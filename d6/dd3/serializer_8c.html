<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: serializer.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">serializer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d5f/serializer_8h_source.html">asterisk/serializer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">asterisk/taskprocessor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d40/threadpool_8h_source.html">asterisk/threadpool.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d68/vector_8h_source.html">asterisk/vector.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for serializer.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d6e/serializer_8c__incl.png" border="0" usemap="#serializer_8c" alt=""/></div>
<map name="serializer_8c" id="serializer_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="98,229,182,256"/>
<area shape="rect" id="node22" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1525,229,1659,256"/>
<area shape="rect" id="node32" href="../../dd/d5f/serializer_8h.html" title="asterisk/serializer.h" alt="" coords="3177,80,3321,107"/>
<area shape="rect" id="node33" href="../../d0/d1e/taskprocessor_8h.html" title="An API for managing task processing threads that can be shared across modules. " alt="" coords="3346,80,3523,107"/>
<area shape="rect" id="node34" href="../../d3/d40/threadpool_8h.html" title="asterisk/threadpool.h" alt="" coords="3548,80,3705,107"/>
<area shape="rect" id="node35" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="2183,80,2297,107"/>
<area shape="rect" id="node49" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="2946,229,3073,256"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="5,528,160,555"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="869,304,1006,331"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="59,304,194,331"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="9,603,156,629"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1331,453,1474,480"/>
<area shape="rect" id="node23" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1803,379,1917,405"/>
<area shape="rect" id="node26" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1817,528,1964,555"/>
<area shape="rect" id="node31" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1651,304,1802,331"/>
<area shape="rect" id="node25" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1505,453,1567,480"/>
<area shape="rect" id="node29" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="1643,453,1794,480"/>
<area shape="rect" id="node30" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="2505,453,2631,480"/>
<area shape="rect" id="node36" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="2171,155,2309,181"/>
<area shape="rect" id="node46" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="2504,155,2651,181"/>
<area shape="rect" id="node48" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="2895,155,3052,181"/>
<area shape="rect" id="node50" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1771,155,1901,181"/>
</map>
</div>
</div>
<p><a href="../../d6/dd3/serializer_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a59e92ce84852e313b5e3a0dae1ddba4d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd3/serializer_8c.html#a59e92ce84852e313b5e3a0dae1ddba4d">ast_serializer_pool_create</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, unsigned int size, struct <a class="el" href="../../d5/d10/structast__threadpool.html">ast_threadpool</a> *<a class="el" href="../../d0/df4/stasis_8c.html#a6dc11fc8f94173cc1af379b74a096abd">threadpool</a>, int <a class="el" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>)</td></tr>
<tr class="memdesc:a59e92ce84852e313b5e3a0dae1ddba4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a serializer pool.  <a href="#a59e92ce84852e313b5e3a0dae1ddba4d">More...</a><br /></td></tr>
<tr class="separator:a59e92ce84852e313b5e3a0dae1ddba4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab24a7208f10fe9bed74475a531f8881e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd3/serializer_8c.html#ab24a7208f10fe9bed74475a531f8881e">ast_serializer_pool_destroy</a> (struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>)</td></tr>
<tr class="memdesc:ab24a7208f10fe9bed74475a531f8881e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the serializer pool.  <a href="#ab24a7208f10fe9bed74475a531f8881e">More...</a><br /></td></tr>
<tr class="separator:ab24a7208f10fe9bed74475a531f8881e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57044062c5e192e675109fa621c1588d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd3/serializer_8c.html#a57044062c5e192e675109fa621c1588d">ast_serializer_pool_get</a> (struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>)</td></tr>
<tr class="memdesc:a57044062c5e192e675109fa621c1588d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a serializer from the pool.  <a href="#a57044062c5e192e675109fa621c1588d">More...</a><br /></td></tr>
<tr class="separator:a57044062c5e192e675109fa621c1588d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9021aba9b9c86fe4f3c652b56a8315a3"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd3/serializer_8c.html#a9021aba9b9c86fe4f3c652b56a8315a3">ast_serializer_pool_name</a> (const struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>)</td></tr>
<tr class="memdesc:a9021aba9b9c86fe4f3c652b56a8315a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the base name of the serializer pool.  <a href="#a9021aba9b9c86fe4f3c652b56a8315a3">More...</a><br /></td></tr>
<tr class="separator:a9021aba9b9c86fe4f3c652b56a8315a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a630652ec26cd3d66063fccef05b3240d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/dd3/serializer_8c.html#a630652ec26cd3d66063fccef05b3240d">ast_serializer_pool_set_alerts</a> (struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, long high, long low)</td></tr>
<tr class="memdesc:a630652ec26cd3d66063fccef05b3240d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set taskprocessor alert levels for the serializers in the pool.  <a href="#a630652ec26cd3d66063fccef05b3240d">More...</a><br /></td></tr>
<tr class="separator:a630652ec26cd3d66063fccef05b3240d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a59e92ce84852e313b5e3a0dae1ddba4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e92ce84852e313b5e3a0dae1ddba4d">&#9670;&nbsp;</a></span>ast_serializer_pool_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a>* ast_serializer_pool_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d5/d10/structast__threadpool.html">ast_threadpool</a> *&#160;</td>
          <td class="paramname"><em>threadpool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a serializer pool. </p>
<p>Create a serializer pool with an optional shutdown group. If a timeout greater than -1 is specified then a shutdown group is enabled on the pool.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The base name for the pool, and used when building taskprocessor(s) </td></tr>
    <tr><td class="paramname">size</td><td>The size of the pool </td></tr>
    <tr><td class="paramname">threadpool</td><td>The backing threadpool to use </td></tr>
    <tr><td class="paramname">timeout</td><td>The timeout used if using a shutdown group (-1 = disabled)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>newly allocated serializer pool object, or NULL on error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00076">76</a> of file <a class="el" href="../../d6/dd3/serializer_8c_source.html">serializer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00039">ast_serializer_pool_destroy()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01229">ast_serializer_shutdown_group_alloc()</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00060">AST_TASKPROCESSOR_MAX_NAME</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01285">ast_taskprocessor_name_append()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01402">ast_threadpool_serializer_group()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00158">AST_VECTOR_RW_INIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">pool</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00030">ast_serializer_pool::shutdown_group</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00032">ast_serializer_pool::shutdown_group_timeout</a>, and <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00086">timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00901">AST_TEST_DEFINE()</a>, and <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05810">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <span class="keywordtype">char</span> tps_name[<a class="code" href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a> + 1];</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordtype">size_t</span> idx;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(size &gt; 0);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   pool = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(<span class="keyword">sizeof</span>(*pool) + strlen(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) + 1);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="keywordflow">if</span> (!pool) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   strcpy(pool-&gt;name, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>); <span class="comment">/* safe */</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#ad502677d8be9ae0ab7bae6f791c6624c">shutdown_group_timeout</a> = <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a> = <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> &gt; -1 ? <a class="code" href="../../d3/d40/threadpool_8h.html#a26d6e398621cb8b8d2e1066b0393944a">ast_serializer_shutdown_group_alloc</a>() : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#af82e9e2b45ad967329a74e88352d7973">AST_VECTOR_RW_INIT</a>(&amp;pool-&gt;serializers, size);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; size; ++idx) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *tps;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="comment">/* Create name with seq number appended. */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a6f0cc7cda2fe82f4c7df4dbdc57b1372">ast_taskprocessor_name_append</a>(tps_name, <span class="keyword">sizeof</span>(tps_name), <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      tps = <a class="code" href="../../d3/d40/threadpool_8h.html#a49b8fabf465ce8e4f325ceecda8ccd16">ast_threadpool_serializer_group</a>(tps_name, threadpool, pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">if</span> (!tps) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;         <a class="code" href="../../d6/dd3/serializer_8c.html#ab24a7208f10fe9bed74475a531f8881e">ast_serializer_pool_destroy</a>(pool);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Pool create: unable to create named serializer &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;               tps_name);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;pool-&gt;serializers, tps)) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;         <a class="code" href="../../d6/dd3/serializer_8c.html#ab24a7208f10fe9bed74475a531f8881e">ast_serializer_pool_destroy</a>(pool);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Pool create: unable to append named serializer &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;               tps_name);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div><div class="ttc" id="vector_8h_html_af82e9e2b45ad967329a74e88352d7973"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af82e9e2b45ad967329a74e88352d7973">AST_VECTOR_RW_INIT</a></div><div class="ttdeci">#define AST_VECTOR_RW_INIT(vec, size)</div><div class="ttdoc">Initialize a vector with a read/write lock. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00158">vector.h:158</a></div></div>
<div class="ttc" id="threadpool_8h_html_a26d6e398621cb8b8d2e1066b0393944a"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#a26d6e398621cb8b8d2e1066b0393944a">ast_serializer_shutdown_group_alloc</a></div><div class="ttdeci">struct ast_serializer_shutdown_group * ast_serializer_shutdown_group_alloc(void)</div><div class="ttdoc">Create a serializer group shutdown control object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01229">threadpool.c:1229</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="threadpool_8h_html_a49b8fabf465ce8e4f325ceecda8ccd16"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#a49b8fabf465ce8e4f325ceecda8ccd16">ast_threadpool_serializer_group</a></div><div class="ttdeci">struct ast_taskprocessor * ast_threadpool_serializer_group(const char *name, struct ast_threadpool *pool, struct ast_serializer_shutdown_group *shutdown_group)</div><div class="ttdoc">Serialized execution of tasks within a ast_threadpool. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01402">threadpool.c:1402</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="serializer_8c_html_ab24a7208f10fe9bed74475a531f8881e"><div class="ttname"><a href="../../d6/dd3/serializer_8c.html#ab24a7208f10fe9bed74475a531f8881e">ast_serializer_pool_destroy</a></div><div class="ttdeci">int ast_serializer_pool_destroy(struct ast_serializer_pool *pool)</div><div class="ttdoc">Destroy the serializer pool. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00039">serializer.c:39</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_adf4c5a237767eb6db5b1db41ccdfc689"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a></div><div class="ttdeci">#define AST_TASKPROCESSOR_MAX_NAME</div><div class="ttdoc">Suggested maximum taskprocessor name length (less null terminator). </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00060">taskprocessor.h:60</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__serializer__pool_html"><div class="ttname"><a href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00028">serializer.c:28</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structast__serializer__pool_html_a2c3d0057b62bfa5b08fe977478749c24"><div class="ttname"><a href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">ast_serializer_pool::shutdown_group</a></div><div class="ttdeci">struct ast_serializer_shutdown_group * shutdown_group</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00030">serializer.c:30</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structast__serializer__pool_html_ad502677d8be9ae0ab7bae6f791c6624c"><div class="ttname"><a href="../../d0/d08/structast__serializer__pool.html#ad502677d8be9ae0ab7bae6f791c6624c">ast_serializer_pool::shutdown_group_timeout</a></div><div class="ttdeci">int shutdown_group_timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00032">serializer.c:32</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a6f0cc7cda2fe82f4c7df4dbdc57b1372"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a6f0cc7cda2fe82f4c7df4dbdc57b1372">ast_taskprocessor_name_append</a></div><div class="ttdeci">void ast_taskprocessor_name_append(char *buf, unsigned int size, const char *name)</div><div class="ttdoc">Append the next sequence number to the given string, and copy into the buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01285">taskprocessor.c:1285</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab24a7208f10fe9bed74475a531f8881e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab24a7208f10fe9bed74475a531f8881e">&#9670;&nbsp;</a></span>ast_serializer_pool_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_serializer_pool_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the serializer pool. </p>
<p>Attempt to destroy the serializer pool. If a shutdown group has been enabled, and times out waiting for threads to complete, then this function will return the number of remaining threads, and the pool will not be destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>The pool to destroy </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00039">39</a> of file <a class="el" href="../../d6/dd3/serializer_8c_source.html">serializer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l01241">ast_serializer_shutdown_group_join()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01109">ast_taskprocessor_unreference()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00627">AST_VECTOR_RESET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00202">AST_VECTOR_RW_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00900">AST_VECTOR_RW_UNLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00890">AST_VECTOR_RW_WRLOCK</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00030">ast_serializer_pool::shutdown_group</a>, and <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00032">ast_serializer_pool::shutdown_group_timeout</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00076">ast_serializer_pool_create()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00901">AST_TEST_DEFINE()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05810">load_module()</a>, and <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05937">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="keywordflow">if</span> (!pool) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="comment">/* Clear out the serializers */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a468985d2b5ca7410d91108bdd0484348">AST_VECTOR_RW_WRLOCK</a>(&amp;pool-&gt;serializers);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a>(&amp;pool-&gt;serializers, <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;pool-&gt;serializers);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="comment">/* If using a shutdown group then wait for all threads to complete */</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">if</span> (pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a>) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordtype">int</span> remaining;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Waiting on serializers before destroying pool &#39;%s&#39;\n&quot;</span>, pool-&gt;name);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      remaining = <a class="code" href="../../d3/d40/threadpool_8h.html#ab8cbf6d9f2f9964fc6225a73cc287441">ast_serializer_shutdown_group_join</a>(</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;         pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a>, pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#ad502677d8be9ae0ab7bae6f791c6624c">shutdown_group_timeout</a>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">if</span> (remaining) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;         <span class="comment">/* If we&#39;ve timed out don&#39;t fully cleanup yet */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;&#39;%s&#39; serializer pool destruction timeout. &quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="stringliteral">&quot;&#39;%d&#39; dependencies still processing.\n&quot;</span>, pool-&gt;name, remaining);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <span class="keywordflow">return</span> remaining;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a>, -1);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      pool-&gt;<a class="code" href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">shutdown_group</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a7b85c5439f23cf3a3b365b7c12643ac8">AST_VECTOR_RW_FREE</a>(&amp;pool-&gt;serializers);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(pool);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="ttc" id="vector_8h_html_a5ad3dd1d3da5d4ebf6a44d32e42c4c91"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_UNLOCK(vec)</div><div class="ttdoc">Unlock vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00900">vector.h:900</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="threadpool_8h_html_ab8cbf6d9f2f9964fc6225a73cc287441"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#ab8cbf6d9f2f9964fc6225a73cc287441">ast_serializer_shutdown_group_join</a></div><div class="ttdeci">int ast_serializer_shutdown_group_join(struct ast_serializer_shutdown_group *shutdown_group, int timeout)</div><div class="ttdoc">Wait for the serializers in the group to shutdown with timeout. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l01241">threadpool.c:1241</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="vector_8h_html_a7b85c5439f23cf3a3b365b7c12643ac8"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a7b85c5439f23cf3a3b365b7c12643ac8">AST_VECTOR_RW_FREE</a></div><div class="ttdeci">#define AST_VECTOR_RW_FREE(vec)</div><div class="ttdoc">Deallocates this locked vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00202">vector.h:202</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__serializer__pool_html_a2c3d0057b62bfa5b08fe977478749c24"><div class="ttname"><a href="../../d0/d08/structast__serializer__pool.html#a2c3d0057b62bfa5b08fe977478749c24">ast_serializer_pool::shutdown_group</a></div><div class="ttdeci">struct ast_serializer_shutdown_group * shutdown_group</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00030">serializer.c:30</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="vector_8h_html_a468985d2b5ca7410d91108bdd0484348"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a468985d2b5ca7410d91108bdd0484348">AST_VECTOR_RW_WRLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_WRLOCK(vec)</div><div class="ttdoc">Obtain write lock on vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00890">vector.h:890</a></div></div>
<div class="ttc" id="vector_8h_html_a0e59aa540254f87575cb1d28821bbd1f"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a></div><div class="ttdeci">#define AST_VECTOR_RESET(vec, cleanup)</div><div class="ttdoc">Reset vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00627">vector.h:627</a></div></div>
<div class="ttc" id="structast__serializer__pool_html_ad502677d8be9ae0ab7bae6f791c6624c"><div class="ttname"><a href="../../d0/d08/structast__serializer__pool.html#ad502677d8be9ae0ab7bae6f791c6624c">ast_serializer_pool::shutdown_group_timeout</a></div><div class="ttdeci">int shutdown_group_timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd3/serializer_8c_source.html#l00032">serializer.c:32</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a32492eb2480cb8c46ad669622cff8556"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a></div><div class="ttdeci">void * ast_taskprocessor_unreference(struct ast_taskprocessor *tps)</div><div class="ttdoc">Unreference the specified taskprocessor and its reference count will decrement. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01109">taskprocessor.c:1109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57044062c5e192e675109fa621c1588d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57044062c5e192e675109fa621c1588d">&#9670;&nbsp;</a></span>ast_serializer_pool_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a>* ast_serializer_pool_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a serializer from the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>The pool object</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">A</td><td>serializer/taskprocessor </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00127">127</a> of file <a class="el" href="../../d6/dd3/serializer_8c_source.html">serializer.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00900">ast_taskprocessor_size()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00880">AST_VECTOR_RW_RDLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00900">AST_VECTOR_RW_UNLOCK</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05218">ast_sip_push_task_wait_serializer()</a>, <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00901">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01553">load_module()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01483">mwi_startup_event_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01156">mwi_stasis_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01343">send_contact_notify()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01142">send_notify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *res;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   <span class="keywordtype">size_t</span> idx;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">if</span> (!pool) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a>(&amp;pool-&gt;serializers);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;pool-&gt;serializers) == 0) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;pool-&gt;serializers);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   res = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;pool-&gt;serializers, 0);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="comment">/* Choose the taskprocessor with the smallest queue */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   <span class="keywordflow">for</span> (idx = 1; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;pool-&gt;serializers); ++idx) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *cur = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;pool-&gt;serializers, idx);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a83d09062fb3c84cf1c84a04174deb2bf">ast_taskprocessor_size</a>(cur) &lt; <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a83d09062fb3c84cf1c84a04174deb2bf">ast_taskprocessor_size</a>(res)) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         res = cur;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a>(&amp;pool-&gt;serializers);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div><div class="ttc" id="taskprocessor_8h_html_a83d09062fb3c84cf1c84a04174deb2bf"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a83d09062fb3c84cf1c84a04174deb2bf">ast_taskprocessor_size</a></div><div class="ttdeci">long ast_taskprocessor_size(struct ast_taskprocessor *tps)</div><div class="ttdoc">Return the current size of the taskprocessor queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00900">taskprocessor.c:900</a></div></div>
<div class="ttc" id="vector_8h_html_a5ad3dd1d3da5d4ebf6a44d32e42c4c91"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a5ad3dd1d3da5d4ebf6a44d32e42c4c91">AST_VECTOR_RW_UNLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_UNLOCK(vec)</div><div class="ttdoc">Unlock vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00900">vector.h:900</a></div></div>
<div class="ttc" id="vector_8h_html_ad414eae87431bad2a7fc4dffa9d06350"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad414eae87431bad2a7fc4dffa9d06350">AST_VECTOR_RW_RDLOCK</a></div><div class="ttdeci">#define AST_VECTOR_RW_RDLOCK(vec)</div><div class="ttdoc">Obtain read lock on vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00880">vector.h:880</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9021aba9b9c86fe4f3c652b56a8315a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9021aba9b9c86fe4f3c652b56a8315a3">&#9670;&nbsp;</a></span>ast_serializer_pool_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_serializer_pool_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *&#160;</td>
          <td class="paramname"><em>pool</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the base name of the serializer pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>The pool object</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>base name given to the pool </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00122">122</a> of file <a class="el" href="../../d6/dd3/serializer_8c_source.html">serializer.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00901">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <span class="keywordflow">return</span> pool-&gt;name;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a630652ec26cd3d66063fccef05b3240d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a630652ec26cd3d66063fccef05b3240d">&#9670;&nbsp;</a></span>ast_serializer_pool_set_alerts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_serializer_pool_set_alerts </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d08/structast__serializer__pool.html">ast_serializer_pool</a> *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>low</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set taskprocessor alert levels for the serializers in the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>The pool to destroy</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success, or -1 on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/dd3/serializer_8c_source.html#l00156">156</a> of file <a class="el" href="../../d6/dd3/serializer_8c_source.html">serializer.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00279">AST_LOG_WARNING</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00830">ast_taskprocessor_alert_set_levels()</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00063">AST_TASKPROCESSOR_HIGH_WATER_LEVEL</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00906">ast_taskprocessor_name()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00078">ast_taskprocessor::tps_queue_high</a>, and <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00076">ast_taskprocessor::tps_queue_low</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/df7/test__taskprocessor_8c_source.html#l00901">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01505">global_loaded()</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="keywordtype">size_t</span> idx;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keywordtype">long</span> <a class="code" href="../../db/d17/structast__taskprocessor.html#a7421fed4da8332ef256efdfdb61bb563">tps_queue_high</a>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordtype">long</span> <a class="code" href="../../db/d17/structast__taskprocessor.html#a281a55644ba8295d14b5ad5c5935b6cc">tps_queue_low</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <span class="keywordflow">if</span> (!pool) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   tps_queue_high = high;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <span class="keywordflow">if</span> (tps_queue_high &lt;= 0) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid &#39;%s-*&#39; taskprocessor high water alert &quot;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="stringliteral">&quot;trigger level &#39;%ld&#39;\n&quot;</span>, pool-&gt;name, tps_queue_high);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      tps_queue_high = <a class="code" href="../../d0/d1e/taskprocessor_8h.html#ad4a3db2b08877779bd481a649318be7d">AST_TASKPROCESSOR_HIGH_WATER_LEVEL</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   tps_queue_low = low;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="keywordflow">if</span> (tps_queue_low &lt; -1 || tps_queue_high &lt; tps_queue_low) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid &#39;%s-*&#39; taskprocessor low water clear alert &quot;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="stringliteral">&quot;level &#39;%ld&#39;\n&quot;</span>, pool-&gt;name, tps_queue_low);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      tps_queue_low = -1;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;pool-&gt;serializers); ++idx) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a> *cur = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;pool-&gt;serializers, idx);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#ad4d9150df7126ae11064d38c755d0813">ast_taskprocessor_alert_set_levels</a>(cur, tps_queue_low, tps_queue_high)) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to set alert levels for serializer &#39;%s&#39;.\n&quot;</span>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;               <a class="code" href="../../d0/d1e/taskprocessor_8h.html#aaa6541086de52447afa994cbfcb792ec">ast_taskprocessor_name</a>(cur));</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="ttc" id="taskprocessor_8h_html_ad4a3db2b08877779bd481a649318be7d"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ad4a3db2b08877779bd481a649318be7d">AST_TASKPROCESSOR_HIGH_WATER_LEVEL</a></div><div class="ttdeci">#define AST_TASKPROCESSOR_HIGH_WATER_LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00063">taskprocessor.h:63</a></div></div>
<div class="ttc" id="logger_8h_html_a2878d83e36d91850732bad997524e45e"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a></div><div class="ttdeci">#define AST_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00279">logger.h:279</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_aaa6541086de52447afa994cbfcb792ec"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#aaa6541086de52447afa994cbfcb792ec">ast_taskprocessor_name</a></div><div class="ttdeci">const char * ast_taskprocessor_name(struct ast_taskprocessor *tps)</div><div class="ttdoc">Return the name of the taskprocessor singleton. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00906">taskprocessor.c:906</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_ad4d9150df7126ae11064d38c755d0813"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ad4d9150df7126ae11064d38c755d0813">ast_taskprocessor_alert_set_levels</a></div><div class="ttdeci">int ast_taskprocessor_alert_set_levels(struct ast_taskprocessor *tps, long low_water, long high_water)</div><div class="ttdoc">Set the high and low alert water marks of the given taskprocessor queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00830">taskprocessor.c:830</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_a7421fed4da8332ef256efdfdb61bb563"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a7421fed4da8332ef256efdfdb61bb563">ast_taskprocessor::tps_queue_high</a></div><div class="ttdeci">long tps_queue_high</div><div class="ttdoc">Taskprocessor high water alert trigger level. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00078">taskprocessor.c:78</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__taskprocessor_html_a281a55644ba8295d14b5ad5c5935b6cc"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html#a281a55644ba8295d14b5ad5c5935b6cc">ast_taskprocessor::tps_queue_low</a></div><div class="ttdeci">long tps_queue_low</div><div class="ttdoc">Taskprocessor low water clear alert level. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00076">taskprocessor.c:76</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__taskprocessor_html"><div class="ttname"><a href="../../db/d17/structast__taskprocessor.html">ast_taskprocessor</a></div><div class="ttdoc">A ast_taskprocessor structure is a singleton by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00069">taskprocessor.c:69</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:46 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
