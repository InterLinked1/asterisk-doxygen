<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: file.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">file.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Generic File Format Support.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;dirent.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/wait.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d78/__private_8h_source.html">asterisk/_private.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/df2/paths_8h_source.html">asterisk/paths.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d5d/mod__format_8h_source.html">asterisk/mod_format.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/db0/cli_8h_source.html">asterisk/cli.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d7b/channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d00/sched_8h_source.html">asterisk/sched.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d39/translate_8h_source.html">asterisk/translate.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d42/lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d93/include_2asterisk_2app_8h_source.html">asterisk/app.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/de0/pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d90/linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d79/stasis_8h_source.html">asterisk/stasis.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d05/json_8h_source.html">asterisk/json.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/df0/stasis__system_8h_source.html">asterisk/stasis_system.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d16/media__cache_8h_source.html">asterisk/media_cache.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for file.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/da4/file_8c__incl.png" border="0" usemap="#file_8c" alt=""/></div>
<map name="file_8c" id="file_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="222,304,306,331"/>
<area shape="rect" id="node14" href="../../d4/d78/__private_8h.html" title="Prototypes for public functions only of internal interest,. " alt="" coords="1393,80,1532,107"/>
<area shape="rect" id="node15" href="../../dd/df2/paths_8h.html" title="Asterisk file paths, configured in asterisk.conf. " alt="" coords="1557,80,1681,107"/>
<area shape="rect" id="node16" href="../../d7/d5d/mod__format_8h.html" title="Header for providers of file and format handling routines. Clients of these routines should include &quot;..." alt="" coords="2103,155,2270,181"/>
<area shape="rect" id="node19" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1702,379,1853,405"/>
<area shape="rect" id="node20" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="2105,453,2218,480"/>
<area shape="rect" id="node21" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="3223,155,3324,181"/>
<area shape="rect" id="node23" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="2588,304,2703,331"/>
<area shape="rect" id="node25" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="2281,304,2415,331"/>
<area shape="rect" id="node26" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1211,155,1349,181"/>
<area shape="rect" id="node38" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="2524,229,2649,256"/>
<area shape="rect" id="node39" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="1989,304,2104,331"/>
<area shape="rect" id="node41" href="../../d7/d00/sched_8h.html" title="Scheduler Routines (derived from cheops) " alt="" coords="1799,155,1926,181"/>
<area shape="rect" id="node42" href="../../db/d39/translate_8h.html" title="Support for translation of data formats. translate.c. " alt="" coords="2650,155,2795,181"/>
<area shape="rect" id="node45" href="../../d3/d93/include_2asterisk_2app_8h.html" title="Application convenience functions, designed to give consistent look and feel to Asterisk apps..." alt="" coords="3348,155,3460,181"/>
<area shape="rect" id="node46" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="1807,80,1918,107"/>
<area shape="rect" id="node47" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="3535,155,3671,181"/>
<area shape="rect" id="node48" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="3258,80,3371,107"/>
<area shape="rect" id="node49" href="../../d3/df0/stasis__system_8h.html" title="asterisk/stasis_system.h" alt="" coords="2417,155,2596,181"/>
<area shape="rect" id="node50" href="../../d3/d16/media__cache_8h.html" title="An in&#45;memory media cache. " alt="" coords="3745,80,3919,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="304,379,459,405"/>
<area shape="rect" id="node4" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="2238,379,2375,405"/>
<area shape="rect" id="node9" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="145,379,279,405"/>
<area shape="rect" id="node5" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="2231,528,2374,555"/>
<area shape="rect" id="node17" href="../../d2/d4d/file_8h.html" title="Generic File Format Support. Should be included by clients of the file handling routines. File service providers should instead include mod_format.h. " alt="" coords="2775,229,2881,256"/>
<area shape="rect" id="node18" href="../../d6/d66/include_2asterisk_2frame_8h.html" title="Asterisk internal frame definitions. " alt="" coords="1663,304,1790,331"/>
<area shape="rect" id="node22" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="3388,229,3519,256"/>
<area shape="rect" id="node24" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="2400,379,2557,405"/>
<area shape="rect" id="node27" href="../../dc/d4d/alertpipe_8h.html" title="asterisk/alertpipe.h" alt="" coords="2305,229,2449,256"/>
<area shape="rect" id="node28" href="../../dc/d14/abstract__jb_8h.html" title="Common implementation&#45;independent jitterbuffer stuff. " alt="" coords="582,229,741,256"/>
<area shape="rect" id="node29" href="../../d4/dfb/poll-compat_8h.html" title="asterisk/poll&#45;compat.h" alt="" coords="765,229,929,256"/>
<area shape="rect" id="node30" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="1316,229,1463,256"/>
<area shape="rect" id="node31" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="2103,229,2230,256"/>
<area shape="rect" id="node32" href="../../dc/d07/cdr_8h.html" title="Call Detail Record API. " alt="" coords="953,229,1060,256"/>
<area shape="rect" id="node33" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="418,304,569,331"/>
<area shape="rect" id="node34" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="1866,229,2027,256"/>
<area shape="rect" id="node35" href="../../d9/d95/channelstate_8h.html" title="Channel states. " alt="" coords="144,229,315,256"/>
<area shape="rect" id="node36" href="../../de/dc8/ccss_8h.html" title="Call Completion Supplementary Services API. " alt="" coords="339,229,455,256"/>
<area shape="rect" id="node37" href="../../db/d3c/framehook_8h.html" title="FrameHook Architecture. " alt="" coords="1084,229,1241,256"/>
<area shape="rect" id="node40" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1487,229,1638,256"/>
<area shape="rect" id="node43" href="../../d2/d66/plc_8h.html" title="SpanDSP &#45; a series of DSP components for telephony. " alt="" coords="2905,229,3012,256"/>
<area shape="rect" id="node44" href="../../db/d1c/format__cache_8h.html" title="Media Format Cache API. " alt="" coords="3036,229,3212,256"/>
</map>
</div>
</div>
<p><a href="../../d6/d13/file_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d8d/structformats.html">formats</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad60e6b6fb8b8078dc9e4deda4ffbde10"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a>(list,  <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)&#160;&#160;&#160;(<a class="el" href="../../d6/d13/file_8c.html#a83eba7ef51aed9cd2463a650e497e359">type_in_list</a>((list), (<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>), strcmp))</td></tr>
<tr class="separator:ad60e6b6fb8b8078dc9e4deda4ffbde10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8dc47e3b39c930caed4bfd05b4ba805"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>&#160;&#160;&#160;&quot;%-10s %-10s %-20s\n&quot;</td></tr>
<tr class="separator:ac8dc47e3b39c930caed4bfd05b4ba805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfd58ce0ec836919236d7a1908494970"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#acfd58ce0ec836919236d7a1908494970">FORMAT2</a>&#160;&#160;&#160;&quot;%-10s %-10s %-20s\n&quot;</td></tr>
<tr class="separator:acfd58ce0ec836919236d7a1908494970"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a8944b5bc4c79736a07589a3761113d01"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01">file_action</a> { <br />
&#160;&#160;<a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a> = 1, 
<a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904">ACTION_DELETE</a>, 
<a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6">ACTION_RENAME</a>, 
<a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a>, 
<br />
&#160;&#160;<a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a>
<br />
 }</td></tr>
<tr class="separator:a8944b5bc4c79736a07589a3761113d01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0245c792fdf4fe895383125a79000fa7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a> { <a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a>, 
<a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a>, 
<a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674">FSREAD_SUCCESS_NOSCHED</a>
 }</td></tr>
<tr class="separator:a0245c792fdf4fe895383125a79000fa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4131813449b33963d46e2345c919e137"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137">wrap_fn</a> { <a class="el" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150">WRAP_OPEN</a>, 
<a class="el" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f">WRAP_REWRITE</a>
 }</td></tr>
<tr class="separator:a4131813449b33963d46e2345c919e137"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa10f8e4185198079a0cecf2278e9144a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#aa10f8e4185198079a0cecf2278e9144a">__ast_file_read_dirs</a> (const char *path, <a class="el" href="../../d2/d4d/file_8h.html#a616155d421abde65671e234068f5d434">ast_file_on_file</a> on_file, void *obj, int max_depth)</td></tr>
<tr class="separator:aa10f8e4185198079a0cecf2278e9144a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01c889d1c352134d89c601384d7c640"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#af01c889d1c352134d89c601384d7c640">__ast_format_def_register</a> (const struct <a class="el" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f, struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *mod)</td></tr>
<tr class="memdesc:af01c889d1c352134d89c601384d7c640"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a new file format capability. Adds a format to Asterisk's format abilities.  <a href="#af01c889d1c352134d89c601384d7c640">More...</a><br /></td></tr>
<tr class="separator:af01c889d1c352134d89c601384d7c640"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a618e3120b6d019312ef2d617d9f14571"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a618e3120b6d019312ef2d617d9f14571">ast_applystream</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s)</td></tr>
<tr class="memdesc:a618e3120b6d019312ef2d617d9f14571"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applys a open stream to a channel.  <a href="#a618e3120b6d019312ef2d617d9f14571">More...</a><br /></td></tr>
<tr class="separator:a618e3120b6d019312ef2d617d9f14571"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab53bd2c3c55d509790c7f7620aac6373"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *f)</td></tr>
<tr class="memdesc:ab53bd2c3c55d509790c7f7620aac6373"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes a stream.  <a href="#ab53bd2c3c55d509790c7f7620aac6373">More...</a><br /></td></tr>
<tr class="separator:ab53bd2c3c55d509790c7f7620aac6373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac4fbc3c21ddf2548bc7ae7fab717f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#aeac4fbc3c21ddf2548bc7ae7fab717f3">ast_file_init</a> (void)</td></tr>
<tr class="separator:aeac4fbc3c21ddf2548bc7ae7fab717f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650841bb643208a8541172297dba1d99"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a650841bb643208a8541172297dba1d99">ast_file_read_dirs</a> (const char *dir_name, <a class="el" href="../../d2/d4d/file_8h.html#a616155d421abde65671e234068f5d434">ast_file_on_file</a> on_file, void *obj, int max_depth)</td></tr>
<tr class="memdesc:a650841bb643208a8541172297dba1d99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recursively iterate through files and directories up to max_depth.  <a href="#a650841bb643208a8541172297dba1d99">More...</a><br /></td></tr>
<tr class="separator:a650841bb643208a8541172297dba1d99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af927e220efdaacab3041f5046ea2973b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#af927e220efdaacab3041f5046ea2973b">ast_filecopy</a> (const char *filename, const char *filename2, const char *fmt)</td></tr>
<tr class="memdesc:af927e220efdaacab3041f5046ea2973b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies a file.  <a href="#af927e220efdaacab3041f5046ea2973b">More...</a><br /></td></tr>
<tr class="separator:af927e220efdaacab3041f5046ea2973b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb15d6efecc1a13b8835bee6d3562ddb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#adb15d6efecc1a13b8835bee6d3562ddb">ast_filedelete</a> (const char *filename, const char *fmt)</td></tr>
<tr class="memdesc:adb15d6efecc1a13b8835bee6d3562ddb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes a file.  <a href="#adb15d6efecc1a13b8835bee6d3562ddb">More...</a><br /></td></tr>
<tr class="separator:adb15d6efecc1a13b8835bee6d3562ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9b8ab8e5ee34c9b4da25779255cafde"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ab9b8ab8e5ee34c9b4da25779255cafde">ast_fileexists</a> (const char *filename, const char *fmt, const char *preflang)</td></tr>
<tr class="memdesc:ab9b8ab8e5ee34c9b4da25779255cafde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks for the existence of a given file.  <a href="#ab9b8ab8e5ee34c9b4da25779255cafde">More...</a><br /></td></tr>
<tr class="separator:ab9b8ab8e5ee34c9b4da25779255cafde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a846dc319b598ef3f0ae9b0c6152e27ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a846dc319b598ef3f0ae9b0c6152e27ba">ast_filerename</a> (const char *filename, const char *filename2, const char *fmt)</td></tr>
<tr class="memdesc:a846dc319b598ef3f0ae9b0c6152e27ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renames a file.  <a href="#a846dc319b598ef3f0ae9b0c6152e27ba">More...</a><br /></td></tr>
<tr class="separator:a846dc319b598ef3f0ae9b0c6152e27ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a484fd6f9417793f9e1d67d3bb6067b0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a484fd6f9417793f9e1d67d3bb6067b0f">ast_format_def_unregister</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a484fd6f9417793f9e1d67d3bb6067b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregisters a file format.  <a href="#a484fd6f9417793f9e1d67d3bb6067b0f">More...</a><br /></td></tr>
<tr class="separator:a484fd6f9417793f9e1d67d3bb6067b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa526fd9bb57d7d9afac2113c30d236f8"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#aa526fd9bb57d7d9afac2113c30d236f8">ast_format_str_reduce</a> (char *fmts)</td></tr>
<tr class="separator:aa526fd9bb57d7d9afac2113c30d236f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96cb704a3da3fbee98696c7a89850a37"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a96cb704a3da3fbee98696c7a89850a37">ast_fsread_audio</a> (const void *data)</td></tr>
<tr class="separator:a96cb704a3da3fbee98696c7a89850a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a9125b21f4ad00a14edbbfeaebace35"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a3a9125b21f4ad00a14edbbfeaebace35">ast_fsread_video</a> (const void *data)</td></tr>
<tr class="separator:a3a9125b21f4ad00a14edbbfeaebace35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdec85bd5a62872c437b223d62e616fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#acdec85bd5a62872c437b223d62e616fa">ast_get_extension_for_mime_type</a> (const char *mime_type, char *buffer, size_t capacity)</td></tr>
<tr class="memdesc:acdec85bd5a62872c437b223d62e616fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a suitable filename extension for the given MIME type.  <a href="#acdec85bd5a62872c437b223d62e616fa">More...</a><br /></td></tr>
<tr class="separator:acdec85bd5a62872c437b223d62e616fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45a9a43d68a284ce9d8467ec9400660c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a45a9a43d68a284ce9d8467ec9400660c">ast_get_format_for_file_ext</a> (const char *file_ext)</td></tr>
<tr class="memdesc:a45a9a43d68a284ce9d8467ec9400660c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the <a class="el" href="../../d0/d98/structast__format.html" title="Definition of a media format. ">ast_format</a> associated with the given file extension.  <a href="#a45a9a43d68a284ce9d8467ec9400660c">More...</a><br /></td></tr>
<tr class="separator:a45a9a43d68a284ce9d8467ec9400660c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad85c951fa1d6988d2d7e169833a951a8"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ad85c951fa1d6988d2d7e169833a951a8">ast_openstream</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *filename, const char *preflang)</td></tr>
<tr class="memdesc:ad85c951fa1d6988d2d7e169833a951a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens stream for use in seeking, playing.  <a href="#ad85c951fa1d6988d2d7e169833a951a8">More...</a><br /></td></tr>
<tr class="separator:ad85c951fa1d6988d2d7e169833a951a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2d6dfeafd18a99d47195178cd752a3d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ae2d6dfeafd18a99d47195178cd752a3d">ast_openstream_full</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *filename, const char *preflang, int asis)</td></tr>
<tr class="memdesc:ae2d6dfeafd18a99d47195178cd752a3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens stream for use in seeking, playing.  <a href="#ae2d6dfeafd18a99d47195178cd752a3d">More...</a><br /></td></tr>
<tr class="separator:ae2d6dfeafd18a99d47195178cd752a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed49fff2d6008a89f996230988d944d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#aeed49fff2d6008a89f996230988d944d">ast_openvstream</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *filename, const char *preflang)</td></tr>
<tr class="memdesc:aeed49fff2d6008a89f996230988d944d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens stream for use in seeking, playing.  <a href="#aeed49fff2d6008a89f996230988d944d">More...</a><br /></td></tr>
<tr class="separator:aeed49fff2d6008a89f996230988d944d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad59224750b8b617f9590b28b88457b14"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ad59224750b8b617f9590b28b88457b14">ast_playstream</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s)</td></tr>
<tr class="memdesc:ad59224750b8b617f9590b28b88457b14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Play a open stream on a channel.  <a href="#ad59224750b8b617f9590b28b88457b14">More...</a><br /></td></tr>
<tr class="separator:ad59224750b8b617f9590b28b88457b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4afbcd56a1aaf40eca3827e6d890372"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ab4afbcd56a1aaf40eca3827e6d890372">ast_ratestream</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs)</td></tr>
<tr class="memdesc:ab4afbcd56a1aaf40eca3827e6d890372"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the sample rate of the stream's format.  <a href="#ab4afbcd56a1aaf40eca3827e6d890372">More...</a><br /></td></tr>
<tr class="separator:ab4afbcd56a1aaf40eca3827e6d890372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6782e0130a721c4eeb51d2d10d791f8"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#aa6782e0130a721c4eeb51d2d10d791f8">ast_readaudio_callback</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s)</td></tr>
<tr class="separator:aa6782e0130a721c4eeb51d2d10d791f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad572060ea434390db3d1ccde4511dfcd"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ad572060ea434390db3d1ccde4511dfcd">ast_readfile</a> (const char *filename, const char *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a>, int flags, int check, mode_t mode)</td></tr>
<tr class="memdesc:ad572060ea434390db3d1ccde4511dfcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts reading from a file.  <a href="#ad572060ea434390db3d1ccde4511dfcd">More...</a><br /></td></tr>
<tr class="separator:ad572060ea434390db3d1ccde4511dfcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a962bc31d7a953b0a0290c72b168d41a7"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a962bc31d7a953b0a0290c72b168d41a7">ast_readframe</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s)</td></tr>
<tr class="memdesc:a962bc31d7a953b0a0290c72b168d41a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a frame from a filestream.  <a href="#a962bc31d7a953b0a0290c72b168d41a7">More...</a><br /></td></tr>
<tr class="separator:a962bc31d7a953b0a0290c72b168d41a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b623c146b07dbc4a96be4d8adbcfc4"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#af8b623c146b07dbc4a96be4d8adbcfc4">ast_readvideo_callback</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s)</td></tr>
<tr class="separator:af8b623c146b07dbc4a96be4d8adbcfc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f6bba05952162d5d1ee7fb9819bd07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a36f6bba05952162d5d1ee7fb9819bd07">ast_seekstream</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs, off_t sample_offset, int whence)</td></tr>
<tr class="memdesc:a36f6bba05952162d5d1ee7fb9819bd07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seeks into stream.  <a href="#a36f6bba05952162d5d1ee7fb9819bd07">More...</a><br /></td></tr>
<tr class="separator:a36f6bba05952162d5d1ee7fb9819bd07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0d358c02e7a6cbe06d4b67237aca3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a2f0d358c02e7a6cbe06d4b67237aca3d">ast_stopstream</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>)</td></tr>
<tr class="memdesc:a2f0d358c02e7a6cbe06d4b67237aca3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops a stream.  <a href="#a2f0d358c02e7a6cbe06d4b67237aca3d">More...</a><br /></td></tr>
<tr class="separator:a2f0d358c02e7a6cbe06d4b67237aca3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95b94a020720147325a486e210b36775"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a95b94a020720147325a486e210b36775">ast_stream_and_wait</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *file, const char *digits)</td></tr>
<tr class="memdesc:a95b94a020720147325a486e210b36775"><td class="mdescLeft">&#160;</td><td class="mdescRight">stream file until digit If the file name is non-empty, try to play it.  <a href="#a95b94a020720147325a486e210b36775">More...</a><br /></td></tr>
<tr class="separator:a95b94a020720147325a486e210b36775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2137b5da91f3408f86d580952f32e94"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ac2137b5da91f3408f86d580952f32e94">ast_stream_fastforward</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs, off_t ms)</td></tr>
<tr class="memdesc:ac2137b5da91f3408f86d580952f32e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fast forward stream ms.  <a href="#ac2137b5da91f3408f86d580952f32e94">More...</a><br /></td></tr>
<tr class="separator:ac2137b5da91f3408f86d580952f32e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c7c02a659b09bb06dd63e1f42692666"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a4c7c02a659b09bb06dd63e1f42692666">ast_stream_rewind</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs, off_t ms)</td></tr>
<tr class="memdesc:a4c7c02a659b09bb06dd63e1f42692666"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rewind stream ms.  <a href="#a4c7c02a659b09bb06dd63e1f42692666">More...</a><br /></td></tr>
<tr class="separator:a4c7c02a659b09bb06dd63e1f42692666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0d3e6f2bebe7f68fd264438e0d2059"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a0e0d3e6f2bebe7f68fd264438e0d2059">ast_streamfile</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *filename, const char *preflang)</td></tr>
<tr class="memdesc:a0e0d3e6f2bebe7f68fd264438e0d2059"><td class="mdescLeft">&#160;</td><td class="mdescRight">Streams a file.  <a href="#a0e0d3e6f2bebe7f68fd264438e0d2059">More...</a><br /></td></tr>
<tr class="separator:a0e0d3e6f2bebe7f68fd264438e0d2059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01771a318e7adea51499040f27b4278a"><td class="memItemLeft" align="right" valign="top">off_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a01771a318e7adea51499040f27b4278a">ast_tellstream</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs)</td></tr>
<tr class="memdesc:a01771a318e7adea51499040f27b4278a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tell where we are in a stream.  <a href="#a01771a318e7adea51499040f27b4278a">More...</a><br /></td></tr>
<tr class="separator:a01771a318e7adea51499040f27b4278a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa647ac352a00b559131f90ffffea2c3c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#aa647ac352a00b559131f90ffffea2c3c">ast_truncstream</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs)</td></tr>
<tr class="memdesc:aa647ac352a00b559131f90ffffea2c3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trunc stream at current location.  <a href="#aa647ac352a00b559131f90ffffea2c3c">More...</a><br /></td></tr>
<tr class="separator:aa647ac352a00b559131f90ffffea2c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affc21cb57c6bf72a2cb7ec8a379b2137"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#affc21cb57c6bf72a2cb7ec8a379b2137">ast_waitstream</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, const char *breakon)</td></tr>
<tr class="memdesc:affc21cb57c6bf72a2cb7ec8a379b2137"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for a stream to stop or digit to be pressed.  <a href="#affc21cb57c6bf72a2cb7ec8a379b2137">More...</a><br /></td></tr>
<tr class="separator:affc21cb57c6bf72a2cb7ec8a379b2137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6eb4e1e4576abe04a4b185688f6690c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ae6eb4e1e4576abe04a4b185688f6690c">ast_waitstream_exten</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, const char *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>)</td></tr>
<tr class="memdesc:ae6eb4e1e4576abe04a4b185688f6690c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for a stream to stop or digit matching a valid one digit exten to be pressed.  <a href="#ae6eb4e1e4576abe04a4b185688f6690c">More...</a><br /></td></tr>
<tr class="separator:ae6eb4e1e4576abe04a4b185688f6690c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42226fa82166fc67e698a77b84f3c692"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a42226fa82166fc67e698a77b84f3c692">ast_waitstream_fr</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, const char *breakon, const char *forward, const char *reverse, int ms)</td></tr>
<tr class="memdesc:a42226fa82166fc67e698a77b84f3c692"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same as waitstream but allows stream to be forwarded or rewound.  <a href="#a42226fa82166fc67e698a77b84f3c692">More...</a><br /></td></tr>
<tr class="separator:a42226fa82166fc67e698a77b84f3c692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42aa663fc1c39323aac9c1da5b54389"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ad42aa663fc1c39323aac9c1da5b54389">ast_waitstream_fr_w_cb</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, const char *breakon, const char *forward, const char *reverse, int ms, <a class="el" href="../../d2/d4d/file_8h.html#a2d5138e99197a1d01f7a2ed07830476e">ast_waitstream_fr_cb</a> cb)</td></tr>
<tr class="memdesc:ad42aa663fc1c39323aac9c1da5b54389"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same as waitstream_fr but allows a callback to be alerted when a user fastforwards or rewinds the file.  <a href="#ad42aa663fc1c39323aac9c1da5b54389">More...</a><br /></td></tr>
<tr class="separator:ad42aa663fc1c39323aac9c1da5b54389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09fa137da8f6383a8075c1fe273f6b7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a09fa137da8f6383a8075c1fe273f6b7b">ast_waitstream_full</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, const char *breakon, int audiofd, int cmdfd)</td></tr>
<tr class="separator:a09fa137da8f6383a8075c1fe273f6b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a964f8ef393c07609d7b9e02937faed52"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a964f8ef393c07609d7b9e02937faed52">ast_writefile</a> (const char *filename, const char *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a>, int flags, int check, mode_t mode)</td></tr>
<tr class="memdesc:a964f8ef393c07609d7b9e02937faed52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts writing a file.  <a href="#a964f8ef393c07609d7b9e02937faed52">More...</a><br /></td></tr>
<tr class="separator:a964f8ef393c07609d7b9e02937faed52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3608386b919ef0949d2858cdeb02d12e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a3608386b919ef0949d2858cdeb02d12e">ast_writestream</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *f)</td></tr>
<tr class="memdesc:a3608386b919ef0949d2858cdeb02d12e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a frame to a stream.  <a href="#a3608386b919ef0949d2858cdeb02d12e">More...</a><br /></td></tr>
<tr class="separator:a3608386b919ef0949d2858cdeb02d12e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a836416f6627399f3b75ef2705bcd89"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a> (const char *filename, const char *<a class="el" href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>)</td></tr>
<tr class="memdesc:a2a836416f6627399f3b75ef2705bcd89"><td class="mdescLeft">&#160;</td><td class="mdescRight">construct a filename. Absolute pathnames are preserved, relative names are prefixed by the sounds/ directory. The wav49 suffix is replaced by 'WAV'. Returns a malloc'ed string to be freed by the caller.  <a href="#a2a836416f6627399f3b75ef2705bcd89">More...</a><br /></td></tr>
<tr class="separator:a2a836416f6627399f3b75ef2705bcd89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939eb1d85b6fd5dfc16d00d1c3f86df0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a939eb1d85b6fd5dfc16d00d1c3f86df0">copy</a> (const char *infile, const char *outfile)</td></tr>
<tr class="separator:a939eb1d85b6fd5dfc16d00d1c3f86df0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af69640cb6edeb12525ed8a85e26ca4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a4af69640cb6edeb12525ed8a85e26ca4">file_shutdown</a> (void)</td></tr>
<tr class="separator:a4af69640cb6edeb12525ed8a85e26ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbaf6de590d8e1505c484b44d278e4f8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#acbaf6de590d8e1505c484b44d278e4f8">fileexists_core</a> (const char *filename, const char *fmt, const char *preflang, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, int buflen, struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *result_cap)</td></tr>
<tr class="memdesc:acbaf6de590d8e1505c484b44d278e4f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">helper routine to locate a file with a given format and language preference.  <a href="#acbaf6de590d8e1505c484b44d278e4f8">More...</a><br /></td></tr>
<tr class="separator:acbaf6de590d8e1505c484b44d278e4f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accfa3871048ab1857f7a409c39f18ec9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#accfa3871048ab1857f7a409c39f18ec9">fileexists_test</a> (const char *filename, const char *fmt, const char *lang, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, int buflen, struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *result_cap)</td></tr>
<tr class="memdesc:accfa3871048ab1857f7a409c39f18ec9"><td class="mdescLeft">&#160;</td><td class="mdescRight">test if a file exists for a given format.  <a href="#accfa3871048ab1857f7a409c39f18ec9">More...</a><br /></td></tr>
<tr class="separator:accfa3871048ab1857f7a409c39f18ec9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a083568a210b02e2a6985923817b6e4dc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a> (const char *filename, const void *arg2, const char *fmt, const enum <a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01">file_action</a> action)</td></tr>
<tr class="separator:a083568a210b02e2a6985923817b6e4dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8897ad04ddc571f5ac100a1b53774ec2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a8897ad04ddc571f5ac100a1b53774ec2">filestream_close</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *f)</td></tr>
<tr class="separator:a8897ad04ddc571f5ac100a1b53774ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a776a9332979114886ee9fbf55bab1801"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a776a9332979114886ee9fbf55bab1801">filestream_destructor</a> (void *arg)</td></tr>
<tr class="separator:a776a9332979114886ee9fbf55bab1801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac764765c2aa449eb5840087a2148e5ef"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ac764765c2aa449eb5840087a2148e5ef">fn_wrapper</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s, const char *<a class="el" href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a>, enum <a class="el" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137">wrap_fn</a> mode)</td></tr>
<tr class="separator:ac764765c2aa449eb5840087a2148e5ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e809ea7be0413c527df113a695552b8"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a3e809ea7be0413c527df113a695552b8">get_filestream</a> (struct <a class="el" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *fmt, FILE *bfile)</td></tr>
<tr class="separator:a3e809ea7be0413c527df113a695552b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71e8d82ba7e263ff1d3ec9dbade3848"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ac71e8d82ba7e263ff1d3ec9dbade3848">handle_cli_core_show_file_formats</a> (struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, int cmd, struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</td></tr>
<tr class="separator:ac71e8d82ba7e263ff1d3ec9dbade3848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2ba253f0cfdacc7312206800f7bd2bb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ab2ba253f0cfdacc7312206800f7bd2bb">is_absolute_path</a> (const char *filename)</td></tr>
<tr class="separator:ab2ba253f0cfdacc7312206800f7bd2bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9693d0bc24ee3d83d6e252a7c2c7c469"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a9693d0bc24ee3d83d6e252a7c2c7c469">is_remote_path</a> (const char *filename)</td></tr>
<tr class="separator:a9693d0bc24ee3d83d6e252a7c2c7c469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1eca44fecdfccc58cc9ba244c96f88d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ad1eca44fecdfccc58cc9ba244c96f88d">json_array_from_list</a> (const char *list, const char *sep)</td></tr>
<tr class="separator:ad1eca44fecdfccc58cc9ba244c96f88d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac17ab5a9432e8fbe75d7968221897716"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ac17ab5a9432e8fbe75d7968221897716">open_wrapper</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s)</td></tr>
<tr class="separator:ac17ab5a9432e8fbe75d7968221897716"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda6674956dbac7a613967194e4b26e7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#adda6674956dbac7a613967194e4b26e7">publish_format_update</a> (const struct <a class="el" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="separator:adda6674956dbac7a613967194e4b26e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d11f27997994d366d52d54a084ec944"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a3d11f27997994d366d52d54a084ec944">read_frame</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s, int *whennext)</td></tr>
<tr class="separator:a3d11f27997994d366d52d54a084ec944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe06882238f9fabfff485fefc6fa619"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#acbe06882238f9fabfff485fefc6fa619">rewrite_wrapper</a> (struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s, const char *<a class="el" href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a>)</td></tr>
<tr class="separator:acbe06882238f9fabfff485fefc6fa619"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55a8377c040ff899e59b19d08030e255"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a55a8377c040ff899e59b19d08030e255">sanitize_waitstream_return</a> (int return_value)</td></tr>
<tr class="separator:a55a8377c040ff899e59b19d08030e255"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa96fd1a85db890f86168553addfe476d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#aa96fd1a85db890f86168553addfe476d">STASIS_MESSAGE_TYPE_DEFN</a> (<a class="el" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a>)</td></tr>
<tr class="separator:aa96fd1a85db890f86168553addfe476d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a906c80ea10a19fdc90ce783d20f1c454"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a906c80ea10a19fdc90ce783d20f1c454">STASIS_MESSAGE_TYPE_DEFN</a> (<a class="el" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a>)</td></tr>
<tr class="separator:a906c80ea10a19fdc90ce783d20f1c454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83eba7ef51aed9cd2463a650e497e359"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a83eba7ef51aed9cd2463a650e497e359">type_in_list</a> (const char *list, const char *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, int(*cmp)(const char *s1, const char *s2))</td></tr>
<tr class="separator:a83eba7ef51aed9cd2463a650e497e359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b84e188c383fe736ce31e891ae684c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a82b84e188c383fe736ce31e891ae684c">waitstream_control</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, enum <a class="el" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6f">ast_waitstream_fr_cb_values</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, <a class="el" href="../../d2/d4d/file_8h.html#a2d5138e99197a1d01f7a2ed07830476e">ast_waitstream_fr_cb</a> cb, int skip_ms)</td></tr>
<tr class="separator:a82b84e188c383fe736ce31e891ae684c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab691e222ec6bab6039597ddbed2b5cf8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>, const char *breakon, const char *forward, const char *reverse, int skip_ms, int audiofd, int cmdfd, const char *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, <a class="el" href="../../d2/d4d/file_8h.html#a2d5138e99197a1d01f7a2ed07830476e">ast_waitstream_fr_cb</a> cb)</td></tr>
<tr class="memdesc:ab691e222ec6bab6039597ddbed2b5cf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">the core of all waitstream() functions  <a href="#ab691e222ec6bab6039597ddbed2b5cf8">More...</a><br /></td></tr>
<tr class="separator:ab691e222ec6bab6039597ddbed2b5cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a248e5c086666b04d29a9cd876ad370b3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a248e5c086666b04d29a9cd876ad370b3">ast_language_is_prefix</a> = 1</td></tr>
<tr class="memdesc:a248e5c086666b04d29a9cd876ad370b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The following variable controls the layout of localized sound files. If 0, use the historical layout with prefix just before the filename (i.e. digits/en/1.gsm , digits/it/1.gsm or default to digits/1.gsm), if 1 put the prefix at the beginning of the filename (i.e. en/digits/1.gsm, it/digits/1.gsm or default to digits/1.gsm). The latter permits a language to be entirely in one directory.  <a href="#a248e5c086666b04d29a9cd876ad370b3">More...</a><br /></td></tr>
<tr class="separator:a248e5c086666b04d29a9cd876ad370b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaef9acc752363813eb89bb0b72721a7"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#abaef9acc752363813eb89bb0b72721a7">cli_file</a> []</td></tr>
<tr class="separator:abaef9acc752363813eb89bb0b72721a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80aada71b7a5bcb79dddc1bcc20540c0"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../df/d8d/structformats.html">formats</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a80aada71b7a5bcb79dddc1bcc20540c0">formats</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td></tr>
<tr class="separator:a80aada71b7a5bcb79dddc1bcc20540c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3cc651725e456bc129d10e1f10271e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../dd/d42/lock_8h.html#a44a55ccb432d858a224b401116277e93">ast_mutex_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d13/file_8c.html#a9c3cc651725e456bc129d10e1f10271e">read_dirs_lock</a> = { PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} }</td></tr>
<tr class="memdesc:a9c3cc651725e456bc129d10e1f10271e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock to hold when iterating over directories.  <a href="#a9c3cc651725e456bc129d10e1f10271e">More...</a><br /></td></tr>
<tr class="separator:a9c3cc651725e456bc129d10e1f10271e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Generic File Format Support. </p>
<dl class="section author"><dt>Author</dt><dd>Mark Spencer <a href="#" onclick="location.href='mai'+'lto:'+'mar'+'ks'+'ter'+'@d'+'igi'+'um'+'.co'+'m'; return false;">marks<span style="display: none;">.nosp@m.</span>ter@<span style="display: none;">.nosp@m.</span>digiu<span style="display: none;">.nosp@m.</span>m.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ad60e6b6fb8b8078dc9e4deda4ffbde10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e6b6fb8b8078dc9e4deda4ffbde10">&#9670;&nbsp;</a></span>exts_compare</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define exts_compare</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">list, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(<a class="el" href="../../d6/d13/file_8c.html#a83eba7ef51aed9cd2463a650e497e359">type_in_list</a>((list), (<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>), strcmp))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00351">351</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01826">ast_format_str_reduce()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01938">ast_get_format_for_file_ext()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01309">ast_readfile()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01361">ast_writefile()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>.</p>

</div>
</div>
<a id="ac8dc47e3b39c930caed4bfd05b4ba805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8dc47e3b39c930caed4bfd05b4ba805">&#9670;&nbsp;</a></span>FORMAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FORMAT&#160;&#160;&#160;&quot;%-10s %-10s %-20s\n&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01902">handle_cli_core_show_file_formats()</a>.</p>

</div>
</div>
<a id="acfd58ce0ec836919236d7a1908494970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd58ce0ec836919236d7a1908494970">&#9670;&nbsp;</a></span>FORMAT2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FORMAT2&#160;&#160;&#160;&quot;%-10s %-10s %-20s\n&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01902">handle_cli_core_show_file_formats()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a8944b5bc4c79736a07589a3761113d01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8944b5bc4c79736a07589a3761113d01">&#9670;&nbsp;</a></span>file_action</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01">file_action</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975"></a>ACTION_EXISTS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904"></a>ACTION_DELETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6"></a>ACTION_RENAME&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7"></a>ACTION_OPEN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f"></a>ACTION_COPY&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00495">495</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                 {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a> = 1, <span class="comment">/* return matching format if file exists, 0 otherwise */</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904">ACTION_DELETE</a>, <span class="comment">/* delete file, return 0 on success, -1 on error */</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6">ACTION_RENAME</a>, <span class="comment">/* rename file. return 0 on success, -1 on error */</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a>,</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a> <span class="comment">/* copy file. return 0 on success, -1 on error */</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;};</div><div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00499">file.c:499</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00496">file.c:496</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904">ACTION_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00497">file.c:497</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6">ACTION_RENAME</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00498">file.c:498</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00500">file.c:500</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0245c792fdf4fe895383125a79000fa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0245c792fdf4fe895383125a79000fa7">&#9670;&nbsp;</a></span>fsread_res</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b"></a>FSREAD_FAILURE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5"></a>FSREAD_SUCCESS_SCHED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674"></a>FSREAD_SUCCESS_NOSCHED&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00906">906</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a>,</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a>,</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674">FSREAD_SUCCESS_NOSCHED</a>,</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;};</div><div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00907">file.c:907</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674">FSREAD_SUCCESS_NOSCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00909">file.c:909</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00908">file.c:908</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4131813449b33963d46e2345c919e137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4131813449b33963d46e2345c919e137">&#9670;&nbsp;</a></span>wrap_fn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137">wrap_fn</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150"></a>WRAP_OPEN&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f"></a>WRAP_REWRITE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00466">466</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{ <a class="code" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150">WRAP_OPEN</a>, <a class="code" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f">WRAP_REWRITE</a> };</div><div class="ttc" id="file_8c_html_a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150">WRAP_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00466">file.c:466</a></div></div>
<div class="ttc" id="file_8c_html_a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f">WRAP_REWRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00466">file.c:466</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa10f8e4185198079a0cecf2278e9144a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10f8e4185198079a0cecf2278e9144a">&#9670;&nbsp;</a></span>__ast_file_read_dirs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int __ast_file_read_dirs </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d4d/file_8h.html#a616155d421abde65671e234068f5d434">ast_file_on_file</a>&#160;</td>
          <td class="paramname"><em>on_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01113">1113</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01231">ast_file_read_dirs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;{</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;   DIR *dir;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   <span class="keyword">struct </span>dirent *<a class="code" href="../../d3/d96/structentry.html">entry</a>;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;   <span class="keywordflow">if</span> (!(dir = opendir(path))) {</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Error opening directory - %s: %s\n&quot;</span>,</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         path, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;   --max_depth;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;   res = 0;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;   <span class="keywordflow">while</span> ((entry = readdir(dir)) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; !<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>) {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="keywordtype">int</span> is_file = 0;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordtype">int</span> is_dir = 0;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keywordtype">char</span> *, full_path, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordflow">if</span> (!strcmp(entry-&gt;d_name, <span class="stringliteral">&quot;.&quot;</span>) || !strcmp(entry-&gt;d_name, <span class="stringliteral">&quot;..&quot;</span>)) {</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment"> * If the dirent structure has a d_type use it to determine if we are dealing with</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment"> * a file or directory. Unfortunately if it doesn&#39;t have it, or if the type is</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment"> * unknown, or a link then we&#39;ll need to use the stat function instead.</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="preprocessor">#ifdef _DIRENT_HAVE_D_TYPE</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">if</span> (entry-&gt;d_type != DT_UNKNOWN &amp;&amp; entry-&gt;d_type != DT_LNK) {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;         is_file = entry-&gt;d_type == DT_REG;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;         is_dir = entry-&gt;d_type == DT_DIR;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      {</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;         <span class="keyword">struct </span>stat statbuf;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">          * Don&#39;t use alloca or we risk blowing out the stack if recursing</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">          * into subdirectories.</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;         full_path = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(strlen(path) + strlen(entry-&gt;d_name) + 2);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;         <span class="keywordflow">if</span> (!full_path) {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;         }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;         sprintf(full_path, <span class="stringliteral">&quot;%s/%s&quot;</span>, path, entry-&gt;d_name);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;         <span class="keywordflow">if</span> (stat(full_path, &amp;statbuf)) {</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Error reading path stats - %s: %s\n&quot;</span>,</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;               full_path, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">             * Output an error, but keep going. It could just be</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">             * a broken link and other files could be fine.</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;         }</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;         is_file = S_ISREG(statbuf.st_mode);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;         is_dir = S_ISDIR(statbuf.st_mode);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      }</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="keywordflow">if</span> (is_file) {</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;         <span class="comment">/* If the handler returns non-zero then stop */</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         <span class="keywordflow">if</span> ((res = on_file(path, entry-&gt;d_name, obj))) {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;         }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;         <span class="comment">/* Otherwise move on to next item in directory */</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keywordflow">if</span> (!is_dir) {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;Skipping %s: not a regular file or directory\n&quot;</span>, full_path);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <span class="comment">/* Only re-curse into sub-directories if not at the max depth */</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">if</span> (max_depth != 0) {</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;         <span class="keywordflow">if</span> (!full_path) {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="comment">/* Don&#39;t use alloca.  See note above. */</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            full_path = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(strlen(path) + strlen(entry-&gt;d_name) + 2);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            <span class="keywordflow">if</span> (!full_path) {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;               <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            }</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            sprintf(full_path, <span class="stringliteral">&quot;%s/%s&quot;</span>, path, entry-&gt;d_name);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;         }</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         <span class="keywordflow">if</span> ((res = <a class="code" href="../../d6/d13/file_8c.html#aa10f8e4185198079a0cecf2278e9144a">__ast_file_read_dirs</a>(full_path, on_file, obj, max_depth))) {</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;         }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      }</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;   }</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;   closedir(dir);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;   <span class="keywordflow">if</span> (!res &amp;&amp; <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>) {</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Error while reading directories - %s: %s\n&quot;</span>,</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;         path, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      res = -1;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;   }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="file_8c_html_aa10f8e4185198079a0cecf2278e9144a"><div class="ttname"><a href="../../d6/d13/file_8c.html#aa10f8e4185198079a0cecf2278e9144a">__ast_file_read_dirs</a></div><div class="ttdeci">static int __ast_file_read_dirs(const char *path, ast_file_on_file on_file, void *obj, int max_depth)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01113">file.c:1113</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af01c889d1c352134d89c601384d7c640"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af01c889d1c352134d89c601384d7c640">&#9670;&nbsp;</a></span>__ast_format_def_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __ast_format_def_register </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td>
          <td class="paramname"><em>mod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a new file format capability. Adds a format to Asterisk's format abilities. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00124">124</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">a</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00717">AST_RWLIST_INSERT_HEAD</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">b</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00090">ast_format_def::buf_size</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00093">ast_format_def::module</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00093">publish_format_update()</a>, and <a class="el" href="../../de/d1e/bt__open_8c_source.html#l00389">tmp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, tmp, <a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>, tmp-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>)) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Tried to register &#39;%s&#39; format, already registered\n&quot;</span>, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keywordflow">if</span> (!(tmp = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*tmp)))) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   *tmp = *f;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   tmp-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a> = mod;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">buf_size</a>) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">       * Align buf_size properly, rounding up to the machine-specific</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">       * alignment for pointers.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keyword">struct </span>_test_align { <span class="keywordtype">void</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>, *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>; } p;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordtype">int</span> align = (<span class="keywordtype">char</span> *)&amp;p.b - (<span class="keywordtype">char</span> *)&amp;p.a;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      tmp-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">buf_size</a> = ((f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">buf_size</a> + align - 1) / align) * align;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   memset(&amp;tmp-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>, 0, <span class="keyword">sizeof</span>(tmp-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>));</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aacc5f6b7c25e361d11d40137fd55a8e8">AST_RWLIST_INSERT_HEAD</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, tmp, list);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Registered file format %s, extension(s) %s\n&quot;</span>, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#adda6674956dbac7a613967194e4b26e7">publish_format_update</a>(f, <a class="code" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a>());</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="structast__format__def_html_a8637433cfbb88aeb10ce2ed5dcba0eb1"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">ast_format_def::module</a></div><div class="ttdeci">struct ast_module * module</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00093">mod_format.h:93</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aacc5f6b7c25e361d11d40137fd55a8e8"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aacc5f6b7c25e361d11d40137fd55a8e8">AST_RWLIST_INSERT_HEAD</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_HEAD</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00717">linkedlists.h:717</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="format_8h_html_a50026f039eb9220ff618fa7a4f3a1da1"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a></div><div class="ttdeci">struct stasis_message_type * ast_format_register_type(void)</div><div class="ttdoc">Get the message type used for signaling a format registration. </div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structast__format__def_html_a4c813abab25e4df4e95d8f0b0ca61500"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">ast_format_def::buf_size</a></div><div class="ttdeci">int buf_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00090">mod_format.h:90</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a025ede890af287961d3a98d0e634a62b"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a></div><div class="ttdeci">static struct test_val b</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">test_linkedlists.c:47</a></div></div>
<div class="ttc" id="file_8c_html_adda6674956dbac7a613967194e4b26e7"><div class="ttname"><a href="../../d6/d13/file_8c.html#adda6674956dbac7a613967194e4b26e7">publish_format_update</a></div><div class="ttdeci">static int publish_format_update(const struct ast_format_def *f, struct stasis_message_type *type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00093">file.c:93</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a618e3120b6d019312ef2d617d9f14571"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a618e3120b6d019312ef2d617d9f14571">&#9670;&nbsp;</a></span>ast_applystream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_applystream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applys a open stream to a channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chan</td><td>channel to work </td></tr>
    <tr><td class="paramname">s</td><td><a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> to apply </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01020">1020</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00116">ast_filestream::owner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01250">ast_streamfile()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>, and <a class="el" href="../../d4/d5b/app__speech__utils_8c_source.html#l00676">speech_streamfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;{</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a> = chan;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;}</div><div class="ttc" id="structast__filestream_html_a9241175b397dfd032c4cadbc8c9c2d05"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">ast_filestream::owner</a></div><div class="ttdeci">struct ast_channel * owner</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00116">mod_format.h:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab53bd2c3c55d509790c7f7620aac6373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab53bd2c3c55d509790c7f7620aac6373">&#9670;&nbsp;</a></span>ast_closestream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_closestream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>filestream to close Close a playback or recording stream </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01068">1068</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00357">filestream_close()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02548">ast_hangup()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00313">ast_moh_files_next()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00305">ast_monitor_start()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00461">ast_monitor_stop()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01309">ast_readfile()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00187">ast_stopstream()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01361">ast_writefile()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00087">dictate_exec()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00383">filestream_destructor()</a>, <a class="el" href="../../de/d26/app__externalivr_8c_source.html#l00188">gen_closestream()</a>, <a class="el" href="../../d0/ddd/res__convert_8c_source.html#l00064">handle_cli_file_convert()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l01878">local_ast_moh_stop()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l00467">mixmonitor_ds_close_fs()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00281">moh_files_release()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, and <a class="el" href="../../df/d44/app__meetme_8c_source.html#l05681">recordthread()</a>.</p>
<div class="fragment"><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;{</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <span class="comment">/* This used to destroy the filestream, but it now just decrements a refcount.</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">    * We close the stream in order to quit queuing frames now, because we might</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">    * change the writeformat, which could result in a subsequent write error, if</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">    * the format is different. */</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   <span class="keywordflow">if</span> (f == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a8897ad04ddc571f5ac100a1b53774ec2">filestream_close</a>(f);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(f, -1);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;}</div><div class="ttc" id="file_8c_html_a8897ad04ddc571f5ac100a1b53774ec2"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8897ad04ddc571f5ac100a1b53774ec2">filestream_close</a></div><div class="ttdeci">static void filestream_close(struct ast_filestream *f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00357">file.c:357</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeac4fbc3c21ddf2548bc7ae7fab717f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac4fbc3c21ddf2548bc7ae7fab717f3">&#9670;&nbsp;</a></span>ast_file_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_file_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provided by file.c </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01983">1983</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00265">ast_cli_register_multiple</a>, <a class="el" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type()</a>, <a class="el" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type()</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00019">ast_register_cleanup()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01976">file_shutdown()</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l01501">STASIS_MESSAGE_TYPE_INIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d03/asterisk_8c_source.html#l03947">asterisk_daemon()</a>.</p>
<div class="fragment"><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;{</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a>);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a>);</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(<a class="code" href="../../d6/d13/file_8c.html#abaef9acc752363813eb89bb0b72721a7">cli_file</a>, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d6/d13/file_8c.html#abaef9acc752363813eb89bb0b72721a7">cli_file</a>));</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d6/d13/file_8c.html#a4af69640cb6edeb12525ed8a85e26ca4">file_shutdown</a>);</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="file_8c_html_abaef9acc752363813eb89bb0b72721a7"><div class="ttname"><a href="../../d6/d13/file_8c.html#abaef9acc752363813eb89bb0b72721a7">cli_file</a></div><div class="ttdeci">static struct ast_cli_entry cli_file[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01972">file.c:1972</a></div></div>
<div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="file_8c_html_a4af69640cb6edeb12525ed8a85e26ca4"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4af69640cb6edeb12525ed8a85e26ca4">file_shutdown</a></div><div class="ttdeci">static void file_shutdown(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01976">file.c:1976</a></div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="format_8h_html_a10e266850ef68354d61ff7207c62781b"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a></div><div class="ttdeci">struct stasis_message_type * ast_format_unregister_type(void)</div><div class="ttdoc">Get the message type used for signaling a format unregistration. </div></div>
<div class="ttc" id="format_8h_html_a50026f039eb9220ff618fa7a4f3a1da1"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a></div><div class="ttdeci">struct stasis_message_type * ast_format_register_type(void)</div><div class="ttdoc">Get the message type used for signaling a format registration. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a650841bb643208a8541172297dba1d99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a650841bb643208a8541172297dba1d99">&#9670;&nbsp;</a></span>ast_file_read_dirs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_file_read_dirs </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dir_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d4d/file_8h.html#a616155d421abde65671e234068f5d434">ast_file_on_file</a>&#160;</td>
          <td class="paramname"><em>on_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_depth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recursively iterate through files and directories up to max_depth. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dir_name</td><td>the name of the directory to search </td></tr>
    <tr><td class="paramname">on_file</td><td>callback called on each file </td></tr>
    <tr><td class="paramname">obj</td><td>user data object </td></tr>
    <tr><td class="paramname">max_depth</td><td>re-curse into sub-directories up to a given maximum (-1 = infinite) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 or errno on failure, otherwise 0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01231">1231</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l01113">__ast_file_read_dirs()</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00187">ast_mutex_lock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00188">ast_mutex_unlock</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01228">read_dirs_lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfe/media__index_8c_source.html#l00587">ast_media_index_update_for_file()</a>, <a class="el" href="../../d0/dd5/test__file_8c_source.html#l00136">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/d96/loader_8c_source.html#l01361">module_load_helper()</a>, and <a class="el" href="../../d3/d74/stored_8c_source.html#l00290">stasis_app_stored_recording_find_all()</a>.</p>
<div class="fragment"><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;{</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> = 0;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="preprocessor">#if !defined(__GLIBC__)</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../d6/d13/file_8c.html#a9c3cc651725e456bc129d10e1f10271e">read_dirs_lock</a>);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#aa10f8e4185198079a0cecf2278e9144a">__ast_file_read_dirs</a>(dir_name, on_file, obj, max_depth);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="preprocessor">#if !defined(__GLIBC__)</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../d6/d13/file_8c.html#a9c3cc651725e456bc129d10e1f10271e">read_dirs_lock</a>);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div><div class="ttc" id="file_8c_html_a9c3cc651725e456bc129d10e1f10271e"><div class="ttname"><a href="../../d6/d13/file_8c.html#a9c3cc651725e456bc129d10e1f10271e">read_dirs_lock</a></div><div class="ttdeci">static ast_mutex_t read_dirs_lock</div><div class="ttdoc">Lock to hold when iterating over directories. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01228">file.c:1228</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="file_8c_html_aa10f8e4185198079a0cecf2278e9144a"><div class="ttname"><a href="../../d6/d13/file_8c.html#aa10f8e4185198079a0cecf2278e9144a">__ast_file_read_dirs</a></div><div class="ttdeci">static int __ast_file_read_dirs(const char *path, ast_file_on_file on_file, void *obj, int max_depth)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01113">file.c:1113</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af927e220efdaacab3041f5046ea2973b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af927e220efdaacab3041f5046ea2973b">&#9670;&nbsp;</a></span>ast_filecopy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_filecopy </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>oldname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>newname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oldname</td><td>name of the file you wish to copy (minus extension) </td></tr>
    <tr><td class="paramname">newname</td><td>name you wish the file to be copied to (minus extension) </td></tr>
    <tr><td class="paramname">fmt</td><td>the format of the file Copy a given file in a given format, or if fmt is NULL, then do so for all </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01108">1108</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00500">ACTION_COPY</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l04694">copy_plain_file()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>, and <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l07948">vm_forwardoptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;{</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a>(filename, filename2, fmt, <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;}</div><div class="ttc" id="file_8c_html_a083568a210b02e2a6985923817b6e4dc"><div class="ttname"><a href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a></div><div class="ttdeci">static int filehelper(const char *filename, const void *arg2, const char *fmt, const enum file_action action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00514">file.c:514</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00500">file.c:500</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb15d6efecc1a13b8835bee6d3562ddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb15d6efecc1a13b8835bee6d3562ddb">&#9670;&nbsp;</a></span>ast_filedelete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_filedelete </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>name of the file you wish to delete (minus the extension) </td></tr>
    <tr><td class="paramname">fmt</td><td>of the file Delete a given file in a given format, or if fmt is NULL, then do so for all </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01098">1098</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00497">ACTION_DELETE</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02615">announce_thread()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00305">ast_monitor_start()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00461">ast_monitor_stop()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02480">async_delete_name_rec_task()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02331">conf_free()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02399">conf_rec_name()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02544">confbridge_exec()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02254">dial_exec_full()</a>, <a class="el" href="../../d0/ddd/res__convert_8c_source.html#l00064">handle_cli_file_convert()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01912">leave_voicemail()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08843">play_message()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l15504">play_record_review()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../d8/d4c/res__stasis__recording_8c_source.html#l00519">recording_cancel()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02075">setup_privacy_args()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l01928">valid_priv_reply()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l02021">vm_allocate_dh()</a>, and <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01630">vm_delete()</a>.</p>
<div class="fragment"><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;{</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a>(filename, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, fmt, <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904">ACTION_DELETE</a>);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div><div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904">ACTION_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00497">file.c:497</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="file_8c_html_a083568a210b02e2a6985923817b6e4dc"><div class="ttname"><a href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a></div><div class="ttdeci">static int filehelper(const char *filename, const void *arg2, const char *fmt, const enum file_action action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00514">file.c:514</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9b8ab8e5ee34c9b4da25779255cafde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9b8ab8e5ee34c9b4da25779255cafde">&#9670;&nbsp;</a></span>ast_fileexists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_fileexists </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>preflang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks for the existence of a given file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>name of the file you wish to check, minus the extension </td></tr>
    <tr><td class="paramname">fmt</td><td>the format you wish to check (the extension) </td></tr>
    <tr><td class="paramname">preflang</td><td>(the preferred language you wisht to find the file in) See if a given file exists in a given format. If fmt is NULL, any format is accepted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0,false.</td><td>The file does not exist </td></tr>
    <tr><td class="paramname">1,true.</td><td>The file does exist. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01086">1086</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00706">fileexists_core()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02615">announce_thread()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l01339">app_exec()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00063">ast_get_character_str()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00294">ast_get_digit_str()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00195">ast_get_phonetic_str()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00313">ast_moh_files_next()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00305">ast_monitor_start()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00461">ast_monitor_stop()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l14480">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d04/app__chanspy_8c_source.html#l00892">common_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02254">dial_exec_full()</a>, <a class="el" href="../../de/d26/app__externalivr_8c_source.html#l00624">eivr_comm()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08269">forward_message()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l07819">get_folder()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01573">invent_message()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01912">leave_voicemail()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02966">meetme_menu_admin_extended()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l02458">minivm_delete_exec()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>, <a class="el" href="../../d3/da4/app__page_8c_source.html#l00250">page_exec()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l03916">play_file()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08843">play_message()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l11359">play_message_by_id_helper()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08716">play_message_callerid()</a>, <a class="el" href="../../d2/de3/app__readexten_8c_source.html#l00119">readexten_exec()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l03434">retrydial_exec()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l14359">sayname()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02075">setup_privacy_args()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l00966">sound_file_exists()</a>, <a class="el" href="../../d8/d4c/res__stasis__recording_8c_source.html#l00370">stasis_app_control_record()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l01928">valid_priv_reply()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l02021">vm_allocate_dh()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l10361">vm_intro()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l16487">vm_msg_play()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l10646">vm_newuser_setup()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l10744">vm_options()</a>, and <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l10888">vm_tempgreeting()</a>.</p>
<div class="fragment"><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;{</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   <span class="keywordtype">int</span> buflen;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;   <span class="keywordflow">if</span> (preflang == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      preflang = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;   buflen = strlen(preflang) + strlen(filename) + 4;  <span class="comment">/* room for everything */</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   buf = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(buflen);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#acbaf6de590d8e1505c484b44d278e4f8">fileexists_core</a>(filename, fmt, preflang, buf, buflen, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) ? 1 : 0;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="file_8c_html_acbaf6de590d8e1505c484b44d278e4f8"><div class="ttname"><a href="../../d6/d13/file_8c.html#acbaf6de590d8e1505c484b44d278e4f8">fileexists_core</a></div><div class="ttdeci">static int fileexists_core(const char *filename, const char *fmt, const char *preflang, char *buf, int buflen, struct ast_format_cap *result_cap)</div><div class="ttdoc">helper routine to locate a file with a given format and language preference. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00706">file.c:706</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a846dc319b598ef3f0ae9b0c6152e27ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a846dc319b598ef3f0ae9b0c6152e27ba">&#9670;&nbsp;</a></span>ast_filerename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_filerename </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>oldname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>newname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renames a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oldname</td><td>the name of the file you wish to act upon (minus the extension) </td></tr>
    <tr><td class="paramname">newname</td><td>the name you wish to rename the file to (minus the extension) </td></tr>
    <tr><td class="paramname">fmt</td><td>the format of the file Rename a given file in a given format, or if fmt is NULL, then do so for all </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01103">1103</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00498">ACTION_RENAME</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00461">ast_monitor_stop()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08269">forward_message()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06601">leave_voicemail()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l15504">play_record_review()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l04554">rename_file()</a>, and <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l07948">vm_forwardoptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;{</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a>(filename, filename2, fmt, <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6">ACTION_RENAME</a>);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;}</div><div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6">ACTION_RENAME</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00498">file.c:498</a></div></div>
<div class="ttc" id="file_8c_html_a083568a210b02e2a6985923817b6e4dc"><div class="ttname"><a href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a></div><div class="ttdeci">static int filehelper(const char *filename, const void *arg2, const char *fmt, const enum file_action action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00514">file.c:514</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a484fd6f9417793f9e1d67d3bb6067b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a484fd6f9417793f9e1d67d3bb6067b0f">&#9670;&nbsp;</a></span>ast_format_def_unregister()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_format_def_unregister </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregisters a file format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>the name of the format you wish to unregister Unregisters a format based on the name of the format. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on failure to unregister </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00162">162</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00569">AST_RWLIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00544">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00616">AST_RWLIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00051">AST_RWLIST_WRLOCK</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00093">publish_format_update()</a>, and <a class="el" href="../../de/d1e/bt__open_8c_source.html#l00389">tmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d44/format__g719_8c_source.html#l00148">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, tmp, <a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, tmp-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>)) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(<a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         <a class="code" href="../../d6/d13/file_8c.html#adda6674956dbac7a613967194e4b26e7">publish_format_update</a>(tmp, <a class="code" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a>());</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tmp);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         res = 0;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordflow">if</span> (!res)</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Unregistered format %s\n&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Tried to unregister format %s, already unregistered\n&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="format_8h_html_a10e266850ef68354d61ff7207c62781b"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a></div><div class="ttdeci">struct stasis_message_type * ast_format_unregister_type(void)</div><div class="ttdoc">Get the message type used for signaling a format unregistration. </div></div>
<div class="ttc" id="linkedlists_8h_html_a02212548652c9eb0f3db38dc4e4bd285"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00569">linkedlists.h:569</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="file_8c_html_adda6674956dbac7a613967194e4b26e7"><div class="ttname"><a href="../../d6/d13/file_8c.html#adda6674956dbac7a613967194e4b26e7">publish_format_update</a></div><div class="ttdeci">static int publish_format_update(const struct ast_format_def *f, struct stasis_message_type *type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00093">file.c:93</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa526fd9bb57d7d9afac2113c30d236f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa526fd9bb57d7d9afac2113c30d236f8">&#9670;&nbsp;</a></span>ast_format_str_reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* ast_format_str_reduce </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>fmts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove duplicate formats from a format string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fmts</td><td>a format string, this string will be modified </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a pointer to the reduced format string, this is a pointer to fmts </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01826">1826</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d2/d4d/file_8h_source.html#l00044">AST_MAX_FORMATS</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00351">exts_compare</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01092">first</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l13680">actual_load_config()</a>, and <a class="el" href="../../d8/d4b/test__ast__format__str__reduce_8c_source.html#l00077">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;{</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *fmts_ptr[<a class="code" href="../../d2/d4d/file_8h.html#aa932272aad0c1610b79e9b04e54e57ea">AST_MAX_FORMATS</a>];</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;   <span class="keywordtype">char</span> *fmts_str[<a class="code" href="../../d2/d4d/file_8h.html#aa932272aad0c1610b79e9b04e54e57ea">AST_MAX_FORMATS</a>];</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;   <span class="keywordtype">char</span> *stringp, *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   <span class="keywordtype">char</span> *orig = fmts;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   <span class="keywordtype">int</span> i, j, x, <a class="code" href="../../df/d44/app__meetme_8c.html#a18b6f1cf748d864dd085819a7d4e6680">first</a>, found = 0;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = strlen(fmts) + 1;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>)) {</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to lock format list\n&quot;</span>);</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;   }</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;   stringp = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(fmts);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;   <span class="keywordflow">for</span> (x = 0; (type = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;stringp, <span class="stringliteral">&quot;|&quot;</span>)) &amp;&amp; x &lt; <a class="code" href="../../d2/d4d/file_8h.html#aa932272aad0c1610b79e9b04e54e57ea">AST_MAX_FORMATS</a>; x++) {</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, f, <a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>) {</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>, type)) {</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            found = 1;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;         }</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      }</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      fmts_str[x] = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordflow">if</span> (found) {</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;         fmts_ptr[x] = f;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;         fmts_ptr[x] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      }</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;   }</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   first = 1;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; x; i++) {</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="comment">/* ignore invalid entries */</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="keywordflow">if</span> (!fmts_ptr[i]) {</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;ignoring unknown format &#39;%s&#39;\n&quot;</span>, fmts_str[i]);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      }</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      <span class="comment">/* special handling for the first entry */</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keywordflow">if</span> (first) {</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;         res = snprintf(fmts, len, <span class="stringliteral">&quot;%s&quot;</span>, fmts_str[i]);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;         fmts += res;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;         len -= res;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;         first = 0;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      }</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      found = 0;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; i; j++) {</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;         <span class="comment">/* this is a duplicate */</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;         <span class="keywordflow">if</span> (fmts_ptr[j] == fmts_ptr[i]) {</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            found = 1;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;         }</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      }</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;         res = snprintf(fmts, len, <span class="stringliteral">&quot;|%s&quot;</span>, fmts_str[i]);</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;         fmts += res;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;         len -= res;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      }</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;   }</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;   <span class="keywordflow">if</span> (first) {</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;no known formats found in format list (%s)\n&quot;</span>, orig);</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;   }</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;   <span class="keywordflow">return</span> orig;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="file_8c_html_ad60e6b6fb8b8078dc9e4deda4ffbde10"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a></div><div class="ttdeci">#define exts_compare(list, type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00351">file.c:351</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="app__meetme_8c_html_a18b6f1cf748d864dd085819a7d4e6680"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#a18b6f1cf748d864dd085819a7d4e6680">first</a></div><div class="ttdeci">struct sla_ringing_trunk * first</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01092">app_meetme.c:1092</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="file_8h_html_aa932272aad0c1610b79e9b04e54e57ea"><div class="ttname"><a href="../../d2/d4d/file_8h.html#aa932272aad0c1610b79e9b04e54e57ea">AST_MAX_FORMATS</a></div><div class="ttdeci">#define AST_MAX_FORMATS</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00044">file.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96cb704a3da3fbee98696c7a89850a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96cb704a3da3fbee98696c7a89850a37">&#9670;&nbsp;</a></span>ast_fsread_audio()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_fsread_audio </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00962">962</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l01007">ast_fsread_video()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00914">ast_readaudio_callback()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00908">FSREAD_SUCCESS_SCHED</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00914">ast_readaudio_callback()</a>.</p>
<div class="fragment"><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;{</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs = (<span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *)data;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a> res;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#aa6782e0130a721c4eeb51d2d10d791f8">ast_readaudio_callback</a>(fs);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="keywordflow">if</span> (res == <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a>)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;}</div><div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a></div><div class="ttdeci">fsread_res</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00906">file.c:906</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="file_8c_html_aa6782e0130a721c4eeb51d2d10d791f8"><div class="ttname"><a href="../../d6/d13/file_8c.html#aa6782e0130a721c4eeb51d2d10d791f8">ast_readaudio_callback</a></div><div class="ttdeci">static enum fsread_res ast_readaudio_callback(struct ast_filestream *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00914">file.c:914</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00908">file.c:908</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a9125b21f4ad00a14edbbfeaebace35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a9125b21f4ad00a14edbbfeaebace35">&#9670;&nbsp;</a></span>ast_fsread_video()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ast_fsread_video </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01007">1007</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00977">ast_readvideo_callback()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00908">FSREAD_SUCCESS_SCHED</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00962">ast_fsread_audio()</a>.</p>
<div class="fragment"><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;{</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs = (<span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *)data;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a> res;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#af8b623c146b07dbc4a96be4d8adbcfc4">ast_readvideo_callback</a>(fs);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   <span class="keywordflow">if</span> (res == <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a>)</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;}</div><div class="ttc" id="file_8c_html_af8b623c146b07dbc4a96be4d8adbcfc4"><div class="ttname"><a href="../../d6/d13/file_8c.html#af8b623c146b07dbc4a96be4d8adbcfc4">ast_readvideo_callback</a></div><div class="ttdeci">static enum fsread_res ast_readvideo_callback(struct ast_filestream *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00977">file.c:977</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a></div><div class="ttdeci">fsread_res</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00906">file.c:906</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00908">file.c:908</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acdec85bd5a62872c437b223d62e616fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdec85bd5a62872c437b223d62e616fa">&#9670;&nbsp;</a></span>ast_get_extension_for_mime_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_get_extension_for_mime_type </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>mime_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>capacity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a suitable filename extension for the given MIME type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mime_type</td><td>The MIME type for which to find extensions </td></tr>
    <tr><td class="paramname">buffer</td><td>A pointer to a buffer to receive the extension </td></tr>
    <tr><td class="paramname">capacity</td><td>The size of 'buffer' in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if an extension was found for the provided MIME type </td></tr>
    <tr><td class="paramname">0</td><td>if the MIME type was not found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01951">1951</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00069">formats::lock</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00047">ast_format_def::mime_types</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00592">SCOPED_RDLOCK</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00338">type_in_list()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00150">bucket_file_update_path()</a>.</p>
<div class="fragment"><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;{</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#aa65b589fd265c905f3682c118f1e02d8">SCOPED_RDLOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>.<a class="code" href="../../df/d8d/structformats.html#ace4e0066a5b24f84b90536e9906619f6">lock</a>);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(buffer &amp;&amp; capacity);</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, f, <a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>) {</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#a83eba7ef51aed9cd2463a650e497e359">type_in_list</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#aa2e3f2c7460ba018b1b608f5b819a2e2">mime_types</a>, mime_type, strcasecmp)) {</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;         <span class="keywordtype">size_t</span> item_len = strcspn(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>, <span class="stringliteral">&quot;|&quot;</span>);</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;         <span class="keywordtype">size_t</span> bytes_written = snprintf(buffer, capacity, <span class="stringliteral">&quot;.%.*s&quot;</span>, (<span class="keywordtype">int</span>) item_len, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;         <span class="keywordflow">if</span> (bytes_written &lt; capacity) {</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            <span class="comment">/* Only return success if we didn&#39;t truncate */</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;         }</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      }</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;   }</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structformats_html_ace4e0066a5b24f84b90536e9906619f6"><div class="ttname"><a href="../../df/d8d/structformats.html#ace4e0066a5b24f84b90536e9906619f6">formats::lock</a></div><div class="ttdeci">ast_rwlock_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="lock_8h_html_aa65b589fd265c905f3682c118f1e02d8"><div class="ttname"><a href="../../dd/d42/lock_8h.html#aa65b589fd265c905f3682c118f1e02d8">SCOPED_RDLOCK</a></div><div class="ttdeci">#define SCOPED_RDLOCK(varname, lock)</div><div class="ttdoc">scoped lock specialization for read locks </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00592">lock.h:592</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__format__def_html_aa2e3f2c7460ba018b1b608f5b819a2e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#aa2e3f2c7460ba018b1b608f5b819a2e2">ast_format_def::mime_types</a></div><div class="ttdeci">char mime_types[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00047">mod_format.h:47</a></div></div>
<div class="ttc" id="file_8c_html_a83eba7ef51aed9cd2463a650e497e359"><div class="ttname"><a href="../../d6/d13/file_8c.html#a83eba7ef51aed9cd2463a650e497e359">type_in_list</a></div><div class="ttdeci">static int type_in_list(const char *list, const char *type, int(*cmp)(const char *s1, const char *s2))</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00338">file.c:338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45a9a43d68a284ce9d8467ec9400660c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45a9a43d68a284ce9d8467ec9400660c">&#9670;&nbsp;</a></span>ast_get_format_for_file_ext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a>* ast_get_format_for_file_ext </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file_ext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the <a class="el" href="../../d0/d98/structast__format.html" title="Definition of a media format. ">ast_format</a> associated with the given file extension. </p>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_ext</td><td>The file extension for which to find the format</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if not found </td></tr>
    <tr><td class="paramname">A</td><td>pointer to the <a class="el" href="../../d0/d98/structast__format.html" title="Definition of a media format. ">ast_format</a> associated with this file extension </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01938">1938</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00351">exts_compare</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00069">formats::lock</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../dd/d42/lock_8h_source.html#l00592">SCOPED_RDLOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d0b/resource__bridges_8c_source.html#l00634">ast_ari_bridges_record()</a>, <a class="el" href="../../da/d49/resource__channels_8c_source.html#l00748">ast_ari_channels_record()</a>, <a class="el" href="../../d6/d1b/resource__recordings_8c_source.html#l00101">ast_ari_recordings_get_stored_file()</a>, <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00150">bucket_file_update_path()</a>, <a class="el" href="../../d3/d74/stored_8c_source.html#l00135">is_recording()</a>, and <a class="el" href="../../de/dfe/media__index_8c_source.html#l00346">process_media_file()</a>.</p>
<div class="fragment"><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;{</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#aa65b589fd265c905f3682c118f1e02d8">SCOPED_RDLOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, &amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>.<a class="code" href="../../df/d8d/structformats.html#ace4e0066a5b24f84b90536e9906619f6">lock</a>);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, f, <a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>) {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>, file_ext)) {</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;         <span class="keywordflow">return</span> f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      }</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;   }</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="file_8c_html_ad60e6b6fb8b8078dc9e4deda4ffbde10"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a></div><div class="ttdeci">#define exts_compare(list, type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00351">file.c:351</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structformats_html_ace4e0066a5b24f84b90536e9906619f6"><div class="ttname"><a href="../../df/d8d/structformats.html#ace4e0066a5b24f84b90536e9906619f6">formats::lock</a></div><div class="ttdeci">ast_rwlock_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="lock_8h_html_aa65b589fd265c905f3682c118f1e02d8"><div class="ttname"><a href="../../dd/d42/lock_8h.html#aa65b589fd265c905f3682c118f1e02d8">SCOPED_RDLOCK</a></div><div class="ttdeci">#define SCOPED_RDLOCK(varname, lock)</div><div class="ttdoc">scoped lock specialization for read locks </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00592">lock.h:592</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad85c951fa1d6988d2d7e169833a951a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad85c951fa1d6988d2d7e169833a951a8">&#9670;&nbsp;</a></span>ast_openstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a>* ast_openstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>preflang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens stream for use in seeking, playing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chan</td><td>channel to work with </td></tr>
    <tr><td class="paramname">filename</td><td>to use </td></tr>
    <tr><td class="paramname">preflang</td><td>prefered language to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">a</td><td><a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> pointer if it opens the file. </td></tr>
    <tr><td class="paramname">NULL</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00755">755</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00760">ast_openstream_full()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01250">ast_streamfile()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00087">dictate_exec()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>, and <a class="el" href="../../d4/d5b/app__speech__utils_8c_source.html#l00676">speech_streamfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;{</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#ae2d6dfeafd18a99d47195178cd752a3d">ast_openstream_full</a>(chan, filename, preflang, 0);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;}</div><div class="ttc" id="file_8c_html_ae2d6dfeafd18a99d47195178cd752a3d"><div class="ttname"><a href="../../d6/d13/file_8c.html#ae2d6dfeafd18a99d47195178cd752a3d">ast_openstream_full</a></div><div class="ttdeci">struct ast_filestream * ast_openstream_full(struct ast_channel *chan, const char *filename, const char *preflang, int asis)</div><div class="ttdoc">Opens stream for use in seeking, playing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00760">file.c:760</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2d6dfeafd18a99d47195178cd752a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2d6dfeafd18a99d47195178cd752a3d">&#9670;&nbsp;</a></span>ast_openstream_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a>* ast_openstream_full </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>preflang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>asis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens stream for use in seeking, playing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chan</td><td>channel to work with </td></tr>
    <tr><td class="paramname">filename</td><td>to use </td></tr>
    <tr><td class="paramname">preflang</td><td>prefered language to use </td></tr>
    <tr><td class="paramname">asis</td><td>if set, don't clear generators </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">a</td><td><a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> pointer if it opens the file. </td></tr>
    <tr><td class="paramname">NULL</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00760">760</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00499">ACTION_OPEN</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00713">ast_channel_generator()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00824">ast_channel_set_oldwriteformat()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00621">ast_channel_stream()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00860">ast_channel_writeformat()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02902">ast_deactivate_generator()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00615">ast_format_cap_has_type()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05908">ast_set_write_format_from_cap()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00187">ast_stopstream()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00706">fileexists_core()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00313">ast_moh_files_next()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00755">ast_openstream()</a>, and <a class="el" href="../../de/d26/app__externalivr_8c_source.html#l00207">gen_nextfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;{</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">    * Use fileexists_core() to find a file in a compatible</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">    * language and format, set up a suitable translator,</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">    * and open the stream.</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *file_fmt_cap;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="keywordtype">int</span> buflen;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="keywordflow">if</span> (!asis) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <span class="comment">/* do this first, otherwise we detect the wrong writeformat */</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <a class="code" href="../../d6/d13/file_8c.html#a2f0d358c02e7a6cbe06d4b67237aca3d">ast_stopstream</a>(chan);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a6fa8e680c963b66575d1950c19493b40">ast_channel_generator</a>(chan))</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7160355005776732fba88cc020f4a45b">ast_deactivate_generator</a>(chan);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">if</span> (preflang == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      preflang = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   buflen = strlen(preflang) + strlen(filename) + 4;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   buf = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(buflen);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <span class="keywordflow">if</span> (!(file_fmt_cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>))) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   }</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d13/file_8c.html#acbaf6de590d8e1505c484b44d278e4f8">fileexists_core</a>(filename, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, preflang, buf, buflen, file_fmt_cap) ||</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      !<a class="code" href="../../d0/d3c/format__cap_8h.html#a9b2d6490b222d436f5f6a8296d36c13f">ast_format_cap_has_type</a>(file_fmt_cap, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>)) {</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;File %s does not exist in any format\n&quot;</span>, filename);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(file_fmt_cap, -1);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <span class="comment">/* Set the channel to a format we can work with and save off the previous format. */</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a280e1c50d97a83e4e3053dc1fb9597eb">ast_channel_set_oldwriteformat</a>(chan, <a class="code" href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a>(chan));</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="comment">/* Set the channel to the best format that exists for the file. */</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   res = <a class="code" href="../../d5/d7b/channel_8h.html#afdb04fd0ce567dd08bc60949e1ec59b6">ast_set_write_format_from_cap</a>(chan, file_fmt_cap);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   <span class="comment">/* don&#39;t need this anymore now that the channel&#39;s write format is set. */</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(file_fmt_cap, -1);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   <span class="keywordflow">if</span> (res == -1) {  <span class="comment">/* No format available that works with this channel */</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a>(buf, chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a>);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="keywordflow">if</span> (res &gt;= 0)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(chan);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;}</div><div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00499">file.c:499</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="channel_8h_html_a280e1c50d97a83e4e3053dc1fb9597eb"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a280e1c50d97a83e4e3053dc1fb9597eb">ast_channel_set_oldwriteformat</a></div><div class="ttdeci">void ast_channel_set_oldwriteformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00824">channel_internal_api.c:824</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="file_8c_html_acbaf6de590d8e1505c484b44d278e4f8"><div class="ttname"><a href="../../d6/d13/file_8c.html#acbaf6de590d8e1505c484b44d278e4f8">fileexists_core</a></div><div class="ttdeci">static int fileexists_core(const char *filename, const char *fmt, const char *preflang, char *buf, int buflen, struct ast_format_cap *result_cap)</div><div class="ttdoc">helper routine to locate a file with a given format and language preference. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00706">file.c:706</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="channel_8h_html_afdb04fd0ce567dd08bc60949e1ec59b6"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afdb04fd0ce567dd08bc60949e1ec59b6">ast_set_write_format_from_cap</a></div><div class="ttdeci">int ast_set_write_format_from_cap(struct ast_channel *chan, struct ast_format_cap *formats)</div><div class="ttdoc">Sets write format on channel chan Set write format for channel to whichever component of &quot;format&quot; is ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05908">channel.c:5908</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="channel_8h_html_a6fa8e680c963b66575d1950c19493b40"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6fa8e680c963b66575d1950c19493b40">ast_channel_generator</a></div><div class="ttdeci">struct ast_generator * ast_channel_generator(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00713">channel_internal_api.c:713</a></div></div>
<div class="ttc" id="file_8c_html_a083568a210b02e2a6985923817b6e4dc"><div class="ttname"><a href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a></div><div class="ttdeci">static int filehelper(const char *filename, const void *arg2, const char *fmt, const enum file_action action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00514">file.c:514</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="file_8c_html_a2f0d358c02e7a6cbe06d4b67237aca3d"><div class="ttname"><a href="../../d6/d13/file_8c.html#a2f0d358c02e7a6cbe06d4b67237aca3d">ast_stopstream</a></div><div class="ttdeci">int ast_stopstream(struct ast_channel *tmp)</div><div class="ttdoc">Stops a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00187">file.c:187</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="channel_8h_html_a043ef90a065fe177af7b21a6045b6506"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_stream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00621">channel_internal_api.c:621</a></div></div>
<div class="ttc" id="channel_8h_html_a7160355005776732fba88cc020f4a45b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7160355005776732fba88cc020f4a45b">ast_deactivate_generator</a></div><div class="ttdeci">void ast_deactivate_generator(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02902">channel.c:2902</a></div></div>
<div class="ttc" id="channel_8h_html_a1dc625bd14a7875b04bfe0c388858929"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a></div><div class="ttdeci">struct ast_format * ast_channel_writeformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00860">channel_internal_api.c:860</a></div></div>
<div class="ttc" id="format__cap_8h_html_a9b2d6490b222d436f5f6a8296d36c13f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a9b2d6490b222d436f5f6a8296d36c13f">ast_format_cap_has_type</a></div><div class="ttdeci">int ast_format_cap_has_type(const struct ast_format_cap *cap, enum ast_media_type type)</div><div class="ttdoc">Find out if the capabilities structure has any formats of a specific type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00615">format_cap.c:615</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeed49fff2d6008a89f996230988d944d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed49fff2d6008a89f996230988d944d">&#9670;&nbsp;</a></span>ast_openvstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a>* ast_openvstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>preflang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens stream for use in seeking, playing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chan</td><td>channel to work with </td></tr>
    <tr><td class="paramname">filename</td><td>to use </td></tr>
    <tr><td class="paramname">preflang</td><td>prefered language to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">a</td><td><a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> pointer if it opens the file. </td></tr>
    <tr><td class="paramname">NULL</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00812">812</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00499">ACTION_OPEN</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00637">ast_channel_nativeformats()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00629">ast_channel_vstream()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00395">ast_format_cap_count()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00400">ast_format_cap_get_format()</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00615">ast_format_cap_has_type()</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00655">ast_format_cap_iscompatible()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00334">ast_format_get_name()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00354">ast_format_get_type()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00033">AST_MEDIA_TYPE_VIDEO</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00706">fileexists_core()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00102">format</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01250">ast_streamfile()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, and <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;{</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   <span class="comment">/* As above, but for video. But here we don&#39;t have translators</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">    * so we must enforce a format.</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *nativeformats, *tmp_cap;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <span class="keywordtype">int</span> buflen;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <span class="keywordtype">int</span> i, fd;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   <span class="keywordflow">if</span> (preflang == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      preflang = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   buflen = strlen(preflang) + strlen(filename) + 4;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   buf = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(buflen);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   nativeformats = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(chan));</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="comment">/* is the channel capable of video without translation ?*/</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d3c/format__cap_8h.html#a9b2d6490b222d436f5f6a8296d36c13f">ast_format_cap_has_type</a>(nativeformats, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>)) {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(nativeformats);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   }</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="keywordflow">if</span> (!(tmp_cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>))) {</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(nativeformats);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;   }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="comment">/* Video is supported, so see what video formats exist for this file */</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d13/file_8c.html#acbaf6de590d8e1505c484b44d278e4f8">fileexists_core</a>(filename, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, preflang, buf, buflen, tmp_cap)) {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tmp_cap, -1);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(nativeformats);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   }</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   <span class="comment">/* iterate over file formats and pick the first one compatible with the channel&#39;s native formats */</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a>(tmp_cap); ++i) {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d98/structast__format.html">ast_format</a> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a> = <a class="code" href="../../d0/d3c/format__cap_8h.html#a5d2c52e9d892cd7c6488563cf00ba9bc">ast_format_cap_get_format</a>(tmp_cap, i);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(format) != <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>) ||</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;         !<a class="code" href="../../d0/d3c/format__cap_8h.html#a9c9b87b5062c057862aa7d4237db2780">ast_format_cap_iscompatible</a>(nativeformats, tmp_cap)) {</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(format, -1);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      fd = <a class="code" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a>(buf, chan, <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(format), <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">if</span> (fd &gt;= 0) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(format, -1);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tmp_cap, -1);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(nativeformats);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a>(chan);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;File %s has video but couldn&#39;t be opened\n&quot;</span>, filename);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(format, -1);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(tmp_cap, -1);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(nativeformats);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;}</div><div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00499">file.c:499</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="format_8h_html_a0aba6e17ced3e85e838ea097baa5ddc7"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a></div><div class="ttdeci">enum ast_media_type ast_format_get_type(const struct ast_format *format)</div><div class="ttdoc">Get the media type of a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00354">format.c:354</a></div></div>
<div class="ttc" id="channel_8h_html_a8b8f9e299537c8eee7cb67de52f44c8d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_vstream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00629">channel_internal_api.c:629</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="file_8c_html_acbaf6de590d8e1505c484b44d278e4f8"><div class="ttname"><a href="../../d6/d13/file_8c.html#acbaf6de590d8e1505c484b44d278e4f8">fileexists_core</a></div><div class="ttdeci">static int fileexists_core(const char *filename, const char *fmt, const char *preflang, char *buf, int buflen, struct ast_format_cap *result_cap)</div><div class="ttdoc">helper routine to locate a file with a given format and language preference. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00706">file.c:706</a></div></div>
<div class="ttc" id="structast__format_html"><div class="ttname"><a href="../../d0/d98/structast__format.html">ast_format</a></div><div class="ttdoc">Definition of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00043">format.c:43</a></div></div>
<div class="ttc" id="format__cap_8h_html_aefb7d3623f4d8a582168e7aaf509459c"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a></div><div class="ttdeci">size_t ast_format_cap_count(const struct ast_format_cap *cap)</div><div class="ttdoc">Get the number of formats present within the capabilities structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00395">format_cap.c:395</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="file_8c_html_a083568a210b02e2a6985923817b6e4dc"><div class="ttname"><a href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a></div><div class="ttdeci">static int filehelper(const char *filename, const void *arg2, const char *fmt, const enum file_action action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00514">file.c:514</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="channel_8h_html_a4a5bc2ea394aace55ea3809e53365ea9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a></div><div class="ttdeci">struct ast_format_cap * ast_channel_nativeformats(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00637">channel_internal_api.c:637</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="format__cap_8h_html_a5d2c52e9d892cd7c6488563cf00ba9bc"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a5d2c52e9d892cd7c6488563cf00ba9bc">ast_format_cap_get_format</a></div><div class="ttdeci">struct ast_format * ast_format_cap_get_format(const struct ast_format_cap *cap, int position)</div><div class="ttdoc">Get the format at a specific index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00400">format_cap.c:400</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a98f5e70e98f6dc48e3c5ba316066d540"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a></div><div class="ttdeci">static snd_pcm_format_t format</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00102">chan_alsa.c:102</a></div></div>
<div class="ttc" id="format__cap_8h_html_a9b2d6490b222d436f5f6a8296d36c13f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a9b2d6490b222d436f5f6a8296d36c13f">ast_format_cap_has_type</a></div><div class="ttdeci">int ast_format_cap_has_type(const struct ast_format_cap *cap, enum ast_media_type type)</div><div class="ttdoc">Find out if the capabilities structure has any formats of a specific type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00615">format_cap.c:615</a></div></div>
<div class="ttc" id="format__cap_8h_html_a9c9b87b5062c057862aa7d4237db2780"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a9c9b87b5062c057862aa7d4237db2780">ast_format_cap_iscompatible</a></div><div class="ttdeci">int ast_format_cap_iscompatible(const struct ast_format_cap *cap1, const struct ast_format_cap *cap2)</div><div class="ttdoc">Determine if any joint capabilities exist between two capabilities structures. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00655">format_cap.c:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad59224750b8b617f9590b28b88457b14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad59224750b8b617f9590b28b88457b14">&#9670;&nbsp;</a></span>ast_playstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_playstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Play a open stream on a channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>filestream to play </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01026">1026</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/da6/format_8c_source.html#l00354">ast_format_get_type()</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00914">ast_readaudio_callback()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00977">ast_readvideo_callback()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00907">FSREAD_FAILURE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01250">ast_streamfile()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>, and <a class="el" href="../../d4/d5b/app__speech__utils_8c_source.html#l00676">speech_streamfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;{</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a> res;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      res = <a class="code" href="../../d6/d13/file_8c.html#aa6782e0130a721c4eeb51d2d10d791f8">ast_readaudio_callback</a>(s);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      res = <a class="code" href="../../d6/d13/file_8c.html#af8b623c146b07dbc4a96be4d8adbcfc4">ast_readvideo_callback</a>(s);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   <span class="keywordflow">return</span> (res == <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a>) ? -1 : 0;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;}</div><div class="ttc" id="file_8c_html_af8b623c146b07dbc4a96be4d8adbcfc4"><div class="ttname"><a href="../../d6/d13/file_8c.html#af8b623c146b07dbc4a96be4d8adbcfc4">ast_readvideo_callback</a></div><div class="ttdeci">static enum fsread_res ast_readvideo_callback(struct ast_filestream *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00977">file.c:977</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00907">file.c:907</a></div></div>
<div class="ttc" id="format_8h_html_a0aba6e17ced3e85e838ea097baa5ddc7"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a></div><div class="ttdeci">enum ast_media_type ast_format_get_type(const struct ast_format *format)</div><div class="ttdoc">Get the media type of a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00354">format.c:354</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a></div><div class="ttdeci">fsread_res</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00906">file.c:906</a></div></div>
<div class="ttc" id="file_8c_html_aa6782e0130a721c4eeb51d2d10d791f8"><div class="ttname"><a href="../../d6/d13/file_8c.html#aa6782e0130a721c4eeb51d2d10d791f8">ast_readaudio_callback</a></div><div class="ttdeci">static enum fsread_res ast_readaudio_callback(struct ast_filestream *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00914">file.c:914</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4afbcd56a1aaf40eca3827e6d890372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4afbcd56a1aaf40eca3827e6d890372">&#9670;&nbsp;</a></span>ast_ratestream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_ratestream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>fs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the sample rate of the stream's format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>fs to act on </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sample rate in Hz </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01053">1053</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/da6/format_8c_source.html#l00379">ast_format_get_sample_rate()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>.</p>
<div class="fragment"><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;{</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;}</div><div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="format_8h_html_a499e920008f775eebadd958a42e85862"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a></div><div class="ttdeci">unsigned int ast_format_get_sample_rate(const struct ast_format *format)</div><div class="ttdoc">Get the sample rate of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00379">format.c:379</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6782e0130a721c4eeb51d2d10d791f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6782e0130a721c4eeb51d2d10d791f8">&#9670;&nbsp;</a></span>ast_readaudio_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a> ast_readaudio_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00914">914</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00729">ast_channel_sched()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00465">ast_channel_streamid_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00469">ast_channel_timingfd()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00379">ast_format_get_sample_rate()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00962">ast_fsread_audio()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00565">ast_sched_add()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l03189">ast_settimeout()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l03194">ast_settimeout_full()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05189">ast_write()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00907">FSREAD_FAILURE</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00909">FSREAD_SUCCESS_NOSCHED</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00908">FSREAD_SUCCESS_SCHED</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00115">ast_filestream::lasttimeout</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00125">ast_filestream::orig_chan_name</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00116">ast_filestream::owner</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00874">read_frame()</a>, and <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#ade09185c0cf8101fa9e2f25c15041b81">roundf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00962">ast_fsread_audio()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01026">ast_playstream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;{</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;   <span class="keywordtype">int</span> whennext = 0;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   <span class="keywordflow">while</span> (!whennext) {</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *fr;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#afa3ba2491683e48895a1e174f7bd7431">orig_chan_name</a> &amp;&amp; strcasecmp(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#afa3ba2491683e48895a1e174f7bd7431">orig_chan_name</a>)) {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;         <span class="keywordflow">goto</span> return_failure;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      fr = <a class="code" href="../../d6/d13/file_8c.html#a3d11f27997994d366d52d54a084ec944">read_frame</a>(s, &amp;whennext);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">if</span> (!fr <span class="comment">/* stream complete */</span> || <a class="code" href="../../d5/d7b/channel_8h.html#a79c413d51b7135404d5cacf811649a61">ast_write</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, fr) <span class="comment">/* error writing */</span>) {</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         <span class="keywordflow">if</span> (fr) {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Failed to write frame\n&quot;</span>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;         }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;         <span class="keywordflow">goto</span> return_failure;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      }</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <span class="keywordflow">if</span> (fr) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;         <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;   <span class="keywordflow">if</span> (whennext != s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">lasttimeout</a>) {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#aa1a82c77c44469cd524ebb00357f673b">ast_channel_timingfd</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) &gt; -1) {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;         <span class="keywordtype">float</span> samp_rate = (float) <a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rate;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;         rate = (<span class="keywordtype">unsigned</span> int) <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#ade09185c0cf8101fa9e2f25c15041b81">roundf</a>(samp_rate / ((<span class="keywordtype">float</span>) whennext));</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a6644e72f9f643891538eca452ed2993a">ast_settimeout_full</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, rate, <a class="code" href="../../d6/d13/file_8c.html#a96cb704a3da3fbee98696c7a89850a37">ast_fsread_audio</a>, s, 1);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a66789713c3657752cc9f502c4cf1d2ea">ast_channel_streamid_set</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a>(<a class="code" href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), whennext / (<a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) / 1000), <a class="code" href="../../d6/d13/file_8c.html#a96cb704a3da3fbee98696c7a89850a37">ast_fsread_audio</a>, s));</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">lasttimeout</a> = whennext;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674">FSREAD_SUCCESS_NOSCHED</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;return_failure:</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a66789713c3657752cc9f502c4cf1d2ea">ast_channel_streamid_set</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, -1);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abb39926813ff8874f8e453ca04307e53">ast_settimeout</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a>;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;}</div><div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00907">file.c:907</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674">FSREAD_SUCCESS_NOSCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00909">file.c:909</a></div></div>
<div class="ttc" id="channel_8h_html_a6644e72f9f643891538eca452ed2993a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6644e72f9f643891538eca452ed2993a">ast_settimeout_full</a></div><div class="ttdeci">int ast_settimeout_full(struct ast_channel *c, unsigned int rate, int(*func)(const void *data), void *data, unsigned int is_ao2_obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l03194">channel.c:3194</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="channel_8h_html_abb39926813ff8874f8e453ca04307e53"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abb39926813ff8874f8e453ca04307e53">ast_settimeout</a></div><div class="ttdeci">int ast_settimeout(struct ast_channel *c, unsigned int rate, int(*func)(const void *data), void *data)</div><div class="ttdoc">Enable or disable timer ticks for a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l03189">channel.c:3189</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__filestream_html_afa3ba2491683e48895a1e174f7bd7431"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#afa3ba2491683e48895a1e174f7bd7431">ast_filestream::orig_chan_name</a></div><div class="ttdeci">const char * orig_chan_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00125">mod_format.h:125</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="channel_8h_html_aa1a82c77c44469cd524ebb00357f673b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa1a82c77c44469cd524ebb00357f673b">ast_channel_timingfd</a></div><div class="ttdeci">int ast_channel_timingfd(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00469">channel_internal_api.c:469</a></div></div>
<div class="ttc" id="channel_8h_html_acd3470664b6a002c9a379a69ddad4cb2"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a></div><div class="ttdeci">struct ast_sched_context * ast_channel_sched(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00729">channel_internal_api.c:729</a></div></div>
<div class="ttc" id="structast__filestream_html_a9241175b397dfd032c4cadbc8c9c2d05"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">ast_filestream::owner</a></div><div class="ttdeci">struct ast_channel * owner</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00116">mod_format.h:116</a></div></div>
<div class="ttc" id="channel_8h_html_a66789713c3657752cc9f502c4cf1d2ea"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a66789713c3657752cc9f502c4cf1d2ea">ast_channel_streamid_set</a></div><div class="ttdeci">void ast_channel_streamid_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00465">channel_internal_api.c:465</a></div></div>
<div class="ttc" id="file_8c_html_a3d11f27997994d366d52d54a084ec944"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3d11f27997994d366d52d54a084ec944">read_frame</a></div><div class="ttdeci">static struct ast_frame * read_frame(struct ast_filestream *s, int *whennext)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00874">file.c:874</a></div></div>
<div class="ttc" id="channel_8h_html_a79c413d51b7135404d5cacf811649a61"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a79c413d51b7135404d5cacf811649a61">ast_write</a></div><div class="ttdeci">int ast_write(struct ast_channel *chan, struct ast_frame *frame)</div><div class="ttdoc">Write a frame to a channel This function writes the given frame to the indicated channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05189">channel.c:5189</a></div></div>
<div class="ttc" id="structast__filestream_html_a486275f508390f690dcd44b31e4d0e87"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">ast_filestream::lasttimeout</a></div><div class="ttdeci">int lasttimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00115">mod_format.h:115</a></div></div>
<div class="ttc" id="sched_8h_html_a7a43dcf8be6b2ed7f96f3867fbcb4082"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a></div><div class="ttdeci">int ast_sched_add(struct ast_sched_context *con, int when, ast_sched_cb callback, const void *data) attribute_warn_unused_result</div><div class="ttdoc">Adds a scheduled event. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00565">sched.c:565</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_ade09185c0cf8101fa9e2f25c15041b81"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#ade09185c0cf8101fa9e2f25c15041b81">roundf</a></div><div class="ttdeci">float roundf(float x)</div></div>
<div class="ttc" id="file_8c_html_a96cb704a3da3fbee98696c7a89850a37"><div class="ttname"><a href="../../d6/d13/file_8c.html#a96cb704a3da3fbee98696c7a89850a37">ast_fsread_audio</a></div><div class="ttdeci">static int ast_fsread_audio(const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00962">file.c:962</a></div></div>
<div class="ttc" id="format_8h_html_a499e920008f775eebadd958a42e85862"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a></div><div class="ttdeci">unsigned int ast_format_get_sample_rate(const struct ast_format *format)</div><div class="ttdoc">Get the sample rate of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00379">format.c:379</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00908">file.c:908</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad572060ea434390db3d1ccde4511dfcd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad572060ea434390db3d1ccde4511dfcd">&#9670;&nbsp;</a></span>ast_readfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a>* ast_readfile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts reading from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>the name of the file to read from </td></tr>
    <tr><td class="paramname">type</td><td>format of file you wish to read from </td></tr>
    <tr><td class="paramname">comment</td><td>comment to go with </td></tr>
    <tr><td class="paramname">flags</td><td>file flags </td></tr>
    <tr><td class="paramname">check</td><td>(unimplemented, hence negligible) </td></tr>
    <tr><td class="paramname">mode</td><td>Open mode Open an incoming file stream. flags are flags for the open() command, and if check is non-zero, then it will not read a file if there are any files that start with that name and have an extension Please note, this is a blocking function. Program execution will not return until ast_waitstream completes it's execution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">a</td><td>struct <a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> on success. </td></tr>
    <tr><td class="paramname">NULL</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01309">1309</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l01068">ast_closestream()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00314">build_filename()</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00351">exts_compare</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00117">ast_filestream::f</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00107">ast_filestream::filename</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00104">ast_filestream::flags</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00428">get_filestream()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00105">ast_filestream::mode</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00490">open_wrapper()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00112">ast_filestream::trans</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00110">ast_filestream::vfs</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d0/ddd/res__convert_8c_source.html#l00064">handle_cli_file_convert()</a>, and <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>.</p>
<div class="fragment"><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;{</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;   FILE *bfile;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;   <span class="keywordtype">char</span> *fn;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   <span class="keywordtype">int</span> format_found = 0;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, f, list) {</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      fs = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>))</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;         format_found = 1;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      fn = <a class="code" href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a>(<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keywordflow">if</span> (!fn) {</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      }</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> = 0;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      bfile = fopen(fn, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="keywordflow">if</span> (!bfile || (fs = <a class="code" href="../../d6/d13/file_8c.html#a3e809ea7be0413c527df113a695552b8">get_filestream</a>(f, bfile)) == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../d6/d13/file_8c.html#ac17ab5a9432e8fbe75d7968221897716">open_wrapper</a>(fs) ) {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open %s\n&quot;</span>, fn);</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;         <span class="keywordflow">if</span> (fs) {</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(fs);</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;         }</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;         fs = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;         bfile = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      }</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      <span class="comment">/* found it */</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a> = <a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> = <a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a> = <a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a>;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>);</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;   }</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;   <span class="keywordflow">if</span> (!format_found)</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No such format &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>);</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;   <span class="keywordflow">return</span> fs;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="file_8c_html_ad60e6b6fb8b8078dc9e4deda4ffbde10"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a></div><div class="ttdeci">#define exts_compare(list, type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00351">file.c:351</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="file_8c_html_a3e809ea7be0413c527df113a695552b8"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3e809ea7be0413c527df113a695552b8">get_filestream</a></div><div class="ttdeci">static struct ast_filestream * get_filestream(struct ast_format_def *fmt, FILE *bfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00428">file.c:428</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="file_8c_html_ab53bd2c3c55d509790c7f7620aac6373"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a></div><div class="ttdeci">int ast_closestream(struct ast_filestream *f)</div><div class="ttdoc">Closes a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01068">file.c:1068</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="file_8c_html_ac17ab5a9432e8fbe75d7968221897716"><div class="ttname"><a href="../../d6/d13/file_8c.html#ac17ab5a9432e8fbe75d7968221897716">open_wrapper</a></div><div class="ttdeci">static int open_wrapper(struct ast_filestream *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00490">file.c:490</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="file_8c_html_a2a836416f6627399f3b75ef2705bcd89"><div class="ttname"><a href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a></div><div class="ttdeci">static char * build_filename(const char *filename, const char *ext)</div><div class="ttdoc">construct a filename. Absolute pathnames are preserved, relative names are prefixed by the sounds/ di...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00314">file.c:314</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__filestream_html_ad98134a98f3e3e3b5611a5fd2117e8e4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">ast_filestream::trans</a></div><div class="ttdeci">struct ast_trans_pvt * trans</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00112">mod_format.h:112</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__filestream_html_aeac90097f29f7529968697163cea5c18"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">ast_filestream::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00107">mod_format.h:107</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="structast__filestream_html_a3efb0e1a16208deecbd84c15401f7cf8"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">ast_filestream::f</a></div><div class="ttdeci">FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00117">mod_format.h:117</a></div></div>
<div class="ttc" id="structast__filestream_html_a084d8f087c50442f51245ec3333abac4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">ast_filestream::vfs</a></div><div class="ttdeci">struct ast_filestream * vfs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00110">mod_format.h:110</a></div></div>
<div class="ttc" id="structast__filestream_html_adc8d3cf511ceb277aea0cfa1cd027c59"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">ast_filestream::mode</a></div><div class="ttdeci">mode_t mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00105">mod_format.h:105</a></div></div>
<div class="ttc" id="structast__filestream_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">ast_filestream::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00104">mod_format.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a962bc31d7a953b0a0290c72b168d41a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a962bc31d7a953b0a0290c72b168d41a7">&#9670;&nbsp;</a></span>ast_readframe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a>* ast_readframe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a frame from a filestream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td><a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> to act on </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a frame. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if read failed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00899">899</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00874">read_frame()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00087">dictate_exec()</a>, <a class="el" href="../../de/d26/app__externalivr_8c_source.html#l00241">gen_readframe()</a>, <a class="el" href="../../d0/ddd/res__convert_8c_source.html#l00064">handle_cli_file_convert()</a>, and <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00409">moh_files_readframe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;{</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   <span class="keywordtype">int</span> whennext = 0;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a3d11f27997994d366d52d54a084ec944">read_frame</a>(s, &amp;whennext);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;}</div><div class="ttc" id="file_8c_html_a3d11f27997994d366d52d54a084ec944"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3d11f27997994d366d52d54a084ec944">read_frame</a></div><div class="ttdeci">static struct ast_frame * read_frame(struct ast_filestream *s, int *whennext)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00874">file.c:874</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af8b623c146b07dbc4a96be4d8adbcfc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b623c146b07dbc4a96be4d8adbcfc4">&#9670;&nbsp;</a></span>ast_readvideo_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7">fsread_res</a> ast_readvideo_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00977">977</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00729">ast_channel_sched()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00497">ast_channel_vstreamid_set()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00379">ast_format_get_sample_rate()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00565">ast_sched_add()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05189">ast_write()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00907">FSREAD_FAILURE</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00909">FSREAD_SUCCESS_NOSCHED</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00908">FSREAD_SUCCESS_SCHED</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00115">ast_filestream::lasttimeout</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00116">ast_filestream::owner</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00874">read_frame()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01007">ast_fsread_video()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01026">ast_playstream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;{</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="keywordtype">int</span> whennext = 0;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   <span class="keywordflow">while</span> (!whennext) {</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *fr = <a class="code" href="../../d6/d13/file_8c.html#a3d11f27997994d366d52d54a084ec944">read_frame</a>(s, &amp;whennext);</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="keywordflow">if</span> (!fr <span class="comment">/* stream complete */</span> || <a class="code" href="../../d5/d7b/channel_8h.html#a79c413d51b7135404d5cacf811649a61">ast_write</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, fr) <span class="comment">/* error writing */</span>) {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;         <span class="keywordflow">if</span> (fr) {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Failed to write frame\n&quot;</span>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a58ac5000cfdf1493ae0e8ca02a04faf7">ast_channel_vstreamid_set</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, -1);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordflow">if</span> (fr) {</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;         <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="keywordflow">if</span> (whennext != s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">lasttimeout</a>) {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a58ac5000cfdf1493ae0e8ca02a04faf7">ast_channel_vstreamid_set</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a>(<a class="code" href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), whennext / (<a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) / 1000), <a class="code" href="../../d6/d13/file_8c.html#a3a9125b21f4ad00a14edbbfeaebace35">ast_fsread_video</a>, s));</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">lasttimeout</a> = whennext;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674">FSREAD_SUCCESS_NOSCHED</a>;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;}</div><div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a51689576f6677be835337676977f6d3b">FSREAD_FAILURE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00907">file.c:907</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7aed05dcad19f8741d107494ccf0bd2674">FSREAD_SUCCESS_NOSCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00909">file.c:909</a></div></div>
<div class="ttc" id="file_8c_html_a3a9125b21f4ad00a14edbbfeaebace35"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3a9125b21f4ad00a14edbbfeaebace35">ast_fsread_video</a></div><div class="ttdeci">static int ast_fsread_video(const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01007">file.c:1007</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="channel_8h_html_acd3470664b6a002c9a379a69ddad4cb2"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a></div><div class="ttdeci">struct ast_sched_context * ast_channel_sched(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00729">channel_internal_api.c:729</a></div></div>
<div class="ttc" id="structast__filestream_html_a9241175b397dfd032c4cadbc8c9c2d05"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">ast_filestream::owner</a></div><div class="ttdeci">struct ast_channel * owner</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00116">mod_format.h:116</a></div></div>
<div class="ttc" id="file_8c_html_a3d11f27997994d366d52d54a084ec944"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3d11f27997994d366d52d54a084ec944">read_frame</a></div><div class="ttdeci">static struct ast_frame * read_frame(struct ast_filestream *s, int *whennext)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00874">file.c:874</a></div></div>
<div class="ttc" id="channel_8h_html_a79c413d51b7135404d5cacf811649a61"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a79c413d51b7135404d5cacf811649a61">ast_write</a></div><div class="ttdeci">int ast_write(struct ast_channel *chan, struct ast_frame *frame)</div><div class="ttdoc">Write a frame to a channel This function writes the given frame to the indicated channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05189">channel.c:5189</a></div></div>
<div class="ttc" id="structast__filestream_html_a486275f508390f690dcd44b31e4d0e87"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">ast_filestream::lasttimeout</a></div><div class="ttdeci">int lasttimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00115">mod_format.h:115</a></div></div>
<div class="ttc" id="sched_8h_html_a7a43dcf8be6b2ed7f96f3867fbcb4082"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a7a43dcf8be6b2ed7f96f3867fbcb4082">ast_sched_add</a></div><div class="ttdeci">int ast_sched_add(struct ast_sched_context *con, int when, ast_sched_cb callback, const void *data) attribute_warn_unused_result</div><div class="ttdoc">Adds a scheduled event. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00565">sched.c:565</a></div></div>
<div class="ttc" id="format_8h_html_a499e920008f775eebadd958a42e85862"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a></div><div class="ttdeci">unsigned int ast_format_get_sample_rate(const struct ast_format *format)</div><div class="ttdoc">Get the sample rate of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00379">format.c:379</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="file_8c_html_a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0245c792fdf4fe895383125a79000fa7a949ffc736fc694146f20c7ab3c26b3f5">FSREAD_SUCCESS_SCHED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00908">file.c:908</a></div></div>
<div class="ttc" id="channel_8h_html_a58ac5000cfdf1493ae0e8ca02a04faf7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a58ac5000cfdf1493ae0e8ca02a04faf7">ast_channel_vstreamid_set</a></div><div class="ttdeci">void ast_channel_vstreamid_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00497">channel_internal_api.c:497</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36f6bba05952162d5d1ee7fb9819bd07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36f6bba05952162d5d1ee7fb9819bd07">&#9670;&nbsp;</a></span>ast_seekstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_seekstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>sample_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>whence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Seeks into stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td><a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> to perform seek on </td></tr>
    <tr><td class="paramname">sample_offset</td><td>numbers of samples to seek </td></tr>
    <tr><td class="paramname">whence</td><td>SEEK_SET, SEEK_CUR, SEEK_END </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01038">1038</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00068">ast_format_def::seek</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d28/channel_8c_source.html#l03529">__ast_read()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00313">ast_moh_files_next()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01058">ast_stream_fastforward()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01063">ast_stream_rewind()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01250">ast_streamfile()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05194">ast_write_stream()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01131">control_streamfile()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00087">dictate_exec()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>, and <a class="el" href="../../dd/de9/res__agi_8c_source.html#l03537">speech_streamfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;{</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   <span class="keywordflow">return</span> fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a1327e7030c55bfe870ed79fab26709aa">seek</a>(fs, sample_offset, whence);</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div><div class="ttc" id="structast__format__def_html_a1327e7030c55bfe870ed79fab26709aa"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a1327e7030c55bfe870ed79fab26709aa">ast_format_def::seek</a></div><div class="ttdeci">int(* seek)(struct ast_filestream *, off_t, int)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00068">mod_format.h:68</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f0d358c02e7a6cbe06d4b67237aca3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0d358c02e7a6cbe06d4b67237aca3d">&#9670;&nbsp;</a></span>ast_stopstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_stopstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stops a stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>The channel you wish to stop playback on</td></tr>
  </table>
  </dd>
</dl>
<p>Stop playback of a stream</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>always</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The channel does not need to be locked before calling this function. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00187">187</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00844">ast_channel_oldwriteformat()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00621">ast_channel_stream()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00625">ast_channel_stream_set()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00629">ast_channel_vstream()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00633">ast_channel_vstream_set()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01068">ast_closestream()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00334">ast_format_get_name()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05890">ast_set_write_format()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02951">action_playback_and_continue()</a>, <a class="el" href="../../dd/d27/res__adsi_8c_source.html#l00388">adsi_transmit_message_full()</a>, <a class="el" href="../../de/d11/app__agent__pool_8c_source.html#l01738">agent_alert()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00800">announce_to_dial()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00760">ast_openstream_full()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01470">ast_play_and_wait()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l06660">ast_readstring_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03218">ast_say_enumeration_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03381">ast_say_enumeration_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03101">ast_say_enumeration_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03543">ast_say_enumeration_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03632">ast_say_enumeration_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03198">ast_say_enumeration_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00826">ast_say_number_full_cs()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00924">ast_say_number_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01038">ast_say_number_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00772">ast_say_number_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01172">ast_say_number_full_en_GB()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01251">ast_say_number_full_es()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01355">ast_say_number_full_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08036">ast_say_number_full_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01447">ast_say_number_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01619">ast_say_number_full_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01699">ast_say_number_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01819">ast_say_number_full_it()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08105">ast_say_number_full_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09270">ast_say_number_full_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01974">ast_say_number_full_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02072">ast_say_number_full_no()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02455">ast_say_number_full_pt()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02834">ast_say_number_full_ru()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02555">ast_say_number_full_se()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02913">ast_say_number_full_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02748">ast_say_number_full_ur()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02983">ast_say_number_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02635">ast_say_number_full_zh()</a>, <a class="el" href="../../d3/dba/app__talkdetect_8c_source.html#l00080">background_detect_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l04837">conf_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01131">control_streamfile()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02254">dial_exec_full()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00847">directory_exec()</a>, <a class="el" href="../../d7/d9b/bridge__basic_8c_source.html#l03160">grab_transfer()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l03556">handle_speechrecognize()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>, <a class="el" href="../../da/d8a/app__ices_8c_source.html#l00110">ices_exec()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l02590">ivr_dispatch()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06601">leave_voicemail()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02846">meetme_menu_admin()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02966">meetme_menu_admin_extended()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l02268">minivm_greet_exec()</a>, <a class="el" href="../../d1/d9a/app__mp3_8c_source.html#l00172">mp3_exec()</a>, <a class="el" href="../../df/d1d/app__nbscat_8c_source.html#l00111">NBScat_exec()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01144">pbx_builtin_background()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02184">pl_odtworz_plik()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l00928">play_file()</a>, <a class="el" href="../../d9/d1a/app__skel_8c_source.html#l00369">play_files_helper()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00286">play_mailbox_owner()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00442">playback_exec()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l08183">queue_exec()</a>, <a class="el" href="../../d6/dbb/app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="../../d2/de3/app__readexten_8c_source.html#l00119">readexten_exec()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l05681">recordthread()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00155">s_streamwait3()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00171">say_character_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00339">say_digit_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00430">say_money_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00270">say_phonetic_str_full()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00347">select_item_seq()</a>, <a class="el" href="../../d5/dd6/app__festival_8c_source.html#l00174">send_waveform_to_channel()</a>, <a class="el" href="../../d4/d5b/app__speech__utils_8c_source.html#l00700">speech_background()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l11226">vm_authenticate()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l11503">vm_execmain()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l00644">wait_for_winner()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>, and <a class="el" href="../../d0/d72/app__zapateller_8c_source.html#l00079">zapateller_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(tmp);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="comment">/* Stop a running stream if there is one */</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(tmp)) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(tmp));</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a1460c260bdadfa226b95598a7d9d44a7">ast_channel_stream_set</a>(tmp, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a4b041a81038d686dc438437a05ab2410">ast_channel_oldwriteformat</a>(tmp) &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#abbdfb98077180544657b2d16c5d25f74">ast_set_write_format</a>(tmp, <a class="code" href="../../d5/d7b/channel_8h.html#a4b041a81038d686dc438437a05ab2410">ast_channel_oldwriteformat</a>(tmp)))</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to restore format back to %s\n&quot;</span>, <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4b041a81038d686dc438437a05ab2410">ast_channel_oldwriteformat</a>(tmp)));</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="comment">/* Stop the video stream too */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a>(tmp) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a>(tmp));</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#afafaea2cd08a0d993f5d667f4cfefd9e">ast_channel_vstream_set</a>(tmp, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(tmp);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div><div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="channel_8h_html_a8b8f9e299537c8eee7cb67de52f44c8d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_vstream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00629">channel_internal_api.c:629</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="channel_8h_html_a4b041a81038d686dc438437a05ab2410"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4b041a81038d686dc438437a05ab2410">ast_channel_oldwriteformat</a></div><div class="ttdeci">struct ast_format * ast_channel_oldwriteformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00844">channel_internal_api.c:844</a></div></div>
<div class="ttc" id="channel_8h_html_afafaea2cd08a0d993f5d667f4cfefd9e"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afafaea2cd08a0d993f5d667f4cfefd9e">ast_channel_vstream_set</a></div><div class="ttdeci">void ast_channel_vstream_set(struct ast_channel *chan, struct ast_filestream *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00633">channel_internal_api.c:633</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="file_8c_html_ab53bd2c3c55d509790c7f7620aac6373"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a></div><div class="ttdeci">int ast_closestream(struct ast_filestream *f)</div><div class="ttdoc">Closes a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01068">file.c:1068</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="channel_8h_html_a1460c260bdadfa226b95598a7d9d44a7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1460c260bdadfa226b95598a7d9d44a7">ast_channel_stream_set</a></div><div class="ttdeci">void ast_channel_stream_set(struct ast_channel *chan, struct ast_filestream *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00625">channel_internal_api.c:625</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="channel_8h_html_abbdfb98077180544657b2d16c5d25f74"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abbdfb98077180544657b2d16c5d25f74">ast_set_write_format</a></div><div class="ttdeci">int ast_set_write_format(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdoc">Sets write format on channel chan. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l05890">channel.c:5890</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="channel_8h_html_a043ef90a065fe177af7b21a6045b6506"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_stream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00621">channel_internal_api.c:621</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95b94a020720147325a486e210b36775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95b94a020720147325a486e210b36775">&#9670;&nbsp;</a></span>ast_stream_and_wait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_stream_and_wait </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>digits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stream file until digit If the file name is non-empty, try to play it. </p>
<dl class="section note"><dt>Note</dt><dd>If digits == "" then we can simply check for non-zero. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if success. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">-1</td><td>if error. </td></tr>
    <tr><td class="paramname">digit</td><td>if interrupted by a digit. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01814">1814</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01250">ast_streamfile()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01776">ast_waitstream()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02937">action_playback()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02895">action_toggle_mute_participants()</a>, <a class="el" href="../../de/d11/app__agent__pool_8c_source.html#l01738">agent_alert()</a>, <a class="el" href="../../de/d11/app__agent__pool_8c_source.html#l02112">agent_login_exec()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l00985">announce_user_count()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l01339">app_exec()</a>, <a class="el" href="../../d3/d32/bridge__channel_8c_source.html#l01321">ast_bridge_channel_playfile()</a>, <a class="el" href="../../d9/dbf/pickup_8c_source.html#l00200">ast_pickup_call()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l02489">ast_record_review()</a>, <a class="el" href="../../d2/df4/bridge__builtin__interval__features_8c_source.html#l00051">bridge_features_duration_callback()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02544">confbridge_exec()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00847">directory_exec()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08269">forward_message()</a>, <a class="el" href="../../d7/d9b/bridge__basic_8c_source.html#l03160">grab_transfer()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l05736">invent_message()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l02590">ivr_dispatch()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01679">join_conference_bridge()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06601">leave_voicemail()</a>, <a class="el" href="../../d2/df4/bridge__builtin__interval__features_8c_source.html#l00067">limits_interval_playback()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l00709">mixmonitor_thread()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00545">park_app_exec()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00603">parked_call_app_exec()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l00928">play_file()</a>, <a class="el" href="../../d9/d1a/app__skel_8c_source.html#l00369">play_files_helper()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00286">play_mailbox_owner()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08716">play_message_callerid()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01038">play_prompt_to_user()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01644">play_record_review()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l01923">playback_common()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l14359">sayname()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00347">select_item_seq()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l00868">setup_mixmonitor_ds()</a>, <a class="el" href="../../d7/d9b/bridge__basic_8c_source.html#l01755">stream_failsound()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l07948">vm_forwardoptions()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l14446">vmsayname_exec()</a>, and <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08609">wait_file2()</a>.</p>
<div class="fragment"><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;{</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>)) {</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      res = <a class="code" href="../../d6/d13/file_8c.html#a0e0d3e6f2bebe7f68fd264438e0d2059">ast_streamfile</a>(chan, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a>(chan));</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;         res = <a class="code" href="../../d6/d13/file_8c.html#affc21cb57c6bf72a2cb7ec8a379b2137">ast_waitstream</a>(chan, digits);</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      }</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;   }</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;}</div><div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="file_8c_html_affc21cb57c6bf72a2cb7ec8a379b2137"><div class="ttname"><a href="../../d6/d13/file_8c.html#affc21cb57c6bf72a2cb7ec8a379b2137">ast_waitstream</a></div><div class="ttdeci">int ast_waitstream(struct ast_channel *c, const char *breakon)</div><div class="ttdoc">Waits for a stream to stop or digit to be pressed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01776">file.c:1776</a></div></div>
<div class="ttc" id="file_8c_html_a0e0d3e6f2bebe7f68fd264438e0d2059"><div class="ttname"><a href="../../d6/d13/file_8c.html#a0e0d3e6f2bebe7f68fd264438e0d2059">ast_streamfile</a></div><div class="ttdeci">int ast_streamfile(struct ast_channel *chan, const char *filename, const char *preflang)</div><div class="ttdoc">Streams a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01250">file.c:1250</a></div></div>
<div class="ttc" id="channel_8h_html_a9abe31fe40dcd03cd2957e5309e32ac6"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9abe31fe40dcd03cd2957e5309e32ac6">ast_channel_language</a></div><div class="ttdeci">const char * ast_channel_language(const struct ast_channel *chan)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2137b5da91f3408f86d580952f32e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2137b5da91f3408f86d580952f32e94">&#9670;&nbsp;</a></span>ast_stream_fastforward()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_stream_fastforward </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fast forward stream ms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>filestream to act on </td></tr>
    <tr><td class="paramname">ms</td><td>milliseconds to move </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01058">1058</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l01038">ast_seekstream()</a>, and <a class="el" href="../../db/db2/asterisk_8h_source.html#l00047">DEFAULT_SAMPLES_PER_MS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01509">waitstream_control()</a>.</p>
<div class="fragment"><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;{</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a36f6bba05952162d5d1ee7fb9819bd07">ast_seekstream</a>(fs, ms * <a class="code" href="../../db/db2/asterisk_8h.html#ab2dba0d8b577d63452ed65647bb22a3f">DEFAULT_SAMPLES_PER_MS</a>, SEEK_CUR);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div><div class="ttc" id="file_8c_html_a36f6bba05952162d5d1ee7fb9819bd07"><div class="ttname"><a href="../../d6/d13/file_8c.html#a36f6bba05952162d5d1ee7fb9819bd07">ast_seekstream</a></div><div class="ttdeci">int ast_seekstream(struct ast_filestream *fs, off_t sample_offset, int whence)</div><div class="ttdoc">Seeks into stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01038">file.c:1038</a></div></div>
<div class="ttc" id="asterisk_8h_html_ab2dba0d8b577d63452ed65647bb22a3f"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#ab2dba0d8b577d63452ed65647bb22a3f">DEFAULT_SAMPLES_PER_MS</a></div><div class="ttdeci">#define DEFAULT_SAMPLES_PER_MS</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00047">asterisk.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c7c02a659b09bb06dd63e1f42692666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c7c02a659b09bb06dd63e1f42692666">&#9670;&nbsp;</a></span>ast_stream_rewind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_stream_rewind </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">off_t&#160;</td>
          <td class="paramname"><em>ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rewind stream ms. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>filestream to act on </td></tr>
    <tr><td class="paramname">ms</td><td>milliseconds to move </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01063">1063</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l01038">ast_seekstream()</a>, and <a class="el" href="../../db/db2/asterisk_8h_source.html#l00047">DEFAULT_SAMPLES_PER_MS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01509">waitstream_control()</a>.</p>
<div class="fragment"><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;{</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a36f6bba05952162d5d1ee7fb9819bd07">ast_seekstream</a>(fs, -ms * <a class="code" href="../../db/db2/asterisk_8h.html#ab2dba0d8b577d63452ed65647bb22a3f">DEFAULT_SAMPLES_PER_MS</a>, SEEK_CUR);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;}</div><div class="ttc" id="file_8c_html_a36f6bba05952162d5d1ee7fb9819bd07"><div class="ttname"><a href="../../d6/d13/file_8c.html#a36f6bba05952162d5d1ee7fb9819bd07">ast_seekstream</a></div><div class="ttdeci">int ast_seekstream(struct ast_filestream *fs, off_t sample_offset, int whence)</div><div class="ttdoc">Seeks into stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01038">file.c:1038</a></div></div>
<div class="ttc" id="asterisk_8h_html_ab2dba0d8b577d63452ed65647bb22a3f"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#ab2dba0d8b577d63452ed65647bb22a3f">DEFAULT_SAMPLES_PER_MS</a></div><div class="ttdeci">#define DEFAULT_SAMPLES_PER_MS</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00047">asterisk.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e0d3e6f2bebe7f68fd264438e0d2059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e0d3e6f2bebe7f68fd264438e0d2059">&#9670;&nbsp;</a></span>ast_streamfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_streamfile </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>preflang</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Streams a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>channel to stream the file to </td></tr>
    <tr><td class="paramname">filename</td><td>the name of the file you wish to stream, minus the extension </td></tr>
    <tr><td class="paramname">preflang</td><td>the preferred language you wish to have the file streamed to you in Prepares a channel for the streaming of a file. To start the stream, afterward do a <a class="el" href="../../d2/d4d/file_8h.html#affc21cb57c6bf72a2cb7ec8a379b2137" title="Waits for a stream to stop or digit to be pressed. ">ast_waitstream()</a> on the channel Also, it will stop any existing streams on the channel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01250">1250</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l01020">ast_applystream()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01260">ast_channel_flags()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00637">ast_channel_nativeformats()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00860">ast_channel_writeformat()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l01015">AST_FLAG_MASQ_NOSTREAM</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00736">ast_format_cap_get_names()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00326">AST_FORMAT_CAP_NAMES_LEN</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00334">ast_format_get_name()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00755">ast_openstream()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00812">ast_openvstream()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01026">ast_playstream()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01038">ast_seekstream()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00800">ast_str_alloca</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00063">ast_test_flag</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00117">ast_filestream::f</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00125">ast_filestream::orig_chan_name</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00461">VERBOSITY_ATLEAST</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00110">ast_filestream::vfs</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d09/sig__analog_8c_source.html#l01711">__analog_ss_thread()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02951">action_playback_and_continue()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09512">analog_ss_thread()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02615">announce_thread()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00800">announce_to_dial()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l01339">app_exec()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l00197">ast_app_getdata()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l00250">ast_app_getdata_full()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01470">ast_play_and_wait()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03871">ast_say_date_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03920">ast_say_date_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03842">ast_say_date_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04002">ast_say_date_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08180">ast_say_date_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04123">ast_say_date_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03970">ast_say_date_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04157">ast_say_date_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08216">ast_say_date_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09348">ast_say_date_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04031">ast_say_date_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04060">ast_say_date_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08455">ast_say_date_with_format_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07397">ast_say_datetime_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07493">ast_say_datetime_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07821">ast_say_datetime_from_now_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07859">ast_say_datetime_from_now_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07947">ast_say_datetime_from_now_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09444">ast_say_datetime_from_now_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08355">ast_say_datetime_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07737">ast_say_datetime_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08388">ast_say_datetime_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07534">ast_say_datetime_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07553">ast_say_datetime_pt()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07634">ast_say_datetime_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07677">ast_say_datetime_zh()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03218">ast_say_enumeration_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03381">ast_say_enumeration_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03101">ast_say_enumeration_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03543">ast_say_enumeration_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03632">ast_say_enumeration_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03198">ast_say_enumeration_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00826">ast_say_number_full_cs()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00924">ast_say_number_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01038">ast_say_number_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00772">ast_say_number_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01172">ast_say_number_full_en_GB()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01251">ast_say_number_full_es()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01355">ast_say_number_full_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08036">ast_say_number_full_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01447">ast_say_number_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01619">ast_say_number_full_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01699">ast_say_number_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01819">ast_say_number_full_it()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08105">ast_say_number_full_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09270">ast_say_number_full_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01974">ast_say_number_full_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02072">ast_say_number_full_no()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02455">ast_say_number_full_pt()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02834">ast_say_number_full_ru()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02555">ast_say_number_full_se()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02913">ast_say_number_full_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02748">ast_say_number_full_ur()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02983">ast_say_number_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02635">ast_say_number_full_zh()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07125">ast_say_time_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07076">ast_say_time_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07168">ast_say_time_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08260">ast_say_time_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07145">ast_say_time_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08308">ast_say_time_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09391">ast_say_time_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07187">ast_say_time_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07284">ast_say_time_zh()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01814">ast_stream_and_wait()</a>, <a class="el" href="../../d6/d0f/app__authenticate_8c_source.html#l00116">auth_exec()</a>, <a class="el" href="../../d3/dba/app__talkdetect_8c_source.html#l00080">background_detect_exec()</a>, <a class="el" href="../../dc/d04/app__chanspy_8c_source.html#l00892">common_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l04837">conf_exec()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02350">conf_get_pin()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01131">control_streamfile()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02254">dial_exec_full()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00768">do_directory()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l04500">find_conf_realtime()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l08269">forward_message()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07991">gr_say_number_female()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01573">invent_message()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01912">leave_voicemail()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02846">meetme_menu_admin()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02966">meetme_menu_admin_extended()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02766">meetme_menu_normal()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l02268">minivm_greet_exec()</a>, <a class="el" href="../../d3/da4/app__page_8c_source.html#l00250">page_exec()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01144">pbx_builtin_background()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02184">pl_odtworz_plik()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00078">play_and_wait()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l03916">play_file()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01644">play_record_review()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00442">playback_exec()</a>, <a class="el" href="../../d7/d17/app__privacy_8c_source.html#l00087">privacy_exec()</a>, <a class="el" href="../../d2/de3/app__readexten_8c_source.html#l00119">readexten_exec()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l03434">retrydial_exec()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00155">s_streamwait3()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00171">say_character_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00339">say_digit_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00430">say_money_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00270">say_phonetic_str_full()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00395">select_item_menu()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02075">setup_privacy_args()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l11226">vm_authenticate()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00699">wait_file()</a>, and <a class="el" href="../../dd/d55/app__followme_8c_source.html#l00644">wait_for_winner()</a>.</p>
<div class="fragment"><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;{</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a>=<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   off_t pos;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;   <span class="keywordtype">int</span> seekattempt;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   fs = <a class="code" href="../../d6/d13/file_8c.html#ad85c951fa1d6988d2d7e169833a951a8">ast_openstream</a>(chan, <a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>, preflang);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;   <span class="keywordflow">if</span> (!fs) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *codec_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open %s (format %s): %s\n&quot;</span>,</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;         filename, <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(chan), &amp;codec_buf), strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;   }</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;   <span class="comment">/* check to see if there is any data present (not a zero length file),</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">    * done this way because there is no where for ast_openstream_full to</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">    * return the file had no data. */</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;   pos = ftello(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;   seekattempt = fseeko(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>, -1, SEEK_END);</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;   <span class="keywordflow">if</span> (seekattempt) {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EINVAL) {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;         <span class="comment">/* Zero-length file, as opposed to a pipe */</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;         <a class="code" href="../../d6/d13/file_8c.html#a36f6bba05952162d5d1ee7fb9819bd07">ast_seekstream</a>(fs, 0, SEEK_SET);</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      }</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      fseeko(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>, pos, SEEK_SET);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   }</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;   vfs = <a class="code" href="../../d6/d13/file_8c.html#aeed49fff2d6008a89f996230988d944d">ast_openvstream</a>(chan, filename, preflang);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;   <span class="keywordflow">if</span> (vfs) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Ooh, found a video stream, too, format %s\n&quot;</span>, <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(vfs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>));</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(chan), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a44e6b334058bf9555fd4b834ad532046">AST_FLAG_MASQ_NOSTREAM</a>))</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#afa3ba2491683e48895a1e174f7bd7431">orig_chan_name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#a618e3120b6d019312ef2d617d9f14571">ast_applystream</a>(chan, fs))</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;   <span class="keywordflow">if</span> (vfs &amp;&amp; <a class="code" href="../../d6/d13/file_8c.html#a618e3120b6d019312ef2d617d9f14571">ast_applystream</a>(chan, vfs))</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;PLAYBACK&quot;</span>, <span class="stringliteral">&quot;Message: %s\r\nChannel: %s&quot;</span>, filename, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#ad59224750b8b617f9590b28b88457b14">ast_playstream</a>(fs);</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;   <span class="keywordflow">if</span> (!res &amp;&amp; vfs)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      res = <a class="code" href="../../d6/d13/file_8c.html#ad59224750b8b617f9590b28b88457b14">ast_playstream</a>(vfs);</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8c/logger_8h.html#a7d52159deec8b3179d27fcb4d39c30d2">VERBOSITY_ATLEAST</a>(3)) {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;&lt;%s&gt; Playing &#39;%s.%s&#39; (language &#39;%s&#39;)\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), filename, <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a>(chan)), preflang ? preflang : <span class="stringliteral">&quot;default&quot;</span>);</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;   }</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;}</div><div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="file_8c_html_a36f6bba05952162d5d1ee7fb9819bd07"><div class="ttname"><a href="../../d6/d13/file_8c.html#a36f6bba05952162d5d1ee7fb9819bd07">ast_seekstream</a></div><div class="ttdeci">int ast_seekstream(struct ast_filestream *fs, off_t sample_offset, int whence)</div><div class="ttdoc">Seeks into stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01038">file.c:1038</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="format__cap_8h_html_a035f4aa78f172a18311bfa15dd232c6f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a></div><div class="ttdeci">#define AST_FORMAT_CAP_NAMES_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00326">format_cap.h:326</a></div></div>
<div class="ttc" id="logger_8h_html_a7d52159deec8b3179d27fcb4d39c30d2"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a7d52159deec8b3179d27fcb4d39c30d2">VERBOSITY_ATLEAST</a></div><div class="ttdeci">#define VERBOSITY_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00461">logger.h:461</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="file_8c_html_ad59224750b8b617f9590b28b88457b14"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad59224750b8b617f9590b28b88457b14">ast_playstream</a></div><div class="ttdeci">int ast_playstream(struct ast_filestream *s)</div><div class="ttdoc">Play a open stream on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01026">file.c:1026</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="file_8c_html_ad85c951fa1d6988d2d7e169833a951a8"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad85c951fa1d6988d2d7e169833a951a8">ast_openstream</a></div><div class="ttdeci">struct ast_filestream * ast_openstream(struct ast_channel *chan, const char *filename, const char *preflang)</div><div class="ttdoc">Opens stream for use in seeking, playing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00755">file.c:755</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__filestream_html_afa3ba2491683e48895a1e174f7bd7431"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#afa3ba2491683e48895a1e174f7bd7431">ast_filestream::orig_chan_name</a></div><div class="ttdeci">const char * orig_chan_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00125">mod_format.h:125</a></div></div>
<div class="ttc" id="channel_8h_html_a82f2c6e4d47f62f6b65c5887eb096fd5a44e6b334058bf9555fd4b834ad532046"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a44e6b334058bf9555fd4b834ad532046">AST_FLAG_MASQ_NOSTREAM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01015">channel.h:1015</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="file_8c_html_a618e3120b6d019312ef2d617d9f14571"><div class="ttname"><a href="../../d6/d13/file_8c.html#a618e3120b6d019312ef2d617d9f14571">ast_applystream</a></div><div class="ttdeci">int ast_applystream(struct ast_channel *chan, struct ast_filestream *s)</div><div class="ttdoc">Applys a open stream to a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01020">file.c:1020</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="file_8c_html_aeed49fff2d6008a89f996230988d944d"><div class="ttname"><a href="../../d6/d13/file_8c.html#aeed49fff2d6008a89f996230988d944d">ast_openvstream</a></div><div class="ttdeci">struct ast_filestream * ast_openvstream(struct ast_channel *chan, const char *filename, const char *preflang)</div><div class="ttdoc">Opens stream for use in seeking, playing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00812">file.c:812</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="format__cap_8h_html_a4dff925fc9e3bb805b926d18447eb3eb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a></div><div class="ttdeci">const char * ast_format_cap_get_names(const struct ast_format_cap *cap, struct ast_str **buf)</div><div class="ttdoc">Get the names of codecs of a set of formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00736">format_cap.c:736</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="channel_8h_html_a4a5bc2ea394aace55ea3809e53365ea9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a></div><div class="ttdeci">struct ast_format_cap * ast_channel_nativeformats(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00637">channel_internal_api.c:637</a></div></div>
<div class="ttc" id="structast__filestream_html_aeac90097f29f7529968697163cea5c18"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">ast_filestream::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00107">mod_format.h:107</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="structast__filestream_html_a3efb0e1a16208deecbd84c15401f7cf8"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">ast_filestream::f</a></div><div class="ttdeci">FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00117">mod_format.h:117</a></div></div>
<div class="ttc" id="structast__filestream_html_a084d8f087c50442f51245ec3333abac4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">ast_filestream::vfs</a></div><div class="ttdeci">struct ast_filestream * vfs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00110">mod_format.h:110</a></div></div>
<div class="ttc" id="channel_8h_html_a91de92158876186d28ba1773877f2732"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a></div><div class="ttdeci">struct ast_flags * ast_channel_flags(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01260">channel_internal_api.c:1260</a></div></div>
<div class="ttc" id="channel_8h_html_a1dc625bd14a7875b04bfe0c388858929"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a></div><div class="ttdeci">struct ast_format * ast_channel_writeformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00860">channel_internal_api.c:860</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01771a318e7adea51499040f27b4278a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01771a318e7adea51499040f27b4278a">&#9670;&nbsp;</a></span>ast_tellstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">off_t ast_tellstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>fs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tell where we are in a stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>fs to act on </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a long as a sample offset into stream </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01048">1048</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00070">ast_format_def::tell</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00313">ast_moh_files_next()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01131">control_streamfile()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l03556">handle_speechrecognize()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l06315">msg_create_from_file()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01509">waitstream_control()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>
<div class="fragment"><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;{</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   <span class="keywordflow">return</span> fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#aa7f9a2e96761424c900c3574d53d8d83">tell</a>(fs);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;}</div><div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_aa7f9a2e96761424c900c3574d53d8d83"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#aa7f9a2e96761424c900c3574d53d8d83">ast_format_def::tell</a></div><div class="ttdeci">off_t(* tell)(struct ast_filestream *fs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00070">mod_format.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa647ac352a00b559131f90ffffea2c3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa647ac352a00b559131f90ffffea2c3c">&#9670;&nbsp;</a></span>ast_truncstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_truncstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>fs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trunc stream at current location. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>filestream to act on </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01043">1043</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00069">ast_format_def::trunc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, and <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;{</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;   <span class="keywordflow">return</span> fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a0d25a710a49fce33c9d5e0c3ae5cb420">trunc</a>(fs);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;}</div><div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_a0d25a710a49fce33c9d5e0c3ae5cb420"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a0d25a710a49fce33c9d5e0c3ae5cb420">ast_format_def::trunc</a></div><div class="ttdeci">int(* trunc)(struct ast_filestream *fs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00069">mod_format.h:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="affc21cb57c6bf72a2cb7ec8a379b2137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affc21cb57c6bf72a2cb7ec8a379b2137">&#9670;&nbsp;</a></span>ast_waitstream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_waitstream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>breakon</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for a stream to stop or digit to be pressed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>channel to waitstream on </td></tr>
    <tr><td class="paramname">breakon</td><td>string of DTMF digits to break upon Begins playback of a stream... Wait for a stream to stop or for any one of a given digit to arrive, </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the stream finishes </td></tr>
    <tr><td class="paramname">the</td><td>character if it was interrupted by the channel. </td></tr>
    <tr><td class="paramname">-1</td><td>on error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01776">1776</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01759">sanitize_waitstream_return()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d09/sig__analog_8c_source.html#l01711">__analog_ss_thread()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02951">action_playback_and_continue()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l09512">analog_ss_thread()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02615">announce_thread()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00800">announce_to_dial()</a>, <a class="el" href="../../dd/d55/app__followme_8c_source.html#l01339">app_exec()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01470">ast_play_and_wait()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03871">ast_say_date_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03920">ast_say_date_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03842">ast_say_date_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04002">ast_say_date_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08180">ast_say_date_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04123">ast_say_date_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03970">ast_say_date_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04157">ast_say_date_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08216">ast_say_date_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09348">ast_say_date_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04031">ast_say_date_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l04060">ast_say_date_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08455">ast_say_date_with_format_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07397">ast_say_datetime_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07493">ast_say_datetime_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07821">ast_say_datetime_from_now_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07859">ast_say_datetime_from_now_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07947">ast_say_datetime_from_now_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09444">ast_say_datetime_from_now_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08355">ast_say_datetime_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07737">ast_say_datetime_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08388">ast_say_datetime_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07534">ast_say_datetime_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07553">ast_say_datetime_pt()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07634">ast_say_datetime_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07677">ast_say_datetime_zh()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03218">ast_say_enumeration_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03381">ast_say_enumeration_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03101">ast_say_enumeration_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03543">ast_say_enumeration_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03632">ast_say_enumeration_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03198">ast_say_enumeration_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00826">ast_say_number_full_cs()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00924">ast_say_number_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01038">ast_say_number_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00772">ast_say_number_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01172">ast_say_number_full_en_GB()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01251">ast_say_number_full_es()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01355">ast_say_number_full_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08036">ast_say_number_full_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01447">ast_say_number_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01619">ast_say_number_full_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01699">ast_say_number_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01819">ast_say_number_full_it()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08105">ast_say_number_full_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09270">ast_say_number_full_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01974">ast_say_number_full_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02072">ast_say_number_full_no()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02455">ast_say_number_full_pt()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02834">ast_say_number_full_ru()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02555">ast_say_number_full_se()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02913">ast_say_number_full_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02748">ast_say_number_full_ur()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02983">ast_say_number_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02635">ast_say_number_full_zh()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07125">ast_say_time_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07076">ast_say_time_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08260">ast_say_time_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07326">ast_say_time_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07145">ast_say_time_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08308">ast_say_time_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09391">ast_say_time_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07187">ast_say_time_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07284">ast_say_time_zh()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01814">ast_stream_and_wait()</a>, <a class="el" href="../../d6/d0f/app__authenticate_8c_source.html#l00116">auth_exec()</a>, <a class="el" href="../../dc/d04/app__chanspy_8c_source.html#l00892">common_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l04837">conf_exec()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l02350">conf_get_pin()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l03177">conf_run()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00847">directory_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l04500">find_conf_realtime()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l07991">gr_say_number_female()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01573">invent_message()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01912">leave_voicemail()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02846">meetme_menu_admin()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02966">meetme_menu_admin_extended()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l02766">meetme_menu_normal()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l02268">minivm_greet_exec()</a>, <a class="el" href="../../d3/da4/app__page_8c_source.html#l00250">page_exec()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01144">pbx_builtin_background()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02184">pl_odtworz_plik()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00078">play_and_wait()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l03916">play_file()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01644">play_record_review()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00442">playback_exec()</a>, <a class="el" href="../../d7/d17/app__privacy_8c_source.html#l00087">privacy_exec()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l03434">retrydial_exec()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00155">s_streamwait3()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00171">say_character_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00339">say_digit_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00430">say_money_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00270">say_phonetic_str_full()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00395">select_item_menu()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02075">setup_privacy_args()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l11226">vm_authenticate()</a>, and <a class="el" href="../../d7/d01/say_8c_source.html#l00699">wait_file()</a>.</p>
<div class="fragment"><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;{</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a>(c, breakon, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, -1, -1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* no callback */</span>);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a55a8377c040ff899e59b19d08030e255">sanitize_waitstream_return</a>(res);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;}</div><div class="ttc" id="file_8c_html_ab691e222ec6bab6039597ddbed2b5cf8"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a></div><div class="ttdeci">static int waitstream_core(struct ast_channel *c, const char *breakon, const char *forward, const char *reverse, int skip_ms, int audiofd, int cmdfd, const char *context, ast_waitstream_fr_cb cb)</div><div class="ttdoc">the core of all waitstream() functions </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01551">file.c:1551</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="file_8c_html_a55a8377c040ff899e59b19d08030e255"><div class="ttname"><a href="../../d6/d13/file_8c.html#a55a8377c040ff899e59b19d08030e255">sanitize_waitstream_return</a></div><div class="ttdeci">static int sanitize_waitstream_return(int return_value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01759">file.c:1759</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6eb4e1e4576abe04a4b185688f6690c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6eb4e1e4576abe04a4b185688f6690c">&#9670;&nbsp;</a></span>ast_waitstream_exten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_waitstream_exten </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for a stream to stop or digit matching a valid one digit exten to be pressed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>channel to waitstream on </td></tr>
    <tr><td class="paramname">context</td><td>string of context to match digits to break upon Begins playback of a stream... Wait for a stream to stop or for any one of a valid extension digit to arrive, </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the stream finishes. </td></tr>
    <tr><td class="paramname">the</td><td>character if it was interrupted. </td></tr>
    <tr><td class="paramname">-1</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01795">1795</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00344">ast_channel_context()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01759">sanitize_waitstream_return()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01144">pbx_builtin_background()</a>.</p>
<div class="fragment"><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;{</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;   <span class="comment">/* Waitstream, with return in the case of a valid 1 digit extension */</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;   <span class="comment">/* in the current or specified context being pressed */</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>)</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a>(c);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a>(c, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0,</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      -1, -1, <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* no callback */</span>);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a55a8377c040ff899e59b19d08030e255">sanitize_waitstream_return</a>(res);</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;}</div><div class="ttc" id="file_8c_html_ab691e222ec6bab6039597ddbed2b5cf8"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a></div><div class="ttdeci">static int waitstream_core(struct ast_channel *c, const char *breakon, const char *forward, const char *reverse, int skip_ms, int audiofd, int cmdfd, const char *context, ast_waitstream_fr_cb cb)</div><div class="ttdoc">the core of all waitstream() functions </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01551">file.c:1551</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="file_8c_html_a55a8377c040ff899e59b19d08030e255"><div class="ttname"><a href="../../d6/d13/file_8c.html#a55a8377c040ff899e59b19d08030e255">sanitize_waitstream_return</a></div><div class="ttdeci">static int sanitize_waitstream_return(int return_value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01759">file.c:1759</a></div></div>
<div class="ttc" id="channel_8h_html_a582dee4d5ea9b2ff6f309f0c5239f6bd"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a></div><div class="ttdeci">const char * ast_channel_context(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00344">channel_internal_api.c:344</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a42226fa82166fc67e698a77b84f3c692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42226fa82166fc67e698a77b84f3c692">&#9670;&nbsp;</a></span>ast_waitstream_fr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_waitstream_fr </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>breakon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>forward</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>rewind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same as waitstream but allows stream to be forwarded or rewound. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>channel to waitstream on </td></tr>
    <tr><td class="paramname">breakon</td><td>string of DTMF digits to break upon </td></tr>
    <tr><td class="paramname">forward</td><td>DTMF digit to fast forward upon </td></tr>
    <tr><td class="paramname">rewind</td><td>DTMF digit to rewind upon </td></tr>
    <tr><td class="paramname">ms</td><td>How many miliseconds to skip forward/back Begins playback of a stream... Wait for a stream to stop or for any one of a given digit to arrive, </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the stream finishes. </td></tr>
    <tr><td class="paramname">the</td><td>character if it was interrupted, </td></tr>
    <tr><td class="paramname">the</td><td>value of the control frame if it was interrupted by some other party, </td></tr>
    <tr><td class="paramname">-1</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01745">1745</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01131">control_streamfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;{</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a>(c, breakon, forward, reverse, ms,</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      -1 <span class="comment">/* no audiofd */</span>, -1 <span class="comment">/* no cmdfd */</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* no context */</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* no callback */</span>);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;}</div><div class="ttc" id="file_8c_html_ab691e222ec6bab6039597ddbed2b5cf8"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a></div><div class="ttdeci">static int waitstream_core(struct ast_channel *c, const char *breakon, const char *forward, const char *reverse, int skip_ms, int audiofd, int cmdfd, const char *context, ast_waitstream_fr_cb cb)</div><div class="ttdoc">the core of all waitstream() functions </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01551">file.c:1551</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad42aa663fc1c39323aac9c1da5b54389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad42aa663fc1c39323aac9c1da5b54389">&#9670;&nbsp;</a></span>ast_waitstream_fr_w_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_waitstream_fr_w_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>breakon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>forward</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>rewind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d4d/file_8h.html#a2d5138e99197a1d01f7a2ed07830476e">ast_waitstream_fr_cb</a>&#160;</td>
          <td class="paramname"><em>cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same as waitstream_fr but allows a callback to be alerted when a user fastforwards or rewinds the file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>channel to waitstream on </td></tr>
    <tr><td class="paramname">breakon</td><td>string of DTMF digits to break upon </td></tr>
    <tr><td class="paramname">forward</td><td>DTMF digit to fast forward upon </td></tr>
    <tr><td class="paramname">rewind</td><td>DTMF digit to rewind upon </td></tr>
    <tr><td class="paramname">ms</td><td>How many milliseconds to skip forward/back </td></tr>
    <tr><td class="paramname">cb</td><td>to call when rewind or fastfoward occurs. Begins playback of a stream... Wait for a stream to stop or for any one of a given digit to arrive, </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if the stream finishes. </td></tr>
    <tr><td class="paramname">the</td><td>character if it was interrupted, </td></tr>
    <tr><td class="paramname">the</td><td>value of the control frame if it was interrupted by some other party, </td></tr>
    <tr><td class="paramname">-1</td><td>on error. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01734">1734</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01131">control_streamfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;{</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a>(c, breakon, forward, reverse, ms,</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      -1 <span class="comment">/* no audiofd */</span>, -1 <span class="comment">/* no cmdfd */</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* no context */</span>, cb);</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;}</div><div class="ttc" id="file_8c_html_ab691e222ec6bab6039597ddbed2b5cf8"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a></div><div class="ttdeci">static int waitstream_core(struct ast_channel *c, const char *breakon, const char *forward, const char *reverse, int skip_ms, int audiofd, int cmdfd, const char *context, ast_waitstream_fr_cb cb)</div><div class="ttdoc">the core of all waitstream() functions </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01551">file.c:1551</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a09fa137da8f6383a8075c1fe273f6b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09fa137da8f6383a8075c1fe273f6b7b">&#9670;&nbsp;</a></span>ast_waitstream_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_waitstream_full </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>breakon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>audiofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>monfd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Same as waitstream, but with audio output to fd and monitored fd checking.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if monfd is ready for reading </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01785">1785</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01759">sanitize_waitstream_return()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d28/channel_8c_source.html#l06660">ast_readstring_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03218">ast_say_enumeration_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03381">ast_say_enumeration_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03101">ast_say_enumeration_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03543">ast_say_enumeration_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03632">ast_say_enumeration_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l03198">ast_say_enumeration_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00826">ast_say_number_full_cs()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00924">ast_say_number_full_da()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01038">ast_say_number_full_de()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00772">ast_say_number_full_en()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01172">ast_say_number_full_en_GB()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01251">ast_say_number_full_es()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01355">ast_say_number_full_fr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08036">ast_say_number_full_gr()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01447">ast_say_number_full_he()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01619">ast_say_number_full_hu()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01699">ast_say_number_full_is()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01819">ast_say_number_full_it()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l08105">ast_say_number_full_ja()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l09270">ast_say_number_full_ka()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l01974">ast_say_number_full_nl()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02072">ast_say_number_full_no()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02455">ast_say_number_full_pt()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02834">ast_say_number_full_ru()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02555">ast_say_number_full_se()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02913">ast_say_number_full_th()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02748">ast_say_number_full_ur()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02983">ast_say_number_full_vi()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02635">ast_say_number_full_zh()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02616">handle_getoption()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02557">handle_streamfile()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l02184">pl_odtworz_plik()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00155">s_streamwait3()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00171">say_character_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00339">say_digit_str_full()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00430">say_money_str_full()</a>, and <a class="el" href="../../d7/d01/say_8c_source.html#l00270">say_phonetic_str_full()</a>.</p>
<div class="fragment"><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;{</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;   res = <a class="code" href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a>(c, breakon, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0,</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      audiofd, cmdfd, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* no context */</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> <span class="comment">/* no callback */</span>);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a55a8377c040ff899e59b19d08030e255">sanitize_waitstream_return</a>(res);</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;}</div><div class="ttc" id="file_8c_html_ab691e222ec6bab6039597ddbed2b5cf8"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab691e222ec6bab6039597ddbed2b5cf8">waitstream_core</a></div><div class="ttdeci">static int waitstream_core(struct ast_channel *c, const char *breakon, const char *forward, const char *reverse, int skip_ms, int audiofd, int cmdfd, const char *context, ast_waitstream_fr_cb cb)</div><div class="ttdoc">the core of all waitstream() functions </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01551">file.c:1551</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="file_8c_html_a55a8377c040ff899e59b19d08030e255"><div class="ttname"><a href="../../d6/d13/file_8c.html#a55a8377c040ff899e59b19d08030e255">sanitize_waitstream_return</a></div><div class="ttdeci">static int sanitize_waitstream_return(int return_value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01759">file.c:1759</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a964f8ef393c07609d7b9e02937faed52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a964f8ef393c07609d7b9e02937faed52">&#9670;&nbsp;</a></span>ast_writefile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a>* ast_writefile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mode_t&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts writing a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>the name of the file to write to </td></tr>
    <tr><td class="paramname">type</td><td>format of file you wish to write out to </td></tr>
    <tr><td class="paramname">comment</td><td>comment to go with </td></tr>
    <tr><td class="paramname">flags</td><td>output file flags </td></tr>
    <tr><td class="paramname">check</td><td>(unimplemented, hence negligible) </td></tr>
    <tr><td class="paramname">mode</td><td>Open mode Create an outgoing file stream. oflags are flags for the open() command, and if check is non-zero, then it will not write a file if there are any files that start with that name and have an extension Please note, this is a blocking function. Program execution will not return until ast_waitstream completes it's execution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">a</td><td>struct <a class="el" href="../../db/dbc/structast__filestream.html" title="This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...">ast_filestream</a> on success. </td></tr>
    <tr><td class="paramname">NULL</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01361">1361</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l01068">ast_closestream()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, <a class="el" href="../../d7/d5b/options_8h_source.html#l00120">ast_opt_cache_record_files</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00314">build_filename()</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">c</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00351">exts_compare</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00117">ast_filestream::f</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00107">ast_filestream::filename</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00104">ast_filestream::flags</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00428">get_filestream()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00105">ast_filestream::mode</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00108">ast_filestream::realfilename</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00096">record_cache_dir</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00485">rewrite_wrapper()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00068">ast_format_def::seek</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00112">ast_filestream::trans</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00110">ast_filestream::vfs</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00126">ast_filestream::write_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00305">ast_monitor_start()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00209">ast_writestream()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00087">dictate_exec()</a>, <a class="el" href="../../d0/ddd/res__convert_8c_source.html#l00064">handle_cli_file_convert()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l00670">mixmonitor_save_prep()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, and <a class="el" href="../../df/d44/app__meetme_8c_source.html#l05681">recordthread()</a>.</p>
<div class="fragment"><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;{</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;   <span class="keywordtype">int</span> fd, myflags = 0;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;   <span class="comment">/* compiler claims this variable can be used before initialization... */</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   FILE *bfile = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *fs = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   <span class="keywordtype">size_t</span> size = 0;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   <span class="keywordtype">int</span> format_found = 0;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;   <span class="comment">/* set the O_TRUNC flag if and only if there is no O_APPEND specified */</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   <span class="comment">/* We really can&#39;t use O_APPEND as it will break WAV header updates */</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp; O_APPEND) {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> &amp;= ~O_APPEND;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      myflags = O_TRUNC;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;   }</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   myflags |= O_WRONLY | O_CREAT;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;   <span class="comment">/* XXX need to fix this - we should just do the fopen,</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">    * not open followed by fdopen()</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, f, list) {</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keywordtype">char</span> *fn, *orig_fn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keywordflow">if</span> (fs)</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>))</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;         format_found = 1;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      fn = <a class="code" href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a>(<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>);</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keywordflow">if</span> (!fn) {</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      }</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      fd = open(fn, <a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> | myflags, <a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a>);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">if</span> (fd &gt; -1) {</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;         <span class="comment">/* fdopen() the resulting file stream */</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;         bfile = fdopen(fd, ((<a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> | myflags) &amp; O_RDWR) ? <span class="stringliteral">&quot;w+&quot;</span> : <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         <span class="keywordflow">if</span> (!bfile) {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Whoa, fdopen failed: %s!\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            close(fd);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            fd = -1;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;         }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      }</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5b/options_8h.html#a3472349abbba9eb4a158cdf4299bf740">ast_opt_cache_record_files</a> &amp;&amp; (fd &gt; -1)) {</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;         <span class="keywordtype">char</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;         fclose(bfile); <span class="comment">/* this also closes fd */</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">           We touch orig_fn just as a place-holder so other things (like vmail) see the file is there.</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">           What we are really doing is writing to record_cache_dir until we are done then we will mv the file into place.</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;         orig_fn = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(fn);</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;         <span class="keywordflow">for</span> (c = fn; *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>; c++)</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            <span class="keywordflow">if</span> (*c == <span class="charliteral">&#39;/&#39;</span>)</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;               *c = <span class="charliteral">&#39;_&#39;</span>;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;         size = strlen(fn) + strlen(<a class="code" href="../../d7/d5b/options_8h.html#a08a845bf43007945cede2f5a6a62225c">record_cache_dir</a>) + 2;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;         buf = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(size);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;         strcpy(buf, <a class="code" href="../../d7/d5b/options_8h.html#a08a845bf43007945cede2f5a6a62225c">record_cache_dir</a>);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;         strcat(buf, <span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;         strcat(buf, fn);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;         fn = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;         fd = open(fn, <a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> | myflags, <a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a>);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;         <span class="keywordflow">if</span> (fd &gt; -1) {</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <span class="comment">/* fdopen() the resulting file stream */</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            bfile = fdopen(fd, ((<a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> | myflags) &amp; O_RDWR) ? <span class="stringliteral">&quot;w+&quot;</span> : <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;            <span class="keywordflow">if</span> (!bfile) {</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Whoa, fdopen failed: %s!\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;               close(fd);</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;               fd = -1;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            }</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;         }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      }</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">if</span> (fd &gt; -1) {</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;         <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> = 0;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;         fs = <a class="code" href="../../d6/d13/file_8c.html#a3e809ea7be0413c527df113a695552b8">get_filestream</a>(f, bfile);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;         <span class="keywordflow">if</span> (fs) {</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <span class="keywordflow">if</span> ((fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a6de7f628c7786f3686214488c8edfc27">write_buffer</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(32768))) {</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;               setvbuf(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>, fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a6de7f628c7786f3686214488c8edfc27">write_buffer</a>, _IOFBF, 32768);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            }</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;         }</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;         <span class="keywordflow">if</span> (!fs || <a class="code" href="../../d6/d13/file_8c.html#acbe06882238f9fabfff485fefc6fa619">rewrite_wrapper</a>(fs, <a class="code" href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a>)) {</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to rewrite %s\n&quot;</span>, fn);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            close(fd);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="keywordflow">if</span> (orig_fn) {</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;               unlink(fn);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;               unlink(orig_fn);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(orig_fn);</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            }</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="keywordflow">if</span> (fs) {</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;               <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(fs);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;               fs = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            }</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment">             * &#39;fn&#39; was has either been allocated from build_filename, or that was freed</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment">             * and now &#39;fn&#39; points to memory allocated for &#39;buf&#39;. Either way the memory</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment">             * now needs to be released.</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;         }</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;         fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;         fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a> = <a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a> = <a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;         fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a> = <a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a>;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         <span class="keywordflow">if</span> (orig_fn) {</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a198a1121327381d95b1bb6c501e38333">realfilename</a> = orig_fn;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a> = fn;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">             * The above now manages the memory allocated for &#39;orig_fn&#39; and &#39;fn&#39;, so</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">             * set them to NULL, so they don&#39;t get released at the end of the loop.</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            orig_fn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            fn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a198a1121327381d95b1bb6c501e38333">realfilename</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>);</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;         }</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;         fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;         <span class="comment">/* If truncated, we&#39;ll be at the beginning; if not truncated, then append */</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;         f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a1327e7030c55bfe870ed79fab26709aa">seek</a>(fs, 0, SEEK_END);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> != EEXIST) {</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open file %s: %s\n&quot;</span>, fn, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;         <span class="keywordflow">if</span> (orig_fn)</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            unlink(orig_fn);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      }</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      <span class="comment">/* Free &#39;fn&#39;, or if &#39;fn&#39; points to &#39;buf&#39; then free &#39;buf&#39; */</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(orig_fn);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   }</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;   <span class="keywordflow">if</span> (!format_found)</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;No such format &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;   <span class="keywordflow">return</span> fs;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="file_8c_html_ad60e6b6fb8b8078dc9e4deda4ffbde10"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a></div><div class="ttdeci">#define exts_compare(list, type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00351">file.c:351</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="file_8c_html_a3e809ea7be0413c527df113a695552b8"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3e809ea7be0413c527df113a695552b8">get_filestream</a></div><div class="ttdeci">static struct ast_filestream * get_filestream(struct ast_format_def *fmt, FILE *bfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00428">file.c:428</a></div></div>
<div class="ttc" id="file_8c_html_acbe06882238f9fabfff485fefc6fa619"><div class="ttname"><a href="../../d6/d13/file_8c.html#acbe06882238f9fabfff485fefc6fa619">rewrite_wrapper</a></div><div class="ttdeci">static int rewrite_wrapper(struct ast_filestream *s, const char *comment)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00485">file.c:485</a></div></div>
<div class="ttc" id="structast__filestream_html_a198a1121327381d95b1bb6c501e38333"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a198a1121327381d95b1bb6c501e38333">ast_filestream::realfilename</a></div><div class="ttdeci">char * realfilename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00108">mod_format.h:108</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="file_8c_html_ab53bd2c3c55d509790c7f7620aac6373"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a></div><div class="ttdeci">int ast_closestream(struct ast_filestream *f)</div><div class="ttdoc">Closes a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01068">file.c:1068</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="structast__format__def_html_a1327e7030c55bfe870ed79fab26709aa"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a1327e7030c55bfe870ed79fab26709aa">ast_format_def::seek</a></div><div class="ttdeci">int(* seek)(struct ast_filestream *, off_t, int)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00068">mod_format.h:68</a></div></div>
<div class="ttc" id="structast__filestream_html_a6de7f628c7786f3686214488c8edfc27"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a6de7f628c7786f3686214488c8edfc27">ast_filestream::write_buffer</a></div><div class="ttdeci">char * write_buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00126">mod_format.h:126</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="file_8c_html_a2a836416f6627399f3b75ef2705bcd89"><div class="ttname"><a href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a></div><div class="ttdeci">static char * build_filename(const char *filename, const char *ext)</div><div class="ttdoc">construct a filename. Absolute pathnames are preserved, relative names are prefixed by the sounds/ di...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00314">file.c:314</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="ael__lex_8c_html_a43be22b7a1b528eaf759e034ec581543"><div class="ttname"><a href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a></div><div class="ttdeci">#define comment</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7e/ael__lex_8c_source.html#l00976">ael_lex.c:976</a></div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__filestream_html_ad98134a98f3e3e3b5611a5fd2117e8e4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">ast_filestream::trans</a></div><div class="ttdeci">struct ast_trans_pvt * trans</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00112">mod_format.h:112</a></div></div>
<div class="ttc" id="options_8h_html_a3472349abbba9eb4a158cdf4299bf740"><div class="ttname"><a href="../../d7/d5b/options_8h.html#a3472349abbba9eb4a158cdf4299bf740">ast_opt_cache_record_files</a></div><div class="ttdeci">#define ast_opt_cache_record_files</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5b/options_8h_source.html#l00120">options.h:120</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="options_8h_html_a08a845bf43007945cede2f5a6a62225c"><div class="ttname"><a href="../../d7/d5b/options_8h.html#a08a845bf43007945cede2f5a6a62225c">record_cache_dir</a></div><div class="ttdeci">char record_cache_dir[AST_CACHE_DIR_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00096">options.c:96</a></div></div>
<div class="ttc" id="structast__filestream_html_aeac90097f29f7529968697163cea5c18"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">ast_filestream::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00107">mod_format.h:107</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="structast__filestream_html_a3efb0e1a16208deecbd84c15401f7cf8"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">ast_filestream::f</a></div><div class="ttdeci">FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00117">mod_format.h:117</a></div></div>
<div class="ttc" id="structast__filestream_html_a084d8f087c50442f51245ec3333abac4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">ast_filestream::vfs</a></div><div class="ttdeci">struct ast_filestream * vfs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00110">mod_format.h:110</a></div></div>
<div class="ttc" id="structast__filestream_html_adc8d3cf511ceb277aea0cfa1cd027c59"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">ast_filestream::mode</a></div><div class="ttdeci">mode_t mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00105">mod_format.h:105</a></div></div>
<div class="ttc" id="structast__filestream_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">ast_filestream::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00104">mod_format.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3608386b919ef0949d2858cdeb02d12e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3608386b919ef0949d2858cdeb02d12e">&#9670;&nbsp;</a></span>ast_writestream()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_writestream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>fs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a frame to a stream. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fs</td><td>filestream to write to </td></tr>
    <tr><td class="paramname">f</td><td>frame to write to the filestream Send a frame to a filestream &ndash; note: does NOT free the frame, call ast_frfree manually </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on failure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00209">209</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00517">ao2_replace</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00201">ast_format_cmp()</a>, <a class="el" href="../../d0/d0a/format_8h_source.html#l00036">AST_FORMAT_CMP_EQUAL</a>, <a class="el" href="../../d0/d0a/format_8h_source.html#l00038">AST_FORMAT_CMP_NOT_EQUAL</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00334">ast_format_get_name()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00354">ast_format_get_type()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00103">AST_FRAME_VIDEO</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00438">AST_LIST_NEXT</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../de/d43/translate_8c_source.html#l00565">ast_translate()</a>, <a class="el" href="../../de/d43/translate_8c_source.html#l00485">ast_translator_build_path()</a>, <a class="el" href="../../de/d43/translate_8c_source.html#l00475">ast_translator_free_path()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01361">ast_writefile()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00107">ast_filestream::filename</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00104">ast_filestream::flags</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">ast_frame_subclass::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00114">ast_filestream::lastwriteformat</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00105">ast_filestream::mode</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00112">ast_filestream::trans</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00110">ast_filestream::vfs</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00066">ast_format_def::write</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l01580">__ast_play_and_record()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l03529">__ast_read()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l05194">ast_write_stream()</a>, <a class="el" href="../../dd/d32/app__dictate_8c_source.html#l00087">dictate_exec()</a>, <a class="el" href="../../d0/ddd/res__convert_8c_source.html#l00064">handle_cli_file_convert()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l02899">handle_recordfile()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l00709">mixmonitor_thread()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, and <a class="el" href="../../df/d44/app__meetme_8c_source.html#l05681">recordthread()</a>.</p>
<div class="fragment"><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> == <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a17ae96b6ea8a2388bb0d409e8124ff30">AST_FRAME_VIDEO</a>) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;         <span class="comment">/* This is the audio portion.  Call the video one... */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         <span class="keywordflow">if</span> (!fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a> &amp;&amp; fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> = <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a> = <a class="code" href="../../d6/d13/file_8c.html#a964f8ef393c07609d7b9e02937faed52">ast_writefile</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>, type, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>, 0, fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Opened video output file\n&quot;</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;         }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         <span class="keywordflow">if</span> (fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a>)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a3608386b919ef0949d2858cdeb02d12e">ast_writestream</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a>, f);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         <span class="comment">/* else ignore */</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> != <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>) {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Tried to write non-voice frame\n&quot;</span>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) != <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a>) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      res =  fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a20bb29fc5058d976de3478468380cdb1">write</a>(fs, f);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">if</span> (res &lt; 0)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Natural write failed\n&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res &gt; 0)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Huh??\n&quot;</span>);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="comment">/* XXX If they try to send us a type of frame that isn&#39;t the normal frame, and isn&#39;t</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">             the one we&#39;ve setup a translator for, we do the &quot;wrong thing&quot; XXX */</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordflow">if</span> (fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> &amp;&amp; (<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ac7d6a578d1d7ec8696b068dd9446580e">lastwriteformat</a>) != <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a>)) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         <a class="code" href="../../db/d39/translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207">ast_translator_free_path</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;         fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span> (!fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;         fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = <a class="code" href="../../db/d39/translate_8h.html#a08790d6e05056f38fe9194134332cfef">ast_translator_build_path</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span> (!fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to translate to format %s, source format %s\n&quot;</span>,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>, <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>));</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *trf;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ac7d6a578d1d7ec8696b068dd9446580e">lastwriteformat</a>, f-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;         <span class="comment">/* Get the translated frame but don&#39;t consume the original in case they&#39;re using it on another stream */</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;         <span class="keywordflow">if</span> ((trf = <a class="code" href="../../db/d39/translate_8h.html#ab09d3ccb95d1f828d2871530226f9456">ast_translate</a>(fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>, f, 0))) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *cur;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">/* the translator may have returned multiple frames, so process them */</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">for</span> (cur = trf; cur; cur = <a class="code" href="../../df/d90/linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6">AST_LIST_NEXT</a>(cur, <a class="code" href="../../d9/d42/structframe__list.html">frame_list</a>)) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;               <span class="keywordflow">if</span> ((res = fs-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a20bb29fc5058d976de3478468380cdb1">write</a>(fs, trf))) {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Translated frame write failed\n&quot;</span>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;               }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(trf);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            res = 0;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="format_8h_html_a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ab1e8c1a0f8b4a1ecb6a2109992636859">AST_FORMAT_CMP_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00036">format.h:36</a></div></div>
<div class="ttc" id="format_8h_html_a0aba6e17ced3e85e838ea097baa5ddc7"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a></div><div class="ttdeci">enum ast_media_type ast_format_get_type(const struct ast_format *format)</div><div class="ttdoc">Get the media type of a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00354">format.c:354</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ae234825bcb65b88c0554b995ff1b8ba6"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6">AST_LIST_NEXT</a></div><div class="ttdeci">#define AST_LIST_NEXT(elm, field)</div><div class="ttdoc">Returns the next entry in the list after the given entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00438">linkedlists.h:438</a></div></div>
<div class="ttc" id="translate_8h_html_ab09d3ccb95d1f828d2871530226f9456"><div class="ttname"><a href="../../db/d39/translate_8h.html#ab09d3ccb95d1f828d2871530226f9456">ast_translate</a></div><div class="ttdeci">struct ast_frame * ast_translate(struct ast_trans_pvt *tr, struct ast_frame *f, int consume)</div><div class="ttdoc">translates one or more frames Apply an input frame into the translator and receive zero or one output...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d43/translate_8c_source.html#l00565">translate.c:565</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="file_8c_html_a3608386b919ef0949d2858cdeb02d12e"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3608386b919ef0949d2858cdeb02d12e">ast_writestream</a></div><div class="ttdeci">int ast_writestream(struct ast_filestream *fs, struct ast_frame *f)</div><div class="ttdoc">Writes a frame to a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00209">file.c:209</a></div></div>
<div class="ttc" id="file_8c_html_a964f8ef393c07609d7b9e02937faed52"><div class="ttname"><a href="../../d6/d13/file_8c.html#a964f8ef393c07609d7b9e02937faed52">ast_writefile</a></div><div class="ttdeci">struct ast_filestream * ast_writefile(const char *filename, const char *type, const char *comment, int flags, int check, mode_t mode)</div><div class="ttdoc">Starts writing a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01361">file.c:1361</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="format_8h_html_a738c58eca291b71de4422e95bff27400"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a></div><div class="ttdeci">enum ast_format_cmp_res ast_format_cmp(const struct ast_format *format1, const struct ast_format *format2)</div><div class="ttdoc">Compare two formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00201">format.c:201</a></div></div>
<div class="ttc" id="format_8h_html_a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00038">format.h:38</a></div></div>
<div class="ttc" id="translate_8h_html_a08790d6e05056f38fe9194134332cfef"><div class="ttname"><a href="../../db/d39/translate_8h.html#a08790d6e05056f38fe9194134332cfef">ast_translator_build_path</a></div><div class="ttdeci">struct ast_trans_pvt * ast_translator_build_path(struct ast_format *dest, struct ast_format *source)</div><div class="ttdoc">Builds a translator path Build a path (possibly NULL) from source to dest. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d43/translate_8c_source.html#l00485">translate.c:485</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="structframe__list_html"><div class="ttname"><a href="../../d9/d42/structframe__list.html">frame_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00590">res_rtp_asterisk.c:590</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="structast__filestream_html_ad98134a98f3e3e3b5611a5fd2117e8e4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">ast_filestream::trans</a></div><div class="ttdeci">struct ast_trans_pvt * trans</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00112">mod_format.h:112</a></div></div>
<div class="ttc" id="structast__filestream_html_ac7d6a578d1d7ec8696b068dd9446580e"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ac7d6a578d1d7ec8696b068dd9446580e">ast_filestream::lastwriteformat</a></div><div class="ttdeci">struct ast_format * lastwriteformat</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00114">mod_format.h:114</a></div></div>
<div class="ttc" id="structast__filestream_html_aeac90097f29f7529968697163cea5c18"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">ast_filestream::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00107">mod_format.h:107</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa81c8462bd0574f4f9e09e71f2772f44"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a></div><div class="ttdeci">#define ao2_replace(dst, src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00517">astobj2.h:517</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="structast__filestream_html_a084d8f087c50442f51245ec3333abac4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">ast_filestream::vfs</a></div><div class="ttdeci">struct ast_filestream * vfs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00110">mod_format.h:110</a></div></div>
<div class="ttc" id="structast__filestream_html_adc8d3cf511ceb277aea0cfa1cd027c59"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">ast_filestream::mode</a></div><div class="ttdeci">mode_t mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00105">mod_format.h:105</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0a17ae96b6ea8a2388bb0d409e8124ff30"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a17ae96b6ea8a2388bb0d409e8124ff30">AST_FRAME_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00103">include/asterisk/frame.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_a20bb29fc5058d976de3478468380cdb1"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a20bb29fc5058d976de3478468380cdb1">ast_format_def::write</a></div><div class="ttdeci">int(* write)(struct ast_filestream *, struct ast_frame *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00066">mod_format.h:66</a></div></div>
<div class="ttc" id="translate_8h_html_a8f767bf5c2095f182e7cbaa73e391207"><div class="ttname"><a href="../../db/d39/translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207">ast_translator_free_path</a></div><div class="ttdeci">void ast_translator_free_path(struct ast_trans_pvt *tr)</div><div class="ttdoc">Frees a translator path Frees the given translator path structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d43/translate_8c_source.html#l00475">translate.c:475</a></div></div>
<div class="ttc" id="structast__filestream_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ac8bf36fe0577cba66bccda3a6f7e80a4">ast_filestream::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00104">mod_format.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a836416f6627399f3b75ef2705bcd89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a836416f6627399f3b75ef2705bcd89">&#9670;&nbsp;</a></span>build_filename()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* build_filename </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>construct a filename. Absolute pathnames are preserved, relative names are prefixed by the sounds/ directory. The wav49 suffix is replaced by 'WAV'. Returns a malloc'ed string to be freed by the caller. </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00314">314</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00158">ast_config_AST_DATA_DIR</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01309">ast_readfile()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01361">ast_writefile()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordtype">char</span> *fn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="comment">/* The wav49 -&gt; WAV translation is duplicated in apps/app_mixmonitor.c, so</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">      if you change it here you need to change it there as well */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <span class="keywordflow">if</span> (!strcmp(<a class="code" href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>, <span class="stringliteral">&quot;wav49&quot;</span>))</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a> = <span class="stringliteral">&quot;WAV&quot;</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <span class="keywordflow">if</span> (filename[0] == <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;fn, <span class="stringliteral">&quot;%s.%s&quot;</span>, filename, <a class="code" href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>) &lt; 0) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;         fn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;fn, <span class="stringliteral">&quot;%s/sounds/%s.%s&quot;</span>,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;              <a class="code" href="../../dd/df2/paths_8h.html#a63af4213b5b83f717398d8d62008a50d">ast_config_AST_DATA_DIR</a>, filename, <a class="code" href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>) &lt; 0) {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         fn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="keywordflow">return</span> fn;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="http_8c_html_af9b32121c4ad80b0887a3d73fd24de5f"><div class="ttname"><a href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a></div><div class="ttdeci">const char * ext</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00147">http.c:147</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="paths_8h_html_a63af4213b5b83f717398d8d62008a50d"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a63af4213b5b83f717398d8d62008a50d">ast_config_AST_DATA_DIR</a></div><div class="ttdeci">const char * ast_config_AST_DATA_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00158">options.c:158</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a939eb1d85b6fd5dfc16d00d1c3f86df0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939eb1d85b6fd5dfc16d00d1c3f86df0">&#9670;&nbsp;</a></span>copy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int copy </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>infile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>outfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00271">271</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db2/asterisk_8h_source.html#l00032">AST_FILE_MODE</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordtype">int</span> ifd, ofd, <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[4096];   <span class="comment">/* XXX make it lerger. */</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keywordflow">if</span> ((ifd = open(infile, O_RDONLY)) &lt; 0) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open %s in read-only mode\n&quot;</span>, infile);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordflow">if</span> ((ofd = open(outfile, O_WRONLY | O_TRUNC | O_CREAT, <a class="code" href="../../db/db2/asterisk_8h.html#aa6293b2dae52a2b470494df672a26c42">AST_FILE_MODE</a>)) &lt; 0) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open %s in write-only mode\n&quot;</span>, outfile);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      close(ifd);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keywordflow">while</span> ( (len = read(ifd, buf, <span class="keyword">sizeof</span>(buf)) ) ) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">if</span> (len &lt; 0) {</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Read failed on %s: %s\n&quot;</span>, infile, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="comment">/* XXX handle partial writes */</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      res = write(ofd, buf, len);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">if</span> (res != len) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Write failed on %s (%d of %d): %s\n&quot;</span>, outfile, res, len, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         len = -1; <span class="comment">/* error marker */</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   close(ifd);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   close(ofd);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <span class="keywordflow">if</span> (len &lt; 0) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      unlink(outfile);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">return</span> -1; <span class="comment">/* error */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <span class="keywordflow">return</span> 0;   <span class="comment">/* success */</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="asterisk_8h_html_aa6293b2dae52a2b470494df672a26c42"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#aa6293b2dae52a2b470494df672a26c42">AST_FILE_MODE</a></div><div class="ttdeci">#define AST_FILE_MODE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00032">asterisk.h:32</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4af69640cb6edeb12525ed8a85e26ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4af69640cb6edeb12525ed8a85e26ca4">&#9670;&nbsp;</a></span>file_shutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void file_shutdown </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01976">1976</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00030">ast_cli_unregister_multiple()</a>, <a class="el" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type()</a>, <a class="el" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type()</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l01523">STASIS_MESSAGE_TYPE_CLEANUP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01983">ast_file_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;{</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(<a class="code" href="../../d6/d13/file_8c.html#abaef9acc752363813eb89bb0b72721a7">cli_file</a>, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d6/d13/file_8c.html#abaef9acc752363813eb89bb0b72721a7">cli_file</a>));</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(<a class="code" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a>);</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(<a class="code" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a>);</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="file_8c_html_abaef9acc752363813eb89bb0b72721a7"><div class="ttname"><a href="../../d6/d13/file_8c.html#abaef9acc752363813eb89bb0b72721a7">cli_file</a></div><div class="ttdeci">static struct ast_cli_entry cli_file[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01972">file.c:1972</a></div></div>
<div class="ttc" id="stasis_8h_html_a31197e193b1dfd6c122ff6d7c7f6b3fa"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_CLEANUP(name)</div><div class="ttdoc">Boiler-plate messaging macro for cleaning up message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01523">stasis.h:1523</a></div></div>
<div class="ttc" id="format_8h_html_a10e266850ef68354d61ff7207c62781b"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a></div><div class="ttdeci">struct stasis_message_type * ast_format_unregister_type(void)</div><div class="ttdoc">Get the message type used for signaling a format unregistration. </div></div>
<div class="ttc" id="format_8h_html_a50026f039eb9220ff618fa7a4f3a1da1"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a></div><div class="ttdeci">struct stasis_message_type * ast_format_register_type(void)</div><div class="ttdoc">Get the message type used for signaling a format registration. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbaf6de590d8e1505c484b44d278e4f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbaf6de590d8e1505c484b44d278e4f8">&#9670;&nbsp;</a></span>fileexists_core()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int fileexists_core </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>preflang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *&#160;</td>
          <td class="paramname"><em>result_cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>helper routine to locate a file with a given format and language preference. </p>
<dl class="section note"><dt>Note</dt><dd>Try preflang, preflang with stripped '_' suffices, or NULL.</dd>
<dd>
The last parameter(s) point to a buffer of sufficient size, which on success is filled with the matching filename.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>Name of the file. </td></tr>
    <tr><td class="paramname">fmt</td><td>Format to look for the file in. OPTIONAL </td></tr>
    <tr><td class="paramname">preflang</td><td>The perfered language </td></tr>
    <tr><td class="paramname">buf</td><td>Returns the matching filename </td></tr>
    <tr><td class="paramname">buflen</td><td>Size of the buf </td></tr>
    <tr><td class="paramname">result_cap</td><td>OPTIONAL format capabilities result structure returns what formats the file was found in.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1,true.</td><td>file exists and result format is set </td></tr>
    <tr><td class="paramname">0,false.</td><td>file does not exist. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00706">706</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../db/db2/asterisk_8h_source.html#l00044">DEFAULT_LANGUAGE</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00656">fileexists_test()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01086">ast_fileexists()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00760">ast_openstream_full()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00812">ast_openvstream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;{</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="keywordtype">char</span> *lang;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <span class="comment">/* We try languages in the following order:</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">    *    preflang (may include dialect and style codes)</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">    *    lang (preflang without dialect - if any)</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">    *    &lt;none&gt;</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">    *    default (unless the same as preflang or lang without dialect)</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   lang = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(preflang);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   <span class="comment">/* Try preferred language, including removing any style or dialect codes */</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <span class="keywordflow">while</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(lang)) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#accfa3871048ab1857f7a409c39f18ec9">fileexists_test</a>(filename, fmt, lang, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, buflen, result_cap)) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordflow">if</span> ((end = strrchr(lang, <span class="charliteral">&#39;_&#39;</span>)) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;         *end = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      }</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <span class="comment">/* Try without any language */</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#accfa3871048ab1857f7a409c39f18ec9">fileexists_test</a>(filename, fmt, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, buflen, result_cap)) {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="comment">/* Finally try the default language unless it was already tried before */</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(preflang) || strcmp(preflang, <a class="code" href="../../db/db2/asterisk_8h.html#a2a112ca1c7c7dc54fe43375469738dc4">DEFAULT_LANGUAGE</a>)) &amp;&amp; (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(lang) || strcmp(lang, <a class="code" href="../../db/db2/asterisk_8h.html#a2a112ca1c7c7dc54fe43375469738dc4">DEFAULT_LANGUAGE</a>))) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d13/file_8c.html#accfa3871048ab1857f7a409c39f18ec9">fileexists_test</a>(filename, fmt, <a class="code" href="../../db/db2/asterisk_8h.html#a2a112ca1c7c7dc54fe43375469738dc4">DEFAULT_LANGUAGE</a>, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, buflen, result_cap)) &gt; 0) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="file_8c_html_accfa3871048ab1857f7a409c39f18ec9"><div class="ttname"><a href="../../d6/d13/file_8c.html#accfa3871048ab1857f7a409c39f18ec9">fileexists_test</a></div><div class="ttdeci">static int fileexists_test(const char *filename, const char *fmt, const char *lang, char *buf, int buflen, struct ast_format_cap *result_cap)</div><div class="ttdoc">test if a file exists for a given format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00656">file.c:656</a></div></div>
<div class="ttc" id="asterisk_8h_html_a2a112ca1c7c7dc54fe43375469738dc4"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a2a112ca1c7c7dc54fe43375469738dc4">DEFAULT_LANGUAGE</a></div><div class="ttdeci">#define DEFAULT_LANGUAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00044">asterisk.h:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="accfa3871048ab1857f7a409c39f18ec9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accfa3871048ab1857f7a409c39f18ec9">&#9670;&nbsp;</a></span>fileexists_test()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int fileexists_test </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>lang</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>buflen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *&#160;</td>
          <td class="paramname"><em>result_cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>test if a file exists for a given format. </p>
<dl class="section note"><dt>Note</dt><dd>result_cap is OPTIONAL </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1,true</td><td>and result_cap represents format capabilities file exists in. </td></tr>
    <tr><td class="paramname">0,false</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00656">656</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00496">ACTION_EXISTS</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00067">ast_language_is_prefix</a>, <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00197">ast_media_cache_retrieve()</a>, <a class="el" href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">c</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00640">is_absolute_path()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00645">is_remote_path()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00706">fileexists_core()</a>.</p>
<div class="fragment"><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#a9693d0bc24ee3d83d6e252a7c2c7c469">is_remote_path</a>(filename) &amp;&amp; !<a class="code" href="../../d3/d16/media__cache_8h.html#aab5d807c3f16ff84d014672deb07edbb">ast_media_cache_retrieve</a>(filename, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, buflen)) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, result_cap, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#a248e5c086666b04d29a9cd876ad370b3">ast_language_is_prefix</a> &amp;&amp; !<a class="code" href="../../d6/d13/file_8c.html#ab2ba253f0cfdacc7312206800f7bd2bb">is_absolute_path</a>(filename)) { <span class="comment">/* new layout */</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keywordflow">if</span> (lang) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;         snprintf(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, buflen, <span class="stringliteral">&quot;%s/%s&quot;</span>, lang, filename);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;         snprintf(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, buflen, <span class="stringliteral">&quot;%s&quot;</span>, filename);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   } <span class="keywordflow">else</span> { <span class="comment">/* old layout */</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      strcpy(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, filename);  <span class="comment">/* first copy the full string */</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">if</span> (lang) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;         <span class="comment">/* insert the language and suffix if needed */</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = strrchr(filename, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="../../d0/d99/structast__frame.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = c ? c - filename + 1 : 0; <span class="comment">/* points right after the last &#39;/&#39; */</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;         snprintf(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> + offset, buflen - offset, <span class="stringliteral">&quot;%s/%s&quot;</span>, lang, filename + offset);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   }</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, result_cap, fmt, <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a>);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div><div class="ttc" id="structast__frame_html_aed7ea92f45bd273dde380a45ddced592"><div class="ttname"><a href="../../d0/d99/structast__frame.html#aed7ea92f45bd273dde380a45ddced592">ast_frame::offset</a></div><div class="ttdeci">int offset</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00179">include/asterisk/frame.h:179</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00496">file.c:496</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="file_8c_html_ab2ba253f0cfdacc7312206800f7bd2bb"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab2ba253f0cfdacc7312206800f7bd2bb">is_absolute_path</a></div><div class="ttdeci">static int is_absolute_path(const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00640">file.c:640</a></div></div>
<div class="ttc" id="file_8c_html_a083568a210b02e2a6985923817b6e4dc"><div class="ttname"><a href="../../d6/d13/file_8c.html#a083568a210b02e2a6985923817b6e4dc">filehelper</a></div><div class="ttdeci">static int filehelper(const char *filename, const void *arg2, const char *fmt, const enum file_action action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00514">file.c:514</a></div></div>
<div class="ttc" id="media__cache_8h_html_aab5d807c3f16ff84d014672deb07edbb"><div class="ttname"><a href="../../d3/d16/media__cache_8h.html#aab5d807c3f16ff84d014672deb07edbb">ast_media_cache_retrieve</a></div><div class="ttdeci">int ast_media_cache_retrieve(const char *uri, const char *preferred_file_name, char *file_path, size_t len)</div><div class="ttdoc">Retrieve an item from the cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dfb/media__cache_8c_source.html#l00197">media_cache.c:197</a></div></div>
<div class="ttc" id="file_8c_html_a9693d0bc24ee3d83d6e252a7c2c7c469"><div class="ttname"><a href="../../d6/d13/file_8c.html#a9693d0bc24ee3d83d6e252a7c2c7c469">is_remote_path</a></div><div class="ttdeci">static int is_remote_path(const char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00645">file.c:645</a></div></div>
<div class="ttc" id="file_8c_html_a248e5c086666b04d29a9cd876ad370b3"><div class="ttname"><a href="../../d6/d13/file_8c.html#a248e5c086666b04d29a9cd876ad370b3">ast_language_is_prefix</a></div><div class="ttdeci">int ast_language_is_prefix</div><div class="ttdoc">The following variable controls the layout of localized sound files. If 0, use the historical layout ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00067">file.c:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a083568a210b02e2a6985923817b6e4dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a083568a210b02e2a6985923817b6e4dc">&#9670;&nbsp;</a></span>filehelper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int filehelper </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>arg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const enum <a class="el" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01">file_action</a>&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00514">514</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00500">ACTION_COPY</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00497">ACTION_DELETE</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00496">ACTION_EXISTS</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00499">ACTION_OPEN</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00498">ACTION_RENAME</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00621">ast_channel_stream()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00625">ast_channel_stream_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00629">ast_channel_vstream()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00633">ast_channel_vstream_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00860">ast_channel_writeformat()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01068">ast_closestream()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00103">ast_format_cap_append</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00201">ast_format_cmp()</a>, <a class="el" href="../../d0/d0a/format_8h_source.html#l00038">AST_FORMAT_CMP_NOT_EQUAL</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00354">ast_format_get_type()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00033">AST_MEDIA_TYPE_VIDEO</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00314">build_filename()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00271">copy()</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00147">ext</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00351">exts_compare</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00117">ast_filestream::f</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00107">ast_filestream::filename</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00428">get_filestream()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00115">ast_filestream::lasttimeout</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00490">open_wrapper()</a>, <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00112">ast_filestream::trans</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01108">ast_filecopy()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01098">ast_filedelete()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01103">ast_filerename()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00760">ast_openstream_full()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00812">ast_openvstream()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00656">fileexists_test()</a>.</p>
<div class="fragment"><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;{</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <span class="keywordtype">int</span> res = (action == <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a>) ? 0 : -1;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <span class="comment">/* Check for a specific format */</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, f, <a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>) {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="keywordtype">char</span> storage[strlen(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>) + 1];</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordtype">char</span> *stringp;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">if</span> (fmt &amp;&amp; !<a class="code" href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>, fmt))</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="comment">/* Look for a file matching the supported extensions.</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">       * The file must exist, and for OPEN, must match</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">       * one of the formats supported by the channel.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      strcpy(storage, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>); <span class="comment">/* safe - this is in the stack so does not need to be freed */</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      stringp = storage;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">while</span> ( (ext = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;stringp, <span class="stringliteral">&quot;|&quot;</span>)) ) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;         <span class="keyword">struct </span>stat st;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;         <span class="keywordtype">char</span> *fn = <a class="code" href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a>(filename, ext);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <span class="keywordflow">if</span> (fn == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         <span class="keywordflow">if</span> ( stat(fn, &amp;st) ) { <span class="comment">/* file not existent */</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;         }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         <span class="comment">/* for &#39;OPEN&#39; we need to be sure that the format matches</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">          * what the channel can process</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;         <span class="keywordflow">if</span> (action == <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a>) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = (<span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *)arg2;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            FILE *bfile;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a>(chan), f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a>) &amp;&amp;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                 !(((<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>) &amp;&amp; <a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>) ||</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                 ((<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>) &amp;&amp; <a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>))) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;               <span class="keywordflow">continue</span>;   <span class="comment">/* not a supported format */</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">if</span> ( (bfile = fopen(fn, <span class="stringliteral">&quot;r&quot;</span>)) == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;               <span class="keywordflow">continue</span>;   <span class="comment">/* cannot open file */</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            s = <a class="code" href="../../d6/d13/file_8c.html#a3e809ea7be0413c527df113a695552b8">get_filestream</a>(f, bfile);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;               fclose(bfile);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);  <span class="comment">/* cannot allocate descriptor */</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d13/file_8c.html#ac17ab5a9432e8fbe75d7968221897716">open_wrapper</a>(s)) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;               <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(s);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;               <span class="keywordflow">continue</span>;   <span class="comment">/* cannot run open on file */</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">if</span> (st.st_size == 0) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;File %s detected to have zero size.\n&quot;</span>, fn);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="comment">/* ok this is good for OPEN */</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            res = 1; <span class="comment">/* found */</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">lasttimeout</a> = -1;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a> = <a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(chan))</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                  <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(chan));</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#a1460c260bdadfa226b95598a7d9d44a7">ast_channel_stream_set</a>(chan, s);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a>(chan))</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                  <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a>(chan));</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#afafaea2cd08a0d993f5d667f4cfefd9e">ast_channel_vstream_set</a>(chan, s);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;         }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         <span class="keywordflow">switch</span> (action) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a>:</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keywordflow">break</span>;   <span class="comment">/* will never get here */</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a>:  <span class="comment">/* return the matching format */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="comment">/* if arg2 is present, it is a format capabilities structure.</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">             * Add this format to the set of formats this file can be played in */</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">if</span> (arg2) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;               <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>((<span class="keyword">struct</span> <a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *) arg2, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>, 0);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            res = 1; <span class="comment">/* file does exist and format it exists in is returned in arg2 */</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904">ACTION_DELETE</a>:</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keywordflow">if</span> ( (res = unlink(fn)) )</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;unlink(%s) failed: %s\n&quot;</span>, fn, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6">ACTION_RENAME</a>:</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a>: {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="keywordtype">char</span> *nfn = <a class="code" href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a>((<span class="keyword">const</span> <span class="keywordtype">char</span> *)arg2, ext);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">if</span> (!nfn)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Out of memory\n&quot;</span>);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;               res = action == <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a> ? <a class="code" href="../../d6/d13/file_8c.html#a939eb1d85b6fd5dfc16d00d1c3f86df0">copy</a>(fn, nfn) : rename(fn, nfn);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;               <span class="keywordflow">if</span> (res)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s(%s,%s) failed: %s\n&quot;</span>,</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                     action == <a class="code" href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a> ? <span class="stringliteral">&quot;copy&quot;</span> : <span class="stringliteral">&quot;rename&quot;</span>,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                      fn, nfn, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(nfn);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;             }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown helper %u\n&quot;</span>, action);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;         }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fn);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a04bda3b7d3fbe904b2d0c85602e73cc7">ACTION_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00499">file.c:499</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="format_8h_html_a0aba6e17ced3e85e838ea097baa5ddc7"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a></div><div class="ttdeci">enum ast_media_type ast_format_get_type(const struct ast_format *format)</div><div class="ttdoc">Get the media type of a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00354">format.c:354</a></div></div>
<div class="ttc" id="channel_8h_html_a8b8f9e299537c8eee7cb67de52f44c8d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a8b8f9e299537c8eee7cb67de52f44c8d">ast_channel_vstream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_vstream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00629">channel_internal_api.c:629</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a3ed1ec6240a2d6ba30efbcdfc6470975">ACTION_EXISTS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00496">file.c:496</a></div></div>
<div class="ttc" id="file_8c_html_ad60e6b6fb8b8078dc9e4deda4ffbde10"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad60e6b6fb8b8078dc9e4deda4ffbde10">exts_compare</a></div><div class="ttdeci">#define exts_compare(list, type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00351">file.c:351</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="file_8c_html_a3e809ea7be0413c527df113a695552b8"><div class="ttname"><a href="../../d6/d13/file_8c.html#a3e809ea7be0413c527df113a695552b8">get_filestream</a></div><div class="ttdeci">static struct ast_filestream * get_filestream(struct ast_format_def *fmt, FILE *bfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00428">file.c:428</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a92f147f69db5353fd464f636eaf02904">ACTION_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00497">file.c:497</a></div></div>
<div class="ttc" id="channel_8h_html_afafaea2cd08a0d993f5d667f4cfefd9e"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afafaea2cd08a0d993f5d667f4cfefd9e">ast_channel_vstream_set</a></div><div class="ttdeci">void ast_channel_vstream_set(struct ast_channel *chan, struct ast_filestream *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00633">channel_internal_api.c:633</a></div></div>
<div class="ttc" id="file_8c_html_ab53bd2c3c55d509790c7f7620aac6373"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a></div><div class="ttdeci">int ast_closestream(struct ast_filestream *f)</div><div class="ttdoc">Closes a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01068">file.c:1068</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="http_8c_html_af9b32121c4ad80b0887a3d73fd24de5f"><div class="ttname"><a href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a></div><div class="ttdeci">const char * ext</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00147">http.c:147</a></div></div>
<div class="ttc" id="file_8c_html_ac17ab5a9432e8fbe75d7968221897716"><div class="ttname"><a href="../../d6/d13/file_8c.html#ac17ab5a9432e8fbe75d7968221897716">open_wrapper</a></div><div class="ttdeci">static int open_wrapper(struct ast_filestream *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00490">file.c:490</a></div></div>
<div class="ttc" id="channel_8h_html_a1460c260bdadfa226b95598a7d9d44a7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1460c260bdadfa226b95598a7d9d44a7">ast_channel_stream_set</a></div><div class="ttdeci">void ast_channel_stream_set(struct ast_channel *chan, struct ast_filestream *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00625">channel_internal_api.c:625</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="file_8c_html_a2a836416f6627399f3b75ef2705bcd89"><div class="ttname"><a href="../../d6/d13/file_8c.html#a2a836416f6627399f3b75ef2705bcd89">build_filename</a></div><div class="ttdeci">static char * build_filename(const char *filename, const char *ext)</div><div class="ttdoc">construct a filename. Absolute pathnames are preserved, relative names are prefixed by the sounds/ di...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00314">file.c:314</a></div></div>
<div class="ttc" id="format_8h_html_a738c58eca291b71de4422e95bff27400"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a738c58eca291b71de4422e95bff27400">ast_format_cmp</a></div><div class="ttdeci">enum ast_format_cmp_res ast_format_cmp(const struct ast_format *format1, const struct ast_format *format2)</div><div class="ttdoc">Compare two formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00201">format.c:201</a></div></div>
<div class="ttc" id="format_8h_html_a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a79bdf0b3c0616d9950d00cfeb62295c3ad88eb6e1d9b89b5e60412393b887391c">AST_FORMAT_CMP_NOT_EQUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d0a/format_8h_source.html#l00038">format.h:38</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01ae266c94c6d3f3d0940c34c798e5842a6">ACTION_RENAME</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00498">file.c:498</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="format__cap_8h_html_ab4d69f2179ed5ca138c9b3d85334217f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a></div><div class="ttdeci">#define ast_format_cap_append(cap, format, framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00103">format_cap.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__filestream_html_ad98134a98f3e3e3b5611a5fd2117e8e4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">ast_filestream::trans</a></div><div class="ttdeci">struct ast_trans_pvt * trans</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00112">mod_format.h:112</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="channel_8h_html_a043ef90a065fe177af7b21a6045b6506"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_stream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00621">channel_internal_api.c:621</a></div></div>
<div class="ttc" id="structast__filestream_html_a486275f508390f690dcd44b31e4d0e87"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a486275f508390f690dcd44b31e4d0e87">ast_filestream::lasttimeout</a></div><div class="ttdeci">int lasttimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00115">mod_format.h:115</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="structast__filestream_html_aeac90097f29f7529968697163cea5c18"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">ast_filestream::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00107">mod_format.h:107</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="structast__filestream_html_a3efb0e1a16208deecbd84c15401f7cf8"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">ast_filestream::f</a></div><div class="ttdeci">FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00117">mod_format.h:117</a></div></div>
<div class="ttc" id="file_8c_html_a939eb1d85b6fd5dfc16d00d1c3f86df0"><div class="ttname"><a href="../../d6/d13/file_8c.html#a939eb1d85b6fd5dfc16d00d1c3f86df0">copy</a></div><div class="ttdeci">static int copy(const char *infile, const char *outfile)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00271">file.c:271</a></div></div>
<div class="ttc" id="channel_8h_html_a1dc625bd14a7875b04bfe0c388858929"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a></div><div class="ttdeci">struct ast_format * ast_channel_writeformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00860">channel_internal_api.c:860</a></div></div>
<div class="ttc" id="file_8c_html_a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8944b5bc4c79736a07589a3761113d01a7930542f31154bb3b8a33654af6cfd4f">ACTION_COPY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00500">file.c:500</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8897ad04ddc571f5ac100a1b53774ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8897ad04ddc571f5ac100a1b53774ec2">&#9670;&nbsp;</a></span>filestream_close()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void filestream_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00357">357</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00729">ast_channel_sched()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00625">ast_channel_stream_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00461">ast_channel_streamid()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00465">ast_channel_streamid_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00633">ast_channel_vstream_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00493">ast_channel_vstreamid()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00497">ast_channel_vstreamid_set()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00354">ast_format_get_type()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00279">AST_LOG_WARNING</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00033">AST_MEDIA_TYPE_VIDEO</a>, <a class="el" href="../../d7/d00/sched_8h_source.html#l00059">AST_SCHED_DEL_ACCESSOR</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l03189">ast_settimeout()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00116">ast_filestream::owner</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01068">ast_closestream()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00383">filestream_destructor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;{</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> format_type = <a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordflow">if</span> (!f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>) {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="comment">/* Stop a running stream if there is one */</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordflow">switch</span> (format_type)</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>:</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a1460c260bdadfa226b95598a7d9d44a7">ast_channel_stream_set</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a4fd72f8ebc171a71262c76e2c44ba204">AST_SCHED_DEL_ACCESSOR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d5/d7b/channel_8h.html#aca669cf3bcacc3152088c9e5057f4239">ast_channel_streamid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a66789713c3657752cc9f502c4cf1d2ea">ast_channel_streamid_set</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#abb39926813ff8874f8e453ca04307e53">ast_settimeout</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>:</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#afafaea2cd08a0d993f5d667f4cfefd9e">ast_channel_vstream_set</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#a4fd72f8ebc171a71262c76e2c44ba204">AST_SCHED_DEL_ACCESSOR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>), f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">owner</a>, <a class="code" href="../../d5/d7b/channel_8h.html#aae48d814858685831ed81f08064404b9">ast_channel_vstreamid</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a58ac5000cfdf1493ae0e8ca02a04faf7">ast_channel_vstreamid_set</a>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to schedule deletion of filestream with unsupported type %s\n&quot;</span>, f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div><div class="ttc" id="channel_8h_html_aae48d814858685831ed81f08064404b9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aae48d814858685831ed81f08064404b9">ast_channel_vstreamid</a></div><div class="ttdeci">int ast_channel_vstreamid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00493">channel_internal_api.c:493</a></div></div>
<div class="ttc" id="format_8h_html_a0aba6e17ced3e85e838ea097baa5ddc7"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a></div><div class="ttdeci">enum ast_media_type ast_format_get_type(const struct ast_format *format)</div><div class="ttdoc">Get the media type of a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00354">format.c:354</a></div></div>
<div class="ttc" id="logger_8h_html_a2878d83e36d91850732bad997524e45e"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a></div><div class="ttdeci">#define AST_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00279">logger.h:279</a></div></div>
<div class="ttc" id="channel_8h_html_afafaea2cd08a0d993f5d667f4cfefd9e"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afafaea2cd08a0d993f5d667f4cfefd9e">ast_channel_vstream_set</a></div><div class="ttdeci">void ast_channel_vstream_set(struct ast_channel *chan, struct ast_filestream *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00633">channel_internal_api.c:633</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="channel_8h_html_a1460c260bdadfa226b95598a7d9d44a7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1460c260bdadfa226b95598a7d9d44a7">ast_channel_stream_set</a></div><div class="ttdeci">void ast_channel_stream_set(struct ast_channel *chan, struct ast_filestream *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00625">channel_internal_api.c:625</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="channel_8h_html_abb39926813ff8874f8e453ca04307e53"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abb39926813ff8874f8e453ca04307e53">ast_settimeout</a></div><div class="ttdeci">int ast_settimeout(struct ast_channel *c, unsigned int rate, int(*func)(const void *data), void *data)</div><div class="ttdoc">Enable or disable timer ticks for a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l03189">channel.c:3189</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="sched_8h_html_a4fd72f8ebc171a71262c76e2c44ba204"><div class="ttname"><a href="../../d7/d00/sched_8h.html#a4fd72f8ebc171a71262c76e2c44ba204">AST_SCHED_DEL_ACCESSOR</a></div><div class="ttdeci">#define AST_SCHED_DEL_ACCESSOR(sched, obj, getter, setter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d00/sched_8h_source.html#l00059">sched.h:59</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="channel_8h_html_acd3470664b6a002c9a379a69ddad4cb2"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a></div><div class="ttdeci">struct ast_sched_context * ast_channel_sched(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00729">channel_internal_api.c:729</a></div></div>
<div class="ttc" id="channel_8h_html_aca669cf3bcacc3152088c9e5057f4239"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aca669cf3bcacc3152088c9e5057f4239">ast_channel_streamid</a></div><div class="ttdeci">int ast_channel_streamid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00461">channel_internal_api.c:461</a></div></div>
<div class="ttc" id="structast__filestream_html_a9241175b397dfd032c4cadbc8c9c2d05"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a9241175b397dfd032c4cadbc8c9c2d05">ast_filestream::owner</a></div><div class="ttdeci">struct ast_channel * owner</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00116">mod_format.h:116</a></div></div>
<div class="ttc" id="channel_8h_html_a66789713c3657752cc9f502c4cf1d2ea"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a66789713c3657752cc9f502c4cf1d2ea">ast_channel_streamid_set</a></div><div class="ttdeci">void ast_channel_streamid_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00465">channel_internal_api.c:465</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a></div><div class="ttdeci">ast_media_type</div><div class="ttdoc">Types of media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00030">codec.h:30</a></div></div>
<div class="ttc" id="channel_8h_html_a58ac5000cfdf1493ae0e8ca02a04faf7"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a58ac5000cfdf1493ae0e8ca02a04faf7">ast_channel_vstreamid_set</a></div><div class="ttdeci">void ast_channel_vstreamid_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00497">channel_internal_api.c:497</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a776a9332979114886ee9fbf55bab1801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776a9332979114886ee9fbf55bab1801">&#9670;&nbsp;</a></span>filestream_destructor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void filestream_destructor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00383">383</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01068">ast_closestream()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00469">ast_module_unref</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l03047">ast_safe_fork()</a>, <a class="el" href="../../de/d43/translate_8c_source.html#l00475">ast_translator_free_path()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00077">ast_format_def::close</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00117">ast_filestream::f</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00107">ast_filestream::filename</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00357">filestream_close()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">ast_frame_subclass::format</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00122">ast_filestream::fr</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00114">ast_filestream::lastwriteformat</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00093">ast_format_def::module</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00125">ast_filestream::orig_chan_name</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00108">ast_filestream::realfilename</a>, <a class="el" href="../../d4/dd1/compiler_8h_source.html#l00087">SENTINEL</a>, <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00146">status</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00112">ast_filestream::trans</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00110">ast_filestream::vfs</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00126">ast_filestream::write_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00428">get_filestream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;{</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a> = arg;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="keywordtype">int</span> pid = -1;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="comment">/* Stop a running stream if there is one */</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <a class="code" href="../../d6/d13/file_8c.html#a8897ad04ddc571f5ac100a1b53774ec2">filestream_close</a>(f);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <span class="comment">/* destroy the translator on exit */</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="../../db/d39/translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207">ast_translator_free_path</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">trans</a>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab5ecb89d68cdad4b69dea730f90f9319">close</a>) {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      void (*closefn)(<span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *) = f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab5ecb89d68cdad4b69dea730f90f9319">close</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      closefn(f);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      fclose(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a198a1121327381d95b1bb6c501e38333">realfilename</a> &amp;&amp; f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      pid = <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a7a4c7e208ffc4d11a1918beb0e920ec0">ast_safe_fork</a>(0);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">if</span> (!pid) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;         execl(<span class="stringliteral">&quot;/bin/mv&quot;</span>, <span class="stringliteral">&quot;mv&quot;</span>, <span class="stringliteral">&quot;-f&quot;</span>, f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>, f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a198a1121327381d95b1bb6c501e38333">realfilename</a>, <a class="code" href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a>);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;         _exit(1);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pid &gt; 0) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         <span class="comment">/* Block the parent until the move is complete.*/</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;         waitpid(pid, &amp;status, 0);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">filename</a>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a198a1121327381d95b1bb6c501e38333">realfilename</a>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="keywordflow">if</span> (f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a>)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">vfs</a>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a6de7f628c7786f3686214488c8edfc27">write_buffer</a>);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">void</span> *)f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#afa3ba2491683e48895a1e174f7bd7431">orig_chan_name</a>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#ac7d6a578d1d7ec8696b068dd9446580e">lastwriteformat</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">fr</a>.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(f-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ab5ecb89d68cdad4b69dea730f90f9319"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab5ecb89d68cdad4b69dea730f90f9319">ast_format_def::close</a></div><div class="ttdeci">void(* close)(struct ast_filestream *)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00077">mod_format.h:77</a></div></div>
<div class="ttc" id="file_8c_html_a8897ad04ddc571f5ac100a1b53774ec2"><div class="ttname"><a href="../../d6/d13/file_8c.html#a8897ad04ddc571f5ac100a1b53774ec2">filestream_close</a></div><div class="ttdeci">static void filestream_close(struct ast_filestream *f)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00357">file.c:357</a></div></div>
<div class="ttc" id="structast__filestream_html_a198a1121327381d95b1bb6c501e38333"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a198a1121327381d95b1bb6c501e38333">ast_filestream::realfilename</a></div><div class="ttdeci">char * realfilename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00108">mod_format.h:108</a></div></div>
<div class="ttc" id="file_8c_html_ab53bd2c3c55d509790c7f7620aac6373"><div class="ttname"><a href="../../d6/d13/file_8c.html#ab53bd2c3c55d509790c7f7620aac6373">ast_closestream</a></div><div class="ttdeci">int ast_closestream(struct ast_filestream *f)</div><div class="ttdoc">Closes a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01068">file.c:1068</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="module_8h_html_a15896c26e51e8162df5eb9a0124c841f"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a></div><div class="ttdeci">#define ast_module_unref(mod)</div><div class="ttdoc">Release a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00469">module.h:469</a></div></div>
<div class="ttc" id="structast__filestream_html_a6de7f628c7786f3686214488c8edfc27"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a6de7f628c7786f3686214488c8edfc27">ast_filestream::write_buffer</a></div><div class="ttdeci">char * write_buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00126">mod_format.h:126</a></div></div>
<div class="ttc" id="structast__format__def_html_a8637433cfbb88aeb10ce2ed5dcba0eb1"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">ast_format_def::module</a></div><div class="ttdeci">struct ast_module * module</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00093">mod_format.h:93</a></div></div>
<div class="ttc" id="compiler_8h_html_af2af475b85aef66019c417d8ded1c435"><div class="ttname"><a href="../../d4/dd1/compiler_8h.html#af2af475b85aef66019c417d8ded1c435">SENTINEL</a></div><div class="ttdeci">#define SENTINEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd1/compiler_8h_source.html#l00087">compiler.h:87</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__filestream_html_afa3ba2491683e48895a1e174f7bd7431"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#afa3ba2491683e48895a1e174f7bd7431">ast_filestream::orig_chan_name</a></div><div class="ttdeci">const char * orig_chan_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00125">mod_format.h:125</a></div></div>
<div class="ttc" id="structast__filestream_html_a0e0e3398d4f54057ddca440cae05f3d4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">ast_filestream::fr</a></div><div class="ttdeci">struct ast_frame fr</div><div class="ttdoc">frame produced by read, typically </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00122">mod_format.h:122</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a7a4c7e208ffc4d11a1918beb0e920ec0"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a7a4c7e208ffc4d11a1918beb0e920ec0">ast_safe_fork</a></div><div class="ttdeci">int ast_safe_fork(int stop_reaper)</div><div class="ttdoc">Common routine to safely fork without a chance of a signal handler firing badly in the child...</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l03047">main/app.c:3047</a></div></div>
<div class="ttc" id="structast__filestream_html_ad98134a98f3e3e3b5611a5fd2117e8e4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ad98134a98f3e3e3b5611a5fd2117e8e4">ast_filestream::trans</a></div><div class="ttdeci">struct ast_trans_pvt * trans</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00112">mod_format.h:112</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__filestream_html_ac7d6a578d1d7ec8696b068dd9446580e"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#ac7d6a578d1d7ec8696b068dd9446580e">ast_filestream::lastwriteformat</a></div><div class="ttdeci">struct ast_format * lastwriteformat</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00114">mod_format.h:114</a></div></div>
<div class="ttc" id="structast__filestream_html_aeac90097f29f7529968697163cea5c18"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#aeac90097f29f7529968697163cea5c18">ast_filestream::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00107">mod_format.h:107</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__filestream_html_a3efb0e1a16208deecbd84c15401f7cf8"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">ast_filestream::f</a></div><div class="ttdeci">FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00117">mod_format.h:117</a></div></div>
<div class="ttc" id="structast__filestream_html_a084d8f087c50442f51245ec3333abac4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a084d8f087c50442f51245ec3333abac4">ast_filestream::vfs</a></div><div class="ttdeci">struct ast_filestream * vfs</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00110">mod_format.h:110</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
<div class="ttc" id="translate_8h_html_a8f767bf5c2095f182e7cbaa73e391207"><div class="ttname"><a href="../../db/d39/translate_8h.html#a8f767bf5c2095f182e7cbaa73e391207">ast_translator_free_path</a></div><div class="ttdeci">void ast_translator_free_path(struct ast_trans_pvt *tr)</div><div class="ttdoc">Frees a translator path Frees the given translator path structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d43/translate_8c_source.html#l00475">translate.c:475</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac764765c2aa449eb5840087a2148e5ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac764765c2aa449eb5840087a2148e5ef">&#9670;&nbsp;</a></span>fn_wrapper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int fn_wrapper </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137">wrap_fn</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00468">468</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00056">ast_format_def::open</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00064">ast_format_def::rewrite</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00466">WRAP_OPEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00490">open_wrapper()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00485">rewrite_wrapper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f = s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keywordtype">int</span> ret = -1;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   int (*openfn)(<span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a> == <a class="code" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150">WRAP_OPEN</a> &amp;&amp; (openfn = f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#aaee5540c8ecc184fc3bad31bdabcd5fd">open</a>) &amp;&amp; openfn(s))</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to open format %s\n&quot;</span>, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">mode</a> == <a class="code" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f">WRAP_REWRITE</a> &amp;&amp; f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a32434483e3b40797e6fc9e6d7b46a714">rewrite</a> &amp;&amp; f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a32434483e3b40797e6fc9e6d7b46a714">rewrite</a>(s, <a class="code" href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a>))</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unable to rewrite format %s\n&quot;</span>, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="keywordflow">else</span> {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="comment">/* preliminary checks succeed. */</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      ret = 0;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div><div class="ttc" id="file_8c_html_a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150">WRAP_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00466">file.c:466</a></div></div>
<div class="ttc" id="file_8c_html_a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f">WRAP_REWRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00466">file.c:466</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="structast__format__def_html_aaee5540c8ecc184fc3bad31bdabcd5fd"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#aaee5540c8ecc184fc3bad31bdabcd5fd">ast_format_def::open</a></div><div class="ttdeci">int(* open)(struct ast_filestream *s)</div><div class="ttdoc">Prepare an input stream for playback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00056">mod_format.h:56</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__format__def_html_a32434483e3b40797e6fc9e6d7b46a714"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a32434483e3b40797e6fc9e6d7b46a714">ast_format_def::rewrite</a></div><div class="ttdeci">int(* rewrite)(struct ast_filestream *s, const char *comment)</div><div class="ttdoc">Prepare a stream for output, and comment it appropriately if applicable. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00064">mod_format.h:64</a></div></div>
<div class="ttc" id="ael__lex_8c_html_a43be22b7a1b528eaf759e034ec581543"><div class="ttname"><a href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a></div><div class="ttdeci">#define comment</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7e/ael__lex_8c_source.html#l00976">ael_lex.c:976</a></div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="structast__filestream_html_adc8d3cf511ceb277aea0cfa1cd027c59"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#adc8d3cf511ceb277aea0cfa1cd027c59">ast_filestream::mode</a></div><div class="ttdeci">mode_t mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00105">mod_format.h:105</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e809ea7be0413c527df113a695552b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e809ea7be0413c527df113a695552b8">&#9670;&nbsp;</a></span>get_filestream()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a>* get_filestream </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *&#160;</td>
          <td class="paramname"><em>fmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>bfile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00428">428</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00124">ast_filestream::_private</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00354">ast_format_get_type()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00103">AST_FRAME_VIDEO</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00033">AST_MEDIA_TYPE_VIDEO</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00455">ast_module_running_ref</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00469">ast_module_unref</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00123">ast_filestream::buf</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00090">ast_format_def::buf_size</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00091">ast_format_def::desc_size</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00117">ast_filestream::f</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00383">filestream_destructor()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">ast_frame_subclass::format</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00122">ast_filestream::fr</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../dc/df2/ast__expr2f_8c_source.html#l00868">if()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00175">ast_frame::mallocd</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00093">ast_format_def::module</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00181">ast_frame::src</a>, and <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01309">ast_readfile()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01361">ast_writefile()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;{</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *s;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordtype">int</span> l = <span class="keyword">sizeof</span>(*s) + fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">buf_size</a> + fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a0f96ba898b665b247108f83d84ce412c">desc_size</a>;  <span class="comment">/* total allocation size */</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d16/module_8h.html#ad2dd3dce05926913c40b883cc7cff0a8">ast_module_running_ref</a>(fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>)) {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   s = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(l, <a class="code" href="../../d6/d13/file_8c.html#a776a9332979114886ee9fbf55bab1801">filestream_destructor</a>);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <span class="keywordflow">if</span> (!s) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a> = <a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">f</a> = bfile;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="keywordflow">if</span> (fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a0f96ba898b665b247108f83d84ce412c">desc_size</a>)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a1cb76d737bf6f5b53e6c970073cba051">_private</a> = ((<span class="keywordtype">char</span> *)(s + 1)) + fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">buf_size</a>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a> (fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">buf_size</a>)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a1fe855c208bc17a51a4d34fefdb2d5b1">buf</a> = (<span class="keywordtype">char</span> *)(s + 1);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">fr</a>.<a class="code" href="../../d0/d99/structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">src</a> = fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">fr</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a>(fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">fr</a>.<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a> = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a17ae96b6ea8a2388bb0d409e8124ff30">AST_FRAME_VIDEO</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">fr</a>.<a class="code" href="../../d0/d99/structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">mallocd</a> = 0;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">fr</a>.<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">format</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(fmt-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <span class="keywordflow">return</span> s;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div><div class="ttc" id="format_8h_html_a0aba6e17ced3e85e838ea097baa5ddc7"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a0aba6e17ced3e85e838ea097baa5ddc7">ast_format_get_type</a></div><div class="ttdeci">enum ast_media_type ast_format_get_type(const struct ast_format *format)</div><div class="ttdoc">Get the media type of a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00354">format.c:354</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a33e91cd0cef6786e9e3a27ac67707207"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a33e91cd0cef6786e9e3a27ac67707207">if</a></div><div class="ttdeci">if(!yyg-&gt;yy_init)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00868">ast_expr2f.c:868</a></div></div>
<div class="ttc" id="structast__format__def_html_a0f96ba898b665b247108f83d84ce412c"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a0f96ba898b665b247108f83d84ce412c">ast_format_def::desc_size</a></div><div class="ttdeci">int desc_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00091">mod_format.h:91</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="module_8h_html_a15896c26e51e8162df5eb9a0124c841f"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a></div><div class="ttdeci">#define ast_module_unref(mod)</div><div class="ttdoc">Release a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00469">module.h:469</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structast__format__def_html_a8637433cfbb88aeb10ce2ed5dcba0eb1"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">ast_format_def::module</a></div><div class="ttdeci">struct ast_module * module</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00093">mod_format.h:93</a></div></div>
<div class="ttc" id="structast__frame_html_af51e37c9331049b1e3d250a7c8bc3c26"><div class="ttname"><a href="../../d0/d99/structast__frame.html#af51e37c9331049b1e3d250a7c8bc3c26">ast_frame::src</a></div><div class="ttdeci">const char * src</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00181">include/asterisk/frame.h:181</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="structast__filestream_html_a0e0e3398d4f54057ddca440cae05f3d4"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a0e0e3398d4f54057ddca440cae05f3d4">ast_filestream::fr</a></div><div class="ttdeci">struct ast_frame fr</div><div class="ttdoc">frame produced by read, typically </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00122">mod_format.h:122</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="structast__filestream_html_a1cb76d737bf6f5b53e6c970073cba051"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a1cb76d737bf6f5b53e6c970073cba051">ast_filestream::_private</a></div><div class="ttdeci">void * _private</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00124">mod_format.h:124</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="structast__format__def_html_a4c813abab25e4df4e95d8f0b0ca61500"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a4c813abab25e4df4e95d8f0b0ca61500">ast_format_def::buf_size</a></div><div class="ttdeci">int buf_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00090">mod_format.h:90</a></div></div>
<div class="ttc" id="structast__frame_html_aed16590d48f41d89f31e0cf347f5cd99"><div class="ttname"><a href="../../d0/d99/structast__frame.html#aed16590d48f41d89f31e0cf347f5cd99">ast_frame::mallocd</a></div><div class="ttdeci">int mallocd</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00175">include/asterisk/frame.h:175</a></div></div>
<div class="ttc" id="module_8h_html_ad2dd3dce05926913c40b883cc7cff0a8"><div class="ttname"><a href="../../d5/d16/module_8h.html#ad2dd3dce05926913c40b883cc7cff0a8">ast_module_running_ref</a></div><div class="ttdeci">#define ast_module_running_ref(mod)</div><div class="ttdoc">Hold a reference to the module if it is running. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00455">module.h:455</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="structast__filestream_html"><div class="ttname"><a href="../../db/dbc/structast__filestream.html">ast_filestream</a></div><div class="ttdoc">This structure is allocated by file.c in one chunk, together with buf_size and desc_size bytes of mem...</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00101">mod_format.h:101</a></div></div>
<div class="ttc" id="structast__filestream_html_a3efb0e1a16208deecbd84c15401f7cf8"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a3efb0e1a16208deecbd84c15401f7cf8">ast_filestream::f</a></div><div class="ttdeci">FILE * f</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00117">mod_format.h:117</a></div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#ab425a484a0916077c5a30d9d7b229b44">ast_frame_subclass::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00155">include/asterisk/frame.h:155</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0a17ae96b6ea8a2388bb0d409e8124ff30"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a17ae96b6ea8a2388bb0d409e8124ff30">AST_FRAME_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00103">include/asterisk/frame.h:103</a></div></div>
<div class="ttc" id="file_8c_html_a776a9332979114886ee9fbf55bab1801"><div class="ttname"><a href="../../d6/d13/file_8c.html#a776a9332979114886ee9fbf55bab1801">filestream_destructor</a></div><div class="ttdeci">static void filestream_destructor(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00383">file.c:383</a></div></div>
<div class="ttc" id="structast__filestream_html_a1fe855c208bc17a51a4d34fefdb2d5b1"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a1fe855c208bc17a51a4d34fefdb2d5b1">ast_filestream::buf</a></div><div class="ttdeci">char * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00123">mod_format.h:123</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac71e8d82ba7e263ff1d3ec9dbade3848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac71e8d82ba7e263ff1d3ec9dbade3848">&#9670;&nbsp;</a></span>handle_cli_core_show_file_formats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char* handle_cli_core_show_file_formats </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *&#160;</td>
          <td class="paramname"><em>a</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01902">1902</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/db0/cli_8h_source.html#l00160">ast_cli_args::argc</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00006">ast_cli()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00334">ast_format_get_name()</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00077">AST_RWLIST_RDLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00493">AST_RWLIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00150">AST_RWLIST_UNLOCK</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00153">CLI_GENERATE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00152">CLI_INIT</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00045">CLI_SHOWUSAGE</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00044">CLI_SUCCESS</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00186">ast_cli_entry::command</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00159">ast_cli_args::fd</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d13/file_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <a class="el" href="../../d6/d13/file_8c.html#acfd58ce0ec836919236d7a1908494970">FORMAT2</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../dc/db0/cli_8h_source.html#l00177">ast_cli_entry::usage</a>.</p>
<div class="fragment"><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;{</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#define FORMAT &quot;%-10s %-10s %-20s\n&quot;</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="preprocessor">#define FORMAT2 &quot;%-10s %-10s %-20s\n&quot;</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *f;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;   <span class="keywordtype">int</span> count_fmt = 0;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;core show file formats&quot;</span>;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;         <span class="stringliteral">&quot;Usage: core show file formats\n&quot;</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;         <span class="stringliteral">&quot;       Displays currently registered file formats (if any).\n&quot;</span>;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;   }</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4)</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d6/d13/file_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Format&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;Extensions&quot;</span>);</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d6/d13/file_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;------&quot;</span>, <span class="stringliteral">&quot;----&quot;</span>, <span class="stringliteral">&quot;----------&quot;</span>);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>, f, <a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>) {</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d6/d13/file_8c.html#acfd58ce0ec836919236d7a1908494970">FORMAT2</a>, <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">format</a>), f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      count_fmt++;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   }</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../df/d8d/structformats.html">formats</a>);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%d file formats registered.\n&quot;</span>, count_fmt);</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="preprocessor">#undef FORMAT</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="preprocessor">#undef FORMAT2</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__format__def_html"><div class="ttname"><a href="../../d0/d57/structast__format__def.html">ast_format_def</a></div><div class="ttdoc">Each supported file format is described by the following structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00043">mod_format.h:43</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="structast__format__def_html_ab425a484a0916077c5a30d9d7b229b44"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ab425a484a0916077c5a30d9d7b229b44">ast_format_def::format</a></div><div class="ttdeci">struct ast_format * format</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00048">mod_format.h:48</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="structformats_html"><div class="ttname"><a href="../../df/d8d/structformats.html">formats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00069">file.c:69</a></div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="file_8c_html_acfd58ce0ec836919236d7a1908494970"><div class="ttname"><a href="../../d6/d13/file_8c.html#acfd58ce0ec836919236d7a1908494970">FORMAT2</a></div><div class="ttdeci">#define FORMAT2</div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="file_8c_html_ac8dc47e3b39c930caed4bfd05b4ba805"><div class="ttname"><a href="../../d6/d13/file_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a></div><div class="ttdeci">#define FORMAT</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2ba253f0cfdacc7312206800f7bd2bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2ba253f0cfdacc7312206800f7bd2bb">&#9670;&nbsp;</a></span>is_absolute_path()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int is_absolute_path </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00640">640</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00656">fileexists_test()</a>.</p>
<div class="fragment"><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="keywordflow">return</span> filename[0] == <span class="charliteral">&#39;/&#39;</span>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a9693d0bc24ee3d83d6e252a7c2c7c469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9693d0bc24ee3d83d6e252a7c2c7c469">&#9670;&nbsp;</a></span>is_remote_path()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int is_remote_path </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00645">645</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00656">fileexists_test()</a>.</p>
<div class="fragment"><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;{</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <span class="keywordflow">return</span> strstr(filename, <span class="stringliteral">&quot;://&quot;</span>) ? 1 : 0;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="ad1eca44fecdfccc58cc9ba244c96f88d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1eca44fecdfccc58cc9ba244c96f88d">&#9670;&nbsp;</a></span>json_array_from_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a>* json_array_from_list </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>sep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00074">74</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01017">array()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00368">ast_json_array_append()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00352">ast_json_array_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00067">ast_json_ref()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00268">ast_json_string_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00147">ext</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00093">publish_format_update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, <a class="code" href="../../d9/d1e/func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a>, <a class="code" href="../../d4/d05/json_8h.html#a48d874eed79fb2bbeb0557440e33ae67">ast_json_array_create</a>(), <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <span class="keywordtype">char</span> *stringp, *<a class="code" href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   stringp = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">list</a>);  <span class="comment">/* this is in the stack so does not need to be freed */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d1e/func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a> || !stringp) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="keywordflow">while</span> ((ext = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;stringp, sep))) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#a3d675e52f866630a6a03302df2712b8d">ast_json_array_append</a>(<a class="code" href="../../d9/d1e/func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a>, <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(ext))) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a>(<a class="code" href="../../d9/d1e/func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a>);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div><div class="ttc" id="json_8h_html_a0ca956b7df20127f7e38993c3c06cb2c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a></div><div class="ttdeci">struct ast_json * ast_json_ref(struct ast_json *value)</div><div class="ttdoc">Increase refcount on value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00067">json.c:67</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="http_8c_html_af9b32121c4ad80b0887a3d73fd24de5f"><div class="ttname"><a href="../../dd/d43/http_8c.html#af9b32121c4ad80b0887a3d73fd24de5f">ext</a></div><div class="ttdeci">const char * ext</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00147">http.c:147</a></div></div>
<div class="ttc" id="structast__format__def_html_acbcd73bcf7463776105fa7d63a1f7019"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#acbcd73bcf7463776105fa7d63a1f7019">ast_format_def::list</a></div><div class="ttdeci">struct ast_format_def::@276 list</div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="json_8h_html_adc52f8d76b7fdd0c8d12987981fd5bf5"><div class="ttname"><a href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a></div><div class="ttdeci">struct ast_json * ast_json_string_create(const char *value)</div><div class="ttdoc">Construct a JSON string from value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00268">json.c:268</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="json_8h_html_a48d874eed79fb2bbeb0557440e33ae67"><div class="ttname"><a href="../../d4/d05/json_8h.html#a48d874eed79fb2bbeb0557440e33ae67">ast_json_array_create</a></div><div class="ttdeci">struct ast_json * ast_json_array_create(void)</div><div class="ttdoc">Create a empty JSON array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00352">json.c:352</a></div></div>
<div class="ttc" id="json_8h_html_a3d675e52f866630a6a03302df2712b8d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a3d675e52f866630a6a03302df2712b8d">ast_json_array_append</a></div><div class="ttdeci">int ast_json_array_append(struct ast_json *array, struct ast_json *value)</div><div class="ttdoc">Append to an array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00368">json.c:368</a></div></div>
<div class="ttc" id="func__strings_8c_html_ab6e308b3a41c01e08d252e071511495c"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a></div><div class="ttdeci">static int array(struct ast_channel *chan, const char *cmd, char *var, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01017">func_strings.c:1017</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac17ab5a9432e8fbe75d7968221897716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac17ab5a9432e8fbe75d7968221897716">&#9670;&nbsp;</a></span>open_wrapper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int open_wrapper </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00490">490</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00468">fn_wrapper()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00466">WRAP_OPEN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01309">ast_readfile()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00514">filehelper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#ac764765c2aa449eb5840087a2148e5ef">fn_wrapper</a>(s, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150">WRAP_OPEN</a>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div><div class="ttc" id="file_8c_html_a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137ab717747f3d4bbdfef86f1fd625bb8150">WRAP_OPEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00466">file.c:466</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="file_8c_html_ac764765c2aa449eb5840087a2148e5ef"><div class="ttname"><a href="../../d6/d13/file_8c.html#ac764765c2aa449eb5840087a2148e5ef">fn_wrapper</a></div><div class="ttdeci">static int fn_wrapper(struct ast_filestream *s, const char *comment, enum wrap_fn mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00468">file.c:468</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adda6674956dbac7a613967194e4b26e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adda6674956dbac7a613967194e4b26e7">&#9670;&nbsp;</a></span>publish_format_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int publish_format_update </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d57/structast__format__def.html">ast_format_def</a> *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00093">93</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00591">ast_json_pack()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00735">ast_json_payload_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00347">ast_system_topic()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00045">ast_format_def::exts</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00074">json_array_from_list()</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00044">ast_format_def::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00124">__ast_format_def_register()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l00162">ast_format_def_unregister()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *, json_payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, json_object, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   json_object = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: o}&quot;</span>,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="stringliteral">&quot;format&quot;</span>, f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">name</a>,</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="stringliteral">&quot;extensions&quot;</span>, <a class="code" href="../../d6/d13/file_8c.html#ad1eca44fecdfccc58cc9ba244c96f88d">json_array_from_list</a>(f-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">exts</a>, <span class="stringliteral">&quot;|&quot;</span>));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordflow">if</span> (!json_object) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   json_payload = <a class="code" href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a>(json_object);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordflow">if</span> (!json_payload) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   msg = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(type, json_payload);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="keywordflow">if</span> (!msg) {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../d3/df0/stasis__system_8h.html#a196188f45631aed77434c898ed322ce6">ast_system_topic</a>(), msg);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="ttc" id="structast__format__def_html_ade71f534a49925f1955a1598556219e2"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#ade71f534a49925f1955a1598556219e2">ast_format_def::exts</a></div><div class="ttdeci">char exts[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00045">mod_format.h:45</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="json_8h_html_a8ac267a28e7eddf5b10bbb65139406f2"><div class="ttname"><a href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a></div><div class="ttdeci">struct ast_json_payload * ast_json_payload_create(struct ast_json *json)</div><div class="ttdoc">Create an ao2 object to pass json blobs as data payloads for stasis. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00735">json.c:735</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structast__json__payload_html"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html">ast_json_payload</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01024">json.h:1024</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="structast__format__def_html_a3777dbae63a15da001b2baa317a25149"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a3777dbae63a15da001b2baa317a25149">ast_format_def::name</a></div><div class="ttdeci">char name[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00044">mod_format.h:44</a></div></div>
<div class="ttc" id="stasis__system_8h_html_a196188f45631aed77434c898ed322ce6"><div class="ttname"><a href="../../d3/df0/stasis__system_8h.html#a196188f45631aed77434c898ed322ce6">ast_system_topic</a></div><div class="ttdeci">struct stasis_topic * ast_system_topic(void)</div><div class="ttdoc">A Stasis Message Bus API topic which publishes messages regarding system changes. ...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/da0/stasis__system_8c_source.html#l00347">stasis_system.c:347</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="file_8c_html_ad1eca44fecdfccc58cc9ba244c96f88d"><div class="ttname"><a href="../../d6/d13/file_8c.html#ad1eca44fecdfccc58cc9ba244c96f88d">json_array_from_list</a></div><div class="ttdeci">static struct ast_json * json_array_from_list(const char *list, const char *sep)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00074">file.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d11f27997994d366d52d54a084ec944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d11f27997994d366d52d54a084ec944">&#9670;&nbsp;</a></span>read_frame()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a>* read_frame </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>whennext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00874">874</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00577">ast_frisolate</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00074">ast_format_def::read</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00914">ast_readaudio_callback()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00899">ast_readframe()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00977">ast_readvideo_callback()</a>, and <a class="el" href="../../d9/d4f/audiohook_8c_source.html#l00380">audiohook_read_frame_helper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;{</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *fr, *new_fr;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   <span class="keywordflow">if</span> (!s || !s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>) {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;   <span class="keywordflow">if</span> (!(fr = s-&gt;<a class="code" href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">fmt</a>-&gt;<a class="code" href="../../d0/d57/structast__format__def.html#a51bd67039dff796e2b8ede18560c4f2c">read</a>(s, whennext))) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <span class="keywordflow">if</span> (!(new_fr = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a314496ce1d74ed7fdb9c5319c5e2e953">ast_frisolate</a>(fr))) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="keywordflow">if</span> (new_fr != fr) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      fr = new_fr;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;   }</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;   <span class="keywordflow">return</span> fr;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__filestream_html_a8e5f2c67c624fc84557ef2bdd855ebb9"><div class="ttname"><a href="../../db/dbc/structast__filestream.html#a8e5f2c67c624fc84557ef2bdd855ebb9">ast_filestream::fmt</a></div><div class="ttdeci">struct ast_format_def * fmt</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00103">mod_format.h:103</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a314496ce1d74ed7fdb9c5319c5e2e953"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a314496ce1d74ed7fdb9c5319c5e2e953">ast_frisolate</a></div><div class="ttdeci">#define ast_frisolate(fr)</div><div class="ttdoc">Makes a frame independent of any static storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00577">include/asterisk/frame.h:577</a></div></div>
<div class="ttc" id="structast__format__def_html_a51bd67039dff796e2b8ede18560c4f2c"><div class="ttname"><a href="../../d0/d57/structast__format__def.html#a51bd67039dff796e2b8ede18560c4f2c">ast_format_def::read</a></div><div class="ttdeci">struct ast_frame *(* read)(struct ast_filestream *, int *whennext)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5d/mod__format_8h_source.html#l00074">mod_format.h:74</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbe06882238f9fabfff485fefc6fa619"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbe06882238f9fabfff485fefc6fa619">&#9670;&nbsp;</a></span>rewrite_wrapper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int rewrite_wrapper </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/dbc/structast__filestream.html">ast_filestream</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>comment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00485">485</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d13/file_8c_source.html#l00468">fn_wrapper()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01361">ast_writefile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;{</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d13/file_8c.html#ac764765c2aa449eb5840087a2148e5ef">fn_wrapper</a>(s, <a class="code" href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a>, <a class="code" href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f">WRAP_REWRITE</a>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="ttc" id="file_8c_html_a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4131813449b33963d46e2345c919e137afacafddc383b7c51dfc4fa2082f95d6f">WRAP_REWRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00466">file.c:466</a></div></div>
<div class="ttc" id="file_8c_html_ac764765c2aa449eb5840087a2148e5ef"><div class="ttname"><a href="../../d6/d13/file_8c.html#ac764765c2aa449eb5840087a2148e5ef">fn_wrapper</a></div><div class="ttdeci">static int fn_wrapper(struct ast_filestream *s, const char *comment, enum wrap_fn mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00468">file.c:468</a></div></div>
<div class="ttc" id="ael__lex_8c_html_a43be22b7a1b528eaf759e034ec581543"><div class="ttname"><a href="../../d2/d7e/ael__lex_8c.html#a43be22b7a1b528eaf759e034ec581543">comment</a></div><div class="ttdeci">#define comment</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d7e/ael__lex_8c_source.html#l00976">ael_lex.c:976</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55a8377c040ff899e59b19d08030e255"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55a8377c040ff899e59b19d08030e255">&#9670;&nbsp;</a></span>sanitize_waitstream_return()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sanitize_waitstream_return </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>return_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01759">1759</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00335">AST_CONTROL_STREAM_RESTART</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00333">AST_CONTROL_STREAM_STOP</a>, and <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00334">AST_CONTROL_STREAM_SUSPEND</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01776">ast_waitstream()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01795">ast_waitstream_exten()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01785">ast_waitstream_full()</a>.</p>
<div class="fragment"><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;{</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;   <span class="keywordflow">switch</span> (return_value) {</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa95eb913e6cbbac8a34e69905245fdf4">AST_CONTROL_STREAM_STOP</a>:</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32e9dbe9416e847668084be16d4698c9">AST_CONTROL_STREAM_SUSPEND</a>:</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32b72bba20e26bcd2d5a299c5d939bce">AST_CONTROL_STREAM_RESTART</a>:</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <span class="comment">/* Fall through and set return_value to 0 */</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      return_value = 0;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      <span class="comment">/* Do nothing */</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;   }</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;   <span class="keywordflow">return</span> return_value;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;}</div><div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a32e9dbe9416e847668084be16d4698c9"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32e9dbe9416e847668084be16d4698c9">AST_CONTROL_STREAM_SUSPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00334">include/asterisk/frame.h:334</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a32b72bba20e26bcd2d5a299c5d939bce"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32b72bba20e26bcd2d5a299c5d939bce">AST_CONTROL_STREAM_RESTART</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00335">include/asterisk/frame.h:335</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa95eb913e6cbbac8a34e69905245fdf4"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa95eb913e6cbbac8a34e69905245fdf4">AST_CONTROL_STREAM_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00333">include/asterisk/frame.h:333</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa96fd1a85db890f86168553addfe476d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa96fd1a85db890f86168553addfe476d">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_DEFN() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STASIS_MESSAGE_TYPE_DEFN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d0a/format_8h.html#a50026f039eb9220ff618fa7a4f3a1da1">ast_format_register_type</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a906c80ea10a19fdc90ce783d20f1c454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a906c80ea10a19fdc90ce783d20f1c454">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_DEFN() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STASIS_MESSAGE_TYPE_DEFN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/d0a/format_8h.html#a10e266850ef68354d61ff7207c62781b">ast_format_unregister_type</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a83eba7ef51aed9cd2463a650e497e359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83eba7ef51aed9cd2463a650e497e359">&#9670;&nbsp;</a></span>type_in_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int type_in_list </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const char *s1, const char *s2)&#160;</td>
          <td class="paramname"><em>cmp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00338">338</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d8/d4f/test__config_8c_source.html#l01463">item</a>, and <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01951">ast_get_extension_for_mime_type()</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="keywordtype">char</span> *stringp = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(list), *<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">while</span> ((<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a> = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;stringp, <span class="stringliteral">&quot;|&quot;</span>))) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">if</span> (!cmp(<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="test__config_8c_html_aecdc7cbd5dfa76493c0212caa55d706c"><div class="ttname"><a href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a></div><div class="ttdeci">static struct aco_type item</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/test__config_8c_source.html#l01463">test_config.c:1463</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a82b84e188c383fe736ce31e891ae684c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b84e188c383fe736ce31e891ae684c">&#9670;&nbsp;</a></span>waitstream_control()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void waitstream_control </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6f">ast_waitstream_fr_cb_values</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d4d/file_8h.html#a2d5138e99197a1d01f7a2ed07830476e">ast_waitstream_fr_cb</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>skip_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01509">1509</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00621">ast_channel_stream()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00379">ast_format_get_sample_rate()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01058">ast_stream_fastforward()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01063">ast_stream_rewind()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01048">ast_tellstream()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d2/d4d/file_8h_source.html#l00056">AST_WAITSTREAM_CB_FASTFORWARD</a>, <a class="el" href="../../d2/d4d/file_8h_source.html#l00055">AST_WAITSTREAM_CB_REWIND</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00117">ast_filestream::f</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, and <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01551">waitstream_core()</a>.</p>
<div class="fragment"><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;{</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>)</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   {</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63">AST_WAITSTREAM_CB_FASTFORWARD</a>:</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      {</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;         <span class="keywordtype">int</span> eoftest;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;         <a class="code" href="../../d6/d13/file_8c.html#ac2137b5da91f3408f86d580952f32e94">ast_stream_fastforward</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c), skip_ms);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;         eoftest = fgetc(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)-&gt;f);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;         <span class="keywordflow">if</span> (feof(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)-&gt;f)) {</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <a class="code" href="../../d6/d13/file_8c.html#a4c7c02a659b09bb06dd63e1f42692666">ast_stream_rewind</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c), skip_ms);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            ungetc(eoftest, <a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)-&gt;f);</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;         }</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      }</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa551635958f534ccf4cb21c6ea0007bad">AST_WAITSTREAM_CB_REWIND</a>:</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <a class="code" href="../../d6/d13/file_8c.html#a4c7c02a659b09bb06dd63e1f42692666">ast_stream_rewind</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c), skip_ms);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;   }</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;   <span class="keywordflow">if</span> (cb) {</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="keywordtype">long</span> ms_len = <a class="code" href="../../d6/d13/file_8c.html#a01771a318e7adea51499040f27b4278a">ast_tellstream</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)) / (<a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)-&gt;fmt-&gt;format) / 1000);</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      cb(c, ms_len, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;   }</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;PLAYBACK&quot;</span>,<span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      <span class="stringliteral">&quot;Control: %s\r\n&quot;</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      <span class="stringliteral">&quot;SkipMs: %d\r\n&quot;</span>,</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c),</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      (<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> == <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63">AST_WAITSTREAM_CB_FASTFORWARD</a>) ? <span class="stringliteral">&quot;FastForward&quot;</span> : <span class="stringliteral">&quot;Rewind&quot;</span>,</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      skip_ms);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="file_8c_html_a4c7c02a659b09bb06dd63e1f42692666"><div class="ttname"><a href="../../d6/d13/file_8c.html#a4c7c02a659b09bb06dd63e1f42692666">ast_stream_rewind</a></div><div class="ttdeci">int ast_stream_rewind(struct ast_filestream *fs, off_t ms)</div><div class="ttdoc">Rewind stream ms. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01063">file.c:1063</a></div></div>
<div class="ttc" id="file_8h_html_a04986aeb2b288409f7828a67998d7d6fa551635958f534ccf4cb21c6ea0007bad"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa551635958f534ccf4cb21c6ea0007bad">AST_WAITSTREAM_CB_REWIND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00055">file.h:55</a></div></div>
<div class="ttc" id="file_8c_html_a01771a318e7adea51499040f27b4278a"><div class="ttname"><a href="../../d6/d13/file_8c.html#a01771a318e7adea51499040f27b4278a">ast_tellstream</a></div><div class="ttdeci">off_t ast_tellstream(struct ast_filestream *fs)</div><div class="ttdoc">Tell where we are in a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01048">file.c:1048</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="channel_8h_html_a043ef90a065fe177af7b21a6045b6506"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_stream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00621">channel_internal_api.c:621</a></div></div>
<div class="ttc" id="file_8h_html_a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63">AST_WAITSTREAM_CB_FASTFORWARD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00056">file.h:56</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="format_8h_html_a499e920008f775eebadd958a42e85862"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a></div><div class="ttdeci">unsigned int ast_format_get_sample_rate(const struct ast_format *format)</div><div class="ttdoc">Get the sample rate of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00379">format.c:379</a></div></div>
<div class="ttc" id="file_8c_html_ac2137b5da91f3408f86d580952f32e94"><div class="ttname"><a href="../../d6/d13/file_8c.html#ac2137b5da91f3408f86d580952f32e94">ast_stream_fastforward</a></div><div class="ttdeci">int ast_stream_fastforward(struct ast_filestream *fs, off_t ms)</div><div class="ttdoc">Fast forward stream ms. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01058">file.c:1058</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab691e222ec6bab6039597ddbed2b5cf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab691e222ec6bab6039597ddbed2b5cf8">&#9670;&nbsp;</a></span>waitstream_core()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int waitstream_core </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>breakon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>forward</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>reverse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>skip_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>audiofd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cmdfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d4d/file_8h.html#a2d5138e99197a1d01f7a2ed07830476e">ast_waitstream_fr_cb</a>&#160;</td>
          <td class="paramname"><em>cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the core of all waitstream() functions </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01551">1551</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00888">ast_channel_caller()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l11235">ast_channel_clear_flag()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01260">ast_channel_flags()</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00729">ast_channel_sched()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l11228">ast_channel_set_flag()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00997">ast_channel_softhangup_internal_flag()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00621">ast_channel_stream()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01231">ast_channel_timingfunc()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">AST_CONTROL_ANSWER</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00305">AST_CONTROL_AOC</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">AST_CONTROL_BUSY</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">AST_CONTROL_CONGESTION</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00299">AST_CONTROL_CONNECTED_LINE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00286">AST_CONTROL_FLASH</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">AST_CONTROL_HANGUP</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00293">AST_CONTROL_HOLD</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00310">AST_CONTROL_PVT_CAUSE_CODE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00300">AST_CONTROL_REDIRECTING</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">AST_CONTROL_RINGING</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00303">AST_CONTROL_SRCCHANGE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00297">AST_CONTROL_SRCUPDATE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00337">AST_CONTROL_STREAM_FORWARD</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00335">AST_CONTROL_STREAM_RESTART</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00336">AST_CONTROL_STREAM_REVERSE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00333">AST_CONTROL_STREAM_STOP</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00334">AST_CONTROL_STREAM_SUSPEND</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00294">AST_CONTROL_UNHOLD</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00309">AST_CONTROL_UPDATE_RTP_PEER</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00295">AST_CONTROL_VIDUPDATE</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l04179">ast_exists_extension()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l01008">AST_FLAG_END_DTMF_ONLY</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l01015">AST_FLAG_MASQ_NOSTREAM</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00379">ast_format_get_sample_rate()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00099">AST_FRAME_DTMF_END</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">ast_frfree</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l04302">ast_read()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00755">ast_sched_runq()</a>, <a class="el" href="../../db/dbe/sched_8c_source.html#l00431">ast_sched_wait()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00187">ast_stopstream()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01048">ast_tellstream()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00063">ast_test_flag</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l03171">ast_waitfor()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02997">ast_waitfor_nandfds()</a>, <a class="el" href="../../d2/d4d/file_8h_source.html#l00056">AST_WAITSTREAM_CB_FASTFORWARD</a>, <a class="el" href="../../d2/d4d/file_8h_source.html#l00055">AST_WAITSTREAM_CB_REWIND</a>, <a class="el" href="../../d2/d4d/file_8h_source.html#l00057">AST_WAITSTREAM_CB_START</a>, <a class="el" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">ast_frame::datalen</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00118">exten</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00103">ast_filestream::fmt</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00048">ast_format_def::format</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">ast_frame::frametype</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00152">ast_frame_subclass::integer</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d5d/mod__format_8h_source.html#l00125">ast_filestream::orig_chan_name</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">ast_frame::ptr</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00085">S_COR</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">ast_frame::subclass</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01509">waitstream_control()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01776">ast_waitstream()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01795">ast_waitstream_exten()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01745">ast_waitstream_fr()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01734">ast_waitstream_fr_w_cb()</a>, and <a class="el" href="../../d6/d13/file_8c_source.html#l01785">ast_waitstream_full()</a>.</p>
<div class="fragment"><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;{</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *orig_chan_name = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;   <span class="keywordtype">int</span> err = 0;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;   <span class="keywordflow">if</span> (!breakon)</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      breakon = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;   <span class="keywordflow">if</span> (!forward)</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      forward = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   <span class="keywordflow">if</span> (!reverse)</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      reverse = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;   <span class="comment">/* Switch the channel to end DTMF frame only. waitstream_core doesn&#39;t care about the start of DTMF. */</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aa9d8ea64f1c03ccc844f630bb59b9466">ast_channel_set_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(c), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a44e6b334058bf9555fd4b834ad532046">AST_FLAG_MASQ_NOSTREAM</a>))</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      orig_chan_name = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c));</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c) &amp;&amp; cb) {</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="keywordtype">long</span> ms_len = <a class="code" href="../../d6/d13/file_8c.html#a01771a318e7adea51499040f27b4278a">ast_tellstream</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)) / (<a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)-&gt;fmt-&gt;format) / 1000);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      cb(c, ms_len, <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6faabc2f8e0278809e40cec7eb54feb6228">AST_WAITSTREAM_CB_START</a>);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;   }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   <span class="keywordflow">while</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a>(c)) {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keywordtype">int</span> ms;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="keywordflow">if</span> (orig_chan_name &amp;&amp; strcasecmp(orig_chan_name, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c))) {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;         <a class="code" href="../../d6/d13/file_8c.html#a2f0d358c02e7a6cbe06d4b67237aca3d">ast_stopstream</a>(c);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;         err = 1;</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      }</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      ms = <a class="code" href="../../d7/d00/sched_8h.html#af13fcd6652b8dcafae35c2fa35e80a8d">ast_sched_wait</a>(<a class="code" href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a>(c));</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="keywordflow">if</span> (ms &lt; 0 &amp;&amp; !<a class="code" href="../../d5/d7b/channel_8h.html#ab23fb6dcd2315d22d59b5101b8ca5417">ast_channel_timingfunc</a>(c)) {</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;         <a class="code" href="../../d6/d13/file_8c.html#a2f0d358c02e7a6cbe06d4b67237aca3d">ast_stopstream</a>(c);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      }</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">if</span> (ms &lt; 0)</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;         ms = 1000;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      <span class="keywordflow">if</span> (cmdfd &lt; 0) {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;         res = <a class="code" href="../../d5/d7b/channel_8h.html#a60e0bcaed001e8d5ed1ba0eb2644b3cc">ast_waitfor</a>(c, ms);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;         <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Select failed (%s)\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;         }</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;         <span class="keywordtype">int</span> outfd;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *rchan = <a class="code" href="../../d5/d7b/channel_8h.html#a5e62602ca9e229304f60ab5c2b32e13b">ast_waitfor_nandfds</a>(&amp;c, 1, &amp;cmdfd, (cmdfd &gt; -1) ? 1 : 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;outfd, &amp;ms);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;         <span class="keywordflow">if</span> (!rchan &amp;&amp; (outfd &lt; 0) &amp;&amp; (ms)) {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="comment">/* Continue */</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EINTR)</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Wait failed (%s)\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (outfd &gt; -1) { <span class="comment">/* this requires cmdfd set */</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            <span class="comment">/* The FD we were watching has something waiting */</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;         }</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;         <span class="comment">/* if rchan is set, it is &#39;c&#39; */</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;         res = rchan ? 1 : 0; <span class="comment">/* map into &#39;res&#39; values */</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      }</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;      <span class="keywordflow">if</span> (res &gt; 0) {</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *fr = <a class="code" href="../../d5/d7b/channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1">ast_read</a>(c);</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;         <span class="keywordflow">if</span> (!fr) {</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;         }</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;         <span class="keywordflow">switch</span> (fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">frametype</a>) {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b">AST_FRAME_DTMF_END</a>:</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>) {</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>[2] = { fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>, <span class="charliteral">&#39;\0&#39;</span> };</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(c, <a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, exten, 1,</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                  <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(c)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.valid, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(c)-&gt;<span class="keywordtype">id</span>.<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                  res = fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                  <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;               }</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;               res = fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;               <span class="keywordflow">if</span> (strchr(forward, res)) {</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                  <a class="code" href="../../d6/d13/file_8c.html#a82b84e188c383fe736ce31e891ae684c">waitstream_control</a>(c, <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63">AST_WAITSTREAM_CB_FASTFORWARD</a>, cb, skip_ms);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strchr(reverse, res)) {</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                  <a class="code" href="../../d6/d13/file_8c.html#a82b84e188c383fe736ce31e891ae684c">waitstream_control</a>(c, <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa551635958f534ccf4cb21c6ea0007bad">AST_WAITSTREAM_CB_REWIND</a>, cb, skip_ms);</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;               } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strchr(breakon, res)) {</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                  <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;PLAYBACK&quot;</span>,<span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                     <span class="stringliteral">&quot;Control: %s\r\n&quot;</span>,</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                     <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c),</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                     <span class="stringliteral">&quot;Break&quot;</span>);</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                  <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                  <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;               }</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            }</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>:</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="keywordflow">switch</span> (fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>) {</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa95eb913e6cbbac8a34e69905245fdf4">AST_CONTROL_STREAM_STOP</a>:</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32e9dbe9416e847668084be16d4698c9">AST_CONTROL_STREAM_SUSPEND</a>:</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32b72bba20e26bcd2d5a299c5d939bce">AST_CONTROL_STREAM_RESTART</a>:</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;               <span class="comment">/* Fall-through and break out */</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;               <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;PLAYBACK&quot;</span>,<span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                  <span class="stringliteral">&quot;Control: %s\r\n&quot;</span>,</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                  <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c),</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                  <span class="stringliteral">&quot;Break&quot;</span>);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;               res = fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;               <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;               <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a4e1f998aacd5c878a02040883b846bd7">AST_CONTROL_STREAM_REVERSE</a>:</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;               <span class="keywordflow">if</span> (!skip_ms) {</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                  skip_ms = 3000;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;               }</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;               <a class="code" href="../../d6/d13/file_8c.html#a82b84e188c383fe736ce31e891ae684c">waitstream_control</a>(c, <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa551635958f534ccf4cb21c6ea0007bad">AST_WAITSTREAM_CB_REWIND</a>, cb, skip_ms);</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ae8e6b1d91a861c33a3de923b24f54dec">AST_CONTROL_STREAM_FORWARD</a>:</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;               <span class="keywordflow">if</span> (!skip_ms) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                  skip_ms = 3000;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;               }</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;               <a class="code" href="../../d6/d13/file_8c.html#a82b84e188c383fe736ce31e891ae684c">waitstream_control</a>(c, <a class="code" href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63">AST_WAITSTREAM_CB_FASTFORWARD</a>, cb, skip_ms);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a>:</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a>:</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a>:</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;               <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;               <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;               <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>:</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>:</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a>:</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4">AST_CONTROL_SRCUPDATE</a>:</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af334ccaa958af9b049d6bfcaa41549b8">AST_CONTROL_SRCCHANGE</a>:</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5">AST_CONTROL_HOLD</a>:</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e">AST_CONTROL_UNHOLD</a>:</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>:</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a">AST_CONTROL_REDIRECTING</a>:</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a>:</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390afa94175de1fafa29c027294f1e5a2aee">AST_CONTROL_UPDATE_RTP_PEER</a>:</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41">AST_CONTROL_PVT_CAUSE_CODE</a>:</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf">AST_CONTROL_FLASH</a>:</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            <span class="keywordflow">case</span> -1:</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;               <span class="comment">/* Unimportant */</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Unexpected control subclass &#39;%d&#39;\n&quot;</span>, fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">subclass</a>.<a class="code" href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">integer</a>);</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            }</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>:</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            <span class="comment">/* Write audio if appropriate */</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;            <span class="keywordflow">if</span> (audiofd &gt; -1) {</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;               <span class="keywordflow">if</span> (write(audiofd, fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>, fr-&gt;<a class="code" href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">datalen</a>) &lt; 0) {</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;write() failed: %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;               }</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            }</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;            <span class="comment">/* Ignore all others */</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;         }</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;         <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a>(fr);</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      }</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <a class="code" href="../../d7/d00/sched_8h.html#aa9c3d54f142eee0bad110fbb825c0787">ast_sched_runq</a>(<a class="code" href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a>(c));</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;   }</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(c, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a>);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;   <span class="keywordflow">return</span> (err || <a class="code" href="../../d5/d7b/channel_8h.html#adac99999f1e55833e7f903979d67b48b">ast_channel_softhangup_internal_flag</a>(c)) ? -1 : 0;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;}</div><div class="ttc" id="channel_8h_html_ac2dc872b606534943c98304aed841b34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a></div><div class="ttdeci">struct ast_party_caller * ast_channel_caller(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00888">channel_internal_api.c:888</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ab99a3d1c08c5ae8bca078c7cd1ec02f5">AST_CONTROL_HOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00293">include/asterisk/frame.h:293</a></div></div>
<div class="ttc" id="file_8h_html_a04986aeb2b288409f7828a67998d7d6faabc2f8e0278809e40cec7eb54feb6228"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6faabc2f8e0278809e40cec7eb54feb6228">AST_WAITSTREAM_CB_START</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00057">file.h:57</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="channel_8h_html_a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a668ac945c84f50becaca2a6134e64058">AST_FLAG_END_DTMF_ONLY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01008">channel.h:1008</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ae8f2cd460fdc81e0a774434fa002e4bf">AST_CONTROL_FLASH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00286">include/asterisk/frame.h:286</a></div></div>
<div class="ttc" id="sched_8h_html_aa9c3d54f142eee0bad110fbb825c0787"><div class="ttname"><a href="../../d7/d00/sched_8h.html#aa9c3d54f142eee0bad110fbb825c0787">ast_sched_runq</a></div><div class="ttdeci">int ast_sched_runq(struct ast_sched_context *con)</div><div class="ttdoc">Runs the queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00755">sched.c:755</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">include/asterisk/frame.h:281</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="channel_8h_html_a1d9fcff85d7adbe0bd54f88eb927998c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a></div><div class="ttdeci">void ast_channel_clear_flag(struct ast_channel *chan, unsigned int flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l11235">channel.c:11235</a></div></div>
<div class="ttc" id="channel_8h_html_a7ef6737309dc9e8b6c4a7cb4800638b1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ef6737309dc9e8b6c4a7cb4800638b1">ast_read</a></div><div class="ttdeci">struct ast_frame * ast_read(struct ast_channel *chan)</div><div class="ttdoc">Reads a frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04302">channel.c:4302</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ae8e6b1d91a861c33a3de923b24f54dec"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ae8e6b1d91a861c33a3de923b24f54dec">AST_CONTROL_STREAM_FORWARD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00337">include/asterisk/frame.h:337</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a5344deefcbdcca938001314e81ea195a">AST_CONTROL_REDIRECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00300">include/asterisk/frame.h:300</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a387635982df3d2edb669a1eece92c875">AST_CONTROL_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00282">include/asterisk/frame.h:282</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="channel_8h_html_a5e62602ca9e229304f60ab5c2b32e13b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5e62602ca9e229304f60ab5c2b32e13b">ast_waitfor_nandfds</a></div><div class="ttdeci">struct ast_channel * ast_waitfor_nandfds(struct ast_channel **chan, int n, int *fds, int nfds, int *exception, int *outfd, int *ms)</div><div class="ttdoc">Waits for activity on a group of channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02997">channel.c:2997</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a32e9dbe9416e847668084be16d4698c9"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32e9dbe9416e847668084be16d4698c9">AST_CONTROL_STREAM_SUSPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00334">include/asterisk/frame.h:334</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af9665e40f4c9ef6fcfc3e179c6986c41">AST_CONTROL_PVT_CAUSE_CODE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00310">include/asterisk/frame.h:310</a></div></div>
<div class="ttc" id="structast__frame_html_a27237c48fdcd22556401f20c693811db"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a27237c48fdcd22556401f20c693811db">ast_frame::subclass</a></div><div class="ttdeci">struct ast_frame_subclass subclass</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00169">include/asterisk/frame.h:169</a></div></div>
<div class="ttc" id="file_8h_html_a04986aeb2b288409f7828a67998d7d6fa551635958f534ccf4cb21c6ea0007bad"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa551635958f534ccf4cb21c6ea0007bad">AST_WAITSTREAM_CB_REWIND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00055">file.h:55</a></div></div>
<div class="ttc" id="structnumber_html"><div class="ttname"><a href="../../d6/d49/structnumber.html">number</a></div><div class="ttdoc">Number structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d55/app__followme_8c_source.html#l00154">app_followme.c:154</a></div></div>
<div class="ttc" id="structast__frame__subclass_html_adece183191b0e700e039e59101e06105"><div class="ttname"><a href="../../d1/d9f/structast__frame__subclass.html#adece183191b0e700e039e59101e06105">ast_frame_subclass::integer</a></div><div class="ttdeci">int integer</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00152">include/asterisk/frame.h:152</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="file_8c_html_a01771a318e7adea51499040f27b4278a"><div class="ttname"><a href="../../d6/d13/file_8c.html#a01771a318e7adea51499040f27b4278a">ast_tellstream</a></div><div class="ttdeci">off_t ast_tellstream(struct ast_filestream *fs)</div><div class="ttdoc">Tell where we are in a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01048">file.c:1048</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a009e81151b19671f42b5e84ab6a619f4">AST_CONTROL_SRCUPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00297">include/asterisk/frame.h:297</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a32b72bba20e26bcd2d5a299c5d939bce"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a32b72bba20e26bcd2d5a299c5d939bce">AST_CONTROL_STREAM_RESTART</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00335">include/asterisk/frame.h:335</a></div></div>
<div class="ttc" id="structast__frame_html_ad67e07841d1233e596e6f822a3c81f6b"><div class="ttname"><a href="../../d0/d99/structast__frame.html#ad67e07841d1233e596e6f822a3c81f6b">ast_frame::datalen</a></div><div class="ttdeci">int datalen</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00171">include/asterisk/frame.h:171</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="channel_8h_html_a82f2c6e4d47f62f6b65c5887eb096fd5a44e6b334058bf9555fd4b834ad532046"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a44e6b334058bf9555fd4b834ad532046">AST_FLAG_MASQ_NOSTREAM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01015">channel.h:1015</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a4e1f998aacd5c878a02040883b846bd7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a4e1f998aacd5c878a02040883b846bd7">AST_CONTROL_STREAM_REVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00336">include/asterisk/frame.h:336</a></div></div>
<div class="ttc" id="pbx_8h_html_a64a5b8fdc919806135ad427aca9e71b7"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a></div><div class="ttdeci">int ast_exists_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Determine whether an extension exists. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04179">pbx.c:4179</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00105">include/asterisk/frame.h:105</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="channel_8h_html_acd3470664b6a002c9a379a69ddad4cb2"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#acd3470664b6a002c9a379a69ddad4cb2">ast_channel_sched</a></div><div class="ttdeci">struct ast_sched_context * ast_channel_sched(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00729">channel_internal_api.c:729</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0a98e65764bc963016c394bcc1bad6540b">AST_FRAME_DTMF_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00099">include/asterisk/frame.h:99</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa7dac1c1896ab418c2ff351aae707fba">AST_CONTROL_HANGUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00278">include/asterisk/frame.h:278</a></div></div>
<div class="ttc" id="file_8c_html_a2f0d358c02e7a6cbe06d4b67237aca3d"><div class="ttname"><a href="../../d6/d13/file_8c.html#a2f0d358c02e7a6cbe06d4b67237aca3d">ast_stopstream</a></div><div class="ttdeci">int ast_stopstream(struct ast_channel *tmp)</div><div class="ttdoc">Stops a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00187">file.c:187</a></div></div>
<div class="ttc" id="channel_8h_html_aa9d8ea64f1c03ccc844f630bb59b9466"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa9d8ea64f1c03ccc844f630bb59b9466">ast_channel_set_flag</a></div><div class="ttdeci">void ast_channel_set_flag(struct ast_channel *chan, unsigned int flag)</div><div class="ttdoc">Set a flag on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l11228">channel.c:11228</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00299">include/asterisk/frame.h:299</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390afa94175de1fafa29c027294f1e5a2aee"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390afa94175de1fafa29c027294f1e5a2aee">AST_CONTROL_UPDATE_RTP_PEER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00309">include/asterisk/frame.h:309</a></div></div>
<div class="ttc" id="channel_8h_html_a043ef90a065fe177af7b21a6045b6506"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a043ef90a065fe177af7b21a6045b6506">ast_channel_stream</a></div><div class="ttdeci">struct ast_filestream * ast_channel_stream(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00621">channel_internal_api.c:621</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00305">include/asterisk/frame.h:305</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a417bc8ac5817cc1525a3b530abfc1528">AST_CONTROL_VIDUPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00295">include/asterisk/frame.h:295</a></div></div>
<div class="ttc" id="channel_8h_html_adac99999f1e55833e7f903979d67b48b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#adac99999f1e55833e7f903979d67b48b">ast_channel_softhangup_internal_flag</a></div><div class="ttdeci">int ast_channel_softhangup_internal_flag(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00997">channel_internal_api.c:997</a></div></div>
<div class="ttc" id="file_8h_html_a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a04986aeb2b288409f7828a67998d7d6fa535f1a556fea89b06556c32a3356ba63">AST_WAITSTREAM_CB_FASTFORWARD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00056">file.h:56</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a3e7629b5f7e39f1cc8ad2e51e266f91e">AST_CONTROL_UNHOLD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00294">include/asterisk/frame.h:294</a></div></div>
<div class="ttc" id="channel_8h_html_a60e0bcaed001e8d5ed1ba0eb2644b3cc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a60e0bcaed001e8d5ed1ba0eb2644b3cc">ast_waitfor</a></div><div class="ttdeci">int ast_waitfor(struct ast_channel *chan, int ms)</div><div class="ttdoc">Wait for input on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l03171">channel.c:3171</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a6440d070425a2efe8e0aa71e8d9e47b7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a6440d070425a2efe8e0aa71e8d9e47b7">ast_frfree</a></div><div class="ttdeci">#define ast_frfree(fr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00556">include/asterisk/frame.h:556</a></div></div>
<div class="ttc" id="format_8h_html_a499e920008f775eebadd958a42e85862"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a></div><div class="ttdeci">unsigned int ast_format_get_sample_rate(const struct ast_format *format)</div><div class="ttdoc">Get the sample rate of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00379">format.c:379</a></div></div>
<div class="ttc" id="file_8c_html_a82b84e188c383fe736ce31e891ae684c"><div class="ttname"><a href="../../d6/d13/file_8c.html#a82b84e188c383fe736ce31e891ae684c">waitstream_control</a></div><div class="ttdeci">static void waitstream_control(struct ast_channel *c, enum ast_waitstream_fr_cb_values type, ast_waitstream_fr_cb cb, int skip_ms)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01509">file.c:1509</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa95eb913e6cbbac8a34e69905245fdf4"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa95eb913e6cbbac8a34e69905245fdf4">AST_CONTROL_STREAM_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00333">include/asterisk/frame.h:333</a></div></div>
<div class="ttc" id="sched_8h_html_af13fcd6652b8dcafae35c2fa35e80a8d"><div class="ttname"><a href="../../d7/d00/sched_8h.html#af13fcd6652b8dcafae35c2fa35e80a8d">ast_sched_wait</a></div><div class="ttdeci">int ast_sched_wait(struct ast_sched_context *con) attribute_warn_unused_result</div><div class="ttdoc">Determines number of seconds until the next outstanding event to take place. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dbe/sched_8c_source.html#l00431">sched.c:431</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">include/asterisk/frame.h:280</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structast__frame_html_a6937b93c56cb473b547eda454dca7b4c"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a6937b93c56cb473b547eda454dca7b4c">ast_frame::frametype</a></div><div class="ttdeci">enum ast_frame_type frametype</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00167">include/asterisk/frame.h:167</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="channel_8h_html_a91de92158876186d28ba1773877f2732"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a></div><div class="ttdeci">struct ast_flags * ast_channel_flags(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01260">channel_internal_api.c:1260</a></div></div>
<div class="ttc" id="channel_8h_html_ab23fb6dcd2315d22d59b5101b8ca5417"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab23fb6dcd2315d22d59b5101b8ca5417">ast_channel_timingfunc</a></div><div class="ttdeci">ast_timing_func_t ast_channel_timingfunc(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01231">channel_internal_api.c:1231</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a850bb06a1702741c93a3fd67cc9637ab">AST_CONTROL_CONGESTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00285">include/asterisk/frame.h:285</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af334ccaa958af9b049d6bfcaa41549b8"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af334ccaa958af9b049d6bfcaa41549b8">AST_CONTROL_SRCCHANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00303">include/asterisk/frame.h:303</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a248e5c086666b04d29a9cd876ad370b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a248e5c086666b04d29a9cd876ad370b3">&#9670;&nbsp;</a></span>ast_language_is_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_language_is_prefix = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The following variable controls the layout of localized sound files. If 0, use the historical layout with prefix just before the filename (i.e. digits/en/1.gsm , digits/it/1.gsm or default to digits/1.gsm), if 1 put the prefix at the beginning of the filename (i.e. en/digits/1.gsm, it/digits/1.gsm or default to digits/1.gsm). The latter permits a language to be entirely in one directory. </p>
<p>This is settable in asterisk.conf. </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l00067">67</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l00656">fileexists_test()</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l00450">handle_show_settings()</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00210">load_asterisk_conf()</a>, and <a class="el" href="../../d5/d03/asterisk_8c_source.html#l03492">main()</a>.</p>

</div>
</div>
<a id="abaef9acc752363813eb89bb0b72721a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaef9acc752363813eb89bb0b72721a7">&#9670;&nbsp;</a></span>cli_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> cli_file[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   { .handler =  <a class="code" href="../../d6/d13/file_8c.html#ac71e8d82ba7e263ff1d3ec9dbade3848">handle_cli_core_show_file_formats</a> , .summary =  <span class="stringliteral">&quot;Displays file formats&quot;</span> ,}</div><div class="line">}</div><div class="ttc" id="file_8c_html_ac71e8d82ba7e263ff1d3ec9dbade3848"><div class="ttname"><a href="../../d6/d13/file_8c.html#ac71e8d82ba7e263ff1d3ec9dbade3848">handle_cli_core_show_file_formats</a></div><div class="ttdeci">static char * handle_cli_core_show_file_formats(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01902">file.c:1902</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01972">1972</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

</div>
</div>
<a id="a80aada71b7a5bcb79dddc1bcc20540c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80aada71b7a5bcb79dddc1bcc20540c0">&#9670;&nbsp;</a></span>formats</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/d8d/structformats.html">formats</a>   <a class="el" href="../../df/d8d/structformats.html">formats</a> = { .<a class="el" href="../../d7/d8e/test__cdr_8c.html#ad010071647150404acc6651544245543">first</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#abaf7793fbb72797de5118c5f1f7b21ae">last</a> = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .<a class="el" href="../../d7/d8e/test__cdr_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a> = { PTHREAD_RWLOCK_INITIALIZER , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} } , }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9c3cc651725e456bc129d10e1f10271e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c3cc651725e456bc129d10e1f10271e">&#9670;&nbsp;</a></span>read_dirs_lock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d42/lock_8h.html#a44a55ccb432d858a224b401116277e93">ast_mutex_t</a> read_dirs_lock = { PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP , <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, {1, 0} }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lock to hold when iterating over directories. </p>
<p>Currently, 'readdir' is not required to be thread-safe. In most modern implementations it should be safe to make concurrent calls into 'readdir' that specify different directory streams (glibc would be one of these). However, since it is potentially unsafe for some implementations we'll use our own locking in order to achieve synchronization for those. </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d13/file_8c_source.html#l01228">1228</a> of file <a class="el" href="../../d6/d13/file_8c_source.html">file.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d13/file_8c_source.html#l01231">ast_file_read_dirs()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:45:53 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
