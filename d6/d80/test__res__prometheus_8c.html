<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: test_res_prometheus.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_59425e443f801f1f2fd8bbe4959a3ccf.html">tests</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">test_res_prometheus.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;curl/curl.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html">asterisk/config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/db1/res__prometheus_8h_source.html">asterisk/res_prometheus.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test_res_prometheus.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d22/test__res__prometheus_8c__incl.png" border="0" usemap="#test__res__prometheus_8c" alt=""/></div>
<map name="test__res__prometheus_8c" id="test__res__prometheus_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="725,229,809,256"/>
<area shape="rect" id="node23" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="1371,80,1485,107"/>
<area shape="rect" id="node31" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1503,155,1639,181"/>
<area shape="rect" id="node32" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="1797,229,1923,256"/>
<area shape="rect" id="node33" href="../../d0/db1/res__prometheus_8h.html" title="asterisk/res_prometheus.h" alt="" coords="1579,229,1773,256"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="221,304,376,331"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="778,304,915,331"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="619,304,754,331"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="5,379,152,405"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1318,453,1461,480"/>
<area shape="rect" id="node24" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="1377,155,1479,181"/>
<area shape="rect" id="node28" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1323,229,1453,256"/>
<area shape="rect" id="node25" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1505,304,1655,331"/>
<area shape="rect" id="node26" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1527,379,1641,405"/>
<area shape="rect" id="node27" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1671,453,1817,480"/>
<area shape="rect" id="node29" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1365,304,1480,331"/>
<area shape="rect" id="node30" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1665,379,1823,405"/>
</map>
</div>
</div>
<p><a href="../../d6/d80/test__res__prometheus_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a60d401f420413a119c88879ab1a4ab58"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>&#160;&#160;&#160;&quot;/res/prometheus/&quot;</td></tr>
<tr class="separator:a60d401f420413a119c88879ab1a4ab58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f74a3dcbfde83a6538a60020059b75"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ad9f74a3dcbfde83a6538a60020059b75">GLOBAL_USERAGENT</a>&#160;&#160;&#160;&quot;asterisk-libcurl-agent/1.0&quot;</td></tr>
<tr class="separator:ad9f74a3dcbfde83a6538a60020059b75"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ec970b1db08e7762ca5d9b77f742b55"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a5ec970b1db08e7762ca5d9b77f742b55">AST_TEST_DEFINE</a> (metric_values)</td></tr>
<tr class="separator:a5ec970b1db08e7762ca5d9b77f742b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada2a6fe3be14556bc45f6cb4afe48d82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ada2a6fe3be14556bc45f6cb4afe48d82">AST_TEST_DEFINE</a> (metric_callback_register)</td></tr>
<tr class="separator:ada2a6fe3be14556bc45f6cb4afe48d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9b0802304e1f21b29384fc7071c17e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ac9b0802304e1f21b29384fc7071c17e3">AST_TEST_DEFINE</a> (metric_register)</td></tr>
<tr class="separator:ac9b0802304e1f21b29384fc7071c17e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36116aea317a5ab76785a29e30c417fa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a36116aea317a5ab76785a29e30c417fa">AST_TEST_DEFINE</a> (counter_to_string)</td></tr>
<tr class="separator:a36116aea317a5ab76785a29e30c417fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef3dcc3ecc37388f47a15f9103387e09"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#aef3dcc3ecc37388f47a15f9103387e09">AST_TEST_DEFINE</a> (counter_create)</td></tr>
<tr class="separator:aef3dcc3ecc37388f47a15f9103387e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7186e3ea654f8171327f02f79cc0b86d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7186e3ea654f8171327f02f79cc0b86d">AST_TEST_DEFINE</a> (gauge_to_string)</td></tr>
<tr class="separator:a7186e3ea654f8171327f02f79cc0b86d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c6067a9dbcde407169a92052176d98"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ae4c6067a9dbcde407169a92052176d98">AST_TEST_DEFINE</a> (gauge_create)</td></tr>
<tr class="separator:ae4c6067a9dbcde407169a92052176d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c85898bf6851a76b635b1b4c92ab25e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a2c85898bf6851a76b635b1b4c92ab25e">AST_TEST_DEFINE</a> (config_general_basic_auth)</td></tr>
<tr class="separator:a2c85898bf6851a76b635b1b4c92ab25e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa7f7c34110352c27d4e44916f0c97b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#aefa7f7c34110352c27d4e44916f0c97b">AST_TEST_DEFINE</a> (config_general_enabled)</td></tr>
<tr class="separator:aefa7f7c34110352c27d4e44916f0c97b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa78076ce1783413c7ed5b4334421caae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#aa78076ce1783413c7ed5b4334421caae">AST_TEST_DEFINE</a> (config_general_core_metrics)</td></tr>
<tr class="separator:aa78076ce1783413c7ed5b4334421caae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e016784943d9278060a97e83f63b97d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a> (void)</td></tr>
<tr class="separator:a0e016784943d9278060a97e83f63b97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a2bd8cdaba0e529b3d5c3b0519e32e6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a> (void *ptr)</td></tr>
<tr class="separator:a9a2bd8cdaba0e529b3d5c3b0519e32e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e2a3dfc5c1b5a46e5af3f2bdce7b2f"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">curl_write_string_callback</a> (void *<a class="el" href="../../d5/dde/test__func__file_8c.html#aedde4c44231f9adaad3339ebe693e8d8">contents</a>, size_t size, size_t nmemb, void *userdata)</td></tr>
<tr class="separator:a90e2a3dfc5c1b5a46e5af3f2bdce7b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8df8ce54e4cb34fdb66469ab40f321"><td class="memItemLeft" align="right" valign="top">static CURL *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a> (void)</td></tr>
<tr class="separator:a0d8df8ce54e4cb34fdb66469ab40f321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7474a9031fa2b6421a8d7ea61f1264"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a3c7474a9031fa2b6421a8d7ea61f1264">metric_values_get_counter_value_cb</a> (struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *metric)</td></tr>
<tr class="separator:a3c7474a9031fa2b6421a8d7ea61f1264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c29a0c6da3b09b04d3f801bd44673e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a> (int <a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>)</td></tr>
<tr class="separator:a23c29a0c6da3b09b04d3f801bd44673e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8fcdf26266a1df6a1f0063dd03e4063"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ac8fcdf26266a1df6a1f0063dd03e4063">prometheus_metric_callback</a> (struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **output)</td></tr>
<tr class="separator:ac8fcdf26266a1df6a1f0063dd03e4063"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d24aa0ecc9425598e6a15d727522012"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a> (void *ptr)</td></tr>
<tr class="separator:a0d24aa0ecc9425598e6a15d727522012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a> (void)</td></tr>
<tr class="separator:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3b9a35577ec3254d74389c44112a914"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ad3b9a35577ec3254d74389c44112a914">test_cleanup_cb</a> (struct <a class="el" href="../../dc/d62/structast__test__info.html">ast_test_info</a> *info, struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>)</td></tr>
<tr class="separator:ad3b9a35577ec3254d74389c44112a914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74f59d77cd5fb076d3a3628bc1310b60"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a74f59d77cd5fb076d3a3628bc1310b60">test_init_cb</a> (struct <a class="el" href="../../dc/d62/structast__test__info.html">ast_test_info</a> *info, struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>)</td></tr>
<tr class="separator:a74f59d77cd5fb076d3a3628bc1310b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a54af2a9b29d140908cc9dffd0618951b">AST_MODFLAG_DEFAULT</a> , .description = &quot;Prometheus Core Unit Tests&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .<a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .requires = &quot;res_prometheus&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46978d10efd8fba3192c1fc26f9e235"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#ac46978d10efd8fba3192c1fc26f9e235">module_config</a></td></tr>
<tr class="separator:ac46978d10efd8fba3192c1fc26f9e235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af04e2af06333eeaa204e80f690383b30"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d80/test__res__prometheus_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a> [512]</td></tr>
<tr class="separator:af04e2af06333eeaa204e80f690383b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a60d401f420413a119c88879ab1a4ab58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60d401f420413a119c88879ab1a4ab58">&#9670;&nbsp;</a></span>CATEGORY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CATEGORY&#160;&#160;&#160;&quot;/res/prometheus/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">35</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00799">load_module()</a>.</p>

</div>
</div>
<a id="ad9f74a3dcbfde83a6538a60020059b75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9f74a3dcbfde83a6538a60020059b75">&#9670;&nbsp;</a></span>GLOBAL_USERAGENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GLOBAL_USERAGENT&#160;&#160;&#160;&quot;asterisk-libcurl-agent/1.0&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00057">57</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">get_curl_instance()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00829">829</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00829">829</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00829">829</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

</div>
</div>
<a id="a5ec970b1db08e7762ca5d9b77f742b55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ec970b1db08e7762ca5d9b77f742b55">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[1/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">metric_values&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">117</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">curl_free_wrapper()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00094">curl_write_string_callback()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">get_curl_instance()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00112">metric_values_get_counter_value_cb()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00128">PROMETHEUS_METRIC_COUNTER</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00287">prometheus_metric_register()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00287">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">prometheus_metric_unregister()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00230">prometheus_metric::value</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(CURL *, curl, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, buffer, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_counter_one = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>,</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="stringliteral">&quot;test_counter_one&quot;</span>,</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="stringliteral">&quot;A test counter&quot;</span>,</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_counter_two = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>,</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="stringliteral">&quot;test_counter_two&quot;</span>,</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="stringliteral">&quot;A test counter&quot;</span>,</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a3c7474a9031fa2b6421a8d7ea61f1264">metric_values_get_counter_value_cb</a>);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test value generation/respecting in metrics&quot;</span>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;         <span class="stringliteral">&quot;Metrics have two ways to provide values when the HTTP callback\n&quot;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         <span class="stringliteral">&quot;is invoked:\n&quot;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;         <span class="stringliteral">&quot;1. By using the direct value that resides in the metric\n&quot;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         <span class="stringliteral">&quot;2. By providing a callback function to specify the value\n&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         <span class="stringliteral">&quot;This test verifies that both function appropriately when the\n&quot;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         <span class="stringliteral">&quot;HTTP callback is called.&quot;</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   buffer = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> (!buffer) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   curl = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a>();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">if</span> (!curl) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(&amp;test_counter_one) == 0, result, metric_values_cleanup);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(&amp;test_counter_two) == 0, result, metric_values_cleanup);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   strcpy(test_counter_one.<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>, <span class="stringliteral">&quot;1&quot;</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURLing request...\n&quot;</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">curl_write_string_callback</a>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   curl_easy_setopt(curl, CURLOPT_WRITEDATA, &amp;buffer);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   res = curl_easy_perform(curl);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="keywordflow">if</span> (res != CURLE_OK) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to execute CURL: %d\n&quot;</span>, res);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      result = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">goto</span> metric_values_cleanup;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; Retrieved: %s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer));</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, strstr(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer),</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="stringliteral">&quot;# HELP test_counter_one A test counter\n&quot;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="stringliteral">&quot;# TYPE test_counter_one counter\n&quot;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="stringliteral">&quot;test_counter_one 1\n&quot;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="stringliteral">&quot;# HELP test_counter_two A test counter\n&quot;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="stringliteral">&quot;# TYPE test_counter_two counter\n&quot;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="stringliteral">&quot;test_counter_two 2\n&quot;</span>) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, result, metric_values_cleanup);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;metric_values_cleanup:</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(&amp;test_counter_one);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(&amp;test_counter_two);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a12a466676f24c8935739be58c2c3aab6"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a></div><div class="ttdeci">int prometheus_metric_register(struct prometheus_metric *metric)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00287">res_prometheus.c:287</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a></div><div class="ttdoc">A metric whose value always goes up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00128">res_prometheus.h:128</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a02a3a2b23615b19bdc4ab8a9ab396dba"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a></div><div class="ttdeci">int prometheus_metric_unregister(struct prometheus_metric *metric)</div><div class="ttdoc">Remove a registered metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00334">res_prometheus.c:334</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a34366ff9c420980c21bbbfd05fe9c6d2"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_STATIC_INITIALIZATION(mtype, n, h, cb)</div><div class="ttdoc">Convenience macro for initializing a metric on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00287">res_prometheus.h:287</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a3c7474a9031fa2b6421a8d7ea61f1264"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a3c7474a9031fa2b6421a8d7ea61f1264">metric_values_get_counter_value_cb</a></div><div class="ttdeci">static void metric_values_get_counter_value_cb(struct prometheus_metric *metric)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00112">test_res_prometheus.c:112</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d8df8ce54e4cb34fdb66469ab40f321"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a></div><div class="ttdeci">static CURL * get_curl_instance(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">test_res_prometheus.c:76</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a90e2a3dfc5c1b5a46e5af3f2bdce7b2f"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">curl_write_string_callback</a></div><div class="ttdeci">static size_t curl_write_string_callback(void *contents, size_t size, size_t nmemb, void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00094">test_res_prometheus.c:94</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae0c1e3dcbc35f789a9e9ff7bfbf468b1"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">prometheus_metric::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_VALUE_LENGTH]</div><div class="ttdoc">The current value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00230">res_prometheus.h:230</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a9a2bd8cdaba0e529b3d5c3b0519e32e6"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a></div><div class="ttdeci">static void curl_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">test_res_prometheus.c:41</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ada2a6fe3be14556bc45f6cb4afe48d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada2a6fe3be14556bc45f6cb4afe48d82">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[2/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">metric_callback_register&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00202">202</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">curl_free_wrapper()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00094">curl_write_string_callback()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">get_curl_instance()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00417">prometheus_callback::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00535">prometheus_callback_register()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00548">prometheus_callback_unregister()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00191">prometheus_metric_callback()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(CURL *, curl, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, buffer, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a> callback = {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      .<a class="code" href="../../d5/d3d/structprometheus__callback.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;test_callback&quot;</span>,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      .callback_fn = &amp;<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#ac8fcdf26266a1df6a1f0063dd03e4063">prometheus_metric_callback</a>,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   };</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test registration of callbacks&quot;</span>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;         <span class="stringliteral">&quot;This test covers callback registration. It registers\n&quot;</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;         <span class="stringliteral">&quot;a callback that is invoked when an HTTP request is made,\n&quot;</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         <span class="stringliteral">&quot;and it verifies that during said callback the output to\n&quot;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         <span class="stringliteral">&quot;the response string is correctly appended to. It also verifies\n&quot;</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         <span class="stringliteral">&quot;that unregistered callbacks are not invoked.&quot;</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   buffer = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="keywordflow">if</span> (!buffer) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#ae28fee05e158456c0b5e7d236fc20d40">prometheus_callback_register</a>(&amp;callback) == 0);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   curl = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a>();</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="keywordflow">if</span> (!curl) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURLing request...\n&quot;</span>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">curl_write_string_callback</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   curl_easy_setopt(curl, CURLOPT_WRITEDATA, &amp;buffer);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   res = curl_easy_perform(curl);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="keywordflow">if</span> (res != CURLE_OK) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to execute CURL: %d\n&quot;</span>, res);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; Retrieved: %s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer));</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, strstr(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer),</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="stringliteral">&quot;# HELP test_counter A test counter\n&quot;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="stringliteral">&quot;# TYPE test_counter counter\n&quot;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="stringliteral">&quot;test_counter 0\n&quot;</span>) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a8af890c773bfd39b4979937b73c1f401">prometheus_callback_unregister</a>(&amp;callback);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div><div class="ttc" id="res__prometheus_8h_html_ae28fee05e158456c0b5e7d236fc20d40"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#ae28fee05e158456c0b5e7d236fc20d40">prometheus_callback_register</a></div><div class="ttdeci">int prometheus_callback_register(struct prometheus_callback *callback)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00535">res_prometheus.c:535</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="structprometheus__callback_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html#a8f8f80d37794cde9472343e4487ba3eb">prometheus_callback::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The name of our callback (always useful for debugging) </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00417">res_prometheus.h:417</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d8df8ce54e4cb34fdb66469ab40f321"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a></div><div class="ttdeci">static CURL * get_curl_instance(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">test_res_prometheus.c:76</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a90e2a3dfc5c1b5a46e5af3f2bdce7b2f"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">curl_write_string_callback</a></div><div class="ttdeci">static size_t curl_write_string_callback(void *contents, size_t size, size_t nmemb, void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00094">test_res_prometheus.c:94</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a8af890c773bfd39b4979937b73c1f401"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a8af890c773bfd39b4979937b73c1f401">prometheus_callback_unregister</a></div><div class="ttdeci">void prometheus_callback_unregister(struct prometheus_callback *callback)</div><div class="ttdoc">Remove a registered callback. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00548">res_prometheus.c:548</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a9a2bd8cdaba0e529b3d5c3b0519e32e6"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a></div><div class="ttdeci">static void curl_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">test_res_prometheus.c:41</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_ac8fcdf26266a1df6a1f0063dd03e4063"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#ac8fcdf26266a1df6a1f0063dd03e4063">prometheus_metric_callback</a></div><div class="ttdeci">static void prometheus_metric_callback(struct ast_str **output)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00191">test_res_prometheus.c:191</a></div></div>
<div class="ttc" id="structprometheus__callback_html"><div class="ttname"><a href="../../d5/d3d/structprometheus__callback.html">prometheus_callback</a></div><div class="ttdoc">Defines a callback that will be invoked when the HTTP route is called. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00413">res_prometheus.h:413</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9b0802304e1f21b29384fc7071c17e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9b0802304e1f21b29384fc7071c17e3">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[3/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">metric_register&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00260">260</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00452">prometheus_counter_create()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00439">prometheus_gauge_create()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00128">PROMETHEUS_METRIC_COUNTER</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00392">prometheus_metric_free()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">prometheus_metric_free_wrapper()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00287">prometheus_metric_register()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00280">prometheus_metric_registered_count()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00321">PROMETHEUS_METRIC_SET_LABEL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00287">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">prometheus_metric_unregister()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_counter = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>,</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="stringliteral">&quot;test_counter&quot;</span>,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="stringliteral">&quot;A test counter&quot;</span>,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *, test_gauge, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *, test_gauge_child_one, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a>);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *, test_gauge_child_two, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *, bad_metric, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a>);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test registration of metrics&quot;</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;         <span class="stringliteral">&quot;This test covers the following registration scenarios:\n&quot;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         <span class="stringliteral">&quot;- Nominal registration of simple metrics\n&quot;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         <span class="stringliteral">&quot;- Registration of metrics with different allocation strategies\n&quot;</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         <span class="stringliteral">&quot;- Nested metrics with label families\n&quot;</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         <span class="stringliteral">&quot;- Off nominal registration with simple name collisions\n&quot;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         <span class="stringliteral">&quot;- Off nominal registration with label collisions&quot;</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing nominal registration\n&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;-&gt; Static metric\n&quot;</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(&amp;test_counter) == 0, result, metric_register_cleanup);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;-&gt; Malloc&#39;d metric\n&quot;</span>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   test_gauge = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a>(<span class="stringliteral">&quot;test_gauge&quot;</span>, <span class="stringliteral">&quot;A test gauge&quot;</span>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, test_gauge != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(test_gauge) == 0, result, metric_register_cleanup);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a>() == 2, result, metric_register_cleanup);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing nominal registration of child metrics\n&quot;</span>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   test_gauge_child_one = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a>(<span class="stringliteral">&quot;test_gauge&quot;</span>, <span class="stringliteral">&quot;A test gauge&quot;</span>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, test_gauge_child_one != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, result, metric_register_cleanup);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(test_gauge_child_one, 0, <span class="stringliteral">&quot;key_one&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(test_gauge_child_one, 1, <span class="stringliteral">&quot;key_two&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   test_gauge_child_two = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a>(<span class="stringliteral">&quot;test_gauge&quot;</span>, <span class="stringliteral">&quot;A test gauge&quot;</span>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, test_gauge_child_two != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, result, metric_register_cleanup);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(test_gauge_child_two, 0, <span class="stringliteral">&quot;key_one&quot;</span>, <span class="stringliteral">&quot;value_two&quot;</span>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(test_gauge_child_two, 1, <span class="stringliteral">&quot;key_two&quot;</span>, <span class="stringliteral">&quot;value_two&quot;</span>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(test_gauge_child_one) == 0, result, metric_register_cleanup);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(test_gauge_child_two) == 0, result, metric_register_cleanup);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a>() == 2, result, metric_register_cleanup);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, test_gauge-&gt;children.first == test_gauge_child_one, result, metric_register_cleanup);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, test_gauge-&gt;children.last == test_gauge_child_two, result, metric_register_cleanup);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing name collisions\n&quot;</span>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   bad_metric = <a class="code" href="../../d0/db1/res__prometheus_8h.html#aa8ce4a778dc12b1b14097b3bfd23a248">prometheus_counter_create</a>(<span class="stringliteral">&quot;test_counter&quot;</span>, <span class="stringliteral">&quot;A test counter&quot;</span>);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, bad_metric != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, result, metric_register_cleanup);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(bad_metric) != 0, result, metric_register_cleanup);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a>(bad_metric);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   bad_metric = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing label collisions\n&quot;</span>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   bad_metric = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a>(<span class="stringliteral">&quot;test_gauge&quot;</span>, <span class="stringliteral">&quot;A test gauge&quot;</span>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, bad_metric != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, result, metric_register_cleanup);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(bad_metric, 0, <span class="stringliteral">&quot;key_one&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(bad_metric, 1, <span class="stringliteral">&quot;key_two&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a>(bad_metric) != 0, result, metric_register_cleanup);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a>(bad_metric);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   bad_metric = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing removal of metrics\n&quot;</span>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(test_gauge_child_two);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   test_gauge_child_two = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a>() == 2, result, metric_register_cleanup);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(test_gauge);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   test_gauge = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a>() == 2, result, metric_register_cleanup);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(test_gauge_child_one);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   test_gauge_child_one = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a>() == 1, result, metric_register_cleanup);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(&amp;test_counter);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   ast_test_validate_cleanup(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../d0/db1/res__prometheus_8h.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a>() == 0, result, metric_register_cleanup);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;metric_register_cleanup:</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(&amp;test_counter);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a12a466676f24c8935739be58c2c3aab6"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a12a466676f24c8935739be58c2c3aab6">prometheus_metric_register</a></div><div class="ttdeci">int prometheus_metric_register(struct prometheus_metric *metric)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00287">res_prometheus.c:287</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a></div><div class="ttdoc">A metric whose value always goes up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00128">res_prometheus.h:128</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a02a3a2b23615b19bdc4ab8a9ab396dba"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a></div><div class="ttdeci">int prometheus_metric_unregister(struct prometheus_metric *metric)</div><div class="ttdoc">Remove a registered metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00334">res_prometheus.c:334</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_ab8409a6e51c0e44c5802261465034a57"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a></div><div class="ttdeci">void prometheus_metric_free(struct prometheus_metric *metric)</div><div class="ttdoc">Destroy a metric and all its children. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00392">res_prometheus.c:392</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a34366ff9c420980c21bbbfd05fe9c6d2"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_STATIC_INITIALIZATION(mtype, n, h, cb)</div><div class="ttdoc">Convenience macro for initializing a metric on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00287">res_prometheus.h:287</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a127df8440ec5752a07056868c7a470b5"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_SET_LABEL(metric, label, n, v)</div><div class="ttdoc">Convenience macro for setting a label / value in a metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00321">res_prometheus.h:321</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a437e2859b1d632b1ee413bad2c42db52"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a></div><div class="ttdeci">struct prometheus_metric * prometheus_gauge_create(const char *name, const char *help)</div><div class="ttdoc">Create a malloc&amp;#39;d gauge metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00439">res_prometheus.c:439</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d24aa0ecc9425598e6a15d727522012"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a></div><div class="ttdeci">static void prometheus_metric_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">test_res_prometheus.c:50</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_aa8ce4a778dc12b1b14097b3bfd23a248"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#aa8ce4a778dc12b1b14097b3bfd23a248">prometheus_counter_create</a></div><div class="ttdeci">struct prometheus_metric * prometheus_counter_create(const char *name, const char *help)</div><div class="ttdoc">Create a malloc&amp;#39;d counter metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00452">res_prometheus.c:452</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a152734c2aa84df297edd115b921e6906"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a152734c2aa84df297edd115b921e6906">prometheus_metric_registered_count</a></div><div class="ttdeci">int prometheus_metric_registered_count(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00280">res_prometheus.c:280</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36116aea317a5ab76785a29e30c417fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36116aea317a5ab76785a29e30c417fa">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[4/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">counter_to_string&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00354">354</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00128">PROMETHEUS_METRIC_COUNTER</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00321">PROMETHEUS_METRIC_SET_LABEL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00287">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">prometheus_metric_to_string()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_counter = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="stringliteral">&quot;test_counter&quot;</span>,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="stringliteral">&quot;A test counter&quot;</span>,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_counter_child_one = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>,</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="stringliteral">&quot;test_counter&quot;</span>,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="stringliteral">&quot;A test counter&quot;</span>,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_counter_child_two = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>,</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="stringliteral">&quot;test_counter&quot;</span>,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="stringliteral">&quot;A test counter&quot;</span>,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, buffer, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test formatting of counters&quot;</span>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;         <span class="stringliteral">&quot;This test covers the formatting of printed counters&quot;</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   }</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   buffer = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="keywordflow">if</span> (!buffer) {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_counter_child_one, 0, <span class="stringliteral">&quot;key_one&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_counter_child_one, 1, <span class="stringliteral">&quot;key_two&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_counter_child_two, 0, <span class="stringliteral">&quot;key_one&quot;</span>, <span class="stringliteral">&quot;value_two&quot;</span>);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_counter_child_two, 1, <span class="stringliteral">&quot;key_two&quot;</span>, <span class="stringliteral">&quot;value_two&quot;</span>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;test_counter.<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, &amp;test_counter_child_one, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;test_counter.<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, &amp;test_counter_child_two, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a>(&amp;test_counter, &amp;buffer);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, strcmp(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer),</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="stringliteral">&quot;# HELP test_counter A test counter\n&quot;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="stringliteral">&quot;# TYPE test_counter counter\n&quot;</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="stringliteral">&quot;test_counter 0\n&quot;</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="stringliteral">&quot;test_counter{key_one=\&quot;value_one\&quot;,key_two=\&quot;value_one\&quot;} 0\n&quot;</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="stringliteral">&quot;test_counter{key_one=\&quot;value_two\&quot;,key_two=\&quot;value_two\&quot;} 0\n&quot;</span>) == 0);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a></div><div class="ttdoc">A metric whose value always goes up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00128">res_prometheus.h:128</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a34366ff9c420980c21bbbfd05fe9c6d2"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_STATIC_INITIALIZATION(mtype, n, h, cb)</div><div class="ttdoc">Convenience macro for initializing a metric on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00287">res_prometheus.h:287</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_abd25ff5603091eef2d7bf3fed8f7474a"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a></div><div class="ttdeci">void prometheus_metric_to_string(struct prometheus_metric *metric, struct ast_str **output)</div><div class="ttdoc">Convert a metric (and its children) into Prometheus compatible text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00521">res_prometheus.c:521</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a127df8440ec5752a07056868c7a470b5"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_SET_LABEL(metric, label, n, v)</div><div class="ttdoc">Convenience macro for setting a label / value in a metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00321">res_prometheus.h:321</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae58ab8ab7bd9df1dfbe5b715284ed572"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a></div><div class="ttdeci">struct prometheus_metric::@312 children</div><div class="ttdoc">A list of children metrics. </div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef3dcc3ecc37388f47a15f9103387e09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef3dcc3ecc37388f47a15f9103387e09">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[5/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">counter_create&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00407">407</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00452">prometheus_counter_create()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00128">PROMETHEUS_METRIC_COUNTER</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">prometheus_metric_free_wrapper()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00148">PROMETHEUS_METRIC_MALLOCD</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;{</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *, metric, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test creation (and destruction) of malloc&#39;d counters&quot;</span>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         <span class="stringliteral">&quot;This test covers creating a counter metric and destroying\n&quot;</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         <span class="stringliteral">&quot;it. The metric should be malloc&#39;d.&quot;</span>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   metric = <a class="code" href="../../d0/db1/res__prometheus_8h.html#aa8ce4a778dc12b1b14097b3bfd23a248">prometheus_counter_create</a>(<span class="stringliteral">&quot;test_counter&quot;</span>, <span class="stringliteral">&quot;A test counter&quot;</span>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;type == <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;allocation_strategy = <a class="code" href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a>);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(metric-&gt;help, <span class="stringliteral">&quot;A test counter&quot;</span>));</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(metric-&gt;name, <span class="stringliteral">&quot;test_counter&quot;</span>));</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(metric-&gt;value, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;children.first == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;children.last == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a></div><div class="ttdoc">A metric whose value always goes up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00128">res_prometheus.h:128</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d24aa0ecc9425598e6a15d727522012"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a></div><div class="ttdeci">static void prometheus_metric_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">test_res_prometheus.c:50</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_aa8ce4a778dc12b1b14097b3bfd23a248"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#aa8ce4a778dc12b1b14097b3bfd23a248">prometheus_counter_create</a></div><div class="ttdeci">struct prometheus_metric * prometheus_counter_create(const char *name, const char *help)</div><div class="ttdoc">Create a malloc&amp;#39;d counter metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00452">res_prometheus.c:452</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a></div><div class="ttdoc">The metric was allocated on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00148">res_prometheus.h:148</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7186e3ea654f8171327f02f79cc0b86d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7186e3ea654f8171327f02f79cc0b86d">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[6/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">gauge_to_string&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00437">437</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00132">PROMETHEUS_METRIC_GAUGE</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00321">PROMETHEUS_METRIC_SET_LABEL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00287">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">prometheus_metric_to_string()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;{</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_gauge = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a>,</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="stringliteral">&quot;test_gauge&quot;</span>,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="stringliteral">&quot;A test gauge&quot;</span>,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_gauge_child_one = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a>,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="stringliteral">&quot;test_gauge&quot;</span>,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="stringliteral">&quot;A test gauge&quot;</span>,</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_gauge_child_two = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a>,</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="stringliteral">&quot;test_gauge&quot;</span>,</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="stringliteral">&quot;A test gauge&quot;</span>,</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, buffer, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test formatting of gauges&quot;</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;         <span class="stringliteral">&quot;This test covers the formatting of printed gauges&quot;</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   buffer = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <span class="keywordflow">if</span> (!buffer) {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_gauge_child_one, 0, <span class="stringliteral">&quot;key_one&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_gauge_child_one, 1, <span class="stringliteral">&quot;key_two&quot;</span>, <span class="stringliteral">&quot;value_one&quot;</span>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_gauge_child_two, 0, <span class="stringliteral">&quot;key_one&quot;</span>, <span class="stringliteral">&quot;value_two&quot;</span>);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a>(&amp;test_gauge_child_two, 1, <span class="stringliteral">&quot;key_two&quot;</span>, <span class="stringliteral">&quot;value_two&quot;</span>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;test_gauge.<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, &amp;test_gauge_child_one, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;test_gauge.<a class="code" href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">children</a>, &amp;test_gauge_child_two, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a>(&amp;test_gauge, &amp;buffer);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, strcmp(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer),</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="stringliteral">&quot;# HELP test_gauge A test gauge\n&quot;</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="stringliteral">&quot;# TYPE test_gauge gauge\n&quot;</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="stringliteral">&quot;test_gauge 0\n&quot;</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="stringliteral">&quot;test_gauge{key_one=\&quot;value_one\&quot;,key_two=\&quot;value_one\&quot;} 0\n&quot;</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="stringliteral">&quot;test_gauge{key_one=\&quot;value_two\&quot;,key_two=\&quot;value_two\&quot;} 0\n&quot;</span>) == 0);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a34366ff9c420980c21bbbfd05fe9c6d2"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_STATIC_INITIALIZATION(mtype, n, h, cb)</div><div class="ttdoc">Convenience macro for initializing a metric on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00287">res_prometheus.h:287</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_abd25ff5603091eef2d7bf3fed8f7474a"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a></div><div class="ttdeci">void prometheus_metric_to_string(struct prometheus_metric *metric, struct ast_str **output)</div><div class="ttdoc">Convert a metric (and its children) into Prometheus compatible text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00521">res_prometheus.c:521</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a127df8440ec5752a07056868c7a470b5"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a127df8440ec5752a07056868c7a470b5">PROMETHEUS_METRIC_SET_LABEL</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_SET_LABEL(metric, label, n, v)</div><div class="ttdoc">Convenience macro for setting a label / value in a metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00321">res_prometheus.h:321</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structprometheus__metric_html_ae58ab8ab7bd9df1dfbe5b715284ed572"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae58ab8ab7bd9df1dfbe5b715284ed572">prometheus_metric::children</a></div><div class="ttdeci">struct prometheus_metric::@312 children</div><div class="ttdoc">A list of children metrics. </div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00132">res_prometheus.h:132</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4c6067a9dbcde407169a92052176d98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4c6067a9dbcde407169a92052176d98">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[7/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">gauge_create&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00490">490</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00439">prometheus_gauge_create()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">prometheus_metric_free_wrapper()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00132">PROMETHEUS_METRIC_GAUGE</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00148">PROMETHEUS_METRIC_MALLOCD</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;{</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *, metric, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test creation (and destruction) of malloc&#39;d gauges&quot;</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         <span class="stringliteral">&quot;This test covers creating a gauge metric and destroying\n&quot;</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;         <span class="stringliteral">&quot;it. The metric should be malloc&#39;d.&quot;</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   metric = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a>(<span class="stringliteral">&quot;test_gauge&quot;</span>, <span class="stringliteral">&quot;A test gauge&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;type == <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;allocation_strategy = <a class="code" href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(metric-&gt;help, <span class="stringliteral">&quot;A test gauge&quot;</span>));</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(metric-&gt;name, <span class="stringliteral">&quot;test_gauge&quot;</span>));</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(metric-&gt;value, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;children.first == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metric-&gt;children.last == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a437e2859b1d632b1ee413bad2c42db52"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a437e2859b1d632b1ee413bad2c42db52">prometheus_gauge_create</a></div><div class="ttdeci">struct prometheus_metric * prometheus_gauge_create(const char *name, const char *help)</div><div class="ttdoc">Create a malloc&amp;#39;d gauge metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00439">res_prometheus.c:439</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d24aa0ecc9425598e6a15d727522012"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d24aa0ecc9425598e6a15d727522012">prometheus_metric_free_wrapper</a></div><div class="ttdeci">static void prometheus_metric_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">test_res_prometheus.c:50</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932a7fc03d9058ae07c06356dd86ee48f3b1">PROMETHEUS_METRIC_GAUGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00132">res_prometheus.h:132</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#af1732dbbefdac1b3c42ff4e86a9998beaa7b739245480ebe32bb422edcfa4264a">PROMETHEUS_METRIC_MALLOCD</a></div><div class="ttdoc">The metric was allocated on the heap. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00148">res_prometheus.h:148</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c85898bf6851a76b635b1b4c92ab25e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c85898bf6851a76b635b1b4c92ab25e">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[8/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">config_general_basic_auth&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00520">520</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00514">ast_string_field_set</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00083">prometheus_general_config::auth_password</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00083">prometheus_general_config::auth_username</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">config_alloc()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">curl_free_wrapper()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">get_curl_instance()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00750">prometheus_general_config_set()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;{</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(CURL *, curl, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="keywordtype">long</span> response_code;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test basic auth handling&quot;</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;         <span class="stringliteral">&quot;This test covers authentication of requests&quot;</span>;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   config = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a>();</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="keywordflow">if</span> (!config) {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(config, <a class="code" href="../../d0/d5a/structprometheus__general__config.html#adf99ba2eaf9fb79d6860e2abcaec5d59">auth_username</a>, <span class="stringliteral">&quot;foo&quot;</span>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(config, <a class="code" href="../../d0/d5a/structprometheus__general__config.html#ab3064107bcc51eb4d31f66e89d122eed">auth_password</a>, <span class="stringliteral">&quot;bar&quot;</span>);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="comment">/* Prometheus module owns the ref after this call */</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a>(config);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(config, -1);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   curl = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a>();</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="keywordflow">if</span> (!curl) {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing without auth credentials\n&quot;</span>);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURLing request...\n&quot;</span>);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   res = curl_easy_perform(curl);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <span class="keywordflow">if</span> (res != CURLE_OK) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to execute CURL: %d\n&quot;</span>, res);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &amp;response_code);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURL returned %ld\n&quot;</span>, response_code);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, response_code == 401);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing with invalid auth credentials\n&quot;</span>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURLing request...\n&quot;</span>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   curl_easy_setopt(curl, CURLOPT_HTTPAUTH, CURLAUTH_ANY);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   curl_easy_setopt(curl, CURLOPT_USERPWD, <span class="stringliteral">&quot;matt:jordan&quot;</span>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   res = curl_easy_perform(curl);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="keywordflow">if</span> (res != CURLE_OK) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to execute CURL: %d\n&quot;</span>, res);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &amp;response_code);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURL returned %ld\n&quot;</span>, response_code);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, response_code == 401);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing with valid auth credentials\n&quot;</span>);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURLing request...\n&quot;</span>);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   curl_easy_setopt(curl, CURLOPT_USERPWD, <span class="stringliteral">&quot;foo:bar&quot;</span>);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   res = curl_easy_perform(curl);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="keywordflow">if</span> (res != CURLE_OK) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to execute CURL: %d\n&quot;</span>, res);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &amp;response_code);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURL returned %ld\n&quot;</span>, response_code);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, response_code == 200);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0e016784943d9278060a97e83f63b97d"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a></div><div class="ttdeci">static struct prometheus_general_config * config_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">test_res_prometheus.c:59</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a25507755e82d34f73b054fac5087d582"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a></div><div class="ttdeci">void prometheus_general_config_set(struct prometheus_general_config *config)</div><div class="ttdoc">Set the configuration for the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00750">res_prometheus.c:750</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structprometheus__general__config_html_ab3064107bcc51eb4d31f66e89d122eed"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html#ab3064107bcc51eb4d31f66e89d122eed">prometheus_general_config::auth_password</a></div><div class="ttdeci">const ast_string_field auth_password</div><div class="ttdoc">Auth password for Basic Auth. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00083">res_prometheus.h:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d8df8ce54e4cb34fdb66469ab40f321"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a></div><div class="ttdeci">static CURL * get_curl_instance(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">test_res_prometheus.c:76</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a9a2bd8cdaba0e529b3d5c3b0519e32e6"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a></div><div class="ttdeci">static void curl_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">test_res_prometheus.c:41</a></div></div>
<div class="ttc" id="structprometheus__general__config_html_adf99ba2eaf9fb79d6860e2abcaec5d59"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html#adf99ba2eaf9fb79d6860e2abcaec5d59">prometheus_general_config::auth_username</a></div><div class="ttdeci">const ast_string_field auth_username</div><div class="ttdoc">Auth username for Basic Auth. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00083">res_prometheus.h:83</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aefa7f7c34110352c27d4e44916f0c97b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa7f7c34110352c27d4e44916f0c97b">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[9/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">config_general_enabled&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00593">593</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">config_alloc()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">curl_free_wrapper()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00071">prometheus_general_config::enabled</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">get_curl_instance()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00750">prometheus_general_config_set()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;{</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(CURL *, curl, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a>);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   <span class="keywordtype">long</span> response_code;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test handling of enable/disable&quot;</span>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         <span class="stringliteral">&quot;When disabled, the module should return a 503.\n&quot;</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;         <span class="stringliteral">&quot;This test verifies that it actually occurs.&quot;</span>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   config = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a>();</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="keywordflow">if</span> (!config) {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   config-&gt;<a class="code" href="../../d0/d5a/structprometheus__general__config.html#a63be54a0beac1f5717217e1d9e629c71">enabled</a> = 0;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="comment">/* Prometheus module owns the ref after this call */</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a>(config);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(config, -1);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   curl = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a>();</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <span class="keywordflow">if</span> (!curl) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURLing request...\n&quot;</span>);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   res = curl_easy_perform(curl);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="keywordflow">if</span> (res != CURLE_OK) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to execute CURL: %d\n&quot;</span>, res);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &amp;response_code);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURL returned %ld\n&quot;</span>, response_code);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, response_code == 503);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0e016784943d9278060a97e83f63b97d"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a></div><div class="ttdeci">static struct prometheus_general_config * config_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">test_res_prometheus.c:59</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a25507755e82d34f73b054fac5087d582"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a></div><div class="ttdeci">void prometheus_general_config_set(struct prometheus_general_config *config)</div><div class="ttdoc">Set the configuration for the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00750">res_prometheus.c:750</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d8df8ce54e4cb34fdb66469ab40f321"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a></div><div class="ttdeci">static CURL * get_curl_instance(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">test_res_prometheus.c:76</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a9a2bd8cdaba0e529b3d5c3b0519e32e6"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a></div><div class="ttdeci">static void curl_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">test_res_prometheus.c:41</a></div></div>
<div class="ttc" id="structprometheus__general__config_html_a63be54a0beac1f5717217e1d9e629c71"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html#a63be54a0beac1f5717217e1d9e629c71">prometheus_general_config::enabled</a></div><div class="ttdeci">unsigned int enabled</div><div class="ttdoc">Whether or not the module is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00071">res_prometheus.h:71</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa78076ce1783413c7ed5b4334421caae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa78076ce1783413c7ed5b4334421caae">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[10/10]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">config_general_core_metrics&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00640">640</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00203">AST_TEST_FAIL</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">config_alloc()</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00073">prometheus_general_config::core_metrics_enabled</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">curl_free_wrapper()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00094">curl_write_string_callback()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">get_curl_instance()</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00750">prometheus_general_config_set()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, and <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>.</p>
<div class="fragment"><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(CURL *, curl, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a>);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, buffer, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test producing core metrics&quot;</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;         <span class="stringliteral">&quot;This test covers the core metrics that are produced\n&quot;</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         <span class="stringliteral">&quot;by the basic Prometheus module.&quot;</span>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   buffer = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keywordflow">if</span> (!buffer) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   config = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a>();</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   <span class="keywordflow">if</span> (!config) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   }</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   config-&gt;<a class="code" href="../../d0/d5a/structprometheus__general__config.html#a6ab3071a788e8d57f71bcbc557ba0b67">core_metrics_enabled</a> = 1;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <span class="comment">/* Prometheus module owns the ref after this call */</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a>(config);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(config, -1);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   curl = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a>();</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keywordflow">if</span> (!curl) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;   }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; CURLing request...\n&quot;</span>);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">curl_write_string_callback</a>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   curl_easy_setopt(curl, CURLOPT_WRITEDATA, &amp;buffer);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   res = curl_easy_perform(curl);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordflow">if</span> (res != CURLE_OK) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Failed to execute CURL: %d\n&quot;</span>, res);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; Retrieved: %s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer));</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; Checking for core properties\n&quot;</span>);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, strstr(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer), <span class="stringliteral">&quot;asterisk_core_properties&quot;</span>) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; Checking for uptime\n&quot;</span>);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, strstr(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer), <span class="stringliteral">&quot;asterisk_core_uptime_seconds&quot;</span>) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; Checking for last reload\n&quot;</span>);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, strstr(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer), <span class="stringliteral">&quot;asterisk_core_last_reload_seconds&quot;</span>) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot; -&gt; Checking for scrape time\n&quot;</span>);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, strstr(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer), <span class="stringliteral">&quot;asterisk_core_scrape_time_ms&quot;</span>) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;}</div><div class="ttc" id="structprometheus__general__config_html_a6ab3071a788e8d57f71bcbc557ba0b67"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html#a6ab3071a788e8d57f71bcbc557ba0b67">prometheus_general_config::core_metrics_enabled</a></div><div class="ttdeci">unsigned int core_metrics_enabled</div><div class="ttdoc">Whether or not core metrics are enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00073">res_prometheus.h:73</a></div></div>
<div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0e016784943d9278060a97e83f63b97d"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a></div><div class="ttdeci">static struct prometheus_general_config * config_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">test_res_prometheus.c:59</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a25507755e82d34f73b054fac5087d582"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a></div><div class="ttdeci">void prometheus_general_config_set(struct prometheus_general_config *config)</div><div class="ttdoc">Set the configuration for the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00750">res_prometheus.c:750</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0d8df8ce54e4cb34fdb66469ab40f321"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0d8df8ce54e4cb34fdb66469ab40f321">get_curl_instance</a></div><div class="ttdeci">static CURL * get_curl_instance(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">test_res_prometheus.c:76</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a90e2a3dfc5c1b5a46e5af3f2bdce7b2f"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">curl_write_string_callback</a></div><div class="ttdeci">static size_t curl_write_string_callback(void *contents, size_t size, size_t nmemb, void *userdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00094">test_res_prometheus.c:94</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a9a2bd8cdaba0e529b3d5c3b0519e32e6"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a9a2bd8cdaba0e529b3d5c3b0519e32e6">curl_free_wrapper</a></div><div class="ttdeci">static void curl_free_wrapper(void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">test_res_prometheus.c:41</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8a11a3a19eb4c9fd2ba654d95df1adb6">AST_TEST_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00203">test.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e016784943d9278060a97e83f63b97d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e016784943d9278060a97e83f63b97d">&#9670;&nbsp;</a></span>config_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>* config_alloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">59</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00514">ast_string_field_set</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00073">prometheus_general_config::core_metrics_enabled</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00071">prometheus_general_config::enabled</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00726">prometheus_general_config_alloc()</a>, and <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00083">prometheus_general_config::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00520">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00750">test_init_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   config = <a class="code" href="../../d0/db1/res__prometheus_8h.html#adbfa9427d40e32fe0111a3746d95133c">prometheus_general_config_alloc</a>();</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordflow">if</span> (!config) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="comment">/* Set what we need on the config for most tests */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(config, <a class="code" href="../../d0/d5a/structprometheus__general__config.html#a19ac71226fac09e87afe31acb4c99214">uri</a>, <span class="stringliteral">&quot;test_metrics&quot;</span>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   config-&gt;<a class="code" href="../../d0/d5a/structprometheus__general__config.html#a63be54a0beac1f5717217e1d9e629c71">enabled</a> = 1;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   config-&gt;<a class="code" href="../../d0/d5a/structprometheus__general__config.html#a6ab3071a788e8d57f71bcbc557ba0b67">core_metrics_enabled</a> = 0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="ttc" id="structprometheus__general__config_html_a6ab3071a788e8d57f71bcbc557ba0b67"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html#a6ab3071a788e8d57f71bcbc557ba0b67">prometheus_general_config::core_metrics_enabled</a></div><div class="ttdeci">unsigned int core_metrics_enabled</div><div class="ttdoc">Whether or not core metrics are enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00073">res_prometheus.h:73</a></div></div>
<div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_adbfa9427d40e32fe0111a3746d95133c"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#adbfa9427d40e32fe0111a3746d95133c">prometheus_general_config_alloc</a></div><div class="ttdeci">void * prometheus_general_config_alloc(void)</div><div class="ttdoc">Allocate a new configuration object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00726">res_prometheus.c:726</a></div></div>
<div class="ttc" id="structprometheus__general__config_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html#a19ac71226fac09e87afe31acb4c99214">prometheus_general_config::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdoc">The HTTP URI we register ourselves to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00083">res_prometheus.h:83</a></div></div>
<div class="ttc" id="structprometheus__general__config_html_a63be54a0beac1f5717217e1d9e629c71"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html#a63be54a0beac1f5717217e1d9e629c71">prometheus_general_config::enabled</a></div><div class="ttdeci">unsigned int enabled</div><div class="ttdoc">Whether or not the module is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00071">res_prometheus.h:71</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a2bd8cdaba0e529b3d5c3b0519e32e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a2bd8cdaba0e529b3d5c3b0519e32e6">&#9670;&nbsp;</a></span>curl_free_wrapper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void curl_free_wrapper </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00041">41</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <span class="keywordflow">if</span> (!ptr) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   }</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   curl_easy_cleanup(ptr);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a90e2a3dfc5c1b5a46e5af3f2bdce7b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90e2a3dfc5c1b5a46e5af3f2bdce7b2f">&#9670;&nbsp;</a></span>curl_write_string_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t curl_write_string_callback </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>contents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nmemb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>userdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00094">94</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00193">ast_malloc</a>, and <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **buffer = userdata;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordtype">size_t</span> realsize = size * nmemb;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="keywordtype">char</span> *rawdata;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   rawdata = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(realsize + 1);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keywordflow">if</span> (!rawdata) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   memcpy(rawdata, <a class="code" href="../../d5/dde/test__func__file_8c.html#aedde4c44231f9adaad3339ebe693e8d8">contents</a>, realsize);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   rawdata[realsize] = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(buffer, 0, <span class="stringliteral">&quot;%s&quot;</span>, rawdata);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(rawdata);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="keywordflow">return</span> realsize;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="test__func__file_8c_html_aedde4c44231f9adaad3339ebe693e8d8"><div class="ttname"><a href="../../d5/dde/test__func__file_8c.html#aedde4c44231f9adaad3339ebe693e8d8">contents</a></div><div class="ttdeci">const char * contents</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/test__func__file_8c_source.html#l00045">test_func_file.c:45</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d8df8ce54e4cb34fdb66469ab40f321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d8df8ce54e4cb34fdb66469ab40f321">&#9670;&nbsp;</a></span>get_curl_instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static CURL* get_curl_instance </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">76</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00057">GLOBAL_USERAGENT</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00037">server_uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   CURL *curl;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   curl = curl_easy_init();</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordflow">if</span> (!curl) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   curl_easy_setopt(curl, CURLOPT_NOSIGNAL, 1);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   curl_easy_setopt(curl, CURLOPT_TIMEOUT, 180);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   curl_easy_setopt(curl, CURLOPT_USERAGENT, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#ad9f74a3dcbfde83a6538a60020059b75">GLOBAL_USERAGENT</a>);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   curl_easy_setopt(curl, CURLOPT_URL, <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="keywordflow">return</span> curl;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div><div class="ttc" id="test__res__prometheus_8c_html_ad9f74a3dcbfde83a6538a60020059b75"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#ad9f74a3dcbfde83a6538a60020059b75">GLOBAL_USERAGENT</a></div><div class="ttdeci">#define GLOBAL_USERAGENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00057">test_res_prometheus.c:57</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00037">test_res_prometheus.c:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00799">799</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00315">AST_MODFLAG_DEFAULT</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00127">AST_TEST_REGISTER</a>, <a class="el" href="../../d8/db9/test_8c_source.html#l00177">ast_test_register_cleanup()</a>, <a class="el" href="../../d8/db9/test_8c_source.html#l00160">ast_test_register_init()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">CATEGORY</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00704">process_config()</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00741">reload()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00776">reload_module()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00768">test_cleanup_cb()</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00750">test_init_cb()</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00781">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;{</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a>(0)) {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;   }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(metric_values);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(metric_callback_register);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(metric_register);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(counter_to_string);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(counter_create);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(gauge_to_string);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(gauge_create);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(config_general_enabled);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(config_general_basic_auth);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(config_general_core_metrics);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <a class="code" href="../../d8/db9/test_8c.html#a4e75c29c042ce5aa6c80cff24fa7f078">ast_test_register_init</a>(<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>, &amp;<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a74f59d77cd5fb076d3a3628bc1310b60">test_init_cb</a>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <a class="code" href="../../d8/db9/test_8c.html#af12ce196f7d1a605f046ed778049c2e0">ast_test_register_cleanup</a>(<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>, &amp;<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#ad3b9a35577ec3254d74389c44112a914">test_cleanup_cb</a>);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div><div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="test_8c_html_a4e75c29c042ce5aa6c80cff24fa7f078"><div class="ttname"><a href="../../d8/db9/test_8c.html#a4e75c29c042ce5aa6c80cff24fa7f078">ast_test_register_init</a></div><div class="ttdeci">int ast_test_register_init(const char *category, ast_test_init_cb_t *cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/db9/test_8c_source.html#l00160">test.c:160</a></div></div>
<div class="ttc" id="test_8h_html_a34f64a69c09d98ceb693b077efd7ef97"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a></div><div class="ttdeci">#define AST_TEST_REGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00127">test.h:127</a></div></div>
<div class="ttc" id="test_8c_html_af12ce196f7d1a605f046ed778049c2e0"><div class="ttname"><a href="../../d8/db9/test_8c.html#af12ce196f7d1a605f046ed778049c2e0">ast_test_register_cleanup</a></div><div class="ttdeci">int ast_test_register_cleanup(const char *category, ast_test_cleanup_cb_t *cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/db9/test_8c_source.html#l00177">test.c:177</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00035">test_res_prometheus.c:35</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a23c29a0c6da3b09b04d3f801bd44673e"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a></div><div class="ttdeci">static int process_config(int reload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00704">test_res_prometheus.c:704</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a74f59d77cd5fb076d3a3628bc1310b60"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a74f59d77cd5fb076d3a3628bc1310b60">test_init_cb</a></div><div class="ttdeci">static int test_init_cb(struct ast_test_info *info, struct ast_test *test)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00750">test_res_prometheus.c:750</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_ad3b9a35577ec3254d74389c44112a914"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#ad3b9a35577ec3254d74389c44112a914">test_cleanup_cb</a></div><div class="ttdeci">static int test_cleanup_cb(struct ast_test_info *info, struct ast_test *test)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00768">test_res_prometheus.c:768</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c7474a9031fa2b6421a8d7ea61f1264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7474a9031fa2b6421a8d7ea61f1264">&#9670;&nbsp;</a></span>metric_values_get_counter_value_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void metric_values_get_counter_value_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> *&#160;</td>
          <td class="paramname"><em>metric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00112">112</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00230">prometheus_metric::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00117">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   strcpy(metric-&gt;<a class="code" href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">value</a>, <span class="stringliteral">&quot;2&quot;</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html_ae0c1e3dcbc35f789a9e9ff7bfbf468b1"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html#ae0c1e3dcbc35f789a9e9ff7bfbf468b1">prometheus_metric::value</a></div><div class="ttdeci">char value[PROMETHEUS_MAX_VALUE_LENGTH]</div><div class="ttdoc">The current value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00230">res_prometheus.h:230</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a23c29a0c6da3b09b04d3f801bd44673e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23c29a0c6da3b09b04d3f801bd44673e">&#9670;&nbsp;</a></span>process_config()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int process_config </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reload</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00704">704</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/dc5/extconf_8c_source.html#l01290">ast_config_destroy()</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">ast_config_load</a>, <a class="el" href="../../d2/d9d/main_2config_8c_source.html#l00684">ast_config_option()</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l01968">ast_false()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00268">AST_LOG_NOTICE</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00353">bindaddr</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">CONFIG_FLAG_FILEUNCHANGED</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">CONFIG_STATUS_FILEINVALID</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">CONFIG_STATUS_FILEUNCHANGED</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00091">enabled</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00141">prefix</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00037">server_uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00799">load_module()</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00776">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;{</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> ? <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a80ca8badd36b5edc83592e8f017817a4">bindaddr</a>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *bindport;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dd/d43/http_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a>;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d5d/dnsmgr_8c.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a>(<span class="stringliteral">&quot;http.conf&quot;</span>, config_flags);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <span class="keywordflow">if</span> (!config || config == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a>, <span class="stringliteral">&quot;HTTP config file is invalid; declining load&quot;</span>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   enabled = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;enabled&quot;</span>);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <span class="keywordflow">if</span> (!enabled || <a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(enabled)) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a>, <span class="stringliteral">&quot;HTTP server is disabled; declining load&quot;</span>);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="comment">/* Construct our Server URI */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   bindaddr = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;bindaddr&quot;</span>);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordflow">if</span> (!bindaddr) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a>, <span class="stringliteral">&quot;HTTP config file fails to specify &#39;bindaddr&#39;; declining load&quot;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   bindport = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;bindport&quot;</span>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   <span class="keywordflow">if</span> (!bindport) {</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      bindport = <span class="stringliteral">&quot;8088&quot;</span>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   }</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   prefix = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;prefix&quot;</span>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   snprintf(<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d80/test__res__prometheus_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>), <span class="stringliteral">&quot;http://%s:%s%s/test_metrics&quot;</span>, bindaddr, bindport, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(prefix, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8d1a63cdf2c7aff22a77b6e75d93b377"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEINVALID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">include/asterisk/config.h:60</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00037">test_res_prometheus.c:37</a></div></div>
<div class="ttc" id="logger_8h_html_ad6810d73cb786e5e74c55c8bd8688e05"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad6810d73cb786e5e74c55c8bd8688e05">AST_LOG_NOTICE</a></div><div class="ttdeci">#define AST_LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00268">logger.h:268</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a0a07ddd6bbcf44485e01c14c96109482"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a></div><div class="ttdeci">#define ast_config_load(filename, flags)</div><div class="ttdoc">Load a config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">include/asterisk/config.h:179</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6b4d4d929013de7812fbba4e58353078"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a></div><div class="ttdeci">void ast_config_destroy(struct ast_config *config)</div><div class="ttdoc">Destroys a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01290">extconf.c:1290</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a846844eb2c4eb44554445936b3770711"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEUNCHANGED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">include/asterisk/config.h:59</a></div></div>
<div class="ttc" id="structast__config_html"><div class="ttname"><a href="../../dd/d18/structast__config.html">ast_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00249">main/config.c:249</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_ad1982509765f4870f1f63412a53ea668"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00741">cdr_mysql.c:741</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="strings_8h_html_a6c3dc0bad204e9dd9890325c1c861e38"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a></div><div class="ttdeci">int attribute_pure ast_false(const char *val)</div><div class="ttdoc">Make sure something is false. Determine if a string containing a boolean value is &quot;false&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01968">main/utils.c:1968</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad9fd2625614158b152434e45acf1d78b"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a></div><div class="ttdeci">const char * ast_config_option(struct ast_config *cfg, const char *cat, const char *var)</div><div class="ttdoc">Retrieve a configuration variable within the configuration set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00684">main/config.c:684</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a80ca8badd36b5edc83592e8f017817a4"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a80ca8badd36b5edc83592e8f017817a4">bindaddr</a></div><div class="ttdeci">struct ast_sockaddr bindaddr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00353">chan_ooh323.c:353</a></div></div>
<div class="ttc" id="http_8c_html_a6f25bc812d09fedb86bf394c01061c56"><div class="ttname"><a href="../../dd/d43/http_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a></div><div class="ttdeci">static char prefix[MAX_PREFIX]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00141">http.c:141</a></div></div>
<div class="ttc" id="dnsmgr_8c_html_a03e6cca0c879c0443efb431c30c14f76"><div class="ttname"><a href="../../d0/d5d/dnsmgr_8c.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a></div><div class="ttdeci">static int enabled</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5d/dnsmgr_8c_source.html#l00091">dnsmgr.c:91</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">include/asterisk/config.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8fcdf26266a1df6a1f0063dd03e4063"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8fcdf26266a1df6a1f0063dd03e4063">&#9670;&nbsp;</a></span>prometheus_metric_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void prometheus_metric_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>output</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00191">191</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00128">PROMETHEUS_METRIC_COUNTER</a>, <a class="el" href="../../d0/db1/res__prometheus_8h_source.html#l00287">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00521">prometheus_metric_to_string()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00202">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d94/structprometheus__metric.html">prometheus_metric</a> test_counter = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a>(</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a>,</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="stringliteral">&quot;test_counter&quot;</span>,</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="stringliteral">&quot;A test counter&quot;</span>,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a>(&amp;test_counter, output);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="ttc" id="structprometheus__metric_html"><div class="ttname"><a href="../../de/d94/structprometheus__metric.html">prometheus_metric</a></div><div class="ttdoc">An actual, honest to god, metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00196">res_prometheus.h:196</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a3499408dda4e539634c332c797651932af12e9bafa9a85ea9eda528448e4c8445">PROMETHEUS_METRIC_COUNTER</a></div><div class="ttdoc">A metric whose value always goes up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00128">res_prometheus.h:128</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a34366ff9c420980c21bbbfd05fe9c6d2"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a34366ff9c420980c21bbbfd05fe9c6d2">PROMETHEUS_METRIC_STATIC_INITIALIZATION</a></div><div class="ttdeci">#define PROMETHEUS_METRIC_STATIC_INITIALIZATION(mtype, n, h, cb)</div><div class="ttdoc">Convenience macro for initializing a metric on the stack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00287">res_prometheus.h:287</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_abd25ff5603091eef2d7bf3fed8f7474a"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#abd25ff5603091eef2d7bf3fed8f7474a">prometheus_metric_to_string</a></div><div class="ttdeci">void prometheus_metric_to_string(struct prometheus_metric *metric, struct ast_str **output)</div><div class="ttdoc">Convert a metric (and its children) into Prometheus compatible text. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00521">res_prometheus.c:521</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d24aa0ecc9425598e6a15d727522012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d24aa0ecc9425598e6a15d727522012">&#9670;&nbsp;</a></span>prometheus_metric_free_wrapper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void prometheus_metric_free_wrapper </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00050">50</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00392">prometheus_metric_free()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00334">prometheus_metric_unregister()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00260">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a>(ptr)) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <a class="code" href="../../d0/db1/res__prometheus_8h.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a>(ptr);</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div><div class="ttc" id="res__prometheus_8h_html_a02a3a2b23615b19bdc4ab8a9ab396dba"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a02a3a2b23615b19bdc4ab8a9ab396dba">prometheus_metric_unregister</a></div><div class="ttdeci">int prometheus_metric_unregister(struct prometheus_metric *metric)</div><div class="ttdoc">Remove a registered metric. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00334">res_prometheus.c:334</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_ab8409a6e51c0e44c5802261465034a57"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#ab8409a6e51c0e44c5802261465034a57">prometheus_metric_free</a></div><div class="ttdeci">void prometheus_metric_free(struct prometheus_metric *metric)</div><div class="ttdoc">Destroy a metric and all its children. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00392">res_prometheus.c:392</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c6ac25ea7536c0bc9ed18cbcf917527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6ac25ea7536c0bc9ed18cbcf917527">&#9670;&nbsp;</a></span>reload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int reload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00776">776</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00704">process_config()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00799">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;{</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a>(1);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div><div class="ttc" id="test__res__prometheus_8c_html_a23c29a0c6da3b09b04d3f801bd44673e"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a></div><div class="ttdeci">static int process_config(int reload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00704">test_res_prometheus.c:704</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3b9a35577ec3254d74389c44112a914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3b9a35577ec3254d74389c44112a914">&#9670;&nbsp;</a></span>test_cleanup_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_cleanup_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d62/structast__test__info.html">ast_test_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00768">768</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00750">prometheus_general_config_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00799">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;{</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a>(<a class="code" href="../../db/d57/structmodule__config.html">module_config</a>);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../db/d57/structmodule__config.html">module_config</a>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div><div class="ttc" id="res__prometheus_8h_html_a25507755e82d34f73b054fac5087d582"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a></div><div class="ttdeci">void prometheus_general_config_set(struct prometheus_general_config *config)</div><div class="ttdoc">Set the configuration for the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00750">res_prometheus.c:750</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74f59d77cd5fb076d3a3628bc1310b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74f59d77cd5fb076d3a3628bc1310b60">&#9670;&nbsp;</a></span>test_init_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_init_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d62/structast__test__info.html">ast_test_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00750">750</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">config_alloc()</a>, <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00738">prometheus_general_config_get()</a>, and <a class="el" href="../../d7/d1b/res__prometheus_8c_source.html#l00750">prometheus_general_config_set()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00799">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;{</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a> *new_module_config;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   new_module_config = <a class="code" href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a>();</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   <span class="keywordflow">if</span> (!new_module_config) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   <a class="code" href="../../db/d57/structmodule__config.html">module_config</a> = <a class="code" href="../../d0/db1/res__prometheus_8h.html#a62b2557ffd682d4efec2d3094a01d104">prometheus_general_config_get</a>();</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <a class="code" href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a>(new_module_config);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="comment">/* Allow the module to own the ref */</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(new_module_config, -1);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div><div class="ttc" id="structprometheus__general__config_html"><div class="ttname"><a href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a></div><div class="ttdoc">Prometheus general configuration. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db1/res__prometheus_8h_source.html#l00069">res_prometheus.h:69</a></div></div>
<div class="ttc" id="test__res__prometheus_8c_html_a0e016784943d9278060a97e83f63b97d"><div class="ttname"><a href="../../d6/d80/test__res__prometheus_8c.html#a0e016784943d9278060a97e83f63b97d">config_alloc</a></div><div class="ttdeci">static struct prometheus_general_config * config_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d80/test__res__prometheus_8c_source.html#l00059">test_res_prometheus.c:59</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a25507755e82d34f73b054fac5087d582"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a25507755e82d34f73b054fac5087d582">prometheus_general_config_set</a></div><div class="ttdeci">void prometheus_general_config_set(struct prometheus_general_config *config)</div><div class="ttdoc">Set the configuration for the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00750">res_prometheus.c:750</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structmodule__config_html"><div class="ttname"><a href="../../db/d57/structmodule__config.html">module_config</a></div><div class="ttdoc">The configuration settings for this module. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l00222">cdr.c:222</a></div></div>
<div class="ttc" id="res__prometheus_8h_html_a62b2557ffd682d4efec2d3094a01d104"><div class="ttname"><a href="../../d0/db1/res__prometheus_8h.html#a62b2557ffd682d4efec2d3094a01d104">prometheus_general_config_get</a></div><div class="ttdeci">struct prometheus_general_config * prometheus_general_config_get(void)</div><div class="ttdoc">Retrieve the current configuration of the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1b/res__prometheus_8c_source.html#l00738">res_prometheus.c:738</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00781">781</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/ddc/test_8h_source.html#l00128">AST_TEST_UNREGISTER</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00799">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;{</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(metric_values);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(metric_callback_register);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(metric_register);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(counter_to_string);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(counter_create);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(gauge_to_string);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(gauge_create);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(config_general_enabled);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(config_general_basic_auth);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(config_general_core_metrics);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;}</div><div class="ttc" id="test_8h_html_a79bc64a935b14b1b181156e5ada58ead"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a></div><div class="ttdeci">#define AST_TEST_UNREGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00128">test.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a54af2a9b29d140908cc9dffd0618951b">AST_MODFLAG_DEFAULT</a> , .description = &quot;Prometheus Core Unit Tests&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .<a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .requires = &quot;res_prometheus&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00829">829</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00829">829</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

</div>
</div>
<a id="ac46978d10efd8fba3192c1fc26f9e235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46978d10efd8fba3192c1fc26f9e235">&#9670;&nbsp;</a></span>module_config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d5a/structprometheus__general__config.html">prometheus_general_config</a>* <a class="el" href="../../db/d57/structmodule__config.html">module_config</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00039">39</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

</div>
</div>
<a id="af04e2af06333eeaa204e80f690383b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af04e2af06333eeaa204e80f690383b30">&#9670;&nbsp;</a></span>server_uri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char server_uri[512]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00037">37</a> of file <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html">test_res_prometheus.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00076">get_curl_instance()</a>, and <a class="el" href="../../d6/d80/test__res__prometheus_8c_source.html#l00704">process_config()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:56 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
