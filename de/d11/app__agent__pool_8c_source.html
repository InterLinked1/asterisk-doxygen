<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: app_agent_pool.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_9654b8d08f4bba4e84b362c5fd320bee.html">apps</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">app_agent_pool.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../de/d11/app__agent__pool_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Asterisk -- An open source telephony toolkit.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (C) 2013 Digium, Inc.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Richard Mudgett &lt;rmudgett@digium.com&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * See http://www.asterisk.org for more information about</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Asterisk project. Please do not directly contact</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * any of the maintainers of this project for assistance;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * the project provides a web site, mailing lists and IRC</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * channels for your use.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * This program is free software, distributed under the terms of</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * at the top of the source tree.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * \file</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * \brief Call center agent pool.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * \author Richard Mudgett &lt;rmudgett@digium.com&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * See Also:</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * \arg \ref AstCREDITS</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * \arg \ref Config_agent</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/*** MODULEINFO</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">   &lt;support_level&gt;core&lt;/support_level&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db2/asterisk_8h.html">asterisk.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db0/cli_8h.html">asterisk/cli.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html">asterisk/app.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de0/pbx_8h.html">asterisk/pbx.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d16/module_8h.html">asterisk/module.h</a>&quot;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7b/channel_8h.html">asterisk/channel.h</a>&quot;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d56/bridge_8h.html">asterisk/bridge.h</a>&quot;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dde/bridge__internal_8h.html">asterisk/bridge_internal.h</a>&quot;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d1e/bridge__basic_8h.html">asterisk/bridge_basic.h</a>&quot;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d85/bridge__after_8h.html">asterisk/bridge_after.h</a>&quot;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dfe/config__options_8h.html">asterisk/config_options.h</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html">asterisk/features_config.h</a>&quot;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da5/astobj2_8h.html">asterisk/astobj2.h</a>&quot;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d0f/stringfields_8h.html">asterisk/stringfields.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d4a/stasis__channels_8h.html">asterisk/stasis_channels.h</a>&quot;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/da3/causes_8h.html">asterisk/causes.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/*** DOCUMENTATION</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">   &lt;application name=&quot;AgentLogin&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">         Login an agent.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">      &lt;syntax argsep=&quot;,&quot;&gt;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">         &lt;parameter name=&quot;AgentId&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">         &lt;parameter name=&quot;options&quot;&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">            &lt;optionlist&gt;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">               &lt;option name=&quot;s&quot;&gt;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">                  &lt;para&gt;silent login - do not announce the login ok segment after</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">                  agent logged on.&lt;/para&gt;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">               &lt;/option&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">            &lt;/optionlist&gt;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">         &lt;para&gt;Login an agent to the system.  Any agent authentication is assumed to</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">         already be done by dialplan.  While logged in, the agent can receive calls</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">         and will hear the sound file specified by the config option custom_beep</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">         when a new call comes in for the agent.  Login failures will continue in</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">         the dialplan with &lt;variable&gt;AGENT_STATUS&lt;/variable&gt; set.&lt;/para&gt;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">         &lt;para&gt;Before logging in, you can setup on the real agent channel the</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">         CHANNEL(dtmf_features) an agent will have when talking to a caller</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">         and you can setup on the channel running this application the</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">         CONNECTEDLINE() information the agent will see while waiting for a</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">         caller.&lt;/para&gt;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">         &lt;para&gt;&lt;variable&gt;AGENT_STATUS&lt;/variable&gt; enumeration values:&lt;/para&gt;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">         &lt;enumlist&gt;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">            &lt;enum name = &quot;INVALID&quot;&gt;&lt;para&gt;The specified agent is invalid.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">            &lt;enum name = &quot;ALREADY_LOGGED_IN&quot;&gt;&lt;para&gt;The agent is already logged in.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">         &lt;/enumlist&gt;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">         &lt;note&gt;&lt;para&gt;The Agent:&lt;replaceable&gt;AgentId&lt;/replaceable&gt; device state is</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">         available to monitor the status of the agent.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Authenticate&lt;/ref&gt;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;Queue&lt;/ref&gt;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AddQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;RemoveQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;PauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UnpauseQueueMember&lt;/ref&gt;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;AGENT&lt;/ref&gt;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;CHANNEL&lt;/ref&gt;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">         &lt;ref type=&quot;function&quot;&gt;CONNECTEDLINE&lt;/ref&gt;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">         &lt;ref type=&quot;filename&quot;&gt;agents.conf&lt;/ref&gt;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">         &lt;ref type=&quot;filename&quot;&gt;queues.conf&lt;/ref&gt;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">   &lt;application name=&quot;AgentRequest&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">         Request an agent to connect with the channel.</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">      &lt;syntax argsep=&quot;,&quot;&gt;</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">         &lt;parameter name=&quot;AgentId&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">         &lt;para&gt;Request an agent to connect with the channel.  Failure to find,</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">         alert the agent, or acknowledge the call will continue in the dialplan</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">         with &lt;variable&gt;AGENT_STATUS&lt;/variable&gt; set.&lt;/para&gt;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">         &lt;para&gt;&lt;variable&gt;AGENT_STATUS&lt;/variable&gt; enumeration values:&lt;/para&gt;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">         &lt;enumlist&gt;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">            &lt;enum name = &quot;INVALID&quot;&gt;&lt;para&gt;The specified agent is invalid.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">            &lt;enum name = &quot;NOT_LOGGED_IN&quot;&gt;&lt;para&gt;The agent is not available.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">            &lt;enum name = &quot;BUSY&quot;&gt;&lt;para&gt;The agent is on another call.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">            &lt;enum name = &quot;NOT_CONNECTED&quot;&gt;&lt;para&gt;The agent did not connect with the</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">            call.  The agent most likely did not acknowledge the call.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">            &lt;enum name = &quot;ERROR&quot;&gt;&lt;para&gt;Alerting the agent failed.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">         &lt;/enumlist&gt;</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;AgentLogin&lt;/ref&gt;</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">   &lt;/application&gt;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">   &lt;function name=&quot;AGENT&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">         Gets information about an Agent</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">      &lt;syntax argsep=&quot;:&quot;&gt;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">         &lt;parameter name=&quot;AgentId&quot; required=&quot;true&quot; /&gt;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">         &lt;parameter name=&quot;item&quot;&gt;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">            &lt;para&gt;The valid items to retrieve are:&lt;/para&gt;</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">               &lt;enum name=&quot;status&quot;&gt;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">                  &lt;para&gt;(default) The status of the agent (LOGGEDIN | LOGGEDOUT)&lt;/para&gt;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">               &lt;enum name=&quot;password&quot;&gt;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">                  &lt;para&gt;Deprecated.  The dialplan handles any agent authentication.&lt;/para&gt;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">               &lt;enum name=&quot;name&quot;&gt;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">                  &lt;para&gt;The name of the agent&lt;/para&gt;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">               &lt;enum name=&quot;mohclass&quot;&gt;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">                  &lt;para&gt;MusicOnHold class&lt;/para&gt;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">               &lt;enum name=&quot;channel&quot;&gt;</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">                  &lt;para&gt;The name of the active channel for the Agent (AgentLogin)&lt;/para&gt;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">               &lt;enum name=&quot;fullchannel&quot;&gt;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">                  &lt;para&gt;The untruncated name of the active channel for the Agent (AgentLogin)&lt;/para&gt;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">      &lt;description&gt;&lt;/description&gt;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">   &lt;manager name=&quot;Agents&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">         Lists agents and their status.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">         &lt;para&gt;Will list info about all defined agents.&lt;/para&gt;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;Agents&lt;/ref&gt;</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;AgentsComplete&lt;/ref&gt;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;Agents&quot;&gt;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">         &lt;synopsis&gt;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">            Response event in a series to the Agents AMI action containing</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">            information about a defined agent.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">         &lt;/synopsis&gt;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">            &lt;parameter name=&quot;Agent&quot;&gt;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">               &lt;para&gt;Agent ID of the agent.&lt;/para&gt;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">            &lt;parameter name=&quot;Name&quot;&gt;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">               &lt;para&gt;User friendly name of the agent.&lt;/para&gt;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">            &lt;parameter name=&quot;Status&quot;&gt;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">               &lt;para&gt;Current status of the agent.&lt;/para&gt;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">               &lt;para&gt;The valid values are:&lt;/para&gt;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">                  &lt;enum name=&quot;AGENT_LOGGEDOFF&quot; /&gt;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">                  &lt;enum name=&quot;AGENT_IDLE&quot; /&gt;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">                  &lt;enum name=&quot;AGENT_ONCALL&quot; /&gt;</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">            &lt;parameter name=&quot;TalkingToChan&quot;&gt;</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">               &lt;para&gt;&lt;variable&gt;BRIDGEPEER&lt;/variable&gt; value on agent channel.&lt;/para&gt;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">               &lt;para&gt;Present if Status value is &lt;literal&gt;AGENT_ONCALL&lt;/literal&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">            &lt;parameter name=&quot;CallStarted&quot;&gt;</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">               &lt;para&gt;Epoche time when the agent started talking with the caller.&lt;/para&gt;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">               &lt;para&gt;Present if Status value is &lt;literal&gt;AGENT_ONCALL&lt;/literal&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">            &lt;parameter name=&quot;LoggedInTime&quot;&gt;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">               &lt;para&gt;Epoche time when the agent logged in.&lt;/para&gt;</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">               &lt;para&gt;Present if Status value is &lt;literal&gt;AGENT_IDLE&lt;/literal&gt; or &lt;literal&gt;AGENT_ONCALL&lt;/literal&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">         &lt;description&gt;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">            &lt;para&gt;The channel snapshot is present if the Status value is &lt;literal&gt;AGENT_IDLE&lt;/literal&gt; or &lt;literal&gt;AGENT_ONCALL&lt;/literal&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">         &lt;/description&gt;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;Agents&lt;/ref&gt;</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;AgentsComplete&quot;&gt;</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_AGENT&quot;&gt;</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">         &lt;synopsis&gt;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">            Final response event in a series of events to the Agents AMI action.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">         &lt;/synopsis&gt;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;Agents&lt;/ref&gt;</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">   &lt;manager name=&quot;AgentLogoff&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">         Sets an agent as no longer logged in.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">         &lt;parameter name=&quot;Agent&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">            &lt;para&gt;Agent ID of the agent to log off.&lt;/para&gt;</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">         &lt;parameter name=&quot;Soft&quot;&gt;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">            &lt;para&gt;Set to &lt;literal&gt;true&lt;/literal&gt; to not hangup existing calls.&lt;/para&gt;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">         &lt;para&gt;Sets an agent as no longer logged in.&lt;/para&gt;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">   &lt;configInfo name=&quot;app_agent_pool&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">      &lt;synopsis&gt;Agent pool applications&lt;/synopsis&gt;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">         &lt;note&gt;&lt;para&gt;Option changes take effect on agent login or after an agent</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">         disconnects from a call.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">      &lt;configFile name=&quot;agents.conf&quot;&gt;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">         &lt;configObject name=&quot;global&quot;&gt;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">            &lt;synopsis&gt;Unused, but reserved.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">         &lt;/configObject&gt;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">         &lt;configObject name=&quot;agent-id&quot;&gt;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">            &lt;synopsis&gt;Configure an agent for the pool.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">            &lt;description&gt;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">               &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">            &lt;/description&gt;</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">            &lt;configOption name=&quot;ackcall&quot;&gt;</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">               &lt;synopsis&gt;Enable to require the agent to acknowledge a call.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">                  &lt;para&gt;Enable to require the agent to give a DTMF acknowledgement</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">                  when the agent receives a call.&lt;/para&gt;</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;The option is overridden by &lt;variable&gt;AGENTACKCALL&lt;/variable&gt; on agent login.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">            &lt;configOption name=&quot;acceptdtmf&quot;&gt;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">               &lt;synopsis&gt;DTMF key sequence the agent uses to acknowledge a call.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;The option is overridden by &lt;variable&gt;AGENTACCEPTDTMF&lt;/variable&gt; on agent login.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;The option is ignored unless the ackcall option is enabled.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">            &lt;configOption name=&quot;autologoff&quot;&gt;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">               &lt;synopsis&gt;Time the agent has to acknowledge a call before being logged off.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">                  &lt;para&gt;Set how many seconds a call for the agent has to wait for the</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">                  agent to acknowledge the call before the agent is automatically</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">                  logged off.  If set to zero then the call will wait forever for</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">                  the agent to acknowledge.&lt;/para&gt;</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;The option is overridden by &lt;variable&gt;AGENTAUTOLOGOFF&lt;/variable&gt; on agent login.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;The option is ignored unless the ackcall option is enabled.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">            &lt;configOption name=&quot;wrapuptime&quot;&gt;</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">               &lt;synopsis&gt;Minimum time the agent has between calls.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">                  &lt;para&gt;Set the minimum amount of time in milliseconds after</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">                  disconnecting a call before the agent can receive a new call.&lt;/para&gt;</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">                  &lt;note&gt;&lt;para&gt;The option is overridden by &lt;variable&gt;AGENTWRAPUPTIME&lt;/variable&gt; on agent login.&lt;/para&gt;&lt;/note&gt;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">            &lt;configOption name=&quot;musiconhold&quot;&gt;</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">               &lt;synopsis&gt;Music on hold class the agent listens to between calls.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">            &lt;configOption name=&quot;recordagentcalls&quot;&gt;</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">               &lt;synopsis&gt;Enable to automatically record calls the agent takes.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">                  &lt;para&gt;Enable recording calls the agent takes automatically by</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">                  invoking the automixmon DTMF feature when the agent connects</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">                  to a caller.  See &lt;filename&gt;features.conf.sample&lt;/filename&gt; for information about</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">                  the automixmon feature.&lt;/para&gt;</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">            &lt;configOption name=&quot;custom_beep&quot;&gt;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">               &lt;synopsis&gt;Sound file played to alert the agent when a call is present.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">            &lt;configOption name=&quot;fullname&quot;&gt;</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">               &lt;synopsis&gt;A friendly name for the agent used in log messages.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">               &lt;description&gt;</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">                  &lt;xi:include xpointer=&quot;xpointer(/docs/configInfo[@name=&#39;app_agent_pool&#39;]/description/note)&quot; /&gt;</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">               &lt;/description&gt;</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">            &lt;/configOption&gt;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">         &lt;/configObject&gt;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">      &lt;/configFile&gt;</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">   &lt;/configInfo&gt;</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/* ------------------------------------------------------------------- */</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a34d3e99d5529e36506d0ee8a9982c281">  336</a></span>&#160;<span class="preprocessor">#define AST_MAX_BUF  256</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">/*! Maximum wait time (in ms) for the custom_beep file to play announcing the caller. */</span></div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a1d78ba0e31a3a17b37273be121850718">  339</a></span>&#160;<span class="preprocessor">#define CALLER_SAFETY_TIMEOUT_TIME  (2 * 60 * 1000)</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">/*! Number of seconds to wait for local channel optimizations to complete. */</span></div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ab9353a3e165a7fd78b69b27e36d49e8b">  342</a></span>&#160;<span class="preprocessor">#define LOGIN_WAIT_TIMEOUT_TIME     5</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a358f094a1d14b589ace3b278972be56f">  344</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a358f094a1d14b589ace3b278972be56f">app_agent_login</a>[] = <span class="stringliteral">&quot;AgentLogin&quot;</span>;</div><div class="line"><a name="l00345"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a872ee537b540de2ccaea4e62ed2dc016">  345</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a872ee537b540de2ccaea4e62ed2dc016">app_agent_request</a>[] = <span class="stringliteral">&quot;AgentRequest&quot;</span>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">/*! Agent config parameters. */</span></div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="../../d4/d01/structagent__cfg.html">  348</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a>(<span class="comment"></span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">      /*! Identification of the agent.  (agents config container key) */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>);<span class="comment"></span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">      /*! Name of agent for logging and querying purposes */</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">full_name</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">      /*!</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">       * \brief DTMF string for an agent to accept a call.</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">       * \note The channel variable AGENTACCEPTDTMF overrides on login.</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d4/d01/structagent__cfg.html#a7e4d44394d3f9e352012ab905cac069e">dtmf_accept</a>);<span class="comment"></span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">      /*! Beep sound file to use.  Alert the agent a call is waiting. */</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d4/d01/structagent__cfg.html#af22047b6d8545b610cde6ad3e397fd79">beep_sound</a>);<span class="comment"></span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">      /*! MOH class to use while agent waiting for call. */</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d4/d01/structagent__cfg.html#a6c0ebcc78965d8817651856e7914631d">moh</a>);</div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">  365</a></span>&#160;   );<span class="comment"></span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">    * \brief Number of seconds for agent to ack a call before being logged off.</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">    * \note The channel variable AGENTAUTOLOGOFF overrides on login.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">    * \note If zero then timer is disabled.</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="../../d4/d01/structagent__cfg.html#aa068f603d067b1a7c92db68e5b27256b">  372</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#aa068f603d067b1a7c92db68e5b27256b">auto_logoff</a>;<span class="comment"></span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">    * \brief Time after a call in ms before the agent can get a new call.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">    * \note The channel variable AGENTWRAPUPTIME overrides on login.</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">  378</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">wrapup_time</a>;<span class="comment"></span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">    * \brief TRUE if agent needs to ack a call to accept it.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">    * \note The channel variable AGENTACKCALL overrides on login.</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="../../d4/d01/structagent__cfg.html#ad2306ec3a17979bc94169e842e87391c">  384</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#ad2306ec3a17979bc94169e842e87391c">ack_call</a>;<span class="comment"></span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">   /*! TRUE if agent calls are automatically recorded. */</span></div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="../../d4/d01/structagent__cfg.html#afa345a7167ae253354866a0e845058b2">  386</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#afa345a7167ae253354866a0e845058b2">record_agent_calls</a>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;};</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"> * \brief Agent config ao2 container sort function.</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"> * \param obj_left pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"> * \param obj_right pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"> * \param flags flags from ao2_callback()</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"> *   OBJ_POINTER - if set, &#39;obj_right&#39;, is an object.</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"> *   OBJ_KEY - if set, &#39;obj_right&#39;, is a search key item that is not an object.</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"> *   OBJ_PARTIAL_KEY - if set, &#39;obj_right&#39;, is a partial search key item that is not an object.</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"> * \retval &lt;0 if obj_left &lt; obj_right</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"> * \retval =0 if obj_left == obj_right</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"> * \retval &gt;0 if obj_left &gt; obj_right</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a81b479dda160b217188d44dffc86361f">  405</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a81b479dda160b217188d44dffc86361f">agent_cfg_sort_cmp</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj_left, <span class="keyword">const</span> <span class="keywordtype">void</span> *obj_right, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;{</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *cfg_left = obj_left;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *cfg_right = obj_right;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *right_key = obj_right;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; (<a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>)) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>:</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      right_key = cfg_right-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>:</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      cmp = strcmp(cfg_left-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>, right_key);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>:</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      cmp = strncmp(cfg_left-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>, right_key, strlen(right_key));</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a6a5ecab02628d53e614a259d45b1d520">  427</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6a5ecab02628d53e614a259d45b1d520">agent_cfg_destructor</a>(<span class="keywordtype">void</span> *vdoomed)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *doomed = vdoomed;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(doomed);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ad29a97a56d35dd72e739c27429ad2287">  434</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#ad29a97a56d35dd72e739c27429ad2287">agent_cfg_alloc</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;{</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *cfg;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   cfg = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*cfg), <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6a5ecab02628d53e614a259d45b1d520">agent_cfg_destructor</a>,</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <span class="keywordflow">if</span> (!cfg || <a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(cfg, 64)) {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cfg);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cfg, <a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>, name);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="keywordflow">return</span> cfg;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a355c423d8d2b38bf42751345e082f211">  448</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a355c423d8d2b38bf42751345e082f211">agent_cfg_find</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;{</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, username, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">/*! Agents configuration */</span></div><div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="../../dd/d4f/structagents__cfg.html">  454</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d4f/structagents__cfg.html">agents_cfg</a> {<span class="comment"></span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">   /*! Master configured agents container. */</span></div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">  456</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;};</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a383a6ddb87cd8afb52a9ade91d706ba9">  459</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a383a6ddb87cd8afb52a9ade91d706ba9">agent_type_blacklist</a>[] = {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <span class="stringliteral">&quot;general&quot;</span>,</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="stringliteral">&quot;agents&quot;</span>,</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;};</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a5cbaa6e72ca2e17b3339e7031d113dc1">  465</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../de/d71/structaco__type.html">aco_type</a> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5cbaa6e72ca2e17b3339e7031d113dc1">agent_type</a> = {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   .<a class="code" href="../../de/d71/structaco__type.html#a41ea490a42392545d2f6e2c6888cd94e">type</a> = <a class="code" href="../../db/dfe/config__options_8h.html#a840871f014617f5415dacb9a7d32a59ba423543a2da4422bd5c7664a0b8ca84d8">ACO_ITEM</a>,</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   .name = <span class="stringliteral">&quot;agent-id&quot;</span>,</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   .category_match = <a class="code" href="../../db/dfe/config__options_8h.html#ab29e0267f5b05969bcd1d16e97100ebba5892a0910f40cf2548d0b0baef53a195">ACO_BLACKLIST_ARRAY</a>,</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   .category = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code" href="../../de/d11/app__agent__pool_8c.html#a383a6ddb87cd8afb52a9ade91d706ba9">agent_type_blacklist</a>,</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   .<a class="code" href="../../de/d71/structaco__type.html#a838022f0c17b1545f08798016578f2ec">item_alloc</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad29a97a56d35dd72e739c27429ad2287">agent_cfg_alloc</a>,</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   .<a class="code" href="../../de/d71/structaco__type.html#a4087c029dcf4619e4eb37e2bd1a9a098">item_find</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a355c423d8d2b38bf42751345e082f211">agent_cfg_find</a>,</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   .<a class="code" href="../../de/d71/structaco__type.html#afa734f374ecc9f8d94f5e6cd3d934db6">item_offset</a> = offsetof(<span class="keyword">struct</span> <a class="code" href="../../dd/d4f/structagents__cfg.html">agents_cfg</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a>),</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;};</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#adb1d2a9b5b0247cdd038c09a4ca3e41b">  475</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../de/d71/structaco__type.html">aco_type</a> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#adb1d2a9b5b0247cdd038c09a4ca3e41b">agent_types</a>[] = <a class="code" href="../../db/dfe/config__options_8h.html#af773eedd7f94d718752798605c687c4b">ACO_TYPES</a>(&amp;agent_type);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">/* The general category is reserved, but unused */</span></div><div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a72c28e8d8b5bf63d00102468e6ac4907">  478</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../de/d71/structaco__type.html">aco_type</a> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a72c28e8d8b5bf63d00102468e6ac4907">general_type</a> = {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   .<a class="code" href="../../de/d71/structaco__type.html#a41ea490a42392545d2f6e2c6888cd94e">type</a> = <a class="code" href="../../db/dfe/config__options_8h.html#a840871f014617f5415dacb9a7d32a59bab3719e39fd87c376c6f143e337f73e12">ACO_GLOBAL</a>,</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   .name = <span class="stringliteral">&quot;global&quot;</span>,</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   .category_match = <a class="code" href="../../db/dfe/config__options_8h.html#ab29e0267f5b05969bcd1d16e97100ebba3e6bada4dbda566888d4317e3bf6343b">ACO_WHITELIST_EXACT</a>,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   .category = <span class="stringliteral">&quot;general&quot;</span>,</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;};</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae45e38e10e4b85b3161bdd0cb45b81ef">  485</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/d9c/structaco__file.html">aco_file</a> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae45e38e10e4b85b3161bdd0cb45b81ef">agents_conf</a> = {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   .<a class="code" href="../../d9/d9c/structaco__file.html#a7efa5e9c7494c7d4586359300221aa5d">filename</a> = <span class="stringliteral">&quot;agents.conf&quot;</span>,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   .types = <a class="code" href="../../db/dfe/config__options_8h.html#af773eedd7f94d718752798605c687c4b">ACO_TYPES</a>(&amp;general_type, &amp;agent_type),</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;};</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keyword">static</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a2b53789591de3558859d20a0800a9eda">AO2_GLOBAL_OBJ_STATIC</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#ace59e73cd525ae17e77397b0cc7f7302">cfg_handle</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a3bc870eb2da8463a4fb53bf2fee5bdf4">  492</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a3bc870eb2da8463a4fb53bf2fee5bdf4">agents_cfg_destructor</a>(<span class="keywordtype">void</span> *vdoomed)</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;{</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4f/structagents__cfg.html">agents_cfg</a> *doomed = vdoomed;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(doomed-&gt;<a class="code" href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a>);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   doomed-&gt;<a class="code" href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"> * \brief Create struct agents_cfg object.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"> * \note A lock is not needed for the object or any secondary</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"> * created cfg objects.  These objects are immutable after the</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"> * config is loaded and applied.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"> * \retval New struct agents_cfg object.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"> * \retval NULL on error.</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ad2b4b080213b6b09e799374f4529ecc2">  512</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#ad2b4b080213b6b09e799374f4529ecc2">agents_cfg_alloc</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4f/structagents__cfg.html">agents_cfg</a> *cfg;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   cfg = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*cfg), <a class="code" href="../../de/d11/app__agent__pool_8c.html#a3bc870eb2da8463a4fb53bf2fee5bdf4">agents_cfg_destructor</a>,</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keywordflow">if</span> (!cfg) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   cfg-&gt;<a class="code" href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>,</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520acadaba53a115685d6a8944dd2c6a8d7bfb">AO2_CONTAINER_ALLOC_OPT_DUPS_REJECT</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a81b479dda160b217188d44dffc86361f">agent_cfg_sort_cmp</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keywordflow">if</span> (!cfg-&gt;<a class="code" href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a>) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg, -1);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      cfg = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="keywordflow">return</span> cfg;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#acda8801e5f7029b4afec1a19ecae16b2">agents_post_apply_config</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<a class="code" href="../../de/d11/app__agent__pool_8c.html#a656be8c315c7512b34037d5445b1fc05">CONFIG_INFO_STANDARD</a>(cfg_info, <a class="code" href="../../d1/da4/res__corosync_8c.html#ace59e73cd525ae17e77397b0cc7f7302">cfg_handle</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad2b4b080213b6b09e799374f4529ecc2">agents_cfg_alloc</a>,</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   .files = <a class="code" href="../../db/dfe/config__options_8h.html#a60d2944aab4537720434ab9c90e12418">ACO_FILES</a>(&amp;agents_conf),</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   .post_apply_config = <a class="code" href="../../de/d11/app__agent__pool_8c.html#acda8801e5f7029b4afec1a19ecae16b2">agents_post_apply_config</a>,</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a542b526fd6c81c6193101dfbe970c2be">  537</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a542b526fd6c81c6193101dfbe970c2be">destroy_config</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#ace59e73cd525ae17e77397b0cc7f7302">cfg_handle</a>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a21b11339ca4d0b1167c956a9f816bd19">aco_info_destroy</a>(&amp;cfg_info);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;}</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aed5779f84d4ebb67745d801d3ebede43">  543</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#aed5779f84d4ebb67745d801d3ebede43">load_config</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;{</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#a3f40a7cffea07c21a21faaee64d24398">aco_info_init</a>(&amp;cfg_info)) {</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   }</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="comment">/* Agent options */</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;ackcall&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#ad2306ec3a17979bc94169e842e87391c">ack_call</a>));</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;acceptdtmf&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <span class="stringliteral">&quot;#&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#a7e4d44394d3f9e352012ab905cac069e">dtmf_accept</a>));</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;autologoff&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#aa068f603d067b1a7c92db68e5b27256b">auto_logoff</a>));</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;wrapuptime&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <span class="stringliteral">&quot;0&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">wrapup_time</a>));</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;musiconhold&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <span class="stringliteral">&quot;default&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#a6c0ebcc78965d8817651856e7914631d">moh</a>));</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;recordagentcalls&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <span class="stringliteral">&quot;no&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a>, 1, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#afa345a7167ae253354866a0e845058b2">record_agent_calls</a>));</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;custom_beep&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <span class="stringliteral">&quot;beep&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#af22047b6d8545b610cde6ad3e397fd79">beep_sound</a>));</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;fullname&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>, agent_types, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a>, <a class="code" href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">full_name</a>));</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a>(&amp;cfg_info, 0) == <a class="code" href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a>) {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7">  566</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7">agent_state</a> {<span class="comment"></span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">   /*! The agent is defined but an agent is not present. */</span></div><div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a3bc3f30b122882c42e989f6c5ca2aa86">  568</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a3bc3f30b122882c42e989f6c5ca2aa86">AGENT_STATE_LOGGED_OUT</a>,<span class="comment"></span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">   /*! Forced initial login wait to allow any local channel optimizations to happen. */</span></div><div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a805e16634a569c003ec65f9a063402b0">  570</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a805e16634a569c003ec65f9a063402b0">AGENT_STATE_PROBATION_WAIT</a>,<span class="comment"></span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">   /*! The agent is ready for a call. */</span></div><div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">  572</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a>,<span class="comment"></span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">   /*! The agent has a call waiting to connect. */</span></div><div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532">  574</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532">AGENT_STATE_CALL_PRESENT</a>,<span class="comment"></span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">   /*! The agent needs to ack the call. */</span></div><div class="line"><a name="l00576"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7">  576</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7">AGENT_STATE_CALL_WAIT_ACK</a>,<span class="comment"></span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">   /*! The agent is connected with a call. */</span></div><div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ace0d2b80786a272cbf12d2fadcf38f49">  578</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ace0d2b80786a272cbf12d2fadcf38f49">AGENT_STATE_ON_CALL</a>,<span class="comment"></span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">   /*! The agent is resting between calls. */</span></div><div class="line"><a name="l00580"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ae0e1c28605b6139c3b8fa403e8a42621">  580</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ae0e1c28605b6139c3b8fa403e8a42621">AGENT_STATE_CALL_WRAPUP</a>,<span class="comment"></span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">   /*! The agent is being kicked out. */</span></div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2">  582</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2">AGENT_STATE_LOGGING_OUT</a>,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;};</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/*! Agent config option override flags. */</span></div><div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8">  586</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8">agent_override_flags</a> {</div><div class="line"><a name="l00587"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a5da8eebe4a635b6bdaada84549b268cd">  587</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a5da8eebe4a635b6bdaada84549b268cd">AGENT_FLAG_ACK_CALL</a> = (1 &lt;&lt; 0),</div><div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8ab8673dd8048180035a6a4981b693bc93">  588</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8ab8673dd8048180035a6a4981b693bc93">AGENT_FLAG_DTMF_ACCEPT</a> = (1 &lt;&lt; 1),</div><div class="line"><a name="l00589"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a739a20e5cddf5896cdc77208b6f6b827">  589</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a739a20e5cddf5896cdc77208b6f6b827">AGENT_FLAG_AUTO_LOGOFF</a> = (1 &lt;&lt; 2),</div><div class="line"><a name="l00590"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8aa4a13f5b13607cff26538ad6e851a832">  590</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8aa4a13f5b13607cff26538ad6e851a832">AGENT_FLAG_WRAPUP_TIME</a> = (1 &lt;&lt; 3),</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;};</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">/*! \brief Structure representing an agent. */</span></div><div class="line"><a name="l00594"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html">  594</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a>(<span class="comment"></span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">      /*! Identification of the agent.  (agents container key) */</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>);<span class="comment"></span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">      /*! Login override DTMF string for an agent to accept a call. */</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(override_dtmf_accept);</div><div class="line"><a name="l00600"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">  600</a></span>&#160;   );<span class="comment"></span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">   /*! Connected line information to send when reentering the holding bridge. */</span></div><div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a1e4986d38981a6836446fd6e0947bfaa">  602</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> waiting_colp;<span class="comment"></span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">   /*! Flags show if settings were overridden by channel vars. */</span></div><div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#ac92588540e8c1d014a08cd8a45462b19">  604</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>;<span class="comment"></span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">   /*! Login override number of seconds for agent to ack a call before being logged off. */</span></div><div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a0db93def45062b0b68b3cfc92828056e">  606</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#a0db93def45062b0b68b3cfc92828056e">override_auto_logoff</a>;<span class="comment"></span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">   /*! Login override time after a call in ms before the agent can get a new call. */</span></div><div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#aafe46fa9fde27806c85eea0f7e012b98">  608</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#aafe46fa9fde27806c85eea0f7e012b98">override_wrapup_time</a>;<span class="comment"></span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">   /*! Login override if agent needs to ack a call to accept it. */</span></div><div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a9e221b3d2bfe1c52281667c3cb15195e">  610</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#a9e221b3d2bfe1c52281667c3cb15195e">override_ack_call</a>:1;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">   /*! TRUE if the agent is requested to logoff when the current call ends. */</span></div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#acc12f7a44f078cee9f52face3f7787f1">  613</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#acc12f7a44f078cee9f52face3f7787f1">deferred_logoff</a>:1;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">   /*! Mark and sweep config update to determine if an agent is dead. */</span></div><div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a3612e1393049830a205c9fb3857ce295">  616</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#a3612e1393049830a205c9fb3857ce295">the_mark</a>:1;<span class="comment"></span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">   /*!</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">    * \brief TRUE if the agent is no longer configured and is being destroyed.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">    * \note Agents cannot log in if they are dead.</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a1d67f434933f43ad9deb32da61dda2b6">  622</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>:1;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">   /*! Agent control state variable. */</span></div><div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">  625</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7">agent_state</a> <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;<span class="comment"></span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">   /*! Custom device state of agent. */</span></div><div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">  627</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eee">ast_device_state</a> devstate;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">   /*! When agent first logged in */</span></div><div class="line"><a name="l00630"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#acd6bb3b5d452161627e0c4b204977401">  630</a></span>&#160;   time_t <a class="code" href="../../dd/d4d/structagent__pvt.html#acd6bb3b5d452161627e0c4b204977401">login_start</a>;<span class="comment"></span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">   /*! When agent login probation started. */</span></div><div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a38c96ef0675bb4c5e4a4bbae53b341cb">  632</a></span>&#160;   time_t <a class="code" href="../../dd/d4d/structagent__pvt.html#a38c96ef0675bb4c5e4a4bbae53b341cb">probation_start</a>;<span class="comment"></span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">   /*! When call started */</span></div><div class="line"><a name="l00634"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#aa09f4acec5c1e337edce28217f8f685c">  634</a></span>&#160;   time_t <a class="code" href="../../dd/d4d/structagent__pvt.html#aa09f4acec5c1e337edce28217f8f685c">call_start</a>;<span class="comment"></span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">   /*! When ack timer started */</span></div><div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a5068662d1a4020ad70203c75f620c74d">  636</a></span>&#160;   <span class="keyword">struct </span>timeval ack_time;<span class="comment"></span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">   /*! When last disconnected */</span></div><div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a41ef42b3f54f9920060abbedc977fea9">  638</a></span>&#160;   <span class="keyword">struct </span>timeval last_disconnect;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">   /*! Caller is waiting in this bridge for agent to join. (Holds ref) */</span></div><div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">  641</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a>;<span class="comment"></span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">   /*! Agent is logged in with this channel. (Holds ref) (NULL if not logged in.) */</span></div><div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">  643</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>;<span class="comment"></span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">   /*! Active config values from config file. (Holds ref) */</span></div><div class="line"><a name="l00645"></a><span class="lineno"><a class="line" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">  645</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;};</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">/*! Container of defined agents. */</span></div><div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a02691f29ac4d0ddd46ef7ebd90c3958d">  649</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"> * \brief Lock the agent.</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"> * \param agent Agent to lock</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">  658</a></span>&#160;<span class="preprocessor">#define agent_lock(agent)  _agent_lock(agent, __FILE__, __PRETTY_FUNCTION__, __LINE__, #agent)</span></div><div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#abcc455cab3ad2f3eeda4797611d1c0ed">  659</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#abcc455cab3ad2f3eeda4797611d1c0ed">_agent_lock</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">function</span>, <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>)</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ae8abe54e1e1460641ed987db20e75e81">__ao2_lock</a>(agent, <a class="code" href="../../d5/da5/astobj2_8h.html#a4e9f309cb90824e22969f0cf1b5b445da1381af5f17622000f344130ef673987b">AO2_LOCK_REQ_MUTEX</a>, file, <span class="keyword">function</span>, line, var);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;}</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> * \brief Unlock the agent.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"> * \param agent Agent to unlock</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00671"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">  671</a></span>&#160;<span class="preprocessor">#define agent_unlock(agent)   _agent_unlock(agent, __FILE__, __PRETTY_FUNCTION__, __LINE__, #agent)</span></div><div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a221957559e467e3d6793e2eaf2c58352">  672</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a221957559e467e3d6793e2eaf2c58352">_agent_unlock</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">function</span>, <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;{</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ae77cde78a0e0ae3e75a2911857bfadc5">__ao2_unlock</a>(agent, file, <span class="keyword">function</span>, line, var);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment"> * \brief Obtain the agent logged in channel lock if it exists.</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"> * \param agent Pointer to the LOCKED agent_pvt.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"> * \note Assumes the agent lock is already obtained.</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment"> * \note Defined locking order is channel lock then agent lock.</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">  690</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;{</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordflow">if</span> (!agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) { <span class="comment">/* No owner. Nothing to do. */</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="comment">/* If we don&#39;t ref the logged, it could be killed when we unlock the agent. */</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      logged = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="comment">/* Locking logged requires us to lock channel, then agent. */</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(logged);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="comment">/* Check if logged changed during agent unlock period */</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordflow">if</span> (logged != agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;         <span class="comment">/* Channel changed. Unref and do another pass. */</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         <span class="comment">/* Channel stayed the same. Return it. */</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;         <span class="keywordflow">return</span> logged;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"> * \brief Get the Agent:agent_id device state.</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"> * \param agent_id Username of the agent.</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment"> * \details</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"> * Search the agents container for the agent and return the</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"> * current state.</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment"> * \return Device state of the agent.</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00732"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a3a5f74a4e24b8c032bd9698c1f2af510">  732</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eee">ast_device_state</a> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a3a5f74a4e24b8c032bd9698c1f2af510">agent_pvt_devstate_get</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *agent_id)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;{</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eee">ast_device_state</a> dev_state = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a>;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, agent_id, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="keywordflow">if</span> (agent) {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      dev_state = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a>;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   }</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="keywordflow">return</span> dev_state;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"> * \brief Request an agent device state be updated.</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"> * \param agent_id Which agent needs the device state updated.</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">  756</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *agent_id)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;{</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <a class="code" href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a>(<a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a">AST_DEVICE_UNKNOWN</a>, <a class="code" href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a>, <span class="stringliteral">&quot;Agent:%s&quot;</span>, agent_id);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a7c84929318242d3454e982dce5668aae">  761</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7c84929318242d3454e982dce5668aae">agent_pvt_destructor</a>(<span class="keywordtype">void</span> *vdoomed)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;{</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *doomed = vdoomed;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="comment">/* Make sure device state reflects agent destruction. */</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>)) {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Destroyed.\n&quot;</span>, doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1e4986d38981a6836446fd6e0947bfaa">waiting_colp</a>);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="keywordflow">if</span> (doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a>) {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a>, 0);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <span class="keywordflow">if</span> (doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a> = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;   }</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   doomed-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(doomed);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;}</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ab0c3d04727ae30c5deac61abe52b5fdd">  784</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#ab0c3d04727ae30c5deac61abe52b5fdd">agent_pvt_new</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>)</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;{</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*agent), <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7c84929318242d3454e982dce5668aae">agent_pvt_destructor</a>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;   }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(agent, 32)) {</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(agent, <a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>, cfg-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a>(&amp;agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1e4986d38981a6836446fd6e0947bfaa">waiting_colp</a>);</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg, +1);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a> = <a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a> = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <span class="keywordflow">return</span> agent;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;}</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment"> * \brief Agents ao2 container sort function.</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment"> * \param obj_left pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"> * \param obj_right pointer to the (user-defined part) of an object.</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment"> * \param flags flags from ao2_callback()</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"> *   OBJ_POINTER - if set, &#39;obj_right&#39;, is an object.</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"> *   OBJ_KEY - if set, &#39;obj_right&#39;, is a search key item that is not an object.</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"> *   OBJ_PARTIAL_KEY - if set, &#39;obj_right&#39;, is a partial search key item that is not an object.</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"> * \retval &lt;0 if obj_left &lt; obj_right</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"> * \retval =0 if obj_left == obj_right</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment"> * \retval &gt;0 if obj_left &gt; obj_right</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00820"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a32d9fcd6bfb0ed9371e6dbae8a994bda">  820</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a32d9fcd6bfb0ed9371e6dbae8a994bda">agent_pvt_sort_cmp</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *obj_left, <span class="keyword">const</span> <span class="keywordtype">void</span> *obj_right, <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>)</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;{</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent_left = obj_left;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent_right = obj_right;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *right_key = obj_right;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; (<a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>)) {</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>:</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      right_key = agent_right-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>:</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      cmp = strcmp(agent_left-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, right_key);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>:</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      cmp = strncmp(agent_left-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, right_key, strlen(right_key));</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;}</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"> * \brief ao2_find() callback function.</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"> * Usage:</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"> * found = ao2_find(agents, agent, OBJ_POINTER);</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"> * found = ao2_find(agents, &quot;agent-id&quot;, OBJ_KEY);</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"> * found = ao2_find(agents, agent-&gt;logged, 0);</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00852"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ad63565be83f2a9e10382f7adb483965c">  852</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad63565be83f2a9e10382f7adb483965c">agent_pvt_cmp</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>)</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;{</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = obj;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   <span class="keywordtype">int</span> cmp;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   <span class="keywordflow">switch</span> (flags &amp; (<a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>)) {</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a>:</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>:</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>:</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      cmp = <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a> == arg) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;         cmp = <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;         cmp = 0;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;   }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;}</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ad7efec5e491195982d97dbb426026cfc">  874</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad7efec5e491195982d97dbb426026cfc">agent_mark</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>)</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;{</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = obj;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a3612e1393049830a205c9fb3857ce295">the_mark</a> = 1;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;}</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ada8114db41c738d45b72e605ebd7ac7f">  884</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ada8114db41c738d45b72e605ebd7ac7f">agents_mark</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;{</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(agents, 0, <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad7efec5e491195982d97dbb426026cfc">agent_mark</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;}</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a46a46dbbf30cbb25031b5276fc7e3d98">  889</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a46a46dbbf30cbb25031b5276fc7e3d98">agent_sweep</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>)</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;{</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = obj;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <span class="keywordtype">int</span> cmp = 0;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;   <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a3612e1393049830a205c9fb3857ce295">the_mark</a>) {</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a3612e1393049830a205c9fb3857ce295">the_mark</a> = 0;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a> = 1;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="comment">/* Unlink dead agents immediately. */</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      cmp = <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;   }</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   <span class="keywordflow">return</span> cmp;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae1a2f2b62c60544be70fc0cff132bdcf">  905</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae1a2f2b62c60544be70fc0cff132bdcf">agents_sweep</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;{</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> *iter;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(agents, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a46a46dbbf30cbb25031b5276fc7e3d98">agent_sweep</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <span class="keywordflow">if</span> (!iter) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;   }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;   <span class="keywordflow">for</span> (; (agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(iter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1)) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;         logged = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;         logged = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">if</span> (!logged) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>,</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;         <span class="stringliteral">&quot;Forced logoff of agent %s(%s).  Agent no longer configured.\n&quot;</span>,</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(logged));</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ac2d6607253f7e8b272d4e845474eaa9b">ast_softhangup</a>(logged, <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2b3b711afc65059c4b51008c9fbc7aee">AST_SOFTHANGUP_EXPLICIT</a>);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(iter);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;}</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#acda8801e5f7029b4afec1a19ecae16b2">  935</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#acda8801e5f7029b4afec1a19ecae16b2">agents_post_apply_config</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;{</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *cfg;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4f/structagents__cfg.html">agents_cfg</a> *, cfgs, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#ace59e73cd525ae17e77397b0cc7f7302">cfg_handle</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cfgs != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ada8114db41c738d45b72e605ebd7ac7f">agents_mark</a>();</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(cfgs-&gt;agents, 0);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="keywordflow">for</span> (; (cfg = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg, -1)) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *, agent, <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, cfg-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">username</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keywordflow">if</span> (agent) {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;         <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;         agent-&gt;the_mark = 0;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;         <span class="keywordflow">if</span> (!agent-&gt;logged) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *cfg_old;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="comment">/* Replace the config of agents not logged in. */</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            cfg_old = agent-&gt;cfg;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg, +1);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            agent-&gt;cfg = cfg;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cfg_old);</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;         }</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;         <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      agent = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ab0c3d04727ae30c5deac61abe52b5fdd">agent_pvt_new</a>(cfg);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(agents, agent);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Created.\n&quot;</span>, agent-&gt;username);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(agent-&gt;username);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae1a2f2b62c60544be70fc0cff132bdcf">agents_sweep</a>();</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;}</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a90c12fe1cfd5f897d788df917f0af3af">  975</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a90c12fe1cfd5f897d788df917f0af3af">agent_logoff_request</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *agent_id, <span class="keywordtype">int</span> soft)</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;{</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *, agent, <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, agent_id, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   }</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a>(agent);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   <span class="keywordflow">if</span> (logged) {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">if</span> (soft) {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         agent-&gt;deferred_logoff = 1;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ac2d6607253f7e8b272d4e845474eaa9b">ast_softhangup</a>(logged, <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2b3b711afc65059c4b51008c9fbc7aee">AST_SOFTHANGUP_EXPLICIT</a>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   }</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">/*! Agent holding bridge instance holder. */</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="keyword">static</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a2b53789591de3558859d20a0800a9eda">AO2_GLOBAL_OBJ_STATIC</a>(agent_holding);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">/*! Agent holding bridge deferred creation lock. */</span></div><div class="line"><a name="l01003"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#adc4d1d983728ada524c84213c2536921"> 1003</a></span>&#160;<a class="code" href="../../dd/d42/lock_8h.html#ac840092853644cea0a186efdc58985f5">AST_MUTEX_DEFINE_STATIC</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#adc4d1d983728ada524c84213c2536921">agent_holding_lock</a>);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment"> * \brief Callback to clear AGENT_STATUS on the caller channel.</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment"> * \param bridge_channel Which channel to operate on.</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"> * \param payload Data to pass to the callback. (NULL if none).</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment"> * \param payload_size Size of the payload if payload is non-NULL.  A number otherwise.</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment"> * \note The payload MUST NOT have any resources that need to be freed.</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01017"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#afb0201bc573414e692523e87814100f9"> 1017</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#afb0201bc573414e692523e87814100f9">clear_agent_status</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">const</span> <span class="keywordtype">void</span> *payload, <span class="keywordtype">size_t</span> payload_size)</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;{</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment"> * \brief Connect the agent with the waiting caller.</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"> * \param bridge_channel Agent channel connecting to the caller.</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment"> * \param agent Which agent is connecting to the caller.</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment"> * \note The agent is locked on entry and not locked on exit.</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ad828f7da4ade54724a517f3e85f46130"> 1034</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad828f7da4ade54724a517f3e85f46130">agent_connect_caller</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;{</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *caller_bridge;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#afa345a7167ae253354866a0e845058b2">record_agent_calls</a>;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   record_agent_calls = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#afa345a7167ae253354866a0e845058b2">record_agent_calls</a>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   caller_bridge = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ace0d2b80786a272cbf12d2fadcf38f49">AGENT_STATE_ON_CALL</a>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   time(&amp;agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#aa09f4acec5c1e337edce28217f8f685c">call_start</a>);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;   <span class="keywordflow">if</span> (!caller_bridge) {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="comment">/* Reset agent. */</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>,</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   }</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   res = <a class="code" href="../../d4/d56/bridge_8h.html#af0e3d51ad653134a92545dec4610b83a">ast_bridge_move</a>(caller_bridge, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>, bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>,</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="comment">/* Reset agent. */</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>,</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;         <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;   }</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   res = <a class="code" href="../../de/d41/bridge__channel_8h.html#a9d7ca6b64c5bd875d4f16e8aef443497">ast_bridge_channel_write_control_data</a>(bridge_channel, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      || <a class="code" href="../../de/d41/bridge__channel_8h.html#ae014c66309327185b609d7e3ccf21af5">ast_bridge_channel_write_callback</a>(bridge_channel, 0, <a class="code" href="../../de/d11/app__agent__pool_8c.html#afb0201bc573414e692523e87814100f9">clear_agent_status</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="comment">/* Reset agent. */</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <span class="keywordflow">if</span> (record_agent_calls) {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/d41/structast__bridge__features__automixmonitor.html">ast_bridge_features_automixmonitor</a> options = {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;         .<a class="code" href="../../d7/d41/structast__bridge__features__automixmonitor.html#a2e911a04575a1931bc544696762088e5">start_stop</a> = <a class="code" href="../../dc/d7a/bridge__features_8h.html#ac5edca1f8aa8a5ea765cea146507a882a26916a61be33d13623f6fd1d8865d7ca">AUTO_MONITOR_START</a>,</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;         };</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">       * The agent is in the new bridge so we can invoke the</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">       * mixmonitor hook to only start recording.</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a5ad28c249794c7354336fc512fab8f7a">ast_bridge_features_do</a>(<a class="code" href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a9075785271a9e2a18bb65c99a6bd7744">AST_BRIDGE_BUILTIN_AUTOMIXMON</a>, bridge_channel, &amp;options);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   }</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(caller_bridge, -1, <span class="stringliteral">&quot;Agent successfully in caller_bridge&quot;</span>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;}</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#af5a8115993ab0d49f73d77a11718a869"> 1085</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#af5a8115993ab0d49f73d77a11718a869">bridge_agent_hold_ack</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keywordtype">void</span> *hook_pvt)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;{</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = hook_pvt;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   <span class="keywordflow">switch</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a>) {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7">AGENT_STATE_CALL_WAIT_ACK</a>:</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="comment">/* Connect to caller now. */</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Acked call.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad828f7da4ade54724a517f3e85f46130">agent_connect_caller</a>(bridge_channel, agent);<span class="comment">/* Will unlock agent. */</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   }</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a1578ec878aa2014f6550270ad1468f94"> 1103</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a1578ec878aa2014f6550270ad1468f94">bridge_agent_hold_heartbeat</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keywordtype">void</span> *hook_pvt)</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;{</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = hook_pvt;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;   <span class="keywordtype">int</span> probation_timedout = 0;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   <span class="keywordtype">int</span> ack_timedout = 0;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   <span class="keywordtype">int</span> wrapup_timedout = 0;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dd/d4d/structagent__pvt.html#acc12f7a44f078cee9f52face3f7787f1">deferred_logoff</a>;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">wrapup_time</a>;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#aa068f603d067b1a7c92db68e5b27256b">auto_logoff</a>;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;   deferred_logoff = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#acc12f7a44f078cee9f52face3f7787f1">deferred_logoff</a>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;   <span class="keywordflow">if</span> (deferred_logoff) {</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2">AGENT_STATE_LOGGING_OUT</a>;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;   <span class="keywordflow">switch</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a>) {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a805e16634a569c003ec65f9a063402b0">AGENT_STATE_PROBATION_WAIT</a>:</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      probation_timedout =</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         <a class="code" href="../../de/d11/app__agent__pool_8c.html#ab9353a3e165a7fd78b69b27e36d49e8b">LOGIN_WAIT_TIMEOUT_TIME</a> &lt;= (time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a38c96ef0675bb4c5e4a4bbae53b341cb">probation_start</a>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">if</span> (probation_timedout) {</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;         <span class="comment">/* Now ready for a caller. */</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a>;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a> = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7">AGENT_STATE_CALL_WAIT_ACK</a>:</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="comment">/* Check ack call time. */</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      auto_logoff = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#aa068f603d067b1a7c92db68e5b27256b">auto_logoff</a>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(agent, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a739a20e5cddf5896cdc77208b6f6b827">AGENT_FLAG_AUTO_LOGOFF</a>)) {</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;         auto_logoff = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a0db93def45062b0b68b3cfc92828056e">override_auto_logoff</a>;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordflow">if</span> (auto_logoff) {</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;         auto_logoff *= 1000;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;         ack_timedout = <a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5068662d1a4020ad70203c75f620c74d">ack_time</a>) &gt; <a class="code" href="../../d4/d01/structagent__cfg.html#aa068f603d067b1a7c92db68e5b27256b">auto_logoff</a>;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;         <span class="keywordflow">if</span> (ack_timedout) {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2">AGENT_STATE_LOGGING_OUT</a>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;         }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ae0e1c28605b6139c3b8fa403e8a42621">AGENT_STATE_CALL_WRAPUP</a>:</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="comment">/* Check wrapup time. */</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      wrapup_time = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">wrapup_time</a>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(agent, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8aa4a13f5b13607cff26538ad6e851a832">AGENT_FLAG_WRAPUP_TIME</a>)) {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;         wrapup_time = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#aafe46fa9fde27806c85eea0f7e012b98">override_wrapup_time</a>;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      wrapup_timedout = <a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a41ef42b3f54f9920060abbedc977fea9">last_disconnect</a>) &gt; <a class="code" href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">wrapup_time</a>;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keywordflow">if</span> (wrapup_timedout) {</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a> = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      }</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;   }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <span class="keywordflow">if</span> (deferred_logoff) {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Deferred logoff.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>,</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;         <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (probation_timedout) {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Login complete.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ack_timedout) {</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Ack call timeout.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>,</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;         <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wrapup_timedout) {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Wrapup timeout. Ready for new call.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;}</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a8f0089dcfc5a0c38a72eaa0aeb3014e0">agent_after_bridge_cb</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keywordtype">void</span> *data);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a99d2d56a1bc356d880b7dfa6921cf32f">agent_after_bridge_cb_failed</a>(<span class="keyword">enum</span> <a class="code" href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9c">ast_bridge_after_cb_reason</a> reason, <span class="keywordtype">void</span> *data);</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment"> * \brief ast_bridge agent_hold push method.</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment"> * \param bridge_channel Bridge channel to push.</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment"> * \param swap Bridge channel to swap places with if not NULL.</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment"> * \note On entry, self is already locked.</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment"> * \retval 0 on success</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment"> * \retval -1 on failure</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01196"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a61441e0cbefa5859ff1953c2248eeef3"> 1196</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a61441e0cbefa5859ff1953c2248eeef3">bridge_agent_hold_push</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *swap)</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;{</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">wrapup_time</a>;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;   <span class="keywordtype">char</span> dtmf[<a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html#a57cae4c5040ce0791d0b4798193fc47f">AST_FEATURE_MAX_LEN</a>];</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *moh_class;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *, agent, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;   chan = bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, swap ? swap-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> : chan, 0);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="comment">/* Could not find the agent. */</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;   }</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;   <span class="comment">/* Setup agent entertainment */</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;   moh_class = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(agent-&gt;cfg-&gt;moh);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   res |= <a class="code" href="../../dd/dff/bridge__roles_8h.html#a8511ad15a10f0b6269094ad307ba17a2">ast_channel_add_bridge_role</a>(chan, <span class="stringliteral">&quot;holding_participant&quot;</span>);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;   res |= <a class="code" href="../../dd/dff/bridge__roles_8h.html#a3c1bc5238aea4e2d19c9894c1b68a457">ast_channel_set_bridge_role_option</a>(chan, <span class="stringliteral">&quot;holding_participant&quot;</span>, <span class="stringliteral">&quot;idle_mode&quot;</span>, <span class="stringliteral">&quot;musiconhold&quot;</span>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   res |= <a class="code" href="../../dd/dff/bridge__roles_8h.html#a3c1bc5238aea4e2d19c9894c1b68a457">ast_channel_set_bridge_role_option</a>(chan, <span class="stringliteral">&quot;holding_participant&quot;</span>, <span class="stringliteral">&quot;moh_class&quot;</span>, moh_class);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   <span class="comment">/* Add DTMF acknowledge hook. */</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;   dtmf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(agent, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a5da8eebe4a635b6bdaada84549b268cd">AGENT_FLAG_ACK_CALL</a>)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      ? agent-&gt;override_ack_call : agent-&gt;cfg-&gt;ack_call) {</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d01/structagent__cfg.html#a7e4d44394d3f9e352012ab905cac069e">dtmf_accept</a>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      dtmf_accept = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(agent, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8ab8673dd8048180035a6a4981b693bc93">AGENT_FLAG_DTMF_ACCEPT</a>)</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;         ? agent-&gt;override_dtmf_accept : agent-&gt;cfg-&gt;dtmf_accept;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(dtmf, dtmf_accept, <span class="keyword">sizeof</span>(dtmf));</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   }</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dtmf)) {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, +1);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a48ebc85ae4e4a203014711dc3a492ac5">ast_bridge_dtmf_hook</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>, dtmf, <a class="code" href="../../de/d11/app__agent__pool_8c.html#af5a8115993ab0d49f73d77a11718a869">bridge_agent_hold_ack</a>,</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;         agent, <a class="code" href="../../d5/da5/astobj2_8h.html#ab940ba7749a2a12c3e9a356bd26fd744">__ao2_cleanup</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a>)) {</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;         res = -1;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   <span class="comment">/* Add heartbeat interval hook. */</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, +1);</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a3e9bdb7b62b531f001b7dcb5c39b3551">ast_bridge_interval_hook</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">features</a>, 0, 1000,</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#a1578ec878aa2014f6550270ad1468f94">bridge_agent_hold_heartbeat</a>, agent, <a class="code" href="../../d5/da5/astobj2_8h.html#ab940ba7749a2a12c3e9a356bd26fd744">__ao2_cleanup</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a>)) {</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      res = -1;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;   }</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;   res |= <a class="code" href="../../d4/d56/bridge_8h.html#a5a2fef16c6520d265d7f81002eb96ee7">ast_bridge_base_v_table</a>.<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a60b76bf280f288b3ef3f1facf873b104">push</a>(<span class="keyword">self</span>, bridge_channel, swap);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <a class="code" href="../../dd/dff/bridge__roles_8h.html#a7dce43ab7e058fda7576097ab7068ae2">ast_channel_remove_bridge_role</a>(chan, <span class="stringliteral">&quot;holding_participant&quot;</span>);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   }</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   <span class="keywordflow">if</span> (swap) {</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      res = <a class="code" href="../../d8/d85/bridge__after_8h.html#a866e05c6b083030e9757cfb37814e671">ast_bridge_set_after_callback</a>(chan, agent_after_bridge_cb,</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         agent_after_bridge_cb_failed, chan);</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;         <a class="code" href="../../dd/dff/bridge__roles_8h.html#a7dce43ab7e058fda7576097ab7068ae2">ast_channel_remove_bridge_role</a>(chan, <span class="stringliteral">&quot;holding_participant&quot;</span>);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(agent-&gt;logged);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      agent-&gt;logged = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(chan);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">       * Kick the channel out so it can come back in fully controlled.</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">       * Otherwise, the after bridge callback will linger and the</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">       * agent will have some slightly different behavior in corner</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">       * cases.</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>,</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;         <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   }</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   <span class="keywordflow">switch</span> (agent-&gt;state) {</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a3bc3f30b122882c42e989f6c5ca2aa86">AGENT_STATE_LOGGED_OUT</a>:<span class="comment"></span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">      /*!</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">       * \todo XXX the login probation time should be only if it is needed.</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">       * Need to determine if there are any local channels that can</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">       * optimize and wait until they actually do before leaving the</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">       * AGENT_STATE_PROBATION_WAIT state.  For now, the blind</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">       * timer of LOGIN_WAIT_TIMEOUT_TIME will do.</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">       * Start the login probation timer.</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">       * We cannot handle an agent local channel optimization when the</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">       * agent is on a call.  The optimization may kick the agent</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">       * channel we know about out of the call without our being able</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">       * to switch to the replacement channel.  Get any agent local</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">       * channel optimization out of the way while the agent is in the</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">       * holding bridge.</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      time(&amp;agent-&gt;probation_start);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      agent-&gt;state = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a805e16634a569c003ec65f9a063402b0">AGENT_STATE_PROBATION_WAIT</a>;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a805e16634a569c003ec65f9a063402b0">AGENT_STATE_PROBATION_WAIT</a>:</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="comment">/* Restart the probation timer. */</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      time(&amp;agent-&gt;probation_start);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a>:</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">       * Likely someone manually kicked us out of the holding bridge</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">       * and we came right back in.</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="comment">/* Unexpected agent state. */</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532">AGENT_STATE_CALL_PRESENT</a>:</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7">AGENT_STATE_CALL_WAIT_ACK</a>:</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      agent-&gt;state = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      agent-&gt;devstate = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Call abort recovery complete.\n&quot;</span>, agent-&gt;username);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(agent-&gt;username);</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ace0d2b80786a272cbf12d2fadcf38f49">AGENT_STATE_ON_CALL</a>:</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ae0e1c28605b6139c3b8fa403e8a42621">AGENT_STATE_CALL_WRAPUP</a>:</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      wrapup_time = agent-&gt;cfg-&gt;wrapup_time;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(agent, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8aa4a13f5b13607cff26538ad6e851a832">AGENT_FLAG_WRAPUP_TIME</a>)) {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;         wrapup_time = agent-&gt;override_wrapup_time;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      }</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordflow">if</span> (wrapup_time) {</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;         agent-&gt;state = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ae0e1c28605b6139c3b8fa403e8a42621">AGENT_STATE_CALL_WRAPUP</a>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;         agent-&gt;state = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a>;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;         agent-&gt;devstate = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      }</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">if</span> (!wrapup_time) {</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;         <span class="comment">/* No wrapup time. */</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Ready for new call.\n&quot;</span>, agent-&gt;username);</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;         <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(agent-&gt;username);</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;   }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;}</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment"> * \brief ast_bridge agent_hold pull method.</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment"> * \param bridge_channel Bridge channel to pull.</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment"> * \details</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment"> * Remove any channel hooks controlled by the bridge.  Release</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment"> * any resources held by bridge_channel-&gt;bridge_pvt and release</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment"> * bridge_channel-&gt;bridge_pvt.</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment"> * \note On entry, self is already locked.</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01369"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae637f8fbe936d377d08099c192d5414f"> 1369</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae637f8fbe936d377d08099c192d5414f">bridge_agent_hold_pull</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;{</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   <a class="code" href="../../dd/dff/bridge__roles_8h.html#a7dce43ab7e058fda7576097ab7068ae2">ast_channel_remove_bridge_role</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;holding_participant&quot;</span>);</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a5a2fef16c6520d265d7f81002eb96ee7">ast_bridge_base_v_table</a>.<a class="code" href="../../d2/dd3/structast__bridge__methods.html#adcfc7ef2b1ee5305158a584970ddea65">pull</a>(<span class="keyword">self</span>, bridge_channel);</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;}</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment"> * \brief The bridge is being dissolved.</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment"> * \param self Bridge to operate upon.</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment"> * \details</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment"> * The bridge is being dissolved.  Remove any external</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment"> * references to the bridge so it can be destroyed.</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment"> * \note On entry, self must NOT be locked.</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01388"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ab30350ac6df6da6e60c63534b3f2e6f2"> 1388</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ab30350ac6df6da6e60c63534b3f2e6f2">bridge_agent_hold_dissolving</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<span class="keyword">self</span>)</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;{</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a>(agent_holding);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a5a2fef16c6520d265d7f81002eb96ee7">ast_bridge_base_v_table</a>.<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a5b1a8e69c6546121e0b4dcec16be3373">dissolving</a>(<span class="keyword">self</span>);</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;}</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6"> 1394</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d2/dd3/structast__bridge__methods.html">ast_bridge_methods</a> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a>;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01396"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a6ac128d97cc9176ba058342d94b90afb"> 1396</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a6ac128d97cc9176ba058342d94b90afb">bridge_agent_hold_new</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;{</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;   bridge = <a class="code" href="../../d5/dde/bridge__internal_8h.html#adf0e64783980f762008ac238f2dbe715">bridge_alloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a>), &amp;<a class="code" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a>);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;   bridge = <a class="code" href="../../d5/dde/bridge__internal_8h.html#a38c501242153bbe13d0eda31220637b8">bridge_base_init</a>(bridge, <a class="code" href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaff2606e446a3b7e22fb3785a06110554">AST_BRIDGE_CAPABILITY_HOLDING</a>,</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;         | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a> | <a class="code" href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a7a4b299b4cb4bf7c644235d708847fc3">AST_BRIDGE_FLAG_TRANSFER_PROHIBITED</a>,</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <span class="stringliteral">&quot;AgentPool&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;   bridge = <a class="code" href="../../d5/dde/bridge__internal_8h.html#a8690315fd0d12e16671f9d22eacfa8f0">bridge_register</a>(bridge);</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;   <span class="keywordflow">return</span> bridge;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;}</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a7f905c96aa9c5adc8d4e297e3cf89f61"> 1409</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7f905c96aa9c5adc8d4e297e3cf89f61">bridge_init_agent_hold</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;{</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;   <span class="comment">/* Setup bridge agent_hold subclass v_table. */</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a> = <a class="code" href="../../d4/d56/bridge_8h.html#a5a2fef16c6520d265d7f81002eb96ee7">ast_bridge_base_v_table</a>;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a>.<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <span class="stringliteral">&quot;agent_hold&quot;</span>;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a>.<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a5b1a8e69c6546121e0b4dcec16be3373">dissolving</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ab30350ac6df6da6e60c63534b3f2e6f2">bridge_agent_hold_dissolving</a>;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a>.<a class="code" href="../../d2/dd3/structast__bridge__methods.html#a60b76bf280f288b3ef3f1facf873b104">push</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a61441e0cbefa5859ff1953c2248eeef3">bridge_agent_hold_push</a>;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a>.<a class="code" href="../../d2/dd3/structast__bridge__methods.html#adcfc7ef2b1ee5305158a584970ddea65">pull</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae637f8fbe936d377d08099c192d5414f">bridge_agent_hold_pull</a>;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;}</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div><div class="line"><a name="l01419"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a6c861b7f9ac3693f06669b575dc6e16b"> 1419</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6c861b7f9ac3693f06669b575dc6e16b">bridge_agent_hold_deferred_create</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;{</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *, holding, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(agent_holding), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;   <span class="keywordflow">if</span> (!holding) {</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;<a class="code" href="../../de/d11/app__agent__pool_8c.html#adc4d1d983728ada524c84213c2536921">agent_holding_lock</a>);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      holding = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(agent_holding);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keywordflow">if</span> (!holding) {</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;         holding = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6ac128d97cc9176ba058342d94b90afb">bridge_agent_hold_new</a>();</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a>(agent_holding, holding);</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      }</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;<a class="code" href="../../de/d11/app__agent__pool_8c.html#adc4d1d983728ada524c84213c2536921">agent_holding_lock</a>);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordflow">if</span> (!holding) {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Could not create agent holding bridge.\n&quot;</span>);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;   }</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;}</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a6f0c90a579585c460312c6c4d2caf216"> 1439</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6f0c90a579585c460312c6c4d2caf216">send_agent_login</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *agent)</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;{</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(agent != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s}&quot;</span>,</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      <span class="stringliteral">&quot;agent&quot;</span>, agent);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;   <span class="keywordflow">if</span> (!blob) {</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   }</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf03b8daa7784a26648db90614add6caa">ast_channel_publish_blob</a>(chan, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga03332d35946786d0689462e58d01467a">ast_channel_agent_login_type</a>(), blob);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a7c8999dd893779d9c04cbf4a70e9e2a1"> 1454</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7c8999dd893779d9c04cbf4a70e9e2a1">send_agent_logoff</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *agent, <span class="keywordtype">long</span> logintime)</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;{</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(agent != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: I}&quot;</span>,</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="stringliteral">&quot;agent&quot;</span>, agent,</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="stringliteral">&quot;logintime&quot;</span>, (<a class="code" href="../../d4/d05/json_8h.html#ae2cc29409ec389e8feaf38ec3a585d83">ast_json_int_t</a>)logintime);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;   <span class="keywordflow">if</span> (!blob) {</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;   }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf03b8daa7784a26648db90614add6caa">ast_channel_publish_blob</a>(chan, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga55d6d1e96f8f003200274d8756a9398a">ast_channel_agent_logoff_type</a>(), blob);</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;}</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="comment"> * \brief Logout the agent.</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment"> * \param agent Which agent logging out.</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment"> * \note On entry agent is already locked.  On exit it is no longer locked.</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01481"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aeaea7aa68d00de5f86fcc523d6f2c55a"> 1481</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#aeaea7aa68d00de5f86fcc523d6f2c55a">agent_logout</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent)</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;{</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *caller_bridge;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;   <span class="keywordtype">long</span> time_logged_in;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   time_logged_in = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#acd6bb3b5d452161627e0c4b204977401">login_start</a>;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;   logged = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   caller_bridge = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a>;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a3bc3f30b122882c42e989f6c5ca2aa86">AGENT_STATE_LOGGED_OUT</a>;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a> = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a>;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a7b260320610a09017a9416398acd0a70">ast_clear_flag</a>(agent, <a class="code" href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a>);</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;   <span class="keywordflow">if</span> (caller_bridge) {</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;   }</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(logged);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7c8999dd893779d9c04cbf4a70e9e2a1">send_agent_logoff</a>(logged, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, time_logged_in);</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Agent &#39;%s&#39; logged out.  Logged in for %ld seconds.\n&quot;</span>,</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, time_logged_in);</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;}</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment"> * \brief Agent driver loop.</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment"> * \param agent Which agent.</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment"> * \param logged The logged in channel.</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01520"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a8e005c499b7e949c3f1a290e88acb71d"> 1520</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a8e005c499b7e949c3f1a290e88acb71d">agent_run</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged)</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;{</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> features;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a3128b52009fb3dd764dce90ea377fce1">ast_bridge_features_init</a>(&amp;features)) {</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(logged, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <span class="keywordflow">goto</span> agent_run_cleanup;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;   }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/d4f/structagents__cfg.html">agents_cfg</a> *cfgs;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *cfg_new;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d01/structagent__cfg.html">agent_cfg</a> *cfg_old;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *holding;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *caller_bridge;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(logged, <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      holding = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(agent_holding);</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="keywordflow">if</span> (!holding) {</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Someone destroyed the agent holding bridge.\n&quot;</span>,</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      }</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">       * When the agent channel leaves the bridging system we usually</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">       * want to put the agent back into the holding bridge for the</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">       * next caller.</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a116a27b8e1e111729ee1828d4fab6b5a">ast_bridge_join</a>(holding, logged, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;features, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93a9106169928c6eeccad5b5ebcf762ac9d">AST_BRIDGE_JOIN_PASS_REFERENCE</a>);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordflow">if</span> (logged != agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) {</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;         <span class="comment">/* This channel is no longer the logged in agent. */</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      }</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1d67f434933f43ad9deb32da61dda2b6">dead</a>) {</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;         <span class="comment">/* The agent is no longer configured. */</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      }</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="comment">/* Update the agent&#39;s config before rejoining the holding bridge. */</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      cfgs = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#ace59e73cd525ae17e77397b0cc7f7302">cfg_handle</a>);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <span class="keywordflow">if</span> (!cfgs) {</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;         <span class="comment">/* There is no agent configuration.  All agents were destroyed. */</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      }</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;      cfg_new = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(cfgs-&gt;<a class="code" href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfgs, -1);</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <span class="keywordflow">if</span> (!cfg_new) {</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;         <span class="comment">/* The agent is no longer configured. */</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      }</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      cfg_old = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a> = cfg_new;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a41ef42b3f54f9920060abbedc977fea9">last_disconnect</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      <span class="comment">/* Clear out any caller bridge before rejoining the holding bridge. */</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      caller_bridge = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a>;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg_old, -1);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordflow">if</span> (caller_bridge) {</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      }</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> == <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2">AGENT_STATE_LOGGING_OUT</a></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;         || agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#acc12f7a44f078cee9f52face3f7787f1">deferred_logoff</a></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;         || <a class="code" href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a>(logged)) {</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;         <span class="comment">/* The agent was requested to logout or hungup. */</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      }</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">       * It is safe to access agent-&gt;waiting_colp without a lock.  It</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">       * is only setup on agent login and not changed.</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7ee3ff7bf7773329e9e20143f0ba2f69">ast_channel_update_connected_line</a>(logged, &amp;agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1e4986d38981a6836446fd6e0947bfaa">waiting_colp</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   }</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;features);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;agent_run_cleanup:</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;   <span class="keywordflow">if</span> (logged != agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) {</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment">       * We are no longer the agent channel because of local channel</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">       * optimization.</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Channel %s is no longer the agent.\n&quot;</span>,</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(logged));</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;   }</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aeaea7aa68d00de5f86fcc523d6f2c55a">agent_logout</a>(agent);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;}</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div><div class="line"><a name="l01618"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a8f0089dcfc5a0c38a72eaa0aeb3014e0"> 1618</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a8f0089dcfc5a0c38a72eaa0aeb3014e0">agent_after_bridge_cb</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keywordtype">void</span> *data)</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;{</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, chan, 0);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;   }</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: New agent channel %s.\n&quot;</span>,</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a8e005c499b7e949c3f1a290e88acb71d">agent_run</a>(agent, chan);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;}</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div><div class="line"><a name="l01633"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a99d2d56a1bc356d880b7dfa6921cf32f"> 1633</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a99d2d56a1bc356d880b7dfa6921cf32f">agent_after_bridge_cb_failed</a>(<span class="keyword">enum</span> <a class="code" href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9c">ast_bridge_after_cb_reason</a> reason, <span class="keywordtype">void</span> *data)</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;{</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = <a class="code" href="../../df/d3c/structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">data</a>;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, chan, 0);</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;   }</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Agent %s: Forced logout.  Lost control of %s because: %s\n&quot;</span>,</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan),</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <a class="code" href="../../d8/d85/bridge__after_8h.html#a1ccac2dce2e8c4f62baed1f63b225a15">ast_bridge_after_cb_reason_string</a>(reason));</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aeaea7aa68d00de5f86fcc523d6f2c55a">agent_logout</a>(agent);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;}</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment"> * \brief Get the lock on the agent bridge_channel and return it.</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment"> * \param agent Whose bridge_channel to get.</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment"> * \retval bridge_channel on success (Reffed and locked).</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment"> * \retval NULL on error.</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01660"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a5733bc2f13f35fe0d8bde13939b50e07"> 1660</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a5733bc2f13f35fe0d8bde13939b50e07">agent_bridge_channel_get_lock</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent)</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;{</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *<a class="code" href="../../d8/d34/gsm__explode_8c.html#a4e819f902d7ae632dd5ae75b29372f1b">bc</a>;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      logged = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;      <span class="keywordflow">if</span> (!logged) {</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;         <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(logged);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(logged);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      bc = <a class="code" href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a>(logged);</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="keywordflow">if</span> (!bc) {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;         <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a> != logged) {</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;         }</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      }</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#aa467e25606c2a21df25c61f139007782">ast_bridge_channel_lock</a>(bc);</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <span class="keywordflow">if</span> (bc-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a> != logged || agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a> != logged) {</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;         <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(bc);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bc, -1);</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      }</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d34/gsm__explode_8c.html#a4e819f902d7ae632dd5ae75b29372f1b">bc</a>;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;   }</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;}</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01696"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2"> 1696</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2">caller_abort_agent</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent)</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;{</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *logged;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;   logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5733bc2f13f35fe0d8bde13939b50e07">agent_bridge_channel_get_lock</a>(agent);</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;   <span class="keywordflow">if</span> (!logged) {</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *caller_bridge;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent &#39;%s&#39; no longer logged in.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      caller_bridge = agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a>;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">caller_bridge</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="keywordflow">if</span> (caller_bridge) {</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;         <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;   <span class="comment">/* Kick the agent out of the holding bridge to reset it. */</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#ab37a1835212d045dcfe7ef7f25eb5e31">ast_bridge_channel_leave_bridge_nolock</a>(logged, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>,</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <a class="code" href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a>);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(logged);</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;}</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aaa635926514981b733c8cc5afaf0def9"> 1722</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#aaa635926514981b733c8cc5afaf0def9">caller_safety_timeout</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keywordtype">void</span> *hook_pvt)</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;{</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = hook_pvt;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> == <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532">AGENT_STATE_CALL_PRESENT</a>) {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Agent &#39;%s&#39; process did not respond.  Safety timeout.\n&quot;</span>,</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;ERROR&quot;</span>);</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>, 0);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2">caller_abort_agent</a>(agent);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;   }</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;}</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a951f3727bbc983c0b9a20bac17650c44"> 1738</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a951f3727bbc983c0b9a20bac17650c44">agent_alert</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">const</span> <span class="keywordtype">void</span> *payload, <span class="keywordtype">size_t</span> payload_size)</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;{</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *agent_id = payload;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *playfile;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d01/structagent__cfg.html#a7e4d44394d3f9e352012ab905cac069e">dtmf_accept</a>;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;   <span class="keywordtype">char</span> dtmf[2];</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, agent_id, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent &#39;%s&#39; does not exist.  Where did it go?\n&quot;</span>, agent_id);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;   }</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   <span class="comment">/* Change holding bridge participant role&#39;s idle mode to silence */</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a7d01ff5caf025a97796d2dbb78f5f02c">ast_bridge_channel_lock_bridge</a>(bridge_channel);</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;   <a class="code" href="../../dd/dff/bridge__roles_8h.html#af01f5cb3712ef0b120433da770f645ab">ast_bridge_channel_clear_roles</a>(bridge_channel);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;   <a class="code" href="../../dd/dff/bridge__roles_8h.html#a3c1bc5238aea4e2d19c9894c1b68a457">ast_channel_set_bridge_role_option</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;holding_participant&quot;</span>, <span class="stringliteral">&quot;idle_mode&quot;</span>, <span class="stringliteral">&quot;silence&quot;</span>);</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;   <a class="code" href="../../dd/dff/bridge__roles_8h.html#ad449a795348a52aefe000f13a1d015f8">ast_bridge_channel_establish_roles</a>(bridge_channel);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;   <a class="code" href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">bridge</a>);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;   playfile = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#af22047b6d8545b610cde6ad3e397fd79">beep_sound</a>);</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;   <span class="comment">/* Determine which DTMF digits interrupt the alerting signal. */</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(agent, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a5da8eebe4a635b6bdaada84549b268cd">AGENT_FLAG_ACK_CALL</a>)</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      ? agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a9e221b3d2bfe1c52281667c3cb15195e">override_ack_call</a> : agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#ad2306ec3a17979bc94169e842e87391c">ack_call</a>) {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      dtmf_accept = <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(agent, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8ab8673dd8048180035a6a4981b693bc93">AGENT_FLAG_DTMF_ACCEPT</a>)</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;         ? agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a255ab96bed8587b3757a2143ed9fa03e">override_dtmf_accept</a> : agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a7e4d44394d3f9e352012ab905cac069e">dtmf_accept</a>;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      <span class="comment">/* Only the first digit of the ack will stop playback. */</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      dtmf[0] = *<a class="code" href="../../d4/d01/structagent__cfg.html#a7e4d44394d3f9e352012ab905cac069e">dtmf_accept</a>;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      dtmf[1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      dtmf_accept = dtmf;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      dtmf_accept = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   }</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;   <span class="comment">/* Alert the agent. */</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;   digit = <a class="code" href="../../d2/d4d/file_8h.html#a95b94a020720147325a486e210b36775">ast_stream_and_wait</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, playfile,</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dtmf_accept) ? <a class="code" href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a> : dtmf_accept);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;   <a class="code" href="../../d2/d4d/file_8h.html#a3092bf11d4bba66f646562759608b1bc">ast_stopstream</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;   <span class="keywordflow">switch</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a>) {</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532">AGENT_STATE_CALL_PRESENT</a>:</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dtmf_accept)) {</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">state</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7">AGENT_STATE_CALL_WAIT_ACK</a>;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;         agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5068662d1a4020ad70203c75f620c74d">ack_time</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;         <span class="keywordflow">if</span> (0 &lt; digit) {</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="comment">/* Playback was interrupted by a digit. */</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            <a class="code" href="../../de/d41/bridge__channel_8h.html#a69864377e8f1cf05ba95f1645bc98c65">ast_bridge_channel_feature_digit</a>(bridge_channel, digit);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;         }</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      }</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <span class="comment">/* Connect to caller now. */</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Agent %s: Immediately connecting to call.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad828f7da4ade54724a517f3e85f46130">agent_connect_caller</a>(bridge_channel, agent);<span class="comment">/* Will unlock agent. */</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;   }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;}</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div><div class="line"><a name="l01812"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a7a5ef1db5b0d29922a128c9422069729"> 1812</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7a5ef1db5b0d29922a128c9422069729">send_alert_to_agent</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">const</span> <span class="keywordtype">char</span> *agent_id)</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;{</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d41/bridge__channel_8h.html#ad7de2a71d5af8f85035713f1f3cb69a9">ast_bridge_channel_queue_callback</a>(bridge_channel,</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#a411218cf4d743baa73c2def8f024cb23a7d9b9e7c20920a163afd3009c21a0e77">AST_BRIDGE_CHANNEL_CB_OPTION_MEDIA</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a951f3727bbc983c0b9a20bac17650c44">agent_alert</a>, agent_id, strlen(agent_id) + 1);</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;}</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div><div class="line"><a name="l01818"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a32da61f3d1a1faa6ae5211f81eb52341"> 1818</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a32da61f3d1a1faa6ae5211f81eb52341">send_colp_to_agent</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keyword">struct</span> <a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a414b69d7583bb4cfc6daf5276aac6d14">connected</a>)</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;{</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/dc9/structast__set__party__connected__line.html">ast_set_party_connected_line</a> update = {</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;      .<a class="code" href="../../d4/dc9/structast__set__party__connected__line.html#aa7845dae2adff27b0da13c58b16ca805">id</a>.<a class="code" href="../../df/dcf/structast__set__party__id.html#abbd32f02dc419af56bdf709336f6c33e">name</a> = 1,</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;      .id.number = 1,</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      .id.subaddress = 1,</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;   };</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> data[1024];  <span class="comment">/* This should be large enough */</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;   <span class="keywordtype">size_t</span> datalen;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;   datalen = <a class="code" href="../../d5/d7b/channel_8h.html#ab380c81e4514ab48ca8402f7950a354a">ast_connected_line_build_data</a>(data, <span class="keyword">sizeof</span>(data), connected, &amp;update);</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;   <span class="keywordflow">if</span> (datalen == (<span class="keywordtype">size_t</span>) -1) {</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;   }</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d41/bridge__channel_8h.html#abc0302bab9fb2f318db695fe1f9047d8">ast_bridge_channel_queue_control_data</a>(bridge_channel,</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a>, data, datalen);</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;}</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment"> * \brief Caller joined the bridge event callback.</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;<span class="comment"> * \param bridge_channel Channel executing the feature</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;<span class="comment"> * \param hook_pvt Private data passed in when the hook was created</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment"> * \retval 0 Keep the callback hook.</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment"> * \retval -1 Remove the callback hook.</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01847"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a33214b7c3d67d8ea8652269fc5afb0d0"> 1847</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a33214b7c3d67d8ea8652269fc5afb0d0">caller_joined_bridge</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *bridge_channel, <span class="keywordtype">void</span> *hook_pvt)</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;{</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = hook_pvt;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *logged;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;   logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5733bc2f13f35fe0d8bde13939b50e07">agent_bridge_channel_get_lock</a>(agent);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;   <span class="keywordflow">if</span> (!logged) {</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39; not logged in.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;NOT_LOGGED_IN&quot;</span>);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>, 0);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2">caller_abort_agent</a>(agent);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   }</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;   res = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7a5ef1db5b0d29922a128c9422069729">send_alert_to_agent</a>(logged, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(logged);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(logged, -1);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39;: Failed to alert the agent.\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;ERROR&quot;</span>);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <a class="code" href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a>(bridge_channel, <a class="code" href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a>, 0);</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2">caller_abort_agent</a>(agent);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;   }</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;NOT_CONNECTED&quot;</span>);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a>(bridge_channel-&gt;<a class="code" href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">chan</a>, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a>);</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;}</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="comment"> * \brief Dialplan AgentRequest application to locate an agent to talk with.</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="comment"> * \param chan Channel wanting to talk with an agent.</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="comment"> * \param data Application parameters</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="comment"> * \retval 0 To continue in dialplan.</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="comment"> * \retval -1 To hangup.</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01889"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a392237b28b1ee658981b450fcf3fe363"> 1889</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a392237b28b1ee658981b450fcf3fe363">agent_request_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;{</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *caller_bridge;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a> *logged;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a> caller_features;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> connected;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(agent_id);</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(other);     <span class="comment">/* Any remaining unused arguments */</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;   );</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *, agent, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d11/app__agent__pool_8c.html#a6c861b7f9ac3693f06669b575dc6e16b">bridge_agent_hold_deferred_create</a>()) {</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;   }</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent_id)) {</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;AgentRequest requires an AgentId\n&quot;</span>);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;   }</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;   <span class="comment">/* Find the agent. */</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent_id, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39; does not exist.\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent_id);</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;INVALID&quot;</span>);</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;   }</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a3128b52009fb3dd764dce90ea377fce1">ast_bridge_features_init</a>(&amp;caller_features)) {</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;   }</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;   <span class="comment">/* Add safety timeout hook. */</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, +1);</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a3e9bdb7b62b531f001b7dcb5c39b3551">ast_bridge_interval_hook</a>(&amp;caller_features, 0, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a1d78ba0e31a3a17b37273be121850718">CALLER_SAFETY_TIMEOUT_TIME</a>,</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aaa635926514981b733c8cc5afaf0def9">caller_safety_timeout</a>, agent, <a class="code" href="../../d5/da5/astobj2_8h.html#ab940ba7749a2a12c3e9a356bd26fd744">__ao2_cleanup</a>, <a class="code" href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a>)) {</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;caller_features);</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;   }</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;   <span class="comment">/* Setup the alert agent on caller joining the bridge hook. */</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, +1);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d7a/bridge__features_8h.html#a5ef8af740b139874195a394ba4abee3d">ast_bridge_join_hook</a>(&amp;caller_features, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a33214b7c3d67d8ea8652269fc5afb0d0">caller_joined_bridge</a>, agent,</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ab940ba7749a2a12c3e9a356bd26fd744">__ao2_cleanup</a>, 0)) {</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;caller_features);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;   caller_bridge = <a class="code" href="../../d4/d1e/bridge__basic_8h.html#a1410fb71fa67f9ee92f15b18439b7571">ast_bridge_basic_new</a>();</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;   <span class="keywordflow">if</span> (!caller_bridge) {</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;caller_features);</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;   }</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;   <span class="keywordflow">switch</span> (agent-&gt;state) {</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a3bc3f30b122882c42e989f6c5ca2aa86">AGENT_STATE_LOGGED_OUT</a>:</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2">AGENT_STATE_LOGGING_OUT</a>:</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;caller_features);</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39; not logged in.\n&quot;</span>, agent-&gt;username);</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;NOT_LOGGED_IN&quot;</span>);</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a>:</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caller_bridge, +1);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      agent-&gt;caller_bridge = caller_bridge;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      agent-&gt;state = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532">AGENT_STATE_CALL_PRESENT</a>;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      agent-&gt;devstate = <a class="code" href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a>;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;caller_features);</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39; is busy.\n&quot;</span>, agent-&gt;username);</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;BUSY&quot;</span>);</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;   }</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a>(agent-&gt;username);</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   <span class="comment">/* Get COLP for agent. */</span></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a>(&amp;connected);</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a>(&amp;connected, <a class="code" href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a>(chan));</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;   logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a5733bc2f13f35fe0d8bde13939b50e07">agent_bridge_channel_get_lock</a>(agent);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   <span class="keywordflow">if</span> (!logged) {</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;connected);</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2">caller_abort_agent</a>(agent);</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(caller_bridge, 0);</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;caller_features);</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39; not logged in.\n&quot;</span>, agent-&gt;username);</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;NOT_LOGGED_IN&quot;</span>);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;   }</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a32da61f3d1a1faa6ae5211f81eb52341">send_colp_to_agent</a>(logged, &amp;connected);</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;   <a class="code" href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a>(logged);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(logged, -1);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;connected);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d56/bridge_8h.html#a116a27b8e1e111729ee1828d4fab6b5a">ast_bridge_join</a>(caller_bridge, chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;caller_features, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93a9106169928c6eeccad5b5ebcf762ac9d">AST_BRIDGE_JOIN_PASS_REFERENCE</a>)) {</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2">caller_abort_agent</a>(agent);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39;: Caller %s failed to join the bridge.\n&quot;</span>,</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;         agent-&gt;username, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan));</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;ERROR&quot;</span>);</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   }</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;   <a class="code" href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a>(&amp;caller_features);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;   <span class="comment">/* Determine if we need to continue in the dialplan after the bridge. */</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#adac99999f1e55833e7f903979d67b48b">ast_channel_softhangup_internal_flag</a>(chan) &amp; <a class="code" href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a085c0c603de12dc2474a17a92e1cb5a4">AST_SOFTHANGUP_ASYNCGOTO</a>) {</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">       * The bridge was broken for a hangup that isn&#39;t real.</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">       * Don&#39;t run the h extension, because the channel isn&#39;t</span></div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">       * really hung up.  This should really only happen with</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">       * AST_SOFTHANGUP_ASYNCGOTO.</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      res = 0;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      res = <a class="code" href="../../d5/d7b/channel_8h.html#a9c63fff1d736568d1ee332dd7ea502bd">ast_check_hangup</a>(chan)</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;         || <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(chan), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d">AST_FLAG_ZOMBIE</a>)</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;         || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>));</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;   }</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;   <span class="keywordflow">return</span> res ? -1 : 0;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;}</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment"> * \brief Get agent config values from the login channel.</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment"> * \since 12.0.0</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment"> * \param agent What to setup channel config values on.</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment"> * \param chan Channel logging in as an agent.</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02040"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae896354e27dbb9fd8ece2a88f4d88d0d"> 2040</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae896354e27dbb9fd8ece2a88f4d88d0d">agent_login_channel_config</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;{</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> opts = { 0 };</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a> connected;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> override_ack_call = 0;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> override_auto_logoff = 0;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> override_wrapup_time = 0;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *override_dtmf_accept = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a>(&amp;connected);</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;   <span class="comment">/* Get config values from channel. */</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a5d3c15fe1dffda82e6dc03ca7b26526a">ast_party_connected_line_copy</a>(&amp;connected, <a class="code" href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a>(chan));</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;   var = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;AGENTACKCALL&quot;</span>);</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var)) {</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      override_ack_call = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(var) ? 1 : 0;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;opts, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a5da8eebe4a635b6bdaada84549b268cd">AGENT_FLAG_ACK_CALL</a>);</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;   }</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;   var = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;AGENTACCEPTDTMF&quot;</span>);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var)) {</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      override_dtmf_accept = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(var);</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;opts, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8ab8673dd8048180035a6a4981b693bc93">AGENT_FLAG_DTMF_ACCEPT</a>);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;   }</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;   var = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;AGENTAUTOLOGOFF&quot;</span>);</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var)) {</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="keywordflow">if</span> (sscanf(var, <span class="stringliteral">&quot;%u&quot;</span>, &amp;override_auto_logoff) == 1) {</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;opts, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a739a20e5cddf5896cdc77208b6f6b827">AGENT_FLAG_AUTO_LOGOFF</a>);</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      }</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   }</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;   var = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(chan, <span class="stringliteral">&quot;AGENTWRAPUPTIME&quot;</span>);</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var)) {</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      <span class="keywordflow">if</span> (sscanf(var, <span class="stringliteral">&quot;%u&quot;</span>, &amp;override_wrapup_time) == 1) {</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(&amp;opts, <a class="code" href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8aa4a13f5b13607cff26538ad6e851a832">AGENT_FLAG_WRAPUP_TIME</a>);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      }</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;   }</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;   <span class="comment">/* Set config values on agent. */</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a>(&amp;agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1e4986d38981a6836446fd6e0947bfaa">waiting_colp</a>);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1e4986d38981a6836446fd6e0947bfaa">waiting_colp</a> = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a414b69d7583bb4cfc6daf5276aac6d14">connected</a>;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(agent, override_dtmf_accept, override_dtmf_accept);</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#ab9da1c7265610eff83ed6146f104dc6f">ast_copy_flags</a>(agent, &amp;opts, <a class="code" href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a>);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a0db93def45062b0b68b3cfc92828056e">override_auto_logoff</a> = override_auto_logoff;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#aafe46fa9fde27806c85eea0f7e012b98">override_wrapup_time</a> = override_wrapup_time;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a9e221b3d2bfe1c52281667c3cb15195e">override_ack_call</a> = override_ack_call;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;}</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div><div class="line"><a name="l02096"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501"> 2096</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501">AGENT_LOGIN_OPT_FLAGS</a> {</div><div class="line"><a name="l02097"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501a9c6a0359498684912cb0a3810e03138d"> 2097</a></span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501a9c6a0359498684912cb0a3810e03138d">OPT_SILENT</a> = (1 &lt;&lt; 0),</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;};</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a520a3c6b7d57903d9a616051da1a019d">AST_APP_OPTIONS</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#abe9c246e6907a134e70926a4a761ef15">agent_login_opts</a>, <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ab451a4653176c211d131b899e1f91bde">BEGIN_OPTIONS</a></div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a>(<span class="charliteral">&#39;s&#39;</span>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501a9c6a0359498684912cb0a3810e03138d">OPT_SILENT</a>),</div><div class="line"><a name="l02101"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#abe9c246e6907a134e70926a4a761ef15"> 2101</a></span>&#160;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a2a1890787b3e55318c417c0a3e1432c7">END_OPTIONS</a>);</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment"> * \brief Dialplan AgentLogin application to log in an agent.</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment"> * \param chan Channel attempting to login as an agent.</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment"> * \param data Application parameters</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment"> * \retval 0 To continue in dialplan.</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment"> * \retval -1 To hangup.</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02112"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ae6f3c6c02f7961bd6939f302cafa0f4f"> 2112</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae6f3c6c02f7961bd6939f302cafa0f4f">agent_login_exec</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *data)</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;{</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> opts;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(agent_id);</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>);</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(other);     <span class="comment">/* Any remaining unused arguments */</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;   );</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *, agent, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d11/app__agent__pool_8c.html#a6c861b7f9ac3693f06669b575dc6e16b">bridge_agent_hold_deferred_create</a>()) {</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;   }</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a>(chan) != <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a> &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#aec583a3e25358ee552a4f3df53914cd0">ast_answer</a>(chan)) {</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;   }</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent_id)) {</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;AgentLogin requires an AgentId\n&quot;</span>);</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;   }</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb">ast_app_parse_options</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#abe9c246e6907a134e70926a4a761ef15">agent_login_opts</a>, &amp;opts, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.options)) {</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      <span class="comment">/* General invalid option syntax. */</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;   }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;   <span class="comment">/* Find the agent. */</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent_id, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39; does not exist.\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agent_id);</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;INVALID&quot;</span>);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;   }</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;   <span class="comment">/* Has someone already logged in as this agent already? */</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;   <span class="keywordflow">if</span> (agent-&gt;logged) {</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;Agent &#39;%s&#39; already logged in.\n&quot;</span>, agent-&gt;username);</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;AGENT_STATUS&quot;</span>, <span class="stringliteral">&quot;ALREADY_LOGGED_IN&quot;</span>);</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;   }</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;   agent-&gt;logged = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(chan);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;   agent-&gt;last_disconnect = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;   time(&amp;agent-&gt;login_start);</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;   agent-&gt;deferred_logoff = 0;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae896354e27dbb9fd8ece2a88f4d88d0d">agent_login_channel_config</a>(agent, chan);</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;opts, <a class="code" href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501a9c6a0359498684912cb0a3810e03138d">OPT_SILENT</a>)) {</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;      <a class="code" href="../../d2/d4d/file_8h.html#a95b94a020720147325a486e210b36775">ast_stream_and_wait</a>(chan, <span class="stringliteral">&quot;agent-loginok&quot;</span>, <a class="code" href="../../d2/d4d/file_8h.html#abb7bdff3c549191072878402b0a0ca9c">AST_DIGIT_NONE</a>);</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;   }</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Agent &#39;%s&#39; logged in (format %s/%s)\n&quot;</span>, agent-&gt;username,</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(chan)),</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a>(chan)));</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6f0c90a579585c460312c6c4d2caf216">send_agent_login</a>(chan, agent-&gt;username);</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a8e005c499b7e949c3f1a290e88acb71d">agent_run</a>(agent, chan);</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;}</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;</div><div class="line"><a name="l02184"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#acf1606296839a7252342273de8f9f563"> 2184</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#acf1606296839a7252342273de8f9f563">agent_function_read</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;{</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(agentid);</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>);</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;   );</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   buf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(data ?: <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#accfcb380df76a64251d88ef49c2dd4e3">AST_NONSTANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agentid)) {</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;The AGENT function requires an argument - agentid!\n&quot;</span>);</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;   }</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.item) {</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.item = <span class="stringliteral">&quot;status&quot;</span>;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;   }</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agentid, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Agent &#39;%s&#39; not found!\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.agentid);</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;   }</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.item, <span class="stringliteral">&quot;status&quot;</span>)) {</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keywordflow">if</span> (agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) {</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;         status = <span class="stringliteral">&quot;LOGGEDIN&quot;</span>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;         status = <span class="stringliteral">&quot;LOGGEDOUT&quot;</span>;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      }</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, status, len);</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.item, <span class="stringliteral">&quot;name&quot;</span>)) {</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">full_name</a>, len);</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.item, <span class="stringliteral">&quot;mohclass&quot;</span>)) {</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a6c0ebcc78965d8817651856e7914631d">moh</a>, len);</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.item, <span class="stringliteral">&quot;channel&quot;</span>)) {</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a>(agent);</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keywordflow">if</span> (logged) {</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;         <span class="keywordtype">char</span> *pos;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(logged), len);</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;         pos = strrchr(buf, <span class="charliteral">&#39;-&#39;</span>);</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;         <span class="keywordflow">if</span> (pos) {</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            *pos = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;         }</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      }</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.item, <span class="stringliteral">&quot;fullchannel&quot;</span>)) {</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a>(agent);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="keywordflow">if</span> (logged) {</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(buf, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(logged), len);</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      }</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;   }</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;}</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;</div><div class="line"><a name="l02255"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a1ef7f429bd53528befc06ac4d0f5ff3b"> 2255</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a1ef7f429bd53528befc06ac4d0f5ff3b">agent_function</a> = {</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;AGENT&quot;</span>,</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;   .read = <a class="code" href="../../de/d11/app__agent__pool_8c.html#acf1606296839a7252342273de8f9f563">agent_function_read</a>,</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;};</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;</div><div class="line"><a name="l02260"></a><span class="lineno"><a class="line" href="../../dc/d86/structagent__complete.html"> 2260</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dc/d86/structagent__complete.html">agent_complete</a> {<span class="comment"></span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">   /*! Nth match to return. */</span></div><div class="line"><a name="l02262"></a><span class="lineno"><a class="line" href="../../dc/d86/structagent__complete.html#a89f234133d3efe315836311cbf21c64b"> 2262</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d86/structagent__complete.html#a89f234133d3efe315836311cbf21c64b">state</a>;<span class="comment"></span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">   /*! Which match currently on. */</span></div><div class="line"><a name="l02264"></a><span class="lineno"><a class="line" href="../../dc/d86/structagent__complete.html#aa2a4dae2a14de4093826005f9bdfd3bb"> 2264</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dc/d86/structagent__complete.html#aa2a4dae2a14de4093826005f9bdfd3bb">which</a>;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;};</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;</div><div class="line"><a name="l02267"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ac7ac094b1e03eda5eef727a0c1988141"> 2267</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ac7ac094b1e03eda5eef727a0c1988141">complete_agent_search</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;{</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d86/structagent__complete.html">agent_complete</a> *search = data;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;   <span class="keywordflow">if</span> (++search-&gt;<a class="code" href="../../dc/d86/structagent__complete.html#aa2a4dae2a14de4093826005f9bdfd3bb">which</a> &gt; search-&gt;<a class="code" href="../../dc/d86/structagent__complete.html#a89f234133d3efe315836311cbf21c64b">state</a>) {</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;   }</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;}</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;</div><div class="line"><a name="l02277"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ac543f4a511c682ff550c23f1c8f7870c"> 2277</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#ac543f4a511c682ff550c23f1c8f7870c">complete_agent</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;{</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;   <span class="keywordtype">char</span> *ret;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d86/structagent__complete.html">agent_complete</a> search = {</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      .<a class="code" href="../../dc/d86/structagent__complete.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>,</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;   };</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(agents, <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(word) ? 0 : <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>,</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#ac7ac094b1e03eda5eef727a0c1988141">complete_agent_search</a>, (<span class="keywordtype">char</span> *) word, &amp;search);</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   }</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;   ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;}</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div><div class="line"><a name="l02295"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#aa54a01cf670832c6ad6fe44fc9bc20bb"> 2295</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#aa54a01cf670832c6ad6fe44fc9bc20bb">complete_agent_logoff_search</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;{</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent = obj;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d86/structagent__complete.html">agent_complete</a> *search = data;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;   <span class="keywordflow">if</span> (!agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">logged</a>) {</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;   }</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;   <span class="keywordflow">if</span> (++search-&gt;<a class="code" href="../../dc/d86/structagent__complete.html#aa2a4dae2a14de4093826005f9bdfd3bb">which</a> &gt; search-&gt;<a class="code" href="../../dc/d86/structagent__complete.html#a89f234133d3efe315836311cbf21c64b">state</a>) {</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;   }</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;}</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a97ba140fa091ecedd7cb9029a5e2ac36"> 2309</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a97ba140fa091ecedd7cb9029a5e2ac36">complete_agent_logoff</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>, <span class="keywordtype">int</span> <a class="code" href="../../d4/d88/structstate.html">state</a>)</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;{</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;   <span class="keywordtype">char</span> *ret;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d86/structagent__complete.html">agent_complete</a> search = {</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      .<a class="code" href="../../dc/d86/structagent__complete.html#a89f234133d3efe315836311cbf21c64b">state</a> = <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>,</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;   };</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(agents, <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(word) ? 0 : <a class="code" href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a>,</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aa54a01cf670832c6ad6fe44fc9bc20bb">complete_agent_logoff_search</a>, (<span class="keywordtype">char</span> *) word, &amp;search);</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;   }</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;   ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;}</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div><div class="line"><a name="l02327"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a4e0c76b6d740600bf9e322b87d04dfb4"> 2327</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a4e0c76b6d740600bf9e322b87d04dfb4">agent_show_requested</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>, <span class="keywordtype">int</span> online_only)</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;{</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="preprocessor">#define FORMAT_HDR &quot;%-8s %-20s %-11s %-30s %s\n&quot;</span></div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="preprocessor">#define FORMAT_ROW &quot;%-8s %-20s %-11s %-30s %s\n&quot;</span></div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(512);</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> agents_total = 0;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> agents_logged_in = 0;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> agents_talking = 0;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#afd2c9505e0edcb47e18669f60500acf0">FORMAT_HDR</a>, <span class="stringliteral">&quot;Agent-ID&quot;</span>, <span class="stringliteral">&quot;Name&quot;</span>, <span class="stringliteral">&quot;State&quot;</span>, <span class="stringliteral">&quot;Channel&quot;</span>, <span class="stringliteral">&quot;Talking with&quot;</span>);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;   iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(agents, 0);</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;   <span class="keywordflow">for</span> (; (agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1)) {</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      ++agents_total;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a>(agent);</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      <span class="keywordflow">if</span> (logged) {</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">char</span> *talking_with;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;         ++agents_logged_in;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;         talking_with = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(logged, <span class="stringliteral">&quot;BRIDGEPEER&quot;</span>);</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(talking_with)) {</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            ++agents_talking;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            talking_with = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;         }</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a4090d7655fc829efc4a37a3144759c7c">FORMAT_ROW</a>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">full_name</a>,</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a6190de57ac370315e51f2c46724d5b10">ast_devstate_str</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a>), <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(logged), talking_with);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a4090d7655fc829efc4a37a3144759c7c">FORMAT_ROW</a>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">full_name</a>,</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <a class="code" href="../../da/da2/devicestate_8h.html#a6190de57ac370315e51f2c46724d5b10">ast_devstate_str</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a>), <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      }</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <span class="keywordflow">if</span> (!online_only || logged) {</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out));</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;      }</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;   }</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter);</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\nDefined agents: %u, Logged in: %u, Talking: %u\n&quot;</span>,</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      agents_total, agents_logged_in, agents_talking);</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="preprocessor">#undef FORMAT_HDR</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="preprocessor">#undef FORMAT_ROW</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;}</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;</div><div class="line"><a name="l02382"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#adcc9e89f7dbd8c807535fbced0f99287"> 2382</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#adcc9e89f7dbd8c807535fbced0f99287">agent_handle_show_online</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;{</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;agent show online&quot;</span>;</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;         <span class="stringliteral">&quot;Usage: agent show online\n&quot;</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;         <span class="stringliteral">&quot;       Provides summary information for logged in agents.\n&quot;</span>;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;   }</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;   }</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a4e0c76b6d740600bf9e322b87d04dfb4">agent_show_requested</a>(a, 1);</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;}</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;</div><div class="line"><a name="l02404"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a5975e0ec066ec59aaca8d2e01989ac7b"> 2404</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a5975e0ec066ec59aaca8d2e01989ac7b">agent_handle_show_all</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;{</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;agent show all&quot;</span>;</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;         <span class="stringliteral">&quot;Usage: agent show all\n&quot;</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;         <span class="stringliteral">&quot;       Provides summary information for all agents.\n&quot;</span>;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;   }</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;   }</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a4e0c76b6d740600bf9e322b87d04dfb4">agent_show_requested</a>(a, 0);</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;}</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;</div><div class="line"><a name="l02426"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#abf5e2903a4ceff8c71544f7760ebc970"> 2426</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#abf5e2903a4ceff8c71544f7760ebc970">agent_handle_show_specific</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;{</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(4096);</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;agent show&quot;</span>;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;         <span class="stringliteral">&quot;Usage: agent show &lt;agent-id&gt;\n&quot;</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;         <span class="stringliteral">&quot;       Show information about the &lt;agent-id&gt; agent\n&quot;</span>;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 2) {</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ac543f4a511c682ff550c23f1c8f7870c">complete_agent</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      }</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;   }</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;   }</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;   agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(agents, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;   <span class="keywordflow">if</span> (!agent) {</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Agent &#39;%s&#39; not found\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;   }</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;   logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a>(agent);</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <span class="stringliteral">&quot;Id: %s\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;Name: %s\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">full_name</a>);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;Beep: %s\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#af22047b6d8545b610cde6ad3e397fd79">beep_sound</a>);</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;MOH: %s\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a6c0ebcc78965d8817651856e7914631d">moh</a>);</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;RecordCalls: %s\n&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#afa345a7167ae253354866a0e845058b2">record_agent_calls</a>));</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;State: %s\n&quot;</span>, <a class="code" href="../../da/da2/devicestate_8h.html#a6190de57ac370315e51f2c46724d5b10">ast_devstate_str</a>(agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">devstate</a>));</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;   <span class="keywordflow">if</span> (logged) {</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *talking_with;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;LoggedInChannel: %s\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(logged));</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;LoggedInTime: %ld\n&quot;</span>, (<span class="keywordtype">long</span>) agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#acd6bb3b5d452161627e0c4b204977401">login_start</a>);</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      talking_with = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(logged, <span class="stringliteral">&quot;BRIDGEPEER&quot;</span>);</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(talking_with)) {</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;TalkingWith: %s\n&quot;</span>, talking_with);</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;CallStarted: %ld\n&quot;</span>, (<span class="keywordtype">long</span>) agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#aa09f4acec5c1e337edce28217f8f685c">call_start</a>);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      }</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;   }</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1);</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out));</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;}</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;</div><div class="line"><a name="l02485"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a5485fc780d3e0cce2d98b85aad2c846c"> 2485</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d11/app__agent__pool_8c.html#a5485fc780d3e0cce2d98b85aad2c846c">agent_handle_logoff_cmd</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>)</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;{</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;agent logoff&quot;</span>;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;         <span class="stringliteral">&quot;Usage: agent logoff &lt;agent-id&gt; [soft]\n&quot;</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;         <span class="stringliteral">&quot;       Sets an agent as no longer logged in.\n&quot;</span></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;         <span class="stringliteral">&quot;       If &#39;soft&#39; is specified, do not hangup existing calls.\n&quot;</span>;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 2) {</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a97ba140fa091ecedd7cb9029a5e2ac36">complete_agent_logoff</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a>);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> == 3 &amp;&amp; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">n</a> == 0</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;         &amp;&amp; (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>)</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            || !strncasecmp(<span class="stringliteral">&quot;soft&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>)))) {</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;soft&quot;</span>);</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      }</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;   }</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &lt; 3 || 4 &lt; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a>) {</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;   }</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 4 &amp;&amp; strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;soft&quot;</span>)) {</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;   }</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/d11/app__agent__pool_8c.html#a90c12fe1cfd5f897d788df917f0af3af">agent_logoff_request</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2], a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 4)) {</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Logging out %s\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[2]);</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   }</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;}</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a86ce161e89fb61c8534e1eca1cdcf618"> 2520</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a86ce161e89fb61c8534e1eca1cdcf618">cli_agents</a>[] = {</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#adcc9e89f7dbd8c807535fbced0f99287">agent_handle_show_online</a>, <span class="stringliteral">&quot;Show status of online agents&quot;</span>),</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#a5975e0ec066ec59aaca8d2e01989ac7b">agent_handle_show_all</a>, <span class="stringliteral">&quot;Show status of all agents&quot;</span>),</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#abf5e2903a4ceff8c71544f7760ebc970">agent_handle_show_specific</a>, <span class="stringliteral">&quot;Show information about an agent&quot;</span>),</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#a5485fc780d3e0cce2d98b85aad2c846c">agent_handle_logoff_cmd</a>, <span class="stringliteral">&quot;Sets an agent offline&quot;</span>),</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;};</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div><div class="line"><a name="l02527"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a0c9069d554e6ace86b060a06c56d2ba3"> 2527</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a0c9069d554e6ace86b060a06c56d2ba3">action_agents</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;{</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;   <span class="keywordtype">char</span> id_text[<a class="code" href="../../de/d11/app__agent__pool_8c.html#a34d3e99d5529e36506d0ee8a9982c281">AST_MAX_BUF</a>];</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d4d/structagent__pvt.html">agent_pvt</a> *agent;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(4096);</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;   <span class="keywordtype">int</span> num_agents = 0;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      snprintf(id_text, <span class="keyword">sizeof</span>(id_text), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      id_text[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   }</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Agents will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(agents, 0);</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   <span class="keywordflow">for</span> (; (agent = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(agent, -1)) {</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *logged;</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a>(agent);</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      logged = <a class="code" href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a>(agent);</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">       * Status Values:</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">       * AGENT_LOGGEDOFF - Agent isn&#39;t logged in</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">       * AGENT_IDLE      - Agent is logged in, and waiting for call</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment">       * AGENT_ONCALL    - Agent is logged in, and on a call</span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment">       * AGENT_UNKNOWN   - Don&#39;t know anything about agent. Shouldn&#39;t ever get this.</span></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;out, 0, <span class="stringliteral">&quot;Agent: %s\r\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;Name: %s\r\n&quot;</span>, agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">cfg</a>-&gt;<a class="code" href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">full_name</a>);</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <span class="keywordflow">if</span> (logged) {</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">char</span> *talking_to_chan;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *logged_headers;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, logged_snapshot, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a>(logged), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;         <span class="keywordflow">if</span> (!logged_snapshot</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;            || !(logged_headers =</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                <a class="code" href="../../db/d45/manager_8h.html#a777cde87d12b331902f862ec44641688">ast_manager_build_channel_state_string</a>(logged_snapshot))) {</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;            <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;         }</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;         talking_to_chan = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(logged, <span class="stringliteral">&quot;BRIDGEPEER&quot;</span>);</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(talking_to_chan)) {</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;Status: %s\r\n&quot;</span>, <span class="stringliteral">&quot;AGENT_ONCALL&quot;</span>);</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;TalkingToChan: %s\r\n&quot;</span>, talking_to_chan);</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;CallStarted: %ld\n&quot;</span>, (<span class="keywordtype">long</span>) agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#aa09f4acec5c1e337edce28217f8f685c">call_start</a>);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;Status: %s\r\n&quot;</span>, <span class="stringliteral">&quot;AGENT_IDLE&quot;</span>);</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;         }</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;LoggedInTime: %ld\r\n&quot;</span>, (<span class="keywordtype">long</span>) agent-&gt;<a class="code" href="../../dd/d4d/structagent__pvt.html#acd6bb3b5d452161627e0c4b204977401">login_start</a>);</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(logged_headers));</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(logged);</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(logged);</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(logged_headers);</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;Status: %s\r\n&quot;</span>, <span class="stringliteral">&quot;AGENT_LOGGEDOFF&quot;</span>);</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      }</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a>(agent);</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: Agents\r\n&quot;</span></div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;         <span class="stringliteral">&quot;%s%s\r\n&quot;</span>,</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(out), id_text);</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;      ++num_agents;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;   }</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter);</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;AgentsComplete&quot;</span>, num_agents);</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;}</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div><div class="line"><a name="l02605"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a6558aa820bc9dd1eebac76ee2e2951f0"> 2605</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6558aa820bc9dd1eebac76ee2e2951f0">action_agent_logoff</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d8/d9e/structmessage.html">message</a> *m)</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;{</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *agent = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Agent&quot;</span>);</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *soft_s = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Soft&quot;</span>); <span class="comment">/* &quot;true&quot; is don&#39;t hangup */</span></div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(agent)) {</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No agent specified&quot;</span>);</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;   }</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../de/d11/app__agent__pool_8c.html#a90c12fe1cfd5f897d788df917f0af3af">agent_logoff_request</a>(agent, <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(soft_s))) {</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Agent logged out&quot;</span>);</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such agent&quot;</span>);</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;   }</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;}</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div><div class="line"><a name="l02624"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ad09fa931f468002152a3cc2d5ce25eae"> 2624</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;{</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *holding;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;   <span class="comment">/* Unregister dialplan applications */</span></div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#a358f094a1d14b589ace3b278972be56f">app_agent_login</a>);</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#a872ee537b540de2ccaea4e62ed2dc016">app_agent_request</a>);</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;   <span class="comment">/* Unregister dialplan functions */</span></div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;agent_function);</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;   <span class="comment">/* Unregister manager command */</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Agents&quot;</span>);</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;AgentLogoff&quot;</span>);</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;   <span class="comment">/* Unregister CLI commands */</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(cli_agents, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_agents));</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;   <a class="code" href="../../da/da2/devicestate_8h.html#a1ab579ae15aaca64a904c3c41d8b8b01">ast_devstate_prov_del</a>(<span class="stringliteral">&quot;Agent&quot;</span>);</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;   <span class="comment">/* Destroy agent holding bridge. */</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;   holding = <a class="code" href="../../d5/da5/astobj2_8h.html#aadb92410f92a28e16f404b51bc601a80">ao2_global_obj_replace</a>(agent_holding, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;   <span class="keywordflow">if</span> (holding) {</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <a class="code" href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a>(holding, 0);</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;   }</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a542b526fd6c81c6193101dfbe970c2be">destroy_config</a>();</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(agents);</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;   agents = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;}</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;</div><div class="line"><a name="l02656"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9"> 2656</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;{</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;   agents = <a class="code" href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>,</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520acadb2bfd83bc54a380d86d3a9b02d99c35">AO2_CONTAINER_ALLOC_OPT_DUPS_REPLACE</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a32d9fcd6bfb0ed9371e6dbae8a994bda">agent_pvt_sort_cmp</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad63565be83f2a9e10382f7adb483965c">agent_pvt_cmp</a>);</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;   <span class="keywordflow">if</span> (!agents) {</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;   }</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;   <span class="comment">/* Init agent holding bridge v_table. */</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;   <a class="code" href="../../de/d11/app__agent__pool_8c.html#a7f905c96aa9c5adc8d4e297e3cf89f61">bridge_init_agent_hold</a>();</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;   <span class="comment">/* Setup to provide Agent:agent-id device state. */</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;   res |= <a class="code" href="../../da/da2/devicestate_8h.html#ae832fcc32c88962e73025ffeafe2961e">ast_devstate_prov_add</a>(<span class="stringliteral">&quot;Agent&quot;</span>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a3a5f74a4e24b8c032bd9698c1f2af510">agent_pvt_devstate_get</a>);</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;   <span class="comment">/* CLI Commands */</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;   res |= <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(cli_agents, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_agents));</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;   <span class="comment">/* Manager commands */</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;   res |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;Agents&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a0c9069d554e6ace86b060a06c56d2ba3">action_agents</a>);</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;   res |= <a class="code" href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a>(<span class="stringliteral">&quot;AgentLogoff&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a6558aa820bc9dd1eebac76ee2e2951f0">action_agent_logoff</a>);</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;   <span class="comment">/* Dialplan Functions */</span></div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;   res |= <a class="code" href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a>(&amp;agent_function);</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;   <span class="comment">/* Dialplan applications */</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;   res |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#a358f094a1d14b589ace3b278972be56f">app_agent_login</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#ae6f3c6c02f7961bd6939f302cafa0f4f">agent_login_exec</a>);</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;   res |= <a class="code" href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a>(<a class="code" href="../../de/d11/app__agent__pool_8c.html#a872ee537b540de2ccaea4e62ed2dc016">app_agent_request</a>, <a class="code" href="../../de/d11/app__agent__pool_8c.html#a392237b28b1ee658981b450fcf3fe363">agent_request_exec</a>);</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to register application. Not loading module.\n&quot;</span>);</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;   }</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d11/app__agent__pool_8c.html#aed5779f84d4ebb67745d801d3ebede43">load_config</a>()) {</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to load config. Not loading module.\n&quot;</span>);</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>();</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;   }</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;}</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div><div class="line"><a name="l02701"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#ad1982509765f4870f1f63412a53ea668"> 2701</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;{</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a>(&amp;cfg_info, 1) == <a class="code" href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a>) {</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="comment">/* Just keep the config we already have in place. */</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;   }</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;}</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a>(<a class="code" href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a>, <a class="code" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a>, <span class="stringliteral">&quot;Call center agent pool applications&quot;</span>,</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;   .support_level = <a class="code" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>,</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;   .load = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>,</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;   .unload = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>,</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;   .<a class="code" href="../../de/d11/app__agent__pool_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="code" href="../../de/d11/app__agent__pool_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>,</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;   .load_pri = <a class="code" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58af2d6c20d90a068171cc852484a435980">AST_MODPRI_DEVSTATE_PROVIDER</a>,</div><div class="line"><a name="l02716"></a><span class="lineno"><a class="line" href="../../de/d11/app__agent__pool_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae"> 2716</a></span>&#160;);</div><div class="ttc" id="astobj2_8h_html_a14c61bcab109a520a96d30c56ba5fcde"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a></div><div class="ttdeci">#define ao2_t_ref(o, delta, tag)</div><div class="ttdoc">Reference/unreference an object and return the old refcount. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00463">astobj2.h:463</a></div></div>
<div class="ttc" id="structast__custom__function_html_afcd1706c9144e6d6eee6127661ae3be2"><div class="ttname"><a href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">ast_custom_function::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00119">pbx.h:119</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_abcb60ae8dded463f56a7c35857f1e501"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501">AGENT_LOGIN_OPT_FLAGS</a></div><div class="ttdeci">AGENT_LOGIN_OPT_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02096">app_agent_pool.c:2096</a></div></div>
<div class="ttc" id="channel_8h_html_ac2dc872b606534943c98304aed841b34"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2dc872b606534943c98304aed841b34">ast_channel_caller</a></div><div class="ttdeci">struct ast_party_caller * ast_channel_caller(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00888">channel_internal_api.c:888</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a81b479dda160b217188d44dffc86361f"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a81b479dda160b217188d44dffc86361f">agent_cfg_sort_cmp</a></div><div class="ttdeci">static int agent_cfg_sort_cmp(const void *obj_left, const void *obj_right, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00405">app_agent_pool.c:405</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ac3382bf6da54c56b37069bd76bbdf4f9"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a></div><div class="ttdeci">static int load_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02656">app_agent_pool.c:2656</a></div></div>
<div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="channel_8h_html_abf514b9d96a1821a33fec8c64ee4e26f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abf514b9d96a1821a33fec8c64ee4e26f">ast_party_connected_line_init</a></div><div class="ttdeci">void ast_party_connected_line_init(struct ast_party_connected_line *init)</div><div class="ttdoc">Initialize the given connected line structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02022">channel.c:2022</a></div></div>
<div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="structaco__type_html_a4087c029dcf4619e4eb37e2bd1a9a098"><div class="ttname"><a href="../../de/d71/structaco__type.html#a4087c029dcf4619e4eb37e2bd1a9a098">aco_type::item_find</a></div><div class="ttdeci">aco_type_item_find item_find</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00135">config_options.h:135</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aba0c7c74e5144e318659f810dbc6d5e8a739a20e5cddf5896cdc77208b6f6b827"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a739a20e5cddf5896cdc77208b6f6b827">AGENT_FLAG_AUTO_LOGOFF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00589">app_agent_pool.c:589</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="bridge__features_8h_html_aafc3026d777c0bf6899e93263178e102"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#aafc3026d777c0bf6899e93263178e102">ast_bridge_features_cleanup</a></div><div class="ttdeci">void ast_bridge_features_cleanup(struct ast_bridge_features *features)</div><div class="ttdoc">Clean up the contents of a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03720">bridge.c:3720</a></div></div>
<div class="ttc" id="cli_8h_html_a5c4130cf8f1e93acfdd84416cebf1aef"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a></div><div class="ttdeci">#define AST_CLI_DEFINE(fn, txt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00197">cli.h:197</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a8e005c499b7e949c3f1a290e88acb71d"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a8e005c499b7e949c3f1a290e88acb71d">agent_run</a></div><div class="ttdeci">static void agent_run(struct agent_pvt *agent, struct ast_channel *logged)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01520">app_agent_pool.c:1520</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a4090d7655fc829efc4a37a3144759c7c"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a4090d7655fc829efc4a37a3144759c7c">FORMAT_ROW</a></div><div class="ttdeci">#define FORMAT_ROW</div></div>
<div class="ttc" id="structagent__cfg_html_a5804ef809b93820d3437a86e08126bd8"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#a5804ef809b93820d3437a86e08126bd8">agent_cfg::username</a></div><div class="ttdeci">const ast_string_field username</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00365">app_agent_pool.c:365</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eee"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eee">ast_device_state</a></div><div class="ttdeci">ast_device_state</div><div class="ttdoc">Device States. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00052">devicestate.h:52</a></div></div>
<div class="ttc" id="channel_8h_html_ab380c81e4514ab48ca8402f7950a354a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab380c81e4514ab48ca8402f7950a354a">ast_connected_line_build_data</a></div><div class="ttdeci">int ast_connected_line_build_data(unsigned char *data, size_t datalen, const struct ast_party_connected_line *connected, const struct ast_set_party_connected_line *update)</div><div class="ttdoc">Build the connected line information data frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08793">channel.c:8793</a></div></div>
<div class="ttc" id="structagents__cfg_html"><div class="ttname"><a href="../../dd/d4f/structagents__cfg.html">agents_cfg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00454">app_agent_pool.c:454</a></div></div>
<div class="ttc" id="config__options_8h_html_a840871f014617f5415dacb9a7d32a59ba423543a2da4422bd5c7664a0b8ca84d8"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a840871f014617f5415dacb9a7d32a59ba423543a2da4422bd5c7664a0b8ca84d8">ACO_ITEM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00042">config_options.h:42</a></div></div>
<div class="ttc" id="structmessage_html"><div class="ttname"><a href="../../d8/d9e/structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00144">manager.h:144</a></div></div>
<div class="ttc" id="structagent__pvt_html_a5068662d1a4020ad70203c75f620c74d"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a5068662d1a4020ad70203c75f620c74d">agent_pvt::ack_time</a></div><div class="ttdeci">struct timeval ack_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00636">app_agent_pool.c:636</a></div></div>
<div class="ttc" id="bridge__roles_8h_html_af01f5cb3712ef0b120433da770f645ab"><div class="ttname"><a href="../../dd/dff/bridge__roles_8h.html#af01f5cb3712ef0b120433da770f645ab">ast_bridge_channel_clear_roles</a></div><div class="ttdeci">void ast_bridge_channel_clear_roles(struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Clear all roles from a bridge_channel&amp;#39;s role list. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d13/bridge__roles_8c_source.html#l00495">bridge_roles.c:495</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="stasis__channels_8h_html"><div class="ttname"><a href="../../d9/d4a/stasis__channels_8h.html">stasis_channels.h</a></div></div>
<div class="ttc" id="asterisk_8h_html"><div class="ttname"><a href="../../db/db2/asterisk_8h.html">asterisk.h</a></div><div class="ttdoc">Asterisk main include file. File version handling, generic pbx functions. </div></div>
<div class="ttc" id="structast__bridge__channel_html_a65633fdc6178dc8d9f754fda0166d16e"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a65633fdc6178dc8d9f754fda0166d16e">ast_bridge_channel::features</a></div><div class="ttdeci">struct ast_bridge_features * features</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00132">bridge_channel.h:132</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a1ccac2dce2e8c4f62baed1f63b225a15"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a1ccac2dce2e8c4f62baed1f63b225a15">ast_bridge_after_cb_reason_string</a></div><div class="ttdeci">const char * ast_bridge_after_cb_reason_string(enum ast_bridge_after_cb_reason reason)</div><div class="ttdoc">Get a string representation of an after bridge callback reason. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00296">bridge_after.c:296</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a8349083856559d62c42c385e3e47f12b">AST_BRIDGE_FLAG_MERGE_INHIBIT_TO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00045">bridge_features.h:45</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a5ad28c249794c7354336fc512fab8f7a"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a5ad28c249794c7354336fc512fab8f7a">ast_bridge_features_do</a></div><div class="ttdeci">int ast_bridge_features_do(enum ast_bridge_builtin_feature feature, struct ast_bridge_channel *bridge_channel, void *hook_pvt)</div><div class="ttdoc">Invoke a built in feature hook now. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03151">bridge.c:3151</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae45e38e10e4b85b3161bdd0cb45b81ef"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae45e38e10e4b85b3161bdd0cb45b81ef">agents_conf</a></div><div class="ttdeci">static struct aco_file agents_conf</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00485">app_agent_pool.c:485</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structagent__pvt_html_a255ab96bed8587b3757a2143ed9fa03e"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a255ab96bed8587b3757a2143ed9fa03e">agent_pvt::override_dtmf_accept</a></div><div class="ttdeci">const ast_string_field override_dtmf_accept</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00600">app_agent_pool.c:600</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="config__options_8h_html_ab29e0267f5b05969bcd1d16e97100ebba5892a0910f40cf2548d0b0baef53a195"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#ab29e0267f5b05969bcd1d16e97100ebba5892a0910f40cf2548d0b0baef53a195">ACO_BLACKLIST_ARRAY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00057">config_options.h:57</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a221957559e467e3d6793e2eaf2c58352"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a221957559e467e3d6793e2eaf2c58352">_agent_unlock</a></div><div class="ttdeci">static void _agent_unlock(struct agent_pvt *agent, const char *file, const char *function, int line, const char *var)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00672">app_agent_pool.c:672</a></div></div>
<div class="ttc" id="config__options_8h_html_a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00064">config_options.h:64</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a1d78ba0e31a3a17b37273be121850718"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a1d78ba0e31a3a17b37273be121850718">CALLER_SAFETY_TIMEOUT_TIME</a></div><div class="ttdeci">#define CALLER_SAFETY_TIMEOUT_TIME</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00339">app_agent_pool.c:339</a></div></div>
<div class="ttc" id="bridge__internal_8h_html_a8690315fd0d12e16671f9d22eacfa8f0"><div class="ttname"><a href="../../d5/dde/bridge__internal_8h.html#a8690315fd0d12e16671f9d22eacfa8f0">bridge_register</a></div><div class="ttdeci">struct ast_bridge * bridge_register(struct ast_bridge *bridge)</div><div class="ttdoc">Register the new bridge with the system. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00709">bridge.c:709</a></div></div>
<div class="ttc" id="module_8h_html_ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15"><div class="ttname"><a href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00121">module.h:121</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a6f0c90a579585c460312c6c4d2caf216"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a6f0c90a579585c460312c6c4d2caf216">send_agent_login</a></div><div class="ttdeci">static void send_agent_login(struct ast_channel *chan, const char *agent)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01439">app_agent_pool.c:1439</a></div></div>
<div class="ttc" id="structagent__cfg_html_a6d121225508f464976ccd1f571cc3ba1"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#a6d121225508f464976ccd1f571cc3ba1">agent_cfg::full_name</a></div><div class="ttdeci">const ast_string_field full_name</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00365">app_agent_pool.c:365</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aec4e1bc1cab0249a428af2157c2514a1"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aec4e1bc1cab0249a428af2157c2514a1">agent_unlock</a></div><div class="ttdeci">#define agent_unlock(agent)</div><div class="ttdoc">Unlock the agent. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00671">app_agent_pool.c:671</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ab37a1835212d045dcfe7ef7f25eb5e31"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ab37a1835212d045dcfe7ef7f25eb5e31">ast_bridge_channel_leave_bridge_nolock</a></div><div class="ttdeci">void ast_bridge_channel_leave_bridge_nolock(struct ast_bridge_channel *bridge_channel, enum bridge_channel_state new_state, int cause)</div><div class="ttdoc">Set bridge channel state to leave bridge (if not leaving already). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00292">bridge_channel.c:292</a></div></div>
<div class="ttc" id="file_8h_html_afa92b0106fb7a918ea994c2867ac0a04"><div class="ttname"><a href="../../d2/d4d/file_8h.html#afa92b0106fb7a918ea994c2867ac0a04">AST_DIGIT_ANY</a></div><div class="ttdeci">#define AST_DIGIT_ANY</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00048">file.h:48</a></div></div>
<div class="ttc" id="structast__bridge__features_html"><div class="ttname"><a href="../../db/dba/structast__bridge__features.html">ast_bridge_features</a></div><div class="ttdoc">Structure that contains features information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00263">bridge_features.h:263</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="channel_8h_html_ab733a7825810b895a89b629e0ea89380"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a></div><div class="ttdeci">#define ast_channel_unref(c)</div><div class="ttdoc">Decrease channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02981">channel.h:2981</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="structagent__pvt_html_a2b63413544f313e27f0a2893dfa5e251"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a2b63413544f313e27f0a2893dfa5e251">agent_pvt::state</a></div><div class="ttdeci">enum agent_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00625">app_agent_pool.c:625</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a7c84929318242d3454e982dce5668aae"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a7c84929318242d3454e982dce5668aae">agent_pvt_destructor</a></div><div class="ttdeci">static void agent_pvt_destructor(void *vdoomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00761">app_agent_pool.c:761</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ab451a4653176c211d131b899e1f91bde"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ab451a4653176c211d131b899e1f91bde">BEGIN_OPTIONS</a></div><div class="ttdeci">#define BEGIN_OPTIONS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01343">include/asterisk/app.h:1343</a></div></div>
<div class="ttc" id="channel_8h_html_aef2af15a597c948e97628da6c5c84f28"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aef2af15a597c948e97628da6c5c84f28">ast_indicate</a></div><div class="ttdeci">int ast_indicate(struct ast_channel *chan, int condition)</div><div class="ttdoc">Indicates condition of channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04322">channel.c:4322</a></div></div>
<div class="ttc" id="structagent__cfg_html_af22047b6d8545b610cde6ad3e397fd79"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#af22047b6d8545b610cde6ad3e397fd79">agent_cfg::beep_sound</a></div><div class="ttdeci">const ast_string_field beep_sound</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00365">app_agent_pool.c:365</a></div></div>
<div class="ttc" id="structagent__cfg_html_afa345a7167ae253354866a0e845058b2"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#afa345a7167ae253354866a0e845058b2">agent_cfg::record_agent_calls</a></div><div class="ttdeci">int record_agent_calls</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00386">app_agent_pool.c:386</a></div></div>
<div class="ttc" id="gsm__explode_8c_html_a4e819f902d7ae632dd5ae75b29372f1b"><div class="ttname"><a href="../../d8/d34/gsm__explode_8c.html#a4e819f902d7ae632dd5ae75b29372f1b">bc</a></div><div class="ttdeci">#define bc</div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="channel_8h_html_ae6b4b7ba458e88fdbb2df9f39d935337"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a></div><div class="ttdeci">void ast_channel_hangupcause_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00431">channel_internal_api.c:431</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a5ef8af740b139874195a394ba4abee3d"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a5ef8af740b139874195a394ba4abee3d">ast_bridge_join_hook</a></div><div class="ttdeci">int ast_bridge_join_hook(struct ast_bridge_features *features, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Unregisters a handler for a built in interval feature. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03338">bridge.c:3338</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a5cbaa6e72ca2e17b3339e7031d113dc1"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a5cbaa6e72ca2e17b3339e7031d113dc1">agent_type</a></div><div class="ttdeci">static struct aco_type agent_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00465">app_agent_pool.c:465</a></div></div>
<div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a41510c1f43cb3401f5c7c88d9c9a8d11a2b221cc62ec019751101af0d7a754cb5">AST_BRIDGE_HOOK_REMOVE_ON_PULL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00183">bridge_features.h:183</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#a8f8f80d37794cde9472343e4487ba3eb">ast_bridge_methods::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00267">bridge.h:267</a></div></div>
<div class="ttc" id="bridge__roles_8h_html_a7dce43ab7e058fda7576097ab7068ae2"><div class="ttname"><a href="../../dd/dff/bridge__roles_8h.html#a7dce43ab7e058fda7576097ab7068ae2">ast_channel_remove_bridge_role</a></div><div class="ttdeci">void ast_channel_remove_bridge_role(struct ast_channel *chan, const char *role_name)</div><div class="ttdoc">Removes a bridge role from a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d13/bridge__roles_8c_source.html#l00336">bridge_roles.c:336</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2448088751e4d494d1981c7f4b84e8d0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2448088751e4d494d1981c7f4b84e8d0">OBJ_POINTER</a></div><div class="ttdeci">#define OBJ_POINTER</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01154">astobj2.h:1154</a></div></div>
<div class="ttc" id="utils_8h_html_ab5033a1f3d781d45e7ccc27598114510"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a></div><div class="ttdeci">#define ast_set_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00070">utils.h:70</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ac08f7eb1eb9476b30987c73e1052ada8"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a></div><div class="ttdeci">#define AST_STANDARD_APP_ARGS(args, parse)</div><div class="ttdoc">Performs the &amp;#39;standard&amp;#39; argument separation process for an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01285">include/asterisk/app.h:1285</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aed5779f84d4ebb67745d801d3ebede43"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aed5779f84d4ebb67745d801d3ebede43">load_config</a></div><div class="ttdeci">static int load_config(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00543">app_agent_pool.c:543</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7ae0e1c28605b6139c3b8fa403e8a42621"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ae0e1c28605b6139c3b8fa403e8a42621">AGENT_STATE_CALL_WRAPUP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00580">app_agent_pool.c:580</a></div></div>
<div class="ttc" id="channel_8h_html_a723ac44c92b9edb6c1a731e01edacb4a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a></div><div class="ttdeci">int ast_check_hangup_locked(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00459">channel.c:459</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aba0c7c74e5144e318659f810dbc6d5e8ab8673dd8048180035a6a4981b693bc93"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8ab8673dd8048180035a6a4981b693bc93">AGENT_FLAG_DTMF_ACCEPT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00588">app_agent_pool.c:588</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="structagent__pvt_html_acc12f7a44f078cee9f52face3f7787f1"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#acc12f7a44f078cee9f52face3f7787f1">agent_pvt::deferred_logoff</a></div><div class="ttdeci">unsigned int deferred_logoff</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00613">app_agent_pool.c:613</a></div></div>
<div class="ttc" id="structast__cli__entry_html"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a></div><div class="ttdoc">descriptor for a cli entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00171">cli.h:171</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="json_8h_html_ae2cc29409ec389e8feaf38ec3a585d83"><div class="ttname"><a href="../../d4/d05/json_8h.html#ae2cc29409ec389e8feaf38ec3a585d83">ast_json_int_t</a></div><div class="ttdeci">AST_JSON_INT_T ast_json_int_t</div><div class="ttdoc">Primarily used to cast when packing to an &quot;I&quot; type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00087">json.h:87</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7a3bc3f30b122882c42e989f6c5ca2aa86"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a3bc3f30b122882c42e989f6c5ca2aa86">AGENT_STATE_LOGGED_OUT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00568">app_agent_pool.c:568</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7ace0d2b80786a272cbf12d2fadcf38f49"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ace0d2b80786a272cbf12d2fadcf38f49">AGENT_STATE_ON_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00578">app_agent_pool.c:578</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae8abe54e1e1460641ed987db20e75e81"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae8abe54e1e1460641ed987db20e75e81">__ao2_lock</a></div><div class="ttdeci">int __ao2_lock(void *a, enum ao2_lock_req lock_how, const char *file, const char *func, int line, const char *var)</div><div class="ttdoc">Lock an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00222">astobj2.c:222</a></div></div>
<div class="ttc" id="structagents__cfg_html_a02691f29ac4d0ddd46ef7ebd90c3958d"><div class="ttname"><a href="../../dd/d4f/structagents__cfg.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents_cfg::agents</a></div><div class="ttdeci">struct ao2_container * agents</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00456">app_agent_pool.c:456</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="channel_8h_html_a7ee3ff7bf7773329e9e20143f0ba2f69"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ee3ff7bf7773329e9e20143f0ba2f69">ast_channel_update_connected_line</a></div><div class="ttdeci">void ast_channel_update_connected_line(struct ast_channel *chan, const struct ast_party_connected_line *connected, const struct ast_set_party_connected_line *update)</div><div class="ttdoc">Indicate that the connected line information has changed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l09189">channel.c:9189</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a3128b52009fb3dd764dce90ea377fce1"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a3128b52009fb3dd764dce90ea377fce1">ast_bridge_features_init</a></div><div class="ttdeci">int ast_bridge_features_init(struct ast_bridge_features *features)</div><div class="ttdoc">Initialize bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03687">bridge.c:3687</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a9d7ca6b64c5bd875d4f16e8aef443497"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a9d7ca6b64c5bd875d4f16e8aef443497">ast_bridge_channel_write_control_data</a></div><div class="ttdeci">int ast_bridge_channel_write_control_data(struct ast_bridge_channel *bridge_channel, enum ast_control_frame_type control, const void *data, size_t datalen)</div><div class="ttdoc">Write a control frame into the bridge with data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01155">bridge_channel.c:1155</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a86ce161e89fb61c8534e1eca1cdcf618"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a86ce161e89fb61c8534e1eca1cdcf618">cli_agents</a></div><div class="ttdeci">static struct ast_cli_entry cli_agents[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02520">app_agent_pool.c:2520</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a99d2d56a1bc356d880b7dfa6921cf32f"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a99d2d56a1bc356d880b7dfa6921cf32f">agent_after_bridge_cb_failed</a></div><div class="ttdeci">static void agent_after_bridge_cb_failed(enum ast_bridge_after_cb_reason reason, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01633">app_agent_pool.c:1633</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab940ba7749a2a12c3e9a356bd26fd744"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab940ba7749a2a12c3e9a356bd26fd744">__ao2_cleanup</a></div><div class="ttdeci">void __ao2_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00674">astobj2.c:674</a></div></div>
<div class="ttc" id="config__options_8h_html_a60d17d3e9451ddcb5aa861339c757bed"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a></div><div class="ttdeci">#define aco_option_register(info, name, matchtype, types, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a config option. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00623">config_options.h:623</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a9e3135920bd5bdbfd8c57fdaaa6b1dbe">AST_CONTROL_ANSWER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00281">include/asterisk/frame.h:281</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aba0c7c74e5144e318659f810dbc6d5e8aa4a13f5b13607cff26538ad6e851a832"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8aa4a13f5b13607cff26538ad6e851a832">AGENT_FLAG_WRAPUP_TIME</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00590">app_agent_pool.c:590</a></div></div>
<div class="ttc" id="structagent__pvt_html_a7d442bd00b142ff82e79c2052d69dcdb"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a7d442bd00b142ff82e79c2052d69dcdb">agent_pvt::logged</a></div><div class="ttdeci">struct ast_channel * logged</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00643">app_agent_pool.c:643</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a1b0936415a643c88ce543099c10e0d7f"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a></div><div class="ttdeci">#define var</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00614">ast_expr2f.c:614</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a></div><div class="ttdoc">Structure representing a snapshot of channel state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00145">stasis_channels.h:145</a></div></div>
<div class="ttc" id="channel_8h_html_a9e9505a91a84992d04ba4e85217fb4e4a2b3b711afc65059c4b51008c9fbc7aee"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a2b3b711afc65059c4b51008c9fbc7aee">AST_SOFTHANGUP_EXPLICIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01149">channel.h:1149</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aba0c7c74e5144e318659f810dbc6d5e8a5da8eebe4a635b6bdaada84549b268cd"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8a5da8eebe4a635b6bdaada84549b268cd">AGENT_FLAG_ACK_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00587">app_agent_pool.c:587</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeafac147cbabf3ccb80e50e86027710549">AST_DEVICE_UNAVAILABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00058">devicestate.h:58</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae77cde78a0e0ae3e75a2911857bfadc5"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae77cde78a0e0ae3e75a2911857bfadc5">__ao2_unlock</a></div><div class="ttdeci">int __ao2_unlock(void *a, const char *file, const char *func, int line, const char *var)</div><div class="ttdoc">Unlock an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00288">astobj2.c:288</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="devicestate_8h_html_a1ab579ae15aaca64a904c3c41d8b8b01"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a1ab579ae15aaca64a904c3c41d8b8b01">ast_devstate_prov_del</a></div><div class="ttdeci">int ast_devstate_prov_del(const char *label)</div><div class="ttdoc">Remove device state provider. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00418">devicestate.c:418</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_afd2c9505e0edcb47e18669f60500acf0"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#afd2c9505e0edcb47e18669f60500acf0">FORMAT_HDR</a></div><div class="ttdeci">#define FORMAT_HDR</div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660">ast_channel_state</a></div><div class="ttdeci">ast_channel_state</div><div class="ttdoc">ast_channel states </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00035">channelstate.h:35</a></div></div>
<div class="ttc" id="structagent__cfg_html_ad2306ec3a17979bc94169e842e87391c"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#ad2306ec3a17979bc94169e842e87391c">agent_cfg::ack_call</a></div><div class="ttdeci">int ack_call</div><div class="ttdoc">TRUE if agent needs to ack a call to accept it. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00384">app_agent_pool.c:384</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a951f3727bbc983c0b9a20bac17650c44"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a951f3727bbc983c0b9a20bac17650c44">agent_alert</a></div><div class="ttdeci">static void agent_alert(struct ast_bridge_channel *bridge_channel, const void *payload, size_t payload_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01738">app_agent_pool.c:1738</a></div></div>
<div class="ttc" id="bridge_8h_html_a4adad484788bb018b8699eeed2ddfedd"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a4adad484788bb018b8699eeed2ddfedd">ast_bridge_destroy</a></div><div class="ttdeci">int ast_bridge_destroy(struct ast_bridge *bridge, int cause)</div><div class="ttdoc">Destroy a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00970">bridge.c:970</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_a5b1a8e69c6546121e0b4dcec16be3373"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#a5b1a8e69c6546121e0b4dcec16be3373">ast_bridge_methods::dissolving</a></div><div class="ttdeci">ast_bridge_dissolving_fn dissolving</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00271">bridge.h:271</a></div></div>
<div class="ttc" id="structagent__complete_html_a89f234133d3efe315836311cbf21c64b"><div class="ttname"><a href="../../dc/d86/structagent__complete.html#a89f234133d3efe315836311cbf21c64b">agent_complete::state</a></div><div class="ttdeci">int state</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02262">app_agent_pool.c:2262</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="config__options_8h_html_af28935f8c2547723d5922ebed1c71898"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a></div><div class="ttdeci">enum aco_process_status aco_process_config(struct aco_info *info, int reload)</div><div class="ttdoc">Process a config info via the options registered with an aco_info. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00652">config_options.c:652</a></div></div>
<div class="ttc" id="test__config_8c_html_aecdc7cbd5dfa76493c0212caa55d706c"><div class="ttname"><a href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a></div><div class="ttdeci">static struct aco_type item</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/test__config_8c_source.html#l01463">test_config.c:1463</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="devicestate_8h_html_ae832fcc32c88962e73025ffeafe2961e"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#ae832fcc32c88962e73025ffeafe2961e">ast_devstate_prov_add</a></div><div class="ttdeci">int ast_devstate_prov_add(const char *label, ast_devstate_prov_cb_type callback)</div><div class="ttdoc">Add device state provider. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00391">devicestate.c:391</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="stringfields_8h_html_a061580e89c55282a7140fa3fdfd52b6d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a></div><div class="ttdeci">#define AST_DECLARE_STRING_FIELDS(field_list)</div><div class="ttdoc">Declare the fields needed in a structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00337">stringfields.h:337</a></div></div>
<div class="ttc" id="structagent__cfg_html"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html">agent_cfg</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00348">app_agent_pool.c:348</a></div></div>
<div class="ttc" id="structagent__complete_html_aa2a4dae2a14de4093826005f9bdfd3bb"><div class="ttname"><a href="../../dc/d86/structagent__complete.html#aa2a4dae2a14de4093826005f9bdfd3bb">agent_complete::which</a></div><div class="ttdeci">int which</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02264">app_agent_pool.c:2264</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a5975e0ec066ec59aaca8d2e01989ac7b"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a5975e0ec066ec59aaca8d2e01989ac7b">agent_handle_show_all</a></div><div class="ttdeci">static char * agent_handle_show_all(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02404">app_agent_pool.c:2404</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ae014c66309327185b609d7e3ccf21af5"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ae014c66309327185b609d7e3ccf21af5">ast_bridge_channel_write_callback</a></div><div class="ttdeci">int ast_bridge_channel_write_callback(struct ast_bridge_channel *bridge_channel, enum ast_bridge_channel_custom_callback_option flags, ast_bridge_custom_callback_fn callback, const void *payload, size_t payload_size)</div><div class="ttdoc">Write a bridge action custom callback frame into the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01484">bridge_channel.c:1484</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga77315fa8e29950f0c88120501acda0a3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a></div><div class="ttdeci">void astman_send_ack(struct mansession *s, const struct message *m, char *msg)</div><div class="ttdoc">Send ack in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03191">manager.c:3191</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00042">channelstate.h:42</a></div></div>
<div class="ttc" id="utils_8h_html_ab9da1c7265610eff83ed6146f104dc6f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ab9da1c7265610eff83ed6146f104dc6f">ast_copy_flags</a></div><div class="ttdeci">#define ast_copy_flags(dest, src, flagz)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00084">utils.h:84</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="channel_8h_html_a40fc421536e02d30fecaa51a255b4144"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a40fc421536e02d30fecaa51a255b4144">ast_party_connected_line_free</a></div><div class="ttdeci">void ast_party_connected_line_free(struct ast_party_connected_line *doomed)</div><div class="ttdoc">Destroy the connected line information contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02072">channel.c:2072</a></div></div>
<div class="ttc" id="bridge__roles_8h_html_a8511ad15a10f0b6269094ad307ba17a2"><div class="ttname"><a href="../../dd/dff/bridge__roles_8h.html#a8511ad15a10f0b6269094ad307ba17a2">ast_channel_add_bridge_role</a></div><div class="ttdeci">int ast_channel_add_bridge_role(struct ast_channel *chan, const char *role_name)</div><div class="ttdoc">Adds a bridge role to a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d13/bridge__roles_8c_source.html#l00317">bridge_roles.c:317</a></div></div>
<div class="ttc" id="test__func__file_8c_html_a7df83d295429a2562396f1ec127a46c0"><div class="ttname"><a href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a></div><div class="ttdeci">const char * args</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/test__func__file_8c_source.html#l00046">test_func_file.c:46</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__channel_html_a8f64897c7ccc5c13f276d1d07c4e7095"><div class="ttname"><a href="../../df/d3c/structast__channel.html#a8f64897c7ccc5c13f276d1d07c4e7095">ast_channel::data</a></div><div class="ttdeci">const char * data</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00083">channel_internal_api.c:83</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a32d9fcd6bfb0ed9371e6dbae8a994bda"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a32d9fcd6bfb0ed9371e6dbae8a994bda">agent_pvt_sort_cmp</a></div><div class="ttdeci">static int agent_pvt_sort_cmp(const void *obj_left, const void *obj_right, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00820">app_agent_pool.c:820</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_adc4d1d983728ada524c84213c2536921"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#adc4d1d983728ada524c84213c2536921">agent_holding_lock</a></div><div class="ttdeci">static ast_mutex_t agent_holding_lock</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01003">app_agent_pool.c:1003</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a69864377e8f1cf05ba95f1645bc98c65"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a69864377e8f1cf05ba95f1645bc98c65">ast_bridge_channel_feature_digit</a></div><div class="ttdeci">void ast_bridge_channel_feature_digit(struct ast_bridge_channel *bridge_channel, int digit)</div><div class="ttdoc">Add a DTMF digit to the collected digits to match against DTMF features. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01762">bridge_channel.c:1762</a></div></div>
<div class="ttc" id="structaco__file_html"><div class="ttname"><a href="../../d9/d9c/structaco__file.html">aco_file</a></div><div class="ttdoc">The representation of a single configuration file to be processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00161">config_options.h:161</a></div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="bridge__roles_8h_html_ad449a795348a52aefe000f13a1d015f8"><div class="ttname"><a href="../../dd/dff/bridge__roles_8h.html#ad449a795348a52aefe000f13a1d015f8">ast_bridge_channel_establish_roles</a></div><div class="ttdeci">int ast_bridge_channel_establish_roles(struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Clone the roles from a bridge_channel&amp;#39;s attached ast_channel onto the bridge_channel&amp;#39;s role list...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d13/bridge__roles_8c_source.html#l00447">bridge_roles.c:447</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a411218cf4d743baa73c2def8f024cb23a7d9b9e7c20920a163afd3009c21a0e77"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a411218cf4d743baa73c2def8f024cb23a7d9b9e7c20920a163afd3009c21a0e77">AST_BRIDGE_CHANNEL_CB_OPTION_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00616">bridge_channel.h:616</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7ad1708425f2412aa1cd0604a8e4a990d2">AGENT_STATE_LOGGING_OUT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00582">app_agent_pool.c:582</a></div></div>
<div class="ttc" id="bridge_8h_html_a815c9b3e933dfd4b8f523cf55caa5bbfaff2606e446a3b7e22fb3785a06110554"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a815c9b3e933dfd4b8f523cf55caa5bbfaff2606e446a3b7e22fb3785a06110554">AST_BRIDGE_CAPABILITY_HOLDING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00086">bridge.h:86</a></div></div>
<div class="ttc" id="astobj2_8h_html_a4e9f309cb90824e22969f0cf1b5b445da1381af5f17622000f344130ef673987b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a4e9f309cb90824e22969f0cf1b5b445da1381af5f17622000f344130ef673987b">AO2_LOCK_REQ_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00703">astobj2.h:703</a></div></div>
<div class="ttc" id="module_8h_html_ad2ca15621101154f29748cf1dac3c3cf"><div class="ttname"><a href="../../d5/d16/module_8h.html#ad2ca15621101154f29748cf1dac3c3cf">ast_unregister_application</a></div><div class="ttdeci">int ast_unregister_application(const char *app)</div><div class="ttdoc">Unregister an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/pbx__app_8c_source.html#l00392">pbx_app.c:392</a></div></div>
<div class="ttc" id="structaco__type_html_a41ea490a42392545d2f6e2c6888cd94e"><div class="ttname"><a href="../../de/d71/structaco__type.html#a41ea490a42392545d2f6e2c6888cd94e">aco_type::type</a></div><div class="ttdeci">enum aco_type_t type</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00123">config_options.h:123</a></div></div>
<div class="ttc" id="config__options_8h_html_af773eedd7f94d718752798605c687c4b"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#af773eedd7f94d718752798605c687c4b">ACO_TYPES</a></div><div class="ttdeci">#define ACO_TYPES(...)</div><div class="ttdoc">A helper macro to ensure that aco_info types always have a sentinel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00181">config_options.h:181</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a866e05c6b083030e9757cfb37814e671"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a866e05c6b083030e9757cfb37814e671">ast_bridge_set_after_callback</a></div><div class="ttdeci">int ast_bridge_set_after_callback(struct ast_channel *chan, ast_bridge_after_cb callback, ast_bridge_after_cb_failed failed, void *data)</div><div class="ttdoc">Setup an after bridge callback for when the channel leaves the bridging system. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/db6/bridge__after_8c_source.html#l00259">bridge_after.c:259</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga7f4919ce97dcdee0a98979ca4de29242"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga7f4919ce97dcdee0a98979ca4de29242">ast_channel_snapshot_create</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_create(struct ast_channel *chan)</div><div class="ttdoc">Generate a snapshot of the channel state. This is an ao2 object, so ao2_cleanup() to deallocate...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00451">stasis_channels.c:451</a></div></div>
<div class="ttc" id="pbx_8h_html_a965977ea9a3144bc203e0ce7a64680a1"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a></div><div class="ttdeci">int ast_custom_function_unregister(struct ast_custom_function *acf)</div><div class="ttdoc">Unregister a custom function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d70/pbx__functions_8c_source.html#l00273">pbx_functions.c:273</a></div></div>
<div class="ttc" id="pbx_8h_html_a98c5425b90ec7c5e136a40f529170b1b"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a></div><div class="ttdeci">const char * pbx_builtin_getvar_helper(struct ast_channel *chan, const char *name)</div><div class="ttdoc">Return a pointer to the value of the corresponding channel variable. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01000">pbx_variables.c:1000</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a4fe7571e3c1759f3689d4453c132bdb7"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a4fe7571e3c1759f3689d4453c132bdb7">ast_bridge_channel::bridge</a></div><div class="ttdeci">struct ast_bridge * bridge</div><div class="ttdoc">Bridge this channel is participating in. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00100">bridge_channel.h:100</a></div></div>
<div class="ttc" id="stringfields_8h_html"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html">stringfields.h</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab0b4e11aba1e0a898b5d75427d3b13fa"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab0b4e11aba1e0a898b5d75427d3b13fa">OBJ_PARTIAL_KEY</a></div><div class="ttdeci">#define OBJ_PARTIAL_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01156">astobj2.h:1156</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Get header from mananger transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="bridge_8h_html_a5a2fef16c6520d265d7f81002eb96ee7"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a5a2fef16c6520d265d7f81002eb96ee7">ast_bridge_base_v_table</a></div><div class="ttdeci">struct ast_bridge_methods ast_bridge_base_v_table</div><div class="ttdoc">Bridge base class virtual method table. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00949">bridge.c:949</a></div></div>
<div class="ttc" id="channel_8h_html_aaced431562223538a94e0e69cf94151a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a></div><div class="ttdeci">struct ast_format * ast_channel_readformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00856">channel_internal_api.c:856</a></div></div>
<div class="ttc" id="structagent__cfg_html_a7e4d44394d3f9e352012ab905cac069e"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#a7e4d44394d3f9e352012ab905cac069e">agent_cfg::dtmf_accept</a></div><div class="ttdeci">const ast_string_field dtmf_accept</div><div class="ttdoc">DTMF string for an agent to accept a call. * *. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00365">app_agent_pool.c:365</a></div></div>
<div class="ttc" id="structagent__pvt_html_a6b2557c443982571cceb9005c5bec611"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a6b2557c443982571cceb9005c5bec611">agent_pvt::caller_bridge</a></div><div class="ttdeci">struct ast_bridge * caller_bridge</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00641">app_agent_pool.c:641</a></div></div>
<div class="ttc" id="config__options_8h_html_a840871f014617f5415dacb9a7d32a59bab3719e39fd87c376c6f143e337f73e12"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a840871f014617f5415dacb9a7d32a59bab3719e39fd87c376c6f143e337f73e12">ACO_GLOBAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00041">config_options.h:41</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_adcc9e89f7dbd8c807535fbced0f99287"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#adcc9e89f7dbd8c807535fbced0f99287">agent_handle_show_online</a></div><div class="ttdeci">static char * agent_handle_show_online(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02382">app_agent_pool.c:2382</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a520a3c6b7d57903d9a616051da1a019d"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a520a3c6b7d57903d9a616051da1a019d">AST_APP_OPTIONS</a></div><div class="ttdeci">#define AST_APP_OPTIONS(holder, options...)</div><div class="ttdoc">Declares an array of options for an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01393">include/asterisk/app.h:1393</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a67c95428c333ffc3b0f5950e3b3cf532">AGENT_STATE_CALL_PRESENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00574">app_agent_pool.c:574</a></div></div>
<div class="ttc" id="bridge__after_8h_html_a1b15a371c654cfe77de053afe0994b9c"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html#a1b15a371c654cfe77de053afe0994b9c">ast_bridge_after_cb_reason</a></div><div class="ttdeci">ast_bridge_after_cb_reason</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d85/bridge__after_8h_source.html#l00037">bridge_after.h:37</a></div></div>
<div class="ttc" id="bridge__roles_8h_html_a3c1bc5238aea4e2d19c9894c1b68a457"><div class="ttname"><a href="../../dd/dff/bridge__roles_8h.html#a3c1bc5238aea4e2d19c9894c1b68a457">ast_channel_set_bridge_role_option</a></div><div class="ttdeci">int ast_channel_set_bridge_role_option(struct ast_channel *channel, const char *role_name, const char *option, const char *value)</div><div class="ttdoc">Set a role option on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d13/bridge__roles_8c_source.html#l00379">bridge_roles.c:379</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_acf1606296839a7252342273de8f9f563"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#acf1606296839a7252342273de8f9f563">agent_function_read</a></div><div class="ttdeci">static int agent_function_read(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02184">app_agent_pool.c:2184</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="structagent__pvt_html_a1b46e6ee7b5c070d8ec3b45f5bc49a92"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a1b46e6ee7b5c070d8ec3b45f5bc49a92">agent_pvt::devstate</a></div><div class="ttdeci">enum ast_device_state devstate</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00627">app_agent_pool.c:627</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae896354e27dbb9fd8ece2a88f4d88d0d"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae896354e27dbb9fd8ece2a88f4d88d0d">agent_login_channel_config</a></div><div class="ttdeci">static void agent_login_channel_config(struct agent_pvt *agent, struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02040">app_agent_pool.c:2040</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a33214b7c3d67d8ea8652269fc5afb0d0"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a33214b7c3d67d8ea8652269fc5afb0d0">caller_joined_bridge</a></div><div class="ttdeci">static int caller_joined_bridge(struct ast_bridge_channel *bridge_channel, void *hook_pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01847">app_agent_pool.c:1847</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a34d3e99d5529e36506d0ee8a9982c281"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a34d3e99d5529e36506d0ee8a9982c281">AST_MAX_BUF</a></div><div class="ttdeci">#define AST_MAX_BUF</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00336">app_agent_pool.c:336</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aad1cee1e03f1e1c5ad4067940fdab5b0"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aad1cee1e03f1e1c5ad4067940fdab5b0">agent_lock</a></div><div class="ttdeci">#define agent_lock(agent)</div><div class="ttdoc">Lock the agent. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00658">app_agent_pool.c:658</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html">features_config.h</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a32da61f3d1a1faa6ae5211f81eb52341"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a32da61f3d1a1faa6ae5211f81eb52341">send_colp_to_agent</a></div><div class="ttdeci">static int send_colp_to_agent(struct ast_bridge_channel *bridge_channel, struct ast_party_connected_line *connected)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01818">app_agent_pool.c:1818</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_aa467e25606c2a21df25c61f139007782"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#aa467e25606c2a21df25c61f139007782">ast_bridge_channel_lock</a></div><div class="ttdeci">#define ast_bridge_channel_lock(bridge_channel)</div><div class="ttdoc">Lock the bridge_channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00231">bridge_channel.h:231</a></div></div>
<div class="ttc" id="devicestate_8h_html_a62a8e6bc4b82dd797e505688f9f29bff"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a62a8e6bc4b82dd797e505688f9f29bff">ast_devstate_changed</a></div><div class="ttdeci">int ast_devstate_changed(enum ast_device_state state, enum ast_devstate_cache cachable, const char *fmt,...)</div><div class="ttdoc">Tells Asterisk the State for Device is changed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00510">devicestate.c:510</a></div></div>
<div class="ttc" id="config__options_8h_html_a3f40a7cffea07c21a21faaee64d24398"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3f40a7cffea07c21a21faaee64d24398">aco_info_init</a></div><div class="ttdeci">int aco_info_init(struct aco_info *info)</div><div class="ttdoc">Initialize an aco_info structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00877">config_options.c:877</a></div></div>
<div class="ttc" id="channel_8h_html"><div class="ttname"><a href="../../d5/d7b/channel_8h.html">channel.h</a></div><div class="ttdoc">General Asterisk PBX channel definitions. </div></div>
<div class="ttc" id="module_8h_html_a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223"><div class="ttname"><a href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00317">module.h:317</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7a805e16634a569c003ec65f9a063402b0"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a805e16634a569c003ec65f9a063402b0">AGENT_STATE_PROBATION_WAIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00570">app_agent_pool.c:570</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a392237b28b1ee658981b450fcf3fe363"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a392237b28b1ee658981b450fcf3fe363">agent_request_exec</a></div><div class="ttdeci">static int agent_request_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">Dialplan AgentRequest application to locate an agent to talk with. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01889">app_agent_pool.c:1889</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_acda8801e5f7029b4afec1a19ecae16b2"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#acda8801e5f7029b4afec1a19ecae16b2">agents_post_apply_config</a></div><div class="ttdeci">static void agents_post_apply_config(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00935">app_agent_pool.c:935</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_afb0201bc573414e692523e87814100f9"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#afb0201bc573414e692523e87814100f9">clear_agent_status</a></div><div class="ttdeci">static void clear_agent_status(struct ast_bridge_channel *bridge_channel, const void *payload, size_t payload_size)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01017">app_agent_pool.c:1017</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a019a75c8729b63787919b2e67331c84f">OPT_UINT_T</a></div><div class="ttdoc">Type for default option handler for unsigned integers. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00459">config_options.h:459</a></div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444addba5f50cfec4a78d22c0479fbd5ac77">AST_BRIDGE_FLAG_MERGE_INHIBIT_FROM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00043">bridge_features.h:43</a></div></div>
<div class="ttc" id="channel_8h_html_a10f23f1907b804485f62973f66cd9aef"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a10f23f1907b804485f62973f66cd9aef">ast_channel_connected</a></div><div class="ttdeci">struct ast_party_connected_line * ast_channel_connected(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00892">channel_internal_api.c:892</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ad7efec5e491195982d97dbb426026cfc"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ad7efec5e491195982d97dbb426026cfc">agent_mark</a></div><div class="ttdeci">static int agent_mark(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00874">app_agent_pool.c:874</a></div></div>
<div class="ttc" id="structast__cli__args_html_acfc02ec89670db29251fda6a66602ce2"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acfc02ec89670db29251fda6a66602ce2">ast_cli_args::n</a></div><div class="ttdeci">const int n</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00165">cli.h:165</a></div></div>
<div class="ttc" id="structast__custom__function_html"><div class="ttname"><a href="../../db/dc0/structast__custom__function.html">ast_custom_function</a></div><div class="ttdoc">Data structure associated with a custom dialplan function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00118">pbx.h:118</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a4e0c76b6d740600bf9e322b87d04dfb4"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a4e0c76b6d740600bf9e322b87d04dfb4">agent_show_requested</a></div><div class="ttdeci">static void agent_show_requested(struct ast_cli_args *a, int online_only)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02327">app_agent_pool.c:2327</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea41983b6678528bfcdf919b24d6e08d9a">AST_DEVICE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00053">devicestate.h:53</a></div></div>
<div class="ttc" id="astobj2_8h_html"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html">astobj2.h</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_abcb60ae8dded463f56a7c35857f1e501a9c6a0359498684912cb0a3810e03138d"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#abcb60ae8dded463f56a7c35857f1e501a9c6a0359498684912cb0a3810e03138d">OPT_SILENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02097">app_agent_pool.c:2097</a></div></div>
<div class="ttc" id="causes_8h_html_af2235eb1c27925e4020ce286255d165f"><div class="ttname"><a href="../../d4/da3/causes_8h.html#af2235eb1c27925e4020ce286255d165f">AST_CAUSE_NORMAL_CLEARING</a></div><div class="ttdeci">#define AST_CAUSE_NORMAL_CLEARING</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00105">causes.h:105</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ad63565be83f2a9e10382f7adb483965c"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ad63565be83f2a9e10382f7adb483965c">agent_pvt_cmp</a></div><div class="ttdeci">static int agent_pvt_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00852">app_agent_pool.c:852</a></div></div>
<div class="ttc" id="stringfields_8h_html_a51b5729220efb7cda4393ed35ecdfea2"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a></div><div class="ttdeci">#define AST_STRING_FIELD(name)</div><div class="ttdoc">Declare a string field. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00299">stringfields.h:299</a></div></div>
<div class="ttc" id="structagent__pvt_html_a5804ef809b93820d3437a86e08126bd8"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a5804ef809b93820d3437a86e08126bd8">agent_pvt::username</a></div><div class="ttdeci">const ast_string_field username</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00600">app_agent_pool.c:600</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a5485fc780d3e0cce2d98b85aad2c846c"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a5485fc780d3e0cce2d98b85aad2c846c">agent_handle_logoff_cmd</a></div><div class="ttdeci">static char * agent_handle_logoff_cmd(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02485">app_agent_pool.c:2485</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="channel_8h_html_ac2d6607253f7e8b272d4e845474eaa9b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac2d6607253f7e8b272d4e845474eaa9b">ast_softhangup</a></div><div class="ttdeci">int ast_softhangup(struct ast_channel *chan, int reason)</div><div class="ttdoc">Softly hangup up a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02476">channel.c:2476</a></div></div>
<div class="ttc" id="structmansession_html"><div class="ttname"><a href="../../d2/d8a/structmansession.html">mansession</a></div><div class="ttdoc">In case you didn&amp;#39;t read that giant block of text above the mansession_session struct, the struct mansession is named this solely to keep the API the same in Asterisk. This structure really represents data that is different from Manager action to Manager action. The mansession_session pointer contained within points to session-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01625">manager.c:1625</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_abcc455cab3ad2f3eeda4797611d1c0ed"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#abcc455cab3ad2f3eeda4797611d1c0ed">_agent_lock</a></div><div class="ttdeci">static void _agent_lock(struct agent_pvt *agent, const char *file, const char *function, int line, const char *var)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00659">app_agent_pool.c:659</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a7a4b299b4cb4bf7c644235d708847fc3"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a7a4b299b4cb4bf7c644235d708847fc3">AST_BRIDGE_FLAG_TRANSFER_PROHIBITED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00053">bridge_features.h:53</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a55ac80086debb254e9d1f21d210e3705"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a55ac80086debb254e9d1f21d210e3705">agent_lock_logged</a></div><div class="ttdeci">static struct ast_channel * agent_lock_logged(struct agent_pvt *agent)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00690">app_agent_pool.c:690</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a1578ec878aa2014f6550270ad1468f94"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a1578ec878aa2014f6550270ad1468f94">bridge_agent_hold_heartbeat</a></div><div class="ttdeci">static int bridge_agent_hold_heartbeat(struct ast_bridge_channel *bridge_channel, void *hook_pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01103">app_agent_pool.c:1103</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a3e9bdb7b62b531f001b7dcb5c39b3551"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a3e9bdb7b62b531f001b7dcb5c39b3551">ast_bridge_interval_hook</a></div><div class="ttdeci">int ast_bridge_interval_hook(struct ast_bridge_features *features, enum ast_bridge_hook_timer_option flags, unsigned int interval, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach an interval hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03382">bridge.c:3382</a></div></div>
<div class="ttc" id="structagent__cfg_html_aa068f603d067b1a7c92db68e5b27256b"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#aa068f603d067b1a7c92db68e5b27256b">agent_cfg::auto_logoff</a></div><div class="ttdeci">unsigned int auto_logoff</div><div class="ttdoc">Number of seconds for agent to ack a call before being logged off. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00372">app_agent_pool.c:372</a></div></div>
<div class="ttc" id="structaco__type_html_a838022f0c17b1545f08798016578f2ec"><div class="ttname"><a href="../../de/d71/structaco__type.html#a838022f0c17b1545f08798016578f2ec">aco_type::item_alloc</a></div><div class="ttdeci">aco_type_item_alloc item_alloc</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00134">config_options.h:134</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga03332d35946786d0689462e58d01467a"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga03332d35946786d0689462e58d01467a">ast_channel_agent_login_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_agent_login_type(void)</div><div class="ttdoc">Message type for agent login on a channel. </div></div>
<div class="ttc" id="bridge__internal_8h_html_adf0e64783980f762008ac238f2dbe715"><div class="ttname"><a href="../../d5/dde/bridge__internal_8h.html#adf0e64783980f762008ac238f2dbe715">bridge_alloc</a></div><div class="ttdeci">struct ast_bridge * bridge_alloc(size_t size, const struct ast_bridge_methods *v_table)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00724">bridge.c:724</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga55d6d1e96f8f003200274d8756a9398a"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga55d6d1e96f8f003200274d8756a9398a">ast_channel_agent_logoff_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_agent_logoff_type(void)</div><div class="ttdoc">Message type for agent logoff on a channel. </div></div>
<div class="ttc" id="app__agent__pool_8c_html_a72c28e8d8b5bf63d00102468e6ac4907"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a72c28e8d8b5bf63d00102468e6ac4907">general_type</a></div><div class="ttdeci">static struct aco_type general_type</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00478">app_agent_pool.c:478</a></div></div>
<div class="ttc" id="manager_8h_html_a777cde87d12b331902f862ec44641688"><div class="ttname"><a href="../../db/d45/manager_8h.html#a777cde87d12b331902f862ec44641688">ast_manager_build_channel_state_string</a></div><div class="ttdeci">struct ast_str * ast_manager_build_channel_state_string(const struct ast_channel_snapshot *snapshot)</div><div class="ttdoc">Generate the AMI message body from a channel snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1c/manager__channels_8c_source.html#l00561">manager_channels.c:561</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_af40039f1c49c16d0f6fa33fe9c43a0cb"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#af40039f1c49c16d0f6fa33fe9c43a0cb">ast_app_parse_options</a></div><div class="ttdeci">int ast_app_parse_options(const struct ast_app_option *options, struct ast_flags *flags, char **args, char *optstr)</div><div class="ttdoc">Parses a string containing application options and sets flags/arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l02906">main/app.c:2906</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aeaea7aa68d00de5f86fcc523d6f2c55a"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aeaea7aa68d00de5f86fcc523d6f2c55a">agent_logout</a></div><div class="ttdeci">static void agent_logout(struct agent_pvt *agent)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01481">app_agent_pool.c:1481</a></div></div>
<div class="ttc" id="pbx_8h_html"><div class="ttname"><a href="../../db/de0/pbx_8h.html">pbx.h</a></div><div class="ttdoc">Core PBX routines and definitions. </div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeeadee91fc4886ffc7b4efb8459cef48fe2">AST_DEVICE_NOT_INUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00054">devicestate.h:54</a></div></div>
<div class="ttc" id="channel_8h_html_a9c63fff1d736568d1ee332dd7ea502bd"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9c63fff1d736568d1ee332dd7ea502bd">ast_check_hangup</a></div><div class="ttdeci">int ast_check_hangup(struct ast_channel *chan)</div><div class="ttdoc">Check to see if a channel is needing hang up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00445">channel.c:445</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aba0c7c74e5144e318659f810dbc6d5e8"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aba0c7c74e5144e318659f810dbc6d5e8">agent_override_flags</a></div><div class="ttdeci">agent_override_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00586">app_agent_pool.c:586</a></div></div>
<div class="ttc" id="bridge__internal_8h_html_a38c501242153bbe13d0eda31220637b8"><div class="ttname"><a href="../../d5/dde/bridge__internal_8h.html#a38c501242153bbe13d0eda31220637b8">bridge_base_init</a></div><div class="ttdeci">struct ast_bridge * bridge_base_init(struct ast_bridge *self, uint32_t capabilities, unsigned int flags, const char *creator, const char *name, const char *id)</div><div class="ttdoc">Initialize the base class of the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00760">bridge.c:760</a></div></div>
<div class="ttc" id="config__options_8h_html_a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a></div><div class="ttdoc">Their was an error and no changes were applied. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00527">config_options.h:527</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="devicestate_8h_html_a6190de57ac370315e51f2c46724d5b10"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a6190de57ac370315e51f2c46724d5b10">ast_devstate_str</a></div><div class="ttdeci">const char * ast_devstate_str(enum ast_device_state devstate) attribute_pure</div><div class="ttdoc">Convert device state to text string that is easier to parse. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d80/devicestate_8c_source.html#l00255">devicestate.c:255</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_a483cd10a0ddcca5814298bdb4f153878"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a483cd10a0ddcca5814298bdb4f153878">ast_bridge_channel_unlock</a></div><div class="ttdeci">#define ast_bridge_channel_unlock(bridge_channel)</div><div class="ttdoc">Unlock the bridge_channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00244">bridge_channel.h:244</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gafadf012f66a9fd7ecf985ec5b9dee101"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a></div><div class="ttdeci">int ast_manager_unregister(const char *action)</div><div class="ttdoc">Unregister a registered manager command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07258">manager.c:7258</a></div></div>
<div class="ttc" id="structagent__pvt_html_adf899cd6660bd07520ca4bc6f04211ee"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#adf899cd6660bd07520ca4bc6f04211ee">agent_pvt::cfg</a></div><div class="ttdeci">struct agent_cfg * cfg</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00645">app_agent_pool.c:645</a></div></div>
<div class="ttc" id="config__options_8h_html"><div class="ttname"><a href="../../db/dfe/config__options_8h.html">config_options.h</a></div><div class="ttdoc">Configuration option-handling. </div></div>
<div class="ttc" id="structast__bridge_html"><div class="ttname"><a href="../../d4/d84/structast__bridge.html">ast_bridge</a></div><div class="ttdoc">Structure that contains information about a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00357">bridge.h:357</a></div></div>
<div class="ttc" id="structagent__cfg_html_ad0596714447eb76c79d0291db700cbcd"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#ad0596714447eb76c79d0291db700cbcd">agent_cfg::wrapup_time</a></div><div class="ttdeci">unsigned int wrapup_time</div><div class="ttdoc">Time after a call in ms before the agent can get a new call. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00378">app_agent_pool.c:378</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ab44a00c2c23eaeec1d8b61eb254eecaaaf0e5994fd47d241360d94f7da1adf326">BRIDGE_CHANNEL_STATE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00064">bridge_channel.h:64</a></div></div>
<div class="ttc" id="strings_8h_html_a387a69b3871ca31061566a73f45d20f4"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a></div><div class="ttdeci">int attribute_pure ast_true(const char *val)</div><div class="ttdoc">Make sure something is true. Determine if a string containing a boolean value is &quot;true&quot;. This function checks to see whether a string passed to it is an indication of an &quot;true&quot; value. It checks to see if the string is &quot;yes&quot;, &quot;true&quot;, &quot;y&quot;, &quot;t&quot;, &quot;on&quot; or &quot;1&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01951">main/utils.c:1951</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae637f8fbe936d377d08099c192d5414f"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae637f8fbe936d377d08099c192d5414f">bridge_agent_hold_pull</a></div><div class="ttdeci">static void bridge_agent_hold_pull(struct ast_bridge *self, struct ast_bridge_channel *bridge_channel)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01369">app_agent_pool.c:1369</a></div></div>
<div class="ttc" id="structagent__pvt_html_acd6bb3b5d452161627e0c4b204977401"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#acd6bb3b5d452161627e0c4b204977401">agent_pvt::login_start</a></div><div class="ttdeci">time_t login_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00630">app_agent_pool.c:630</a></div></div>
<div class="ttc" id="structagent__pvt_html"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html">agent_pvt</a></div><div class="ttdoc">Structure representing an agent. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00594">app_agent_pool.c:594</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea23aa227468c09b5ebd0fb01b4c895190">AST_DEVICE_INUSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00055">devicestate.h:55</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="config__options_8h_html_a21b11339ca4d0b1167c956a9f816bd19"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a21b11339ca4d0b1167c956a9f816bd19">aco_info_destroy</a></div><div class="ttdeci">void aco_info_destroy(struct aco_info *info)</div><div class="ttdoc">Destroy an initialized aco_info struct. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00910">config_options.c:910</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390ac976c01c12ae70e36b99b16dbfa3dda7">AST_CONTROL_CONNECTED_LINE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00299">include/asterisk/frame.h:299</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ad09fa931f468002152a3cc2d5ce25eae"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a></div><div class="ttdeci">static int unload_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02624">app_agent_pool.c:2624</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac0e1cbc7cf050c8b7b8e3a8fee92c50e"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a></div><div class="ttdeci">#define ao2_global_obj_release(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00865">astobj2.h:865</a></div></div>
<div class="ttc" id="file_8h_html_abb7bdff3c549191072878402b0a0ca9c"><div class="ttname"><a href="../../d2/d4d/file_8h.html#abb7bdff3c549191072878402b0a0ca9c">AST_DIGIT_NONE</a></div><div class="ttdeci">#define AST_DIGIT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/file_8h_source.html#l00047">file.h:47</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144a5cb849face8441c434d1a2f60264cedb">OPT_BOOL_T</a></div><div class="ttdoc">Type for default option handler for bools (ast_true/ast_false) </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00294">config_options.h:294</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_accfcb380df76a64251d88ef49c2dd4e3"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#accfcb380df76a64251d88ef49c2dd4e3">AST_NONSTANDARD_APP_ARGS</a></div><div class="ttdeci">#define AST_NONSTANDARD_APP_ARGS(args, parse, sep)</div><div class="ttdoc">Performs the &amp;#39;nonstandard&amp;#39; argument separation process for an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01300">include/asterisk/app.h:1300</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structagent__pvt_html_a41ef42b3f54f9920060abbedc977fea9"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a41ef42b3f54f9920060abbedc977fea9">agent_pvt::last_disconnect</a></div><div class="ttdeci">struct timeval last_disconnect</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00638">app_agent_pool.c:638</a></div></div>
<div class="ttc" id="astobj2_8h_html_a63fd831fe48aed32d3ef992ad8e45293"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a></div><div class="ttdeci">#define ao2_callback_data(container, flags, cb_fn, arg, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01743">astobj2.h:1743</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aab6ab498f59aece6e53aa7102c0077e2"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aab6ab498f59aece6e53aa7102c0077e2">caller_abort_agent</a></div><div class="ttdeci">static void caller_abort_agent(struct agent_pvt *agent)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01696">app_agent_pool.c:1696</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aa54a01cf670832c6ad6fe44fc9bc20bb"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aa54a01cf670832c6ad6fe44fc9bc20bb">complete_agent_logoff_search</a></div><div class="ttdeci">static int complete_agent_logoff_search(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02295">app_agent_pool.c:2295</a></div></div>
<div class="ttc" id="structast__party__connected__line_html"><div class="ttname"><a href="../../dc/d9e/structast__party__connected__line.html">ast_party_connected_line</a></div><div class="ttdoc">Connected Line/Party information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00457">channel.h:457</a></div></div>
<div class="ttc" id="manager_8h_html_acd32bc0b58b87cc22c60ffff79496c7f"><div class="ttname"><a href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a></div><div class="ttdeci">#define EVENT_FLAG_AGENT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00076">manager.h:76</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a0c9069d554e6ace86b060a06c56d2ba3"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a0c9069d554e6ace86b060a06c56d2ba3">action_agents</a></div><div class="ttdeci">static int action_agents(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02527">app_agent_pool.c:2527</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a3bc870eb2da8463a4fb53bf2fee5bdf4"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a3bc870eb2da8463a4fb53bf2fee5bdf4">agents_cfg_destructor</a></div><div class="ttdeci">static void agents_cfg_destructor(void *vdoomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00492">app_agent_pool.c:492</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ad58d921ec1c5a6f12be8f94327dd98c0"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ad58d921ec1c5a6f12be8f94327dd98c0">ast_bridge_channel_leave_bridge</a></div><div class="ttdeci">void ast_bridge_channel_leave_bridge(struct ast_bridge_channel *bridge_channel, enum bridge_channel_state new_state, int cause)</div><div class="ttdoc">Set bridge channel state to leave bridge (if not leaving already). </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00314">bridge_channel.c:314</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a6a5ecab02628d53e614a259d45b1d520"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a6a5ecab02628d53e614a259d45b1d520">agent_cfg_destructor</a></div><div class="ttdeci">static void agent_cfg_destructor(void *vdoomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00427">app_agent_pool.c:427</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a6c861b7f9ac3693f06669b575dc6e16b"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a6c861b7f9ac3693f06669b575dc6e16b">bridge_agent_hold_deferred_create</a></div><div class="ttdeci">static int bridge_agent_hold_deferred_create(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01419">app_agent_pool.c:1419</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_ad7de2a71d5af8f85035713f1f3cb69a9"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#ad7de2a71d5af8f85035713f1f3cb69a9">ast_bridge_channel_queue_callback</a></div><div class="ttdeci">int ast_bridge_channel_queue_callback(struct ast_bridge_channel *bridge_channel, enum ast_bridge_channel_custom_callback_option flags, ast_bridge_custom_callback_fn callback, const void *payload, size_t payload_size)</div><div class="ttdoc">Queue a bridge action custom callback frame onto the bridge channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01492">bridge_channel.c:1492</a></div></div>
<div class="ttc" id="structagent__cfg_html_a6c0ebcc78965d8817651856e7914631d"><div class="ttname"><a href="../../d4/d01/structagent__cfg.html#a6c0ebcc78965d8817651856e7914631d">agent_cfg::moh</a></div><div class="ttdeci">const ast_string_field moh</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00365">app_agent_pool.c:365</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a542b526fd6c81c6193101dfbe970c2be"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a542b526fd6c81c6193101dfbe970c2be">destroy_config</a></div><div class="ttdeci">static void destroy_config(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00537">app_agent_pool.c:537</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a46a46dbbf30cbb25031b5276fc7e3d98"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a46a46dbbf30cbb25031b5276fc7e3d98">agent_sweep</a></div><div class="ttdeci">static int agent_sweep(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00889">app_agent_pool.c:889</a></div></div>
<div class="ttc" id="structast__bridge__methods_html"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html">ast_bridge_methods</a></div><div class="ttdoc">Bridge virtual methods table definition. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00265">bridge.h:265</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="bridge_8h_html_a0fb66f4741ca8d106af1917a2f1aab6e"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a0fb66f4741ca8d106af1917a2f1aab6e">ast_bridge_unlock</a></div><div class="ttdeci">#define ast_bridge_unlock(bridge)</div><div class="ttdoc">Unlock the bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00493">bridge.h:493</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a2b53789591de3558859d20a0800a9eda"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a2b53789591de3558859d20a0800a9eda">AO2_GLOBAL_OBJ_STATIC</a></div><div class="ttdeci">static AO2_GLOBAL_OBJ_STATIC(cfg_handle)</div></div>
<div class="ttc" id="app__agent__pool_8c_html_a383a6ddb87cd8afb52a9ade91d706ba9"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a383a6ddb87cd8afb52a9ade91d706ba9">agent_type_blacklist</a></div><div class="ttdeci">static const char * agent_type_blacklist[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00459">app_agent_pool.c:459</a></div></div>
<div class="ttc" id="structast__bridge__features__automixmonitor_html"><div class="ttname"><a href="../../d7/d41/structast__bridge__features__automixmonitor.html">ast_bridge_features_automixmonitor</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00324">bridge_features.h:324</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a2e006acff60d9b3d65d7d60f975d6747"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a></div><div class="ttdeci">static void parse(struct mgcp_request *req)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l01872">chan_mgcp.c:1872</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ac543f4a511c682ff550c23f1c8f7870c"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ac543f4a511c682ff550c23f1c8f7870c">complete_agent</a></div><div class="ttdeci">static char * complete_agent(const char *word, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02277">app_agent_pool.c:2277</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="channel_8h_html_a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a26796fa52cc5857446eec8d16a4b718d">AST_FLAG_ZOMBIE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00988">channel.h:988</a></div></div>
<div class="ttc" id="file_8h_html_a95b94a020720147325a486e210b36775"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a95b94a020720147325a486e210b36775">ast_stream_and_wait</a></div><div class="ttdeci">int ast_stream_and_wait(struct ast_channel *chan, const char *file, const char *digits)</div><div class="ttdoc">stream file until digit If the file name is non-empty, try to play it. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l01814">file.c:1814</a></div></div>
<div class="ttc" id="utils_8h_html_afb8683b4d96960d7a82a86a974a57599"><div class="ttname"><a href="../../d5/d60/utils_8h.html#afb8683b4d96960d7a82a86a974a57599">AST_FLAGS_ALL</a></div><div class="ttdeci">#define AST_FLAGS_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00196">utils.h:196</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae6f3c6c02f7961bd6939f302cafa0f4f"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae6f3c6c02f7961bd6939f302cafa0f4f">agent_login_exec</a></div><div class="ttdeci">static int agent_login_exec(struct ast_channel *chan, const char *data)</div><div class="ttdoc">Dialplan AgentLogin application to log in an agent. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02112">app_agent_pool.c:2112</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a7f905c96aa9c5adc8d4e297e3cf89f61"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a7f905c96aa9c5adc8d4e297e3cf89f61">bridge_init_agent_hold</a></div><div class="ttdeci">static void bridge_init_agent_hold(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01409">app_agent_pool.c:1409</a></div></div>
<div class="ttc" id="structagent__complete_html"><div class="ttname"><a href="../../dc/d86/structagent__complete.html">agent_complete</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02260">app_agent_pool.c:2260</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ad29a97a56d35dd72e739c27429ad2287"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ad29a97a56d35dd72e739c27429ad2287">agent_cfg_alloc</a></div><div class="ttdeci">static void * agent_cfg_alloc(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00434">app_agent_pool.c:434</a></div></div>
<div class="ttc" id="bridge__features_8h_html_ac5edca1f8aa8a5ea765cea146507a882a26916a61be33d13623f6fd1d8865d7ca"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#ac5edca1f8aa8a5ea765cea146507a882a26916a61be33d13623f6fd1d8865d7ca">AUTO_MONITOR_START</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00314">bridge_features.h:314</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="config__options_8h_html_a3e5be807d4a10b6da6382a40a0004ace"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a></div><div class="ttdeci">#define STRFLDSET(type,...)</div><div class="ttdoc">Convert a struct and a list of stringfield fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00827">config_options.h:827</a></div></div>
<div class="ttc" id="structagent__pvt_html_a3612e1393049830a205c9fb3857ce295"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a3612e1393049830a205c9fb3857ce295">agent_pvt::the_mark</a></div><div class="ttdeci">unsigned int the_mark</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00616">app_agent_pool.c:616</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="structagent__pvt_html_a1d67f434933f43ad9deb32da61dda2b6"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a1d67f434933f43ad9deb32da61dda2b6">agent_pvt::dead</a></div><div class="ttdeci">unsigned int dead</div><div class="ttdoc">TRUE if the agent is no longer configured and is being destroyed. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00622">app_agent_pool.c:622</a></div></div>
<div class="ttc" id="devicestate_8h_html_a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#a26cbac580d3e86b529f90058f6e91ac7a3683b746ab070a6455934b5d24dbd779">AST_DEVSTATE_CACHABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00070">devicestate.h:70</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a90c12fe1cfd5f897d788df917f0af3af"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a90c12fe1cfd5f897d788df917f0af3af">agent_logoff_request</a></div><div class="ttdeci">static int agent_logoff_request(const char *agent_id, int soft)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00975">app_agent_pool.c:975</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_af5a8115993ab0d49f73d77a11718a869"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#af5a8115993ab0d49f73d77a11718a869">bridge_agent_hold_ack</a></div><div class="ttdeci">static int bridge_agent_hold_ack(struct ast_bridge_channel *bridge_channel, void *hook_pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01085">app_agent_pool.c:1085</a></div></div>
<div class="ttc" id="bridge__basic_8h_html"><div class="ttname"><a href="../../d4/d1e/bridge__basic_8h.html">bridge_basic.h</a></div><div class="ttdoc">Basic bridge subclass API. </div></div>
<div class="ttc" id="structagent__pvt_html_aafe46fa9fde27806c85eea0f7e012b98"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#aafe46fa9fde27806c85eea0f7e012b98">agent_pvt::override_wrapup_time</a></div><div class="ttdeci">unsigned int override_wrapup_time</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00608">app_agent_pool.c:608</a></div></div>
<div class="ttc" id="structagent__pvt_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#ac92588540e8c1d014a08cd8a45462b19">agent_pvt::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00604">app_agent_pool.c:604</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a48ebc85ae4e4a203014711dc3a492ac5"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a48ebc85ae4e4a203014711dc3a492ac5">ast_bridge_dtmf_hook</a></div><div class="ttdeci">int ast_bridge_dtmf_hook(struct ast_bridge_features *features, const char *dtmf, ast_bridge_hook_callback callback, void *hook_pvt, ast_bridge_hook_pvt_destructor destructor, enum ast_bridge_hook_remove_flags remove_flags)</div><div class="ttdoc">Attach a DTMF hook to a bridge features structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l03245">bridge.c:3245</a></div></div>
<div class="ttc" id="utils_8h_html_a7b260320610a09017a9416398acd0a70"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7b260320610a09017a9416398acd0a70">ast_clear_flag</a></div><div class="ttdeci">#define ast_clear_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00077">utils.h:77</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a65c2644d2eadb31bcec0aaeb41cb3444a2000e175bb94bcefb4f72a8e28871d9d">AST_BRIDGE_FLAG_SWAP_INHIBIT_FROM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00047">bridge_features.h:47</a></div></div>
<div class="ttc" id="bridge_8h_html_a116a27b8e1e111729ee1828d4fab6b5a"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a116a27b8e1e111729ee1828d4fab6b5a">ast_bridge_join</a></div><div class="ttdeci">int ast_bridge_join(struct ast_bridge *bridge, struct ast_channel *chan, struct ast_channel *swap, struct ast_bridge_features *features, struct ast_bridge_tech_optimizations *tech_args, enum ast_bridge_join_flags flags)</div><div class="ttdoc">Join a channel to a bridge (blocking) </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l01667">bridge.c:1667</a></div></div>
<div class="ttc" id="channel_8h_html_a9b6409c38af733c46eead884d86dd284"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9b6409c38af733c46eead884d86dd284">ast_channel_get_bridge_channel</a></div><div class="ttdeci">struct ast_bridge_channel * ast_channel_get_bridge_channel(struct ast_channel *chan)</div><div class="ttdoc">Get a reference to the channel&amp;#39;s bridge pointer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10783">channel.c:10783</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_addaa208b0ed785225e24490fb9f28a80"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a></div><div class="ttdeci">AST_MODULE_INFO(ASTERISK_GPL_KEY, AST_MODFLAG_GLOBAL_SYMBOLS|AST_MODFLAG_LOAD_ORDER, &quot;HTTP Phone Provisioning&quot;,.support_level=AST_MODULE_SUPPORT_EXTENDED,.load=load_module,.unload=unload_module,.reload=reload,.load_pri=AST_MODPRI_CHANNEL_DEPEND,.requires=&quot;http&quot;,)</div></div>
<div class="ttc" id="structast__set__party__connected__line_html"><div class="ttname"><a href="../../d4/dc9/structast__set__party__connected__line.html">ast_set_party_connected_line</a></div><div class="ttdoc">Indicate what information in ast_party_connected_line should be set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00490">channel.h:490</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="pbx_8h_html_a6e5b90edb84d216267148dddcffe9b9a"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a></div><div class="ttdeci">int pbx_builtin_setvar_helper(struct ast_channel *chan, const char *name, const char *value)</div><div class="ttdoc">Add a variable to the channel variable stack, removing the most recently set value for the same name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01071">pbx_variables.c:1071</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a97ba140fa091ecedd7cb9029a5e2ac36"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a97ba140fa091ecedd7cb9029a5e2ac36">complete_agent_logoff</a></div><div class="ttdeci">static char * complete_agent_logoff(const char *word, int state)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02309">app_agent_pool.c:2309</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ad828f7da4ade54724a517f3e85f46130"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ad828f7da4ade54724a517f3e85f46130">agent_connect_caller</a></div><div class="ttdeci">static void agent_connect_caller(struct ast_bridge_channel *bridge_channel, struct agent_pvt *agent)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01034">app_agent_pool.c:1034</a></div></div>
<div class="ttc" id="channel_8h_html_a9e9505a91a84992d04ba4e85217fb4e4a085c0c603de12dc2474a17a92e1cb5a4"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9e9505a91a84992d04ba4e85217fb4e4a085c0c603de12dc2474a17a92e1cb5a4">AST_SOFTHANGUP_ASYNCGOTO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01127">channel.h:1127</a></div></div>
<div class="ttc" id="res__corosync_8c_html_ace59e73cd525ae17e77397b0cc7f7302"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#ace59e73cd525ae17e77397b0cc7f7302">cfg_handle</a></div><div class="ttdeci">static corosync_cfg_handle_t cfg_handle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00284">res_corosync.c:284</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_abe9c246e6907a134e70926a4a761ef15"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#abe9c246e6907a134e70926a4a761ef15">agent_login_opts</a></div><div class="ttdeci">static const struct ast_app_option agent_login_opts[128]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02101">app_agent_pool.c:2101</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ab30350ac6df6da6e60c63534b3f2e6f2"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ab30350ac6df6da6e60c63534b3f2e6f2">bridge_agent_hold_dissolving</a></div><div class="ttdeci">static void bridge_agent_hold_dissolving(struct ast_bridge *self)</div><div class="ttdoc">The bridge is being dissolved. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01388">app_agent_pool.c:1388</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3a11e1a1d3e99bed3ea0a7c57a3880d7"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a></div><div class="ttdeci">#define ao2_global_obj_replace_unref(holder, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00908">astobj2.h:908</a></div></div>
<div class="ttc" id="structast__set__party__connected__line_html_aa7845dae2adff27b0da13c58b16ca805"><div class="ttname"><a href="../../d4/dc9/structast__set__party__connected__line.html#aa7845dae2adff27b0da13c58b16ca805">ast_set_party_connected_line::id</a></div><div class="ttdeci">struct ast_set_party_id id</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00492">channel.h:492</a></div></div>
<div class="ttc" id="config__options_8h_html_a60d2944aab4537720434ab9c90e12418"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a60d2944aab4537720434ab9c90e12418">ACO_FILES</a></div><div class="ttdeci">#define ACO_FILES(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00182">config_options.h:182</a></div></div>
<div class="ttc" id="channel_8h_html_adac99999f1e55833e7f903979d67b48b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#adac99999f1e55833e7f903979d67b48b">ast_channel_softhangup_internal_flag</a></div><div class="ttdeci">int ast_channel_softhangup_internal_flag(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00997">channel_internal_api.c:997</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a656be8c315c7512b34037d5445b1fc05"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a656be8c315c7512b34037d5445b1fc05">CONFIG_INFO_STANDARD</a></div><div class="ttdeci">CONFIG_INFO_STANDARD(cfg_info, cfg_handle, agents_cfg_alloc,.files=ACO_FILES(&amp;agents_conf),.post_apply_config=agents_post_apply_config,)</div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="config__options_8h_html_ab29e0267f5b05969bcd1d16e97100ebba3e6bada4dbda566888d4317e3bf6343b"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#ab29e0267f5b05969bcd1d16e97100ebba3e6bada4dbda566888d4317e3bf6343b">ACO_WHITELIST_EXACT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00055">config_options.h:55</a></div></div>
<div class="ttc" id="bridge__basic_8h_html_a1410fb71fa67f9ee92f15b18439b7571"><div class="ttname"><a href="../../d4/d1e/bridge__basic_8h.html#a1410fb71fa67f9ee92f15b18439b7571">ast_bridge_basic_new</a></div><div class="ttdeci">struct ast_bridge * ast_bridge_basic_new(void)</div><div class="ttdoc">Create a new basic class bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/bridge__basic_8c_source.html#l03617">bridge_basic.c:3617</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a872ee537b540de2ccaea4e62ed2dc016"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a872ee537b540de2ccaea4e62ed2dc016">app_agent_request</a></div><div class="ttdeci">static const char app_agent_request[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00345">app_agent_pool.c:345</a></div></div>
<div class="ttc" id="structast__bridge__channel_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html#a84d1435c5b8d387806714ea7079304b7">ast_bridge_channel::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00091">bridge_channel.h:91</a></div></div>
<div class="ttc" id="astobj2_8h_html_afe7a6b368052cb171d371d873b7520acadb2bfd83bc54a380d86d3a9b02d99c35"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520acadb2bfd83bc54a380d86d3a9b02d99c35">AO2_CONTAINER_ALLOC_OPT_DUPS_REPLACE</a></div><div class="ttdoc">Replace objects with duplicate keys in container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01215">astobj2.h:1215</a></div></div>
<div class="ttc" id="structast__bridge__channel_html"><div class="ttname"><a href="../../d5/dca/structast__bridge__channel.html">ast_bridge_channel</a></div><div class="ttdoc">Structure that contains information regarding a channel in a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d41/bridge__channel_8h_source.html#l00084">bridge_channel.h:84</a></div></div>
<div class="ttc" id="channel_8h_html_a5d3c15fe1dffda82e6dc03ca7b26526a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5d3c15fe1dffda82e6dc03ca7b26526a">ast_party_connected_line_copy</a></div><div class="ttdeci">void ast_party_connected_line_copy(struct ast_party_connected_line *dest, const struct ast_party_connected_line *src)</div><div class="ttdoc">Copy the source connected line information to the destination connected line. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02031">channel.c:2031</a></div></div>
<div class="ttc" id="bridge_8h_html_af0e3d51ad653134a92545dec4610b83a"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#af0e3d51ad653134a92545dec4610b83a">ast_bridge_move</a></div><div class="ttdeci">int ast_bridge_move(struct ast_bridge *dst_bridge, struct ast_bridge *src_bridge, struct ast_channel *chan, struct ast_channel *swap, int attempt_recovery)</div><div class="ttdoc">Move a channel from one bridge to another. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l02508">bridge.c:2508</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae1a2f2b62c60544be70fc0cff132bdcf"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae1a2f2b62c60544be70fc0cff132bdcf">agents_sweep</a></div><div class="ttdeci">static void agents_sweep(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00905">app_agent_pool.c:905</a></div></div>
<div class="ttc" id="structast__set__party__id_html_abbd32f02dc419af56bdf709336f6c33e"><div class="ttname"><a href="../../df/dcf/structast__set__party__id.html#abbd32f02dc419af56bdf709336f6c33e">ast_set_party_id::name</a></div><div class="ttdeci">unsigned char name</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00364">channel.h:364</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a48bc11919b2752df9d14ce89557cfb25"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00033">utils/frame.c:33</a></div></div>
<div class="ttc" id="bridge__after_8h_html"><div class="ttname"><a href="../../d8/d85/bridge__after_8h.html">bridge_after.h</a></div><div class="ttdoc">After Bridge Execution API. </div></div>
<div class="ttc" id="channel_8h_html_a6801c703e767d6f760c54c8b86a30024"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a></div><div class="ttdeci">#define ast_channel_ref(c)</div><div class="ttdoc">Increase channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02970">channel.h:2970</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a7c8999dd893779d9c04cbf4a70e9e2a1"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a7c8999dd893779d9c04cbf4a70e9e2a1">send_agent_logoff</a></div><div class="ttdeci">static void send_agent_logoff(struct ast_channel *chan, const char *agent, long logintime)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01454">app_agent_pool.c:1454</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="cli_8h_html"><div class="ttname"><a href="../../dc/db0/cli_8h.html">cli.h</a></div><div class="ttdoc">Standard Command Line Interface. </div></div>
<div class="ttc" id="bridge__channel_8h_html_a7d01ff5caf025a97796d2dbb78f5f02c"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#a7d01ff5caf025a97796d2dbb78f5f02c">ast_bridge_channel_lock_bridge</a></div><div class="ttdeci">void ast_bridge_channel_lock_bridge(struct ast_bridge_channel *bridge_channel)</div><div class="ttdoc">Lock the bridge associated with the bridge channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l00222">bridge_channel.c:222</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7abfa6979308f8cc4f7f76982213d2693a">AGENT_STATE_READY_FOR_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00572">app_agent_pool.c:572</a></div></div>
<div class="ttc" id="structaco__type_html"><div class="ttname"><a href="../../de/d71/structaco__type.html">aco_type</a></div><div class="ttdoc">Type information about a category-level configurable object. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00121">config_options.h:121</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a358f094a1d14b589ace3b278972be56f"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a358f094a1d14b589ace3b278972be56f">app_agent_login</a></div><div class="ttdeci">static const char app_agent_login[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00344">app_agent_pool.c:344</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="channel_8h_html_accf4e9753bd5d7316f4988e74486552b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#accf4e9753bd5d7316f4988e74486552b">ast_connected_line_copy_from_caller</a></div><div class="ttdeci">void ast_connected_line_copy_from_caller(struct ast_party_connected_line *dest, const struct ast_party_caller *src)</div><div class="ttdoc">Copy the caller information to the connected line information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08389">channel.c:8389</a></div></div>
<div class="ttc" id="structaco__type_html_afa734f374ecc9f8d94f5e6cd3d934db6"><div class="ttname"><a href="../../de/d71/structaco__type.html#afa734f374ecc9f8d94f5e6cd3d934db6">aco_type::item_offset</a></div><div class="ttdeci">size_t item_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00130">config_options.h:130</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="structast__cli__args_html_a4b911d12699acbbb5a8b62355b35bae8"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">ast_cli_args::pos</a></div><div class="ttdeci">const int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00164">cli.h:164</a></div></div>
<div class="ttc" id="structaco__file_html_a7efa5e9c7494c7d4586359300221aa5d"><div class="ttname"><a href="../../d9/d9c/structaco__file.html#a7efa5e9c7494c7d4586359300221aa5d">aco_file::filename</a></div><div class="ttdeci">const char * filename</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00162">config_options.h:162</a></div></div>
<div class="ttc" id="structagent__pvt_html_aa09f4acec5c1e337edce28217f8f685c"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#aa09f4acec5c1e337edce28217f8f685c">agent_pvt::call_start</a></div><div class="ttdeci">time_t call_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00634">app_agent_pool.c:634</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a2a1890787b3e55318c417c0a3e1432c7"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a2a1890787b3e55318c417c0a3e1432c7">END_OPTIONS</a></div><div class="ttdeci">#define END_OPTIONS</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01344">include/asterisk/app.h:1344</a></div></div>
<div class="ttc" id="structagent__pvt_html_a0db93def45062b0b68b3cfc92828056e"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a0db93def45062b0b68b3cfc92828056e">agent_pvt::override_auto_logoff</a></div><div class="ttdeci">unsigned int override_auto_logoff</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00606">app_agent_pool.c:606</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ab9353a3e165a7fd78b69b27e36d49e8b"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ab9353a3e165a7fd78b69b27e36d49e8b">LOGIN_WAIT_TIMEOUT_TIME</a></div><div class="ttdeci">#define LOGIN_WAIT_TIMEOUT_TIME</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00342">app_agent_pool.c:342</a></div></div>
<div class="ttc" id="channel_8h_html_aec583a3e25358ee552a4f3df53914cd0"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aec583a3e25358ee552a4f3df53914cd0">ast_answer</a></div><div class="ttdeci">int ast_answer(struct ast_channel *chan)</div><div class="ttdoc">Answer a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02814">channel.c:2814</a></div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html_a57cae4c5040ce0791d0b4798193fc47f"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html#a57cae4c5040ce0791d0b4798193fc47f">AST_FEATURE_MAX_LEN</a></div><div class="ttdeci">#define AST_FEATURE_MAX_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/daa/include_2asterisk_2features__config_8h_source.html#l00231">include/asterisk/features_config.h:231</a></div></div>
<div class="ttc" id="causes_8h_html"><div class="ttname"><a href="../../d4/da3/causes_8h.html">causes.h</a></div><div class="ttdoc">Internal Asterisk hangup causes. </div></div>
<div class="ttc" id="app__agent__pool_8c_html_ac7ac094b1e03eda5eef727a0c1988141"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ac7ac094b1e03eda5eef727a0c1988141">complete_agent_search</a></div><div class="ttdeci">static int complete_agent_search(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02267">app_agent_pool.c:2267</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a1ef7f429bd53528befc06ac4d0f5ff3b"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a1ef7f429bd53528befc06ac4d0f5ff3b">agent_function</a></div><div class="ttdeci">static struct ast_custom_function agent_function</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02255">app_agent_pool.c:2255</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390aa5814e690c23b590bcd4eb43535907a1">AST_CONTROL_RINGING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00280">include/asterisk/frame.h:280</a></div></div>
<div class="ttc" id="structagent__pvt_html_a38c96ef0675bb4c5e4a4bbae53b341cb"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a38c96ef0675bb4c5e4a4bbae53b341cb">agent_pvt::probation_start</a></div><div class="ttdeci">time_t probation_start</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00632">app_agent_pool.c:632</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a></div><div class="ttdoc">Type for default option handler for stringfields. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00435">config_options.h:435</a></div></div>
<div class="ttc" id="structast__cli__args_html"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html">ast_cli_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00158">cli.h:158</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a355c423d8d2b38bf42751345e082f211"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a355c423d8d2b38bf42751345e082f211">agent_cfg_find</a></div><div class="ttdeci">static void * agent_cfg_find(struct ao2_container *agents, const char *username)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00448">app_agent_pool.c:448</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a6558aa820bc9dd1eebac76ee2e2951f0"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a6558aa820bc9dd1eebac76ee2e2951f0">action_agent_logoff</a></div><div class="ttdeci">static int action_agent_logoff(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02605">app_agent_pool.c:2605</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_adcfc7ef2b1ee5305158a584970ddea65"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#adcfc7ef2b1ee5305158a584970ddea65">ast_bridge_methods::pull</a></div><div class="ttdeci">ast_bridge_pull_channel_fn pull</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00275">bridge.h:275</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9657c4f40f012fc1d426c3c94b3d32c0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a></div><div class="ttdeci">#define ao2_container_alloc_rbtree(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01358">astobj2.h:1358</a></div></div>
<div class="ttc" id="bridge__channel_8h_html_abc0302bab9fb2f318db695fe1f9047d8"><div class="ttname"><a href="../../de/d41/bridge__channel_8h.html#abc0302bab9fb2f318db695fe1f9047d8">ast_bridge_channel_queue_control_data</a></div><div class="ttdeci">int ast_bridge_channel_queue_control_data(struct ast_bridge_channel *bridge_channel, enum ast_control_frame_type control, const void *data, size_t datalen)</div><div class="ttdoc">Queue a control frame onto the bridge channel with data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/bridge__channel_8c_source.html#l01143">bridge_channel.c:1143</a></div></div>
<div class="ttc" id="structast__bridge__methods_html_a60b76bf280f288b3ef3f1facf873b104"><div class="ttname"><a href="../../d2/dd3/structast__bridge__methods.html#a60b76bf280f288b3ef3f1facf873b104">ast_bridge_methods::push</a></div><div class="ttdeci">ast_bridge_push_channel_fn push</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00273">bridge.h:273</a></div></div>
<div class="ttc" id="astobj2_8h_html_afe7a6b368052cb171d371d873b7520acadaba53a115685d6a8944dd2c6a8d7bfb"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520acadaba53a115685d6a8944dd2c6a8d7bfb">AO2_CONTAINER_ALLOC_OPT_DUPS_REJECT</a></div><div class="ttdoc">Reject objects with duplicate keys in container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01192">astobj2.h:1192</a></div></div>
<div class="ttc" id="bridge__internal_8h_html"><div class="ttname"><a href="../../d5/dde/bridge__internal_8h.html">bridge_internal.h</a></div><div class="ttdoc">Private Bridging API. </div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7">agent_state</a></div><div class="ttdeci">agent_state</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00566">app_agent_pool.c:566</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ad2b4b080213b6b09e799374f4529ecc2"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ad2b4b080213b6b09e799374f4529ecc2">agents_cfg_alloc</a></div><div class="ttdeci">static void * agents_cfg_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00512">app_agent_pool.c:512</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ae60dcdeaa28da0fc60d394eaf1a6edd7a9d261cfbf17a8c9c45edb25d1970e0d7">AGENT_STATE_CALL_WAIT_ACK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00576">app_agent_pool.c:576</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="cli_8h_html_a29e703082f8137e165097c41f249e6d1"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a></div><div class="ttdeci">#define AST_CLI_YESNO(x)</div><div class="ttdoc">Return Yes or No depending on the argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00071">cli.h:71</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf03b8daa7784a26648db90614add6caa"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf03b8daa7784a26648db90614add6caa">ast_channel_publish_blob</a></div><div class="ttdeci">void ast_channel_publish_blob(struct ast_channel *chan, struct stasis_message_type *type, struct ast_json *blob)</div><div class="ttdoc">Publish a channel blob message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l01135">stasis_channels.c:1135</a></div></div>
<div class="ttc" id="channel_8h_html_a91de92158876186d28ba1773877f2732"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a></div><div class="ttdeci">struct ast_flags * ast_channel_flags(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01260">channel_internal_api.c:1260</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_aca036489931bf5571e2472331c8ac80b"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#aca036489931bf5571e2472331c8ac80b">AST_APP_OPTION</a></div><div class="ttdeci">#define AST_APP_OPTION(option, flagno)</div><div class="ttdoc">Declares an application option that does not accept an argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01402">include/asterisk/app.h:1402</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a6ac128d97cc9176ba058342d94b90afb"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a6ac128d97cc9176ba058342d94b90afb">bridge_agent_hold_new</a></div><div class="ttdeci">static struct ast_bridge * bridge_agent_hold_new(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01396">app_agent_pool.c:1396</a></div></div>
<div class="ttc" id="bridge__features_8h_html_a59c3a69424e1d3c627ece7aeb5f0bdb3a9075785271a9e2a18bb65c99a6bd7744"><div class="ttname"><a href="../../dc/d7a/bridge__features_8h.html#a59c3a69424e1d3c627ece7aeb5f0bdb3a9075785271a9e2a18bb65c99a6bd7744">AST_BRIDGE_BUILTIN_AUTOMIXMON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00104">bridge_features.h:104</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a5733bc2f13f35fe0d8bde13939b50e07"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a5733bc2f13f35fe0d8bde13939b50e07">agent_bridge_channel_get_lock</a></div><div class="ttdeci">static struct ast_bridge_channel * agent_bridge_channel_get_lock(struct agent_pvt *agent)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01660">app_agent_pool.c:1660</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ab0c3d04727ae30c5deac61abe52b5fdd"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ab0c3d04727ae30c5deac61abe52b5fdd">agent_pvt_new</a></div><div class="ttdeci">static struct agent_pvt * agent_pvt_new(struct agent_cfg *cfg)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00784">app_agent_pool.c:784</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ada8114db41c738d45b72e605ebd7ac7f"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ada8114db41c738d45b72e605ebd7ac7f">agents_mark</a></div><div class="ttdeci">static void agents_mark(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00884">app_agent_pool.c:884</a></div></div>
<div class="ttc" id="manager_8h_html_a5b63b8a8faede2d852e071e1f7b31c11"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5b63b8a8faede2d852e071e1f7b31c11">ast_manager_register_xml</a></div><div class="ttdeci">#define ast_manager_register_xml(action, authority, func)</div><div class="ttdoc">Register a manager callback using XML documentation to describe the manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00186">manager.h:186</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_abf5e2903a4ceff8c71544f7760ebc970"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#abf5e2903a4ceff8c71544f7760ebc970">agent_handle_show_specific</a></div><div class="ttdeci">static char * agent_handle_show_specific(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02426">app_agent_pool.c:2426</a></div></div>
<div class="ttc" id="bridge_8h_html_ad52005264bec898a8f825bd47d91cf93a9106169928c6eeccad5b5ebcf762ac9d"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#ad52005264bec898a8f825bd47d91cf93a9106169928c6eeccad5b5ebcf762ac9d">AST_BRIDGE_JOIN_PASS_REFERENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00549">bridge.h:549</a></div></div>
<div class="ttc" id="module_8h_html_aba2c8d4be709a254658b21a834f8294a"><div class="ttname"><a href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a></div><div class="ttdeci">#define ASTERISK_GPL_KEY</div><div class="ttdoc">The text the key() function should return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00046">module.h:46</a></div></div>
<div class="ttc" id="bridge_8h_html"><div class="ttname"><a href="../../d4/d56/bridge_8h.html">bridge.h</a></div><div class="ttdoc">Bridging API. </div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a414b69d7583bb4cfc6daf5276aac6d14"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a414b69d7583bb4cfc6daf5276aac6d14">connected</a></div><div class="ttdeci">char connected</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00082">eagi_proxy.c:82</a></div></div>
<div class="ttc" id="module_8h_html"><div class="ttname"><a href="../../d5/d16/module_8h.html">module.h</a></div><div class="ttdoc">Asterisk module definitions. </div></div>
<div class="ttc" id="channel_8h_html_a1dc625bd14a7875b04bfe0c388858929"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a></div><div class="ttdeci">struct ast_format * ast_channel_writeformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00860">channel_internal_api.c:860</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a5ec2310ede2b9b46427e10e8e0cb43e6"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a5ec2310ede2b9b46427e10e8e0cb43e6">bridge_agent_hold_v_table</a></div><div class="ttdeci">static struct ast_bridge_methods bridge_agent_hold_v_table</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01394">app_agent_pool.c:1394</a></div></div>
<div class="ttc" id="structast__bridge__features__automixmonitor_html_a2e911a04575a1931bc544696762088e5"><div class="ttname"><a href="../../d7/d41/structast__bridge__features__automixmonitor.html#a2e911a04575a1931bc544696762088e5">ast_bridge_features_automixmonitor::start_stop</a></div><div class="ttdeci">enum ast_bridge_features_monitor start_stop</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/bridge__features_8h_source.html#l00326">bridge_features.h:326</a></div></div>
<div class="ttc" id="devicestate_8h_html_af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94"><div class="ttname"><a href="../../da/da2/devicestate_8h.html#af72f8a5c0601e4c1f8a852749cd44eeea9c008e1d20858cbc3275c157e02ebc94">AST_DEVICE_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/da2/devicestate_8h_source.html#l00057">devicestate.h:57</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a80cd3f6f786b59b742bcecfc0b3be7c2"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a></div><div class="ttdeci">#define AST_DECLARE_APP_ARGS(name, arglist)</div><div class="ttdoc">Declare a structure to hold an application&amp;#39;s arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01249">include/asterisk/app.h:1249</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html">app.h</a></div><div class="ttdoc">Application convenience functions, designed to give consistent look and feel to Asterisk apps...</div></div>
<div class="ttc" id="structagent__pvt_html_a1e4986d38981a6836446fd6e0947bfaa"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a1e4986d38981a6836446fd6e0947bfaa">agent_pvt::waiting_colp</a></div><div class="ttdeci">struct ast_party_connected_line waiting_colp</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00602">app_agent_pool.c:602</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aaa635926514981b733c8cc5afaf0def9"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aaa635926514981b733c8cc5afaf0def9">caller_safety_timeout</a></div><div class="ttdeci">static int caller_safety_timeout(struct ast_bridge_channel *bridge_channel, void *hook_pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01722">app_agent_pool.c:1722</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="astobj2_8h_html_aadb92410f92a28e16f404b51bc601a80"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aadb92410f92a28e16f404b51bc601a80">ao2_global_obj_replace</a></div><div class="ttdeci">#define ao2_global_obj_replace(holder, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00885">astobj2.h:885</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
<div class="ttc" id="pbx_8h_html_a8af0e93442a9e468425f63cc52b0ac7b"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a8af0e93442a9e468425f63cc52b0ac7b">ast_custom_function_register</a></div><div class="ttdeci">#define ast_custom_function_register(acf)</div><div class="ttdoc">Register a custom function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l01508">pbx.h:1508</a></div></div>
<div class="ttc" id="structagent__pvt_html_a9e221b3d2bfe1c52281667c3cb15195e"><div class="ttname"><a href="../../dd/d4d/structagent__pvt.html#a9e221b3d2bfe1c52281667c3cb15195e">agent_pvt::override_ack_call</a></div><div class="ttdeci">unsigned int override_ack_call</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00610">app_agent_pool.c:610</a></div></div>
<div class="ttc" id="module_8h_html_aa4f734041ffd9d75b07cefb0291e1e58af2d6c20d90a068171cc852484a435980"><div class="ttname"><a href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58af2d6c20d90a068171cc852484a435980">AST_MODPRI_DEVSTATE_PROVIDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00329">module.h:329</a></div></div>
<div class="ttc" id="lock_8h_html_ac840092853644cea0a186efdc58985f5"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac840092853644cea0a186efdc58985f5">AST_MUTEX_DEFINE_STATIC</a></div><div class="ttdeci">#define AST_MUTEX_DEFINE_STATIC(mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00518">lock.h:518</a></div></div>
<div class="ttc" id="file_8h_html_a3092bf11d4bba66f646562759608b1bc"><div class="ttname"><a href="../../d2/d4d/file_8h.html#a3092bf11d4bba66f646562759608b1bc">ast_stopstream</a></div><div class="ttdeci">int ast_stopstream(struct ast_channel *c)</div><div class="ttdoc">Stops a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d13/file_8c_source.html#l00187">file.c:187</a></div></div>
<div class="ttc" id="module_8h_html_afba4eb7a910b10969041ae4cd488729d"><div class="ttname"><a href="../../d5/d16/module_8h.html#afba4eb7a910b10969041ae4cd488729d">ast_register_application_xml</a></div><div class="ttdeci">#define ast_register_application_xml(app, execute)</div><div class="ttdoc">Register an application using XML documentation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00626">module.h:626</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a61441e0cbefa5859ff1953c2248eeef3"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a61441e0cbefa5859ff1953c2248eeef3">bridge_agent_hold_push</a></div><div class="ttdeci">static int bridge_agent_hold_push(struct ast_bridge *self, struct ast_bridge_channel *bridge_channel, struct ast_bridge_channel *swap)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01196">app_agent_pool.c:1196</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a3a5f74a4e24b8c032bd9698c1f2af510"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a3a5f74a4e24b8c032bd9698c1f2af510">agent_pvt_devstate_get</a></div><div class="ttdeci">static enum ast_device_state agent_pvt_devstate_get(const char *agent_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00732">app_agent_pool.c:732</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_adb1d2a9b5b0247cdd038c09a4ca3e41b"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#adb1d2a9b5b0247cdd038c09a4ca3e41b">agent_types</a></div><div class="ttdeci">static struct aco_type * agent_types[]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00475">app_agent_pool.c:475</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_aec6f971b8bba2801e4ab3a92917860f1"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#aec6f971b8bba2801e4ab3a92917860f1">agent_devstate_changed</a></div><div class="ttdeci">static void agent_devstate_changed(const char *agent_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00756">app_agent_pool.c:756</a></div></div>
<div class="ttc" id="codecs_2gsm_2inc_2private_8h_html_a0b023cbb2bf7d034c2269d58d7455ac8"><div class="ttname"><a href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a></div><div class="ttdeci">short word</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da0/codecs_2gsm_2inc_2private_8h_source.html#l00012">codecs/gsm/inc/private.h:12</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a037e9a5b28477b17e7c9acbe7ecb21d5"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a></div><div class="ttdeci">#define AST_APP_ARG(name)</div><div class="ttdoc">Define an application argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01232">include/asterisk/app.h:1232</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a7a5ef1db5b0d29922a128c9422069729"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a7a5ef1db5b0d29922a128c9422069729">send_alert_to_agent</a></div><div class="ttdeci">static int send_alert_to_agent(struct ast_bridge_channel *bridge_channel, const char *agent_id)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01812">app_agent_pool.c:1812</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a02691f29ac4d0ddd46ef7ebd90c3958d"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a02691f29ac4d0ddd46ef7ebd90c3958d">agents</a></div><div class="ttdeci">static struct ao2_container * agents</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l00649">app_agent_pool.c:649</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_ad1982509765f4870f1f63412a53ea668"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l02701">app_agent_pool.c:2701</a></div></div>
<div class="ttc" id="app__agent__pool_8c_html_a8f0089dcfc5a0c38a72eaa0aeb3014e0"><div class="ttname"><a href="../../de/d11/app__agent__pool_8c.html#a8f0089dcfc5a0c38a72eaa0aeb3014e0">agent_after_bridge_cb</a></div><div class="ttdeci">static void agent_after_bridge_cb(struct ast_channel *chan, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d11/app__agent__pool_8c_source.html#l01618">app_agent_pool.c:1618</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:42:57 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
