<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: app.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li><li class="navelem"><a class="el" href="../../dir_645bb0ee2d9887263292b3f6cc7c69f2.html">stasis</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">res/stasis/app.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Internal API for the Stasis application controller.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../d5/d7b/channel_8h_source.html">asterisk/channel.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d79/stasis_8h_source.html">asterisk/stasis.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d9c/stasis__app_8h_source.html">asterisk/stasis_app.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res/stasis/app.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/d52/res_2stasis_2app_8h__incl.png" border="0" usemap="#app_8h" alt=""/></div>
<map name="app_8h" id="app_8h">
<area shape="rect" id="node2" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1045,155,1183,181"/>
<area shape="rect" id="node29" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="187,229,313,256"/>
<area shape="rect" id="node34" href="../../d8/d9c/stasis__app_8h.html" title="Stasis Application API. See Stasis Application API for detailed documentation. " alt="" coords="1036,80,1192,107"/>
<area shape="rect" id="node3" href="../../dc/d4d/alertpipe_8h.html" title="asterisk/alertpipe.h" alt="" coords="1151,229,1295,256"/>
<area shape="rect" id="node4" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1125,379,1239,405"/>
<area shape="rect" id="node5" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="583,528,696,555"/>
<area shape="rect" id="node7" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1435,453,1593,480"/>
<area shape="rect" id="node8" href="../../dc/d14/abstract__jb_8h.html" title="Common implementation&#45;independent jitterbuffer stuff. " alt="" coords="1623,304,1781,331"/>
<area shape="rect" id="node12" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="341,379,476,405"/>
<area shape="rect" id="node13" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="691,453,841,480"/>
<area shape="rect" id="node14" href="../../d4/dfb/poll-compat_8h.html" title="asterisk/poll&#45;compat.h" alt="" coords="1884,229,2048,256"/>
<area shape="rect" id="node17" href="../../d6/d66/include_2asterisk_2frame_8h.html" title="Asterisk internal frame definitions. " alt="" coords="1472,304,1599,331"/>
<area shape="rect" id="node19" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="665,229,811,256"/>
<area shape="rect" id="node20" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="1269,304,1396,331"/>
<area shape="rect" id="node21" href="../../dc/d07/cdr_8h.html" title="Call Detail Record API. " alt="" coords="1753,229,1859,256"/>
<area shape="rect" id="node22" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="552,379,703,405"/>
<area shape="rect" id="node23" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="2140,379,2301,405"/>
<area shape="rect" id="node24" href="../../d9/d95/channelstate_8h.html" title="Channel states. " alt="" coords="930,379,1101,405"/>
<area shape="rect" id="node26" href="../../de/dc8/ccss_8h.html" title="Call Completion Supplementary Services API. " alt="" coords="887,229,1003,256"/>
<area shape="rect" id="node28" href="../../db/d3c/framehook_8h.html" title="FrameHook Architecture. " alt="" coords="1370,229,1527,256"/>
<area shape="rect" id="node33" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="337,229,488,256"/>
<area shape="rect" id="node6" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="945,603,1091,629"/>
<area shape="rect" id="node10" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="1631,379,1762,405"/>
<area shape="rect" id="node11" href="../../d1/d16/codec_8h.html" title="Codec API. " alt="" coords="1895,453,2021,480"/>
<area shape="rect" id="node15" href="../../d9/dab/select_8h.html" title="Bitfield expansions for ast_select. " alt="" coords="1937,304,2064,331"/>
<area shape="rect" id="node18" href="../../d1/d84/endian_8h.html" title="Asterisk architecture endianess compatibility definitions. " alt="" coords="1470,379,1601,405"/>
<area shape="rect" id="node25" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="903,453,987,480"/>
<area shape="rect" id="node27" href="../../da/da2/devicestate_8h.html" title="Device state management. " alt="" coords="981,304,1143,331"/>
<area shape="rect" id="node30" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="374,304,489,331"/>
<area shape="rect" id="node31" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="153,304,299,331"/>
<area shape="rect" id="node32" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="5,304,129,331"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/d9b/res_2stasis_2app_8h__dep__incl.png" border="0" usemap="#app_8hdep" alt=""/></div>
<map name="app_8hdep" id="app_8hdep">
<area shape="rect" id="node2" href="../../d2/d80/res__stasis_8c.html" title="Stasis application support. " alt="" coords="5,80,103,107"/>
<area shape="rect" id="node3" href="../../d3/d5e/res_2stasis_2app_8c.html" title="Stasis application support. " alt="" coords="127,80,184,107"/>
<area shape="rect" id="node4" href="../../de/de3/control_8c.html" title="Stasis application control support. " alt="" coords="209,80,286,107"/>
<area shape="rect" id="node5" href="../../d9/de0/stasis__bridge_8c.html" title="Stasis bridge subclass. " alt="" coords="310,80,427,107"/>
</map>
</div>
</div>
<p><a href="../../df/d5f/res_2stasis_2app_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aed792ab54d9817f46bfcc787e2754dc8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8">stasis_app_subscription_model</a> { <a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8ab68b1338eae899760e38b8d0c684e007">STASIS_APP_SUBSCRIBE_MANUAL</a>, 
<a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8abb410559dd7f7ee3fbd477cc39d73afe">STASIS_APP_SUBSCRIBE_ALL</a>
 }</td></tr>
<tr class="separator:aed792ab54d9817f46bfcc787e2754dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:acf8bdfbd0c394c97598c4e0565525504"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#acf8bdfbd0c394c97598c4e0565525504">app_create</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <a class="el" href="../../d8/d9c/stasis__app_8h.html#a745524550c947d73d1dc42de3c74627d">stasis_app_cb</a> <a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, void *data, enum <a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8">stasis_app_subscription_model</a> subscription_model)</td></tr>
<tr class="memdesc:acf8bdfbd0c394c97598c4e0565525504"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a res_stasis application.  <a href="#acf8bdfbd0c394c97598c4e0565525504">More...</a><br /></td></tr>
<tr class="separator:acf8bdfbd0c394c97598c4e0565525504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac70355ddeb33a79cdaf71549b82c22e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#ac70355ddeb33a79cdaf71549b82c22e8">app_deactivate</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>)</td></tr>
<tr class="memdesc:ac70355ddeb33a79cdaf71549b82c22e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deactivates an application.  <a href="#ac70355ddeb33a79cdaf71549b82c22e8">More...</a><br /></td></tr>
<tr class="separator:ac70355ddeb33a79cdaf71549b82c22e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e3b3e8bf99e659289aacde3e6df03f"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a90e3b3e8bf99e659289aacde3e6df03f">app_get_replace_channel_app</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</td></tr>
<tr class="memdesc:a90e3b3e8bf99e659289aacde3e6df03f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the app that the replacement channel will be controlled by.  <a href="#a90e3b3e8bf99e659289aacde3e6df03f">More...</a><br /></td></tr>
<tr class="separator:a90e3b3e8bf99e659289aacde3e6df03f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafff5782ef991feae701cb5762457461"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#aafff5782ef991feae701cb5762457461">app_is_active</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>)</td></tr>
<tr class="memdesc:aafff5782ef991feae701cb5762457461"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether an app is active.  <a href="#aafff5782ef991feae701cb5762457461">More...</a><br /></td></tr>
<tr class="separator:aafff5782ef991feae701cb5762457461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb21fd32f98d4bdea9de6f9c5eea752"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a5fb21fd32f98d4bdea9de6f9c5eea752">app_is_finished</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>)</td></tr>
<tr class="memdesc:a5fb21fd32f98d4bdea9de6f9c5eea752"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether a deactivated app has no channels.  <a href="#a5fb21fd32f98d4bdea9de6f9c5eea752">More...</a><br /></td></tr>
<tr class="separator:a5fb21fd32f98d4bdea9de6f9c5eea752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfdcc440a99fdb9cc42937a884ba0ee6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#abfdcc440a99fdb9cc42937a884ba0ee6">app_is_subscribed_bridge_id</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *bridge_id)</td></tr>
<tr class="memdesc:abfdcc440a99fdb9cc42937a884ba0ee6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if an app is subscribed to a bridge.  <a href="#abfdcc440a99fdb9cc42937a884ba0ee6">More...</a><br /></td></tr>
<tr class="separator:abfdcc440a99fdb9cc42937a884ba0ee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a316a1a996a5456a1b7422cc05add62e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a316a1a996a5456a1b7422cc05add62e6">app_is_subscribed_channel_id</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *channel_id)</td></tr>
<tr class="memdesc:a316a1a996a5456a1b7422cc05add62e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if an app is subscribed to a channel.  <a href="#a316a1a996a5456a1b7422cc05add62e6">More...</a><br /></td></tr>
<tr class="separator:a316a1a996a5456a1b7422cc05add62e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1f3daa5de52b71b552447ad5079f7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a0a1f3daa5de52b71b552447ad5079f7b">app_is_subscribed_endpoint_id</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *endpoint_id)</td></tr>
<tr class="memdesc:a0a1f3daa5de52b71b552447ad5079f7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test if an app is subscribed to a endpoint.  <a href="#a0a1f3daa5de52b71b552447ad5079f7b">More...</a><br /></td></tr>
<tr class="separator:a0a1f3daa5de52b71b552447ad5079f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2b5ef224bf880e5ef556a910f41a37"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#afc2b5ef224bf880e5ef556a910f41a37">app_send</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:afc2b5ef224bf880e5ef556a910f41a37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a message to an application.  <a href="#afc2b5ef224bf880e5ef556a910f41a37">More...</a><br /></td></tr>
<tr class="separator:afc2b5ef224bf880e5ef556a910f41a37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a814d56d14f2e4afead2c709145b240f3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a814d56d14f2e4afead2c709145b240f3">app_send_end_msg</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</td></tr>
<tr class="memdesc:a814d56d14f2e4afead2c709145b240f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send StasisEnd message to the listening app.  <a href="#a814d56d14f2e4afead2c709145b240f3">More...</a><br /></td></tr>
<tr class="separator:a814d56d14f2e4afead2c709145b240f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0921b1de9a2b8d700ac18f594e98727b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a0921b1de9a2b8d700ac18f594e98727b">app_set_replace_channel_app</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, const char *replace_app)</td></tr>
<tr class="memdesc:a0921b1de9a2b8d700ac18f594e98727b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the app that the replacement channel will be controlled by.  <a href="#a0921b1de9a2b8d700ac18f594e98727b">More...</a><br /></td></tr>
<tr class="separator:a0921b1de9a2b8d700ac18f594e98727b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18bd387c4272cbb57cc038bc96b789a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a18bd387c4272cbb57cc038bc96b789a9">app_set_replace_channel_snapshot</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, struct <a class="el" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *replace_snapshot)</td></tr>
<tr class="memdesc:a18bd387c4272cbb57cc038bc96b789a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the snapshot of the channel that this channel will replace.  <a href="#a18bd387c4272cbb57cc038bc96b789a9">More...</a><br /></td></tr>
<tr class="separator:a18bd387c4272cbb57cc038bc96b789a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a364056b7da44bbeee2959155aa4ef72d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a364056b7da44bbeee2959155aa4ef72d">app_shutdown</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>)</td></tr>
<tr class="memdesc:a364056b7da44bbeee2959155aa4ef72d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tears down an application.  <a href="#a364056b7da44bbeee2959155aa4ef72d">More...</a><br /></td></tr>
<tr class="separator:a364056b7da44bbeee2959155aa4ef72d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c81b198af25100a727e3b42f6a6a5ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a0c81b198af25100a727e3b42f6a6a5ab">app_subscribe_bridge</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, struct <a class="el" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge)</td></tr>
<tr class="memdesc:a0c81b198af25100a727e3b42f6a6a5ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a bridge subscription to an existing channel subscription.  <a href="#a0c81b198af25100a727e3b42f6a6a5ab">More...</a><br /></td></tr>
<tr class="separator:a0c81b198af25100a727e3b42f6a6a5ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0dbc86b18101e9d9d48b350aeec489"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a5b0dbc86b18101e9d9d48b350aeec489">app_subscribe_channel</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</td></tr>
<tr class="memdesc:a5b0dbc86b18101e9d9d48b350aeec489"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscribes an application to a channel.  <a href="#a5b0dbc86b18101e9d9d48b350aeec489">More...</a><br /></td></tr>
<tr class="separator:a5b0dbc86b18101e9d9d48b350aeec489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a021ad5ebb8ff3d64b1df955eb887fbea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a021ad5ebb8ff3d64b1df955eb887fbea">app_subscribe_endpoint</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, struct <a class="el" href="../../d4/df2/structast__endpoint.html">ast_endpoint</a> *endpoint)</td></tr>
<tr class="memdesc:a021ad5ebb8ff3d64b1df955eb887fbea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subscribes an application to a endpoint.  <a href="#a021ad5ebb8ff3d64b1df955eb887fbea">More...</a><br /></td></tr>
<tr class="separator:a021ad5ebb8ff3d64b1df955eb887fbea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6099632575d3b2fd83d64698b1114c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a2e6099632575d3b2fd83d64698b1114c">app_to_json</a> (const struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>)</td></tr>
<tr class="memdesc:a2e6099632575d3b2fd83d64698b1114c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a JSON representation of a <code><a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a></code>.  <a href="#a2e6099632575d3b2fd83d64698b1114c">More...</a><br /></td></tr>
<tr class="separator:a2e6099632575d3b2fd83d64698b1114c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3319e8e92c07466ddc920e885c6d23f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a3319e8e92c07466ddc920e885c6d23f0">app_unsubscribe_bridge</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, struct <a class="el" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge)</td></tr>
<tr class="memdesc:a3319e8e92c07466ddc920e885c6d23f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel the bridge subscription for an application.  <a href="#a3319e8e92c07466ddc920e885c6d23f0">More...</a><br /></td></tr>
<tr class="separator:a3319e8e92c07466ddc920e885c6d23f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a564345075a21180f2186dbae310f72"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a0a564345075a21180f2186dbae310f72">app_unsubscribe_bridge_id</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *bridge_id)</td></tr>
<tr class="memdesc:a0a564345075a21180f2186dbae310f72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel the subscription an app has for a bridge.  <a href="#a0a564345075a21180f2186dbae310f72">More...</a><br /></td></tr>
<tr class="separator:a0a564345075a21180f2186dbae310f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a451e2970210436f5fd6ffdb94d38f7b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a451e2970210436f5fd6ffdb94d38f7b2">app_unsubscribe_channel</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</td></tr>
<tr class="memdesc:a451e2970210436f5fd6ffdb94d38f7b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel the subscription an app has for a channel.  <a href="#a451e2970210436f5fd6ffdb94d38f7b2">More...</a><br /></td></tr>
<tr class="separator:a451e2970210436f5fd6ffdb94d38f7b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb98d263b0d1405caa0a948bf49b5985"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#abb98d263b0d1405caa0a948bf49b5985">app_unsubscribe_channel_id</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *channel_id)</td></tr>
<tr class="memdesc:abb98d263b0d1405caa0a948bf49b5985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel the subscription an app has for a channel.  <a href="#abb98d263b0d1405caa0a948bf49b5985">More...</a><br /></td></tr>
<tr class="separator:abb98d263b0d1405caa0a948bf49b5985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77b1e94137f9d8131f363023261767ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a77b1e94137f9d8131f363023261767ec">app_unsubscribe_endpoint_id</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *endpoint_id)</td></tr>
<tr class="memdesc:a77b1e94137f9d8131f363023261767ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel the subscription an app has for a endpoint.  <a href="#a77b1e94137f9d8131f363023261767ec">More...</a><br /></td></tr>
<tr class="separator:a77b1e94137f9d8131f363023261767ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11d8e51b6dc44258770b7a7a9d1e9992"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a11d8e51b6dc44258770b7a7a9d1e9992">app_update</a> (struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, <a class="el" href="../../d8/d9c/stasis__app_8h.html#a745524550c947d73d1dc42de3c74627d">stasis_app_cb</a> <a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, void *data)</td></tr>
<tr class="memdesc:a11d8e51b6dc44258770b7a7a9d1e9992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the handler and data for a <code>res_stasis</code> application.  <a href="#a11d8e51b6dc44258770b7a7a9d1e9992">More...</a><br /></td></tr>
<tr class="separator:a11d8e51b6dc44258770b7a7a9d1e9992"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Internal API for the Stasis application controller. </p>
<dl class="section author"><dt>Author</dt><dd>David M. Lee, II <a href="#" onclick="location.href='mai'+'lto:'+'dle'+'e@'+'dig'+'iu'+'m.c'+'om'; return false;">dlee@<span style="display: none;">.nosp@m.</span>digi<span style="display: none;">.nosp@m.</span>um.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../df/d5f/res_2stasis_2app_8h_source.html">res/stasis/app.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aed792ab54d9817f46bfcc787e2754dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed792ab54d9817f46bfcc787e2754dc8">&#9670;&nbsp;</a></span>stasis_app_subscription_model</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8">stasis_app_subscription_model</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aed792ab54d9817f46bfcc787e2754dc8ab68b1338eae899760e38b8d0c684e007"></a>STASIS_APP_SUBSCRIBE_MANUAL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aed792ab54d9817f46bfcc787e2754dc8abb410559dd7f7ee3fbd477cc39d73afe"></a>STASIS_APP_SUBSCRIBE_ALL&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../df/d5f/res_2stasis_2app_8h_source.html#l00039">39</a> of file <a class="el" href="../../df/d5f/res_2stasis_2app_8h_source.html">res/stasis/app.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                   {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">    * \brief An application must manually subscribe to each</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">    * resource that it cares about. This is the default approach.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <a class="code" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8ab68b1338eae899760e38b8d0c684e007">STASIS_APP_SUBSCRIBE_MANUAL</a>,</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">    * \brief An application is automatically subscribed to all</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">    * resources in Asterisk, even if it does not control them.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <a class="code" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8abb410559dd7f7ee3fbd477cc39d73afe">STASIS_APP_SUBSCRIBE_ALL</a></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;};</div><div class="ttc" id="res_2stasis_2app_8h_html_aed792ab54d9817f46bfcc787e2754dc8ab68b1338eae899760e38b8d0c684e007"><div class="ttname"><a href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8ab68b1338eae899760e38b8d0c684e007">STASIS_APP_SUBSCRIBE_MANUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5f/res_2stasis_2app_8h_source.html#l00044">res/stasis/app.h:44</a></div></div>
<div class="ttc" id="res_2stasis_2app_8h_html_aed792ab54d9817f46bfcc787e2754dc8abb410559dd7f7ee3fbd477cc39d73afe"><div class="ttname"><a href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8abb410559dd7f7ee3fbd477cc39d73afe">STASIS_APP_SUBSCRIBE_ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d5f/res_2stasis_2app_8h_source.html#l00049">res/stasis/app.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="acf8bdfbd0c394c97598c4e0565525504"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf8bdfbd0c394c97598c4e0565525504">&#9670;&nbsp;</a></span>app_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a>* app_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/d9c/stasis__app_8h.html#a745524550c947d73d1dc42de3c74627d">stasis_app_cb</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#aed792ab54d9817f46bfcc787e2754dc8">stasis_app_subscription_model</a>&#160;</td>
          <td class="paramname"><em>subscription_model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a res_stasis application. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the application. </td></tr>
    <tr><td class="paramname">handler</td><td>Callback for messages sent to the application. </td></tr>
    <tr><td class="paramname">data</td><td>Data pointer provided to the callback. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New <code>res_stasis</code> application. </dd>
<dd>
<code>NULL</code> on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00915">915</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01205">AO2_CONTAINER_ALLOC_OPT_DUPS_OBJ_REJECT</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01358">ao2_container_alloc_rbtree</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d0/db6/app__mysql_8c_source.html#l00062">app</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00287">app_dtor()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l06970">ast_add_extension()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d4e/stasis__bridges_8h.html#a263062ed75918c257f5401617389bdd8">ast_attended_transfer_type()</a>, <a class="el" href="../../dc/d4e/stasis__bridges_8h.html#a05b1c5a7666e29a9ec982e3c9d6c1b85">ast_blind_transfer_type()</a>, <a class="el" href="../../dc/d4e/stasis__bridges_8h.html#a20be59047a504f4c5dca2289beef7963">ast_bridge_merge_message_type()</a>, <a class="el" href="../../dc/d4e/stasis__bridges_8h.html#a93724fb58fab92a0a749535e8c8534d2">ast_bridge_snapshot_type()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00179">ast_bridge_topic_all()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga8fb4dbec86956e211c0489112a6de975">ast_channel_snapshot_type()</a>, <a class="el" href="../../d4/dc5/extconf_8c_source.html#l04174">ast_context_find()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l06198">ast_context_find_or_create()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf23b8f5195f28ae2044eae71be431433">ast_endpoint_snapshot_type()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d9/db0/astmm_8c_source.html#l01771">ast_free_ptr()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00786">bridge_attended_transfer_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00773">bridge_blind_transfer_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00733">bridge_merge_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00832">bridge_subscription_change_handler()</a>, <a class="el" href="../../dc/dcf/func__periodic__hook_8c_source.html#l00092">context_name</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00257">forwards_sort()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">stasis_app::handler</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00310">stasis_message_router_add()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00336">stasis_message_router_add_cache_update()</a>, <a class="el" href="../../d4/d25/stasis__message__router_8h_source.html#l00060">stasis_message_router_create</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00397">stasis_message_router_set_formatters_default()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00313">STASIS_SUBSCRIPTION_FORMATTER_JSON</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00682">sub_bridge_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00543">sub_channel_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00347">sub_default_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00628">sub_endpoint_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00337">sub_subscription_change_handler()</a>, and <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00065">stasis_app::subscription_model</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01726">__stasis_app_register()</a>.</p>
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;{</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/de3/structstasis__app.html">stasis_app</a> *, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   <span class="keywordtype">size_t</span> size;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;   <span class="keywordtype">size_t</span> context_size = strlen(<span class="stringliteral">&quot;stasis-&quot;</span>) + strlen(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) + 1;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dc/dcf/func__periodic__hook_8c.html#ab32539883094fa1c8103ce4b6ec197c2">context_name</a>[context_size];</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   <span class="keywordtype">char</span> *topic_name;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Creating Stasis app &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   size = <span class="keyword">sizeof</span>(*app) + strlen(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) + 1;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(size, <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a49502a8f4f6c56e70abb37eca7586fcc">app_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>) {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;subscription_model = subscription_model;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>,</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520aca2ee9edd754d08a5f1773d48534c15dfa">AO2_CONTAINER_ALLOC_OPT_DUPS_OBJ_REJECT</a>,</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#ac76af524af8e609eb73505a2df25a8be">forwards_sort</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;forwards) {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;topic_name, <span class="stringliteral">&quot;ari:application/%s&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <span class="keywordflow">if</span> (ret &lt; 0) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;topic = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(topic_name);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(topic_name);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;topic) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;bridge_router = <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a1a1761c57f73009d305f95d8ad99e2a7">stasis_message_router_create</a>(<a class="code" href="../../dc/d4e/stasis__bridges_8h.html#abf64fa441014314244648caa6c8ab80b">ast_bridge_topic_all</a>());</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;bridge_router) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;bridge_router,</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a20be59047a504f4c5dca2289beef7963">ast_bridge_merge_message_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#aa2949083f6331aa1b0de16d83fdba25f">bridge_merge_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;bridge_router,</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a05b1c5a7666e29a9ec982e3c9d6c1b85">ast_blind_transfer_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a90a34a08e7562dd1161c75cd2a5c382f">bridge_blind_transfer_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;bridge_router,</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a263062ed75918c257f5401617389bdd8">ast_attended_transfer_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a9fead1d348a2dbf1bfc11ebb612f30c7">bridge_attended_transfer_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;bridge_router,</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a83d47dfce3749c491ee7f6711e5d7af0">bridge_subscription_change_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <span class="comment">/* Bridge router holds a reference */</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>, +1);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;router = <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a1a1761c57f73009d305f95d8ad99e2a7">stasis_message_router_create</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;topic);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;router) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;router,</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <a class="code" href="../../dc/d4e/stasis__bridges_8h.html#a93724fb58fab92a0a749535e8c8534d2">ast_bridge_snapshot_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#aab4771e60b5ab6b5a3289806acc68aaf">sub_bridge_update_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;router,</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga8fb4dbec86956e211c0489112a6de975">ast_channel_snapshot_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#abac7a8471d743c59f9d8051afc4b8ed9">sub_channel_update_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a77e2b34cd6f7daafb7bb43bfd6642cbc">stasis_message_router_add_cache_update</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;router,</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gaf23b8f5195f28ae2044eae71be431433">ast_endpoint_snapshot_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a24dbf4e305ed6eb791452b12e3c04109">sub_endpoint_update_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;router,</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>(), <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a677989a38a05fde4d3dc237294c8fdaf">sub_subscription_change_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#ac911cfd927625dfd7d78908aae0fec80">stasis_message_router_set_formatters_default</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;router,</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a687b2abb6bfcf3d33553ccff3215535d">sub_default_handler</a>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587">STASIS_SUBSCRIPTION_FORMATTER_JSON</a>);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <span class="comment">/* Router holds a reference */</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>, +1);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   strncpy(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;name, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, size - <span class="keyword">sizeof</span>(*<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>));</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;handler = <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>-&gt;data = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(data);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <span class="comment">/* Create a context, a match-all extension, and a &#39;h&#39; extension for this application. Note that</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">    * this should only be done if a context does not already exist. */</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   strcpy(context_name, <span class="stringliteral">&quot;stasis-&quot;</span>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;   strcat(context_name, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../db/de0/pbx_8h.html#a2e3c5fe3db1ee8cd78f2bf58c9416aa4">ast_context_find</a>(context_name)) {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../db/de0/pbx_8h.html#a8a07400b41b3302edf8aef9f53644698">ast_context_find_or_create</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context_name, <span class="stringliteral">&quot;res_stasis&quot;</span>)) {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Could not create context &#39;%s&#39; for Stasis application &#39;%s&#39;\n&quot;</span>, context_name, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a07176e8d314eb68b3b50279fafa11390">ast_add_extension</a>(context_name, 0, <span class="stringliteral">&quot;_.&quot;</span>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Stasis&quot;</span>, <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>), <a class="code" href="../../d8/d8a/astmm_8h.html#ad42ab843b767e8b57162c10a158b75c3">ast_free_ptr</a>, <span class="stringliteral">&quot;res_stasis&quot;</span>);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a07176e8d314eb68b3b50279fafa11390">ast_add_extension</a>(context_name, 0, <span class="stringliteral">&quot;h&quot;</span>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;NoOp&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;res_stasis&quot;</span>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Not creating context &#39;%s&#39; for Stasis application &#39;%s&#39; because it already exists\n&quot;</span>,</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;         context_name, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>, +1);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div><div class="ttc" id="stasis__bridges_8h_html_a93724fb58fab92a0a749535e8c8534d2"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a93724fb58fab92a0a749535e8c8534d2">ast_bridge_snapshot_type</a></div><div class="ttdeci">struct stasis_message_type * ast_bridge_snapshot_type(void)</div><div class="ttdoc">Message type for ast_bridge_snapshot. </div></div>
<div class="ttc" id="stasis__bridges_8h_html_a05b1c5a7666e29a9ec982e3c9d6c1b85"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a05b1c5a7666e29a9ec982e3c9d6c1b85">ast_blind_transfer_type</a></div><div class="ttdeci">struct stasis_message_type * ast_blind_transfer_type(void)</div><div class="ttdoc">Message type for ast_blind_transfer_message. </div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_aab4771e60b5ab6b5a3289806acc68aaf"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#aab4771e60b5ab6b5a3289806acc68aaf">sub_bridge_update_handler</a></div><div class="ttdeci">static void sub_bridge_update_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00682">res/stasis/app.c:682</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a90a34a08e7562dd1161c75cd2a5c382f"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a90a34a08e7562dd1161c75cd2a5c382f">bridge_blind_transfer_handler</a></div><div class="ttdeci">static void bridge_blind_transfer_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00773">res/stasis/app.c:773</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_abac7a8471d743c59f9d8051afc4b8ed9"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#abac7a8471d743c59f9d8051afc4b8ed9">sub_channel_update_handler</a></div><div class="ttdeci">static void sub_channel_update_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00543">res/stasis/app.c:543</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a677989a38a05fde4d3dc237294c8fdaf"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a677989a38a05fde4d3dc237294c8fdaf">sub_subscription_change_handler</a></div><div class="ttdeci">static void sub_subscription_change_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00337">res/stasis/app.c:337</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a5adc304e693097ec75b474e6a5309958"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a></div><div class="ttdeci">int stasis_message_router_add(struct stasis_message_router *router, struct stasis_message_type *message_type, stasis_subscription_cb callback, void *data)</div><div class="ttdoc">Add a route to a message router. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00310">stasis_message_router.c:310</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_ac76af524af8e609eb73505a2df25a8be"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#ac76af524af8e609eb73505a2df25a8be">forwards_sort</a></div><div class="ttdeci">static int forwards_sort(const void *obj_left, const void *obj_right, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00257">res/stasis/app.c:257</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a49502a8f4f6c56e70abb37eca7586fcc"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a49502a8f4f6c56e70abb37eca7586fcc">app_dtor</a></div><div class="ttdeci">static void app_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00287">res/stasis/app.c:287</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gaf23b8f5195f28ae2044eae71be431433"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gaf23b8f5195f28ae2044eae71be431433">ast_endpoint_snapshot_type</a></div><div class="ttdeci">struct stasis_message_type * ast_endpoint_snapshot_type(void)</div><div class="ttdoc">Message type for ast_endpoint_snapshot. </div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a9fead1d348a2dbf1bfc11ebb612f30c7"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a9fead1d348a2dbf1bfc11ebb612f30c7">bridge_attended_transfer_handler</a></div><div class="ttdeci">static void bridge_attended_transfer_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00786">res/stasis/app.c:786</a></div></div>
<div class="ttc" id="structstasis__app_html"><div class="ttname"><a href="../../d4/de3/structstasis__app.html">stasis_app</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00049">res/stasis/app.c:49</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a77e2b34cd6f7daafb7bb43bfd6642cbc"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a77e2b34cd6f7daafb7bb43bfd6642cbc">stasis_message_router_add_cache_update</a></div><div class="ttdeci">int stasis_message_router_add_cache_update(struct stasis_message_router *router, struct stasis_message_type *message_type, stasis_subscription_cb callback, void *data)</div><div class="ttdoc">Add a route for stasis_cache_update messages to a message router. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00336">stasis_message_router.c:336</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a687b2abb6bfcf3d33553ccff3215535d"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a687b2abb6bfcf3d33553ccff3215535d">sub_default_handler</a></div><div class="ttdeci">static void sub_default_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00347">res/stasis/app.c:347</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astmm_8h_html_ad42ab843b767e8b57162c10a158b75c3"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ad42ab843b767e8b57162c10a158b75c3">ast_free_ptr</a></div><div class="ttdeci">void ast_free_ptr(void *ptr)</div><div class="ttdoc">free() wrapper </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db0/astmm_8c_source.html#l01771">astmm.c:1771</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="func__periodic__hook_8c_html_ab32539883094fa1c8103ce4b6ec197c2"><div class="ttname"><a href="../../dc/dcf/func__periodic__hook_8c.html#ab32539883094fa1c8103ce4b6ec197c2">context_name</a></div><div class="ttdeci">static const char context_name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dcf/func__periodic__hook_8c_source.html#l00092">func_periodic_hook.c:92</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_ac911cfd927625dfd7d78908aae0fec80"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#ac911cfd927625dfd7d78908aae0fec80">stasis_message_router_set_formatters_default</a></div><div class="ttdeci">void stasis_message_router_set_formatters_default(struct stasis_message_router *router, stasis_subscription_cb callback, void *data, enum stasis_subscription_message_formatters formatters)</div><div class="ttdoc">Sets the default route of a router with formatters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00397">stasis_message_router.c:397</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a20be59047a504f4c5dca2289beef7963"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a20be59047a504f4c5dca2289beef7963">ast_bridge_merge_message_type</a></div><div class="ttdeci">struct stasis_message_type * ast_bridge_merge_message_type(void)</div><div class="ttdoc">Message type for ast_bridge_merge_message. </div></div>
<div class="ttc" id="pbx_8h_html_a2e3c5fe3db1ee8cd78f2bf58c9416aa4"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a2e3c5fe3db1ee8cd78f2bf58c9416aa4">ast_context_find</a></div><div class="ttdeci">struct ast_context * ast_context_find(const char *name)</div><div class="ttdoc">Find a context. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l04174">extconf.c:4174</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a1a1761c57f73009d305f95d8ad99e2a7"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a1a1761c57f73009d305f95d8ad99e2a7">stasis_message_router_create</a></div><div class="ttdeci">#define stasis_message_router_create(topic)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d25/stasis__message__router_8h_source.html#l00060">stasis_message_router.h:60</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html_a263062ed75918c257f5401617389bdd8"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#a263062ed75918c257f5401617389bdd8">ast_attended_transfer_type</a></div><div class="ttdeci">struct stasis_message_type * ast_attended_transfer_type(void)</div><div class="ttdoc">Message type for ast_attended_transfer_message. </div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a83d47dfce3749c491ee7f6711e5d7af0"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a83d47dfce3749c491ee7f6711e5d7af0">bridge_subscription_change_handler</a></div><div class="ttdeci">static void bridge_subscription_change_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00832">res/stasis/app.c:832</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga8fb4dbec86956e211c0489112a6de975"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga8fb4dbec86956e211c0489112a6de975">ast_channel_snapshot_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_snapshot_type(void)</div><div class="ttdoc">Message type for ast_channel_snapshot_update. </div></div>
<div class="ttc" id="stasis__bridges_8h_html_abf64fa441014314244648caa6c8ab80b"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html#abf64fa441014314244648caa6c8ab80b">ast_bridge_topic_all</a></div><div class="ttdeci">struct stasis_topic * ast_bridge_topic_all(void)</div><div class="ttdoc">A topic which publishes the events for all bridges. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0f/stasis__bridges_8c_source.html#l00179">stasis_bridges.c:179</a></div></div>
<div class="ttc" id="pbx_8h_html_a07176e8d314eb68b3b50279fafa11390"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a07176e8d314eb68b3b50279fafa11390">ast_add_extension</a></div><div class="ttdeci">int ast_add_extension(const char *context, int replace, const char *extension, int priority, const char *label, const char *callerid, const char *application, void *data, void(*datad)(void *), const char *registrar)</div><div class="ttdoc">Add and extension to an extension context. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l06970">pbx.c:6970</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a24dbf4e305ed6eb791452b12e3c04109"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a24dbf4e305ed6eb791452b12e3c04109">sub_endpoint_update_handler</a></div><div class="ttdeci">static void sub_endpoint_update_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00628">res/stasis/app.c:628</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587">STASIS_SUBSCRIPTION_FORMATTER_JSON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00313">stasis.h:313</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
<div class="ttc" id="astobj2_8h_html_a9657c4f40f012fc1d426c3c94b3d32c0"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9657c4f40f012fc1d426c3c94b3d32c0">ao2_container_alloc_rbtree</a></div><div class="ttdeci">#define ao2_container_alloc_rbtree(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01358">astobj2.h:1358</a></div></div>
<div class="ttc" id="pbx_8h_html_a8a07400b41b3302edf8aef9f53644698"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a8a07400b41b3302edf8aef9f53644698">ast_context_find_or_create</a></div><div class="ttdeci">struct ast_context * ast_context_find_or_create(struct ast_context **extcontexts, struct ast_hashtab *exttable, const char *name, const char *registrar)</div><div class="ttdoc">Register a new context or find an existing one. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l06198">pbx.c:6198</a></div></div>
<div class="ttc" id="app__mysql_8c_html_a1d9b1eccfc259a14525ce817482a3f88"><div class="ttname"><a href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a></div><div class="ttdeci">static const char app[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db6/app__mysql_8c_source.html#l00062">app_mysql.c:62</a></div></div>
<div class="ttc" id="astobj2_8h_html_afe7a6b368052cb171d371d873b7520aca2ee9edd754d08a5f1773d48534c15dfa"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#afe7a6b368052cb171d371d873b7520aca2ee9edd754d08a5f1773d48534c15dfa">AO2_CONTAINER_ALLOC_OPT_DUPS_OBJ_REJECT</a></div><div class="ttdoc">Reject duplicate objects in container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01205">astobj2.h:1205</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_aa2949083f6331aa1b0de16d83fdba25f"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#aa2949083f6331aa1b0de16d83fdba25f">bridge_merge_handler</a></div><div class="ttdeci">static void bridge_merge_handler(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00733">res/stasis/app.c:733</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac70355ddeb33a79cdaf71549b82c22e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac70355ddeb33a79cdaf71549b82c22e8">&#9670;&nbsp;</a></span>app_deactivate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_deactivate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deactivates an application. </p>
<p>Any channels currently in the application remain active (since the app might come back), but new channels are rejected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application to deactivate. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01066">1066</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00063">stasis_app::data</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">stasis_app::handler</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">stasis_app::name</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01787">stasis_app_unregister()</a>.</p>
<div class="fragment"><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;{</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Deactivating Stasis app &#39;%s&#39;\n&quot;</span>, app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">handler</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">data</a>);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;   app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">data</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;}</div><div class="ttc" id="structstasis__app_html_a8c07e1a3c558a90f7a8c55488fb08681"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">stasis_app::handler</a></div><div class="ttdeci">stasis_app_cb handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">res/stasis/app.c:61</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__app_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">stasis_app::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00063">res/stasis/app.c:63</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structstasis__app_html_a635b950b2ddb0f18644a528dbdd60dfe"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">stasis_app::name</a></div><div class="ttdeci">char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">res/stasis/app.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90e3b3e8bf99e659289aacde3e6df03f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90e3b3e8bf99e659289aacde3e6df03f">&#9670;&nbsp;</a></span>app_get_replace_channel_app()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* app_get_replace_channel_app </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the app that the replacement channel will be controlled by. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel</td><td>The channel on which this will be set</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>on error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the name of the controlling app (must be <a class="el" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free()</a>d) </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00967">967</a> of file <a class="el" href="../../d2/d80/res__stasis_8c_source.html">res_stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00873">replace_channel_store::app</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00890">get_replace_channel_store()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l00790">replace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/de0/stasis__bridge_8c_source.html#l00049">bridge_stasis_run_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;{</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d85/structreplace__channel__store.html">replace_channel_store</a> *<a class="code" href="../../d9/d1e/func__strings_8c.html#a7f763283c27da5574f6f8d1b2a2b9288">replace</a> = <a class="code" href="../../d2/d80/res__stasis_8c.html#aeb82aa7656b732bbcb4af3759f04b9fd">get_replace_channel_store</a>(chan, 1);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   <span class="keywordtype">char</span> *replace_channel_app;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="keywordflow">if</span> (!replace) {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   replace_channel_app = replace-&gt;<a class="code" href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   replace-&gt;<a class="code" href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="keywordflow">return</span> replace_channel_app;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structreplace__channel__store_html"><div class="ttname"><a href="../../d2/d85/structreplace__channel__store.html">replace_channel_store</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00871">res_stasis.c:871</a></div></div>
<div class="ttc" id="func__strings_8c_html_a7f763283c27da5574f6f8d1b2a2b9288"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#a7f763283c27da5574f6f8d1b2a2b9288">replace</a></div><div class="ttdeci">static int replace(struct ast_channel *chan, const char *cmd, char *data, struct ast_str **buf, ssize_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00790">func_strings.c:790</a></div></div>
<div class="ttc" id="structreplace__channel__store_html_a9e5f57131367eff409b9e0bd7b31aa1a"><div class="ttname"><a href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">replace_channel_store::app</a></div><div class="ttdeci">char * app</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00873">res_stasis.c:873</a></div></div>
<div class="ttc" id="res__stasis_8c_html_aeb82aa7656b732bbcb4af3759f04b9fd"><div class="ttname"><a href="../../d2/d80/res__stasis_8c.html#aeb82aa7656b732bbcb4af3759f04b9fd">get_replace_channel_store</a></div><div class="ttdeci">static struct replace_channel_store * get_replace_channel_store(struct ast_channel *chan, int no_create)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00890">res_stasis.c:890</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aafff5782ef991feae701cb5762457461"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafff5782ef991feae701cb5762457461">&#9670;&nbsp;</a></span>app_is_active()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_is_active </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether an app is active. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True (non-zero) if app is active. </dd>
<dd>
False (zero) if app has been deactivated. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01094">1094</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">stasis_app::handler</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01324">stasis_app_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;{</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;   ret = app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">handler</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;}</div><div class="ttc" id="structstasis__app_html_a8c07e1a3c558a90f7a8c55488fb08681"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">stasis_app::handler</a></div><div class="ttdeci">stasis_app_cb handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">res/stasis/app.c:61</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fb21fd32f98d4bdea9de6f9c5eea752"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb21fd32f98d4bdea9de6f9c5eea752">&#9670;&nbsp;</a></span>app_is_finished()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_is_finished </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether a deactivated app has no channels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application to check. </td></tr>
    <tr><td class="paramname">True</td><td>(non-zero) if app is deactivated, and has no associated channels. </td></tr>
    <tr><td class="paramname">False</td><td>(zero) otherwise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01105">1105</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00034">ao2_container_count()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">stasis_app::handler</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01078">app_shutdown()</a>, and <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00309">cleanup_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;{</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;   ret = app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">handler</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>) == 0;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a512cc40ce96c63b3d5c78040baa4c9cd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a></div><div class="ttdeci">int ao2_container_count(struct ao2_container *c)</div><div class="ttdoc">Returns the number of elements in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00034">astobj2_container.c:34</a></div></div>
<div class="ttc" id="structstasis__app_html_a8c07e1a3c558a90f7a8c55488fb08681"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">stasis_app::handler</a></div><div class="ttdeci">stasis_app_cb handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">res/stasis/app.c:61</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abfdcc440a99fdb9cc42937a884ba0ee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfdcc440a99fdb9cc42937a884ba0ee6">&#9670;&nbsp;</a></span>app_is_subscribed_bridge_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_is_subscribed_bridge_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>bridge_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test if an app is subscribed to a bridge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Subscribing application. </td></tr>
    <tr><td class="paramname">bridge_id</td><td>Id of bridge to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True (non-zero) if bridge is subscribed to <em>app</em>. </dd>
<dd>
False (zero) if bridge is not subscribed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01504">1504</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00040">BRIDGE_ALL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>
<div class="fragment"><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;{</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc4/structapp__forwards.html">app_forwards</a> *forwards;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(bridge_id)) {</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      bridge_id = <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a9ac9137d8506b8244b41486bf8e9d2a6">BRIDGE_ALL</a>;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;   }</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, bridge_id, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(forwards);</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;   <span class="keywordflow">return</span> forwards != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structapp__forwards_html"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html">app_forwards</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00083">res/stasis/app.c:83</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a9ac9137d8506b8244b41486bf8e9d2a6"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a9ac9137d8506b8244b41486bf8e9d2a6">BRIDGE_ALL</a></div><div class="ttdeci">#define BRIDGE_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00040">res/stasis/app.c:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a316a1a996a5456a1b7422cc05add62e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a316a1a996a5456a1b7422cc05add62e6">&#9670;&nbsp;</a></span>app_is_subscribed_channel_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_is_subscribed_channel_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>channel_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test if an app is subscribed to a channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Subscribing application. </td></tr>
    <tr><td class="paramname">channel_id</td><td>Id of channel to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True (non-zero) if channel is subscribed to <em>app</em>. </dd>
<dd>
False (zero) if channel is not subscribed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01402">1402</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00041">CHANNEL_ALL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>
<div class="fragment"><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;{</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc4/structapp__forwards.html">app_forwards</a> *forwards;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(channel_id)) {</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      channel_id = <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a22bebb2d35ffb38b9bb202e88822d74c">CHANNEL_ALL</a>;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;   }</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, channel_id, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(forwards);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   <span class="keywordflow">return</span> forwards != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div><div class="ttc" id="res_2stasis_2app_8c_html_a22bebb2d35ffb38b9bb202e88822d74c"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a22bebb2d35ffb38b9bb202e88822d74c">CHANNEL_ALL</a></div><div class="ttdeci">#define CHANNEL_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00041">res/stasis/app.c:41</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structapp__forwards_html"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html">app_forwards</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00083">res/stasis/app.c:83</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a1f3daa5de52b71b552447ad5079f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a1f3daa5de52b71b552447ad5079f7b">&#9670;&nbsp;</a></span>app_is_subscribed_endpoint_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_is_subscribed_endpoint_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>endpoint_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test if an app is subscribed to a endpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Subscribing application. </td></tr>
    <tr><td class="paramname">endpoint_id</td><td>Id of endpoint to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True (non-zero) if endpoint is subscribed to <em>app</em>. </dd>
<dd>
False (zero) if endpoint is not subscribed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01601">1601</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00042">ENDPOINT_ALL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>
<div class="fragment"><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;{</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc4/structapp__forwards.html">app_forwards</a> *forwards;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(endpoint_id)) {</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      endpoint_id = <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#adb679c8c5450b8fdc65ef309ac078d76">ENDPOINT_ALL</a>;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;   }</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, endpoint_id, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(forwards);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;   <span class="keywordflow">return</span> forwards != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structapp__forwards_html"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html">app_forwards</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00083">res/stasis/app.c:83</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_adb679c8c5450b8fdc65ef309ac078d76"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#adb679c8c5450b8fdc65ef309ac078d76">ENDPOINT_ALL</a></div><div class="ttdeci">#define ENDPOINT_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00042">res/stasis/app.c:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc2b5ef224bf880e5ef556a910f41a37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc2b5ef224bf880e5ef556a910f41a37">&#9670;&nbsp;</a></span>app_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a message to an application. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application. </td></tr>
    <tr><td class="paramname">message</td><td>Message to send.</td></tr>
  </table>
  </dd>
</dl>
<p>Send a message to an application.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>App to send the message to. </td></tr>
    <tr><td class="paramname">message</td><td>Message to send. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01038">1038</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02587">ast_eid_to_str()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00404">ast_json_object_set()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00268">ast_json_string_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00273">ast_json_string_get()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00279">AST_LOG_WARNING</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00063">stasis_app::data</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">stasis_app::handler</a>, and <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">stasis_app::name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01116">app_update()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00584">message_received_handler()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01324">stasis_app_exec()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01656">stasis_app_send()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00682">sub_bridge_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00543">sub_channel_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00347">sub_default_handler()</a>, and <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00628">sub_endpoint_update_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;{</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   <a class="code" href="../../d8/d9c/stasis__app_8h.html#a745524550c947d73d1dc42de3c74627d">stasis_app_cb</a> <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   <span class="keywordtype">char</span> eid[20];</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   <span class="keywordtype">void</span> *data;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(message, <span class="stringliteral">&quot;asterisk_id&quot;</span>, <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a>(eid, <span class="keyword">sizeof</span>(eid), &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>)))) {</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to append EID to outgoing event %s\n&quot;</span>,</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;         <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(message, <span class="stringliteral">&quot;type&quot;</span>)));</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;   }</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   <span class="comment">/* Copy off mutable state with lock held */</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   handler = app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">handler</a>;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;   data = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">data</a>);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;   <span class="comment">/* Name is immutable; no need to copy */</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;   <span class="keywordflow">if</span> (handler) {</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>(data, app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>, message);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3,</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;         <span class="stringliteral">&quot;Inactive Stasis app &#39;%s&#39; missed message\n&quot;</span>, app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(data);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;}</div><div class="ttc" id="utils_8h_html_a8ebf6841073ea2a063a0c86a5092a85b"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a8ebf6841073ea2a063a0c86a5092a85b">ast_eid_to_str</a></div><div class="ttdeci">char * ast_eid_to_str(char *s, int maxlen, struct ast_eid *eid)</div><div class="ttdoc">Convert an EID to a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02587">main/utils.c:2587</a></div></div>
<div class="ttc" id="logger_8h_html_a2878d83e36d91850732bad997524e45e"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a></div><div class="ttdeci">#define AST_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00279">logger.h:279</a></div></div>
<div class="ttc" id="structstasis__app_html_a8c07e1a3c558a90f7a8c55488fb08681"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">stasis_app::handler</a></div><div class="ttdeci">stasis_app_cb handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">res/stasis/app.c:61</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="structstasis__app_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">stasis_app::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00063">res/stasis/app.c:63</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="json_8h_html_abc8b563c172cfaffa2b555195990f729"><div class="ttname"><a href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a></div><div class="ttdeci">int ast_json_object_set(struct ast_json *object, const char *key, struct ast_json *value)</div><div class="ttdoc">Set a field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00404">json.c:404</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="json_8h_html_adc52f8d76b7fdd0c8d12987981fd5bf5"><div class="ttname"><a href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a></div><div class="ttdeci">struct ast_json * ast_json_string_create(const char *value)</div><div class="ttdoc">Construct a JSON string from value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00268">json.c:268</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="structstasis__app_html_a635b950b2ddb0f18644a528dbdd60dfe"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">stasis_app::name</a></div><div class="ttdeci">char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">res/stasis/app.c:73</a></div></div>
<div class="ttc" id="stasis__app_8h_html_a745524550c947d73d1dc42de3c74627d"><div class="ttname"><a href="../../d8/d9c/stasis__app_8h.html#a745524550c947d73d1dc42de3c74627d">stasis_app_cb</a></div><div class="ttdeci">void(* stasis_app_cb)(void *data, const char *app_name, struct ast_json *message)</div><div class="ttdoc">Callback for Stasis application handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d9c/stasis__app_8h_source.html#l00067">stasis_app.h:67</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a814d56d14f2e4afead2c709145b240f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a814d56d14f2e4afead2c709145b240f3">&#9670;&nbsp;</a></span>app_send_end_msg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_send_end_msg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send StasisEnd message to the listening app. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>The app that owns the channel </td></tr>
    <tr><td class="paramname">chan</td><td>The channel for which the message is being sent</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">zero</td><td>on success </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>non-zero on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01083">1083</a> of file <a class="el" href="../../d2/d80/res__stasis_8c_source.html">res_stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01384">app_unsubscribe_channel()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01028">ast_app_get_topic()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00788">ast_channel_blob_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00591">ast_json_pack()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00649">ast_json_timeval()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00144">start_message_blob::blob</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00232">stasis_message_sanitizer::channel</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01236">remove_masquerade_store()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l02264">stasis_app_get_sanitizer()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01156">stasis_app_name()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/de0/stasis__bridge_8c_source.html#l00248">bridge_stasis_moving()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01159">channel_replaced_cb()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01128">channel_stolen_cb()</a>, and <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01324">stasis_app_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;{</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d45/structstasis__message__sanitizer.html">stasis_message_sanitizer</a> *sanitize = <a class="code" href="../../d2/d80/res__stasis_8c.html#a75e0d54649ef61d0ac78c70bf9ff58ec">stasis_app_get_sanitizer</a>();</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *blob;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   <span class="keywordflow">if</span> (sanitize &amp;&amp; sanitize-&gt;<a class="code" href="../../d4/d45/structstasis__message__sanitizer.html#a52db905aedac0c5ce25976826d0e33f2">channel</a></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      &amp;&amp; sanitize-&gt;<a class="code" href="../../d4/d45/structstasis__message__sanitizer.html#a52db905aedac0c5ce25976826d0e33f2">channel</a>(chan)) {</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;   }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: o}&quot;</span>,</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="stringliteral">&quot;app&quot;</span>, <a class="code" href="../../d8/d9c/stasis__app_8h.html#a8f04206486943b8208052323a7dfd101">stasis_app_name</a>(app),</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="stringliteral">&quot;timestamp&quot;</span>, <a class="code" href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      );</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   <span class="keywordflow">if</span> (!blob) {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Error packing JSON for StasisEnd message\n&quot;</span>);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;   }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;   <a class="code" href="../../d2/d80/res__stasis_8c.html#ac5d6bc383547bf03ea940e5fd25b04ec">remove_masquerade_store</a>(chan);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a451e2970210436f5fd6ffdb94d38f7b2">app_unsubscribe_channel</a>(app, chan);</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   msg = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gae23eb2907ce7b59817fc0e47f09abf42">ast_channel_blob_create</a>(chan, end_message_type(), blob);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;   <span class="keywordflow">if</span> (msg) {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../d8/d9c/stasis__app_8h.html#a1c95eccf2647ee7aba08fd47933940d7">ast_app_get_topic</a>(app), msg);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;   }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(msg);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(blob);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;}</div><div class="ttc" id="stasis__app_8h_html_a1c95eccf2647ee7aba08fd47933940d7"><div class="ttname"><a href="../../d8/d9c/stasis__app_8h.html#a1c95eccf2647ee7aba08fd47933940d7">ast_app_get_topic</a></div><div class="ttdeci">struct stasis_topic * ast_app_get_topic(struct stasis_app *app)</div><div class="ttdoc">Returns the stasis topic for an app. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01028">res/stasis/app.c:1028</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a451e2970210436f5fd6ffdb94d38f7b2"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a451e2970210436f5fd6ffdb94d38f7b2">app_unsubscribe_channel</a></div><div class="ttdeci">int app_unsubscribe_channel(struct stasis_app *app, struct ast_channel *chan)</div><div class="ttdoc">Cancel the subscription an app has for a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01384">res/stasis/app.c:1384</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="res__stasis_8c_html_ac5d6bc383547bf03ea940e5fd25b04ec"><div class="ttname"><a href="../../d2/d80/res__stasis_8c.html#ac5d6bc383547bf03ea940e5fd25b04ec">remove_masquerade_store</a></div><div class="ttdeci">static void remove_masquerade_store(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l01236">res_stasis.c:1236</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__stasis_8c_html_a75e0d54649ef61d0ac78c70bf9ff58ec"><div class="ttname"><a href="../../d2/d80/res__stasis_8c.html#a75e0d54649ef61d0ac78c70bf9ff58ec">stasis_app_get_sanitizer</a></div><div class="ttdeci">struct stasis_message_sanitizer * stasis_app_get_sanitizer(void)</div><div class="ttdoc">Get the Stasis message sanitizer for app_stasis applications. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l02264">res_stasis.c:2264</a></div></div>
<div class="ttc" id="structstasis__message__sanitizer_html"><div class="ttname"><a href="../../d4/d45/structstasis__message__sanitizer.html">stasis_message_sanitizer</a></div><div class="ttdoc">Structure containing callbacks for Stasis message sanitization. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00200">stasis.h:200</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="stasis__app_8h_html_a8f04206486943b8208052323a7dfd101"><div class="ttname"><a href="../../d8/d9c/stasis__app_8h.html#a8f04206486943b8208052323a7dfd101">stasis_app_name</a></div><div class="ttdeci">const char * stasis_app_name(const struct stasis_app *app)</div><div class="ttdoc">Retrieve an application&amp;#39;s name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01156">res/stasis/app.c:1156</a></div></div>
<div class="ttc" id="structstasis__message__sanitizer_html_a52db905aedac0c5ce25976826d0e33f2"><div class="ttname"><a href="../../d4/d45/structstasis__message__sanitizer.html#a52db905aedac0c5ce25976826d0e33f2">stasis_message_sanitizer::channel</a></div><div class="ttdeci">int(* channel)(const struct ast_channel *chan)</div><div class="ttdoc">Callback which determines whether a channel should be sanitized from a message based on the channel...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00232">stasis.h:232</a></div></div>
<div class="ttc" id="json_8h_html_a2b7c72e2e3ab2634d8a4f8b708440d95"><div class="ttname"><a href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a></div><div class="ttdeci">struct ast_json * ast_json_timeval(const struct timeval tv, const char *zone)</div><div class="ttdoc">Construct a timeval as JSON. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00649">json.c:649</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gae23eb2907ce7b59817fc0e47f09abf42"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gae23eb2907ce7b59817fc0e47f09abf42">ast_channel_blob_create</a></div><div class="ttdeci">struct stasis_message * ast_channel_blob_create(struct ast_channel *chan, struct stasis_message_type *type, struct ast_json *blob)</div><div class="ttdoc">Creates a ast_channel_blob message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00788">stasis_channels.c:788</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0921b1de9a2b8d700ac18f594e98727b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0921b1de9a2b8d700ac18f594e98727b">&#9670;&nbsp;</a></span>app_set_replace_channel_app()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_set_replace_channel_app </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>replace_app</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the app that the replacement channel will be controlled by. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel</td><td>The channel on which this will be set </td></tr>
    <tr><td class="paramname">replace_app</td><td>The app that will be controlling this channel</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">zero</td><td>success </td></tr>
    <tr><td class="paramname">non-zero</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00931">931</a> of file <a class="el" href="../../d2/d80/res__stasis_8c_source.html">res_stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00873">replace_channel_store::app</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00890">get_replace_channel_store()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l00790">replace()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/de0/stasis__bridge_8c_source.html#l00142">bridge_stasis_push_peek()</a>.</p>
<div class="fragment"><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;{</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d85/structreplace__channel__store.html">replace_channel_store</a> *<a class="code" href="../../d9/d1e/func__strings_8c.html#a7f763283c27da5574f6f8d1b2a2b9288">replace</a> = <a class="code" href="../../d2/d80/res__stasis_8c.html#aeb82aa7656b732bbcb4af3759f04b9fd">get_replace_channel_store</a>(chan, 0);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   <span class="keywordflow">if</span> (!replace) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   }</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(replace-&gt;<a class="code" href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;   replace-&gt;<a class="code" href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;   <span class="keywordflow">if</span> (replace_app) {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      replace-&gt;<a class="code" href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(replace_app);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <span class="keywordflow">if</span> (!replace-&gt;<a class="code" href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>) {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      }</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   }</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;}</div><div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structreplace__channel__store_html"><div class="ttname"><a href="../../d2/d85/structreplace__channel__store.html">replace_channel_store</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00871">res_stasis.c:871</a></div></div>
<div class="ttc" id="func__strings_8c_html_a7f763283c27da5574f6f8d1b2a2b9288"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#a7f763283c27da5574f6f8d1b2a2b9288">replace</a></div><div class="ttdeci">static int replace(struct ast_channel *chan, const char *cmd, char *data, struct ast_str **buf, ssize_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00790">func_strings.c:790</a></div></div>
<div class="ttc" id="structreplace__channel__store_html_a9e5f57131367eff409b9e0bd7b31aa1a"><div class="ttname"><a href="../../d2/d85/structreplace__channel__store.html#a9e5f57131367eff409b9e0bd7b31aa1a">replace_channel_store::app</a></div><div class="ttdeci">char * app</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00873">res_stasis.c:873</a></div></div>
<div class="ttc" id="res__stasis_8c_html_aeb82aa7656b732bbcb4af3759f04b9fd"><div class="ttname"><a href="../../d2/d80/res__stasis_8c.html#aeb82aa7656b732bbcb4af3759f04b9fd">get_replace_channel_store</a></div><div class="ttdeci">static struct replace_channel_store * get_replace_channel_store(struct ast_channel *chan, int no_create)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00890">res_stasis.c:890</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a18bd387c4272cbb57cc038bc96b789a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18bd387c4272cbb57cc038bc96b789a9">&#9670;&nbsp;</a></span>app_set_replace_channel_snapshot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_set_replace_channel_snapshot </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *&#160;</td>
          <td class="paramname"><em>replace_snapshot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the snapshot of the channel that this channel will replace. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel</td><td>The channel on which this will be set </td></tr>
    <tr><td class="paramname">replace_snapshot</td><td>The snapshot of the channel that is being replaced</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">zero</td><td>success </td></tr>
    <tr><td class="paramname">non-zero</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00919">919</a> of file <a class="el" href="../../d2/d80/res__stasis_8c_source.html">res_stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00517">ao2_replace</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00890">get_replace_channel_store()</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l00790">replace()</a>, and <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00872">replace_channel_store::snapshot</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/de0/stasis__bridge_8c_source.html#l00142">bridge_stasis_push_peek()</a>.</p>
<div class="fragment"><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;{</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d85/structreplace__channel__store.html">replace_channel_store</a> *<a class="code" href="../../d9/d1e/func__strings_8c.html#a7f763283c27da5574f6f8d1b2a2b9288">replace</a> = <a class="code" href="../../d2/d80/res__stasis_8c.html#aeb82aa7656b732bbcb4af3759f04b9fd">get_replace_channel_store</a>(chan, 0);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;   <span class="keywordflow">if</span> (!replace) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a>(replace-&gt;<a class="code" href="../../d2/d85/structreplace__channel__store.html#a36584c0251e54a7af4892d63f7a28c77">snapshot</a>, replace_snapshot);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;}</div><div class="ttc" id="structreplace__channel__store_html_a36584c0251e54a7af4892d63f7a28c77"><div class="ttname"><a href="../../d2/d85/structreplace__channel__store.html#a36584c0251e54a7af4892d63f7a28c77">replace_channel_store::snapshot</a></div><div class="ttdeci">struct ast_channel_snapshot * snapshot</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00872">res_stasis.c:872</a></div></div>
<div class="ttc" id="structreplace__channel__store_html"><div class="ttname"><a href="../../d2/d85/structreplace__channel__store.html">replace_channel_store</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00871">res_stasis.c:871</a></div></div>
<div class="ttc" id="func__strings_8c_html_a7f763283c27da5574f6f8d1b2a2b9288"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#a7f763283c27da5574f6f8d1b2a2b9288">replace</a></div><div class="ttdeci">static int replace(struct ast_channel *chan, const char *cmd, char *data, struct ast_str **buf, ssize_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00790">func_strings.c:790</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa81c8462bd0574f4f9e09e71f2772f44"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a></div><div class="ttdeci">#define ao2_replace(dst, src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00517">astobj2.h:517</a></div></div>
<div class="ttc" id="res__stasis_8c_html_aeb82aa7656b732bbcb4af3759f04b9fd"><div class="ttname"><a href="../../d2/d80/res__stasis_8c.html#aeb82aa7656b732bbcb4af3759f04b9fd">get_replace_channel_store</a></div><div class="ttdeci">static struct replace_channel_store * get_replace_channel_store(struct ast_channel *chan, int no_create)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d80/res__stasis_8c_source.html#l00890">res_stasis.c:890</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a364056b7da44bbeee2959155aa4ef72d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a364056b7da44bbeee2959155aa4ef72d">&#9670;&nbsp;</a></span>app_shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_shutdown </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tears down an application. </p>
<p>It should be finished before calling this.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application to unsubscribe. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01078">1078</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01105">app_is_finished()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00055">stasis_app::bridge_router</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00057">stasis_app::endpoint_router</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00053">stasis_app::router</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00258">stasis_message_router_unsubscribe()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00309">cleanup_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;{</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a5fb21fd32f98d4bdea9de6f9c5eea752">app_is_finished</a>(app));</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>);</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a>);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab88eb28b8d887439a811399b36edfbe8">bridge_router</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#af588b244758c3d43c25c556b0cff9ed7">endpoint_router</a>);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#af588b244758c3d43c25c556b0cff9ed7">endpoint_router</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__app_html_af588b244758c3d43c25c556b0cff9ed7"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#af588b244758c3d43c25c556b0cff9ed7">stasis_app::endpoint_router</a></div><div class="ttdeci">struct stasis_message_router * endpoint_router</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00057">res/stasis/app.c:57</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a5fb21fd32f98d4bdea9de6f9c5eea752"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a5fb21fd32f98d4bdea9de6f9c5eea752">app_is_finished</a></div><div class="ttdeci">int app_is_finished(struct stasis_app *app)</div><div class="ttdoc">Checks whether a deactivated app has no channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01105">res/stasis/app.c:1105</a></div></div>
<div class="ttc" id="structstasis__app_html_a85c07e3e0d15ea99cf0c5dbe1dfdcb24"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">stasis_app::router</a></div><div class="ttdeci">struct stasis_message_router * router</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00053">res/stasis/app.c:53</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a5646e370e39cc29f5faa7a30fda11159"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a></div><div class="ttdeci">void stasis_message_router_unsubscribe(struct stasis_message_router *router)</div><div class="ttdoc">Unsubscribe the router from the upstream topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00258">stasis_message_router.c:258</a></div></div>
<div class="ttc" id="structstasis__app_html_ab88eb28b8d887439a811399b36edfbe8"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab88eb28b8d887439a811399b36edfbe8">stasis_app::bridge_router</a></div><div class="ttdeci">struct stasis_message_router * bridge_router</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00055">res/stasis/app.c:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c81b198af25100a727e3b42f6a6a5ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c81b198af25100a727e3b42f6a6a5ab">&#9670;&nbsp;</a></span>app_subscribe_bridge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_subscribe_bridge </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *&#160;</td>
          <td class="paramname"><em>bridge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a bridge subscription to an existing channel subscription. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application. </td></tr>
    <tr><td class="paramname">bridge</td><td>Bridge to subscribe to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01428">1428</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00040">BRIDGE_ALL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00164">forwards_create_bridge()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00085">app_forwards::interested</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">stasis_app::name</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, and <a class="el" href="../../d4/d56/bridge_8h_source.html#l00409">ast_bridge::uniqueid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/de3/control_8c_source.html#l01284">control_swap_channel_in_bridge()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01324">stasis_app_exec()</a>, and <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01481">subscribe_bridge()</a>.</p>
<div class="fragment"><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;{</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc4/structapp__forwards.html">app_forwards</a> *forwards;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;   }</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;   <span class="comment">/* If subscribed to all, don&#39;t subscribe again */</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a9ac9137d8506b8244b41486bf8e9d2a6">BRIDGE_ALL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;   <span class="keywordflow">if</span> (forwards) {</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;   }</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>,</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      bridge ? bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a> : <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a9ac9137d8506b8244b41486bf8e9d2a6">BRIDGE_ALL</a>,</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   <span class="keywordflow">if</span> (!forwards) {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="comment">/* Forwards not found, create one */</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      forwards = <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a3e73e15b929bc0a5d3a69ff8fd96a37d">forwards_create_bridge</a>(app, bridge);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="keywordflow">if</span> (!forwards) {</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      }</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      res = <a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, forwards, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;   }</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;   ++forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">interested</a>;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Bridge &#39;%s&#39; is %d interested in %s\n&quot;</span>,</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      bridge ? bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a> : <span class="stringliteral">&quot;ALL&quot;</span>,</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">interested</a>,</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;}</div><div class="ttc" id="res_2stasis_2app_8c_html_a3e73e15b929bc0a5d3a69ff8fd96a37d"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a3e73e15b929bc0a5d3a69ff8fd96a37d">forwards_create_bridge</a></div><div class="ttdeci">static struct app_forwards * forwards_create_bridge(struct stasis_app *app, struct ast_bridge *bridge)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00164">res/stasis/app.c:164</a></div></div>
<div class="ttc" id="structast__bridge_html_a753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">ast_bridge::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00409">bridge.h:409</a></div></div>
<div class="ttc" id="structapp__forwards_html_a0ebe65d4c1af116e2e32b97cfa46af8a"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">app_forwards::interested</a></div><div class="ttdeci">int interested</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00085">res/stasis/app.c:85</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structapp__forwards_html"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html">app_forwards</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00083">res/stasis/app.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structstasis__app_html_a635b950b2ddb0f18644a528dbdd60dfe"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">stasis_app::name</a></div><div class="ttdeci">char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">res/stasis/app.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a9ac9137d8506b8244b41486bf8e9d2a6"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a9ac9137d8506b8244b41486bf8e9d2a6">BRIDGE_ALL</a></div><div class="ttdeci">#define BRIDGE_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00040">res/stasis/app.c:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b0dbc86b18101e9d9d48b350aeec489"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0dbc86b18101e9d9d48b350aeec489">&#9670;&nbsp;</a></span>app_subscribe_channel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_subscribe_channel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subscribes an application to a channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application. </td></tr>
    <tr><td class="paramname">chan</td><td>Channel to subscribe to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01281">1281</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00305">ast_channel_uniqueid()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00041">CHANNEL_ALL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00136">forwards_create_channel()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00085">app_forwards::interested</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">stasis_app::name</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00318">call_forwarded_handler()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00991">send_start_msg_snapshots()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01984">stasis_app_subscribe_channel()</a>, and <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01334">subscribe_channel()</a>.</p>
<div class="fragment"><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;{</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc4/structapp__forwards.html">app_forwards</a> *forwards;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;   <span class="comment">/* If subscribed to all, don&#39;t subscribe again */</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a22bebb2d35ffb38b9bb202e88822d74c">CHANNEL_ALL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <span class="keywordflow">if</span> (forwards) {</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;   }</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>,</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      chan ? <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan) : <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a22bebb2d35ffb38b9bb202e88822d74c">CHANNEL_ALL</a>,</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;   <span class="keywordflow">if</span> (!forwards) {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="comment">/* Forwards not found, create one */</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      forwards = <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#ad545360ffdd9a3cb168628c715eea3bd">forwards_create_channel</a>(app, chan);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keywordflow">if</span> (!forwards) {</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      }</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      res = <a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, forwards, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;   }</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;   ++forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">interested</a>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Channel &#39;%s&#39; is %d interested in %s\n&quot;</span>,</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      chan ? <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan) : <span class="stringliteral">&quot;ALL&quot;</span>,</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">interested</a>,</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;}</div><div class="ttc" id="structapp__forwards_html_a0ebe65d4c1af116e2e32b97cfa46af8a"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">app_forwards::interested</a></div><div class="ttdeci">int interested</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00085">res/stasis/app.c:85</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a22bebb2d35ffb38b9bb202e88822d74c"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a22bebb2d35ffb38b9bb202e88822d74c">CHANNEL_ALL</a></div><div class="ttdeci">#define CHANNEL_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00041">res/stasis/app.c:41</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structapp__forwards_html"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html">app_forwards</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00083">res/stasis/app.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="structstasis__app_html_a635b950b2ddb0f18644a528dbdd60dfe"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">stasis_app::name</a></div><div class="ttdeci">char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">res/stasis/app.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_ad545360ffdd9a3cb168628c715eea3bd"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#ad545360ffdd9a3cb168628c715eea3bd">forwards_create_channel</a></div><div class="ttdeci">static struct app_forwards * forwards_create_channel(struct stasis_app *app, struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00136">res/stasis/app.c:136</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a021ad5ebb8ff3d64b1df955eb887fbea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a021ad5ebb8ff3d64b1df955eb887fbea">&#9670;&nbsp;</a></span>app_subscribe_endpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_subscribe_endpoint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/df2/structast__endpoint.html">ast_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subscribes an application to a endpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application. </td></tr>
    <tr><td class="paramname">chan</td><td>Endpoint to subscribe to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01531">1531</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00391">ast_endpoint_get_id()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00042">ENDPOINT_ALL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00199">forwards_create_endpoint()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00085">app_forwards::interested</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00584">message_received_handler()</a>, <a class="el" href="../../db/d21/messaging_8c_source.html#l00493">messaging_app_subscribe_endpoint()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">stasis_app::name</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01587">subscribe_endpoint()</a>.</p>
<div class="fragment"><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;{</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc4/structapp__forwards.html">app_forwards</a> *forwards;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;   }</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <span class="comment">/* If subscribed to all, don&#39;t subscribe again */</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#adb679c8c5450b8fdc65ef309ac078d76">ENDPOINT_ALL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;   <span class="keywordflow">if</span> (forwards) {</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   }</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;   forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>,</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      endpoint ? <a class="code" href="../../d4/d61/endpoints_8h.html#acb88bdfcaf27c5ba3d54c8bb44ec480c">ast_endpoint_get_id</a>(endpoint) : <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#adb679c8c5450b8fdc65ef309ac078d76">ENDPOINT_ALL</a>,</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   <span class="keywordflow">if</span> (!forwards) {</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="comment">/* Forwards not found, create one */</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      forwards = <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#afb0022fc4c6dfa2b1cb4f44a0995b6a5">forwards_create_endpoint</a>(app, endpoint);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordflow">if</span> (!forwards) {</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      }</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      res = <a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, forwards, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      }</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <span class="comment">/* Subscribe for messages */</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <a class="code" href="../../db/d21/messaging_8c.html#a0a96e49b9bbe4c2ed54e2ad0be07e7e3">messaging_app_subscribe_endpoint</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>, endpoint, &amp;<a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a58025308dde450a79aa3243f13f7a12a">message_received_handler</a>, app);</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   }</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;   ++forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">interested</a>;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Endpoint &#39;%s&#39; is %d interested in %s\n&quot;</span>,</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      endpoint ? <a class="code" href="../../d4/d61/endpoints_8h.html#acb88bdfcaf27c5ba3d54c8bb44ec480c">ast_endpoint_get_id</a>(endpoint) : <span class="stringliteral">&quot;ALL&quot;</span>,</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">interested</a>,</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>);</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;}</div><div class="ttc" id="structapp__forwards_html_a0ebe65d4c1af116e2e32b97cfa46af8a"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html#a0ebe65d4c1af116e2e32b97cfa46af8a">app_forwards::interested</a></div><div class="ttdeci">int interested</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00085">res/stasis/app.c:85</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structapp__forwards_html"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html">app_forwards</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00083">res/stasis/app.c:83</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="messaging_8c_html_a0a96e49b9bbe4c2ed54e2ad0be07e7e3"><div class="ttname"><a href="../../db/d21/messaging_8c.html#a0a96e49b9bbe4c2ed54e2ad0be07e7e3">messaging_app_subscribe_endpoint</a></div><div class="ttdeci">int messaging_app_subscribe_endpoint(const char *app_name, struct ast_endpoint *endpoint, message_received_cb callback, void *pvt)</div><div class="ttdoc">Subscribe an application to an endpoint for messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d21/messaging_8c_source.html#l00493">messaging.c:493</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_afb0022fc4c6dfa2b1cb4f44a0995b6a5"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#afb0022fc4c6dfa2b1cb4f44a0995b6a5">forwards_create_endpoint</a></div><div class="ttdeci">static struct app_forwards * forwards_create_endpoint(struct stasis_app *app, struct ast_endpoint *endpoint)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00199">res/stasis/app.c:199</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a58025308dde450a79aa3243f13f7a12a"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a58025308dde450a79aa3243f13f7a12a">message_received_handler</a></div><div class="ttdeci">static int message_received_handler(const char *endpoint_id, struct ast_json *json_msg, void *pvt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00584">res/stasis/app.c:584</a></div></div>
<div class="ttc" id="structstasis__app_html_a635b950b2ddb0f18644a528dbdd60dfe"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">stasis_app::name</a></div><div class="ttdeci">char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">res/stasis/app.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="endpoints_8h_html_acb88bdfcaf27c5ba3d54c8bb44ec480c"><div class="ttname"><a href="../../d4/d61/endpoints_8h.html#acb88bdfcaf27c5ba3d54c8bb44ec480c">ast_endpoint_get_id</a></div><div class="ttdeci">const char * ast_endpoint_get_id(const struct ast_endpoint *endpoint)</div><div class="ttdoc">Gets the tech/resource id of the given endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d4b/main_2endpoints_8c_source.html#l00391">main/endpoints.c:391</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_adb679c8c5450b8fdc65ef309ac078d76"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#adb679c8c5450b8fdc65ef309ac078d76">ENDPOINT_ALL</a></div><div class="ttdeci">#define ENDPOINT_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00042">res/stasis/app.c:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e6099632575d3b2fd83d64698b1114c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e6099632575d3b2fd83d64698b1114c">&#9670;&nbsp;</a></span>app_to_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a>* app_to_json </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a JSON representation of a <code><a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a></code>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>The application</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>JSON</code> blob on success </dd>
<dd>
<code>NULL</code> on error </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01228">1228</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00534">ao2_iterator_destroy()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00485">ao2_iterator_init()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01933">ao2_iterator_next</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01017">array()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00368">ast_json_array_append()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00397">ast_json_object_get()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00591">ast_json_pack()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00268">ast_json_string_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/d95/bridge_8c_source.html#l00123">bridges</a>, <a class="el" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00050">endpoints</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00078">FORWARD_BRIDGE</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00077">FORWARD_CHANNEL</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00079">FORWARD_ENDPOINT</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00093">app_forwards::forward_type</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">stasis_app::forwards</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00095">app_forwards::id</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">stasis_app::name</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01866">stasis_app_object_to_json()</a>.</p>
<div class="fragment"><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;{</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *json;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../d0/d95/bridge_8c.html#aaa64e0df7082a1a31b65d0c956bc2534">bridges</a>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../d7/d4b/main_2endpoints_8c.html#a0b6312c44448ff7ed80ac99b3077e438">endpoints</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc4/structapp__forwards.html">app_forwards</a> *forwards;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   json = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: [], s: [], s: []}&quot;</span>,</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="stringliteral">&quot;name&quot;</span>, app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>,</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="stringliteral">&quot;channel_ids&quot;</span>, <span class="stringliteral">&quot;bridge_ids&quot;</span>, <span class="stringliteral">&quot;endpoint_ids&quot;</span>);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;   }</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;   channels = <a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;channel_ids&quot;</span>);</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;   bridges = <a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;bridge_ids&quot;</span>);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   endpoints = <a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(json, <span class="stringliteral">&quot;endpoint_ids&quot;</span>);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">forwards</a>, 0);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;   <span class="keywordflow">while</span> ((forwards = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../d9/d1e/func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordtype">int</span> append_res;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keywordflow">switch</span> (forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#a2cd8c66a3f0c194fc3f55b0b449b1893">forward_type</a>) {</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a2ecf07a317ee26b38344a67b3aee4663a2d33835630407256b44b09bde1f12f70">FORWARD_CHANNEL</a>:</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;         array = <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a2ecf07a317ee26b38344a67b3aee4663a94e22266ef15628389bea86cdca8caef">FORWARD_BRIDGE</a>:</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;         array = <a class="code" href="../../d0/d95/bridge_8c.html#aaa64e0df7082a1a31b65d0c956bc2534">bridges</a>;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a2ecf07a317ee26b38344a67b3aee4663a361770260939c2a85fa65737ac69e6d8">FORWARD_ENDPOINT</a>:</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;         array = <a class="code" href="../../d7/d4b/main_2endpoints_8c.html#a0b6312c44448ff7ed80ac99b3077e438">endpoints</a>;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="comment">/* If forward_type value is unexpected this will safely return an error. */</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      append_res = <a class="code" href="../../d4/d05/json_8h.html#a3d675e52f866630a6a03302df2712b8d">ast_json_array_append</a>(array, <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(forwards-&gt;<a class="code" href="../../d1/dc4/structapp__forwards.html#aa754553486730ec7ec2b2539aa4e1985">id</a>));</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forwards, -1);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      <span class="keywordflow">if</span> (append_res != 0) {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Error building response\n&quot;</span>);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;         <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(json);</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      }</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;   <span class="keywordflow">return</span> json;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;}</div><div class="ttc" id="structapp__forwards_html_aa754553486730ec7ec2b2539aa4e1985"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html#aa754553486730ec7ec2b2539aa4e1985">app_forwards::id</a></div><div class="ttdeci">char id[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00095">res/stasis/app.c:95</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="structapp__forwards_html"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html">app_forwards</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00083">res/stasis/app.c:83</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a2ecf07a317ee26b38344a67b3aee4663a2d33835630407256b44b09bde1f12f70"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a2ecf07a317ee26b38344a67b3aee4663a2d33835630407256b44b09bde1f12f70">FORWARD_CHANNEL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00077">res/stasis/app.c:77</a></div></div>
<div class="ttc" id="structapp__forwards_html_a2cd8c66a3f0c194fc3f55b0b449b1893"><div class="ttname"><a href="../../d1/dc4/structapp__forwards.html#a2cd8c66a3f0c194fc3f55b0b449b1893">app_forwards::forward_type</a></div><div class="ttdeci">enum forward_type forward_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00093">res/stasis/app.c:93</a></div></div>
<div class="ttc" id="structstasis__app_html_ab3fbf2247727e45606e989b9376cd60a"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#ab3fbf2247727e45606e989b9376cd60a">stasis_app::forwards</a></div><div class="ttdeci">struct ao2_container * forwards</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00059">res/stasis/app.c:59</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="json_8h_html_adc52f8d76b7fdd0c8d12987981fd5bf5"><div class="ttname"><a href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a></div><div class="ttdeci">struct ast_json * ast_json_string_create(const char *value)</div><div class="ttdoc">Construct a JSON string from value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00268">json.c:268</a></div></div>
<div class="ttc" id="main_2endpoints_8c_html_a0b6312c44448ff7ed80ac99b3077e438"><div class="ttname"><a href="../../d7/d4b/main_2endpoints_8c.html#a0b6312c44448ff7ed80ac99b3077e438">endpoints</a></div><div class="ttdeci">static struct ao2_container * endpoints</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d4b/main_2endpoints_8c_source.html#l00050">main/endpoints.c:50</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="codec__dahdi_8c_html_aea0622703055b62259903cdab213319b"><div class="ttname"><a href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a></div><div class="ttdeci">static struct channel_usage channels</div></div>
<div class="ttc" id="json_8h_html_a3d675e52f866630a6a03302df2712b8d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a3d675e52f866630a6a03302df2712b8d">ast_json_array_append</a></div><div class="ttdeci">int ast_json_array_append(struct ast_json *array, struct ast_json *value)</div><div class="ttdoc">Append to an array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00368">json.c:368</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="func__strings_8c_html_ab6e308b3a41c01e08d252e071511495c"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#ab6e308b3a41c01e08d252e071511495c">array</a></div><div class="ttdeci">static int array(struct ast_channel *chan, const char *cmd, char *var, const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01017">func_strings.c:1017</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="bridge_8c_html_aaa64e0df7082a1a31b65d0c956bc2534"><div class="ttname"><a href="../../d0/d95/bridge_8c.html#aaa64e0df7082a1a31b65d0c956bc2534">bridges</a></div><div class="ttdeci">static struct ao2_container * bridges</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l00123">bridge.c:123</a></div></div>
<div class="ttc" id="structstasis__app_html_a635b950b2ddb0f18644a528dbdd60dfe"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">stasis_app::name</a></div><div class="ttdeci">char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">res/stasis/app.c:73</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a2ecf07a317ee26b38344a67b3aee4663a94e22266ef15628389bea86cdca8caef"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a2ecf07a317ee26b38344a67b3aee4663a94e22266ef15628389bea86cdca8caef">FORWARD_BRIDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00078">res/stasis/app.c:78</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a2ecf07a317ee26b38344a67b3aee4663a361770260939c2a85fa65737ac69e6d8"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a2ecf07a317ee26b38344a67b3aee4663a361770260939c2a85fa65737ac69e6d8">FORWARD_ENDPOINT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00079">res/stasis/app.c:79</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3319e8e92c07466ddc920e885c6d23f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3319e8e92c07466ddc920e885c6d23f0">&#9670;&nbsp;</a></span>app_unsubscribe_bridge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_unsubscribe_bridge </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *&#160;</td>
          <td class="paramname"><em>bridge</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel the bridge subscription for an application. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">forwards</td><td>Return from <a class="el" href="../../df/d5f/res_2stasis_2app_8h.html#a5b0dbc86b18101e9d9d48b350aeec489" title="Subscribes an application to a channel. ">app_subscribe_channel()</a>. </td></tr>
    <tr><td class="paramname">bridge</td><td>Bridge to subscribe to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01486">1486</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01495">app_unsubscribe_bridge_id()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00040">BRIDGE_ALL</a>, and <a class="el" href="../../d4/d56/bridge_8h_source.html#l00409">ast_bridge::uniqueid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/de3/control_8c_source.html#l01108">internal_bridge_after_cb()</a>, and <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01324">stasis_app_exec()</a>.</p>
<div class="fragment"><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;{</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   }</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a0a564345075a21180f2186dbae310f72">app_unsubscribe_bridge_id</a>(app, bridge ? bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a> : <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a9ac9137d8506b8244b41486bf8e9d2a6">BRIDGE_ALL</a>);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;}</div><div class="ttc" id="structast__bridge_html_a753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">ast_bridge::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00409">bridge.h:409</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a0a564345075a21180f2186dbae310f72"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a0a564345075a21180f2186dbae310f72">app_unsubscribe_bridge_id</a></div><div class="ttdeci">int app_unsubscribe_bridge_id(struct stasis_app *app, const char *bridge_id)</div><div class="ttdoc">Cancel the subscription an app has for a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01495">res/stasis/app.c:1495</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_a9ac9137d8506b8244b41486bf8e9d2a6"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a9ac9137d8506b8244b41486bf8e9d2a6">BRIDGE_ALL</a></div><div class="ttdeci">#define BRIDGE_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00040">res/stasis/app.c:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a564345075a21180f2186dbae310f72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a564345075a21180f2186dbae310f72">&#9670;&nbsp;</a></span>app_unsubscribe_bridge_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_unsubscribe_bridge_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>bridge_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel the subscription an app has for a bridge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Subscribing application. </td></tr>
    <tr><td class="paramname">bridge_id</td><td>Id of bridge to unsubscribe from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01495">1495</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01339">unsubscribe()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01486">app_unsubscribe_bridge()</a>.</p>
<div class="fragment"><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;{</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   }</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#ae25c865e186eb0d4896afd416cb03ec9">unsubscribe</a>(app, <span class="stringliteral">&quot;bridge&quot;</span>, bridge_id, 0);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;}</div><div class="ttc" id="res_2stasis_2app_8c_html_ae25c865e186eb0d4896afd416cb03ec9"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#ae25c865e186eb0d4896afd416cb03ec9">unsubscribe</a></div><div class="ttdeci">static int unsubscribe(struct stasis_app *app, const char *kind, const char *id, int terminate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01339">res/stasis/app.c:1339</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a451e2970210436f5fd6ffdb94d38f7b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a451e2970210436f5fd6ffdb94d38f7b2">&#9670;&nbsp;</a></span>app_unsubscribe_channel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_unsubscribe_channel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel the subscription an app has for a channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Subscribing application. </td></tr>
    <tr><td class="paramname">chan</td><td>Channel to unsubscribe from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01384">1384</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01393">app_unsubscribe_channel_id()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00305">ast_channel_uniqueid()</a>, and <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00041">CHANNEL_ALL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01083">app_send_end_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;{</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;   }</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#abb98d263b0d1405caa0a948bf49b5985">app_unsubscribe_channel_id</a>(app, chan ? <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan) : <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#a22bebb2d35ffb38b9bb202e88822d74c">CHANNEL_ALL</a>);</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;}</div><div class="ttc" id="res_2stasis_2app_8c_html_a22bebb2d35ffb38b9bb202e88822d74c"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#a22bebb2d35ffb38b9bb202e88822d74c">CHANNEL_ALL</a></div><div class="ttdeci">#define CHANNEL_ALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00041">res/stasis/app.c:41</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_abb98d263b0d1405caa0a948bf49b5985"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#abb98d263b0d1405caa0a948bf49b5985">app_unsubscribe_channel_id</a></div><div class="ttdeci">int app_unsubscribe_channel_id(struct stasis_app *app, const char *channel_id)</div><div class="ttdoc">Cancel the subscription an app has for a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01393">res/stasis/app.c:1393</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb98d263b0d1405caa0a948bf49b5985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb98d263b0d1405caa0a948bf49b5985">&#9670;&nbsp;</a></span>app_unsubscribe_channel_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_unsubscribe_channel_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>channel_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel the subscription an app has for a channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Subscribing application. </td></tr>
    <tr><td class="paramname">channel_id</td><td>Id of channel to unsubscribe from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01393">1393</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01339">unsubscribe()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01384">app_unsubscribe_channel()</a>, and <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00991">send_start_msg_snapshots()</a>.</p>
<div class="fragment"><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;{</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;   }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#ae25c865e186eb0d4896afd416cb03ec9">unsubscribe</a>(app, <span class="stringliteral">&quot;channel&quot;</span>, channel_id, 0);</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div><div class="ttc" id="res_2stasis_2app_8c_html_ae25c865e186eb0d4896afd416cb03ec9"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#ae25c865e186eb0d4896afd416cb03ec9">unsubscribe</a></div><div class="ttdeci">static int unsubscribe(struct stasis_app *app, const char *kind, const char *id, int terminate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01339">res/stasis/app.c:1339</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77b1e94137f9d8131f363023261767ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77b1e94137f9d8131f363023261767ec">&#9670;&nbsp;</a></span>app_unsubscribe_endpoint_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int app_unsubscribe_endpoint_id </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>endpoint_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel the subscription an app has for a endpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Subscribing application. </td></tr>
    <tr><td class="paramname">endpoint_id</td><td>Id of endpoint to unsubscribe from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01592">1592</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01339">unsubscribe()</a>.</p>
<div class="fragment"><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;{</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;   <span class="keywordflow">if</span> (!app) {</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   }</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#ae25c865e186eb0d4896afd416cb03ec9">unsubscribe</a>(app, <span class="stringliteral">&quot;endpoint&quot;</span>, endpoint_id, 0);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;}</div><div class="ttc" id="res_2stasis_2app_8c_html_ae25c865e186eb0d4896afd416cb03ec9"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#ae25c865e186eb0d4896afd416cb03ec9">unsubscribe</a></div><div class="ttdeci">static int unsubscribe(struct stasis_app *app, const char *kind, const char *id, int terminate)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01339">res/stasis/app.c:1339</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11d8e51b6dc44258770b7a7a9d1e9992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11d8e51b6dc44258770b7a7a9d1e9992">&#9670;&nbsp;</a></span>app_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void app_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/de3/structstasis__app.html">stasis_app</a> *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/d9c/stasis__app_8h.html#a745524550c947d73d1dc42de3c74627d">stasis_app_cb</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the handler and data for a <code>res_stasis</code> application. </p>
<p>If app has been deactivated, this will reactivate it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">app</td><td>Application to update. </td></tr>
    <tr><td class="paramname">handler</td><td>New application callback. </td></tr>
    <tr><td class="paramname">data</td><td>New data pointer for the callback. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01116">1116</a> of file <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html">res/stasis/app.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00517">ao2_replace</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01038">app_send()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00591">ast_json_pack()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00649">ast_json_timeval()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00063">stasis_app::data</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">stasis_app::handler</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">stasis_app::name</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01726">__stasis_app_register()</a>.</p>
<div class="fragment"><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;{</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;   <span class="keywordflow">if</span> (app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">handler</a> &amp;&amp; app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">data</a>) {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *msg;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Replacing Stasis app &#39;%s&#39;\n&quot;</span>, app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      msg = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: o?, s: s}&quot;</span>,</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;ApplicationReplaced&quot;</span>,</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         <span class="stringliteral">&quot;timestamp&quot;</span>, <a class="code" href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;         <span class="stringliteral">&quot;application&quot;</span>, app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">if</span> (msg) {</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">          * The app must be unlocked before calling &#39;send&#39; since a handler may</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">          * subsequently attempt to grab the app lock after first obtaining a</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">          * lock for another object, thus causing a deadlock.</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         <a class="code" href="../../d3/d5e/res_2stasis_2app_8c.html#afc2b5ef224bf880e5ef556a910f41a37">app_send</a>(app, msg);</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(app);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;         <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>(msg);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;         <span class="keywordflow">if</span> (!app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">handler</a>) {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">             * If the handler disappeared then the app was deactivated. In that</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">             * case don&#39;t replace. Re-activation will reset the handler later.</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;         }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(1, <span class="stringliteral">&quot;Activating Stasis app &#39;%s&#39;\n&quot;</span>, app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">name</a>);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   }</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">handler</a> = <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a>(app-&gt;<a class="code" href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">data</a>, data);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(app);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;}</div><div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structstasis__app_html_a8c07e1a3c558a90f7a8c55488fb08681"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a8c07e1a3c558a90f7a8c55488fb08681">stasis_app::handler</a></div><div class="ttdeci">stasis_app_cb handler</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00061">res/stasis/app.c:61</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__app_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a735984d41155bc1032e09bece8f8d66d">stasis_app::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00063">res/stasis/app.c:63</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="json_8h_html_a2b7c72e2e3ab2634d8a4f8b708440d95"><div class="ttname"><a href="../../d4/d05/json_8h.html#a2b7c72e2e3ab2634d8a4f8b708440d95">ast_json_timeval</a></div><div class="ttdeci">struct ast_json * ast_json_timeval(const struct timeval tv, const char *zone)</div><div class="ttdoc">Construct a timeval as JSON. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00649">json.c:649</a></div></div>
<div class="ttc" id="res_2stasis_2app_8c_html_afc2b5ef224bf880e5ef556a910f41a37"><div class="ttname"><a href="../../d3/d5e/res_2stasis_2app_8c.html#afc2b5ef224bf880e5ef556a910f41a37">app_send</a></div><div class="ttdeci">void app_send(struct stasis_app *app, struct ast_json *message)</div><div class="ttdoc">Send a message to the given application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01038">res/stasis/app.c:1038</a></div></div>
<div class="ttc" id="structstasis__app_html_a635b950b2ddb0f18644a528dbdd60dfe"><div class="ttname"><a href="../../d4/de3/structstasis__app.html#a635b950b2ddb0f18644a528dbdd60dfe">stasis_app::name</a></div><div class="ttdeci">char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00073">res/stasis/app.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa81c8462bd0574f4f9e09e71f2772f44"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa81c8462bd0574f4f9e09e71f2772f44">ao2_replace</a></div><div class="ttdeci">#define ao2_replace(dst, src)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00517">astobj2.h:517</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:44:30 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
