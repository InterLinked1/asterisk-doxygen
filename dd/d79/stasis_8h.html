<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: stasis.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_6d4b1cdb59e2db6ad82005b337288fef.html">asterisk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stasis.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Stasis Message Bus API. See <a class="el" href="../../dd/dfd/stasis.html">Stasis Message Bus API</a> for detailed documentation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../d4/d05/json_8h_source.html">asterisk/json.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d45/manager_8h_source.html">asterisk/manager.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d20/event_8h_source.html">asterisk/event.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stasis.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/d3f/stasis_8h__incl.png" border="0" usemap="#stasis_8h" alt=""/></div>
<map name="stasis_8h" id="stasis_8h">
<area shape="rect" id="node2" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="498,80,613,107"/>
<area shape="rect" id="node7" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="1188,80,1333,107"/>
<area shape="rect" id="node31" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1101,304,1215,331"/>
<area shape="rect" id="node32" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="1455,80,1579,107"/>
<area shape="rect" id="node3" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="203,379,350,405"/>
<area shape="rect" id="node6" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1069,453,1196,480"/>
<area shape="rect" id="node8" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="626,379,765,405"/>
<area shape="rect" id="node16" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1465,379,1579,405"/>
<area shape="rect" id="node25" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="1485,229,1636,256"/>
<area shape="rect" id="node27" href="../../d1/d99/xmldoc_8h.html" title="Asterisk XML Documentation API. " alt="" coords="1193,155,1328,181"/>
<area shape="rect" id="node18" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1220,453,1283,480"/>
<area shape="rect" id="node19" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1247,528,1394,555"/>
<area shape="rect" id="node22" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="1409,453,1560,480"/>
<area shape="rect" id="node23" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1584,453,1727,480"/>
<area shape="rect" id="node26" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1485,304,1636,331"/>
<area shape="rect" id="node28" href="../../d0/d62/xml_8h.html" title="Asterisk XML abstraction layer. " alt="" coords="1299,229,1409,256"/>
<area shape="rect" id="node29" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1221,379,1378,405"/>
<area shape="rect" id="node30" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1093,229,1223,256"/>
<area shape="rect" id="node33" href="../../d6/d37/event__defs_8h.html" title="Generic event system. " alt="" coords="1536,155,1695,181"/>
</map>
</div>
</div>
<p><a href="../../dd/d79/stasis_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache update message.  <a href="../../de/dfa/structstasis__cache__update.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/structstasis__message__sanitizer.html">stasis_message_sanitizer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure containing callbacks for Stasis message sanitization.  <a href="../../d4/d45/structstasis__message__sanitizer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d3e/structstasis__message__vtable.html">stasis_message_vtable</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual table providing methods for messages.  <a href="../../dd/d3e/structstasis__message__vtable.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d43/structstasis__subscription__change.html">stasis_subscription_change</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds details about changes to subscriptions for the specified topic.  <a href="../../d5/d43/structstasis__subscription__change.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a31197e193b1dfd6c122ff6d7c7f6b3fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a31197e193b1dfd6c122ff6d7c7f6b3fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boiler-plate messaging macro for cleaning up message types.  <a href="#a31197e193b1dfd6c122ff6d7c7f6b3fa">More...</a><br /></td></tr>
<tr class="separator:a31197e193b1dfd6c122ff6d7c7f6b3fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72a761b5a8e8065c28f5b24ad54d68c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aa72a761b5a8e8065c28f5b24ad54d68c">STASIS_MESSAGE_TYPE_DEFN</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, ...)</td></tr>
<tr class="memdesc:aa72a761b5a8e8065c28f5b24ad54d68c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boiler-plate messaging macro for defining public message types.  <a href="#aa72a761b5a8e8065c28f5b24ad54d68c">More...</a><br /></td></tr>
<tr class="separator:aa72a761b5a8e8065c28f5b24ad54d68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51fb372b38f434a3bab7a5ec5e65c396"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a51fb372b38f434a3bab7a5ec5e65c396">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, ...)</td></tr>
<tr class="memdesc:a51fb372b38f434a3bab7a5ec5e65c396"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boiler-plate messaging macro for defining local message types.  <a href="#a51fb372b38f434a3bab7a5ec5e65c396">More...</a><br /></td></tr>
<tr class="separator:a51fb372b38f434a3bab7a5ec5e65c396"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70cd046d8e3fd50de5c51aecb2830d2a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a70cd046d8e3fd50de5c51aecb2830d2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boiler-plate messaging macro for initializing message types.  <a href="#a70cd046d8e3fd50de5c51aecb2830d2a">More...</a><br /></td></tr>
<tr class="separator:a70cd046d8e3fd50de5c51aecb2830d2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3fe7fe099389094244002113814ec23"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>(topic,  callback,  data)&#160;&#160;&#160;<a class="el" href="../../d0/df4/stasis_8c.html#a23dcf25efe633f0f429a1520f066249f">__stasis_subscribe</a>(topic, callback, data, __FILE__, __LINE__, __PRETTY_FUNCTION__)</td></tr>
<tr class="separator:ae3fe7fe099389094244002113814ec23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a597f7a30fe616c9f083a93ed168955ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a597f7a30fe616c9f083a93ed168955ed">stasis_subscribe_pool</a>(topic,  callback,  data)&#160;&#160;&#160;<a class="el" href="../../d0/df4/stasis_8c.html#a6b7cbb6df580f2e3cba59eed0400fee4">__stasis_subscribe_pool</a>(topic, callback, data, __FILE__, __LINE__, __PRETTY_FUNCTION__)</td></tr>
<tr class="separator:a597f7a30fe616c9f083a93ed168955ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad6616af7b6415ff5186c87a0236df462"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gad6616af7b6415ff5186c87a0236df462">STASIS_UMOS_MAX</a>&#160;&#160;&#160;(<a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gga4cf6fe670f1f46e8db561d407b694d4da1f02519f8ea66bad627d5797b0c6b0ce">STASIS_UMOS_ENDPOINT</a> + 1)</td></tr>
<tr class="memdesc:gad6616af7b6415ff5186c87a0236df462"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of snapshot types.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#gad6616af7b6415ff5186c87a0236df462">More...</a><br /></td></tr>
<tr class="separator:gad6616af7b6415ff5186c87a0236df462"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aa4a7b629d3125dc329b43715f5f5663b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aa4a7b629d3125dc329b43715f5f5663b">cache_aggregate_calc_fn</a>) (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *new_snapshot)</td></tr>
<tr class="memdesc:aa4a7b629d3125dc329b43715f5f5663b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback to calculate the aggregate cache entry.  <a href="#aa4a7b629d3125dc329b43715f5f5663b">More...</a><br /></td></tr>
<tr class="separator:aa4a7b629d3125dc329b43715f5f5663b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0eb1c6ec2920123af41e05b5592a7c"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a9a0eb1c6ec2920123af41e05b5592a7c">cache_aggregate_publish_fn</a>) (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *aggregate)</td></tr>
<tr class="memdesc:a9a0eb1c6ec2920123af41e05b5592a7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback to publish the aggregate cache entry message.  <a href="#a9a0eb1c6ec2920123af41e05b5592a7c">More...</a><br /></td></tr>
<tr class="separator:a9a0eb1c6ec2920123af41e05b5592a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987cdda9bbdeb303d5d7619136f5bea6"><td class="memItemLeft" align="right" valign="top">typedef const char *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a>) (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:a987cdda9bbdeb303d5d7619136f5bea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback extract a unique identity from a snapshot message.  <a href="#a987cdda9bbdeb303d5d7619136f5bea6">More...</a><br /></td></tr>
<tr class="separator:a987cdda9bbdeb303d5d7619136f5bea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7854b4fb538be6f885943a24d60c8f"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>) (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:a2b7854b4fb538be6f885943a24d60c8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function type for Stasis subscriptions.  <a href="#a2b7854b4fb538be6f885943a24d60c8f">More...</a><br /></td></tr>
<tr class="separator:a2b7854b4fb538be6f885943a24d60c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:af326808a49f64881cfa368ef2e5f49e3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3">stasis_message_type_result</a> { <a class="el" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a> = -1, 
<a class="el" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42">STASIS_MESSAGE_TYPE_SUCCESS</a>, 
<a class="el" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e">STASIS_MESSAGE_TYPE_DECLINED</a>
 }<tr class="memdesc:af326808a49f64881cfa368ef2e5f49e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return code for Stasis message type creation attempts.  <a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:af326808a49f64881cfa368ef2e5f49e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3804fa8ec76d77090d5cda80fc4ac891"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a> { <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a98a891164b5e65d1d6377ab58321621f">STASIS_SUBSCRIPTION_FILTER_NONE</a> = 0, 
<a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>, 
<a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>
 }<tr class="memdesc:a3804fa8ec76d77090d5cda80fc4ac891"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stasis subscription message filters.  <a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a3804fa8ec76d77090d5cda80fc4ac891"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae672fb0f772d0e3066fa4c29c41814"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> { <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e">STASIS_SUBSCRIPTION_FORMATTER_NONE</a> = 0, 
<a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587">STASIS_SUBSCRIPTION_FORMATTER_JSON</a> = 1 &lt;&lt; 0, 
<a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d">STASIS_SUBSCRIPTION_FORMATTER_AMI</a> = 1 &lt;&lt; 1, 
<a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09">STASIS_SUBSCRIPTION_FORMATTER_EVENT</a> = 1 &lt;&lt; 2
 }<tr class="memdesc:a5ae672fb0f772d0e3066fa4c29c41814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stasis subscription formatter filters.  <a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a5ae672fb0f772d0e3066fa4c29c41814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4cf6fe670f1f46e8db561d407b694d4d"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga4cf6fe670f1f46e8db561d407b694d4d">stasis_user_multi_object_snapshot_type</a> { <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gga4cf6fe670f1f46e8db561d407b694d4da679186d0a76e3ed91a98c2289921485a">STASIS_UMOS_CHANNEL</a> = 0, 
<a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gga4cf6fe670f1f46e8db561d407b694d4da30a07e65360c3484148ca1750067fe87">STASIS_UMOS_BRIDGE</a>, 
<a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gga4cf6fe670f1f46e8db561d407b694d4da1f02519f8ea66bad627d5797b0c6b0ce">STASIS_UMOS_ENDPOINT</a>
 }<tr class="memdesc:ga4cf6fe670f1f46e8db561d407b694d4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Object type code for multi user object snapshots.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#ga4cf6fe670f1f46e8db561d407b694d4d">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ga4cf6fe670f1f46e8db561d407b694d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a23dcf25efe633f0f429a1520f066249f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a23dcf25efe633f0f429a1520f066249f">__stasis_subscribe</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data, const char *file, int lineno, const char *func)</td></tr>
<tr class="memdesc:a23dcf25efe633f0f429a1520f066249f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a subscription.  <a href="#a23dcf25efe633f0f429a1520f066249f">More...</a><br /></td></tr>
<tr class="separator:a23dcf25efe633f0f429a1520f066249f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b7cbb6df580f2e3cba59eed0400fee4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a6b7cbb6df580f2e3cba59eed0400fee4">__stasis_subscribe_pool</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data, const char *file, int lineno, const char *func)</td></tr>
<tr class="memdesc:a6b7cbb6df580f2e3cba59eed0400fee4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a subscription whose callbacks occur on a thread pool.  <a href="#a6b7cbb6df580f2e3cba59eed0400fee4">More...</a><br /></td></tr>
<tr class="separator:a6b7cbb6df580f2e3cba59eed0400fee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f5721e90c221f9808fcedaf013ae56e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga3f5721e90c221f9808fcedaf013ae56e">ast_multi_object_blob_add</a> (struct <a class="el" href="../../d4/d38/structast__multi__object__blob.html">ast_multi_object_blob</a> *multi, enum <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga4cf6fe670f1f46e8db561d407b694d4d">stasis_user_multi_object_snapshot_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, void *object)</td></tr>
<tr class="memdesc:ga3f5721e90c221f9808fcedaf013ae56e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an object to a multi object blob previously created.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#ga3f5721e90c221f9808fcedaf013ae56e">More...</a><br /></td></tr>
<tr class="separator:ga3f5721e90c221f9808fcedaf013ae56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0679202aea3da62adf0dff0e09a4e07a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d38/structast__multi__object__blob.html">ast_multi_object_blob</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga0679202aea3da62adf0dff0e09a4e07a">ast_multi_object_blob_create</a> (struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *blob)</td></tr>
<tr class="memdesc:ga0679202aea3da62adf0dff0e09a4e07a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a stasis multi object blob.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#ga0679202aea3da62adf0dff0e09a4e07a">More...</a><br /></td></tr>
<tr class="separator:ga0679202aea3da62adf0dff0e09a4e07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8fd487c2186f10859ec2619cf26b0907"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga8fd487c2186f10859ec2619cf26b0907">ast_multi_object_blob_single_channel_publish</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *blob)</td></tr>
<tr class="memdesc:ga8fd487c2186f10859ec2619cf26b0907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and publish a stasis message blob on a channel with it's snapshot.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#ga8fd487c2186f10859ec2619cf26b0907">More...</a><br /></td></tr>
<tr class="separator:ga8fd487c2186f10859ec2619cf26b0907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga903c0022d53e0cac08b7eab6539ab206"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga903c0022d53e0cac08b7eab6539ab206">ast_multi_user_event_type</a> (void)</td></tr>
<tr class="memdesc:ga903c0022d53e0cac08b7eab6539ab206"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message type for custom user defined events with multi object blobs.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#ga903c0022d53e0cac08b7eab6539ab206">More...</a><br /></td></tr>
<tr class="separator:ga903c0022d53e0cac08b7eab6539ab206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a169e12055004ecf0ecc355b3e3e1f218"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a169e12055004ecf0ecc355b3e3e1f218">stasis_cache_clear_create</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:a169e12055004ecf0ecc355b3e3e1f218"><td class="mdescLeft">&#160;</td><td class="mdescRight">A message which instructs the caching topic to remove an entry from its cache.  <a href="#a169e12055004ecf0ecc355b3e3e1f218">More...</a><br /></td></tr>
<tr class="separator:a169e12055004ecf0ecc355b3e3e1f218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5e2b5addf55fb60e66c4f590652a3649"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a> (void)</td></tr>
<tr class="memdesc:ga5e2b5addf55fb60e66c4f590652a3649"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message type for clearing a message from a stasis cache.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">More...</a><br /></td></tr>
<tr class="separator:ga5e2b5addf55fb60e66c4f590652a3649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64035c0f7317db2590817a173d268ff1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a64035c0f7317db2590817a173d268ff1">stasis_cache_create</a> (<a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a> id_fn)</td></tr>
<tr class="memdesc:a64035c0f7317db2590817a173d268ff1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a cache.  <a href="#a64035c0f7317db2590817a173d268ff1">More...</a><br /></td></tr>
<tr class="separator:a64035c0f7317db2590817a173d268ff1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb417e66895425f128678fe3ed589010"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#adb417e66895425f128678fe3ed589010">stasis_cache_create_full</a> (<a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a> id_fn, <a class="el" href="../../dd/d79/stasis_8h.html#aa4a7b629d3125dc329b43715f5f5663b">cache_aggregate_calc_fn</a> aggregate_calc_fn, <a class="el" href="../../dd/d79/stasis_8h.html#a9a0eb1c6ec2920123af41e05b5592a7c">cache_aggregate_publish_fn</a> aggregate_publish_fn)</td></tr>
<tr class="memdesc:adb417e66895425f128678fe3ed589010"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a cache.  <a href="#adb417e66895425f128678fe3ed589010">More...</a><br /></td></tr>
<tr class="separator:adb417e66895425f128678fe3ed589010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5612920b22beb93b5e8acbdae40078"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a8c5612920b22beb93b5e8acbdae40078">stasis_cache_dump</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:a8c5612920b22beb93b5e8acbdae40078"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump cached items to a subscription for the ast_eid_default entity.  <a href="#a8c5612920b22beb93b5e8acbdae40078">More...</a><br /></td></tr>
<tr class="separator:a8c5612920b22beb93b5e8acbdae40078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab54f6037e019ae477c15e90e52904d09"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ab54f6037e019ae477c15e90e52904d09">stasis_cache_dump_all</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:ab54f6037e019ae477c15e90e52904d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump all entity items from the cache to a subscription.  <a href="#ab54f6037e019ae477c15e90e52904d09">More...</a><br /></td></tr>
<tr class="separator:ab54f6037e019ae477c15e90e52904d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4de0928d2b230b1c3184ba506ecf26"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a9a4de0928d2b230b1c3184ba506ecf26">stasis_cache_dump_by_eid</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="memdesc:a9a4de0928d2b230b1c3184ba506ecf26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump cached items to a subscription for a specific entity.  <a href="#a9a4de0928d2b230b1c3184ba506ecf26">More...</a><br /></td></tr>
<tr class="separator:a9a4de0928d2b230b1c3184ba506ecf26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a103ead88f88b74cb33bee4a843c4a162"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a103ead88f88b74cb33bee4a843c4a162">stasis_cache_entry_get_aggregate</a> (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>)</td></tr>
<tr class="memdesc:a103ead88f88b74cb33bee4a843c4a162"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the aggregate cache entry snapshot.  <a href="#a103ead88f88b74cb33bee4a843c4a162">More...</a><br /></td></tr>
<tr class="separator:a103ead88f88b74cb33bee4a843c4a162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55563a8b16be69f6f7cae05e5b4e65fc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a55563a8b16be69f6f7cae05e5b4e65fc">stasis_cache_entry_get_local</a> (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>)</td></tr>
<tr class="memdesc:a55563a8b16be69f6f7cae05e5b4e65fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the local entity's cache entry snapshot.  <a href="#a55563a8b16be69f6f7cae05e5b4e65fc">More...</a><br /></td></tr>
<tr class="separator:a55563a8b16be69f6f7cae05e5b4e65fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ffccea6541acbcf4ab9d6913f2e757"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ab0ffccea6541acbcf4ab9d6913f2e757">stasis_cache_entry_get_remote</a> (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>, int idx)</td></tr>
<tr class="memdesc:ab0ffccea6541acbcf4ab9d6913f2e757"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a remote entity's cache entry snapshot by index.  <a href="#ab0ffccea6541acbcf4ab9d6913f2e757">More...</a><br /></td></tr>
<tr class="separator:ab0ffccea6541acbcf4ab9d6913f2e757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3da17290725793258020b83f56e4df6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ab3da17290725793258020b83f56e4df6">stasis_cache_get</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:ab3da17290725793258020b83f56e4df6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve an item from the cache for the ast_eid_default entity.  <a href="#ab3da17290725793258020b83f56e4df6">More...</a><br /></td></tr>
<tr class="separator:ab3da17290725793258020b83f56e4df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886f222d38f8a07dee5a595d5c19a3fb"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a886f222d38f8a07dee5a595d5c19a3fb">stasis_cache_get_all</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>)</td></tr>
<tr class="memdesc:a886f222d38f8a07dee5a595d5c19a3fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve all matching entity items from the cache.  <a href="#a886f222d38f8a07dee5a595d5c19a3fb">More...</a><br /></td></tr>
<tr class="separator:a886f222d38f8a07dee5a595d5c19a3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d22721748b1bfd63ab13d92f19dfd02"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a1d22721748b1bfd63ab13d92f19dfd02">stasis_cache_get_by_eid</a> (struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="memdesc:a1d22721748b1bfd63ab13d92f19dfd02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve an item from the cache for a specific entity.  <a href="#a1d22721748b1bfd63ab13d92f19dfd02">More...</a><br /></td></tr>
<tr class="separator:a1d22721748b1bfd63ab13d92f19dfd02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81215cb37a9287389855d0529332b1b7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a81215cb37a9287389855d0529332b1b7">stasis_cache_init</a> (void)</td></tr>
<tr class="separator:a81215cb37a9287389855d0529332b1b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5d1a876f8f0cd0562fb5d5f94c06717"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a> (void)</td></tr>
<tr class="memdesc:gab5d1a876f8f0cd0562fb5d5f94c06717"><td class="mdescLeft">&#160;</td><td class="mdescRight">Message type for cache update messages.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">More...</a><br /></td></tr>
<tr class="separator:gab5d1a876f8f0cd0562fb5d5f94c06717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd235b443f5fffb17c7bc98b6d48ddd2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#afd235b443f5fffb17c7bc98b6d48ddd2">stasis_caching_accept_message_type</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:afd235b443f5fffb17c7bc98b6d48ddd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate to a caching topic that we are interested in a message type.  <a href="#afd235b443f5fffb17c7bc98b6d48ddd2">More...</a><br /></td></tr>
<tr class="separator:afd235b443f5fffb17c7bc98b6d48ddd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b3b41b59f3894b40f5630524347d62"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a60b3b41b59f3894b40f5630524347d62">stasis_caching_get_topic</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic)</td></tr>
<tr class="memdesc:a60b3b41b59f3894b40f5630524347d62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the topic of cached events from a caching topics.  <a href="#a60b3b41b59f3894b40f5630524347d62">More...</a><br /></td></tr>
<tr class="separator:a60b3b41b59f3894b40f5630524347d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5db3f77a72f6a07c86a00f638daff07a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a5db3f77a72f6a07c86a00f638daff07a">stasis_caching_set_filter</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic, enum <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a> <a class="el" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a>)</td></tr>
<tr class="memdesc:a5db3f77a72f6a07c86a00f638daff07a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the message type filtering level on a cache.  <a href="#a5db3f77a72f6a07c86a00f638daff07a">More...</a><br /></td></tr>
<tr class="separator:a5db3f77a72f6a07c86a00f638daff07a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4290101180caea800a0461017a167120"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a4290101180caea800a0461017a167120">stasis_caching_topic_create</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *original_topic, struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="el" href="../../d6/d12/test__sorcery_8c.html#a754f1806adf6d9a932e80148f3f7bd12">cache</a>)</td></tr>
<tr class="memdesc:a4290101180caea800a0461017a167120"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a topic which monitors and caches messages from another topic.  <a href="#a4290101180caea800a0461017a167120">More...</a><br /></td></tr>
<tr class="separator:a4290101180caea800a0461017a167120"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc3370e3a15daaa00179f2f72ab8c9d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#afdc3370e3a15daaa00179f2f72ab8c9d">stasis_caching_unsubscribe</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic)</td></tr>
<tr class="memdesc:afdc3370e3a15daaa00179f2f72ab8c9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes a caching topic from its upstream topic.  <a href="#afdc3370e3a15daaa00179f2f72ab8c9d">More...</a><br /></td></tr>
<tr class="separator:afdc3370e3a15daaa00179f2f72ab8c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab211ac23afbd0560f08539021888db57"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ab211ac23afbd0560f08539021888db57">stasis_caching_unsubscribe_and_join</a> (struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic)</td></tr>
<tr class="memdesc:ab211ac23afbd0560f08539021888db57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribes a caching topic from its upstream topic, blocking until all messages have been forwarded.  <a href="#ab211ac23afbd0560f08539021888db57">More...</a><br /></td></tr>
<tr class="separator:ab211ac23afbd0560f08539021888db57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d90a883fee0f3ce89487a4e42f7806a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a5d90a883fee0f3ce89487a4e42f7806a">stasis_config_init</a> (void)</td></tr>
<tr class="separator:a5d90a883fee0f3ce89487a4e42f7806a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2513a93567ddc93510f7896b777da119"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *from_topic, struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *to_topic)</td></tr>
<tr class="memdesc:a2513a93567ddc93510f7896b777da119"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a subscription which forwards all messages from one topic to another.  <a href="#a2513a93567ddc93510f7896b777da119">More...</a><br /></td></tr>
<tr class="separator:a2513a93567ddc93510f7896b777da119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5713715b0f26f4943d0af05363b07027"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a> (struct <a class="el" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *forward)</td></tr>
<tr class="separator:a5713715b0f26f4943d0af05363b07027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e674e1a85d014776968a99025bf7bce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a5e674e1a85d014776968a99025bf7bce">stasis_init</a> (void)</td></tr>
<tr class="memdesc:a5e674e1a85d014776968a99025bf7bce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the Stasis subsystem.  <a href="#a5e674e1a85d014776968a99025bf7bce">More...</a><br /></td></tr>
<tr class="separator:a5e674e1a85d014776968a99025bf7bce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72385bdbbdd39eda3680da22820da7a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a72385bdbbdd39eda3680da22820da7a5">stasis_log_bad_type_access</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="separator:a72385bdbbdd39eda3680da22820da7a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff3b891ecf151757d9977e167c9a3b07"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aff3b891ecf151757d9977e167c9a3b07">stasis_message_can_be_ami</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:aff3b891ecf151757d9977e167c9a3b07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the given message can be converted to AMI.  <a href="#aff3b891ecf151757d9977e167c9a3b07">More...</a><br /></td></tr>
<tr class="separator:aff3b891ecf151757d9977e167c9a3b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a06fdaec039fdfb5f36892e725f9ec"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a> (struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, void *data)</td></tr>
<tr class="memdesc:a72a06fdaec039fdfb5f36892e725f9ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new message.  <a href="#a72a06fdaec039fdfb5f36892e725f9ec">More...</a><br /></td></tr>
<tr class="separator:a72a06fdaec039fdfb5f36892e725f9ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08010732dcea60e116e54fca0133d582"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a08010732dcea60e116e54fca0133d582">stasis_message_create_full</a> (struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, void *data, const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *eid)</td></tr>
<tr class="memdesc:a08010732dcea60e116e54fca0133d582"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new message for an entity.  <a href="#a08010732dcea60e116e54fca0133d582">More...</a><br /></td></tr>
<tr class="separator:a08010732dcea60e116e54fca0133d582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6081f17431b81bc1a010b680517491d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a> (const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:af6081f17431b81bc1a010b680517491d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the data contained in a message.  <a href="#af6081f17431b81bc1a010b680517491d">More...</a><br /></td></tr>
<tr class="separator:af6081f17431b81bc1a010b680517491d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5dc2372860d977cc3e2a8e9af24aeaf"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ae5dc2372860d977cc3e2a8e9af24aeaf">stasis_message_eid</a> (const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:ae5dc2372860d977cc3e2a8e9af24aeaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the entity id for a <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>.  <a href="#ae5dc2372860d977cc3e2a8e9af24aeaf">More...</a><br /></td></tr>
<tr class="separator:ae5dc2372860d977cc3e2a8e9af24aeaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9c10eadd9db34f8c0b19619752ea93"><td class="memItemLeft" align="right" valign="top">const struct timeval *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a0a9c10eadd9db34f8c0b19619752ea93">stasis_message_timestamp</a> (const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:a0a9c10eadd9db34f8c0b19619752ea93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the time when a message was created.  <a href="#a0a9c10eadd9db34f8c0b19619752ea93">More...</a><br /></td></tr>
<tr class="separator:a0a9c10eadd9db34f8c0b19619752ea93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf8e3a27e9995917eb0bc043acd1316a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#adf8e3a27e9995917eb0bc043acd1316a">stasis_message_to_ami</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:adf8e3a27e9995917eb0bc043acd1316a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the AMI representation of the message.  <a href="#adf8e3a27e9995917eb0bc043acd1316a">More...</a><br /></td></tr>
<tr class="separator:adf8e3a27e9995917eb0bc043acd1316a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90ab45287904a603efb31319aaf8b91"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d5/d78/structast__event.html">ast_event</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aa90ab45287904a603efb31319aaf8b91">stasis_message_to_event</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:aa90ab45287904a603efb31319aaf8b91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the <a class="el" href="../../db/d28/AstGenericEvents.html">Generic event system</a> representation of the message.  <a href="#aa90ab45287904a603efb31319aaf8b91">More...</a><br /></td></tr>
<tr class="separator:aa90ab45287904a603efb31319aaf8b91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a415493fbb3571cc6c9e7ac599309110f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a415493fbb3571cc6c9e7ac599309110f">stasis_message_to_json</a> (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg, struct <a class="el" href="../../d4/d45/structstasis__message__sanitizer.html">stasis_message_sanitizer</a> *sanitize)</td></tr>
<tr class="memdesc:a415493fbb3571cc6c9e7ac599309110f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the JSON representation of the message.  <a href="#a415493fbb3571cc6c9e7ac599309110f">More...</a><br /></td></tr>
<tr class="separator:a415493fbb3571cc6c9e7ac599309110f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9356e8a29344ca4eac93088198ccff89"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a> (const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:a9356e8a29344ca4eac93088198ccff89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the message type for a <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>.  <a href="#a9356e8a29344ca4eac93088198ccff89">More...</a><br /></td></tr>
<tr class="separator:a9356e8a29344ca4eac93088198ccff89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a9331334e3c57d1718475864636d1c"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ad7a9331334e3c57d1718475864636d1c">stasis_message_type_available_formatters</a> (const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type)</td></tr>
<tr class="memdesc:ad7a9331334e3c57d1718475864636d1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a bitmap of available formatters for a message type.  <a href="#ad7a9331334e3c57d1718475864636d1c">More...</a><br /></td></tr>
<tr class="separator:ad7a9331334e3c57d1718475864636d1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7761ce3c78b45fd34cb25bf0e1ba09"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3">stasis_message_type_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a7c7761ce3c78b45fd34cb25bf0e1ba09">stasis_message_type_create</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct <a class="el" href="../../dd/d3e/structstasis__message__vtable.html">stasis_message_vtable</a> *vtable, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> **<a class="el" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>)</td></tr>
<tr class="memdesc:a7c7761ce3c78b45fd34cb25bf0e1ba09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new message type.  <a href="#a7c7761ce3c78b45fd34cb25bf0e1ba09">More...</a><br /></td></tr>
<tr class="separator:a7c7761ce3c78b45fd34cb25bf0e1ba09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2e98dd27243b0fe07717c54c40d0b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a6c2e98dd27243b0fe07717c54c40d0b1">stasis_message_type_declined</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a6c2e98dd27243b0fe07717c54c40d0b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a message type is declined.  <a href="#a6c2e98dd27243b0fe07717c54c40d0b1">More...</a><br /></td></tr>
<tr class="separator:a6c2e98dd27243b0fe07717c54c40d0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1996f291ef2df28b75c279d4790c2258"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a1996f291ef2df28b75c279d4790c2258">stasis_message_type_hash</a> (const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:a1996f291ef2df28b75c279d4790c2258"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the hash of a given message type.  <a href="#a1996f291ef2df28b75c279d4790c2258">More...</a><br /></td></tr>
<tr class="separator:a1996f291ef2df28b75c279d4790c2258"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa72759806ee4118a78b9d1373c633d2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aaa72759806ee4118a78b9d1373c633d2">stasis_message_type_id</a> (const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:aaa72759806ee4118a78b9d1373c633d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the id of a given message type.  <a href="#aaa72759806ee4118a78b9d1373c633d2">More...</a><br /></td></tr>
<tr class="separator:aaa72759806ee4118a78b9d1373c633d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefd78086150c89477f5851f2836e0478"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a> (const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:aefd78086150c89477f5851f2836e0478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the name of a given message type.  <a href="#aefd78086150c89477f5851f2836e0478">More...</a><br /></td></tr>
<tr class="separator:aefd78086150c89477f5851f2836e0478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac43d0a33d111e9f34b441b285c166cfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:ac43d0a33d111e9f34b441b285c166cfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish a message to a topic's subscribers.  <a href="#ac43d0a33d111e9f34b441b285c166cfc">More...</a><br /></td></tr>
<tr class="separator:ac43d0a33d111e9f34b441b285c166cfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499d7d708fc81464ec55de7c518b02c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a499d7d708fc81464ec55de7c518b02c6">stasis_publish_sync</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:a499d7d708fc81464ec55de7c518b02c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish a message to a topic's subscribers, synchronizing on the specified subscriber.  <a href="#a499d7d708fc81464ec55de7c518b02c6">More...</a><br /></td></tr>
<tr class="separator:a499d7d708fc81464ec55de7c518b02c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf3a92c10ab654d4a7b11cbf44aa1074"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aaf3a92c10ab654d4a7b11cbf44aa1074">stasis_subscription_accept_formatters</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription, enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> formatters)</td></tr>
<tr class="memdesc:aaf3a92c10ab654d4a7b11cbf44aa1074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate to a subscription that we are interested in messages with one or more formatters.  <a href="#aaf3a92c10ab654d4a7b11cbf44aa1074">More...</a><br /></td></tr>
<tr class="separator:aaf3a92c10ab654d4a7b11cbf44aa1074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f248ee5f4791f05d0af8768aaab282b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription, const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:a4f248ee5f4791f05d0af8768aaab282b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate to a subscription that we are interested in a message type.  <a href="#a4f248ee5f4791f05d0af8768aaab282b">More...</a><br /></td></tr>
<tr class="separator:a4f248ee5f4791f05d0af8768aaab282b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613709cd56550431a4ed3c45e59b72a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a613709cd56550431a4ed3c45e59b72a3">stasis_subscription_cb_noop</a> (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:a613709cd56550431a4ed3c45e59b72a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stasis subscription callback function that does nothing.  <a href="#a613709cd56550431a4ed3c45e59b72a3">More...</a><br /></td></tr>
<tr class="separator:a613709cd56550431a4ed3c45e59b72a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafae630f05995b59b49dc523a5b9ce757"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a> (void)</td></tr>
<tr class="memdesc:gafae630f05995b59b49dc523a5b9ce757"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the message type for subscription change notices.  <a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">More...</a><br /></td></tr>
<tr class="separator:gafae630f05995b59b49dc523a5b9ce757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a223dba20686ad9d48d9ea8329984f14b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a223dba20686ad9d48d9ea8329984f14b">stasis_subscription_decline_message_type</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription, const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>)</td></tr>
<tr class="memdesc:a223dba20686ad9d48d9ea8329984f14b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate to a subscription that we are not interested in a message type.  <a href="#a223dba20686ad9d48d9ea8329984f14b">More...</a><br /></td></tr>
<tr class="separator:a223dba20686ad9d48d9ea8329984f14b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a839350445aaa51cedf31f6daec933ee0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *msg)</td></tr>
<tr class="memdesc:a839350445aaa51cedf31f6daec933ee0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine whether a message is the final message to be received on a subscription.  <a href="#a839350445aaa51cedf31f6daec933ee0">More...</a><br /></td></tr>
<tr class="separator:a839350445aaa51cedf31f6daec933ee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c69c471e1b836539f280b80b0000de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a04c69c471e1b836539f280b80b0000de">stasis_subscription_is_done</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription)</td></tr>
<tr class="memdesc:a04c69c471e1b836539f280b80b0000de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether <em>subscription</em> has received its final message.  <a href="#a04c69c471e1b836539f280b80b0000de">More...</a><br /></td></tr>
<tr class="separator:a04c69c471e1b836539f280b80b0000de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5bedbb2212956dac77be47dceef510"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a> (const struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:acd5bedbb2212956dac77be47dceef510"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether a subscription is currently subscribed.  <a href="#acd5bedbb2212956dac77be47dceef510">More...</a><br /></td></tr>
<tr class="separator:acd5bedbb2212956dac77be47dceef510"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68a963557189666f5d733bfb9a826e41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a68a963557189666f5d733bfb9a826e41">stasis_subscription_join</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription)</td></tr>
<tr class="memdesc:a68a963557189666f5d733bfb9a826e41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block until the last message is processed on a subscription.  <a href="#a68a963557189666f5d733bfb9a826e41">More...</a><br /></td></tr>
<tr class="separator:a68a963557189666f5d733bfb9a826e41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d95cf98ebb8880cc602c801a639888e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a2d95cf98ebb8880cc602c801a639888e">stasis_subscription_set_congestion_limits</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription, long low_water, long high_water)</td></tr>
<tr class="memdesc:a2d95cf98ebb8880cc602c801a639888e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the high and low alert water marks of the stasis subscription.  <a href="#a2d95cf98ebb8880cc602c801a639888e">More...</a><br /></td></tr>
<tr class="separator:a2d95cf98ebb8880cc602c801a639888e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52b5393bef89d7781c0d039d6489de23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription, enum <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a> <a class="el" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a>)</td></tr>
<tr class="memdesc:a52b5393bef89d7781c0d039d6489de23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the message type filtering level on a subscription.  <a href="#a52b5393bef89d7781c0d039d6489de23">More...</a><br /></td></tr>
<tr class="separator:a52b5393bef89d7781c0d039d6489de23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86a7ba1f3c93ba7ee7583a0d8595025d"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a86a7ba1f3c93ba7ee7583a0d8595025d">stasis_subscription_uniqueid</a> (const struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)</td></tr>
<tr class="memdesc:a86a7ba1f3c93ba7ee7583a0d8595025d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the unique ID for the subscription.  <a href="#a86a7ba1f3c93ba7ee7583a0d8595025d">More...</a><br /></td></tr>
<tr class="separator:a86a7ba1f3c93ba7ee7583a0d8595025d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac26206b971b094c90839b4049cb6cc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:acac26206b971b094c90839b4049cb6cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new topic.  <a href="#acac26206b971b094c90839b4049cb6cc">More...</a><br /></td></tr>
<tr class="separator:acac26206b971b094c90839b4049cb6cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b49e1209c8280ab73a25585068b04cc"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a6b49e1209c8280ab73a25585068b04cc">stasis_topic_create_with_detail</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, const char *detail)</td></tr>
<tr class="memdesc:a6b49e1209c8280ab73a25585068b04cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new topic with given detail.  <a href="#a6b49e1209c8280ab73a25585068b04cc">More...</a><br /></td></tr>
<tr class="separator:a6b49e1209c8280ab73a25585068b04cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e5e4d29943a4dd27300887dc88ece28"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a6e5e4d29943a4dd27300887dc88ece28">stasis_topic_detail</a> (const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic)</td></tr>
<tr class="memdesc:a6e5e4d29943a4dd27300887dc88ece28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the detail of a topic.  <a href="#a6e5e4d29943a4dd27300887dc88ece28">More...</a><br /></td></tr>
<tr class="separator:a6e5e4d29943a4dd27300887dc88ece28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f065d129b21343b13a9eeb1c740771"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a02f065d129b21343b13a9eeb1c740771">stasis_topic_get</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a02f065d129b21343b13a9eeb1c740771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a topic of the given name.  <a href="#a02f065d129b21343b13a9eeb1c740771">More...</a><br /></td></tr>
<tr class="separator:a02f065d129b21343b13a9eeb1c740771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af23deee342575033bc73311b1215d886"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a> (const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic)</td></tr>
<tr class="memdesc:af23deee342575033bc73311b1215d886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the name of a topic.  <a href="#af23deee342575033bc73311b1215d886">More...</a><br /></td></tr>
<tr class="separator:af23deee342575033bc73311b1215d886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9a69946c2be89329630328f125330d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#aeb9a69946c2be89329630328f125330d">stasis_topic_pool_create</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *pooled_topic)</td></tr>
<tr class="memdesc:aeb9a69946c2be89329630328f125330d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a topic pool that routes messages from dynamically generated topics to the given topic.  <a href="#aeb9a69946c2be89329630328f125330d">More...</a><br /></td></tr>
<tr class="separator:aeb9a69946c2be89329630328f125330d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dfabff07a77d235b2b16d2b564f5c4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a1dfabff07a77d235b2b16d2b564f5c4b">stasis_topic_pool_delete_topic</a> (struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, const char *topic_name)</td></tr>
<tr class="memdesc:a1dfabff07a77d235b2b16d2b564f5c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a topic from the topic pool.  <a href="#a1dfabff07a77d235b2b16d2b564f5c4b">More...</a><br /></td></tr>
<tr class="separator:a1dfabff07a77d235b2b16d2b564f5c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ee1df597af46f3b489cce002b604a89"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a1ee1df597af46f3b489cce002b604a89">stasis_topic_pool_get_topic</a> (struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, const char *topic_name)</td></tr>
<tr class="memdesc:a1ee1df597af46f3b489cce002b604a89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find or create a topic in the pool.  <a href="#a1ee1df597af46f3b489cce002b604a89">More...</a><br /></td></tr>
<tr class="separator:a1ee1df597af46f3b489cce002b604a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a947db1503987a5c215dbc7240800a13d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a947db1503987a5c215dbc7240800a13d">stasis_topic_pool_topic_exists</a> (const struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, const char *topic_name)</td></tr>
<tr class="memdesc:a947db1503987a5c215dbc7240800a13d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if a topic exists in a pool.  <a href="#a947db1503987a5c215dbc7240800a13d">More...</a><br /></td></tr>
<tr class="separator:a947db1503987a5c215dbc7240800a13d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a461ec3c31a2f54d7c001b0ead6c7313d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a461ec3c31a2f54d7c001b0ead6c7313d">stasis_topic_subscribers</a> (const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic)</td></tr>
<tr class="memdesc:a461ec3c31a2f54d7c001b0ead6c7313d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of subscribers of a topic.  <a href="#a461ec3c31a2f54d7c001b0ead6c7313d">More...</a><br /></td></tr>
<tr class="separator:a461ec3c31a2f54d7c001b0ead6c7313d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a364abbdbd9de2c0cbc6487d0e8395913"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a364abbdbd9de2c0cbc6487d0e8395913">stasis_topic_uniqueid</a> (const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic)</td></tr>
<tr class="memdesc:a364abbdbd9de2c0cbc6487d0e8395913"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the uniqueid of a topic.  <a href="#a364abbdbd9de2c0cbc6487d0e8395913">More...</a><br /></td></tr>
<tr class="separator:a364abbdbd9de2c0cbc6487d0e8395913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3498301077e2005383f0d261c471388b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription)</td></tr>
<tr class="memdesc:a3498301077e2005383f0d261c471388b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel a subscription.  <a href="#a3498301077e2005383f0d261c471388b">More...</a><br /></td></tr>
<tr class="separator:a3498301077e2005383f0d261c471388b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221d05010106dcde0cc2e2b43c1a8b67"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a> (struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *subscription)</td></tr>
<tr class="memdesc:a221d05010106dcde0cc2e2b43c1a8b67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel a subscription, blocking until the last message is processed.  <a href="#a221d05010106dcde0cc2e2b43c1a8b67">More...</a><br /></td></tr>
<tr class="separator:a221d05010106dcde0cc2e2b43c1a8b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Stasis Message Bus API. See <a class="el" href="../../dd/dfd/stasis.html">Stasis Message Bus API</a> for detailed documentation. </p>
<dl class="section author"><dt>Author</dt><dd>David M. Lee, II <a href="#" onclick="location.href='mai'+'lto:'+'dle'+'e@'+'dig'+'iu'+'m.c'+'om'; return false;">dlee@<span style="display: none;">.nosp@m.</span>digi<span style="display: none;">.nosp@m.</span>um.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a31197e193b1dfd6c122ff6d7c7f6b3fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31197e193b1dfd6c122ff6d7c7f6b3fa">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_CLEANUP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STASIS_MESSAGE_TYPE_CLEANUP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({             \</div><div class="line">      ao2_cleanup(_priv_ ## <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);  \</div><div class="line">      _priv_ ## <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;     \</div><div class="line">   })</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
<p>Boiler-plate messaging macro for cleaning up message types. </p>
<p>Note that if your type is defined in core instead of a loadable module, you should call message type cleanup from an <a class="el" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3" title="Register a function to be executed before Asterisk gracefully exits. ">ast_register_cleanup()</a> handler instead of an <a class="el" href="../../db/db2/asterisk_8h.html#a9b09e95876dfecb9a8573819da0b255e" title="Register a function to be executed before Asterisk exits. ">ast_register_atexit()</a> handler.</p>
<p>The reason is that during an immediate shutdown, loadable modules (which may refer to core message types) are not unloaded. While the atexit handlers are run, there's a window of time where a module subscription might reference a core message type after it's been cleaned up. Which is bad.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of message type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l01523">1523</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l17540">__unload_module()</a>, <a class="el" href="../../d0/da6/aoc_8c_source.html#l02018">aoc_shutdown()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04385">cdr_engine_shutdown()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01249">cleanup_module()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00881">devstate_cleanup()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00448">endpoints_stasis_cleanup()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01976">file_shutdown()</a>, <a class="el" href="../../d7/de1/res__stasis__playback_8c_source.html#l00742">load_module()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l01122">local_shutdown()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00698">manager_confbridge_shutdown()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l08956">manager_shutdown()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01142">meetme_stasis_cleanup()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00491">mwi_cleanup()</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00046">parking_stasis_cleanup()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08909">pbx_shutdown()</a>, <a class="el" href="../../d9/dbf/pickup_8c_source.html#l00396">pickup_shutdown()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00484">presence_state_engine_cleanup()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03585">rtp_engine_shutdown()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00475">security_stasis_cleanup()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l01392">stasis_bridging_cleanup()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01002">stasis_cache_cleanup()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01630">stasis_channels_cleanup()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l03042">stasis_cleanup()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00353">stasis_system_cleanup()</a>, <a class="el" href="../../d8/db9/test_8c_source.html#l01211">test_cleanup()</a>, and <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00233">unload_module()</a>.</p>

</div>
</div>
<a id="aa72a761b5a8e8065c28f5b24ad54d68c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa72a761b5a8e8065c28f5b24ad54d68c">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_DEFN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STASIS_MESSAGE_TYPE_DEFN</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boiler-plate messaging macro for defining public message types. </p>
<div class="fragment"><div class="line"><a class="code" href="../../dd/d79/stasis_8h.html#aa72a761b5a8e8065c28f5b24ad54d68c">STASIS_MESSAGE_TYPE_DEFN</a>(ast_foo_type,</div><div class="line">   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = foo_to_ami,</div><div class="line">   .to_json = foo_to_json,</div><div class="line">   .to_event = foo_to_event,</div><div class="line">   );</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of message type. </td></tr>
    <tr><td class="paramname">...</td><td>Virtual table methods for messages of this type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l01448">1448</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

</div>
</div>
<a id="a51fb372b38f434a3bab7a5ec5e65c396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51fb372b38f434a3bab7a5ec5e65c396">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_DEFN_LOCAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STASIS_MESSAGE_TYPE_DEFN_LOCAL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Boiler-plate messaging macro for defining local message types. </p>
<div class="fragment"><div class="line"><a class="code" href="../../dd/d79/stasis_8h.html#a51fb372b38f434a3bab7a5ec5e65c396">STASIS_MESSAGE_TYPE_DEFN_LOCAL</a>(ast_foo_type,</div><div class="line">   .<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a> = foo_to_ami,</div><div class="line">   .to_json = foo_to_json,</div><div class="line">   .to_event = foo_to_event,</div><div class="line">   );</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of message type. </td></tr>
    <tr><td class="paramname">...</td><td>Virtual table methods for messages of this type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l01475">1475</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

</div>
</div>
<a id="a70cd046d8e3fd50de5c51aecb2830d2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70cd046d8e3fd50de5c51aecb2830d2a">&#9670;&nbsp;</a></span>STASIS_MESSAGE_TYPE_INIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STASIS_MESSAGE_TYPE_INIT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({                      \</div><div class="line">      ast_assert(_priv_ ## <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);       \</div><div class="line">      stasis_message_type_create(#<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>,   \</div><div class="line">         &amp;_priv_ ## <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> ## _v, &amp;_priv_ ## <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) == <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a> ? 1 : 0; \</div><div class="line">   })</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8h_html_af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00289">stasis.h:289</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
<p>Boiler-plate messaging macro for initializing message types. </p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(ast_foo_type) != 0) {</div><div class="line">   <span class="keywordflow">return</span> -1;</div><div class="line">}</div></div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of message type. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if initialization is successful. </dd>
<dd>
Non-zero on failure. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l01501">1501</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d10/manager_8c_source.html#l09144">__init_manager()</a>, <a class="el" href="../../d0/da6/aoc_8c_source.html#l02026">ast_aoc_cli_init()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00458">ast_endpoint_stasis_init()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l01983">ast_file_init()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l01140">ast_local_init()</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00053">ast_parking_stasis_init()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08982">ast_pbx_init()</a>, <a class="el" href="../../d9/dbf/pickup_8c_source.html#l00401">ast_pickup_init()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03622">ast_rtp_engine_init()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00483">ast_security_stasis_init()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l01407">ast_stasis_bridging_init()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01666">ast_stasis_channels_init()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00373">ast_stasis_system_init()</a>, <a class="el" href="../../d8/db9/test_8c_source.html#l01221">ast_test_init()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00246">load_module()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00721">manager_confbridge_init()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01157">meetme_stasis_init()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00502">mwi_init()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01008">stasis_cache_init()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l03061">stasis_init()</a>.</p>

</div>
</div>
<a id="ae3fe7fe099389094244002113814ec23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3fe7fe099389094244002113814ec23">&#9670;&nbsp;</a></span>stasis_subscribe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define stasis_subscribe</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">topic, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">callback, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../d0/df4/stasis_8c.html#a23dcf25efe633f0f429a1520f066249f">__stasis_subscribe</a>(topic, callback, data, __FILE__, __LINE__, __PRETTY_FUNCTION__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l00652">652</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01470">acl_change_stasis_subscribe()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01973">ast_res_pjsip_initialize_configuration()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00666">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02791">cc_generic_agent_start_monitoring()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02154">create_cts()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01409">create_new_generic_list()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l11324">load_module()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08460">load_pbx()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01455">network_change_stasis_subscribe()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00685">parking_manager_enable_stasis()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00705">presence_change_common()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l09346">rtp_reload()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01588">xmpp_init_event_distribution()</a>.</p>

</div>
</div>
<a id="a597f7a30fe616c9f083a93ed168955ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a597f7a30fe616c9f083a93ed168955ed">&#9670;&nbsp;</a></span>stasis_subscribe_pool</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define stasis_subscribe_pool</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">topic, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">callback, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../d0/df4/stasis_8c.html#a6b7cbb6df580f2e3cba59eed0400fee4">__stasis_subscribe_pool</a>(topic, callback, data, __FILE__, __LINE__, __PRETTY_FUNCTION__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l00682">682</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00369">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00174">create_parked_subscription_full()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l35495">load_module()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00892">park_and_announce_app_exec()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00625">refer_blind_callback()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00446">stasis_state_subscribe_pool()</a>, <a class="el" href="../../dd/d71/res__stasis__device__state_8c_source.html#l00360">subscribe_device_state()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01588">xmpp_init_event_distribution()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aa4a7b629d3125dc329b43715f5f5663b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a7b629d3125dc329b43715f5f5663b">&#9670;&nbsp;</a></span>cache_aggregate_calc_fn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>*(* cache_aggregate_calc_fn) (struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *<a class="el" href="../../d3/d96/structentry.html">entry</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *new_snapshot)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback to calculate the aggregate cache entry. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>Cache entry to calculate a new aggregate snapshot. </td></tr>
    <tr><td class="paramname">new_snapshot</td><td>The shapshot that is being updated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Return a ref bumped pointer from <a class="el" href="../../dd/d79/stasis_8h.html#a103ead88f88b74cb33bee4a843c4a162" title="Get the aggregate cache entry snapshot. ">stasis_cache_entry_get_aggregate()</a> if a new aggregate could not be calculated because of error.</dd>
<dd>
An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>New aggregate-snapshot calculated on success. Caller has a reference on return. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l01033">1033</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

</div>
</div>
<a id="a9a0eb1c6ec2920123af41e05b5592a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0eb1c6ec2920123af41e05b5592a7c">&#9670;&nbsp;</a></span>cache_aggregate_publish_fn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* cache_aggregate_publish_fn) (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *aggregate)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback to publish the aggregate cache entry message. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<p>Once an aggregate message is calculated. This callback publishes the message so subscribers will know the new value of an aggregated state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>The aggregate message may be published to this topic. It is the topic to which the cache itself is subscribed. </td></tr>
    <tr><td class="paramname">aggregate</td><td>The aggregate shapshot message to publish.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is up to the function to determine if there is a better topic the aggregate message should be published over.</dd>
<dd>
An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l01059">1059</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

</div>
</div>
<a id="a987cdda9bbdeb303d5d7619136f5bea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987cdda9bbdeb303d5d7619136f5bea6">&#9670;&nbsp;</a></span>snapshot_get_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef const char*(* snapshot_get_id) (struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback extract a unique identity from a snapshot message. </p>
<p>This identity is unique to the underlying object of the snapshot, such as the UniqueId field of a channel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>Message to extract id from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>String representing the snapshot's id. </dd>
<dd>
<code>NULL</code> if the message_type of the message isn't a handled snapshot. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l01011">1011</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

</div>
</div>
<a id="a2b7854b4fb538be6f885943a24d60c8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b7854b4fb538be6f885943a24d60c8f">&#9670;&nbsp;</a></span>stasis_subscription_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* stasis_subscription_cb) (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback function type for Stasis subscriptions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Data field provided with subscription. </td></tr>
    <tr><td class="paramname">message</td><td>Published message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l00615">615</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="af326808a49f64881cfa368ef2e5f49e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af326808a49f64881cfa368ef2e5f49e3">&#9670;&nbsp;</a></span>stasis_message_type_result</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3">stasis_message_type_result</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return code for Stasis message type creation attempts. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8"></a>STASIS_MESSAGE_TYPE_ERROR&#160;</td><td class="fielddoc"><p>Message type was not created due to allocation failure </p>
</td></tr>
<tr><td class="fieldname"><a id="af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42"></a>STASIS_MESSAGE_TYPE_SUCCESS&#160;</td><td class="fielddoc"><p>Message type was created successfully </p>
</td></tr>
<tr><td class="fieldname"><a id="af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e"></a>STASIS_MESSAGE_TYPE_DECLINED&#160;</td><td class="fielddoc"><p>Message type was not created due to configuration </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l00288">288</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a> = -1,  <span class="comment">/*!&lt; Message type was not created due to allocation failure */</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42">STASIS_MESSAGE_TYPE_SUCCESS</a>,  <span class="comment">/*!&lt; Message type was created successfully */</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e">STASIS_MESSAGE_TYPE_DECLINED</a>, <span class="comment">/*!&lt; Message type was not created due to configuration */</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;};</div><div class="ttc" id="stasis_8h_html_af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42">STASIS_MESSAGE_TYPE_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00290">stasis.h:290</a></div></div>
<div class="ttc" id="stasis_8h_html_af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00289">stasis.h:289</a></div></div>
<div class="ttc" id="stasis_8h_html_af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e">STASIS_MESSAGE_TYPE_DECLINED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00291">stasis.h:291</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3804fa8ec76d77090d5cda80fc4ac891"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3804fa8ec76d77090d5cda80fc4ac891">&#9670;&nbsp;</a></span>stasis_subscription_message_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stasis subscription message filters. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a3804fa8ec76d77090d5cda80fc4ac891a98a891164b5e65d1d6377ab58321621f"></a>STASIS_SUBSCRIPTION_FILTER_NONE&#160;</td><td class="fielddoc"><p>No filter is in place, all messages are raised </p>
</td></tr>
<tr><td class="fieldname"><a id="a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70"></a>STASIS_SUBSCRIPTION_FILTER_FORCED_NONE&#160;</td><td class="fielddoc"><p>No filter is in place or can be set, all messages are raised </p>
</td></tr>
<tr><td class="fieldname"><a id="a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"></a>STASIS_SUBSCRIPTION_FILTER_SELECTIVE&#160;</td><td class="fielddoc"><p>Only messages of allowed message types are raised </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l00297">297</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                        {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a98a891164b5e65d1d6377ab58321621f">STASIS_SUBSCRIPTION_FILTER_NONE</a> = 0,    <span class="comment">/*!&lt; No filter is in place, all messages are raised */</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>, <span class="comment">/*!&lt; No filter is in place or can be set, all messages are raised */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>,   <span class="comment">/*!&lt; Only messages of allowed message types are raised */</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;};</div><div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a98a891164b5e65d1d6377ab58321621f"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a98a891164b5e65d1d6377ab58321621f">STASIS_SUBSCRIPTION_FILTER_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00298">stasis.h:298</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00299">stasis.h:299</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ae672fb0f772d0e3066fa4c29c41814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae672fb0f772d0e3066fa4c29c41814">&#9670;&nbsp;</a></span>stasis_subscription_message_formatters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stasis subscription formatter filters. </p>
<p>There should be an entry here for each member of <a class="el" href="../../dd/d3e/structstasis__message__vtable.html">stasis_message_vtable</a></p>
<dl class="section since"><dt>Since</dt><dd>13.25.0 </dd>
<dd>
16.2.0 </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e"></a>STASIS_SUBSCRIPTION_FORMATTER_NONE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587"></a>STASIS_SUBSCRIPTION_FORMATTER_JSON&#160;</td><td class="fielddoc"><p>Allow messages with a to_json formatter </p>
</td></tr>
<tr><td class="fieldname"><a id="a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d"></a>STASIS_SUBSCRIPTION_FORMATTER_AMI&#160;</td><td class="fielddoc"><p>Allow messages with a to_ami formatter </p>
</td></tr>
<tr><td class="fieldname"><a id="a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09"></a>STASIS_SUBSCRIPTION_FORMATTER_EVENT&#160;</td><td class="fielddoc"><p>Allow messages with a to_event formatter </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/d79/stasis_8h_source.html#l00311">311</a> of file <a class="el" href="../../dd/d79/stasis_8h_source.html">stasis.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                            {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e">STASIS_SUBSCRIPTION_FORMATTER_NONE</a> =  0,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587">STASIS_SUBSCRIPTION_FORMATTER_JSON</a> =  1 &lt;&lt; 0,  <span class="comment">/*!&lt; Allow messages with a to_json formatter */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d">STASIS_SUBSCRIPTION_FORMATTER_AMI</a> =   1 &lt;&lt; 1,  <span class="comment">/*!&lt; Allow messages with a to_ami formatter */</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09">STASIS_SUBSCRIPTION_FORMATTER_EVENT</a> = 1 &lt;&lt; 2,  <span class="comment">/*!&lt; Allow messages with a to_event formatter */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;};</div><div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09">STASIS_SUBSCRIPTION_FORMATTER_EVENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00315">stasis.h:315</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d">STASIS_SUBSCRIPTION_FORMATTER_AMI</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00314">stasis.h:314</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e">STASIS_SUBSCRIPTION_FORMATTER_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00312">stasis.h:312</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587">STASIS_SUBSCRIPTION_FORMATTER_JSON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00313">stasis.h:313</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a23dcf25efe633f0f429a1520f066249f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23dcf25efe633f0f429a1520f066249f">&#9670;&nbsp;</a></span>__stasis_subscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a>* __stasis_subscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a subscription. </p>
<p>In addition to being AO2 managed memory (requiring an <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> to free up this reference), the subscription must be explicitly unsubscribed from its topic using <a class="el" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b" title="Cancel a subscription. ">stasis_unsubscribe()</a>.</p>
<p>The invocations of the callback are serialized, but may not always occur on the same thread. The invocation order of different subscriptions is unspecified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic to subscribe to. </td></tr>
    <tr><td class="paramname">callback</td><td>Callback function for subscription messages. </td></tr>
    <tr><td class="paramname">data</td><td>Data to be passed to the callback, in addition to the message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> object. </dd>
<dd>
<code>NULL</code> on error. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This callback will receive a callback with a message indicating it has been subscribed. This occurs immediately before accepted message types can be set and the callback must expect to receive it. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00944">944</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;{</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/df4/stasis_8c.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a>(topic, callback, data, 1, 0, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, lineno, func);</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;}</div><div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="stasis_8c_html_ab7d9bff23ceccb19080696e3b48506aa"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a></div><div class="ttdeci">struct stasis_subscription * internal_stasis_subscribe(struct stasis_topic *topic, stasis_subscription_cb callback, void *data, int needs_mailbox, int use_thread_pool, const char *file, int lineno, const char *func)</div><div class="ttdoc">Create a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00858">stasis.c:858</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b7cbb6df580f2e3cba59eed0400fee4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b7cbb6df580f2e3cba59eed0400fee4">&#9670;&nbsp;</a></span>__stasis_subscribe_pool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a>* __stasis_subscribe_pool </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a subscription whose callbacks occur on a thread pool. </p>
<p>In addition to being AO2 managed memory (requiring an <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> to free up this reference), the subscription must be explicitly unsubscribed from its topic using <a class="el" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b" title="Cancel a subscription. ">stasis_unsubscribe()</a>.</p>
<p>The invocations of the callback are serialized, but will almost certainly not always happen on the same thread. The invocation order of different subscriptions is unspecified.</p>
<p>Unlike <a class="el" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>, this function will explicitly use a threadpool to dispatch items to its <code>callback</code>. This form of subscription should be used when many subscriptions may be made to the specified <code>topic</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic to subscribe to. </td></tr>
    <tr><td class="paramname">callback</td><td>Callback function for subscription messages. </td></tr>
    <tr><td class="paramname">data</td><td>Data to be passed to the callback, in addition to the message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> object. </dd>
<dd>
<code>NULL</code> on error. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12.8.0</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This callback will receive a callback with a message indicating it has been subscribed. This occurs immediately before accepted message types can be set and the callback must expect to receive it. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00955">955</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;{</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/df4/stasis_8c.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a>(topic, callback, data, 1, 1, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, lineno, func);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div><div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="stasis_8c_html_ab7d9bff23ceccb19080696e3b48506aa"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a></div><div class="ttdeci">struct stasis_subscription * internal_stasis_subscribe(struct stasis_topic *topic, stasis_subscription_cb callback, void *data, int needs_mailbox, int use_thread_pool, const char *file, int lineno, const char *func)</div><div class="ttdoc">Create a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00858">stasis.c:858</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a169e12055004ecf0ecc355b3e3e1f218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a169e12055004ecf0ecc355b3e3e1f218">&#9670;&nbsp;</a></span>stasis_cache_clear_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_clear_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A message which instructs the caching topic to remove an entry from its cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message</td><td>Message representative of the cache entry that should be cleared. This will become the data held in the stasis_cache_clear message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Message which, when sent to a <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>, will clear the item from the cache. </dd>
<dd>
<code>NULL</code> on error. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00778">778</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00399">ast_delete_mwi_state_full()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00688">ast_device_state_clear_cache()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00350">ast_endpoint_shutdown()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01033">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00623">clear_node_cache()</a>, and <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00479">remove_device_states_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;{</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>(), id_message);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div><div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a64035c0f7317db2590817a173d268ff1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64035c0f7317db2590817a173d268ff1">&#9670;&nbsp;</a></span>stasis_cache_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a>* stasis_cache_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a>&#160;</td>
          <td class="paramname"><em>id_fn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a cache. </p>
<p>This is the backend store for a <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>. The cache is thread safe, allowing concurrent reads and writes.</p>
<p>The returned object is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id_fn</td><td>Callback to extract the id from a snapshot message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">New</td><td>cache indexed by <em>id_fn</em>. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00360">360</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache_create_full()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00502">mwi_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00065">stasis_cp_all_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/da9/stasis__cache_8c.html#adb417e66895425f128678fe3ed589010">stasis_cache_create_full</a>(id_fn, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_adb417e66895425f128678fe3ed589010"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#adb417e66895425f128678fe3ed589010">stasis_cache_create_full</a></div><div class="ttdeci">struct stasis_cache * stasis_cache_create_full(snapshot_get_id id_fn, cache_aggregate_calc_fn aggregate_calc_fn, cache_aggregate_publish_fn aggregate_publish_fn)</div><div class="ttdoc">Create a cache. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00334">stasis_cache.c:334</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb417e66895425f128678fe3ed589010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb417e66895425f128678fe3ed589010">&#9670;&nbsp;</a></span>stasis_cache_create_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a>* stasis_cache_create_full </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a987cdda9bbdeb303d5d7619136f5bea6">snapshot_get_id</a>&#160;</td>
          <td class="paramname"><em>id_fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#aa4a7b629d3125dc329b43715f5f5663b">cache_aggregate_calc_fn</a>&#160;</td>
          <td class="paramname"><em>aggregate_calc_fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a9a0eb1c6ec2920123af41e05b5592a7c">cache_aggregate_publish_fn</a>&#160;</td>
          <td class="paramname"><em>aggregate_publish_fn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a cache. </p>
<p>This is the backend store for a <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>. The cache is thread safe, allowing concurrent reads and writes.</p>
<p>The returned object is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id_fn</td><td>Callback to extract the id from a snapshot message. </td></tr>
    <tr><td class="paramname">aggregate_calc_fn</td><td>Callback to calculate the aggregate cache entry. </td></tr>
    <tr><td class="paramname">aggregate_publish_fn</td><td>Callback to publish the aggregate cache entry.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">New</td><td>cache indexed by <em>id_fn</em>. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00334">334</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00049">stasis_cache::aggregate_calc_fn</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00050">stasis_cache::aggregate_publish_fn</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00367">AO2_ALLOC_OPT_LOCK_RWLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">cache</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00326">cache_dtor()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00288">cache_entry_cmp()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00266">cache_entry_hash()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00048">stasis_cache::id_fn</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00042">NUM_CACHE_BUCKETS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00360">stasis_cache_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   cache = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*cache), <a class="code" href="../../d0/da9/stasis__cache_8c.html#ad08f197928151ebfd2bc4dc40d43cc7d">cache_dtor</a>,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">if</span> (!cache) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488">AO2_ALLOC_OPT_LOCK_RWLOCK</a>, 0,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <a class="code" href="../../d0/da9/stasis__cache_8c.html#aa2c7ce70c25f706f8eafad4001c28daa">NUM_CACHE_BUCKETS</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a8b8388a1d7ada8d25bee76503157c7b3">cache_entry_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#abb6ae2aeb60c09e62d465d9e4f64afc8">cache_entry_cmp</a>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cache);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">id_fn</a> = <a class="code" href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">id_fn</a>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">aggregate_calc_fn</a> = <a class="code" href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">aggregate_calc_fn</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">aggregate_publish_fn</a> = <a class="code" href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">aggregate_publish_fn</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div><div class="ttc" id="structstasis__cache_html_a369970f3c5eed960424f218cd62c7767"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a369970f3c5eed960424f218cd62c7767">stasis_cache::aggregate_calc_fn</a></div><div class="ttdeci">cache_aggregate_calc_fn aggregate_calc_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00049">stasis_cache.c:49</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_abb6ae2aeb60c09e62d465d9e4f64afc8"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#abb6ae2aeb60c09e62d465d9e4f64afc8">cache_entry_cmp</a></div><div class="ttdeci">static int cache_entry_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00288">stasis_cache.c:288</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structstasis__cache_html"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html">stasis_cache</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00046">stasis_cache.c:46</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488">AO2_ALLOC_OPT_LOCK_RWLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00367">astobj2.h:367</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_aefe318d32c8bb7a9e2025eb146d47781"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a></div><div class="ttdeci">struct ao2_container * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">pbx_realtime.c:77</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__cache_html_aeda10c064fed74e2c7297ccd112dbd37"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#aeda10c064fed74e2c7297ccd112dbd37">stasis_cache::id_fn</a></div><div class="ttdeci">snapshot_get_id id_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00048">stasis_cache.c:48</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_aa2c7ce70c25f706f8eafad4001c28daa"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#aa2c7ce70c25f706f8eafad4001c28daa">NUM_CACHE_BUCKETS</a></div><div class="ttdeci">#define NUM_CACHE_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00042">stasis_cache.c:42</a></div></div>
<div class="ttc" id="structstasis__cache_html_af22227dc9b043f62966da1f9f8556137"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#af22227dc9b043f62966da1f9f8556137">stasis_cache::aggregate_publish_fn</a></div><div class="ttdeci">cache_aggregate_publish_fn aggregate_publish_fn</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00050">stasis_cache.c:50</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a8b8388a1d7ada8d25bee76503157c7b3"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a8b8388a1d7ada8d25bee76503157c7b3">cache_entry_hash</a></div><div class="ttdeci">static int cache_entry_hash(const void *obj, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00266">stasis_cache.c:266</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_ad08f197928151ebfd2bc4dc40d43cc7d"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#ad08f197928151ebfd2bc4dc40d43cc7d">cache_dtor</a></div><div class="ttdeci">static void cache_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00326">stasis_cache.c:326</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c5612920b22beb93b5e8acbdae40078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c5612920b22beb93b5e8acbdae40078">&#9670;&nbsp;</a></span>stasis_cache_dump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_dump </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump cached items to a subscription for the ast_eid_default entity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to dump (any type if <code>NULL</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d2/da9/structao2__container.html" title="Generic container type. ">ao2_container</a></td><td>containing all matches (must be unreffed by caller) </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">736</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00718">stasis_cache_dump_by_eid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d2d/res__manager__presencestate_8c_source.html#l00073">action_presencestatelist()</a>, <a class="el" href="../../d1/d5a/resource__endpoints_8c_source.html#l00037">ast_ari_endpoints_list()</a>, <a class="el" href="../../d1/d5a/resource__endpoints_8c_source.html#l00085">ast_ari_endpoints_list_by_tech()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01132">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00559">asterisk_publication_devicestate_refresh()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00650">asterisk_publication_mwi_refresh()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>, <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00097">endpoints_scrape_cb()</a>, <a class="el" href="../../d6/d6a/res__endpoint__stats_8c_source.html#l00115">load_module()</a>, <a class="el" href="../../d6/d6a/res__endpoint__stats_8c_source.html#l00134">unload_module()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01588">xmpp_init_event_distribution()</a>.</p>
<div class="fragment"><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;{</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/da9/stasis__cache_8c.html#a9a4de0928d2b230b1c3184ba506ecf26">stasis_cache_dump_by_eid</a>(cache, type, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div><div class="ttc" id="stasis__cache_8c_html_a9a4de0928d2b230b1c3184ba506ecf26"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a9a4de0928d2b230b1c3184ba506ecf26">stasis_cache_dump_by_eid</a></div><div class="ttdeci">struct ao2_container * stasis_cache_dump_by_eid(struct stasis_cache *cache, struct stasis_message_type *type, const struct ast_eid *eid)</div><div class="ttdoc">Dump cached items to a subscription for a specific entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00718">stasis_cache.c:718</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab54f6037e019ae477c15e90e52904d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab54f6037e019ae477c15e90e52904d09">&#9670;&nbsp;</a></span>stasis_cache_dump_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_dump_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump all entity items from the cache to a subscription. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to dump (any type if <code>NULL</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d2/da9/structao2__container.html" title="Generic container type. ">ao2_container</a></td><td>containing all matches (must be unreffed by caller) </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00757">757</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01335">ao2_container_alloc_list</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00741">cache_dump_all_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00692">cache_dump_data::container</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00694">cache_dump_data::eid</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01053">OBJ_MULTIPLE</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c.html#a96256b49165db103875323bce1540653">STASIS_MESSAGE_TYPE_DEFN()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00693">cache_dump_data::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00498">cache_cleanup()</a>, and <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01249">cleanup_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a> cache_dump;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   cache_dump.eid = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   cache_dump.type = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   cache_dump.container = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keywordflow">if</span> (!cache_dump.container) {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#af687f0328d2e3cd667cb5a4a881031d4">cache_dump_all_cb</a>, &amp;cache_dump);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="keywordflow">return</span> cache_dump.container;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_af687f0328d2e3cd667cb5a4a881031d4"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#af687f0328d2e3cd667cb5a4a881031d4">cache_dump_all_cb</a></div><div class="ttdeci">static int cache_dump_all_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00741">stasis_cache.c:741</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structcache__dump__data_html"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00691">stasis_cache.c:691</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a4de0928d2b230b1c3184ba506ecf26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4de0928d2b230b1c3184ba506ecf26">&#9670;&nbsp;</a></span>stasis_cache_dump_by_eid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_dump_by_eid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump cached items to a subscription for a specific entity. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to dump (any type if <code>NULL</code>). </td></tr>
    <tr><td class="paramname">eid</td><td>Specific entity id to retrieve. NULL for aggregate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname"><a class="el" href="../../d2/da9/structao2__container.html" title="Generic container type. ">ao2_container</a></td><td>containing all matches (must be unreffed by caller) </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00718">718</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01335">ao2_container_alloc_list</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00697">cache_dump_by_eid_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00692">cache_dump_data::container</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00694">cache_dump_data::eid</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01053">OBJ_MULTIPLE</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00693">cache_dump_data::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d1d/res__manager__devicestate_8c_source.html#l00073">action_devicestatelist()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00647">cpg_confchg_cb()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00736">stasis_cache_dump()</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a> cache_dump;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   cache_dump.eid = <a class="code" href="../../dc/dea/structcache__dump__data.html#a39d1b63955a48c72508fa9f884d05762">eid</a>;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   cache_dump.type = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   cache_dump.container = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="keywordflow">if</span> (!cache_dump.container) {</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a364ec06116503a4aa2ebededab145a8b">cache_dump_by_eid_cb</a>, &amp;cache_dump);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="keywordflow">return</span> cache_dump.container;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="structcache__dump__data_html_a39d1b63955a48c72508fa9f884d05762"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html#a39d1b63955a48c72508fa9f884d05762">cache_dump_data::eid</a></div><div class="ttdeci">const struct ast_eid * eid</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00694">stasis_cache.c:694</a></div></div>
<div class="ttc" id="structcache__dump__data_html"><div class="ttname"><a href="../../dc/dea/structcache__dump__data.html">cache_dump_data</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00691">stasis_cache.c:691</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a364ec06116503a4aa2ebededab145a8b"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a364ec06116503a4aa2ebededab145a8b">cache_dump_by_eid_cb</a></div><div class="ttdeci">static int cache_dump_by_eid_cb(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00697">stasis_cache.c:697</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a103ead88f88b74cb33bee4a843c4a162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a103ead88f88b74cb33bee4a843c4a162">&#9670;&nbsp;</a></span>stasis_cache_entry_get_aggregate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_entry_get_aggregate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the aggregate cache entry snapshot. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>Cache entry to get the aggregate snapshot.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A reference is not given to the returned pointer so don't unref it.</dd>
<dd>
An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Aggregate-snapshot</td><td>in cache. </td></tr>
    <tr><td class="paramname">NULL</td><td>if not present. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00365">365</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache_entry::aggregate</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, and <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keywordflow">return</span> entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">aggregate</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div><div class="ttc" id="structstasis__cache__entry_html_af11d58f16b29e3f5149a1ea04f83d5a4"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#af11d58f16b29e3f5149a1ea04f83d5a4">stasis_cache_entry::aggregate</a></div><div class="ttdeci">struct stasis_message * aggregate</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00176">stasis_cache.c:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55563a8b16be69f6f7cae05e5b4e65fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55563a8b16be69f6f7cae05e5b4e65fc">&#9670;&nbsp;</a></span>stasis_cache_entry_get_local()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_entry_get_local </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the local entity's cache entry snapshot. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>Cache entry to get the local entity's snapshot.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A reference is not given to the returned pointer so don't unref it.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Internal-snapshot</td><td>in cache. </td></tr>
    <tr><td class="paramname">NULL</td><td>if not present. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00370">370</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache_entry::local</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, and <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <span class="keywordflow">return</span> entry-&gt;<a class="code" href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">local</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="ttc" id="structstasis__cache__entry_html_aa539ae24ebd585ae6ca257d219ca52fd"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html#aa539ae24ebd585ae6ca257d219ca52fd">stasis_cache_entry::local</a></div><div class="ttdeci">struct stasis_message * local</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00178">stasis_cache.c:178</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0ffccea6541acbcf4ab9d6913f2e757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ffccea6541acbcf4ab9d6913f2e757">&#9670;&nbsp;</a></span>stasis_cache_entry_get_remote()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_entry_get_remote </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *&#160;</td>
          <td class="paramname"><em>entry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a remote entity's cache entry snapshot by index. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">entry</td><td>Cache entry to get a remote entity's snapshot. </td></tr>
    <tr><td class="paramname">idx</td><td>Which remote entity's snapshot to get.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>A reference is not given to the returned pointer so don't unref it.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Remote-entity-snapshot</td><td>in cache. </td></tr>
    <tr><td class="paramname">NULL</td><td>if not present. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00375">375</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, and <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;{</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keywordflow">if</span> (idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;entry-&gt;remote)) {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;entry-&gt;remote, idx);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3da17290725793258020b83f56e4df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3da17290725793258020b83f56e4df6">&#9670;&nbsp;</a></span>stasis_cache_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve an item from the cache for the ast_eid_default entity. </p>
<p>The returned item is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done with it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to retrieve. </td></tr>
    <tr><td class="paramname">id</td><td>Identity of the snapshot to retrieve.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Message</td><td>from the cache. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00686">686</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00659">stasis_cache_get_by_eid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00341">ast_endpoint_latest_snapshot()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01033">AST_TEST_DEFINE()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l29726">get_cached_mwi()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l05033">has_voicemail()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00125">presence_state_cached()</a>, <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l05675">unistim_send_mwi_to_peer()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l09002">update_registry()</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/da9/stasis__cache_8c.html#a1d22721748b1bfd63ab13d92f19dfd02">stasis_cache_get_by_eid</a>(cache, type, <span class="keywordtype">id</span>, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div><div class="ttc" id="stasis__cache_8c_html_a1d22721748b1bfd63ab13d92f19dfd02"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a1d22721748b1bfd63ab13d92f19dfd02">stasis_cache_get_by_eid</a></div><div class="ttdeci">struct stasis_message * stasis_cache_get_by_eid(struct stasis_cache *cache, struct stasis_message_type *type, const char *id, const struct ast_eid *eid)</div><div class="ttdoc">Retrieve an item from the cache for a specific entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00659">stasis_cache.c:659</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a886f222d38f8a07dee5a595d5c19a3fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886f222d38f8a07dee5a595d5c19a3fb">&#9670;&nbsp;</a></span>stasis_cache_get_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* stasis_cache_get_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve all matching entity items from the cache. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to retrieve. </td></tr>
    <tr><td class="paramname">id</td><td>Identity of the snapshot to retrieve.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Container</td><td>of matching items found. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00587">587</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01335">ao2_container_alloc_list</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00719">ao2_rdlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00563">cache_entry_dump()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01245">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_entry;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *found;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<span class="keywordtype">id</span> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   found = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   cached_entry = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, type, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <span class="keywordflow">if</span> (cached_entry &amp;&amp; <a class="code" href="../../d0/da9/stasis__cache_8c.html#a4ba570c6048d965f9848d65ca75f7a42">cache_entry_dump</a>(found, cached_entry)) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(found);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      found = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cached_entry);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordflow">return</span> found;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a0723b9228855b55f0e1a0be21cf819ae"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a></div><div class="ttdeci">static struct stasis_cache_entry * cache_find(struct ao2_container *entries, struct stasis_message_type *type, const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00396">stasis_cache.c:396</a></div></div>
<div class="ttc" id="astobj2_8h_html_a24c1bf4b1202c996cf8a793fa6669bc2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a></div><div class="ttdeci">#define ao2_rdlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00719">astobj2.h:719</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4ba570c6048d965f9848d65ca75f7a42"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4ba570c6048d965f9848d65ca75f7a42">cache_entry_dump</a></div><div class="ttdeci">static int cache_entry_dump(struct ao2_container *snapshots, const struct stasis_cache_entry *entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00563">stasis_cache.c:563</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d22721748b1bfd63ab13d92f19dfd02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d22721748b1bfd63ab13d92f19dfd02">&#9670;&nbsp;</a></span>stasis_cache_get_by_eid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_cache_get_by_eid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve an item from the cache for a specific entity. </p>
<p>The returned item is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done with it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">type</td><td>Type of message to retrieve. </td></tr>
    <tr><td class="paramname">id</td><td>Identity of the snapshot to retrieve. </td></tr>
    <tr><td class="paramname">eid</td><td>Specific entity id to retrieve. NULL for aggregate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Message</td><td>from the cache. </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00659">659</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00719">ao2_rdlock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00631">cache_entry_by_eid()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/db4/mwi_8c_source.html#l00399">ast_delete_mwi_state_full()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00688">ast_device_state_clear_cache()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00511">AST_TEST_DEFINE()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00970">check_cache_aggregate()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00309">devstate_cached()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00686">stasis_cache_get()</a>.</p>
<div class="fragment"><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;{</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a> *cached_entry;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *snapshot = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<span class="keywordtype">id</span> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   cached_entry = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, type, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="keywordflow">if</span> (cached_entry) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      snapshot = <a class="code" href="../../d0/da9/stasis__cache_8c.html#a4ecac4fb3b7fba43cc0fae0c20a91cbd">cache_entry_by_eid</a>(cached_entry, eid);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(snapshot);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cached_entry);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordflow">return</span> snapshot;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;}</div><div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a0723b9228855b55f0e1a0be21cf819ae"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0723b9228855b55f0e1a0be21cf819ae">cache_find</a></div><div class="ttdeci">static struct stasis_cache_entry * cache_find(struct ao2_container *entries, struct stasis_message_type *type, const char *id)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00396">stasis_cache.c:396</a></div></div>
<div class="ttc" id="astobj2_8h_html_a24c1bf4b1202c996cf8a793fa6669bc2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a24c1bf4b1202c996cf8a793fa6669bc2">ao2_rdlock</a></div><div class="ttdeci">#define ao2_rdlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00719">astobj2.h:719</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a4ecac4fb3b7fba43cc0fae0c20a91cbd"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a4ecac4fb3b7fba43cc0fae0c20a91cbd">cache_entry_by_eid</a></div><div class="ttdeci">static struct stasis_message * cache_entry_by_eid(const struct stasis_cache_entry *entry, const struct ast_eid *eid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00631">stasis_cache.c:631</a></div></div>
<div class="ttc" id="structstasis__cache__entry_html"><div class="ttname"><a href="../../de/d73/structstasis__cache__entry.html">stasis_cache_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00173">stasis_cache.c:173</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a81215cb37a9287389855d0529332b1b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81215cb37a9287389855d0529332b1b7">&#9670;&nbsp;</a></span>stasis_cache_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_cache_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01008">1008</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00019">ast_register_cleanup()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01002">stasis_cache_cleanup()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l01501">STASIS_MESSAGE_TYPE_INIT</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/df4/stasis_8c_source.html#l03061">stasis_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;{</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d0/da9/stasis__cache_8c.html#a0a8871098ef8b0f1afa6103fd2774ddb">stasis_cache_cleanup</a>);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>) != 0) {</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   }</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>) != 0) {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab5d1a876f8f0cd0562fb5d5f94c06717"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_update_type(void)</div><div class="ttdoc">Message type for cache update messages. </div></div>
<div class="ttc" id="stasis__cache_8c_html_a0a8871098ef8b0f1afa6103fd2774ddb"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a0a8871098ef8b0f1afa6103fd2774ddb">stasis_cache_cleanup</a></div><div class="ttdeci">static void stasis_cache_cleanup(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l01002">stasis_cache.c:1002</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd235b443f5fffb17c7bc98b6d48ddd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd235b443f5fffb17c7bc98b6d48ddd2">&#9670;&nbsp;</a></span>stasis_caching_accept_message_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_caching_accept_message_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate to a caching topic that we are interested in a message type. </p>
<p>This will cause the caching topic to receive messages of the given message type. This enables internal filtering in the stasis message bus to reduce messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>The caching topic. </td></tr>
    <tr><td class="paramname">type</td><td>The message type we wish to receive. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00090">90</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00222">stasis_cp_single_accept_message_type()</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   <span class="comment">/* We wait to accept the stasis specific message types until now so that by default everything</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    * will flow to us.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   res = <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a>());</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   res |= <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>());</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   res |= <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, type);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga5e2b5addf55fb60e66c4f590652a3649"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga5e2b5addf55fb60e66c4f590652a3649">stasis_cache_clear_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_clear_type(void)</div><div class="ttdoc">Message type for clearing a message from a stasis cache. </div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a60b3b41b59f3894b40f5630524347d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60b3b41b59f3894b40f5630524347d62">&#9670;&nbsp;</a></span>stasis_caching_get_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_caching_get_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the topic of cached events from a caching topics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>The caching topic. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The topic that publishes cache update events, along with passthrough events from the underlying topic. </dd>
<dd>
<code>NULL</code> if <em>caching_topic</em> is <code>NULL</code>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00085">85</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_caching_topic::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00678">ast_device_state_topic_cached()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00095">ast_mwi_topic_cached()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00375">ast_presence_state_topic_cached()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00139">stasis_cp_single_create()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00213">stasis_cp_single_topic_cached()</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="keywordflow">return</span> caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div><div class="ttc" id="structstasis__caching__topic_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">stasis_caching_topic::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_cache.c:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5db3f77a72f6a07c86a00f638daff07a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5db3f77a72f6a07c86a00f638daff07a">&#9670;&nbsp;</a></span>stasis_caching_set_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_caching_set_filter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a>&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the message type filtering level on a cache. </p>
<p>This will cause the underlying subscription to filter messages according to the provided filter level. For example if selective is used then only messages matching those provided to <a class="el" href="../../d0/df4/stasis_8c.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a> will be raised to the subscription callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>The caching topic. </td></tr>
    <tr><td class="paramname">filter</td><td>What filter to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00109">109</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00231">stasis_cp_single_set_filter()</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, <a class="code" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="func__strings_8c_html_af2deb3c7b0d3bdd442bb9ada5fda3d17"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a></div><div class="ttdeci">static int filter(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00709">func_strings.c:709</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4290101180caea800a0461017a167120"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4290101180caea800a0461017a167120">&#9670;&nbsp;</a></span>stasis_caching_topic_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>* stasis_caching_topic_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>original_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d25/structstasis__cache.html">stasis_cache</a> *&#160;</td>
          <td class="paramname"><em>cache</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a topic which monitors and caches messages from another topic. </p>
<p>The idea is that some topics publish 'snapshots' of some other object's state that should be cached. When these snapshot messages are received, the cache is updated, and a <a class="el" href="../../de/dfa/structstasis__cache__update.html" title="Cache update message. ">stasis_cache_update()</a> message is forwarded, which has both the original snapshot message and the new message.</p>
<p>The returned object is AO2 managed, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when done with it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">original_topic</td><td>Topic publishing snapshot messages. </td></tr>
    <tr><td class="paramname">cache</td><td>Backend cache in which to keep snapshots. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New topic which changes snapshot messages to <a class="el" href="../../de/dfa/structstasis__cache__update.html" title="Cache update message. ">stasis_cache_update()</a> messages, and forwards all other messages from the original topic. </dd>
<dd>
<code>NULL</code> on error </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00948">948</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00958">ao2_container_register()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_caching_topic::cache</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">cache</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache::entries</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_caching_topic::original_topic</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00937">print_cache_entry()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00051">stasis_cache::registered</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00062">stasis_caching_topic_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_caching_topic::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00502">mwi_init()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00162">stasis_cp_sink_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;{</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *caching_topic;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;   <span class="keyword">static</span> <span class="keywordtype">int</span> caching_id;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <span class="keywordtype">char</span> *new_name;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;new_name, <span class="stringliteral">&quot;cache:%d/%s&quot;</span>, <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;caching_id, +1), <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(original_topic));</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="keywordflow">if</span> (ret &lt; 0) {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   caching_topic = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*caching_topic),</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <a class="code" href="../../d0/da9/stasis__cache_8c.html#a5a8fb198af71133995bf7a55be029eed">stasis_caching_topic_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   <span class="keywordflow">if</span> (caching_topic == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(new_name);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   }</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a> = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(new_name);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="keywordflow">if</span> (caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">topic</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, -1);</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(new_name);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cache, +1);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">cache</a> = <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <span class="keywordflow">if</span> (!cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a>) {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a>(new_name, cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a21e50c4d5c0fdf83ab6d1e7ed3facbb3">print_cache_entry</a>)) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Stasis cache container &#39;%p&#39; for &#39;%s&#39; did not register\n&quot;</span>,</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">entries</a>, new_name);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;         cache-&gt;<a class="code" href="../../dd/d25/structstasis__cache.html#a995fb73070b544ea93cbc8b4552a44b0">registered</a> = 1;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(new_name);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a> = <a class="code" href="../../de/d90/stasis__internal_8h.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a>(original_topic, <a class="code" href="../../d0/da9/stasis__cache_8c.html#a6bf91e29b6ef63f34910f4163e71fb93">caching_topic_exec</a>, caching_topic, 0, 0, __FILE__, __LINE__, __PRETTY_FUNCTION__);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   <span class="keywordflow">if</span> (caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, -1);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(original_topic, +1);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">original_topic</a> = <a class="code" href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">original_topic</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="comment">/* The subscription holds the reference, so no additional ref bump. */</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   <span class="keywordflow">return</span> caching_topic;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a6f8938d63002ad38415453cf70c27a14"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a6f8938d63002ad38415453cf70c27a14">stasis_caching_topic::cache</a></div><div class="ttdeci">struct stasis_cache * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00056">stasis_cache.c:56</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_ad00691c9d41a2baefe2a3bc108bb7ad3"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#ad00691c9d41a2baefe2a3bc108bb7ad3">stasis_caching_topic::original_topic</a></div><div class="ttdeci">struct stasis_topic * original_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00058">stasis_cache.c:58</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a6bf91e29b6ef63f34910f4163e71fb93"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a6bf91e29b6ef63f34910f4163e71fb93">caching_topic_exec</a></div><div class="ttdeci">static void caching_topic_exec(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00833">stasis_cache.c:833</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="stasis__internal_8h_html_ab7d9bff23ceccb19080696e3b48506aa"><div class="ttname"><a href="../../de/d90/stasis__internal_8h.html#ab7d9bff23ceccb19080696e3b48506aa">internal_stasis_subscribe</a></div><div class="ttdeci">struct stasis_subscription * internal_stasis_subscribe(struct stasis_topic *topic, stasis_subscription_cb callback, void *data, int needs_mailbox, int use_thread_pool, const char *file, int lineno, const char *func)</div><div class="ttdoc">Create a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00858">stasis.c:858</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structstasis__cache_html_a02ae6353379de71d2da8a3d5659cdc73"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a02ae6353379de71d2da8a3d5659cdc73">stasis_cache::entries</a></div><div class="ttdeci">struct ao2_container * entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00047">stasis_cache.c:47</a></div></div>
<div class="ttc" id="astobj2_8h_html_abdb952d2373503555d96f02f130c5770"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a></div><div class="ttdeci">int ao2_container_register(const char *name, struct ao2_container *self, ao2_prnt_obj_fn *prnt_obj)</div><div class="ttdoc">Register a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00958">astobj2_container.c:958</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__cache_html_a995fb73070b544ea93cbc8b4552a44b0"><div class="ttname"><a href="../../dd/d25/structstasis__cache.html#a995fb73070b544ea93cbc8b4552a44b0">stasis_cache::registered</a></div><div class="ttdeci">int registered</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00051">stasis_cache.c:51</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a136460a7868b48ef576c0fa505ef96db">stasis_caching_topic::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00057">stasis_cache.c:57</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_aefe318d32c8bb7a9e2025eb146d47781"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#aefe318d32c8bb7a9e2025eb146d47781">cache</a></div><div class="ttdeci">struct ao2_container * cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00077">pbx_realtime.c:77</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a5a8fb198af71133995bf7a55be029eed"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a5a8fb198af71133995bf7a55be029eed">stasis_caching_topic_dtor</a></div><div class="ttdeci">static void stasis_caching_topic_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00062">stasis_cache.c:62</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00055">stasis_cache.c:55</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_a21e50c4d5c0fdf83ab6d1e7ed3facbb3"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#a21e50c4d5c0fdf83ab6d1e7ed3facbb3">print_cache_entry</a></div><div class="ttdeci">static void print_cache_entry(void *v_obj, void *where, ao2_prnt_fn *prnt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00937">stasis_cache.c:937</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afdc3370e3a15daaa00179f2f72ab8c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdc3370e3a15daaa00179f2f72ab8c9d">&#9670;&nbsp;</a></span>stasis_caching_unsubscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>* stasis_caching_unsubscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribes a caching topic from its upstream topic. </p>
<p>This function returns immediately, so be sure to cleanup when <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a> is received.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>Caching topic to unsubscribe </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> for convenience </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00119">119</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01152">stasis_subscription_is_subscribed()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">stasis_unsubscribe()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00986">AST_TEST_DEFINE()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00146">stasis_caching_unsubscribe_and_join()</a>, and <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00189">stasis_cp_single_unsubscribe()</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">    * The subscription may hold the last reference to this caching</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">    * topic, but we want to make sure the unsubscribe finishes</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">    * before kicking of the caching topic&#39;s dtor.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, +1);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>)) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">       * Increment the reference to hold on to it past the</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">       * unsubscribe. Will be cleaned up in dtor.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>, +1);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;stasis_caching_topic unsubscribed multiple times\n&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="ttc" id="stasis_8h_html_acd5bedbb2212956dac77be47dceef510"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a></div><div class="ttdeci">int stasis_subscription_is_subscribed(const struct stasis_subscription *sub)</div><div class="ttdoc">Returns whether a subscription is currently subscribed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01152">stasis.c:1152</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stasis_8h_html_a3498301077e2005383f0d261c471388b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00973">stasis.c:973</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab211ac23afbd0560f08539021888db57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab211ac23afbd0560f08539021888db57">&#9670;&nbsp;</a></span>stasis_caching_unsubscribe_and_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a>* stasis_caching_unsubscribe_and_join </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/de2/structstasis__caching__topic.html">stasis_caching_topic</a> *&#160;</td>
          <td class="paramname"><em>caching_topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribes a caching topic from its upstream topic, blocking until all messages have been forwarded. </p>
<p>See stasis_unsubscriben_and_join() for more info on when to use this as opposed to <a class="el" href="../../dd/d79/stasis_8h.html#afdc3370e3a15daaa00179f2f72ab8c9d" title="Unsubscribes a caching topic from its upstream topic. ">stasis_caching_unsubscribe()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">caching_topic</td><td>Caching topic to unsubscribe </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> for convenience </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00146">146</a> of file <a class="el" href="../../d0/da9/stasis__cache_8c_source.html">stasis_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00119">stasis_caching_unsubscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01107">stasis_subscription_join()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_caching_topic::sub</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01710">AST_TEST_DEFINE()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00881">devstate_cleanup()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00491">mwi_cleanup()</a>, and <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00484">presence_state_engine_cleanup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keywordflow">if</span> (!caching_topic) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="comment">/* Hold a ref past the unsubscribe */</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caching_topic, +1);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <a class="code" href="../../d0/da9/stasis__cache_8c.html#afdc3370e3a15daaa00179f2f72ab8c9d">stasis_caching_unsubscribe</a>(caching_topic);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a68a963557189666f5d733bfb9a826e41">stasis_subscription_join</a>(caching_topic-&gt;<a class="code" href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">sub</a>);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(caching_topic);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__caching__topic_html_a03bb86c52b8e22ea4325ea04e6443fa0"><div class="ttname"><a href="../../d3/de2/structstasis__caching__topic.html#a03bb86c52b8e22ea4325ea04e6443fa0">stasis_caching_topic::sub</a></div><div class="ttdeci">struct stasis_subscription * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00059">stasis_cache.c:59</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8h_html_a68a963557189666f5d733bfb9a826e41"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a68a963557189666f5d733bfb9a826e41">stasis_subscription_join</a></div><div class="ttdeci">void stasis_subscription_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Block until the last message is processed on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01107">stasis.c:1107</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stasis__cache_8c_html_afdc3370e3a15daaa00179f2f72ab8c9d"><div class="ttname"><a href="../../d0/da9/stasis__cache_8c.html#afdc3370e3a15daaa00179f2f72ab8c9d">stasis_caching_unsubscribe</a></div><div class="ttdeci">struct stasis_caching_topic * stasis_caching_unsubscribe(struct stasis_caching_topic *caching_topic)</div><div class="ttdoc">Unsubscribes a caching topic from its upstream topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l00119">stasis_cache.c:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d90a883fee0f3ce89487a4e42f7806a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d90a883fee0f3ce89487a4e42f7806a">&#9670;&nbsp;</a></span>stasis_config_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_config_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2513a93567ddc93510f7896b777da119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2513a93567ddc93510f7896b777da119">&#9670;&nbsp;</a></span>stasis_forward_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d54/structstasis__forward.html">stasis_forward</a>* stasis_forward_all </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>from_topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>to_topic</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a subscription which forwards all messages from one topic to another. </p>
<p>Note that the <em>topic</em> parameter of the invoked callback will the be the <em>topic</em> the message was sent to, not the topic the subscriber subscribed to.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">from_topic</td><td>Topic to forward. </td></tr>
    <tr><td class="paramname">to_topic</td><td>Destination topic of forwarded messages. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New forwarding subscription. </dd>
<dd>
<code>NULL</code> on error. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01578">1578</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01538">forward_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01533">stasis_forward::from_topic</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01535">stasis_forward::to_topic</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01203">topic_add_subscription()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00426">topic_lock_both</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d10/manager_8c_source.html#l09144">__init_manager()</a>, <a class="el" href="../../db/d0b/resource__bridges_8c_source.html#l00407">ari_bridges_play_new()</a>, <a class="el" href="../../db/d0b/resource__bridges_8c_source.html#l00634">ast_ari_bridges_record()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01511">ast_channel_forward_endpoint()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01527">ast_channel_internal_setup_topics()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00613">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04314">create_subscriptions()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00214">endpoint_internal_create()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00164">forwards_create_bridge()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00136">forwards_create_channel()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00199">forwards_create_endpoint()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01177">load_general_config()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l11324">load_module()</a>, <a class="el" href="../../da/d10/manager__bridges_8c_source.html#l00681">manager_bridging_init()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01308">manager_channels_init()</a>, <a class="el" href="../../d4/d00/manager__mwi_8c_source.html#l00153">manager_mwi_init()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l09053">manager_subscriptions_init()</a>, <a class="el" href="../../dd/d65/manager__system_8c_source.html#l00043">manager_system_init()</a>, <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00065">stasis_cp_all_create()</a>, <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00139">stasis_cp_single_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01884">stasis_topic_pool_get_topic()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;{</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   <span class="keywordtype">size_t</span> idx;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *forward;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;   <span class="keywordflow">if</span> (!from_topic || !to_topic) {</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;   }</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;   forward = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*forward), <a class="code" href="../../d0/df4/stasis_8c.html#a38736c464d6ded1bd9c2570a59dca6b3">forward_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;   <span class="keywordflow">if</span> (!forward) {</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;   }</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;   <span class="comment">/* Forwards to ourselves are implicit. */</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   <span class="keywordflow">if</span> (to_topic == from_topic) {</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="keywordflow">return</span> forward;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;   }</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;   forward-&gt;<a class="code" href="../../d8/d54/structstasis__forward.html#a08704f04d89d378499fb30161d4772a3">from_topic</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(from_topic);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   forward-&gt;<a class="code" href="../../d8/d54/structstasis__forward.html#a1cdfe3ae76a2e8b2b1c8083120f26100">to_topic</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(to_topic);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#ae11ee3d32be3f0cc558f1ef40cd9a45b">topic_lock_both</a>(to_topic, from_topic);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;   res = <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;to_topic-&gt;upstream_topics, from_topic);</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;   <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(from_topic);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(to_topic);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(forward, -1);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;   }</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;to_topic-&gt;subscribers); ++idx) {</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#a79e3a46cca0390255f951e98052a6508">topic_add_subscription</a>(from_topic, <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;to_topic-&gt;subscribers, idx));</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;   }</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(from_topic);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(to_topic);</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;   <span class="keywordflow">return</span> forward;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="stasis_8c_html_a38736c464d6ded1bd9c2570a59dca6b3"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a38736c464d6ded1bd9c2570a59dca6b3">forward_dtor</a></div><div class="ttdeci">static void forward_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01538">stasis.c:1538</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8c_html_ae11ee3d32be3f0cc558f1ef40cd9a45b"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ae11ee3d32be3f0cc558f1ef40cd9a45b">topic_lock_both</a></div><div class="ttdeci">#define topic_lock_both(topic1, topic2)</div><div class="ttdoc">Lock two topics. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00426">stasis.c:426</a></div></div>
<div class="ttc" id="structstasis__forward_html_a08704f04d89d378499fb30161d4772a3"><div class="ttname"><a href="../../d8/d54/structstasis__forward.html#a08704f04d89d378499fb30161d4772a3">stasis_forward::from_topic</a></div><div class="ttdeci">struct stasis_topic * from_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01533">stasis.c:1533</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__forward_html_a1cdfe3ae76a2e8b2b1c8083120f26100"><div class="ttname"><a href="../../d8/d54/structstasis__forward.html#a1cdfe3ae76a2e8b2b1c8083120f26100">stasis_forward::to_topic</a></div><div class="ttdeci">struct stasis_topic * to_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01535">stasis.c:1535</a></div></div>
<div class="ttc" id="stasis_8c_html_a79e3a46cca0390255f951e98052a6508"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a79e3a46cca0390255f951e98052a6508">topic_add_subscription</a></div><div class="ttdeci">static int topic_add_subscription(struct stasis_topic *topic, struct stasis_subscription *sub)</div><div class="ttdoc">Add a subscriber to a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01203">stasis.c:1203</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structstasis__forward_html"><div class="ttname"><a href="../../d8/d54/structstasis__forward.html">stasis_forward</a></div><div class="ttdoc">Forwarding information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01531">stasis.c:1531</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5713715b0f26f4943d0af05363b07027"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5713715b0f26f4943d0af05363b07027">&#9670;&nbsp;</a></span>stasis_forward_cancel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d8/d54/structstasis__forward.html">stasis_forward</a>* stasis_forward_cancel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *&#160;</td>
          <td class="paramname"><em>forward</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01548">1548</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00573">AST_VECTOR_ELEM_CLEANUP_NOOP</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00585">AST_VECTOR_REMOVE_ELEM_UNORDERED</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01533">stasis_forward::from_topic</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01535">stasis_forward::to_topic</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00426">topic_lock_both</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01231">topic_remove_subscription()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00051">all_dtor()</a>, <a class="el" href="../../db/d0b/resource__bridges_8c_source.html#l00407">ari_bridges_play_new()</a>, <a class="el" href="../../db/d0b/resource__bridges_8c_source.html#l00634">ast_ari_bridges_record()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01471">ast_channel_internal_cleanup()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00350">ast_endpoint_shutdown()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00613">AST_TEST_DEFINE()</a>, <a class="el" href="../../db/d0b/resource__bridges_8c_source.html#l00288">bridge_channel_control_thread()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01249">cleanup_module()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04304">destroy_subscriptions()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00108">forwards_unsubscribe()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01177">load_general_config()</a>, <a class="el" href="../../df/d1d/res__manager__devicestate_8c_source.html#l00123">load_module()</a>, <a class="el" href="../../da/d10/manager__bridges_8c_source.html#l00670">manager_bridging_cleanup()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01302">manager_channels_shutdown()</a>, <a class="el" href="../../d4/d00/manager__mwi_8c_source.html#l00147">manager_mwi_shutdown()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l08956">manager_shutdown()</a>, <a class="el" href="../../dd/d65/manager__system_8c_source.html#l00037">manager_system_shutdown()</a>, <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00189">stasis_cp_single_unsubscribe()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00121">state_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01715">topic_pool_entry_dtor()</a>, and <a class="el" href="../../da/dfb/app__queue_8c_source.html#l11250">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;{</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *from;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *to;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;   <span class="keywordflow">if</span> (!forward) {</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;   }</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;   from = forward-&gt;<a class="code" href="../../d8/d54/structstasis__forward.html#a08704f04d89d378499fb30161d4772a3">from_topic</a>;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;   to = forward-&gt;<a class="code" href="../../d8/d54/structstasis__forward.html#a1cdfe3ae76a2e8b2b1c8083120f26100">to_topic</a>;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;   <span class="keywordflow">if</span> (from &amp;&amp; to) {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#ae11ee3d32be3f0cc558f1ef40cd9a45b">topic_lock_both</a>(to, from);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a79df3872d03069f077e7cab2262b8550">AST_VECTOR_REMOVE_ELEM_UNORDERED</a>(&amp;to-&gt;upstream_topics, from,</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a>);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;to-&gt;subscribers); ++idx) {</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;         <a class="code" href="../../d0/df4/stasis_8c.html#aedcfe63e48121eabbf8ec304cee1d7bd">topic_remove_subscription</a>(from, <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;to-&gt;subscribers, idx));</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;      }</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(from);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(to);</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;   }</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(forward);</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;}</div><div class="ttc" id="stasis_8c_html_aedcfe63e48121eabbf8ec304cee1d7bd"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#aedcfe63e48121eabbf8ec304cee1d7bd">topic_remove_subscription</a></div><div class="ttdeci">static int topic_remove_subscription(struct stasis_topic *topic, struct stasis_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01231">stasis.c:1231</a></div></div>
<div class="ttc" id="vector_8h_html_a79df3872d03069f077e7cab2262b8550"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a79df3872d03069f077e7cab2262b8550">AST_VECTOR_REMOVE_ELEM_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_ELEM_UNORDERED(vec, elem, cleanup)</div><div class="ttdoc">Remove an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00585">vector.h:585</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8c_html_ae11ee3d32be3f0cc558f1ef40cd9a45b"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ae11ee3d32be3f0cc558f1ef40cd9a45b">topic_lock_both</a></div><div class="ttdeci">#define topic_lock_both(topic1, topic2)</div><div class="ttdoc">Lock two topics. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00426">stasis.c:426</a></div></div>
<div class="ttc" id="structstasis__forward_html_a08704f04d89d378499fb30161d4772a3"><div class="ttname"><a href="../../d8/d54/structstasis__forward.html#a08704f04d89d378499fb30161d4772a3">stasis_forward::from_topic</a></div><div class="ttdeci">struct stasis_topic * from_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01533">stasis.c:1533</a></div></div>
<div class="ttc" id="vector_8h_html_a1885c25b9d767a53d1df9b641f53951a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a></div><div class="ttdeci">#define AST_VECTOR_ELEM_CLEANUP_NOOP(elem)</div><div class="ttdoc">Vector element cleanup that does nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00573">vector.h:573</a></div></div>
<div class="ttc" id="structstasis__forward_html_a1cdfe3ae76a2e8b2b1c8083120f26100"><div class="ttname"><a href="../../d8/d54/structstasis__forward.html#a1cdfe3ae76a2e8b2b1c8083120f26100">stasis_forward::to_topic</a></div><div class="ttdeci">struct stasis_topic * to_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01535">stasis.c:1535</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e674e1a85d014776968a99025bf7bce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e674e1a85d014776968a99025bf7bce">&#9670;&nbsp;</a></span>stasis_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the Stasis subsystem. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
Non-zero on error. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l03061">3061</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/dfe/config__options_8h_source.html#l00064">ACO_EXACT</a>, <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00877">aco_info_init()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00623">aco_option_register</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00638">aco_option_register_custom</a>, <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00652">aco_process_config()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00527">ACO_PROCESS_ERROR</a>, <a class="el" href="../../d6/dc8/config__options_8c_source.html#l00924">aco_set_defaults()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00925">ao2_global_obj_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00908">ao2_global_obj_replace_unref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../dc/db0/cli_8h_source.html#l00265">ast_cli_register_multiple</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga903c0022d53e0cac08b7eab6539ab206">ast_multi_user_event_type()</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00019">ast_register_cleanup()</a>, <a class="el" href="../../d1/dc7/threadpool_8c_source.html#l00915">ast_threadpool_create()</a>, <a class="el" href="../../d3/d40/threadpool_8h_source.html#l00071">AST_THREADPOOL_OPTIONS_VERSION</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d3/d40/threadpool_8h_source.html#l00090">ast_threadpool_options::auto_increment</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02304">declined_handler()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02199">stasis_config::declined_message_types</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00816">FLDSET</a>, <a class="el" href="../../d3/d4e/chan__console_8c.html#aa36e3e2c486b920b166c2d17c5242221">globals</a>, <a class="el" href="../../d3/d40/threadpool_8h_source.html#l00079">ast_threadpool_options::idle_timeout</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02190">stasis_threadpool_conf::idle_timeout_sec</a>, <a class="el" href="../../d3/d40/threadpool_8h_source.html#l00100">ast_threadpool_options::initial_size</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02188">stasis_threadpool_conf::initial_size</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d3/d40/threadpool_8h_source.html#l00110">ast_threadpool_options::max_size</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02192">stasis_threadpool_conf::max_size</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00392">OPT_INT_T</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01125">PARSE_IN_RANGE</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l01008">stasis_cache_init()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l03042">stasis_cleanup()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02253">stasis_config_alloc()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l01501">STASIS_MESSAGE_TYPE_INIT</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00328">SUBSCRIPTION_STATISTICS_BUCKETS</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02945">subscription_statistics_cmp()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02924">subscription_statistics_hash()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02197">stasis_config::threadpool_options</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00318">TOPIC_ALL_BUCKETS</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00325">TOPIC_STATISTICS_BUCKETS</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l03003">topic_statistics_cmp()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02982">topic_statistics_hash()</a>, and <a class="el" href="../../d3/d40/threadpool_8h_source.html#l00073">ast_threadpool_options::version</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d03/asterisk_8c_source.html#l03947">asterisk_daemon()</a>.</p>
<div class="fragment"><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;{</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d0e/structstasis__config.html">stasis_config</a> *cfg;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;   <span class="keywordtype">int</span> cache_init;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/de6/structast__threadpool__options.html">ast_threadpool_options</a> threadpool_opts = { 0, };</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="preprocessor">#ifdef AST_DEVMODE</span></div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *subscription_stats;</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *topic_stats;</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;   <span class="comment">/* Be sure the types are cleaned up after the message bus */</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d0/df4/stasis_8c.html#a59a4b47914bab8d430d86766504c52dc">stasis_cleanup</a>);</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#a3f40a7cffea07c21a21faaee64d24398">aco_info_init</a>(&amp;cfg_info)) {</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;   }</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a83b8d55eb1ba88ac7291f77a3ebfce45">aco_option_register_custom</a>(&amp;cfg_info, <span class="stringliteral">&quot;decline&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>,</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#ada04be29882062127408e67ba605ca60">declined_options</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../d0/df4/stasis_8c.html#ad2be5dfe3f2bdc69bb3f0b9d92078bb4">declined_handler</a>, 0);</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;initial_size&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>,</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#aac523295c428ee99baad3a6a7ef1cfbe">threadpool_options</a>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ade42e2c356f57749868689960d0fd542">OPT_INT_T</a>, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585">PARSE_IN_RANGE</a>,</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d30/structstasis__threadpool__conf.html">stasis_threadpool_conf</a>, initial_size), 0,</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;      INT_MAX);</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;idle_timeout_sec&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>,</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#aac523295c428ee99baad3a6a7ef1cfbe">threadpool_options</a>, <span class="stringliteral">&quot;20&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ade42e2c356f57749868689960d0fd542">OPT_INT_T</a>, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585">PARSE_IN_RANGE</a>,</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d30/structstasis__threadpool__conf.html">stasis_threadpool_conf</a>, idle_timeout_sec), 0,</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;      INT_MAX);</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;   <a class="code" href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a>(&amp;cfg_info, <span class="stringliteral">&quot;max_size&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a>,</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#aac523295c428ee99baad3a6a7ef1cfbe">threadpool_options</a>, <span class="stringliteral">&quot;50&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ade42e2c356f57749868689960d0fd542">OPT_INT_T</a>, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585">PARSE_IN_RANGE</a>,</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;      <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d30/structstasis__threadpool__conf.html">stasis_threadpool_conf</a>, max_size), 0,</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;      INT_MAX);</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a>(&amp;cfg_info, 0) == <a class="code" href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a>) {</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d0e/structstasis__config.html">stasis_config</a> *default_cfg = <a class="code" href="../../d0/df4/stasis_8c.html#a513440e1209c1c0e7982ed5112d754f4">stasis_config_alloc</a>();</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      <span class="keywordflow">if</span> (!default_cfg) {</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      }</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#a206bf60e38d1114efdeeabc35b7eaa69">aco_set_defaults</a>(&amp;<a class="code" href="../../d0/df4/stasis_8c.html#a75dbfda070501bd401698bdf6813e571">threadpool_option</a>, <span class="stringliteral">&quot;threadpool&quot;</span>, default_cfg-&gt;<a class="code" href="../../d2/d0e/structstasis__config.html#a9b9399e0648d49583081463ba55ce257">threadpool_options</a>)) {</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to initialize defaults on Stasis configuration object\n&quot;</span>);</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(default_cfg, -1);</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      }</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../db/dfe/config__options_8h.html#a206bf60e38d1114efdeeabc35b7eaa69">aco_set_defaults</a>(&amp;<a class="code" href="../../d0/df4/stasis_8c.html#afe12a283dc4ec49a7557650cbc4e8ec9">declined_option</a>, <span class="stringliteral">&quot;declined_message_types&quot;</span>, default_cfg-&gt;<a class="code" href="../../d2/d0e/structstasis__config.html#a6f30927c99c8edf4d9c895bf3ab7baca">declined_message_types</a>)) {</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to load stasis.conf and failed to initialize defaults.\n&quot;</span>);</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(default_cfg, -1);</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      }</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Could not load Stasis configuration; using defaults\n&quot;</span>);</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a>(<a class="code" href="../../d3/d4e/chan__console_8c.html#aa36e3e2c486b920b166c2d17c5242221">globals</a>, default_cfg);</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      cfg = default_cfg;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      cfg = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d3/d4e/chan__console_8c.html#aa36e3e2c486b920b166c2d17c5242221">globals</a>);</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      <span class="keywordflow">if</span> (!cfg) {</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to obtain Stasis configuration object\n&quot;</span>);</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      }</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;   }</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;   threadpool_opts.<a class="code" href="../../de/de6/structast__threadpool__options.html#aad880fc4455c253781e8968f2239d56f">version</a> = <a class="code" href="../../d3/d40/threadpool_8h.html#ae95119c74a92ef5c17f55421b278a25c">AST_THREADPOOL_OPTIONS_VERSION</a>;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;   threadpool_opts.<a class="code" href="../../de/de6/structast__threadpool__options.html#af688239509aef8d133559c6b15c96395">initial_size</a> = cfg-&gt;<a class="code" href="../../d2/d0e/structstasis__config.html#a9b9399e0648d49583081463ba55ce257">threadpool_options</a>-&gt;<a class="code" href="../../df/d30/structstasis__threadpool__conf.html#af688239509aef8d133559c6b15c96395">initial_size</a>;</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;   threadpool_opts.<a class="code" href="../../de/de6/structast__threadpool__options.html#ae44aa7ff10e622be697711e67c13be3b">auto_increment</a> = 1;</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;   threadpool_opts.<a class="code" href="../../de/de6/structast__threadpool__options.html#a98ca8117bc73d9d7520727c4ce8772e6">max_size</a> = cfg-&gt;<a class="code" href="../../d2/d0e/structstasis__config.html#a9b9399e0648d49583081463ba55ce257">threadpool_options</a>-&gt;<a class="code" href="../../df/d30/structstasis__threadpool__conf.html#a98ca8117bc73d9d7520727c4ce8772e6">max_size</a>;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;   threadpool_opts.<a class="code" href="../../de/de6/structast__threadpool__options.html#a55f8da70e65091a4533dae72885d0227">idle_timeout</a> = cfg-&gt;<a class="code" href="../../d2/d0e/structstasis__config.html#a9b9399e0648d49583081463ba55ce257">threadpool_options</a>-&gt;<a class="code" href="../../df/d30/structstasis__threadpool__conf.html#a645e9643f8d1fb189cc95263ebe2df05">idle_timeout_sec</a>;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#a6dc11fc8f94173cc1af379b74a096abd">threadpool</a> = <a class="code" href="../../d3/d40/threadpool_8h.html#abf6fc4af30779217d37047cbb1fddd1a">ast_threadpool_create</a>(<span class="stringliteral">&quot;stasis&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;threadpool_opts);</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg, -1);</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/df4/stasis_8c.html#a6dc11fc8f94173cc1af379b74a096abd">threadpool</a>) {</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create &#39;stasis-core&#39; threadpool\n&quot;</span>);</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;   }</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;   cache_init = <a class="code" href="../../dd/d79/stasis_8h.html#a81215cb37a9287389855d0529332b1b7">stasis_cache_init</a>();</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;   <span class="keywordflow">if</span> (cache_init != 0) {</div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;   }</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>) != 0) {</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;   }</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga903c0022d53e0cac08b7eab6539ab206">ast_multi_user_event_type</a>) != 0) {</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   }</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#ae14b5f72d5278c2e22621748fba0610b">topic_all</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../d0/df4/stasis_8c.html#af25c73f0280eb52884585e91c8d18d70">TOPIC_ALL_BUCKETS</a>,</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;         topic_proxy_hash_fn, 0, topic_proxy_cmp_fn);</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/df4/stasis_8c.html#ae14b5f72d5278c2e22621748fba0610b">topic_all</a>) {</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;   }</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(<a class="code" href="../../d0/df4/stasis_8c.html#a12e07f14a24059d6ca7ad80c23473729">cli_stasis</a>, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/df4/stasis_8c.html#a12e07f14a24059d6ca7ad80c23473729">cli_stasis</a>))) {</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;   }</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="preprocessor">#ifdef AST_DEVMODE</span></div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   <span class="comment">/* Statistics information is stored separately so that we don&#39;t alter or interrupt the lifetime of the underlying</span></div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="comment">    * topic or subscripton.</span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;   subscription_stats = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../d0/df4/stasis_8c.html#a92f09fdb7bda5eeca4fa0e1b4c9046c0">SUBSCRIPTION_STATISTICS_BUCKETS</a>,</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#a65f74acd52a27788bee2b0aa2a417b7c">subscription_statistics_hash</a>, 0, <a class="code" href="../../d0/df4/stasis_8c.html#aff7f67df7e0d35e466ad20d9f8c534da">subscription_statistics_cmp</a>);</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   <span class="keywordflow">if</span> (!subscription_stats) {</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;   }</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a>(subscription_statistics, subscription_stats);</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(subscription_stats);</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   topic_stats = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../d0/df4/stasis_8c.html#a348a7ad6b881b6b0b401da2d8546ccc4">TOPIC_STATISTICS_BUCKETS</a>,</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#aca08aa236124705a035a6fe95371c6ca">topic_statistics_hash</a>, 0, <a class="code" href="../../d0/df4/stasis_8c.html#a1bfbdd05a5b4d1c42475d1a89d4a0bea">topic_statistics_cmp</a>);</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;   <span class="keywordflow">if</span> (!topic_stats) {</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;   }</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a>(topic_statistics, topic_stats);</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(topic_stats);</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;   <span class="keywordflow">if</span> (!topic_stats) {</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   }</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;message_type_statistics, 0);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(<a class="code" href="../../d0/df4/stasis_8c.html#a9ee1e67ae2faf5be87758cc11248e2f9">cli_stasis_statistics</a>, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d0/df4/stasis_8c.html#a9ee1e67ae2faf5be87758cc11248e2f9">cli_stasis_statistics</a>))) {</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;   }</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;}</div><div class="ttc" id="stasis_8c_html_a75dbfda070501bd401698bdf6813e571"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a75dbfda070501bd401698bdf6813e571">threadpool_option</a></div><div class="ttdeci">static struct aco_type threadpool_option</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02202">stasis.c:2202</a></div></div>
<div class="ttc" id="structast__threadpool__options_html_ae44aa7ff10e622be697711e67c13be3b"><div class="ttname"><a href="../../de/de6/structast__threadpool__options.html#ae44aa7ff10e622be697711e67c13be3b">ast_threadpool_options::auto_increment</a></div><div class="ttdeci">int auto_increment</div><div class="ttdoc">Number of threads to increment pool by. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/threadpool_8h_source.html#l00090">threadpool.h:90</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structast__threadpool__options_html_a55f8da70e65091a4533dae72885d0227"><div class="ttname"><a href="../../de/de6/structast__threadpool__options.html#a55f8da70e65091a4533dae72885d0227">ast_threadpool_options::idle_timeout</a></div><div class="ttdeci">int idle_timeout</div><div class="ttdoc">Time limit in seconds for idle threads. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/threadpool_8h_source.html#l00079">threadpool.h:79</a></div></div>
<div class="ttc" id="config__options_8h_html_a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a1b87da445ce6937e5cfbdaed1288a572abba7035409cf0b61400c00ef5bb59b52">ACO_EXACT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00064">config_options.h:64</a></div></div>
<div class="ttc" id="config__options_8h_html_a83b8d55eb1ba88ac7291f77a3ebfce45"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a83b8d55eb1ba88ac7291f77a3ebfce45">aco_option_register_custom</a></div><div class="ttdeci">#define aco_option_register_custom(info, name, matchtype, types, default_val, handler, flags)</div><div class="ttdoc">Register a config option. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00638">config_options.h:638</a></div></div>
<div class="ttc" id="structast__threadpool__options_html_af688239509aef8d133559c6b15c96395"><div class="ttname"><a href="../../de/de6/structast__threadpool__options.html#af688239509aef8d133559c6b15c96395">ast_threadpool_options::initial_size</a></div><div class="ttdeci">int initial_size</div><div class="ttdoc">Number of threads the pool will start with. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/threadpool_8h_source.html#l00100">threadpool.h:100</a></div></div>
<div class="ttc" id="stasis_8c_html_a59a4b47914bab8d430d86766504c52dc"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a59a4b47914bab8d430d86766504c52dc">stasis_cleanup</a></div><div class="ttdeci">static void stasis_cleanup(void)</div><div class="ttdoc">Cleanup function for graceful shutdowns. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l03042">stasis.c:3042</a></div></div>
<div class="ttc" id="structast__threadpool__options_html_a98ca8117bc73d9d7520727c4ce8772e6"><div class="ttname"><a href="../../de/de6/structast__threadpool__options.html#a98ca8117bc73d9d7520727c4ce8772e6">ast_threadpool_options::max_size</a></div><div class="ttdeci">int max_size</div><div class="ttdoc">Maximum number of threads a pool may have. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/threadpool_8h_source.html#l00110">threadpool.h:110</a></div></div>
<div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="structast__threadpool__options_html"><div class="ttname"><a href="../../de/de6/structast__threadpool__options.html">ast_threadpool_options</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/threadpool_8h_source.html#l00070">threadpool.h:70</a></div></div>
<div class="ttc" id="threadpool_8h_html_ae95119c74a92ef5c17f55421b278a25c"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#ae95119c74a92ef5c17f55421b278a25c">AST_THREADPOOL_OPTIONS_VERSION</a></div><div class="ttdeci">#define AST_THREADPOOL_OPTIONS_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/threadpool_8h_source.html#l00071">threadpool.h:71</a></div></div>
<div class="ttc" id="stasis_8c_html_a9ee1e67ae2faf5be87758cc11248e2f9"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a9ee1e67ae2faf5be87758cc11248e2f9">cli_stasis_statistics</a></div><div class="ttdeci">static struct ast_cli_entry cli_stasis_statistics[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02916">stasis.c:2916</a></div></div>
<div class="ttc" id="config__options_8h_html_a60d17d3e9451ddcb5aa861339c757bed"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a60d17d3e9451ddcb5aa861339c757bed">aco_option_register</a></div><div class="ttdeci">#define aco_option_register(info, name, matchtype, types, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a config option. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00623">config_options.h:623</a></div></div>
<div class="ttc" id="structstasis__threadpool__conf_html"><div class="ttname"><a href="../../df/d30/structstasis__threadpool__conf.html">stasis_threadpool_conf</a></div><div class="ttdoc">Threadpool configuration options. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02186">stasis.c:2186</a></div></div>
<div class="ttc" id="structstasis__threadpool__conf_html_a98ca8117bc73d9d7520727c4ce8772e6"><div class="ttname"><a href="../../df/d30/structstasis__threadpool__conf.html#a98ca8117bc73d9d7520727c4ce8772e6">stasis_threadpool_conf::max_size</a></div><div class="ttdeci">int max_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02192">stasis.c:2192</a></div></div>
<div class="ttc" id="stasis_8c_html_ada04be29882062127408e67ba605ca60"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ada04be29882062127408e67ba605ca60">declined_options</a></div><div class="ttdeci">struct aco_type * declined_options[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02221">stasis.c:2221</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="config__options_8h_html_af28935f8c2547723d5922ebed1c71898"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#af28935f8c2547723d5922ebed1c71898">aco_process_config</a></div><div class="ttdeci">enum aco_process_status aco_process_config(struct aco_info *info, int reload)</div><div class="ttdoc">Process a config info via the options registered with an aco_info. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00652">config_options.c:652</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structstasis__config_html_a6f30927c99c8edf4d9c895bf3ab7baca"><div class="ttname"><a href="../../d2/d0e/structstasis__config.html#a6f30927c99c8edf4d9c895bf3ab7baca">stasis_config::declined_message_types</a></div><div class="ttdeci">struct stasis_declined_config * declined_message_types</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02199">stasis.c:2199</a></div></div>
<div class="ttc" id="structstasis__threadpool__conf_html_af688239509aef8d133559c6b15c96395"><div class="ttname"><a href="../../df/d30/structstasis__threadpool__conf.html#af688239509aef8d133559c6b15c96395">stasis_threadpool_conf::initial_size</a></div><div class="ttdeci">int initial_size</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02188">stasis.c:2188</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="config__options_8h_html_a3f40a7cffea07c21a21faaee64d24398"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3f40a7cffea07c21a21faaee64d24398">aco_info_init</a></div><div class="ttdeci">int aco_info_init(struct aco_info *info)</div><div class="ttdoc">Initialize an aco_info structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00877">config_options.c:877</a></div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="stasis_8c_html_a65f74acd52a27788bee2b0aa2a417b7c"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a65f74acd52a27788bee2b0aa2a417b7c">subscription_statistics_hash</a></div><div class="ttdeci">static int subscription_statistics_hash(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02924">stasis.c:2924</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8c_html_aca08aa236124705a035a6fe95371c6ca"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#aca08aa236124705a035a6fe95371c6ca">topic_statistics_hash</a></div><div class="ttdeci">static int topic_statistics_hash(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02982">stasis.c:2982</a></div></div>
<div class="ttc" id="chan__console_8c_html_aa36e3e2c486b920b166c2d17c5242221"><div class="ttname"><a href="../../d3/d4e/chan__console_8c.html#aa36e3e2c486b920b166c2d17c5242221">globals</a></div><div class="ttdeci">static struct console_pvt globals</div></div>
<div class="ttc" id="structstasis__threadpool__conf_html_a645e9643f8d1fb189cc95263ebe2df05"><div class="ttname"><a href="../../df/d30/structstasis__threadpool__conf.html#a645e9643f8d1fb189cc95263ebe2df05">stasis_threadpool_conf::idle_timeout_sec</a></div><div class="ttdeci">int idle_timeout_sec</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02190">stasis.c:2190</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="structstasis__config_html"><div class="ttname"><a href="../../d2/d0e/structstasis__config.html">stasis_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02195">stasis.c:2195</a></div></div>
<div class="ttc" id="config__options_8h_html_a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3b4f259d48ef20f47171b73078282d75a832b5997265d8870481f9684cbca5792">ACO_PROCESS_ERROR</a></div><div class="ttdoc">Their was an error and no changes were applied. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00527">config_options.h:527</a></div></div>
<div class="ttc" id="stasis_8c_html_a92f09fdb7bda5eeca4fa0e1b4c9046c0"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a92f09fdb7bda5eeca4fa0e1b4c9046c0">SUBSCRIPTION_STATISTICS_BUCKETS</a></div><div class="ttdeci">#define SUBSCRIPTION_STATISTICS_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00328">stasis.c:328</a></div></div>
<div class="ttc" id="stasis_8c_html_a12e07f14a24059d6ca7ad80c23473729"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a12e07f14a24059d6ca7ad80c23473729">cli_stasis</a></div><div class="ttdeci">static struct ast_cli_entry cli_stasis[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02476">stasis.c:2476</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="stasis_8c_html_a513440e1209c1c0e7982ed5112d754f4"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a513440e1209c1c0e7982ed5112d754f4">stasis_config_alloc</a></div><div class="ttdeci">static void * stasis_config_alloc(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02253">stasis.c:2253</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585">PARSE_IN_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01125">include/asterisk/config.h:1125</a></div></div>
<div class="ttc" id="stasis_8c_html_aff7f67df7e0d35e466ad20d9f8c534da"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#aff7f67df7e0d35e466ad20d9f8c534da">subscription_statistics_cmp</a></div><div class="ttdeci">static int subscription_statistics_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02945">stasis.c:2945</a></div></div>
<div class="ttc" id="stasis_8c_html_ae14b5f72d5278c2e22621748fba0610b"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ae14b5f72d5278c2e22621748fba0610b">topic_all</a></div><div class="ttdeci">struct ao2_container * topic_all</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00396">stasis.c:396</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="structast__threadpool__options_html_aad880fc4455c253781e8968f2239d56f"><div class="ttname"><a href="../../de/de6/structast__threadpool__options.html#aad880fc4455c253781e8968f2239d56f">ast_threadpool_options::version</a></div><div class="ttdeci">int version</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d40/threadpool_8h_source.html#l00073">threadpool.h:73</a></div></div>
<div class="ttc" id="threadpool_8h_html_abf6fc4af30779217d37047cbb1fddd1a"><div class="ttname"><a href="../../d3/d40/threadpool_8h.html#abf6fc4af30779217d37047cbb1fddd1a">ast_threadpool_create</a></div><div class="ttdeci">struct ast_threadpool * ast_threadpool_create(const char *name, struct ast_threadpool_listener *listener, const struct ast_threadpool_options *options)</div><div class="ttdoc">Create a new threadpool. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc7/threadpool_8c_source.html#l00915">threadpool.c:915</a></div></div>
<div class="ttc" id="config__options_8h_html_a206bf60e38d1114efdeeabc35b7eaa69"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a206bf60e38d1114efdeeabc35b7eaa69">aco_set_defaults</a></div><div class="ttdeci">int aco_set_defaults(struct aco_type *type, const char *category, void *obj)</div><div class="ttdoc">Set all default options of obj. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dc8/config__options_8c_source.html#l00924">config_options.c:924</a></div></div>
<div class="ttc" id="stasis_8c_html_afe12a283dc4ec49a7557650cbc4e8ec9"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#afe12a283dc4ec49a7557650cbc4e8ec9">declined_option</a></div><div class="ttdeci">static struct aco_type declined_option</div><div class="ttdoc">An aco_type structure to link the &quot;declined_message_types&quot; category to the stasis_declined_config typ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02213">stasis.c:2213</a></div></div>
<div class="ttc" id="stasis_8h_html_a81215cb37a9287389855d0529332b1b7"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a81215cb37a9287389855d0529332b1b7">stasis_cache_init</a></div><div class="ttdeci">int stasis_cache_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da9/stasis__cache_8c_source.html#l01008">stasis_cache.c:1008</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga903c0022d53e0cac08b7eab6539ab206"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga903c0022d53e0cac08b7eab6539ab206">ast_multi_user_event_type</a></div><div class="ttdeci">struct stasis_message_type * ast_multi_user_event_type(void)</div><div class="ttdoc">Message type for custom user defined events with multi object blobs. </div></div>
<div class="ttc" id="stasis_8c_html_a348a7ad6b881b6b0b401da2d8546ccc4"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a348a7ad6b881b6b0b401da2d8546ccc4">TOPIC_STATISTICS_BUCKETS</a></div><div class="ttdeci">#define TOPIC_STATISTICS_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00325">stasis.c:325</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3a11e1a1d3e99bed3ea0a7c57a3880d7"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a></div><div class="ttdeci">#define ao2_global_obj_replace_unref(holder, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00908">astobj2.h:908</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__config_html_a9b9399e0648d49583081463ba55ce257"><div class="ttname"><a href="../../d2/d0e/structstasis__config.html#a9b9399e0648d49583081463ba55ce257">stasis_config::threadpool_options</a></div><div class="ttdeci">struct stasis_threadpool_conf * threadpool_options</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02197">stasis.c:2197</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="stasis_8c_html_aac523295c428ee99baad3a6a7ef1cfbe"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#aac523295c428ee99baad3a6a7ef1cfbe">threadpool_options</a></div><div class="ttdeci">static struct aco_type * threadpool_options[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02210">stasis.c:2210</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144ade42e2c356f57749868689960d0fd542"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144ade42e2c356f57749868689960d0fd542">OPT_INT_T</a></div><div class="ttdoc">Type for default option handler for signed integers. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00392">config_options.h:392</a></div></div>
<div class="ttc" id="stasis_8c_html_a6dc11fc8f94173cc1af379b74a096abd"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a6dc11fc8f94173cc1af379b74a096abd">threadpool</a></div><div class="ttdeci">static struct ast_threadpool * threadpool</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00308">stasis.c:308</a></div></div>
<div class="ttc" id="stasis_8c_html_a1bfbdd05a5b4d1c42475d1a89d4a0bea"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a1bfbdd05a5b4d1c42475d1a89d4a0bea">topic_statistics_cmp</a></div><div class="ttdeci">static int topic_statistics_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l03003">stasis.c:3003</a></div></div>
<div class="ttc" id="stasis_8c_html_ad2be5dfe3f2bdc69bb3f0b9d92078bb4"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ad2be5dfe3f2bdc69bb3f0b9d92078bb4">declined_handler</a></div><div class="ttdeci">static int declined_handler(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02304">stasis.c:2304</a></div></div>
<div class="ttc" id="stasis_8c_html_af25c73f0280eb52884585e91c8d18d70"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#af25c73f0280eb52884585e91c8d18d70">TOPIC_ALL_BUCKETS</a></div><div class="ttdeci">#define TOPIC_ALL_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00318">stasis.c:318</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72385bdbbdd39eda3680da22820da7a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72385bdbbdd39eda3680da22820da7a5">&#9670;&nbsp;</a></span>stasis_log_bad_type_access()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_log_bad_type_access </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01940">1940</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l02283">stasis_message_type_declined()</a>.</p>
<div class="fragment"><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;{</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="preprocessor">#ifdef AST_DEVMODE</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/df4/stasis_8c.html#a6c2e98dd27243b0fe07717c54c40d0b1">stasis_message_type_declined</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Use of %s() before init/after destruction\n&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;   }</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;}</div><div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="stasis_8c_html_a6c2e98dd27243b0fe07717c54c40d0b1"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a6c2e98dd27243b0fe07717c54c40d0b1">stasis_message_type_declined</a></div><div class="ttdeci">int stasis_message_type_declined(const char *name)</div><div class="ttdoc">Check whether a message type is declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02283">stasis.c:2283</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff3b891ecf151757d9977e167c9a3b07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff3b891ecf151757d9977e167c9a3b07">&#9670;&nbsp;</a></span>stasis_message_can_be_ami()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_can_be_ami </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if the given message can be converted to AMI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message to see if can be converted to AMI.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Cannot be converted </td></tr>
    <tr><td class="paramname">non-zero</td><td>Can be converted </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00251">251</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00241">HAS_VIRTUAL</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00542">to_ami()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d10/manager_8c_source.html#l01838">manager_default_msg_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/db9/stasis__message_8c.html#a16ea8e0b2040307000b2a3949e5dcf56">HAS_VIRTUAL</a>(<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a>, msg);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div><div class="ttc" id="res__pjsip__exten__state_8c_html_ae8731a90be4dc2d8272b7dfd8a001d4c"><div class="ttname"><a href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a></div><div class="ttdeci">static void to_ami(struct ast_sip_subscription *sub, struct ast_str **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00542">res_pjsip_exten_state.c:542</a></div></div>
<div class="ttc" id="stasis__message_8c_html_a16ea8e0b2040307000b2a3949e5dcf56"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#a16ea8e0b2040307000b2a3949e5dcf56">HAS_VIRTUAL</a></div><div class="ttdeci">#define HAS_VIRTUAL(fn, msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00241">stasis_message.c:241</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72a06fdaec039fdfb5f36892e725f9ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72a06fdaec039fdfb5f36892e725f9ec">&#9670;&nbsp;</a></span>stasis_message_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_message_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new message. </p>
<p>This message is an <code>ao2</code> object, and must be <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a>'ed when you are done with it. Messages are also immutable, and must not be modified after they are initialized. Especially the <em>data</em> in the message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Type of the message </td></tr>
    <tr><td class="paramname">data</td><td>Immutable data that is the actual contents of the message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New message </dd>
<dd>
<code>NULL</code> on error</dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">174</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00093">ast_eid_default</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00140">stasis_message_create_full()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db9/test_8c_source.html#l01145">__ast_test_suite_event_notify()</a>, <a class="el" href="../../d0/da6/aoc_8c_source.html#l01835">aoc_publish_blob()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00500">ast_bridge_blob_create()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00546">ast_bridge_blob_create_from_snapshots()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l01346">ast_bridge_publish_attended_transfer()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00953">ast_bridge_publish_blind_transfer()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00460">ast_bridge_publish_merge()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00350">ast_bridge_publish_state()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04577">ast_cdr_engine_term()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00602">ast_channel_publish_dial_internal()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00917">ast_channel_publish_final_snapshot()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01055">ast_channel_publish_snapshot()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00293">ast_endpoint_blob_create()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l01903">ast_manager_publish_event()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02010">ast_multi_object_blob_single_channel_publish()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00462">ast_mwi_blob_create()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03485">ast_rtp_publish_rtcp_message()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00118">ast_system_publish_registry()</a>, <a class="el" href="../../db/dc4/test__cel_8c_source.html#l01616">AST_TEST_DEFINE()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00381">bridge_publish_state_from_blob()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00319">bridge_topics_destroy()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01023">cc_publish()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00604">cdr_prop_write()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00448">cdr_read()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00506">cdr_write()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00745">create_channel_blob_message()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00334">create_endpoint_snapshot_message()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00122">endpoint_publish_snapshot()</a>, <a class="el" href="../../d2/db9/app__forkcdr_8c_source.html#l00134">forkcdr_exec()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00433">local_optimization_finished_cb()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00390">local_optimization_started_cb()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00294">presence_state_event()</a>, <a class="el" href="../../da/ddd/named__acl_8c_source.html#l00371">publish_acl_change()</a>, <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00166">publish_app_cdr_message()</a>, <a class="el" href="../../dc/d04/app__chanspy_8c_source.html#l00565">publish_chanspy_message()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00303">publish_cluster_discovery_to_stasis_full()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00204">publish_corosync_ping_to_stasis()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00093">publish_format_update()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l04074">publish_hint_change()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l03924">publish_hint_remove()</a>, <a class="el" href="../../d3/d96/loader_8c_source.html#l01475">publish_load_message_type()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00540">publish_local_bridge_message()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00617">publish_parked_call()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00595">publish_parked_call_failure()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02234">queue_publish_member_blob()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02166">queue_publish_multi_channel_snapshot_blob()</a>, <a class="el" href="../../d9/dbf/pickup_8c_source.html#l00278">send_call_pickup_stasis_message()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02208">send_msg()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00991">send_start_msg_snapshots()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01648">send_subscription_subscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01676">send_subscription_unsubscribe()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l02095">stasis_app_user_event()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00778">stasis_cache_clear_create()</a>, <a class="el" href="../../da/dca/res__stasis__test_8c_source.html#l00236">stasis_test_message_create()</a>, <a class="el" href="../../db/dd3/res__stun__monitor_8c_source.html#l00085">stun_monitor_request()</a>, and <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00795">update_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/db9/stasis__message_8c.html#a08010732dcea60e116e54fca0133d582">stasis_message_create_full</a>(type, data, &amp;<a class="code" href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div><div class="ttc" id="stasis__message_8c_html_a08010732dcea60e116e54fca0133d582"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#a08010732dcea60e116e54fca0133d582">stasis_message_create_full</a></div><div class="ttdeci">struct stasis_message * stasis_message_create_full(struct stasis_message_type *type, void *data, const struct ast_eid *eid)</div><div class="ttdoc">Create a new message for an entity. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00140">stasis_message.c:140</a></div></div>
<div class="ttc" id="utils_8h_html_ad5db11fa27352e2b9a3c669adc76955f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ad5db11fa27352e2b9a3c669adc76955f">ast_eid_default</a></div><div class="ttdeci">struct ast_eid ast_eid_default</div><div class="ttdoc">Global EID. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00093">options.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08010732dcea60e116e54fca0133d582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08010732dcea60e116e54fca0133d582">&#9670;&nbsp;</a></span>stasis_message_create_full()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>* stasis_message_create_full </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a> *&#160;</td>
          <td class="paramname"><em>eid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new message for an entity. </p>
<p>This message is an <code>ao2</code> object, and must be <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a>'ed when you are done with it. Messages are also immutable, and must not be modified after they are initialized. Especially the <em>data</em> in the message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Type of the message </td></tr>
    <tr><td class="paramname">data</td><td>Immutable data that is the actual contents of the message </td></tr>
    <tr><td class="paramname">eid</td><td>What entity originated this message. (NULL for aggregate)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>An aggregate message is a combined representation of the local and remote entities publishing the message data. e.g., An aggregate device state represents the combined device state from the local and any remote entities publishing state for a device. e.g., An aggregate MWI message is the old/new MWI counts accumulated from the local and any remote entities publishing to a mailbox.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">New</td><td>message </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00140">140</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00404">ao2_t_alloc_options</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00129">stasis_message::data</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00131">stasis_message::eid</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00127">stasis_message::eid_ptr</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00040">stasis_message_type::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00134">stasis_message_dtor()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00123">stasis_message::timestamp</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00125">stasis_message::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00709">ast_publish_device_state_full()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00099">AST_TEST_DEFINE()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00875">cache_test_message_create_full()</a>, <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00246">create_foo_type_message()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00169">mwi_state_create_message()</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;{</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">if</span> (type == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">data</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   message = <a class="code" href="../../d5/da5/astobj2_8h.html#a7d8e253a1db2dc47ed4af636c3ea89ce">ao2_t_alloc_options</a>(<span class="keyword">sizeof</span>(*message), <a class="code" href="../../d2/db9/stasis__message_8c.html#a45177efd00399bdd5026f27091240305">stasis_message_dtor</a>,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a5ac083a645d964373f022d03df4849c8">name</a>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="keywordflow">if</span> (message == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   message-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#a175ebf16736553ad076aefe3f02d180c">timestamp</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">    * XXX Normal ao2 ref counting rules says we should increment the message</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">    * type ref here and decrement it in stasis_message_dtor().  However, the</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">    * stasis message could be cached and legitimately cause the type ref count</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">    * to hit the excessive ref count assertion.  Since the message type</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">    * practically has to be a global object anyway, we can get away with not</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">    * holding a ref in the stasis message.</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   message-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a> = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">data</a>, +1);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   message-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">data</a> = <a class="code" href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="keywordflow">if</span> (eid) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      message-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#afeb01b4380f565c50af8cfc4c6ea036d">eid_ptr</a> = &amp;message-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#aa1d7e6e6eb6d297e62f2d79dbdfaafb4">eid</a>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      message-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#aa1d7e6e6eb6d297e62f2d79dbdfaafb4">eid</a> = *<a class="code" href="../../d7/d55/structstasis__message.html#aa1d7e6e6eb6d297e62f2d79dbdfaafb4">eid</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <span class="keywordflow">return</span> message;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structmessage_html"><div class="ttname"><a href="../../d8/d9e/structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00144">manager.h:144</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structstasis__message_html_aa1d7e6e6eb6d297e62f2d79dbdfaafb4"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#aa1d7e6e6eb6d297e62f2d79dbdfaafb4">stasis_message::eid</a></div><div class="ttdeci">struct ast_eid eid</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00131">stasis_message.c:131</a></div></div>
<div class="ttc" id="stasis__message_8c_html_a45177efd00399bdd5026f27091240305"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#a45177efd00399bdd5026f27091240305">stasis_message_dtor</a></div><div class="ttdeci">static void stasis_message_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00134">stasis_message.c:134</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7d8e253a1db2dc47ed4af636c3ea89ce"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7d8e253a1db2dc47ed4af636c3ea89ce">ao2_t_alloc_options</a></div><div class="ttdeci">#define ao2_t_alloc_options(data_size, destructor_fn, options, debug_msg)</div><div class="ttdoc">Allocate and initialize an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00404">astobj2.h:404</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__message_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#a39694abd1b80d3c9ef0619acf9d493aa">stasis_message::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00125">stasis_message.c:125</a></div></div>
<div class="ttc" id="structstasis__message_html_a175ebf16736553ad076aefe3f02d180c"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#a175ebf16736553ad076aefe3f02d180c">stasis_message::timestamp</a></div><div class="ttdeci">struct timeval timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00123">stasis_message.c:123</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__message_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">stasis_message::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00129">stasis_message.c:129</a></div></div>
<div class="ttc" id="structstasis__message__type_html_a5ac083a645d964373f022d03df4849c8"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a5ac083a645d964373f022d03df4849c8">stasis_message_type::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00040">stasis_message.c:40</a></div></div>
<div class="ttc" id="structstasis__message_html_afeb01b4380f565c50af8cfc4c6ea036d"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#afeb01b4380f565c50af8cfc4c6ea036d">stasis_message::eid_ptr</a></div><div class="ttdeci">const struct ast_eid * eid_ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00127">stasis_message.c:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6081f17431b81bc1a010b680517491d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6081f17431b81bc1a010b680517491d">&#9670;&nbsp;</a></span>stasis_message_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* stasis_message_data </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the data contained in a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Immutable data pointer </dd>
<dd>
<code>NULL</code> if msg is <code>NULL</code>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">195</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00129">stasis_message::data</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01213">agent_login_to_ami()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01233">agent_logoff_to_ami()</a>, <a class="el" href="../../dd/de9/res__agi_8c_source.html#l01421">agi_channel_to_ami()</a>, <a class="el" href="../../d0/da6/aoc_8c_source.html#l01871">aoc_to_ami()</a>, <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00131">appcdr_callback()</a>, <a class="el" href="../../d1/d5a/resource__endpoints_8c_source.html#l00037">ast_ari_endpoints_list()</a>, <a class="el" href="../../d1/d5a/resource__endpoints_8c_source.html#l00085">ast_ari_endpoints_list_by_tech()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00438">ast_bridge_merge_message_to_json()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00582">ast_bridge_publish_enter()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00611">ast_bridge_publish_leave()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00653">ast_channel_entered_bridge_to_json()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00663">ast_channel_left_bridge_to_json()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00399">ast_delete_mwi_state_full()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00341">ast_endpoint_latest_snapshot()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00370">ast_mwi_publish_by_mailbox()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00511">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">asterisk_publisher_devstate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">asterisk_publisher_mwistate_cb()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l01103">attended_transfer_to_ami()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00967">attended_transfer_to_json()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00870">blind_transfer_to_ami()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00799">blind_transfer_to_json()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00786">bridge_attended_transfer_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00773">bridge_blind_transfer_handler()</a>, <a class="el" href="../../da/d10/manager__bridges_8c_source.html#l00362">bridge_merge_cb()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00733">bridge_merge_handler()</a>, <a class="el" href="../../da/d10/manager__bridges_8c_source.html#l00329">bridge_snapshot_update()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00901">cache_test_data_id()</a>, <a class="el" href="../../d5/d3c/test__stasis__endpoints_8c_source.html#l00048">cache_update()</a>, <a class="el" href="../../d6/d6a/res__endpoint__stats_8c_source.html#l00078">cache_update_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00318">call_forwarded_handler()</a>, <a class="el" href="../../d9/dbf/pickup_8c_source.html#l00246">call_pickup_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00185">cc_available_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00284">cc_callerrecalling_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00269">cc_callerstartmonitoring_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00254">cc_callerstopmonitoring_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00314">cc_failure_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00332">cc_monitorfailed_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00203">cc_offertimerstart_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00299">cc_recallcomplete_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00239">cc_requestacknowledged_to_ami()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00221">cc_requested_to_ami()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00400">cdr_prop_write_callback()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00248">cdr_read_callback()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00357">cdr_write_callback()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01305">cel_attended_transfer_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01279">cel_blind_transfer_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01047">cel_bridge_enter_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01077">cel_bridge_leave_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01229">cel_dial_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01256">cel_generic_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01392">cel_local_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01107">cel_parking_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01368">cel_pickup_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l00994">cel_snapshot_update_cb()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01338">channel_blob_to_json()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00842">channel_chanspy_start_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00807">channel_chanspy_stop_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01194">channel_dial_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00877">channel_dtmf_begin_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00921">channel_dtmf_end_cb()</a>, <a class="el" href="../../da/d10/manager__bridges_8c_source.html#l00394">channel_enter_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01020">channel_fax_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00971">channel_flash_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00989">channel_hangup_handler_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00759">channel_hangup_request_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01247">channel_hold_cb()</a>, <a class="el" href="../../da/d10/manager__bridges_8c_source.html#l00422">channel_leave_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01153">channel_mixmonitor_mute_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01137">channel_mixmonitor_start_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01145">channel_mixmonitor_stop_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01093">channel_moh_start_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01113">channel_moh_stop_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01121">channel_monitor_start_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01129">channel_monitor_stop_cb()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l00713">channel_snapshot_update()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01284">channel_unhold_cb()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00970">check_cache_aggregate()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00414">conf_send_event_to_participants()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00624">confbridge_atxfer_cb()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00525">confbridge_publish_manager_event()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00678">confbridge_talking_cb()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00415">consumer_exec()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00203">contactstatus_to_ami()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00237">contactstatus_to_json()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00175">corosync_ping_to_event()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l01741">dahdichannel_to_ami()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00818">device_state_aggregate_calc()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02503">device_state_cb()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00761">device_state_get_id()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00309">devstate_cached()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00583">devstate_change_cb()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00938">devstate_to_ami()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00956">devstate_to_event()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01433">dial_to_json()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01385">dtmf_end_to_json()</a>, <a class="el" href="../../d6/d6a/res__endpoint__stats_8c_source.html#l00095">dump_cache_load()</a>, <a class="el" href="../../d6/d6a/res__endpoint__stats_8c_source.html#l00105">dump_cache_unload()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02193">dump_consumer()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00183">endpoint_cache_clear()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00384">endpoint_snapshot_get_id()</a>, <a class="el" href="../../d6/d2c/res_2prometheus_2endpoints_8c_source.html#l00097">endpoints_scrape_cb()</a>, <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00293">explicit_publish_cb()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00056">fake_ami()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00049">fake_json()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00155">find_route()</a>, <a class="el" href="../../d2/db9/app__forkcdr_8c_source.html#l00115">forkcdr_callback()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02761">generic_agent_devstate_cb()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01484">generic_monitor_devstate_cb()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00564">get_bool_header()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l29726">get_cached_mwi()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06206">handle_attended_transfer()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06146">handle_blind_transfer()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06112">handle_bridge_enter()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02708">handle_bridge_enter_message()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02404">handle_bridge_leave_message()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02278">handle_channel_snapshot_update_message()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02105">handle_dial_message()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06398">handle_hangup()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l03537">handle_hint_change_message_type()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06281">handle_local_optimization_begin()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06333">handle_local_optimization_end()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06455">handle_masquerade()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00313">handle_mwi_state()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02751">handle_parked_call_message()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l05033">has_voicemail()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01535">hold_to_json()</a>, <a class="el" href="../../de/d6b/test__stasis__state_8c_source.html#l00272">implicit_publish_cb()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02178">is_msg()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00463">local_message_to_ami()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l01869">manager_generic_msg_cb()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01226">meetme_stasis_cb()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00239">moh_post_start()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00264">moh_post_stop()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02155">multi_user_event_to_ami()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02045">multi_user_event_to_json()</a>, <a class="el" href="../../d4/d00/manager__mwi_8c_source.html#l00055">mwi_app_event_cb()</a>, <a class="el" href="../../d0/d80/chan__skinny_8c_source.html#l03554">mwi_event_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01483">mwi_startup_event_cb()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00441">mwi_state_get_id()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00038">mwi_to_event()</a>, <a class="el" href="../../d4/d00/manager__mwi_8c_source.html#l00086">mwi_update_cb()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00859">park_announce_update_cb()</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00158">parker_update_cb()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00677">parking_event_cb()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00128">peerstatus_to_ami()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00163">peerstatus_to_json()</a>, <a class="el" href="../../d7/de1/res__stasis__playback_8c_source.html#l00095">playback_to_json()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00125">presence_state_cached()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08333">presence_state_cb()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00380">presence_state_get_id()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00525">presence_state_to_ami()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l05895">queue_agent_cb()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01976">queue_channel_to_ami()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02020">queue_member_to_ami()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02084">queue_multi_channel_to_ami()</a>, <a class="el" href="../../d8/d4c/res__stasis__recording_8c_source.html#l00073">recording_to_json()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00181">refer_progress_bridge()</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00267">registry_message_cb()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00479">remove_device_states_cb()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03297">rtcp_report_to_ami()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03387">rtcp_report_to_json()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00455">security_event_to_ami()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00117">security_stasis_cb()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l29861">session_timeout_to_ami()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l35461">startup_event_cb()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00115">stasis_end_to_json()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00147">stasis_start_to_json()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00497">stasis_state_subscriber_data()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01176">stasis_subscription_final_message()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00682">sub_bridge_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00543">sub_channel_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00628">sub_endpoint_update_handler()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">subscription_persistence_event_cb()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00152">system_registry_to_ami()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01483">talking_start_to_ami()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01507">talking_stop_to_ami()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00693">test_cb()</a>, <a class="el" href="../../d8/db9/test_8c_source.html#l01100">test_suite_event_to_ami()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01557">unhold_to_json()</a>, <a class="el" href="../../d1/d6d/chan__unistim_8c_source.html#l05675">unistim_send_mwi_to_peer()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l09002">update_registry()</a>, <a class="el" href="../../d0/dff/res__chan__stats_8c_source.html#l00089">updates()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01175">varset_to_ami()</a>, <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01364">xmpp_pubsub_devstate_cb()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01336">xmpp_pubsub_mwi_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   <span class="keywordflow">if</span> (msg == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="keywordflow">return</span> msg-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__message_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#a735984d41155bc1032e09bece8f8d66d">stasis_message::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00129">stasis_message.c:129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5dc2372860d977cc3e2a8e9af24aeaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5dc2372860d977cc3e2a8e9af24aeaf">&#9670;&nbsp;</a></span>stasis_message_eid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../d0/d86/structast__eid.html">ast_eid</a>* stasis_message_eid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the entity id for a <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>. </p>
<dl class="section since"><dt>Since</dt><dd>12.2.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message to get eid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Entity</td><td>id of <em>msg</em> </td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00179">179</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00127">stasis_message::eid_ptr</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00099">AST_TEST_DEFINE()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00631">cache_entry_by_eid()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00212">cache_entry_create()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00425">cache_remove()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00466">cache_udpate()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, and <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00623">clear_node_cache()</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;{</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordflow">if</span> (msg == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <span class="keywordflow">return</span> msg-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#afeb01b4380f565c50af8cfc4c6ea036d">eid_ptr</a>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__message_html_afeb01b4380f565c50af8cfc4c6ea036d"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#afeb01b4380f565c50af8cfc4c6ea036d">stasis_message::eid_ptr</a></div><div class="ttdeci">const struct ast_eid * eid_ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00127">stasis_message.c:127</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a9c10eadd9db34f8c0b19619752ea93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a9c10eadd9db34f8c0b19619752ea93">&#9670;&nbsp;</a></span>stasis_message_timestamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct timeval* stasis_message_timestamp </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the time when a message was created. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the <em>timeval</em> when the message was created. </dd>
<dd>
<code>NULL</code> if msg is <code>NULL</code>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00203">203</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00123">stasis_message::timestamp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00438">ast_bridge_merge_message_to_json()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00653">ast_channel_entered_bridge_to_json()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00663">ast_channel_left_bridge_to_json()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00099">AST_TEST_DEFINE()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00967">attended_transfer_to_json()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00799">blind_transfer_to_json()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01305">cel_attended_transfer_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01279">cel_blind_transfer_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01047">cel_bridge_enter_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01077">cel_bridge_leave_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01229">cel_dial_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01256">cel_generic_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01392">cel_local_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01107">cel_parking_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01368">cel_pickup_cb()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l00994">cel_snapshot_update_cb()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01338">channel_blob_to_json()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00237">contactstatus_to_json()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01433">dial_to_json()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01385">dtmf_end_to_json()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02708">handle_bridge_enter_message()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02404">handle_bridge_leave_message()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02278">handle_channel_snapshot_update_message()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02105">handle_dial_message()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l02751">handle_parked_call_message()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01535">hold_to_json()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02045">multi_user_event_to_json()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00329">pack_bridge_and_channels()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00163">peerstatus_to_json()</a>, <a class="el" href="../../d7/de1/res__stasis__playback_8c_source.html#l00095">playback_to_json()</a>, <a class="el" href="../../d8/d4c/res__stasis__recording_8c_source.html#l00073">recording_to_json()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00682">sub_bridge_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00543">sub_channel_update_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00628">sub_endpoint_update_handler()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01557">unhold_to_json()</a>, and <a class="el" href="../../d0/dff/res__chan__stats_8c_source.html#l00089">updates()</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="keywordflow">if</span> (msg == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="keywordflow">return</span> &amp;msg-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#a175ebf16736553ad076aefe3f02d180c">timestamp</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__message_html_a175ebf16736553ad076aefe3f02d180c"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#a175ebf16736553ad076aefe3f02d180c">stasis_message::timestamp</a></div><div class="ttdeci">struct timeval timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00123">stasis_message.c:123</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adf8e3a27e9995917eb0bc043acd1316a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf8e3a27e9995917eb0bc043acd1316a">&#9670;&nbsp;</a></span>stasis_message_to_ami()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a>* stasis_message_to_ami </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the AMI representation of the message. </p>
<p>May return <code>NULL</code>, to indicate no representation. The returned object should be <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a>'ed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message to convert to AMI. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> on error. </dd>
<dd>
<code>NULL</code> if AMI format is not supported. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00224">224</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00211">INVOKE_VIRTUAL</a>, and <a class="el" href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00542">to_ami()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d1d/res__manager__devicestate_8c_source.html#l00073">action_devicestatelist()</a>, <a class="el" href="../../d3/d2d/res__manager__presencestate_8c_source.html#l00073">action_presencestatelist()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01892">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d4/d10/manager_8c_source.html#l01838">manager_default_msg_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/db9/stasis__message_8c.html#ab93a8e3900b856699ffb2eb8e1c76248">INVOKE_VIRTUAL</a>(<a class="code" href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a>, msg);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div><div class="ttc" id="stasis__message_8c_html_ab93a8e3900b856699ffb2eb8e1c76248"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#ab93a8e3900b856699ffb2eb8e1c76248">INVOKE_VIRTUAL</a></div><div class="ttdeci">#define INVOKE_VIRTUAL(fn,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00211">stasis_message.c:211</a></div></div>
<div class="ttc" id="res__pjsip__exten__state_8c_html_ae8731a90be4dc2d8272b7dfd8a001d4c"><div class="ttname"><a href="../../d2/d3d/res__pjsip__exten__state_8c.html#ae8731a90be4dc2d8272b7dfd8a001d4c">to_ami</a></div><div class="ttdeci">static void to_ami(struct ast_sip_subscription *sub, struct ast_str **buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3d/res__pjsip__exten__state_8c_source.html#l00542">res_pjsip_exten_state.c:542</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa90ab45287904a603efb31319aaf8b91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90ab45287904a603efb31319aaf8b91">&#9670;&nbsp;</a></span>stasis_message_to_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d5/d78/structast__event.html">ast_event</a>* stasis_message_to_event </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the <a class="el" href="../../db/d28/AstGenericEvents.html">Generic event system</a> representation of the message. </p>
<p>May return <code>NULL</code>, to indicate no representation. The returned object should be disposed of via <a class="el" href="../../d0/deb/event_8c.html#a50b34e0161630dbbc0880a06eb78ad7a">ast_event_destroy</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message to convert to AMI. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> on error. </dd>
<dd>
<code>NULL</code> if AMI format is not supported. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00236">236</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00211">INVOKE_VIRTUAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00571">publish_to_corosync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/db9/stasis__message_8c.html#ab93a8e3900b856699ffb2eb8e1c76248">INVOKE_VIRTUAL</a>(to_event, msg);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div><div class="ttc" id="stasis__message_8c_html_ab93a8e3900b856699ffb2eb8e1c76248"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#ab93a8e3900b856699ffb2eb8e1c76248">INVOKE_VIRTUAL</a></div><div class="ttdeci">#define INVOKE_VIRTUAL(fn,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00211">stasis_message.c:211</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a415493fbb3571cc6c9e7ac599309110f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a415493fbb3571cc6c9e7ac599309110f">&#9670;&nbsp;</a></span>stasis_message_to_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a>* stasis_message_to_json </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d45/structstasis__message__sanitizer.html">stasis_message_sanitizer</a> *&#160;</td>
          <td class="paramname"><em>sanitize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Build the JSON representation of the message. </p>
<p>May return <code>NULL</code>, to indicate no representation. The returned object should be <a class="el" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c" title="Decrease refcount on value. If refcount reaches zero, value is freed. ">ast_json_unref()</a>'ed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message to convert to JSON string. </td></tr>
    <tr><td class="paramname">sanitize</td><td>Snapshot sanitization callback.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Newly allocated string with JSON message. </dd>
<dd>
<code>NULL</code> on error. </dd>
<dd>
<code>NULL</code> if JSON format is not supported. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00229">229</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00211">INVOKE_VIRTUAL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01821">AST_TEST_DEFINE()</a>, <a class="el" href="../../d4/d8f/res__hep__rtcp_8c_source.html#l00085">rtcp_message_handler()</a>, and <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00347">sub_default_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/db9/stasis__message_8c.html#ab93a8e3900b856699ffb2eb8e1c76248">INVOKE_VIRTUAL</a>(to_json, msg, sanitize);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div><div class="ttc" id="stasis__message_8c_html_ab93a8e3900b856699ffb2eb8e1c76248"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#ab93a8e3900b856699ffb2eb8e1c76248">INVOKE_VIRTUAL</a></div><div class="ttdeci">#define INVOKE_VIRTUAL(fn,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00211">stasis_message.c:211</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9356e8a29344ca4eac93088198ccff89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9356e8a29344ca4eac93088198ccff89">&#9670;&nbsp;</a></span>stasis_message_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a>* <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the message type for a <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message to type </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Type of <em>msg</em> </dd>
<dd>
<code>NULL</code> if <em>msg</em> is <code>NULL</code>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">187</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00125">stasis_message::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01512">acl_change_stasis_cb()</a>, <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00131">appcdr_callback()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00099">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">asterisk_publisher_devstate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">asterisk_publisher_mwistate_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00212">cache_entry_create()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00505">cache_put()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01699">cache_simple()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00911">cache_test_aggregate_calc_fn()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00901">cache_test_data_id()</a>, <a class="el" href="../../d5/d3c/test__stasis__endpoints_8c_source.html#l00048">cache_update()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00400">cdr_prop_write_callback()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00248">cdr_read_callback()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00357">cdr_write_callback()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00414">conf_send_event_to_participants()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00525">confbridge_publish_manager_event()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02503">device_state_cb()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00761">device_state_get_id()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00583">devstate_change_cb()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01314">dispatch_message()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02193">dump_consumer()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00384">endpoint_snapshot_get_id()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00155">find_route()</a>, <a class="el" href="../../d2/db9/app__forkcdr_8c_source.html#l00115">forkcdr_callback()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02761">generic_agent_devstate_cb()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01484">generic_monitor_devstate_cb()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l03537">handle_hint_change_message_type()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02178">is_msg()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00463">local_message_to_ami()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01226">meetme_stasis_cb()</a>, <a class="el" href="../../da/dca/res__stasis__test_8c_source.html#l00108">message_sink_cb()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l17528">mwi_event_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01483">mwi_startup_event_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01156">mwi_stasis_cb()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00441">mwi_state_get_id()</a>, <a class="el" href="../../d4/d00/manager__mwi_8c_source.html#l00086">mwi_update_cb()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01498">network_change_stasis_cb()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00329">pack_bridge_and_channels()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00859">park_announce_update_cb()</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00158">parker_update_cb()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00677">parking_event_cb()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08333">presence_state_cb()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00380">presence_state_get_id()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01432">publish_msg()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l05895">queue_agent_cb()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00181">refer_progress_bridge()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03297">rtcp_report_to_ami()</a>, <a class="el" href="../../d4/d8f/res__hep__rtcp_8c_source.html#l00148">rtp_topic_handler()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00455">security_event_to_ami()</a>, <a class="el" href="../../dd/d1e/res__security__log_8c_source.html#l00117">security_stasis_cb()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l35461">startup_event_cb()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01176">stasis_subscription_final_message()</a>, <a class="el" href="../../d0/dff/res__chan__stats_8c_source.html#l00057">statsmaker()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00347">sub_default_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00628">sub_endpoint_update_handler()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00756">subscription_invoke()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">subscription_persistence_event_cb()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00693">test_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00795">update_create()</a>, <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01364">xmpp_pubsub_devstate_cb()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01336">xmpp_pubsub_mwi_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <span class="keywordflow">if</span> (msg == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordflow">return</span> msg-&gt;<a class="code" href="../../d7/d55/structstasis__message.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__message_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../d7/d55/structstasis__message.html#a39694abd1b80d3c9ef0619acf9d493aa">stasis_message::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00125">stasis_message.c:125</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7a9331334e3c57d1718475864636d1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7a9331334e3c57d1718475864636d1c">&#9670;&nbsp;</a></span>stasis_message_type_available_formatters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> stasis_message_type_available_formatters </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a bitmap of available formatters for a message type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">message_type</td><td>Message type </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A bitmap of <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>13.25.0 </dd>
<dd>
16.2.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00114">114</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00043">stasis_message_type::available_formatters</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/df4/stasis_8c_source.html#l01314">dispatch_message()</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>-&gt;available_formatters;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c7761ce3c78b45fd34cb25bf0e1ba09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7761ce3c78b45fd34cb25bf0e1ba09">&#9670;&nbsp;</a></span>stasis_message_type_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3">stasis_message_type_result</a> stasis_message_type_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d3e/structstasis__message__vtable.html">stasis_message_vtable</a> *&#160;</td>
          <td class="paramname"><em>vtable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> **&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new message type. </p>
<p><a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> is an AO2 object, so <a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup()</a> when you're done with it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">name</td><td>Name of the new type. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">vtable</td><td>Virtual table of message methods. May be <code>NULL</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">result</td><td>The location where the new message type will be placed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Stasis message type creation may be declined if the message type is disabled</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>A stasis_message_type_result enum </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00056">56</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00404">ao2_t_alloc_options</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>, <a class="el" href="../../df/d35/hashtab_8c_source.html#l00153">ast_hashtab_hash_string()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00043">stasis_message_type::available_formatters</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00041">stasis_message_type::hash</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00042">stasis_message_type::id</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00049">message_type_dtor()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00047">message_type_id</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00040">stasis_message_type::name</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00046">null_vtable</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00291">STASIS_MESSAGE_TYPE_DECLINED</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02283">stasis_message_type_declined()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00289">STASIS_MESSAGE_TYPE_ERROR</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00290">STASIS_MESSAGE_TYPE_SUCCESS</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00314">STASIS_SUBSCRIPTION_FORMATTER_AMI</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00315">STASIS_SUBSCRIPTION_FORMATTER_EVENT</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00313">STASIS_SUBSCRIPTION_FORMATTER_JSON</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00266">stasis_message_vtable::to_ami</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00281">stasis_message_vtable::to_event</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00253">stasis_message_vtable::to_json</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00039">stasis_message_type::vtable</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00077">AST_TEST_DEFINE()</a>, and <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02080">create_message_types()</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <span class="comment">/* Check for declination */</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> &amp;&amp; <a class="code" href="../../dd/d79/stasis_8h.html#a6c2e98dd27243b0fe07717c54c40d0b1">stasis_message_type_declined</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e">STASIS_MESSAGE_TYPE_DECLINED</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   type = <a class="code" href="../../d5/da5/astobj2_8h.html#a7d8e253a1db2dc47ed4af636c3ea89ce">ao2_t_alloc_options</a>(<span class="keyword">sizeof</span>(*type), <a class="code" href="../../d2/db9/stasis__message_8c.html#a37a5fd1a121e57501bd9fe0d83ba448a">message_type_dtor</a>,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> ?: <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keywordflow">if</span> (!type) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <span class="keywordflow">if</span> (!vtable) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="comment">/* Null object pattern, FTW! */</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      vtable = &amp;<a class="code" href="../../d2/db9/stasis__message_8c.html#ae9017e7abcabc89dfb08c4653d08733d">null_vtable</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   }</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a5ac083a645d964373f022d03df4849c8">name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="keywordflow">if</span> (!type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a5ac083a645d964373f022d03df4849c8">name</a>) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(type);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a09f9a9ce240560b1d191b42ed56af642">hash</a> = <a class="code" href="../../d6/da0/hashtab_8h.html#af8904cce564fd39de28b566bb8c261eb">ast_hashtab_hash_string</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a577ad3d8a0b5b866d55464d1b684b4e9">vtable</a> = <a class="code" href="../../d4/d8f/structstasis__message__type.html#a577ad3d8a0b5b866d55464d1b684b4e9">vtable</a>;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="keywordflow">if</span> (vtable-&gt;<a class="code" href="../../dd/d3e/structstasis__message__vtable.html#a8ebb74617e8d5134105fd04797d2fba7">to_json</a>) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#af146c2c40e3c6ebd3f45d4118d9637fb">available_formatters</a> |= <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587">STASIS_SUBSCRIPTION_FORMATTER_JSON</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="keywordflow">if</span> (vtable-&gt;<a class="code" href="../../dd/d3e/structstasis__message__vtable.html#a92408bd64ea09c19566c897fe9a9ec69">to_ami</a>) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#af146c2c40e3c6ebd3f45d4118d9637fb">available_formatters</a> |= <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d">STASIS_SUBSCRIPTION_FORMATTER_AMI</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="keywordflow">if</span> (vtable-&gt;<a class="code" href="../../dd/d3e/structstasis__message__vtable.html#af8252f3e39a79e8ac04f8a83993d0d09">to_event</a>) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#af146c2c40e3c6ebd3f45d4118d9637fb">available_formatters</a> |= <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09">STASIS_SUBSCRIPTION_FORMATTER_EVENT</a>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a> = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../d2/db9/stasis__message_8c.html#a744ceb580c661e018a750bee94f2a1c0">message_type_id</a>, +1);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   *result = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42">STASIS_MESSAGE_TYPE_SUCCESS</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structstasis__message__type_html_a09f9a9ce240560b1d191b42ed56af642"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a09f9a9ce240560b1d191b42ed56af642">stasis_message_type::hash</a></div><div class="ttdeci">unsigned int hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00041">stasis_message.c:41</a></div></div>
<div class="ttc" id="stasis_8h_html_a6c2e98dd27243b0fe07717c54c40d0b1"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a6c2e98dd27243b0fe07717c54c40d0b1">stasis_message_type_declined</a></div><div class="ttdeci">int stasis_message_type_declined(const char *name)</div><div class="ttdoc">Check whether a message type is declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02283">stasis.c:2283</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="stasis__message_8c_html_a744ceb580c661e018a750bee94f2a1c0"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#a744ceb580c661e018a750bee94f2a1c0">message_type_id</a></div><div class="ttdeci">static int message_type_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00047">stasis_message.c:47</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a225e305ebf20685fe0b8a6493b44ea09">STASIS_SUBSCRIPTION_FORMATTER_EVENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00315">stasis.h:315</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d">STASIS_SUBSCRIPTION_FORMATTER_AMI</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00314">stasis.h:314</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7d8e253a1db2dc47ed4af636c3ea89ce"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7d8e253a1db2dc47ed4af636c3ea89ce">ao2_t_alloc_options</a></div><div class="ttdeci">#define ao2_t_alloc_options(data_size, destructor_fn, options, debug_msg)</div><div class="ttdoc">Allocate and initialize an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00404">astobj2.h:404</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structstasis__message__vtable_html_af8252f3e39a79e8ac04f8a83993d0d09"><div class="ttname"><a href="../../dd/d3e/structstasis__message__vtable.html#af8252f3e39a79e8ac04f8a83993d0d09">stasis_message_vtable::to_event</a></div><div class="ttdeci">struct ast_event *(* to_event)(struct stasis_message *message)</div><div class="ttdoc">Build the ast_event representation of the message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00281">stasis.h:281</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="stasis_8h_html_af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a69bbd642277d3d76eb62bc4736a3ab42">STASIS_MESSAGE_TYPE_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00290">stasis.h:290</a></div></div>
<div class="ttc" id="stasis_8h_html_af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a5cdf581193f897efeb4387c08e5688e8">STASIS_MESSAGE_TYPE_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00289">stasis.h:289</a></div></div>
<div class="ttc" id="structstasis__message__vtable_html_a8ebb74617e8d5134105fd04797d2fba7"><div class="ttname"><a href="../../dd/d3e/structstasis__message__vtable.html#a8ebb74617e8d5134105fd04797d2fba7">stasis_message_vtable::to_json</a></div><div class="ttdeci">struct ast_json *(* to_json)(struct stasis_message *message, const struct stasis_message_sanitizer *sanitize)</div><div class="ttdoc">Build the JSON representation of the message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00253">stasis.h:253</a></div></div>
<div class="ttc" id="structstasis__message__type_html"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00038">stasis_message.c:38</a></div></div>
<div class="ttc" id="stasis__message_8c_html_ae9017e7abcabc89dfb08c4653d08733d"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#ae9017e7abcabc89dfb08c4653d08733d">null_vtable</a></div><div class="ttdeci">static struct stasis_message_vtable null_vtable</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00046">stasis_message.c:46</a></div></div>
<div class="ttc" id="stasis__message_8c_html_a37a5fd1a121e57501bd9fe0d83ba448a"><div class="ttname"><a href="../../d2/db9/stasis__message_8c.html#a37a5fd1a121e57501bd9fe0d83ba448a">message_type_dtor</a></div><div class="ttdeci">static void message_type_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00049">stasis_message.c:49</a></div></div>
<div class="ttc" id="structstasis__message__vtable_html_a92408bd64ea09c19566c897fe9a9ec69"><div class="ttname"><a href="../../dd/d3e/structstasis__message__vtable.html#a92408bd64ea09c19566c897fe9a9ec69">stasis_message_vtable::to_ami</a></div><div class="ttdeci">struct ast_manager_event_blob *(* to_ami)(struct stasis_message *message)</div><div class="ttdoc">Build the AMI representation of the message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00266">stasis.h:266</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="hashtab_8h_html_af8904cce564fd39de28b566bb8c261eb"><div class="ttname"><a href="../../d6/da0/hashtab_8h.html#af8904cce564fd39de28b566bb8c261eb">ast_hashtab_hash_string</a></div><div class="ttdeci">unsigned int ast_hashtab_hash_string(const void *obj)</div><div class="ttdoc">Hashes a string to a number. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d35/hashtab_8c_source.html#l00153">hashtab.c:153</a></div></div>
<div class="ttc" id="structstasis__message__type_html_a577ad3d8a0b5b866d55464d1b684b4e9"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a577ad3d8a0b5b866d55464d1b684b4e9">stasis_message_type::vtable</a></div><div class="ttdeci">struct stasis_message_vtable * vtable</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00039">stasis_message.c:39</a></div></div>
<div class="ttc" id="stasis_8h_html_af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af326808a49f64881cfa368ef2e5f49e3a56f95961ba428213b720264bd36fa08e">STASIS_MESSAGE_TYPE_DECLINED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00291">stasis.h:291</a></div></div>
<div class="ttc" id="structstasis__message__type_html_a5ac083a645d964373f022d03df4849c8"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a5ac083a645d964373f022d03df4849c8">stasis_message_type::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00040">stasis_message.c:40</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__message__type_html_a7441ef0865bcb3db9b8064dd7375c1ea"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a7441ef0865bcb3db9b8064dd7375c1ea">stasis_message_type::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00042">stasis_message.c:42</a></div></div>
<div class="ttc" id="structstasis__message__type_html_af146c2c40e3c6ebd3f45d4118d9637fb"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#af146c2c40e3c6ebd3f45d4118d9637fb">stasis_message_type::available_formatters</a></div><div class="ttdeci">enum stasis_subscription_message_formatters available_formatters</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00043">stasis_message.c:43</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a9b0968d4d470737abacb289024559587">STASIS_SUBSCRIPTION_FORMATTER_JSON</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00313">stasis.h:313</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c2e98dd27243b0fe07717c54c40d0b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c2e98dd27243b0fe07717c54c40d0b1">&#9670;&nbsp;</a></span>stasis_message_type_declined()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_type_declined </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether a message type is declined. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the message type to check</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">zero</td><td>The message type is not declined </td></tr>
    <tr><td class="paramname">non-zero</td><td>The message type is declined </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l02283">2283</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00925">ao2_global_obj_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02182">stasis_declined_config::declined</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02199">stasis_config::declined_message_types</a>, <a class="el" href="../../d3/d4e/chan__console_8c.html#aa36e3e2c486b920b166c2d17c5242221">globals</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/df4/stasis_8c_source.html#l01940">stasis_log_bad_type_access()</a>, and <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00056">stasis_message_type_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;{</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d0e/structstasis__config.html">stasis_config</a> *cfg = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(<a class="code" href="../../d3/d4e/chan__console_8c.html#aa36e3e2c486b920b166c2d17c5242221">globals</a>);</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;   <span class="keywordtype">char</span> *name_in_declined;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   <span class="keywordflow">if</span> (!cfg || !cfg-&gt;<a class="code" href="../../d2/d0e/structstasis__config.html#a6f30927c99c8edf4d9c895bf3ab7baca">declined_message_types</a>) {</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cfg);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;   }</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;   name_in_declined = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(cfg-&gt;<a class="code" href="../../d2/d0e/structstasis__config.html#a6f30927c99c8edf4d9c895bf3ab7baca">declined_message_types</a>-&gt;<a class="code" href="../../de/d5b/structstasis__declined__config.html#a9d8349e5ac80baf69070a6a108d8e372">declined</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;   res = name_in_declined ? 1 : 0;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(name_in_declined);</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cfg, -1);</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Declining to allocate Stasis message type &#39;%s&#39; due to configuration\n&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;   }</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="structstasis__declined__config_html_a9d8349e5ac80baf69070a6a108d8e372"><div class="ttname"><a href="../../de/d5b/structstasis__declined__config.html#a9d8349e5ac80baf69070a6a108d8e372">stasis_declined_config::declined</a></div><div class="ttdeci">struct ao2_container * declined</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02182">stasis.c:2182</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structstasis__config_html_a6f30927c99c8edf4d9c895bf3ab7baca"><div class="ttname"><a href="../../d2/d0e/structstasis__config.html#a6f30927c99c8edf4d9c895bf3ab7baca">stasis_config::declined_message_types</a></div><div class="ttdeci">struct stasis_declined_config * declined_message_types</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02199">stasis.c:2199</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="chan__console_8c_html_aa36e3e2c486b920b166c2d17c5242221"><div class="ttname"><a href="../../d3/d4e/chan__console_8c.html#aa36e3e2c486b920b166c2d17c5242221">globals</a></div><div class="ttdeci">static struct console_pvt globals</div></div>
<div class="ttc" id="structstasis__config_html"><div class="ttname"><a href="../../d2/d0e/structstasis__config.html">stasis_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l02195">stasis.c:2195</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1996f291ef2df28b75c279d4790c2258"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1996f291ef2df28b75c279d4790c2258">&#9670;&nbsp;</a></span>stasis_message_type_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int stasis_message_type_hash </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the hash of a given message type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The type to get the hash of. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The hash </dd></dl>
<dl class="section since"><dt>Since</dt><dd>13.24.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00104">104</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00041">stasis_message_type::hash</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00206">cache_entry_compute_hash()</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <span class="keywordflow">return</span> type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a09f9a9ce240560b1d191b42ed56af642">hash</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="ttc" id="structstasis__message__type_html_a09f9a9ce240560b1d191b42ed56af642"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a09f9a9ce240560b1d191b42ed56af642">stasis_message_type::hash</a></div><div class="ttdeci">unsigned int hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00041">stasis_message.c:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa72759806ee4118a78b9d1373c633d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa72759806ee4118a78b9d1373c633d2">&#9670;&nbsp;</a></span>stasis_message_type_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_type_id </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the id of a given message type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The type to get the id of. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The id </dd></dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00109">109</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00042">stasis_message_type::id</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/df4/stasis_8c_source.html#l01314">dispatch_message()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01432">publish_msg()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01055">stasis_subscription_decline_message_type()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00756">subscription_invoke()</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keywordflow">return</span> type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div><div class="ttc" id="structstasis__message__type_html_a7441ef0865bcb3db9b8064dd7375c1ea"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a7441ef0865bcb3db9b8064dd7375c1ea">stasis_message_type::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00042">stasis_message.c:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aefd78086150c89477f5851f2836e0478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefd78086150c89477f5851f2836e0478">&#9670;&nbsp;</a></span>stasis_message_type_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* stasis_message_type_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the name of a given message type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The type to get. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of the type. </dd>
<dd>
<code>NULL</code> if <em>type</em> is <code>NULL</code>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00099">99</a> of file <a class="el" href="../../d2/db9/stasis__message_8c_source.html">stasis_message.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00040">stasis_message_type::name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00077">AST_TEST_DEFINE()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00396">cache_find()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01699">cache_simple()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00901">cache_test_data_id()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02193">dump_consumer()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00937">print_cache_entry()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02208">send_msg()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01055">stasis_subscription_decline_message_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02865">statistics_show_messages()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02604">statistics_show_subscription()</a>, and <a class="el" href="../../d0/dff/res__chan__stats_8c_source.html#l00057">statsmaker()</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keywordflow">return</span> type-&gt;<a class="code" href="../../d4/d8f/structstasis__message__type.html#a5ac083a645d964373f022d03df4849c8">name</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div><div class="ttc" id="structstasis__message__type_html_a5ac083a645d964373f022d03df4849c8"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html#a5ac083a645d964373f022d03df4849c8">stasis_message_type::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00040">stasis_message.c:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac43d0a33d111e9f34b441b285c166cfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac43d0a33d111e9f34b441b285c166cfc">&#9670;&nbsp;</a></span>stasis_publish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_publish </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish a message to a topic's subscribers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic. </td></tr>
    <tr><td class="paramname">message</td><td>Message to publish.</td></tr>
  </table>
  </dd>
</dl>
<p>This call is asynchronous and will return immediately upon queueing the message for delivery to the topic's subscribers.</p>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">1511</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01432">publish_msg()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d8/db9/test_8c_source.html#l01145">__ast_test_suite_event_notify()</a>, <a class="el" href="../../d0/da6/aoc_8c_source.html#l01835">aoc_publish_blob()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l01083">app_send_end_msg()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l01346">ast_bridge_publish_attended_transfer()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00953">ast_bridge_publish_blind_transfer()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00582">ast_bridge_publish_enter()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00611">ast_bridge_publish_leave()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00460">ast_bridge_publish_merge()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00350">ast_bridge_publish_state()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01666">ast_cel_publish_event()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01135">ast_channel_publish_blob()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01120">ast_channel_publish_cached_blob()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00917">ast_channel_publish_final_snapshot()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01055">ast_channel_publish_snapshot()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00688">ast_device_state_clear_cache()</a>, <a class="el" href="../../d3/daf/stasis__endpoints_8c_source.html#l00325">ast_endpoint_blob_publish()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00350">ast_endpoint_shutdown()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l01903">ast_manager_publish_event()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00305">ast_monitor_start()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00461">ast_monitor_stop()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02010">ast_multi_object_blob_single_channel_publish()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00709">ast_publish_device_state_full()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03485">ast_rtp_publish_rtcp_message()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00118">ast_system_publish_registry()</a>, <a class="el" href="../../db/dc4/test__cel_8c_source.html#l01616">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00786">bridge_attended_transfer_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00773">bridge_blind_transfer_handler()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00733">bridge_merge_handler()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00381">bridge_publish_state_from_blob()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00319">bridge_topics_destroy()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00965">cache_test_aggregate_publish_fn()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01023">cc_publish()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00623">clear_node_cache()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00787">device_state_aggregate_publish()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00122">endpoint_publish_snapshot()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00190">endpoint_state_cb()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l01118">handle_security_event()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00433">local_optimization_finished_cb()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00390">local_optimization_started_cb()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l01406">manager_mute_mixmonitor()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01343">meetme_stasis_generate_msg()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l01115">mixmonitor_exec()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00239">moh_post_start()</a>, <a class="el" href="../../d3/d97/res__musiconhold_8c_source.html#l00264">moh_post_stop()</a>, <a class="el" href="../../de/dfe/app__minivm_8c_source.html#l01811">notify_new_message()</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00206">phase_e_handler()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00294">presence_state_event()</a>, <a class="el" href="../../da/ddd/named__acl_8c_source.html#l00371">publish_acl_change()</a>, <a class="el" href="../../dc/d04/app__chanspy_8c_source.html#l00565">publish_chanspy_message()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00303">publish_cluster_discovery_to_stasis_full()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00204">publish_corosync_ping_to_stasis()</a>, <a class="el" href="../../d6/d13/file_8c_source.html#l00093">publish_format_update()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l04074">publish_hint_change()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l03924">publish_hint_remove()</a>, <a class="el" href="../../d3/d96/loader_8c_source.html#l01475">publish_load_message_type()</a>, <a class="el" href="../../de/d47/core__local_8c_source.html#l00540">publish_local_bridge_message()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00586">publish_message_for_channel_topics()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00617">publish_parked_call()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00595">publish_parked_call_failure()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02234">queue_publish_member_blob()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l02166">queue_publish_multi_channel_snapshot_blob()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00479">remove_device_states_cb()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l01407">report_fax_status()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l02018">report_receive_fax_status()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l02527">report_send_fax_status()</a>, <a class="el" href="../../d9/dbf/pickup_8c_source.html#l00278">send_call_pickup_stasis_message()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l00585">send_conf_stasis()</a>, <a class="el" href="../../d0/dcf/app__confbridge_8c_source.html#l00622">send_conf_stasis_snapshots()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02208">send_msg()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l00991">send_start_msg_snapshots()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01648">send_subscription_subscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01676">send_subscription_unsubscribe()</a>, <a class="el" href="../../de/de3/control_8c_source.html#l01436">stasis_app_control_publish()</a>, <a class="el" href="../../d2/d80/res__stasis_8c_source.html#l02095">stasis_app_user_event()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00562">stasis_state_publish()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00638">stasis_state_publish_by_id()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00658">stasis_state_remove_publish_by_id()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l01257">stop_mixmonitor_full()</a>, <a class="el" href="../../db/dd3/res__stun__monitor_8c_source.html#l00085">stun_monitor_request()</a>, and <a class="el" href="../../d4/df5/func__talkdetect_8c_source.html#l00159">talk_detect_audiohook_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;{</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#a95001d504d94709275db7e173ce31b43">publish_msg</a>(topic, message, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8c_html_a95001d504d94709275db7e173ce31b43"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a95001d504d94709275db7e173ce31b43">publish_msg</a></div><div class="ttdeci">static void publish_msg(struct stasis_topic *topic, struct stasis_message *message, struct stasis_subscription *sync_sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01432">stasis.c:1432</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a499d7d708fc81464ec55de7c518b02c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a499d7d708fc81464ec55de7c518b02c6">&#9670;&nbsp;</a></span>stasis_publish_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_publish_sync </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish a message to a topic's subscribers, synchronizing on the specified subscriber. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>Subscription to synchronize on. </td></tr>
    <tr><td class="paramname">message</td><td>Message to publish.</td></tr>
  </table>
  </dd>
</dl>
<p>The caller of stasis_publish_sync will block until the specified subscriber completes handling of the message.</p>
<p>All other subscribers to the topic the stasis_subpscription is subscribed to are also delivered the message; this delivery however happens asynchronously.</p>
<dl class="section since"><dt>Since</dt><dd>12.1.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01516">1516</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01432">publish_msg()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00685">stasis_subscription::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00471">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00288">stasis_message_router_publish_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;{</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(sub != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#a95001d504d94709275db7e173ce31b43">publish_msg</a>(sub-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, message, sub);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;}</div><div class="ttc" id="structstasis__subscription_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">stasis_subscription::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00685">stasis.c:685</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8c_html_a95001d504d94709275db7e173ce31b43"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a95001d504d94709275db7e173ce31b43">publish_msg</a></div><div class="ttdeci">static void publish_msg(struct stasis_topic *topic, struct stasis_message *message, struct stasis_subscription *sync_sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01432">stasis.c:1432</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf3a92c10ab654d4a7b11cbf44aa1074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf3a92c10ab654d4a7b11cbf44aa1074">&#9670;&nbsp;</a></span>stasis_subscription_accept_formatters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_subscription_accept_formatters </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a>&#160;</td>
          <td class="paramname"><em>formatters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate to a subscription that we are interested in messages with one or more formatters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription to alter. </td></tr>
    <tr><td class="paramname">formatters</td><td>A bitmap of <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> we wish to receive.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.25.0 </dd>
<dd>
16.2.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01095">1095</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00685">stasis_subscription::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02301">AST_TEST_DEFINE()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00420">stasis_message_router_accept_formatters()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00397">stasis_message_router_set_formatters_default()</a>.</p>
<div class="fragment"><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;{</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(subscription != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;   subscription-&gt;accepted_formatters = formatters;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;}</div><div class="ttc" id="structstasis__subscription_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">stasis_subscription::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00685">stasis.c:685</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f248ee5f4791f05d0af8768aaab282b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f248ee5f4791f05d0af8768aaab282b">&#9670;&nbsp;</a></span>stasis_subscription_accept_message_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_subscription_accept_message_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate to a subscription that we are interested in a message type. </p>
<p>This will cause the subscription to allow the given message type to be raised to our subscription callback. This enables internal filtering in the stasis message bus to reduce messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription to add message type to. </td></tr>
    <tr><td class="paramname">type</td><td>The message type we wish to receive. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If you are wanting to use stasis_final_message you will need to accept <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a> as a message type.</dd>
<dd>
Until the subscription is set to selective filtering it is possible for it to receive messages of message types that would not normally be accepted. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">1025</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00109">stasis_message_type_id()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message_type_name()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00299">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00685">stasis_subscription::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01470">acl_change_stasis_subscribe()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l28499">add_peer_mwi_subs()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00230">ast_mwi_subscribe_pool()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01973">ast_res_pjsip_initialize_configuration()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02234">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02791">cc_generic_agent_start_monitoring()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01409">create_new_generic_list()</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00174">create_parked_subscription_full()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l11324">load_module()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08460">load_pbx()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l00140">mwi_stasis_subscription_alloc()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01455">network_change_stasis_subscribe()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00892">park_and_announce_app_exec()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00685">parking_manager_enable_stasis()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00625">refer_blind_callback()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l09346">rtp_reload()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00090">stasis_caching_accept_message_type()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00310">stasis_message_router_add()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00336">stasis_message_router_add_cache_update()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>, <a class="el" href="../../dd/d71/res__stasis__device__state_8c_source.html#l00360">subscribe_device_state()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01588">xmpp_init_event_distribution()</a>.</p>
<div class="fragment"><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;{</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;   <span class="keywordflow">if</span> (!subscription) {</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;   }</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(type != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(type) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   <span class="keywordflow">if</span> (!type || !<a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(type)) {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <span class="comment">/* Filtering is unreliable as this message type is not yet initialized</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">       * so force all messages through.</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      subscription-&gt;filter = <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;subscription-&gt;accepted_message_types, <a class="code" href="../../dd/d79/stasis_8h.html#aaa72759806ee4118a78b9d1373c633d2">stasis_message_type_id</a>(type), 1)) {</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <span class="comment">/* We do this for the same reason as above. The subscription can still operate, so allow</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">       * it to do so by forcing all messages through.</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      subscription-&gt;filter = <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;}</div><div class="ttc" id="stasis_8h_html_aefd78086150c89477f5851f2836e0478"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a></div><div class="ttdeci">const char * stasis_message_type_name(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the name of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message.c:99</a></div></div>
<div class="ttc" id="stasis_8h_html_aaa72759806ee4118a78b9d1373c633d2"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aaa72759806ee4118a78b9d1373c633d2">stasis_message_type_id</a></div><div class="ttdeci">int stasis_message_type_id(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the id of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00109">stasis_message.c:109</a></div></div>
<div class="ttc" id="structstasis__subscription_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">stasis_subscription::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00685">stasis.c:685</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00299">stasis.h:299</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a613709cd56550431a4ed3c45e59b72a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a613709cd56550431a4ed3c45e59b72a3">&#9670;&nbsp;</a></span>stasis_subscription_cb_noop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_subscription_cb_noop </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stasis subscription callback function that does nothing. </p>
<dl class="section note"><dt>Note</dt><dd>This callback should be used for events are not directly processed, but need to be generated so data can be retrieved from cache later. Subscriptions with this callback can be released with <a class="el" href="../../d0/df4/stasis_8c.html#ab9864d12ae0d2cca19740b90ee3109e9">stasis_unsubscribe</a>, even during module unload.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>13.5 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00811">811</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/dd6/chan__mgcp_8c_source.html#l04016">build_gateway()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l12794">build_peer()</a>, and <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l12095">mkintf()</a>.</p>
<div class="fragment"><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;{</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a223dba20686ad9d48d9ea8329984f14b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a223dba20686ad9d48d9ea8329984f14b">&#9670;&nbsp;</a></span>stasis_subscription_decline_message_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_subscription_decline_message_type </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate to a subscription that we are not interested in a message type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription to remove message type from. </td></tr>
    <tr><td class="paramname">type</td><td>The message type we don't wish to receive. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01055">1055</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00109">stasis_message_type_id()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message_type_name()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00685">stasis_subscription::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02234">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;{</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <span class="keywordflow">if</span> (!subscription) {</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;   }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(type != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(type) != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   <span class="keywordflow">if</span> (!type || !<a class="code" href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a>(type)) {</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;   }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#aaa72759806ee4118a78b9d1373c633d2">stasis_message_type_id</a>(type) &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;subscription-&gt;accepted_message_types)) {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="comment">/* The memory is already allocated so this can&#39;t fail */</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;subscription-&gt;accepted_message_types, <a class="code" href="../../dd/d79/stasis_8h.html#aaa72759806ee4118a78b9d1373c633d2">stasis_message_type_id</a>(type), 0);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;   }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;}</div><div class="ttc" id="stasis_8h_html_aefd78086150c89477f5851f2836e0478"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aefd78086150c89477f5851f2836e0478">stasis_message_type_name</a></div><div class="ttdeci">const char * stasis_message_type_name(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the name of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00099">stasis_message.c:99</a></div></div>
<div class="ttc" id="stasis_8h_html_aaa72759806ee4118a78b9d1373c633d2"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aaa72759806ee4118a78b9d1373c633d2">stasis_message_type_id</a></div><div class="ttdeci">int stasis_message_type_id(const struct stasis_message_type *type)</div><div class="ttdoc">Gets the id of a given message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00109">stasis_message.c:109</a></div></div>
<div class="ttc" id="structstasis__subscription_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">stasis_subscription::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00685">stasis.c:685</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a839350445aaa51cedf31f6daec933ee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a839350445aaa51cedf31f6daec933ee0">&#9670;&nbsp;</a></span>stasis_subscription_final_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_subscription_final_message </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine whether a message is the final message to be received on a subscription. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>Subscription on which the message was received. </td></tr>
    <tr><td class="paramname">msg</td><td>Message to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>zero if the provided message is not the final message. </dd>
<dd>
non-zero if the provided message is the final message. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01176">1176</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d79/stasis_8h_source.html#l00895">stasis_subscription_change::description</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01171">stasis_subscription_uniqueid()</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l00894">stasis_subscription_change::uniqueid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00832">bridge_subscription_change_handler()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00204">consumer_exec()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00226">consumer_exec_sync()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00451">consumer_finalize()</a>, <a class="el" href="../../d0/dff/res__chan__stats_8c_source.html#l00130">default_route()</a>, <a class="el" href="../../dd/d71/res__stasis__device__state_8c_source.html#l00301">device_state_cb()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01314">dispatch_message()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00203">endpoint_subscription_change()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02761">generic_agent_devstate_cb()</a>, <a class="el" href="../../da/dca/res__stasis__test_8c_source.html#l00108">message_sink_cb()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l17528">mwi_event_cb()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01156">mwi_stasis_cb()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00859">park_announce_update_cb()</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00158">parker_update_cb()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06261">queue_bridge_cb()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06489">queue_channel_cb()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00181">refer_progress_bridge()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00191">router_dispatch()</a>, <a class="el" href="../../d0/dff/res__chan__stats_8c_source.html#l00057">statsmaker()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00337">sub_subscription_change_handler()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00756">subscription_invoke()</a>.</p>
<div class="fragment"><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;{</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d43/structstasis__subscription__change.html">stasis_subscription_change</a> *change;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(msg) != <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>()) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;   }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;   change = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(msg);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;   <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;Unsubscribe&quot;</span>, change-&gt;<a class="code" href="../../d5/d43/structstasis__subscription__change.html#a148e968cb2e6176288982274dab428c3">description</a>)) {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;   }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;   <span class="keywordflow">if</span> (strcmp(<a class="code" href="../../d0/df4/stasis_8c.html#a86a7ba1f3c93ba7ee7583a0d8595025d">stasis_subscription_uniqueid</a>(sub), change-&gt;<a class="code" href="../../d5/d43/structstasis__subscription__change.html#ace8710cd56677f85900cab7dca29b82c">uniqueid</a>)) {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;}</div><div class="ttc" id="stasis_8c_html_a86a7ba1f3c93ba7ee7583a0d8595025d"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a86a7ba1f3c93ba7ee7583a0d8595025d">stasis_subscription_uniqueid</a></div><div class="ttdeci">const char * stasis_subscription_uniqueid(const struct stasis_subscription *sub)</div><div class="ttdoc">Get the unique ID for the subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01171">stasis.c:1171</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="structstasis__subscription__change_html_ace8710cd56677f85900cab7dca29b82c"><div class="ttname"><a href="../../d5/d43/structstasis__subscription__change.html#ace8710cd56677f85900cab7dca29b82c">stasis_subscription_change::uniqueid</a></div><div class="ttdeci">char * uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00894">stasis.h:894</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="structstasis__subscription__change_html"><div class="ttname"><a href="../../d5/d43/structstasis__subscription__change.html">stasis_subscription_change</a></div><div class="ttdoc">Holds details about changes to subscriptions for the specified topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00892">stasis.h:892</a></div></div>
<div class="ttc" id="structstasis__subscription__change_html_a148e968cb2e6176288982274dab428c3"><div class="ttname"><a href="../../d5/d43/structstasis__subscription__change.html#a148e968cb2e6176288982274dab428c3">stasis_subscription_change::description</a></div><div class="ttdeci">char description[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00895">stasis.h:895</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04c69c471e1b836539f280b80b0000de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04c69c471e1b836539f280b80b0000de">&#9670;&nbsp;</a></span>stasis_subscription_is_done()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_subscription_is_done </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether <em>subscription</em> has received its final message. </p>
<p>Note that a subscription is considered done even while the <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a> is being processed. This allows cleanup routines to check the status of the subscription.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True (non-zero) if <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a> has been received. </dd>
<dd>
False (zero) if waiting for the end. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01120">1120</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00697">stasis_subscription::final_message_rxed</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00142">router_dtor()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00062">stasis_caching_topic_dtor()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00278">stasis_message_router_is_done()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00715">subscription_dtor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;{</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;   <span class="keywordflow">if</span> (subscription) {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(subscription);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      ret = subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a09021779b74a40d962db94f3910215d7">final_message_rxed</a>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(subscription);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;   }</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;   <span class="comment">/* Null subscription is about as done as you can get */</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structstasis__subscription_html_a09021779b74a40d962db94f3910215d7"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a09021779b74a40d962db94f3910215d7">stasis_subscription::final_message_rxed</a></div><div class="ttdeci">int final_message_rxed</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00697">stasis.c:697</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd5bedbb2212956dac77be47dceef510"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5bedbb2212956dac77be47dceef510">&#9670;&nbsp;</a></span>stasis_subscription_is_subscribed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_subscription_is_subscribed </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether a subscription is currently subscribed. </p>
<p>Note that there may still be messages queued up to be dispatched to this subscription, but the <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a> has been enqueued.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>Subscription to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>False (zero) if subscription is not subscribed. </dd>
<dd>
True (non-zero) if still subscribed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01152">1152</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l00240">sub</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00685">stasis_subscription::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00173">asterisk_publisher_devstate_cb()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00232">asterisk_publisher_mwistate_cb()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00142">router_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01648">send_subscription_subscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01676">send_subscription_unsubscribe()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00062">stasis_caching_topic_dtor()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00119">stasis_caching_unsubscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00715">subscription_dtor()</a>, <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01364">xmpp_pubsub_devstate_cb()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01336">xmpp_pubsub_mwi_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;{</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;   <span class="keywordflow">if</span> (sub) {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordtype">size_t</span> i;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic = sub-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(topic);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;topic-&gt;subscribers); ++i) {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;topic-&gt;subscribers, i) == <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>) {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(topic);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;         }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      }</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(topic);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;   }</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div><div class="ttc" id="structstasis__subscription_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">stasis_subscription::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00685">stasis.c:685</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a68a963557189666f5d733bfb9a826e41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68a963557189666f5d733bfb9a826e41">&#9670;&nbsp;</a></span>stasis_subscription_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_subscription_join </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Block until the last message is processed on a subscription. </p>
<p>This function will not return until the <em>subscription's</em> callback for the <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a> completes. This allows cleanup routines to run before unblocking the joining thread.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription to block on. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01107">1107</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00476">ao2_object_get_lockaddr()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00203">ast_cond_wait</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00700">stasis_subscription::final_message_processed</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00694">stasis_subscription::join_cond</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00146">stasis_caching_unsubscribe_and_join()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">stasis_unsubscribe_and_join()</a>.</p>
<div class="fragment"><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;{</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <span class="keywordflow">if</span> (subscription) {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(subscription);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="comment">/* Wait until the processed flag has been set */</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">while</span> (!subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#acfba3a8a57e0ab524b78b3734df9043e">final_message_processed</a>) {</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a>(&amp;subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a23bbead00056908b13511b20fd390bf6">join_cond</a>,</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a>(subscription));</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(subscription);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;   }</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}</div><div class="ttc" id="structstasis__subscription_html_a23bbead00056908b13511b20fd390bf6"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a23bbead00056908b13511b20fd390bf6">stasis_subscription::join_cond</a></div><div class="ttdeci">ast_cond_t join_cond</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00694">stasis.c:694</a></div></div>
<div class="ttc" id="lock_8h_html_a36233c5520173c095bf732a788356aee"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a></div><div class="ttdeci">#define ast_cond_wait(cond, mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00203">lock.h:203</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="structstasis__subscription_html_acfba3a8a57e0ab524b78b3734df9043e"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#acfba3a8a57e0ab524b78b3734df9043e">stasis_subscription::final_message_processed</a></div><div class="ttdeci">int final_message_processed</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00700">stasis.c:700</a></div></div>
<div class="ttc" id="astobj2_8h_html_a503b6c7ced96f9b56ec59c115cbeb29a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a></div><div class="ttdeci">void * ao2_object_get_lockaddr(void *obj)</div><div class="ttdoc">Return the mutex lock address of an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00476">astobj2.c:476</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d95cf98ebb8880cc602c801a639888e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d95cf98ebb8880cc602c801a639888e">&#9670;&nbsp;</a></span>stasis_subscription_set_congestion_limits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_subscription_set_congestion_limits </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>low_water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>high_water</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the high and low alert water marks of the stasis subscription. </p>
<dl class="section since"><dt>Since</dt><dd>13.10.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Pointer to a stasis subscription </td></tr>
    <tr><td class="paramname">low_water</td><td>New queue low water mark. (-1 to set as 90% of high_water) </td></tr>
    <tr><td class="paramname">high_water</td><td>New queue high water mark.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on error (water marks not changed). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01013">1013</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l00830">ast_taskprocessor_alert_set_levels()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00687">stasis_subscription::mailbox</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00298">stasis_message_router_set_congestion_limits()</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;{</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   <span class="keywordflow">if</span> (subscription) {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      res = <a class="code" href="../../d0/d1e/taskprocessor_8h.html#ad4d9150df7126ae11064d38c755d0813">ast_taskprocessor_alert_set_levels</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#aa4d485b7c131a7229ae4f1054b2f506d">mailbox</a>,</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;         low_water, high_water);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}</div><div class="ttc" id="taskprocessor_8h_html_ad4d9150df7126ae11064d38c755d0813"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ad4d9150df7126ae11064d38c755d0813">ast_taskprocessor_alert_set_levels</a></div><div class="ttdeci">int ast_taskprocessor_alert_set_levels(struct ast_taskprocessor *tps, long low_water, long high_water)</div><div class="ttdoc">Set the high and low alert water marks of the given taskprocessor queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l00830">taskprocessor.c:830</a></div></div>
<div class="ttc" id="structstasis__subscription_html_aa4d485b7c131a7229ae4f1054b2f506d"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#aa4d485b7c131a7229ae4f1054b2f506d">stasis_subscription::mailbox</a></div><div class="ttdeci">struct ast_taskprocessor * mailbox</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00687">stasis.c:687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a52b5393bef89d7781c0d039d6489de23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52b5393bef89d7781c0d039d6489de23">&#9670;&nbsp;</a></span>stasis_subscription_set_filter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_subscription_set_filter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891">stasis_subscription_message_filter</a>&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the message type filtering level on a subscription. </p>
<p>This will cause the subscription to filter messages according to the provided filter level. For example if selective is used then only messages matching those provided to <a class="el" href="../../d0/df4/stasis_8c.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a> will be raised to the subscription callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription that should receive all messages. </td></tr>
    <tr><td class="paramname">filter</td><td>What filter to use </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">1079</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l00709">filter()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00299">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00685">stasis_subscription::topic</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01470">acl_change_stasis_subscribe()</a>, <a class="el" href="../../d6/db4/mwi_8c_source.html#l00230">ast_mwi_subscribe_pool()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l01973">ast_res_pjsip_initialize_configuration()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02234">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00322">asterisk_start_devicestate_publishing()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00401">asterisk_start_mwi_publishing()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02791">cc_generic_agent_start_monitoring()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01409">create_new_generic_list()</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00174">create_parked_subscription_full()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l11324">load_module()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l08460">load_pbx()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01455">network_change_stasis_subscribe()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00892">park_and_announce_app_exec()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00685">parking_manager_enable_stasis()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00625">refer_blind_callback()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l09346">rtp_reload()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00109">stasis_caching_set_filter()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00310">stasis_message_router_add()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00336">stasis_message_router_add_cache_update()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00397">stasis_message_router_set_formatters_default()</a>, <a class="el" href="../../dd/d71/res__stasis__device__state_8c_source.html#l00360">subscribe_device_state()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01588">xmpp_init_event_distribution()</a>.</p>
<div class="fragment"><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;{</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   <span class="keywordflow">if</span> (!subscription) {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;   }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   <span class="keywordflow">if</span> (subscription-&gt;filter != <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>) {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      subscription-&gt;filter = <a class="code" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;   }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(subscription-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">topic</a>);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;}</div><div class="ttc" id="structstasis__subscription_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#a136460a7868b48ef576c0fa505ef96db">stasis_subscription::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00685">stasis.c:685</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00299">stasis.h:299</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="func__strings_8c_html_af2deb3c7b0d3bdd442bb9ada5fda3d17"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a></div><div class="ttdeci">static int filter(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00709">func_strings.c:709</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86a7ba1f3c93ba7ee7583a0d8595025d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86a7ba1f3c93ba7ee7583a0d8595025d">&#9670;&nbsp;</a></span>stasis_subscription_uniqueid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* stasis_subscription_uniqueid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the unique ID for the subscription. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>Subscription for which to get the unique ID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Unique ID for the subscription. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01171">1171</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l00683">stasis_subscription::uniqueid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00314">AST_TEST_DEFINE()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01176">stasis_subscription_final_message()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01203">topic_add_subscription()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01231">topic_remove_subscription()</a>.</p>
<div class="fragment"><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;{</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;   <span class="keywordflow">return</span> sub-&gt;<a class="code" href="../../d9/de4/structstasis__subscription.html#ace8710cd56677f85900cab7dca29b82c">uniqueid</a>;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;}</div><div class="ttc" id="structstasis__subscription_html_ace8710cd56677f85900cab7dca29b82c"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html#ace8710cd56677f85900cab7dca29b82c">stasis_subscription::uniqueid</a></div><div class="ttdeci">char * uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00683">stasis.c:683</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acac26206b971b094c90839b4049cb6cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac26206b971b094c90839b4049cb6cc">&#9670;&nbsp;</a></span>stasis_topic_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_topic_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the new topic. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New topic instance. </dd>
<dd>
<code>NULL</code> on error. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="section note"><dt>Note</dt><dd>There is no explicit ability to unsubscribe all subscribers from a topic and destroy it. As a result the topic can persist until the last subscriber unsubscribes itself even if there is no publisher.</dd>
<dd>
Topic names should be in the form of &lt;subsystem&gt;:&lt;functionality&gt;[/&lt;object&gt;] </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="../../d4/dca/_2usr_2src_2asterisk-18_85_80_2main_2app_8c-example.html#a460">/usr/src/asterisk-18.5.0/main/app.c</a>.</dd>
</dl>
<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">618</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l00569">stasis_topic_create_with_detail()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d10/manager_8c_source.html#l09144">__init_manager()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00915">app_create()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l03205">app_init()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01527">ast_channel_internal_setup_topics()</a>, <a class="el" href="../../d3/d2a/parking_8c_source.html#l00053">ast_parking_stasis_init()</a>, <a class="el" href="../../d5/d07/presencestate_8c_source.html#l00495">ast_presence_state_engine_init()</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l03622">ast_rtp_engine_init()</a>, <a class="el" href="../../d8/d30/main_2security__events_8c_source.html#l00483">ast_security_stasis_init()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l01407">ast_stasis_bridging_init()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l01666">ast_stasis_channels_init()</a>, <a class="el" href="../../df/da0/stasis__system_8c_source.html#l00373">ast_stasis_system_init()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00314">AST_TEST_DEFINE()</a>, <a class="el" href="../../d8/db9/test_8c_source.html#l01221">ast_test_init()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02154">create_cts()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01454">create_subscriptions()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04522">load_module()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00948">stasis_caching_topic_create()</a>, <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00065">stasis_cp_all_create()</a>, <a class="el" href="../../dc/d1c/stasis__cache__pattern_8c_source.html#l00162">stasis_cp_sink_create()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00324">stasis_state_manager_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01884">stasis_topic_pool_get_topic()</a>, and <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/df4/stasis_8c.html#a6b49e1209c8280ab73a25585068b04cc">stasis_topic_create_with_detail</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div><div class="ttc" id="stasis_8c_html_a6b49e1209c8280ab73a25585068b04cc"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a6b49e1209c8280ab73a25585068b04cc">stasis_topic_create_with_detail</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create_with_detail(const char *name, const char *detail)</div><div class="ttdoc">Create a new topic with given detail. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00569">stasis.c:569</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b49e1209c8280ab73a25585068b04cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b49e1209c8280ab73a25585068b04cc">&#9670;&nbsp;</a></span>stasis_topic_create_with_detail()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_topic_create_with_detail </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>detail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new topic with given detail. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the new topic. </td></tr>
    <tr><td class="paramname">detail</td><td>Detail description of the new topic. i.e. "Queue main topic for subscribing every queue event" </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New topic instance. </dd>
<dd>
<code>NULL</code> on error.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>There is no explicit ability to unsubscribe all subscribers from a topic and destroy it. As a result the topic can persist until the last subscriber unsubscribes itself even if there is no publisher. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00569">569</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00409">ao2_t_alloc</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00302">INITIAL_SUBSCRIBERS_MAX</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00501">link_topic_proxy()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00623">stasis_topic_get()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00472">stasis_topic_statistics_create()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00434">topic_dtor()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>.</p>
<div class="fragment"><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;{</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>|| !strlen(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) || !detail) {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Creating topic. name: %s, detail: %s\n&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, detail);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   topic = <a class="code" href="../../d0/df4/stasis_8c.html#a02f065d129b21343b13a9eeb1c740771">stasis_topic_get</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="keywordflow">if</span> (topic) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(2, <span class="stringliteral">&quot;Topic is already exist. name: %s, detail: %s\n&quot;</span>,</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, detail);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">return</span> topic;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   topic = <a class="code" href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a>(<span class="keyword">sizeof</span>(*topic), <a class="code" href="../../d0/df4/stasis_8c.html#a5452a83caf693562327d1b86c5748703">topic_dtor</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="keywordflow">if</span> (!topic) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   res |= <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;topic-&gt;subscribers, <a class="code" href="../../d0/df4/stasis_8c.html#a1a7335532b05804a34da6dead8e50a9d">INITIAL_SUBSCRIBERS_MAX</a>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   res |= <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;topic-&gt;upstream_topics, 0);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(topic, -1);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   <span class="comment">/* link to the proxy */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/df4/stasis_8c.html#a786a897527c7c44864c2c9f289a90c73">link_topic_proxy</a>(topic, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, detail)) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(topic, -1);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="preprocessor">#ifdef AST_DEVMODE</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   topic-&gt;statistics = <a class="code" href="../../d0/df4/stasis_8c.html#a4bad26ce576a9d2ed0a1116ed10ee730">stasis_topic_statistics_create</a>(topic);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <span class="keywordflow">if</span> (!topic-&gt;statistics) {</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(topic, -1);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Topic &#39;%s&#39;: %p created\n&quot;</span>, topic-&gt;name, topic);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="keywordflow">return</span> topic;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad57326008c326db88dc36779741622b8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a></div><div class="ttdeci">#define ao2_t_alloc(data_size, destructor_fn, debug_msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00409">astobj2.h:409</a></div></div>
<div class="ttc" id="stasis_8c_html_a5452a83caf693562327d1b86c5748703"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a5452a83caf693562327d1b86c5748703">topic_dtor</a></div><div class="ttdeci">static void topic_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00434">stasis.c:434</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="stasis_8c_html_a786a897527c7c44864c2c9f289a90c73"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a786a897527c7c44864c2c9f289a90c73">link_topic_proxy</a></div><div class="ttdeci">static int link_topic_proxy(struct stasis_topic *topic, const char *name, const char *detail)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00501">stasis.c:501</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="stasis_8c_html_a4bad26ce576a9d2ed0a1116ed10ee730"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a4bad26ce576a9d2ed0a1116ed10ee730">stasis_topic_statistics_create</a></div><div class="ttdeci">static struct stasis_topic_statistics * stasis_topic_statistics_create(struct stasis_topic *topic)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00472">stasis.c:472</a></div></div>
<div class="ttc" id="stasis_8c_html_a1a7335532b05804a34da6dead8e50a9d"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a1a7335532b05804a34da6dead8e50a9d">INITIAL_SUBSCRIBERS_MAX</a></div><div class="ttdeci">#define INITIAL_SUBSCRIBERS_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00302">stasis.c:302</a></div></div>
<div class="ttc" id="stasis_8c_html_a02f065d129b21343b13a9eeb1c740771"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a02f065d129b21343b13a9eeb1c740771">stasis_topic_get</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_get(const char *name)</div><div class="ttdoc">Get a topic of the given name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00623">stasis.c:623</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e5e4d29943a4dd27300887dc88ece28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e5e4d29943a4dd27300887dc88ece28">&#9670;&nbsp;</a></span>stasis_topic_detail()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* stasis_topic_detail </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the detail of a topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Detail of the topic. </dd>
<dd>
<code>NULL</code> if topic is <code>NULL</code>. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00636">636</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>
<div class="fragment"><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;{</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <span class="keywordflow">if</span> (!topic) {</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="keywordflow">return</span> topic-&gt;detail;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02f065d129b21343b13a9eeb1c740771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02f065d129b21343b13a9eeb1c740771">&#9670;&nbsp;</a></span>stasis_topic_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_topic_get </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a topic of the given name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Topic's name. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of the topic. </dd>
<dd>
<code>NULL</code> on error or not exist.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This SHOULD NOT be used in normal operation for publishing messages. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00623">623</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01768">ao2_weakproxy_find</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/df4/stasis_8c_source.html#l00501">link_topic_proxy()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l02417">stasis_show_topic()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00569">stasis_topic_create_with_detail()</a>.</p>
<div class="fragment"><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;{</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#aa78a383f537bc7a35efb8eaabcdc44e9">ao2_weakproxy_find</a>(<a class="code" href="../../d0/df4/stasis_8c.html#ae14b5f72d5278c2e22621748fba0610b">topic_all</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="stasis_8c_html_ae14b5f72d5278c2e22621748fba0610b"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ae14b5f72d5278c2e22621748fba0610b">topic_all</a></div><div class="ttdeci">struct ao2_container * topic_all</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00396">stasis.c:396</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa78a383f537bc7a35efb8eaabcdc44e9"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa78a383f537bc7a35efb8eaabcdc44e9">ao2_weakproxy_find</a></div><div class="ttdeci">#define ao2_weakproxy_find(c, arg, flags, tag)</div><div class="ttdoc">Perform an ao2_find on a container with ao2_weakproxy objects, returning the real object...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01768">astobj2.h:1768</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af23deee342575033bc73311b1215d886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af23deee342575033bc73311b1215d886">&#9670;&nbsp;</a></span>stasis_topic_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* stasis_topic_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the name of a topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Name of the topic. </dd>
<dd>
<code>NULL</code> if topic is <code>NULL</code>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">628</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00319">bridge_topics_destroy()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00858">internal_stasis_subscribe()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00948">stasis_caching_topic_create()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00062">stasis_caching_topic_dtor()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00531">stasis_state_add_publisher()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00412">stasis_state_add_subscriber()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00324">stasis_state_manager_create()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00446">stasis_state_subscribe_pool()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01833">stasis_topic_pool_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01864">stasis_topic_pool_delete_topic()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01884">stasis_topic_pool_get_topic()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00167">state_alloc()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00104">state_id_by_topic()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00292">state_manager_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01203">topic_add_subscription()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01744">topic_pool_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01784">topic_pool_entry_cmp()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01231">topic_remove_subscription()</a>.</p>
<div class="fragment"><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;{</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="keywordflow">if</span> (!topic) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   <span class="keywordflow">return</span> topic-&gt;name;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeb9a69946c2be89329630328f125330d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb9a69946c2be89329630328f125330d">&#9670;&nbsp;</a></span>stasis_topic_pool_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a>* stasis_topic_pool_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>pooled_topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a topic pool that routes messages from dynamically generated topics to the given topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pooled_topic</td><td>Topic to which messages will be routed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the new <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> </dd>
<dd>
<code>NULL</code> on failure </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="../../d4/dca/_2usr_2src_2asterisk-18_85_80_2main_2app_8c-example.html#a461">/usr/src/asterisk-18.5.0/main/app.c</a>.</dd>
</dl>
<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01833">1833</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00958">ao2_container_register()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">pool</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01740">stasis_topic_pool::pool_container</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01741">stasis_topic_pool::pool_topic</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00305">TOPIC_POOL_BUCKETS</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01744">topic_pool_dtor()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01784">topic_pool_entry_cmp()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01763">topic_pool_entry_hash()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d83/main_2app_8c_source.html#l03205">app_init()</a>, <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l01407">ast_stasis_bridging_init()</a>, and <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00898">devstate_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;{</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;   pool = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*pool), <a class="code" href="../../d0/df4/stasis_8c.html#a48c5592db184a6f1d2055845a0bd94aa">topic_pool_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;   <span class="keywordflow">if</span> (!pool) {</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;   }</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;   pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;      <a class="code" href="../../d0/df4/stasis_8c.html#a551da25f7ccf7648107004ad73424064">TOPIC_POOL_BUCKETS</a>, <a class="code" href="../../d0/df4/stasis_8c.html#a6e61da6e3b66f39e64e8de751c3867c0">topic_pool_entry_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d0/df4/stasis_8c.html#a669f6c3dbec7c74b97b5b388bfa999c3">topic_pool_entry_cmp</a>);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;   <span class="keywordflow">if</span> (!pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a>) {</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(pool);</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;   }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="preprocessor">#ifdef AO2_DEBUG</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   {</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keywordtype">char</span> *container_name =</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(strlen(<a class="code" href="../../d0/df4/stasis_8c.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(pooled_topic)) + strlen(<span class="stringliteral">&quot;-pool&quot;</span>) + 1);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      sprintf(container_name, <span class="stringliteral">&quot;%s-pool&quot;</span>, <a class="code" href="../../d0/df4/stasis_8c.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(pooled_topic));</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a>(container_name, pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a>, topic_pool_prnt_obj);</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;   }</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(pooled_topic, +1);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;   pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a4d4893d86a646368c7187e1d2540241a">pool_topic</a> = pooled_topic;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="stasis_8c_html_a551da25f7ccf7648107004ad73424064"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a551da25f7ccf7648107004ad73424064">TOPIC_POOL_BUCKETS</a></div><div class="ttdeci">#define TOPIC_POOL_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00305">stasis.c:305</a></div></div>
<div class="ttc" id="stasis_8c_html_a48c5592db184a6f1d2055845a0bd94aa"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a48c5592db184a6f1d2055845a0bd94aa">topic_pool_dtor</a></div><div class="ttdeci">static void topic_pool_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01744">stasis.c:1744</a></div></div>
<div class="ttc" id="stasis_8c_html_a669f6c3dbec7c74b97b5b388bfa999c3"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a669f6c3dbec7c74b97b5b388bfa999c3">topic_pool_entry_cmp</a></div><div class="ttdeci">static int topic_pool_entry_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01784">stasis.c:1784</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html_a1c800fe69edb831327a694a01d61af71"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">stasis_topic_pool::pool_container</a></div><div class="ttdeci">struct ao2_container * pool_container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01740">stasis.c:1740</a></div></div>
<div class="ttc" id="stasis_8c_html_a6e61da6e3b66f39e64e8de751c3867c0"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a6e61da6e3b66f39e64e8de751c3867c0">topic_pool_entry_hash</a></div><div class="ttdeci">static int topic_pool_entry_hash(const void *obj, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01763">stasis.c:1763</a></div></div>
<div class="ttc" id="astobj2_8h_html_abdb952d2373503555d96f02f130c5770"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#abdb952d2373503555d96f02f130c5770">ao2_container_register</a></div><div class="ttdeci">int ao2_container_register(const char *name, struct ao2_container *self, ao2_prnt_obj_fn *prnt_obj)</div><div class="ttdoc">Register a container for CLI stats and integrity check. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00958">astobj2_container.c:958</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8c_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01739">stasis.c:1739</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html_a4d4893d86a646368c7187e1d2540241a"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html#a4d4893d86a646368c7187e1d2540241a">stasis_topic_pool::pool_topic</a></div><div class="ttdeci">struct stasis_topic * pool_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01741">stasis.c:1741</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dfabff07a77d235b2b16d2b564f5c4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dfabff07a77d235b2b16d2b564f5c4b">&#9670;&nbsp;</a></span>stasis_topic_pool_delete_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_topic_pool_delete_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a topic from the topic pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>Pool from which to delete the topic </td></tr>
    <tr><td class="paramname">topic_name</td><td>Name of the topic to delete in the form of &lt;pool_topic_name&gt;/&lt;topic_name&gt; or just &lt;topic_name&gt;</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.24 </dd>
<dd>
15.6 </dd>
<dd>
16.1 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01864">1864</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01740">stasis_topic_pool::pool_container</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01741">stasis_topic_pool::pool_topic</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00319">bridge_topics_destroy()</a>.</p>
<div class="fragment"><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;{</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">    * The topic_name passed in could be a fully-qualified name like &lt;pool_topic_name&gt;/&lt;topic_name&gt;</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">    * or just &lt;topic_name&gt;.  If it&#39;s fully qualified, we need to skip past &lt;pool_topic_name&gt;</span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">    * name and search only on &lt;topic_name&gt;.</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *pool_topic_name = <a class="code" href="../../d0/df4/stasis_8c.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a4d4893d86a646368c7187e1d2540241a">pool_topic</a>);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;   <span class="keywordtype">int</span> pool_topic_name_len = strlen(pool_topic_name);</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *search_topic_name;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;   <span class="keywordflow">if</span> (strncmp(pool_topic_name, topic_name, pool_topic_name_len) == 0) {</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      search_topic_name = topic_name + pool_topic_name_len + 1;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      search_topic_name = topic_name;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;   }</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a>, search_topic_name, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a>);</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html_a1c800fe69edb831327a694a01d61af71"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">stasis_topic_pool::pool_container</a></div><div class="ttdeci">struct ao2_container * pool_container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01740">stasis.c:1740</a></div></div>
<div class="ttc" id="stasis_8c_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html_a4d4893d86a646368c7187e1d2540241a"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html#a4d4893d86a646368c7187e1d2540241a">stasis_topic_pool::pool_topic</a></div><div class="ttdeci">struct stasis_topic * pool_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01741">stasis.c:1741</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ee1df597af46f3b489cce002b604a89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ee1df597af46f3b489cce002b604a89">&#9670;&nbsp;</a></span>stasis_topic_pool_get_topic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a>* stasis_topic_pool_get_topic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find or create a topic in the pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>Pool for which to get the topic </td></tr>
    <tr><td class="paramname">topic_name</td><td>Name of the topic to get </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The already stored or newly allocated topic </dd>
<dd>
<code>NULL</code> if the topic was not found and could not be allocated </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="../../d4/dca/_2usr_2src_2asterisk-18_85_80_2main_2app_8c-example.html#a456">/usr/src/asterisk-18.5.0/main/app.c</a>.</dd>
</dl>
<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01884">1884</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01710">topic_pool_entry::forward</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01740">stasis_topic_pool::pool_container</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01741">stasis_topic_pool::pool_topic</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00602">SCOPED_AO2LOCK</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01578">stasis_forward_all()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00618">stasis_topic_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01711">topic_pool_entry::topic</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01724">topic_pool_entry_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00683">ast_device_state_topic()</a>, <a class="el" href="../../d3/d83/main_2app_8c_source.html#l03189">ast_queue_topic()</a>, and <a class="el" href="../../da/d0f/stasis__bridges_8c_source.html#l00295">bridge_topics_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;{</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a> *, <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(topic_container_lock, pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a>);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;   <span class="keywordtype">char</span> *new_topic_name;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;   <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a>, topic_name, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>) {</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>-&gt;<a class="code" href="../../dc/d12/structtopic__pool__entry.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;   }</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;   <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a> = <a class="code" href="../../d0/df4/stasis_8c.html#a31134d792ae64e6f21060b8e7ffd49fc">topic_pool_entry_alloc</a>(topic_name);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>) {</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;   }</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   <span class="comment">/* To provide further detail and to ensure that the topic is unique within the scope of the</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">    * system we prefix it with the pooling topic name, which should itself already be unique.</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;   ret = <a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;new_topic_name, <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d0/df4/stasis_8c.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a4d4893d86a646368c7187e1d2540241a">pool_topic</a>), topic_name);</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;   <span class="keywordflow">if</span> (ret &lt; 0) {</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;   }</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>-&gt;<a class="code" href="../../dc/d12/structtopic__pool__entry.html#a136460a7868b48ef576c0fa505ef96db">topic</a> = <a class="code" href="../../d0/df4/stasis_8c.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(new_topic_name);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(new_topic_name);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>-&gt;<a class="code" href="../../dc/d12/structtopic__pool__entry.html#a136460a7868b48ef576c0fa505ef96db">topic</a>) {</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   }</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;   <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>-&gt;<a class="code" href="../../dc/d12/structtopic__pool__entry.html#afd101b3d2cc1eb673b30afb631718b79">forward</a> = <a class="code" href="../../d0/df4/stasis_8c.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a>(<a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>-&gt;<a class="code" href="../../dc/d12/structtopic__pool__entry.html#a136460a7868b48ef576c0fa505ef96db">topic</a>, pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a4d4893d86a646368c7187e1d2540241a">pool_topic</a>);</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>-&gt;<a class="code" href="../../dc/d12/structtopic__pool__entry.html#afd101b3d2cc1eb673b30afb631718b79">forward</a>) {</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;   }</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a>, <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>)) {</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;   }</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>-&gt;<a class="code" href="../../dc/d12/structtopic__pool__entry.html#a136460a7868b48ef576c0fa505ef96db">topic</a>;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;}</div><div class="ttc" id="structtopic__pool__entry_html"><div class="ttname"><a href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01709">stasis.c:1709</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="stasis_8c_html_a31134d792ae64e6f21060b8e7ffd49fc"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a31134d792ae64e6f21060b8e7ffd49fc">topic_pool_entry_alloc</a></div><div class="ttdeci">static struct topic_pool_entry * topic_pool_entry_alloc(const char *topic_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01724">stasis.c:1724</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html_a1c800fe69edb831327a694a01d61af71"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">stasis_topic_pool::pool_container</a></div><div class="ttdeci">struct ao2_container * pool_container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01740">stasis.c:1740</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="stasis_8c_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="stasis_8c_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="structtopic__pool__entry_html_a136460a7868b48ef576c0fa505ef96db"><div class="ttname"><a href="../../dc/d12/structtopic__pool__entry.html#a136460a7868b48ef576c0fa505ef96db">topic_pool_entry::topic</a></div><div class="ttdeci">struct stasis_topic * topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01711">stasis.c:1711</a></div></div>
<div class="ttc" id="lock_8h_html_a2cfb325ed371eb6e629446bac4676e9f"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a></div><div class="ttdeci">#define SCOPED_AO2LOCK(varname, obj)</div><div class="ttdoc">scoped lock specialization for ao2 mutexes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00602">lock.h:602</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html_a4d4893d86a646368c7187e1d2540241a"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html#a4d4893d86a646368c7187e1d2540241a">stasis_topic_pool::pool_topic</a></div><div class="ttdeci">struct stasis_topic * pool_topic</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01741">stasis.c:1741</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structtopic__pool__entry_html_afd101b3d2cc1eb673b30afb631718b79"><div class="ttname"><a href="../../dc/d12/structtopic__pool__entry.html#afd101b3d2cc1eb673b30afb631718b79">topic_pool_entry::forward</a></div><div class="ttdeci">struct stasis_forward * forward</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01710">stasis.c:1710</a></div></div>
<div class="ttc" id="stasis_8c_html_a2513a93567ddc93510f7896b777da119"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a></div><div class="ttdeci">struct stasis_forward * stasis_forward_all(struct stasis_topic *from_topic, struct stasis_topic *to_topic)</div><div class="ttdoc">Create a subscription which forwards all messages from one topic to another. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01578">stasis.c:1578</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a947db1503987a5c215dbc7240800a13d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a947db1503987a5c215dbc7240800a13d">&#9670;&nbsp;</a></span>stasis_topic_pool_topic_exists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_topic_pool_topic_exists </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d1/d65/structstasis__topic__pool.html">stasis_topic_pool</a> *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if a topic exists in a pool. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pool</td><td>Pool to check </td></tr>
    <tr><td class="paramname">topic_name</td><td>Name of the topic to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>exists </td></tr>
    <tr><td class="paramname">0</td><td>does not exist </td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.23.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01927">1927</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01105">OBJ_SEARCH_KEY</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01740">stasis_topic_pool::pool_container</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00709">ast_publish_device_state_full()</a>.</p>
<div class="fragment"><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;{</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a> *<a class="code" href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a>;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;   topic_pool_entry = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(pool-&gt;<a class="code" href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">pool_container</a>, topic_name, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a>);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   <span class="keywordflow">if</span> (!topic_pool_entry) {</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;   }</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(topic_pool_entry, -1);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;}</div><div class="ttc" id="structtopic__pool__entry_html"><div class="ttname"><a href="../../dc/d12/structtopic__pool__entry.html">topic_pool_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01709">stasis.c:1709</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35caa13a6e0771cc457e86f425d95c3b8d54">OBJ_SEARCH_KEY</a></div><div class="ttdoc">The arg parameter is a search key, but is not an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01105">astobj2.h:1105</a></div></div>
<div class="ttc" id="structstasis__topic__pool_html_a1c800fe69edb831327a694a01d61af71"><div class="ttname"><a href="../../d1/d65/structstasis__topic__pool.html#a1c800fe69edb831327a694a01d61af71">stasis_topic_pool::pool_container</a></div><div class="ttdeci">struct ao2_container * pool_container</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01740">stasis.c:1740</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a461ec3c31a2f54d7c001b0ead6c7313d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a461ec3c31a2f54d7c001b0ead6c7313d">&#9670;&nbsp;</a></span>stasis_topic_subscribers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t stasis_topic_subscribers </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the number of subscribers of a topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of subscribers of the topic. </dd></dl>
<dl class="section since"><dt>Since</dt><dd>17.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00644">644</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00833">caching_topic_exec()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01432">publish_msg()</a>.</p>
<div class="fragment"><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;{</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;topic-&gt;subscribers);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div><div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a364abbdbd9de2c0cbc6487d0e8395913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a364abbdbd9de2c0cbc6487d0e8395913">&#9670;&nbsp;</a></span>stasis_topic_uniqueid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* stasis_topic_uniqueid </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the uniqueid of a topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Uniqueid of the topic. </dd>
<dd>
<code>NULL</code> if topic is <code>NULL</code>. </dd></dl>

</div>
</div>
<a id="a3498301077e2005383f0d261c471388b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3498301077e2005383f0d261c471388b">&#9670;&nbsp;</a></span>stasis_unsubscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a>* stasis_unsubscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel a subscription. </p>
<p>Note that in an asynchronous system, there may still be messages queued or in transit to the subscription's callback. These will still be delivered. There will be a final 'SubscriptionCancelled' message, indicating the delivery of the final message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription to cancel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> for convenience </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">973</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01175">ast_taskprocessor_push()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00687">stasis_subscription::mailbox</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01676">send_subscription_unsubscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00966">sub_cleanup()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00685">stasis_subscription::topic</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01231">topic_remove_subscription()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l00314">AST_TEST_DEFINE()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02911">cc_generic_agent_destructor()</a>, <a class="el" href="../../db/d00/test__stasis_8c_source.html#l02145">destroy_cts()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l02761">generic_agent_devstate_cb()</a>, <a class="el" href="../../d3/d5a/ccss_8c_source.html#l01396">generic_monitor_instance_list_destructor()</a>, <a class="el" href="../../d8/d25/res__pjsip__mwi_8c_source.html#l01483">mwi_startup_event_cb()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00892">park_and_announce_app_exec()</a>, <a class="el" href="../../d1/db7/parking__bridge__features_8c_source.html#l00076">parked_subscription_datastore_destroy()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00181">refer_progress_bridge()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00349">refer_progress_destroy()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00297">refer_progress_framehook_destroy()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l35461">startup_event_cb()</a>, <a class="el" href="../../d0/da9/stasis__cache_8c_source.html#l00119">stasis_caching_unsubscribe()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00258">stasis_message_router_unsubscribe()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00470">stasis_state_unsubscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">stasis_unsubscribe_and_join()</a>, <a class="el" href="../../d8/dca/res__pjsip__pubsub_8c_source.html#l01772">subscription_persistence_event_cb()</a>, <a class="el" href="../../d2/dd0/res__mwi__devstate_8c_source.html#l00064">unload_module()</a>, and <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01588">xmpp_init_event_distribution()</a>.</p>
<div class="fragment"><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;{</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <span class="comment">/* The subscription may be the last ref to this topic. Hold</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">    * the topic ref open until after the unlock. */</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>) {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   }</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   topic = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>-&gt;topic);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <span class="comment">/* We have to remove the subscription first, to ensure the unsubscribe</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">    * is the final message */</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/df4/stasis_8c.html#aedcfe63e48121eabbf8ec304cee1d7bd">topic_remove_subscription</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>-&gt;topic, <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>) != 0) {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;         <span class="stringliteral">&quot;Internal error: subscription has invalid topic\n&quot;</span>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(topic);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <span class="comment">/* Now let everyone know about the unsubscribe */</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#a8c683cc9e9e3d1c9ce2f20c97cf69feb">send_subscription_unsubscribe</a>(topic, <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="comment">/* When all that&#39;s done, remove the ref the mailbox has on the sub */</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>-&gt;mailbox) {</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a6b2508ba0a6b8f43ae6d3963f3189585">ast_taskprocessor_push</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>-&gt;mailbox, <a class="code" href="../../d0/df4/stasis_8c.html#a3273b186b9627de5e6eecd8ac8230a41">sub_cleanup</a>, <a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>)) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;         <span class="comment">/* Nothing we can do here, the conditional is just to keep</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">          * the compiler happy that we&#39;re not ignoring the result. */</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      }</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <span class="comment">/* Unsubscribing unrefs the subscription */</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(topic);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;}</div><div class="ttc" id="stasis_8c_html_aedcfe63e48121eabbf8ec304cee1d7bd"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#aedcfe63e48121eabbf8ec304cee1d7bd">topic_remove_subscription</a></div><div class="ttdeci">static int topic_remove_subscription(struct stasis_topic *topic, struct stasis_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01231">stasis.c:1231</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="stasis_8c_html_a3273b186b9627de5e6eecd8ac8230a41"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a3273b186b9627de5e6eecd8ac8230a41">sub_cleanup</a></div><div class="ttdeci">static int sub_cleanup(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00966">stasis.c:966</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="stasis_8c_html_a8c683cc9e9e3d1c9ce2f20c97cf69feb"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a8c683cc9e9e3d1c9ce2f20c97cf69feb">send_subscription_unsubscribe</a></div><div class="ttdeci">static void send_subscription_unsubscribe(struct stasis_topic *topic, struct stasis_subscription *sub)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01676">stasis.c:1676</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a6b2508ba0a6b8f43ae6d3963f3189585"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a6b2508ba0a6b8f43ae6d3963f3189585">ast_taskprocessor_push</a></div><div class="ttdeci">int ast_taskprocessor_push(struct ast_taskprocessor *tps, int(*task_exe)(void *datap), void *datap) attribute_warn_unused_result</div><div class="ttdoc">Push a task into the specified taskprocessor queue and signal the taskprocessor thread. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01175">taskprocessor.c:1175</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a221d05010106dcde0cc2e2b43c1a8b67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a221d05010106dcde0cc2e2b43c1a8b67">&#9670;&nbsp;</a></span>stasis_unsubscribe_and_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a>* stasis_unsubscribe_and_join </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>subscription</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel a subscription, blocking until the last message is processed. </p>
<p>While normally it's recommended to <a class="el" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b" title="Cancel a subscription. ">stasis_unsubscribe()</a> and wait for <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a>, there are times (like during a module unload) where you have to wait for the final message (otherwise you'll call a function in a shared module that no longer exists).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subscription</td><td>Subscription to cancel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>NULL</code> for convenience </dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">1136</a> of file <a class="el" href="../../d0/df4/stasis_8c_source.html">stasis.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01107">stasis_subscription_join()</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">stasis_unsubscribe()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l17573">acl_change_event_stasis_unsubscribe()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01480">acl_change_stasis_unsubscribe()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02219">ast_res_pjsip_destroy_configuration()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00666">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l03528">ast_xmpp_client_disconnect()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00374">asterisk_stop_devicestate_publishing()</a>, <a class="el" href="../../dc/d7a/res__pjsip__publish__asterisk_8c_source.html#l00452">asterisk_stop_mwi_publishing()</a>, <a class="el" href="../../d1/d80/devicestate_8c_source.html#l00881">devstate_cleanup()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01465">network_change_stasis_unsubscribe()</a>, <a class="el" href="../../d0/d39/parking__manager_8c_source.html#l00705">parking_manager_disable_stasis()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00705">presence_change_common()</a>, <a class="el" href="../../dd/d71/res__stasis__device__state_8c_source.html#l00151">remove_device_state_subscription()</a>, <a class="el" href="../../d9/d21/res__rtp__asterisk_8c_source.html#l09346">rtp_reload()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00269">stasis_message_router_unsubscribe_and_join()</a>, <a class="el" href="../../dc/d1d/stasis__state_8c_source.html#l00477">stasis_state_unsubscribe_and_join()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l11250">unload_module()</a>, and <a class="el" href="../../db/d94/pbx_8c_source.html#l08448">unload_pbx()</a>.</p>
<div class="fragment"><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;{</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;   <span class="keywordflow">if</span> (!subscription) {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;   <span class="comment">/* Bump refcount to hold it past the unsubscribe */</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(subscription, +1);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#ab9864d12ae0d2cca19740b90ee3109e9">stasis_unsubscribe</a>(subscription);</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   <a class="code" href="../../d0/df4/stasis_8c.html#a68a963557189666f5d733bfb9a826e41">stasis_subscription_join</a>(subscription);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;   <span class="comment">/* Now decrement the refcount back */</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(subscription);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="stasis_8c_html_ab9864d12ae0d2cca19740b90ee3109e9"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#ab9864d12ae0d2cca19740b90ee3109e9">stasis_unsubscribe</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe(struct stasis_subscription *sub)</div><div class="ttdoc">Cancel a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00973">stasis.c:973</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stasis_8c_html_a68a963557189666f5d733bfb9a826e41"><div class="ttname"><a href="../../d0/df4/stasis_8c.html#a68a963557189666f5d733bfb9a826e41">stasis_subscription_join</a></div><div class="ttdeci">void stasis_subscription_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Block until the last message is processed on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01107">stasis.c:1107</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:49 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
