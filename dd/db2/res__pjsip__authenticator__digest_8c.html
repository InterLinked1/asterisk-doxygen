<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_authenticator_digest.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_pjsip_authenticator_digest.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;pjsip.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">asterisk/res_pjsip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d8c/logger_8h_source.html">asterisk/logger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d90/strings_8h_source.html">asterisk/strings.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_pjsip_authenticator_digest.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d5e/res__pjsip__authenticator__digest_8c__incl.png" border="0" usemap="#res__pjsip__authenticator__digest_8c" alt=""/></div>
<map name="res__pjsip__authenticator__digest_8c" id="res__pjsip__authenticator__digest_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="155,95,239,121"/>
<area shape="rect" id="node23" href="../../d8/d8c/res__pjsip_8h.html" title="asterisk/res_pjsip.h" alt="" coords="1611,95,1755,121"/>
<area shape="rect" id="node34" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1343,393,1469,420"/>
<area shape="rect" id="node39" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="521,393,651,420"/>
<area shape="rect" id="node48" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="578,95,714,121"/>
<area shape="rect" id="node49" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="433,244,547,271"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="203,169,358,196"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="796,543,933,569"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="44,169,179,196"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="207,244,354,271"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1096,617,1239,644"/>
<area shape="rect" id="node28" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="2195,393,2353,420"/>
<area shape="rect" id="node30" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="2329,468,2456,495"/>
<area shape="rect" id="node31" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="1331,244,1478,271"/>
<area shape="rect" id="node35" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1648,543,1799,569"/>
<area shape="rect" id="node36" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1749,244,1887,271"/>
<area shape="rect" id="node40" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1980,319,2131,345"/>
<area shape="rect" id="node41" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="1767,169,1901,196"/>
<area shape="rect" id="node42" href="../../db/dc4/dnsmgr_8h.html" title="Background DNS update manager. " alt="" coords="1231,169,1367,196"/>
<area shape="rect" id="node43" href="../../d5/da1/udptl_8h.html" title="UDPTL support for T.38. " alt="" coords="1623,169,1743,196"/>
<area shape="rect" id="node44" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="1443,169,1599,196"/>
<area shape="rect" id="node45" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1975,169,2165,196"/>
<area shape="rect" id="node46" href="../../d7/d44/stasis__endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="2206,244,2401,271"/>
<area shape="rect" id="node47" href="../../d8/d95/stream_8h.html" title="Media Stream API. " alt="" coords="2377,393,2512,420"/>
<area shape="rect" id="node29" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1994,543,2141,569"/>
<area shape="rect" id="node37" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1603,468,1737,495"/>
<area shape="rect" id="node38" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1447,319,1562,345"/>
<area shape="rect" id="node50" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="433,319,534,345"/>
</map>
</div>
</div>
<p><a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4cd636e6e8acb7f77b7c945a4e2f1b29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a4cd636e6e8acb7f77b7c945a4e2f1b29">MAX_REALM_LENGTH</a>&#160;&#160;&#160;40</td></tr>
<tr class="separator:a4cd636e6e8acb7f77b7c945a4e2f1b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a1cf295633d0179111d9fe2d3b872cb19"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19">digest_verify_result</a> { <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e">AUTH_FAIL</a> = 0, 
<a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02">AUTH_SUCCESS</a>, 
<a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a">AUTH_STALE</a>, 
<a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a">AUTH_NOAUTH</a>
 }<tr class="memdesc:a1cf295633d0179111d9fe2d3b872cb19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result of digest verification.  <a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a1cf295633d0179111d9fe2d3b872cb19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6143b51368f8255b368c4fc2dd95da91"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6143b51368f8255b368c4fc2dd95da91">__init_auth_store</a> (void)</td></tr>
<tr class="memdesc:a6143b51368f8255b368c4fc2dd95da91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread-local storage for <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a>.  <a href="#a6143b51368f8255b368c4fc2dd95da91">More...</a><br /></td></tr>
<tr class="separator:a6143b51368f8255b368c4fc2dd95da91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bd37944adbc585f0099b533f58e15bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3bd37944adbc585f0099b533f58e15bf">AO2_GLOBAL_OBJ_STATIC</a> (entity_id)</td></tr>
<tr class="separator:a3bd37944adbc585f0099b533f58e15bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b1aad6aec7fe404a680f3760cee6bd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad5b1aad6aec7fe404a680f3760cee6bd">auth_store_cleanup</a> (void *data)</td></tr>
<tr class="separator:ad5b1aad6aec7fe404a680f3760cee6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6483e4e89084aad0c779da9da6a15b8b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6483e4e89084aad0c779da9da6a15b8b">build_entity_id</a> (void)</td></tr>
<tr class="separator:a6483e4e89084aad0c779da9da6a15b8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af40fb4b31bbdad0292e0997ab0328c54"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#af40fb4b31bbdad0292e0997ab0328c54">build_nonce</a> (struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **nonce, const char *timestamp, const pjsip_rx_data *rdata, const char *realm)</td></tr>
<tr class="memdesc:af40fb4b31bbdad0292e0997ab0328c54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a nonce.  <a href="#af40fb4b31bbdad0292e0997ab0328c54">More...</a><br /></td></tr>
<tr class="separator:af40fb4b31bbdad0292e0997ab0328c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad920f57db5e8c4e82e415be692af48a8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad920f57db5e8c4e82e415be692af48a8">challenge</a> (const char *realm, pjsip_tx_data *tdata, const pjsip_rx_data *rdata, int is_stale)</td></tr>
<tr class="memdesc:ad920f57db5e8c4e82e415be692af48a8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d3/dfb/structastobj2.html">astobj2</a> callback for adding digest challenges to responses  <a href="#ad920f57db5e8c4e82e415be692af48a8">More...</a><br /></td></tr>
<tr class="separator:ad920f57db5e8c4e82e415be692af48a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17b3a366445ede7cbf3d215066d2ebf7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a17b3a366445ede7cbf3d215066d2ebf7">check_nonce</a> (const char *candidate, const pjsip_rx_data *rdata, const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *auth)</td></tr>
<tr class="memdesc:a17b3a366445ede7cbf3d215066d2ebf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure that a nonce on an incoming request is sane.  <a href="#a17b3a366445ede7cbf3d215066d2ebf7">More...</a><br /></td></tr>
<tr class="separator:a17b3a366445ede7cbf3d215066d2ebf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac002a8b1a18aabf8eed9cf620eb717ec"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397">ast_sip_check_auth_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ac002a8b1a18aabf8eed9cf620eb717ec">digest_check_auth</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, pjsip_rx_data *rdata, pjsip_tx_data *tdata)</td></tr>
<tr class="memdesc:ac002a8b1a18aabf8eed9cf620eb717ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check authentication using Digest scheme.  <a href="#ac002a8b1a18aabf8eed9cf620eb717ec">More...</a><br /></td></tr>
<tr class="separator:ac002a8b1a18aabf8eed9cf620eb717ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84bd1299e5244703d67bf186fa940ec1"><td class="memItemLeft" align="right" valign="top">static pj_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a84bd1299e5244703d67bf186fa940ec1">digest_lookup</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, const pj_str_t *realm, const pj_str_t *acc_name, pjsip_cred_info *info)</td></tr>
<tr class="memdesc:a84bd1299e5244703d67bf186fa940ec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lookup callback for authentication verification.  <a href="#a84bd1299e5244703d67bf186fa940ec1">More...</a><br /></td></tr>
<tr class="separator:a84bd1299e5244703d67bf186fa940ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada73daa4f9f0edca64b08d62d00a7c7e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ada73daa4f9f0edca64b08d62d00a7c7e">digest_requires_authentication</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:ada73daa4f9f0edca64b08d62d00a7c7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if authentication is required.  <a href="#ada73daa4f9f0edca64b08d62d00a7c7e">More...</a><br /></td></tr>
<tr class="separator:ada73daa4f9f0edca64b08d62d00a7c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0e90149e7047d8d30110829d9c6f4c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1e0e90149e7047d8d30110829d9c6f4c">find_challenge</a> (const pjsip_rx_data *rdata, const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *auth)</td></tr>
<tr class="separator:a1e0e90149e7047d8d30110829d9c6f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a451bc73ec483a358013824d6cd854bfe"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a451bc73ec483a358013824d6cd854bfe">get_auth</a> (void)</td></tr>
<tr class="memdesc:a451bc73ec483a358013824d6cd854bfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve shallow copy authentication information from thread-local storage.  <a href="#a451bc73ec483a358013824d6cd854bfe">More...</a><br /></td></tr>
<tr class="separator:a451bc73ec483a358013824d6cd854bfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2244349ff10e2b679104328f8829617a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a2244349ff10e2b679104328f8829617a">global_loaded</a> (const char *object_type)</td></tr>
<tr class="separator:a2244349ff10e2b679104328f8829617a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a> (void)</td></tr>
<tr class="separator:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae87ced83d2c2b4f9c5f56085bb6e012"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#aae87ced83d2c2b4f9c5f56085bb6e012">remove_auth</a> (void)</td></tr>
<tr class="memdesc:aae87ced83d2c2b4f9c5f56085bb6e012"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove shallow copy authentication information from thread-local storage.  <a href="#aae87ced83d2c2b4f9c5f56085bb6e012">More...</a><br /></td></tr>
<tr class="separator:aae87ced83d2c2b4f9c5f56085bb6e012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a16e20ca21eba467f79a08cf9fea77"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a07a16e20ca21eba467f79a08cf9fea77">setup_auth_srv</a> (pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, pjsip_auth_srv *auth_server, const char *realm)</td></tr>
<tr class="memdesc:a07a16e20ca21eba467f79a08cf9fea77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common code for initializing a pjsip_auth_srv.  <a href="#a07a16e20ca21eba467f79a08cf9fea77">More...</a><br /></td></tr>
<tr class="separator:a07a16e20ca21eba467f79a08cf9fea77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a904e7f74e585dd50e4aeabe7fa6072d5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a904e7f74e585dd50e4aeabe7fa6072d5">store_auth</a> (const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *auth)</td></tr>
<tr class="memdesc:a904e7f74e585dd50e4aeabe7fa6072d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store shallow copy authentication information in thread-local storage.  <a href="#a904e7f74e585dd50e4aeabe7fa6072d5">More...</a><br /></td></tr>
<tr class="separator:a904e7f74e585dd50e4aeabe7fa6072d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51cb46a64fb1ed494edb3410c3fd1dd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ab51cb46a64fb1ed494edb3410c3fd1dd">verify</a> (const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *auth, pjsip_rx_data *rdata, pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>)</td></tr>
<tr class="memdesc:ab51cb46a64fb1ed494edb3410c3fd1dd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d3/dfb/structastobj2.html">astobj2</a> callback for verifying incoming credentials  <a href="#ab51cb46a64fb1ed494edb3410c3fd1dd">More...</a><br /></td></tr>
<tr class="separator:ab51cb46a64fb1ed494edb3410c3fd1dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP authentication resource&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .reload = reload_module, .load_pri = AST_MODPRI_CHANNEL_DEPEND - 5, .requires = &quot;res_pjsip&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5045f31007234b9e82de0350c4d49dfe"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d17/structast__threadstorage.html">ast_threadstorage</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a5045f31007234b9e82de0350c4d49dfe">auth_store</a> = { .once = PTHREAD_ONCE_INIT , .key_init = <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6143b51368f8255b368c4fc2dd95da91">__init_auth_store</a> , .custom_init = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> , }</td></tr>
<tr class="separator:a5045f31007234b9e82de0350c4d49dfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3971caa7a574924ac701f25d5f708ebb"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a> [<a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a4cd636e6e8acb7f77b7c945a4e2f1b29">MAX_REALM_LENGTH</a>+1]</td></tr>
<tr class="separator:a3971caa7a574924ac701f25d5f708ebb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addb83444e6f650d21ebdd890b4101ad4"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d9/de9/structast__sip__authenticator.html">ast_sip_authenticator</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#addb83444e6f650d21ebdd890b4101ad4">digest_authenticator</a></td></tr>
<tr class="separator:addb83444e6f650d21ebdd890b4101ad4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0872cb2fc431c02f2b19ff1d58145c2d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a0872cb2fc431c02f2b19ff1d58145c2d">global_observer</a></td></tr>
<tr class="memdesc:a0872cb2fc431c02f2b19ff1d58145c2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Observer which is used to update our default_realm when the global setting changes.  <a href="#a0872cb2fc431c02f2b19ff1d58145c2d">More...</a><br /></td></tr>
<tr class="separator:a0872cb2fc431c02f2b19ff1d58145c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accdf0cb27bfc7062aad382f6ce4025d1"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#accdf0cb27bfc7062aad382f6ce4025d1">verify_result_str</a> []</td></tr>
<tr class="separator:accdf0cb27bfc7062aad382f6ce4025d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4cd636e6e8acb7f77b7c945a4e2f1b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cd636e6e8acb7f77b7c945a4e2f1b29">&#9670;&nbsp;</a></span>MAX_REALM_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_REALM_LENGTH&#160;&#160;&#160;40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00036">36</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a1cf295633d0179111d9fe2d3b872cb19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cf295633d0179111d9fe2d3b872cb19">&#9670;&nbsp;</a></span>digest_verify_result</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19">digest_verify_result</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Result of digest verification. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e"></a>AUTH_FAIL&#160;</td><td class="fielddoc"><p>Authentication credentials incorrect </p>
</td></tr>
<tr><td class="fieldname"><a id="a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02"></a>AUTH_SUCCESS&#160;</td><td class="fielddoc"><p>Authentication credentials correct </p>
</td></tr>
<tr><td class="fieldname"><a id="a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a"></a>AUTH_STALE&#160;</td><td class="fielddoc"><p>Authentication credentials correct but nonce mismatch </p>
</td></tr>
<tr><td class="fieldname"><a id="a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a"></a>AUTH_NOAUTH&#160;</td><td class="fielddoc"><p>Authentication credentials were not provided </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00298">298</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                          {<span class="comment"></span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">   /*! Authentication credentials incorrect */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e">AUTH_FAIL</a> = 0,<span class="comment"></span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">   /*! Authentication credentials correct */</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02">AUTH_SUCCESS</a>,<span class="comment"></span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">   /*! Authentication credentials correct but nonce mismatch */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a">AUTH_STALE</a>,<span class="comment"></span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">   /*! Authentication credentials were not provided */</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a">AUTH_NOAUTH</a>,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;};</div><div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02">AUTH_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00302">res_pjsip_authenticator_digest.c:302</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a">AUTH_STALE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00304">res_pjsip_authenticator_digest.c:304</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a">AUTH_NOAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00306">res_pjsip_authenticator_digest.c:306</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e">AUTH_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00300">res_pjsip_authenticator_digest.c:300</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6143b51368f8255b368c4fc2dd95da91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6143b51368f8255b368c4fc2dd95da91">&#9670;&nbsp;</a></span>__init_auth_store()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __init_auth_store </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread-local storage for <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a>. </p>
<p>The PJSIP authentication API is a bit annoying. When you set up an authentication server, you specify a lookup callback to call into when verifying incoming credentials. The problem with this callback is that it only gives you the realm and authentication username. In 2.0.5, there is a new version of the callback you can use that gives the pjsip_rx_data in addition.</p>
<p>Unfortunately, the data we actually <b>need</b> is the <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> we are currently observing. So we have two choices: 1) Use the current PJSIP API and use thread-local storage to temporarily store our SIP authentication information. Then in the callback, we can retrieve the authentication info and use as needed. Given our threading model, this is safe. 2) Use the 2.0.5 API and temporarily store the authentication information in the rdata's endpoint_info. Then in the callback, we can retrieve the authentication info from the rdata.</p>
<p>I've chosen option 1 since it does not require backporting any APIs from future versions of PJSIP, plus I feel the thread-local option is a bit cleaner. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">88</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div></div><!-- fragment -->
</div>
</div>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00573">573</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00573">573</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<a id="a3bd37944adbc585f0099b533f58e15bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bd37944adbc585f0099b533f58e15bf">&#9670;&nbsp;</a></span>AO2_GLOBAL_OBJ_STATIC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AO2_GLOBAL_OBJ_STATIC </td>
          <td>(</td>
          <td class="paramtype">entity_id&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00573">573</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<a id="ad5b1aad6aec7fe404a680f3760cee6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5b1aad6aec7fe404a680f3760cee6bd">&#9670;&nbsp;</a></span>auth_store_cleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void auth_store_cleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00054">54</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, and <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> **auth = data;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(*auth);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(data);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div><div class="ttc" id="structast__sip__auth_html"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00444">res_pjsip.h:444</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6483e4e89084aad0c779da9da6a15b8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6483e4e89084aad0c779da9da6a15b8b">&#9670;&nbsp;</a></span>build_entity_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int build_entity_id </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00509">509</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00908">ao2_global_obj_replace_unref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../df/da9/uuid_8c_source.html#l00143">ast_uuid_generate_str()</a>, <a class="el" href="../../dd/d1d/uuid_8h_source.html#l00027">AST_UUID_STR_LEN</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00542">load_module()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00534">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;{</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   <span class="keywordtype">char</span> *eid;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   eid = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<a class="code" href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keywordflow">if</span> (!eid) {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <a class="code" href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a>(eid, <a class="code" href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a>);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a>(entity_id, eid);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(eid, -1);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="ttc" id="uuid_8h_html_a127408e53d34dca0c589a099fabf1e13"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a></div><div class="ttdeci">#define AST_UUID_STR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d1d/uuid_8h_source.html#l00027">uuid.h:27</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="uuid_8h_html_abe6d0b550cd9a54964e7891960d1e5bc"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a></div><div class="ttdeci">char * ast_uuid_generate_str(char *buf, size_t size)</div><div class="ttdoc">Generate a UUID string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/uuid_8c_source.html#l00143">uuid.c:143</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3a11e1a1d3e99bed3ea0a7c57a3880d7"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a></div><div class="ttdeci">#define ao2_global_obj_replace_unref(holder, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00908">astobj2.h:908</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af40fb4b31bbdad0292e0997ab0328c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af40fb4b31bbdad0292e0997ab0328c54">&#9670;&nbsp;</a></span>build_nonce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int build_nonce </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/da2/structast__str.html">ast_str</a> **&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>realm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate a nonce. </p>
<p>We use this in order to create authentication challenges. We also use this in order to verify that an incoming request with credentials could be in response to one of our challenges.</p>
<p>The nonce is calculated from a timestamp, the source IP address, the source port, a unique ID for us, and the realm. This helps to ensure that the incoming request is from the same source that the nonce was calculated for. Including the realm ensures that multiple challenges to the same request have different nonces.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>UNIX timestamp expressed as a string </td></tr>
    <tr><td class="paramname">rdata</td><td>The incoming request </td></tr>
    <tr><td class="paramname">realm</td><td>The realm for which authentication should occur </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00206">206</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00925">ao2_global_obj_ref</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l00248">ast_md5_hash()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00800">ast_str_alloca</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00147">str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00377">challenge()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00238">check_nonce()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(256);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keywordtype">char</span> *, eid, <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(entity_id), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keywordtype">char</span> hash[33];</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">    * Note you may be tempted to think why not include the port. The reason</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">    * is that when using TCP the port can potentially differ from before.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;str, 0, <span class="stringliteral">&quot;%s&quot;</span>, timestamp);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;str, 0, <span class="stringliteral">&quot;:%s&quot;</span>, rdata-&gt;pkt_info.src_name);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;str, 0, <span class="stringliteral">&quot;:%s&quot;</span>, eid);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;str, 0, <span class="stringliteral">&quot;:%s&quot;</span>, realm);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#aee8200caadc6a4b5afe01ea37fd26cb3">ast_md5_hash</a>(hash, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(str));</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(nonce, 0, <span class="stringliteral">&quot;%s/%s&quot;</span>, timestamp, hash);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="utils_8h_html_aee8200caadc6a4b5afe01ea37fd26cb3"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aee8200caadc6a4b5afe01ea37fd26cb3">ast_md5_hash</a></div><div class="ttdeci">void ast_md5_hash(char *output, const char *input)</div><div class="ttdoc">Produces MD5 hash based on input string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l00248">main/utils.c:248</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad920f57db5e8c4e82e415be692af48a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad920f57db5e8c4e82e415be692af48a8">&#9670;&nbsp;</a></span>challenge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void challenge </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>realm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_stale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d3/dfb/structastobj2.html">astobj2</a> callback for adding digest challenges to responses </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">realm</td><td>An auth's realm to build a challenge from </td></tr>
    <tr><td class="paramname">tdata</td><td>The response to add the challenge to </td></tr>
    <tr><td class="paramname">rdata</td><td>The request the challenge is in response to </td></tr>
    <tr><td class="paramname">is_stale</td><td>Indicates whether nonce on incoming request was stale </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00377">377</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00800">ast_str_alloca</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00206">build_nonce()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00287">setup_auth_srv()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l08411">authenticate_reply()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l08055">authenticate_request()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l06515">decrypt_frame()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00405">digest_check_auth()</a>, <a class="el" href="../../d2/d4d/astman_8c_source.html#l00629">manager_login()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l08189">register_verify()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l09180">registry_authrequest()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l09228">registry_rerequest()</a>, and <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04937">send_request_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   pj_str_t qop;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   pj_str_t pj_nonce;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   pjsip_auth_srv auth_server;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *nonce = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(256);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="keywordtype">char</span> time_buf[32];</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   time_t timestamp = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   snprintf(time_buf, <span class="keyword">sizeof</span>(time_buf), <span class="stringliteral">&quot;%d&quot;</span>, (<span class="keywordtype">int</span>) timestamp);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#af40fb4b31bbdad0292e0997ab0328c54">build_nonce</a>(&amp;nonce, time_buf, rdata, realm);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a07a16e20ca21eba467f79a08cf9fea77">setup_auth_srv</a>(tdata-&gt;pool, &amp;auth_server, realm);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   pj_cstr(&amp;pj_nonce, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(nonce));</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   pj_cstr(&amp;qop, <span class="stringliteral">&quot;auth&quot;</span>);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   pjsip_auth_srv_challenge(&amp;auth_server, &amp;qop, &amp;pj_nonce, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, is_stale ? PJ_TRUE : PJ_FALSE, tdata);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a07a16e20ca21eba467f79a08cf9fea77"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a07a16e20ca21eba467f79a08cf9fea77">setup_auth_srv</a></div><div class="ttdeci">static void setup_auth_srv(pj_pool_t *pool, pjsip_auth_srv *auth_server, const char *realm)</div><div class="ttdoc">Common code for initializing a pjsip_auth_srv. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00287">res_pjsip_authenticator_digest.c:287</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_af40fb4b31bbdad0292e0997ab0328c54"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#af40fb4b31bbdad0292e0997ab0328c54">build_nonce</a></div><div class="ttdeci">static int build_nonce(struct ast_str **nonce, const char *timestamp, const pjsip_rx_data *rdata, const char *realm)</div><div class="ttdoc">Calculate a nonce. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00206">res_pjsip_authenticator_digest.c:206</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17b3a366445ede7cbf3d215066d2ebf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17b3a366445ede7cbf3d215066d2ebf7">&#9670;&nbsp;</a></span>check_nonce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_nonce </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>candidate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *&#160;</td>
          <td class="paramname"><em>auth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Ensure that a nonce on an incoming request is sane. </p>
<p>The nonce in an incoming Authorization header needs to pass some scrutiny in order for us to consider accepting it. What we do is re-build a nonce based on request data and a realm and see if it matches the nonce they sent us. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">candidate</td><td>The nonce on an incoming request </td></tr>
    <tr><td class="paramname">rdata</td><td>The incoming request </td></tr>
    <tr><td class="paramname">auth</td><td>The auth credentials we are trying to match against. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Nonce does not pass validity checks </td></tr>
    <tr><td class="paramname">1</td><td>Nonce passes validity check </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00238">238</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00800">ast_str_alloca</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00206">build_nonce()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l04629">copy()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00462">ast_sip_auth::nonce_lifetime</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00448">ast_sip_auth::realm</a>, and <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00267">find_challenge()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(candidate);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <span class="keywordtype">char</span> *timestamp = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;copy, <span class="stringliteral">&quot;/&quot;</span>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="keywordtype">int</span> timestamp_int;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *calculated = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(64);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordflow">if</span> (!copy) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">/* Clearly a bad nonce! */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keywordflow">if</span> (sscanf(timestamp, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;timestamp_int) != 1) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>) now - timestamp_int &gt; auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a9406710019573ce91357fb893c725eab">nonce_lifetime</a>) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#af40fb4b31bbdad0292e0997ab0328c54">build_nonce</a>(&amp;calculated, timestamp, rdata, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Calculated nonce %s. Actual nonce is %s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(calculated), candidate);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="keywordflow">if</span> (strcmp(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(calculated), candidate)) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div><div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="app__voicemail_8c_html_abe15777a07ac747625b018ac01f92531"><div class="ttname"><a href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a></div><div class="ttdeci">static int copy(char *infile, char *outfile)</div><div class="ttdoc">Utility function to copy a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df4/app__voicemail_8c_source.html#l04629">app_voicemail.c:4629</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a9406710019573ce91357fb893c725eab"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a9406710019573ce91357fb893c725eab">ast_sip_auth::nonce_lifetime</a></div><div class="ttdeci">unsigned int nonce_lifetime</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00462">res_pjsip.h:462</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a71767d73977f42a36bcb04fb76f7a286"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">ast_sip_auth::realm</a></div><div class="ttdeci">const ast_string_field realm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00448">res_pjsip.h:448</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_af40fb4b31bbdad0292e0997ab0328c54"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#af40fb4b31bbdad0292e0997ab0328c54">build_nonce</a></div><div class="ttdeci">static int build_nonce(struct ast_str **nonce, const char *timestamp, const pjsip_rx_data *rdata, const char *realm)</div><div class="ttdoc">Calculate a nonce. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00206">res_pjsip_authenticator_digest.c:206</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac002a8b1a18aabf8eed9cf620eb717ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac002a8b1a18aabf8eed9cf620eb717ec">&#9670;&nbsp;</a></span>digest_check_auth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397">ast_sip_check_auth_result</a> digest_check_auth </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check authentication using Digest scheme. </p>
<p>This function will check an incoming message against configured authentication options. If <b>any</b> of the incoming Authorization headers result in successful authentication, then authentication is considered successful.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="../../de/d96/res__pjsip_8c.html#a64865fb2b6d118505ab9769b41aeb91a" title="Method to determine authentication status of an incoming request. ">ast_sip_check_authentication</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00405">405</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00636">artificial_endpoint</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00934">AST_SIP_AUTHENTICATION_CHALLENGE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00940">AST_SIP_AUTHENTICATION_ERROR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00938">AST_SIP_AUTHENTICATION_FAILED</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00936">AST_SIP_AUTHENTICATION_SUCCESS</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02377">ast_sip_cleanup_auths()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00631">ast_sip_get_artificial_auth()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00654">ast_sip_get_artificial_endpoint()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02360">ast_sip_retrieve_auths()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00300">AUTH_FAIL</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00304">AUTH_STALE</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00302">AUTH_SUCCESS</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00377">challenge()</a>, <a class="el" href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">cleanup()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00037">default_realm</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00853">ast_sip_endpoint::inbound_auths</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;{</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> **auths;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> **auths_shallow;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19">digest_verify_result</a> *verify_res;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *<a class="code" href="../../d7/dad/pjsip__distributor_8c.html#a84a2f6706a005bdb74f4ea503b01e95b">artificial_endpoint</a>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397">ast_sip_check_auth_result</a> res;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <span class="keywordtype">int</span> is_artificial;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="keywordtype">int</span> failures = 0;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordtype">size_t</span> auth_size;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   auth_size = <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76e125b73c8e19a4e42b4c4112031584">inbound_auths</a>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(0 &lt; auth_size);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   auths = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(auth_size * <span class="keyword">sizeof</span>(*auths));</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   verify_res = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(auth_size * <span class="keyword">sizeof</span>(*verify_res));</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   artificial_endpoint = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a261c2cada6e51e2d73574ffe6b1ae7e3">ast_sip_get_artificial_endpoint</a>();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <span class="keywordflow">if</span> (!artificial_endpoint) {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="comment">/* Should not happen except possibly if we are shutting down. */</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397a9e45ea0dd227514e5e8b420da03e9742">AST_SIP_AUTHENTICATION_ERROR</a>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   is_artificial = endpoint == <a class="code" href="../../d7/dad/pjsip__distributor_8c.html#a84a2f6706a005bdb74f4ea503b01e95b">artificial_endpoint</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(artificial_endpoint, -1);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="keywordflow">if</span> (is_artificial) {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(auth_size == 1);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      auths[0] = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9b41a14917b193124f8da5a1323f33e3">ast_sip_get_artificial_auth</a>();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">if</span> (!auths[0]) {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         <span class="comment">/* Should not happen except possibly if we are shutting down. */</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397a9e45ea0dd227514e5e8b420da03e9742">AST_SIP_AUTHENTICATION_ERROR</a>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      memset(auths, 0, auth_size * <span class="keyword">sizeof</span>(*auths));</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a72f43e82cb97ea0b744a4a0ba7ff0a43">ast_sip_retrieve_auths</a>(&amp;endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76e125b73c8e19a4e42b4c4112031584">inbound_auths</a>, auths)) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         res = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397a9e45ea0dd227514e5e8b420da03e9742">AST_SIP_AUTHENTICATION_ERROR</a>;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="comment">/* Setup shallow copy of auths */</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a>)) {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      auths_shallow = auths;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">       * Set default realm on a shallow copy of the authentication</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">       * objects that don&#39;t have a realm set.</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      auths_shallow = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(auth_size * <span class="keyword">sizeof</span>(*auths_shallow));</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">for</span> (idx = 0; idx &lt; auth_size; ++idx) {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(auths[idx]-&gt;realm)) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">             * Make a shallow copy and set the default realm on it.</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">             *</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">             * The stack allocation is OK here.  Normally this will</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">             * loop one time.  If you have multiple auths then you</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">             * shouldn&#39;t need more auths than the normal complement</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">             * of fingers and toes.  Otherwise, you should check</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">             * your sanity for setting up your system up that way.</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            auths_shallow[idx] = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(<span class="keyword">sizeof</span>(**auths_shallow));</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            memcpy(auths_shallow[idx], auths[idx], <span class="keyword">sizeof</span>(**auths_shallow));</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            *((<span class="keywordtype">char</span> **) (&amp;auths_shallow[idx]-&gt;realm)) = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Using default realm &#39;%s&#39; on incoming auth &#39;%s&#39;.\n&quot;</span>,</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;               <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(auths_shallow[idx]));</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            auths_shallow[idx] = auths[idx];</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;         }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; auth_size; ++idx) {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      verify_res[idx] = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ab51cb46a64fb1ed494edb3410c3fd1dd">verify</a>(auths_shallow[idx], rdata, tdata-&gt;pool);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">if</span> (verify_res[idx] == <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02">AUTH_SUCCESS</a>) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;         res = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397aa0871afe29e292ca48bcb0b1be287452">AST_SIP_AUTHENTICATION_SUCCESS</a>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      }</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">if</span> (verify_res[idx] == <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e">AUTH_FAIL</a>) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;         failures++;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; auth_size; ++idx) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad920f57db5e8c4e82e415be692af48a8">challenge</a>(auths_shallow[idx]-&gt;realm, tdata, rdata, verify_res[idx] == <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a">AUTH_STALE</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keywordflow">if</span> (failures == auth_size) {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      res = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397aa6a63fc1f7fe3fb15d1a957f8ec0cb9c">AST_SIP_AUTHENTICATION_FAILED</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      res = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397a39aaed66adb496e856458909ecdf5446">AST_SIP_AUTHENTICATION_CHALLENGE</a>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<a class="code" href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a>:</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a3e8ce0855f5b8cc0e2c64cc59887d779">ast_sip_cleanup_auths</a>(auths, auth_size);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div><div class="ttc" id="structast__sip__auth_html"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00444">res_pjsip.h:444</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_ab51cb46a64fb1ed494edb3410c3fd1dd"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ab51cb46a64fb1ed494edb3410c3fd1dd">verify</a></div><div class="ttdeci">static int verify(const struct ast_sip_auth *auth, pjsip_rx_data *rdata, pj_pool_t *pool)</div><div class="ttdoc">astobj2 callback for verifying incoming credentials </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">res_pjsip_authenticator_digest.c:324</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a3971caa7a574924ac701f25d5f708ebb"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a></div><div class="ttdeci">static char default_realm[MAX_REALM_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00037">res_pjsip_authenticator_digest.c:37</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ad4af2859e259268e0e51d74b524ac397aa6a63fc1f7fe3fb15d1a957f8ec0cb9c"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397aa6a63fc1f7fe3fb15d1a957f8ec0cb9c">AST_SIP_AUTHENTICATION_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00938">res_pjsip.h:938</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ad4af2859e259268e0e51d74b524ac397"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397">ast_sip_check_auth_result</a></div><div class="ttdeci">ast_sip_check_auth_result</div><div class="ttdoc">Possible returns from ast_sip_check_authentication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00932">res_pjsip.h:932</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02">AUTH_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00302">res_pjsip_authenticator_digest.c:302</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ad4af2859e259268e0e51d74b524ac397a39aaed66adb496e856458909ecdf5446"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397a39aaed66adb496e856458909ecdf5446">AST_SIP_AUTHENTICATION_CHALLENGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00934">res_pjsip.h:934</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a">AUTH_STALE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00304">res_pjsip_authenticator_digest.c:304</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19">digest_verify_result</a></div><div class="ttdeci">digest_verify_result</div><div class="ttdoc">Result of digest verification. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00298">res_pjsip_authenticator_digest.c:298</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a72f43e82cb97ea0b744a4a0ba7ff0a43"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a72f43e82cb97ea0b744a4a0ba7ff0a43">ast_sip_retrieve_auths</a></div><div class="ttdeci">int ast_sip_retrieve_auths(const struct ast_sip_auth_vector *auths, struct ast_sip_auth **out)</div><div class="ttdoc">Retrieve relevant SIP auth structures from sorcery. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02360">pjsip_configuration.c:2360</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="pjsip__distributor_8c_html_a84a2f6706a005bdb74f4ea503b01e95b"><div class="ttname"><a href="../../d7/dad/pjsip__distributor_8c.html#a84a2f6706a005bdb74f4ea503b01e95b">artificial_endpoint</a></div><div class="ttdeci">static struct ast_sip_endpoint * artificial_endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00636">pjsip_distributor.c:636</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ad4af2859e259268e0e51d74b524ac397a9e45ea0dd227514e5e8b420da03e9742"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397a9e45ea0dd227514e5e8b420da03e9742">AST_SIP_AUTHENTICATION_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00940">res_pjsip.h:940</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_ad920f57db5e8c4e82e415be692af48a8"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad920f57db5e8c4e82e415be692af48a8">challenge</a></div><div class="ttdeci">static void challenge(const char *realm, pjsip_tx_data *tdata, const pjsip_rx_data *rdata, int is_stale)</div><div class="ttdoc">astobj2 callback for adding digest challenges to responses </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00377">res_pjsip_authenticator_digest.c:377</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9b41a14917b193124f8da5a1323f33e3"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9b41a14917b193124f8da5a1323f33e3">ast_sip_get_artificial_auth</a></div><div class="ttdeci">struct ast_sip_auth * ast_sip_get_artificial_auth(void)</div><div class="ttdoc">Retrieves a reference to the artificial auth. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00631">pjsip_distributor.c:631</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a76e125b73c8e19a4e42b4c4112031584"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a76e125b73c8e19a4e42b4c4112031584">ast_sip_endpoint::inbound_auths</a></div><div class="ttdeci">struct ast_sip_auth_vector inbound_auths</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00853">res_pjsip.h:853</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a261c2cada6e51e2d73574ffe6b1ae7e3"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a261c2cada6e51e2d73574ffe6b1ae7e3">ast_sip_get_artificial_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_sip_get_artificial_endpoint(void)</div><div class="ttdoc">Retrieves a reference to the artificial endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00654">pjsip_distributor.c:654</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a3e8ce0855f5b8cc0e2c64cc59887d779"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a3e8ce0855f5b8cc0e2c64cc59887d779">ast_sip_cleanup_auths</a></div><div class="ttdeci">void ast_sip_cleanup_auths(struct ast_sip_auth *auths[], size_t num_auths)</div><div class="ttdoc">Clean up retrieved auth structures from memory. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02377">pjsip_configuration.c:2377</a></div></div>
<div class="ttc" id="pbx__realtime_8c_html_a10b51e1931bd03dd172cbfb9d3d67efb"><div class="ttname"><a href="../../d2/d2c/pbx__realtime_8c.html#a10b51e1931bd03dd172cbfb9d3d67efb">cleanup</a></div><div class="ttdeci">static void * cleanup(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d2c/pbx__realtime_8c_source.html#l00124">pbx_realtime.c:124</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ad4af2859e259268e0e51d74b524ac397aa0871afe29e292ca48bcb0b1be287452"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ad4af2859e259268e0e51d74b524ac397aa0871afe29e292ca48bcb0b1be287452">AST_SIP_AUTHENTICATION_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00936">res_pjsip.h:936</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e">AUTH_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00300">res_pjsip_authenticator_digest.c:300</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84bd1299e5244703d67bf186fa940ec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84bd1299e5244703d67bf186fa940ec1">&#9670;&nbsp;</a></span>digest_lookup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_status_t digest_lookup </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pj_str_t *&#160;</td>
          <td class="paramname"><em>realm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pj_str_t *&#160;</td>
          <td class="paramname"><em>acc_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_cred_info *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lookup callback for authentication verification. </p>
<p>This function is called when we call pjsip_auth_srv_verify(). It expects us to verify that the realm and account name from the Authorization header is correct. We are then supposed to supply a password or MD5 sum of credentials.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">pool</td><td>A memory pool we can use for allocations </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">realm</td><td>The realm from the Authorization header </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">acc_name</td><td>the user from the Authorization header </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">info</td><td>The credentials we need to fill in </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">PJ_SUCCESS</td><td>Successful authentication </td></tr>
    <tr><td class="paramname">other</td><td>Unsuccessful </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00151">151</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00439">AST_SIP_AUTH_TYPE_ARTIFICIAL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00435">AST_SIP_AUTH_TYPE_MD5</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00433">AST_SIP_AUTH_TYPE_USER_PASS</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00452">ast_sip_auth::auth_pass</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00450">ast_sip_auth::auth_user</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00125">get_auth()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00454">ast_sip_auth::md5_creds</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00448">ast_sip_auth::realm</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00464">ast_sip_auth::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00287">setup_auth_srv()</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *auth;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   auth = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a451bc73ec483a358013824d6cd854bfe">get_auth</a>();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <span class="keywordflow">if</span> (!auth) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_FORBIDDEN;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> (auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#af9a537c0354134006946f9dd7351fc49">type</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cda662c2f6a25954136d58f73a6e7940501">AST_SIP_AUTH_TYPE_ARTIFICIAL</a>) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_FORBIDDEN;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <span class="keywordflow">if</span> (pj_strcmp2(<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>)) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_FORBIDDEN;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">if</span> (pj_strcmp2(acc_name, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">auth_user</a>)) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_FORBIDDEN;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;realm, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;username, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">auth_user</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keywordflow">switch</span> (auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#af9a537c0354134006946f9dd7351fc49">type</a>) {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cdacb1470ed32c61ab7bf30cccb2887ed2b">AST_SIP_AUTH_TYPE_USER_PASS</a>:</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;data, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#af263f62bf45d20982f102de2a9cd461f">auth_pass</a>);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;data_type = PJSIP_CRED_DATA_PLAIN_PASSWD;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cdabbc9332fb29a5f57bc4a9b6c39c3d553">AST_SIP_AUTH_TYPE_MD5</a>:</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      pj_strdup2(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;data, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a65a9bdda248637db17f2af0c9896cdfb">md5_creds</a>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;data_type = PJSIP_CRED_DATA_DIGEST;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">return</span> PJSIP_SC_FORBIDDEN;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="keywordflow">return</span> PJ_SUCCESS;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div><div class="ttc" id="structast__sip__auth_html"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00444">res_pjsip.h:444</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a451bc73ec483a358013824d6cd854bfe"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a451bc73ec483a358013824d6cd854bfe">get_auth</a></div><div class="ttdeci">static const struct ast_sip_auth * get_auth(void)</div><div class="ttdoc">Retrieve shallow copy authentication information from thread-local storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00125">res_pjsip_authenticator_digest.c:125</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a65a9bdda248637db17f2af0c9896cdfb"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a65a9bdda248637db17f2af0c9896cdfb">ast_sip_auth::md5_creds</a></div><div class="ttdeci">const ast_string_field md5_creds</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00454">res_pjsip.h:454</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ab5b75b4bdba91e178731511c7fa659cdacb1470ed32c61ab7bf30cccb2887ed2b"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cdacb1470ed32c61ab7bf30cccb2887ed2b">AST_SIP_AUTH_TYPE_USER_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00433">res_pjsip.h:433</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ab5b75b4bdba91e178731511c7fa659cda662c2f6a25954136d58f73a6e7940501"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cda662c2f6a25954136d58f73a6e7940501">AST_SIP_AUTH_TYPE_ARTIFICIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00439">res_pjsip.h:439</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a71767d73977f42a36bcb04fb76f7a286"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">ast_sip_auth::realm</a></div><div class="ttdeci">const ast_string_field realm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00448">res_pjsip.h:448</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="structast__sip__auth_html_af263f62bf45d20982f102de2a9cd461f"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#af263f62bf45d20982f102de2a9cd461f">ast_sip_auth::auth_pass</a></div><div class="ttdeci">const ast_string_field auth_pass</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00452">res_pjsip.h:452</a></div></div>
<div class="ttc" id="structast__sip__auth_html_af9a537c0354134006946f9dd7351fc49"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#af9a537c0354134006946f9dd7351fc49">ast_sip_auth::type</a></div><div class="ttdeci">enum ast_sip_auth_type type</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00464">res_pjsip.h:464</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ab5b75b4bdba91e178731511c7fa659cdabbc9332fb29a5f57bc4a9b6c39c3d553"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ab5b75b4bdba91e178731511c7fa659cdabbc9332fb29a5f57bc4a9b6c39c3d553">AST_SIP_AUTH_TYPE_MD5</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00435">res_pjsip.h:435</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a9dfeb2fdce6acf9c0f869d674aa5a1c2"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">ast_sip_auth::auth_user</a></div><div class="ttdeci">const ast_string_field auth_user</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00450">res_pjsip.h:450</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ada73daa4f9f0edca64b08d62d00a7c7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada73daa4f9f0edca64b08d62d00a7c7e">&#9670;&nbsp;</a></span>digest_requires_authentication()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int digest_requires_authentication </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if authentication is required. </p>
<p>Authentication is required if the endpoint has at least one auth section specified </p>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00047">47</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00654">ast_sip_get_artificial_endpoint()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00853">ast_sip_endpoint::inbound_auths</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *, artificial, <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a261c2cada6e51e2d73574ffe6b1ae7e3">ast_sip_get_artificial_endpoint</a>(), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordflow">return</span> endpoint == artificial || <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76e125b73c8e19a4e42b4c4112031584">inbound_auths</a>) &gt; 0;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div><div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a76e125b73c8e19a4e42b4c4112031584"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a76e125b73c8e19a4e42b4c4112031584">ast_sip_endpoint::inbound_auths</a></div><div class="ttdeci">struct ast_sip_auth_vector inbound_auths</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00853">res_pjsip.h:853</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a261c2cada6e51e2d73574ffe6b1ae7e3"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a261c2cada6e51e2d73574ffe6b1ae7e3">ast_sip_get_artificial_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_sip_get_artificial_endpoint(void)</div><div class="ttdoc">Retrieves a reference to the artificial endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00654">pjsip_distributor.c:654</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e0e90149e7047d8d30110829d9c6f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e0e90149e7047d8d30110829d9c6f4c">&#9670;&nbsp;</a></span>find_challenge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int find_challenge </td>
          <td>(</td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *&#160;</td>
          <td class="paramname"><em>auth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00267">267</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00238">check_nonce()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00448">ast_sip_auth::realm</a>, and <a class="el" href="../../dc/df2/ast__expr2f_8c_source.html#l00894">while()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;{</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <span class="keyword">struct </span>pjsip_authorization_hdr *auth_hdr = (pjsip_authorization_hdr *) &amp;rdata-&gt;msg_info.msg-&gt;hdr;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="keywordtype">int</span> challenge_found = 0;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keywordtype">char</span> nonce[64];</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a> ((auth_hdr = (pjsip_authorization_hdr *) pjsip_msg_find_hdr(rdata-&gt;msg_info.msg, PJSIP_H_AUTHORIZATION, auth_hdr-&gt;next))) {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(nonce, &amp;auth_hdr-&gt;credential.digest.nonce, <span class="keyword">sizeof</span>(nonce));</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a17b3a366445ede7cbf3d215066d2ebf7">check_nonce</a>(nonce, rdata, auth) &amp;&amp; !pj_strcmp2(&amp;auth_hdr-&gt;credential.digest.realm, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>)) {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;         challenge_found = 1;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <span class="keywordflow">return</span> challenge_found;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div><div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a17b3a366445ede7cbf3d215066d2ebf7"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a17b3a366445ede7cbf3d215066d2ebf7">check_nonce</a></div><div class="ttdeci">static int check_nonce(const char *candidate, const pjsip_rx_data *rdata, const struct ast_sip_auth *auth)</div><div class="ttdoc">Ensure that a nonce on an incoming request is sane. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00238">res_pjsip_authenticator_digest.c:238</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a8fdafe3be7e00ce3d4f0cb50a9a5eb39"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a8fdafe3be7e00ce3d4f0cb50a9a5eb39">while</a></div><div class="ttdeci">while(1)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00894">ast_expr2f.c:894</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a71767d73977f42a36bcb04fb76f7a286"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">ast_sip_auth::realm</a></div><div class="ttdeci">const ast_string_field realm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00448">res_pjsip.h:448</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a451bc73ec483a358013824d6cd854bfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a451bc73ec483a358013824d6cd854bfe">&#9670;&nbsp;</a></span>get_auth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a>* get_auth </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve shallow copy authentication information from thread-local storage. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00125">125</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7d/threadstorage_8h_source.html#l00197">ast_threadstorage_get()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">auth_store</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00151">digest_lookup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> **auth;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   auth = <a class="code" href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a>(&amp;<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a5045f31007234b9e82de0350c4d49dfe">auth_store</a>, <span class="keyword">sizeof</span>(auth));</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   <span class="keywordflow">if</span> (auth) {</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">return</span> *auth;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="ttc" id="structast__sip__auth_html"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00444">res_pjsip.h:444</a></div></div>
<div class="ttc" id="threadstorage_8h_html_ab6ff44d2acf6ea45090177cd3141da03"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a></div><div class="ttdeci">void * ast_threadstorage_get(struct ast_threadstorage *ts, size_t init_size)</div><div class="ttdoc">Retrieve thread storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00197">threadstorage.h:197</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a5045f31007234b9e82de0350c4d49dfe"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a5045f31007234b9e82de0350c4d49dfe">auth_store</a></div><div class="ttdeci">static struct ast_threadstorage auth_store</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">res_pjsip_authenticator_digest.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2244349ff10e2b679104328f8829617a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2244349ff10e2b679104328f8829617a">&#9670;&nbsp;</a></span>global_loaded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void global_loaded </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>object_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00524">524</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/dfd/config__global_8c_source.html#l00375">ast_sip_get_default_realm()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00037">default_realm</a>.</p>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9ec3329ebc96c83e7d992cabe78bca58">ast_sip_get_default_realm</a>(<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a>));</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div><div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a3971caa7a574924ac701f25d5f708ebb"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a3971caa7a574924ac701f25d5f708ebb">default_realm</a></div><div class="ttdeci">static char default_realm[MAX_REALM_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00037">res_pjsip_authenticator_digest.c:37</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9ec3329ebc96c83e7d992cabe78bca58"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9ec3329ebc96c83e7d992cabe78bca58">ast_sip_get_default_realm</a></div><div class="ttdeci">void ast_sip_get_default_realm(char *realm, size_t size)</div><div class="ttdoc">Retrieve the global default realm. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfd/config__global_8c_source.html#l00375">config_global.c:375</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00542">542</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00865">ao2_global_obj_release</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03338">ast_sip_register_authenticator()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02386">ast_sorcery_observer_add()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01442">ast_sorcery_reload_object()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00509">build_entity_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00558">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;{</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6483e4e89084aad0c779da9da6a15b8b">build_entity_id</a>()) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;global&quot;</span>, &amp;<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a0872cb2fc431c02f2b19ff1d58145c2d">global_observer</a>);</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;global&quot;</span>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#aa9619038b1c9446b8aa48f3701b41495">ast_sip_register_authenticator</a>(&amp;<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#addb83444e6f650d21ebdd890b4101ad4">digest_authenticator</a>)) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a>(entity_id);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_aa9619038b1c9446b8aa48f3701b41495"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aa9619038b1c9446b8aa48f3701b41495">ast_sip_register_authenticator</a></div><div class="ttdeci">int ast_sip_register_authenticator(struct ast_sip_authenticator *auth)</div><div class="ttdoc">Register a SIP authenticator. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03338">res_pjsip.c:3338</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a6483e4e89084aad0c779da9da6a15b8b"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6483e4e89084aad0c779da9da6a15b8b">build_entity_id</a></div><div class="ttdeci">static int build_entity_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00509">res_pjsip_authenticator_digest.c:509</a></div></div>
<div class="ttc" id="sorcery_8h_html_a6c1928d47eae1172f236e8ee421c2db4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a></div><div class="ttdeci">int ast_sorcery_observer_add(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Add an observer to a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02386">sorcery.c:2386</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac0e1cbc7cf050c8b7b8e3a8fee92c50e"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a></div><div class="ttdeci">#define ao2_global_obj_release(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00865">astobj2.h:865</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a0872cb2fc431c02f2b19ff1d58145c2d"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a0872cb2fc431c02f2b19ff1d58145c2d">global_observer</a></div><div class="ttdeci">static struct ast_sorcery_observer global_observer</div><div class="ttdoc">Observer which is used to update our default_realm when the global setting changes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00530">res_pjsip_authenticator_digest.c:530</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_addb83444e6f650d21ebdd890b4101ad4"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#addb83444e6f650d21ebdd890b4101ad4">digest_authenticator</a></div><div class="ttdeci">static struct ast_sip_authenticator digest_authenticator</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00504">res_pjsip_authenticator_digest.c:504</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad98ae6e153f53b0c3c40119acc5e5266"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad98ae6e153f53b0c3c40119acc5e5266">ast_sorcery_reload_object</a></div><div class="ttdeci">void ast_sorcery_reload_object(const struct ast_sorcery *sorcery, const char *type)</div><div class="ttdoc">Inform any wizards of a specific object type to reload persistent objects. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01442">sorcery.c:1442</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c6ac25ea7536c0bc9ed18cbcf917527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6ac25ea7536c0bc9ed18cbcf917527">&#9670;&nbsp;</a></span>reload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int reload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00534">534</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00509">build_entity_id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00558">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;{</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6483e4e89084aad0c779da9da6a15b8b">build_entity_id</a>()) {</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;}</div><div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a6483e4e89084aad0c779da9da6a15b8b"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6483e4e89084aad0c779da9da6a15b8b">build_entity_id</a></div><div class="ttdeci">static int build_entity_id(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00509">res_pjsip_authenticator_digest.c:509</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae87ced83d2c2b4f9c5f56085bb6e012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae87ced83d2c2b4f9c5f56085bb6e012">&#9670;&nbsp;</a></span>remove_auth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int remove_auth </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove shallow copy authentication information from thread-local storage. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00109">109</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7d/threadstorage_8h_source.html#l00197">ast_threadstorage_get()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">auth_store</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;{</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> **pointing;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   pointing = <a class="code" href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a>(&amp;<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a5045f31007234b9e82de0350c4d49dfe">auth_store</a>, <span class="keyword">sizeof</span>(pointing));</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <span class="keywordflow">if</span> (!pointing) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   *pointing = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div><div class="ttc" id="structast__sip__auth_html"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00444">res_pjsip.h:444</a></div></div>
<div class="ttc" id="threadstorage_8h_html_ab6ff44d2acf6ea45090177cd3141da03"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a></div><div class="ttdeci">void * ast_threadstorage_get(struct ast_threadstorage *ts, size_t init_size)</div><div class="ttdoc">Retrieve thread storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00197">threadstorage.h:197</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a5045f31007234b9e82de0350c4d49dfe"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a5045f31007234b9e82de0350c4d49dfe">auth_store</a></div><div class="ttdeci">static struct ast_threadstorage auth_store</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">res_pjsip_authenticator_digest.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a07a16e20ca21eba467f79a08cf9fea77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07a16e20ca21eba467f79a08cf9fea77">&#9670;&nbsp;</a></span>setup_auth_srv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void setup_auth_srv </td>
          <td>(</td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_auth_srv *&#160;</td>
          <td class="paramname"><em>auth_server</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>realm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Common code for initializing a pjsip_auth_srv. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00287">287</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00151">digest_lookup()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00377">challenge()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;{</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   pj_str_t realm_str;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   pj_cstr(&amp;realm_str, <a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   pjsip_auth_srv_init(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, auth_server, &amp;realm_str, <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a84bd1299e5244703d67bf186fa940ec1">digest_lookup</a>, 0);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a71767d73977f42a36bcb04fb76f7a286"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">ast_sip_auth::realm</a></div><div class="ttdeci">const ast_string_field realm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00448">res_pjsip.h:448</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a84bd1299e5244703d67bf186fa940ec1"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a84bd1299e5244703d67bf186fa940ec1">digest_lookup</a></div><div class="ttdeci">static pj_status_t digest_lookup(pj_pool_t *pool, const pj_str_t *realm, const pj_str_t *acc_name, pjsip_cred_info *info)</div><div class="ttdoc">Lookup callback for authentication verification. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00151">res_pjsip_authenticator_digest.c:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a904e7f74e585dd50e4aeabe7fa6072d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a904e7f74e585dd50e4aeabe7fa6072d5">&#9670;&nbsp;</a></span>store_auth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int store_auth </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *&#160;</td>
          <td class="paramname"><em>auth</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Store shallow copy authentication information in thread-local storage. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00093">93</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7d/threadstorage_8h_source.html#l00197">ast_threadstorage_get()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">auth_store</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">verify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;{</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> **pointing;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   pointing = <a class="code" href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a>(&amp;<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a5045f31007234b9e82de0350c4d49dfe">auth_store</a>, <span class="keyword">sizeof</span>(pointing));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="keywordflow">if</span> (!pointing) {</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   *pointing = auth;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="ttc" id="structast__sip__auth_html"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00444">res_pjsip.h:444</a></div></div>
<div class="ttc" id="threadstorage_8h_html_ab6ff44d2acf6ea45090177cd3141da03"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ab6ff44d2acf6ea45090177cd3141da03">ast_threadstorage_get</a></div><div class="ttdeci">void * ast_threadstorage_get(struct ast_threadstorage *ts, size_t init_size)</div><div class="ttdoc">Retrieve thread storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00197">threadstorage.h:197</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a5045f31007234b9e82de0350c4d49dfe"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a5045f31007234b9e82de0350c4d49dfe">auth_store</a></div><div class="ttdeci">static struct ast_threadstorage auth_store</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">res_pjsip_authenticator_digest.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00558">558</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00865">ao2_global_obj_release</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00326">AST_MODPRI_CHANNEL_DEPEND</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03350">ast_sip_unregister_authenticator()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02418">ast_sorcery_observer_remove()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00542">load_module()</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00741">reload()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00534">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;{</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;global&quot;</span>, &amp;<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a0872cb2fc431c02f2b19ff1d58145c2d">global_observer</a>);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a8fa30d3e04f251038795393bbd08e75f">ast_sip_unregister_authenticator</a>(&amp;<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#addb83444e6f650d21ebdd890b4101ad4">digest_authenticator</a>);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a>(entity_id);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_a8fa30d3e04f251038795393bbd08e75f"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a8fa30d3e04f251038795393bbd08e75f">ast_sip_unregister_authenticator</a></div><div class="ttdeci">void ast_sip_unregister_authenticator(struct ast_sip_authenticator *auth)</div><div class="ttdoc">Unregister a SIP authenticator. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03350">res_pjsip.c:3350</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac0e1cbc7cf050c8b7b8e3a8fee92c50e"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a></div><div class="ttdeci">#define ao2_global_obj_release(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00865">astobj2.h:865</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a0872cb2fc431c02f2b19ff1d58145c2d"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a0872cb2fc431c02f2b19ff1d58145c2d">global_observer</a></div><div class="ttdeci">static struct ast_sorcery_observer global_observer</div><div class="ttdoc">Observer which is used to update our default_realm when the global setting changes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00530">res_pjsip_authenticator_digest.c:530</a></div></div>
<div class="ttc" id="sorcery_8h_html_a18d64c360480b458754fc30f781d5011"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a></div><div class="ttdeci">void ast_sorcery_observer_remove(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Remove an observer from a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02418">sorcery.c:2418</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_addb83444e6f650d21ebdd890b4101ad4"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#addb83444e6f650d21ebdd890b4101ad4">digest_authenticator</a></div><div class="ttdeci">static struct ast_sip_authenticator digest_authenticator</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00504">res_pjsip_authenticator_digest.c:504</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab51cb46a64fb1ed494edb3410c3fd1dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51cb46a64fb1ed494edb3410c3fd1dd">&#9670;&nbsp;</a></span>verify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int verify </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> *&#160;</td>
          <td class="paramname"><em>auth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d3/dfb/structastobj2.html">astobj2</a> callback for verifying incoming credentials </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">auth</td><td>The <a class="el" href="../../d0/d01/structast__sip__auth.html">ast_sip_auth</a> to check against </td></tr>
    <tr><td class="paramname">rdata</td><td>The incoming request </td></tr>
    <tr><td class="paramname">pool</td><td>A pool to use for the auth server </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CMP_MATCH on successful authentication </dd>
<dd>
0 on failed authentication </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">324</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00300">AUTH_FAIL</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00306">AUTH_NOAUTH</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00304">AUTH_STALE</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00302">AUTH_SUCCESS</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00450">ast_sip_auth::auth_user</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00267">find_challenge()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00448">ast_sip_auth::realm</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00109">remove_auth()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00287">setup_auth_srv()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00093">store_auth()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00309">verify_result_str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00405">digest_check_auth()</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   pj_status_t authed;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   <span class="keywordtype">int</span> response_code;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   pjsip_auth_srv auth_server;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <span class="keywordtype">int</span> stale = 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="keywordtype">int</span> res = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e">AUTH_FAIL</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1e0e90149e7047d8d30110829d9c6f4c">find_challenge</a>(rdata, auth)) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="comment">/* Couldn&#39;t find a challenge with a sane nonce.</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">       * Nonce mismatch may just be due to staleness.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      stale = 1;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a07a16e20ca21eba467f79a08cf9fea77">setup_auth_srv</a>(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, &amp;auth_server, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a904e7f74e585dd50e4aeabe7fa6072d5">store_auth</a>(auth);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   authed = pjsip_auth_srv_verify(&amp;auth_server, rdata, &amp;response_code);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#aae87ced83d2c2b4f9c5f56085bb6e012">remove_auth</a>();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="keywordflow">if</span> (authed == PJ_SUCCESS) {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">if</span> (stale) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         res = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a">AUTH_STALE</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;         res = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02">AUTH_SUCCESS</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <span class="keywordflow">if</span> (authed == PJSIP_EAUTHNOAUTH) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      res = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a">AUTH_NOAUTH</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Realm: %s  Username: %s  Result: %s\n&quot;</span>,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">auth_user</a>, <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#accdf0cb27bfc7062aad382f6ce4025d1">verify_result_str</a>[res]);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;INCOMING_AUTH_VERIFY_RESULT&quot;</span>,</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="stringliteral">&quot;Realm: %s\r\n&quot;</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="stringliteral">&quot;Username: %s\r\n&quot;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="stringliteral">&quot;Status: %s&quot;</span>,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">realm</a>, auth-&gt;<a class="code" href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">auth_user</a>, <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#accdf0cb27bfc7062aad382f6ce4025d1">verify_result_str</a>[res]);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div><div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a15bfecd1f575ee18d4dd5d1cddcc3e02">AUTH_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00302">res_pjsip_authenticator_digest.c:302</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19aeb7311474d4eb60c3eb1a0062922124a">AUTH_STALE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00304">res_pjsip_authenticator_digest.c:304</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19a5908db17b53ddc1751a2e4aa64099c2a">AUTH_NOAUTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00306">res_pjsip_authenticator_digest.c:306</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a904e7f74e585dd50e4aeabe7fa6072d5"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a904e7f74e585dd50e4aeabe7fa6072d5">store_auth</a></div><div class="ttdeci">static int store_auth(const struct ast_sip_auth *auth)</div><div class="ttdoc">Store shallow copy authentication information in thread-local storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00093">res_pjsip_authenticator_digest.c:93</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_accdf0cb27bfc7062aad382f6ce4025d1"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#accdf0cb27bfc7062aad382f6ce4025d1">verify_result_str</a></div><div class="ttdeci">static char * verify_result_str[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00309">res_pjsip_authenticator_digest.c:309</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a71767d73977f42a36bcb04fb76f7a286"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a71767d73977f42a36bcb04fb76f7a286">ast_sip_auth::realm</a></div><div class="ttdeci">const ast_string_field realm</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00448">res_pjsip.h:448</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a07a16e20ca21eba467f79a08cf9fea77"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a07a16e20ca21eba467f79a08cf9fea77">setup_auth_srv</a></div><div class="ttdeci">static void setup_auth_srv(pj_pool_t *pool, pjsip_auth_srv *auth_server, const char *realm)</div><div class="ttdoc">Common code for initializing a pjsip_auth_srv. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00287">res_pjsip_authenticator_digest.c:287</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_aae87ced83d2c2b4f9c5f56085bb6e012"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#aae87ced83d2c2b4f9c5f56085bb6e012">remove_auth</a></div><div class="ttdeci">static int remove_auth(void)</div><div class="ttdoc">Remove shallow copy authentication information from thread-local storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00109">res_pjsip_authenticator_digest.c:109</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1e0e90149e7047d8d30110829d9c6f4c"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1e0e90149e7047d8d30110829d9c6f4c">find_challenge</a></div><div class="ttdeci">static int find_challenge(const pjsip_rx_data *rdata, const struct ast_sip_auth *auth)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00267">res_pjsip_authenticator_digest.c:267</a></div></div>
<div class="ttc" id="structast__sip__auth_html_a9dfeb2fdce6acf9c0f869d674aa5a1c2"><div class="ttname"><a href="../../d0/d01/structast__sip__auth.html#a9dfeb2fdce6acf9c0f869d674aa5a1c2">ast_sip_auth::auth_user</a></div><div class="ttdeci">const ast_string_field auth_user</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00450">res_pjsip.h:450</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a1cf295633d0179111d9fe2d3b872cb19ad74c04fb63cdfdc4dacb03bd22f7e64e">AUTH_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00300">res_pjsip_authenticator_digest.c:300</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP authentication resource&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .reload = reload_module, .load_pri = AST_MODPRI_CHANNEL_DEPEND - 5, .requires = &quot;res_pjsip&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00573">573</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00573">573</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<a id="a5045f31007234b9e82de0350c4d49dfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5045f31007234b9e82de0350c4d49dfe">&#9670;&nbsp;</a></span>auth_store</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d17/structast__threadstorage.html">ast_threadstorage</a> auth_store = { .once = PTHREAD_ONCE_INIT , .key_init = <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a6143b51368f8255b368c4fc2dd95da91">__init_auth_store</a> , .custom_init = <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> , }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00088">88</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00125">get_auth()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00109">remove_auth()</a>, and <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00093">store_auth()</a>.</p>

</div>
</div>
<a id="a3971caa7a574924ac701f25d5f708ebb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3971caa7a574924ac701f25d5f708ebb">&#9670;&nbsp;</a></span>default_realm</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char default_realm[<a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a4cd636e6e8acb7f77b7c945a4e2f1b29">MAX_REALM_LENGTH</a>+1]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00037">37</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00614">create_artificial_auth()</a>, <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00405">digest_check_auth()</a>, and <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l01165">global_loaded()</a>.</p>

</div>
</div>
<a id="addb83444e6f650d21ebdd890b4101ad4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addb83444e6f650d21ebdd890b4101ad4">&#9670;&nbsp;</a></span>digest_authenticator</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/de9/structast__sip__authenticator.html">ast_sip_authenticator</a> digest_authenticator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .requires_authentication = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ada73daa4f9f0edca64b08d62d00a7c7e">digest_requires_authentication</a>,</div><div class="line">   .check_authentication = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ac002a8b1a18aabf8eed9cf620eb717ec">digest_check_auth</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__authenticator__digest_8c_html_ada73daa4f9f0edca64b08d62d00a7c7e"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ada73daa4f9f0edca64b08d62d00a7c7e">digest_requires_authentication</a></div><div class="ttdeci">static int digest_requires_authentication(struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata)</div><div class="ttdoc">Determine if authentication is required. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00047">res_pjsip_authenticator_digest.c:47</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_ac002a8b1a18aabf8eed9cf620eb717ec"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ac002a8b1a18aabf8eed9cf620eb717ec">digest_check_auth</a></div><div class="ttdeci">static enum ast_sip_check_auth_result digest_check_auth(struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata, pjsip_tx_data *tdata)</div><div class="ttdoc">Check authentication using Digest scheme. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00405">res_pjsip_authenticator_digest.c:405</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00504">504</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<a id="a0872cb2fc431c02f2b19ff1d58145c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0872cb2fc431c02f2b19ff1d58145c2d">&#9670;&nbsp;</a></span>global_observer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> global_observer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .loaded = <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a2244349ff10e2b679104328f8829617a">global_loaded</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__authenticator__digest_8c_html_a2244349ff10e2b679104328f8829617a"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#a2244349ff10e2b679104328f8829617a">global_loaded</a></div><div class="ttdeci">static void global_loaded(const char *object_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00524">res_pjsip_authenticator_digest.c:524</a></div></div>
</div><!-- fragment -->
<p>Observer which is used to update our default_realm when the global setting changes. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00530">530</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

</div>
</div>
<a id="accdf0cb27bfc7062aad382f6ce4025d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accdf0cb27bfc7062aad382f6ce4025d1">&#9670;&nbsp;</a></span>verify_result_str</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char* verify_result_str[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00309">309</a> of file <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html">res_pjsip_authenticator_digest.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00324">verify()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:30 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
