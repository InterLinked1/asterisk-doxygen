<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_stasis_snoop.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_stasis_snoop.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Stasis application snoop control support.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d0b/stasis__app__impl_8h_source.html">asterisk/stasis_app_impl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d9b/stasis__app__snoop_8h_source.html">asterisk/stasis_app_snoop.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d79/audiohook_8h_source.html">asterisk/audiohook.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/de0/pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d41/timing_8h_source.html">asterisk/timing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d4a/stasis__channels_8h_source.html">asterisk/stasis_channels.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d05/json_8h_source.html">asterisk/json.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d1c/format__cache_8h_source.html">asterisk/format_cache.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_stasis_snoop.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d98/res__stasis__snoop_8c__incl.png" border="0" usemap="#res__stasis__snoop_8c" alt=""/></div>
<map name="res__stasis__snoop_8c" id="res__stasis__snoop_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="620,393,704,420"/>
<area shape="rect" id="node22" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1864,169,2000,196"/>
<area shape="rect" id="node31" href="../../de/d0b/stasis__app__impl_8h.html" title="Backend API for implementing components of res_stasis. " alt="" coords="1296,80,1440,121"/>
<area shape="rect" id="node37" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="948,393,1063,420"/>
<area shape="rect" id="node38" href="../../d7/d9b/stasis__app__snoop_8h.html" title="Stasis Application Snoop API. See StasisApplication API&quot; for detailed documentation. " alt="" coords="1128,80,1272,121"/>
<area shape="rect" id="node39" href="../../d0/d79/audiohook_8h.html" title="Audiohooks Architecture. " alt="" coords="950,87,1104,114"/>
<area shape="rect" id="node42" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="1570,169,1681,196"/>
<area shape="rect" id="node48" href="../../db/d41/timing_8h.html" title="Timing source management. " alt="" coords="1566,87,1694,114"/>
<area shape="rect" id="node49" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1356,169,1546,196"/>
<area shape="rect" id="node50" href="../../db/d1c/format__cache_8h.html" title="Media Format Cache API. " alt="" coords="1768,87,1944,114"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="562,617,716,644"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="673,468,810,495"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="514,468,649,495"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="566,692,712,719"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1042,543,1185,569"/>
<area shape="rect" id="node23" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1514,393,1628,420"/>
<area shape="rect" id="node24" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="1512,468,1651,495"/>
<area shape="rect" id="node25" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1396,543,1458,569"/>
<area shape="rect" id="node26" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1102,468,1216,495"/>
<area shape="rect" id="node27" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1574,543,1701,569"/>
<area shape="rect" id="node28" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="1291,468,1438,495"/>
<area shape="rect" id="node29" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1931,468,2088,495"/>
<area shape="rect" id="node30" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1776,468,1907,495"/>
<area shape="rect" id="node32" href="../../d8/d9c/stasis__app_8h.html" title="Stasis Application API. See Stasis Application API for detailed documentation. " alt="" coords="1176,169,1332,196"/>
<area shape="rect" id="node33" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1286,244,1424,271"/>
<area shape="rect" id="node34" href="../../d9/de7/chanvars_8h.html" title="Channel Variables. " alt="" coords="1150,319,1296,345"/>
<area shape="rect" id="node35" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1116,393,1266,420"/>
<area shape="rect" id="node36" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1000,319,1126,345"/>
<area shape="rect" id="node40" href="../../da/d7d/slinfactory_8h.html" title="A machine to gather up arbitrary frames and convert them to raw slinear on demand. " alt="" coords="1001,169,1152,196"/>
<area shape="rect" id="node41" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="1080,244,1211,271"/>
<area shape="rect" id="node43" href="../../d7/d00/sched_8h.html" title="Scheduler Routines (derived from cheops) " alt="" coords="1601,244,1728,271"/>
<area shape="rect" id="node44" href="../../da/da2/devicestate_8h.html" title="Device state management. " alt="" coords="1703,319,1866,345"/>
<area shape="rect" id="node45" href="../../d6/dd7/presencestate_8h.html" title="Presence state management. " alt="" coords="1752,244,1932,271"/>
<area shape="rect" id="node46" href="../../d6/da0/hashtab_8h.html" title="Generic (perhaps overly so) hashtable implementation Hash Table support in Asterisk. " alt="" coords="1473,319,1613,345"/>
<area shape="rect" id="node47" href="../../d1/d99/xmldoc_8h.html" title="Asterisk XML Documentation API. " alt="" coords="1797,393,1932,420"/>
</map>
</div>
</div>
<p><a href="../../dd/da3/res__stasis__snoop_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure which contains all of the snoop information.  <a href="../../d5/d77/structstasis__app__snoop.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afa17561e4b5e6858cbe23ff203c1e685"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#afa17561e4b5e6858cbe23ff203c1e685">SNOOP_INTERVAL</a>&#160;&#160;&#160;20</td></tr>
<tr class="memdesc:afa17561e4b5e6858cbe23ff203c1e685"><td class="mdescLeft">&#160;</td><td class="mdescRight">The interval (in milliseconds) that the Snoop timer is triggered, also controls length of audio within frames.  <a href="#afa17561e4b5e6858cbe23ff203c1e685">More...</a><br /></td></tr>
<tr class="separator:afa17561e4b5e6858cbe23ff203c1e685"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a01f5a85b808b6a1d1dee83678f46e9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#a2a01f5a85b808b6a1d1dee83678f46e9">publish_chanspy_message</a> (struct <a class="el" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *snoop, int start)</td></tr>
<tr class="separator:a2a01f5a85b808b6a1d1dee83678f46e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a697ff4e2e7f1677bd5bab17f43f00aa1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#a697ff4e2e7f1677bd5bab17f43f00aa1">snoop_destroy</a> (void *obj)</td></tr>
<tr class="memdesc:a697ff4e2e7f1677bd5bab17f43f00aa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for snoop structure.  <a href="#a697ff4e2e7f1677bd5bab17f43f00aa1">More...</a><br /></td></tr>
<tr class="separator:a697ff4e2e7f1677bd5bab17f43f00aa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfa4d1f6eb8f84d8ba86b6099b43eb7f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#abfa4d1f6eb8f84d8ba86b6099b43eb7f">snoop_determine_format</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, struct <a class="el" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *snoop)</td></tr>
<tr class="memdesc:abfa4d1f6eb8f84d8ba86b6099b43eb7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function which gets the format for a Snoop channel based on the channel being snooped on.  <a href="#abfa4d1f6eb8f84d8ba86b6099b43eb7f">More...</a><br /></td></tr>
<tr class="separator:abfa4d1f6eb8f84d8ba86b6099b43eb7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14261cecf287f93ad3ad8f51e2be3e75"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#a14261cecf287f93ad3ad8f51e2be3e75">snoop_fixup</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *oldchan, struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *newchan)</td></tr>
<tr class="separator:a14261cecf287f93ad3ad8f51e2be3e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad73c202da8f8449542835571d6baa8d0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ad73c202da8f8449542835571d6baa8d0">snoop_hangup</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</td></tr>
<tr class="memdesc:ad73c202da8f8449542835571d6baa8d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for hanging up a Snoop channel.  <a href="#ad73c202da8f8449542835571d6baa8d0">More...</a><br /></td></tr>
<tr class="separator:ad73c202da8f8449542835571d6baa8d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78ceac74eb40bce5fe1022cb1b2049ec"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#a78ceac74eb40bce5fe1022cb1b2049ec">snoop_read</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</td></tr>
<tr class="memdesc:a78ceac74eb40bce5fe1022cb1b2049ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for reading from a Snoop channel.  <a href="#a78ceac74eb40bce5fe1022cb1b2049ec">More...</a><br /></td></tr>
<tr class="separator:a78ceac74eb40bce5fe1022cb1b2049ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56c2047ab01037d1a1b539a652a216d5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#a56c2047ab01037d1a1b539a652a216d5">snoop_setup_audiohook</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, enum <a class="el" href="../../d0/d79/audiohook_8h.html#abce1d2faae234aa016905215014542b0">ast_audiohook_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, enum <a class="el" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849">stasis_app_snoop_direction</a> requested_direction, enum <a class="el" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899">ast_audiohook_direction</a> *<a class="el" href="../../d4/d8b/func__frame__drop_8c.html#a99f26e6ee9fcd62f75203b5402df8098">direction</a>, struct <a class="el" href="../../d2/d49/structast__audiohook.html">ast_audiohook</a> *audiohook)</td></tr>
<tr class="memdesc:a56c2047ab01037d1a1b539a652a216d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal helper function which sets up and attaches a snoop audiohook.  <a href="#a56c2047ab01037d1a1b539a652a216d5">More...</a><br /></td></tr>
<tr class="separator:a56c2047ab01037d1a1b539a652a216d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8df9dd0b4144142af14e17a476be737"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ac8df9dd0b4144142af14e17a476be737">snoop_stasis_thread</a> (void *obj)</td></tr>
<tr class="memdesc:ac8df9dd0b4144142af14e17a476be737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread used for running the Stasis application.  <a href="#ac8df9dd0b4144142af14e17a476be737">More...</a><br /></td></tr>
<tr class="separator:ac8df9dd0b4144142af14e17a476be737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e942b2d0c309ef352e3e309fe5bf20"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ad8e942b2d0c309ef352e3e309fe5bf20">snoop_write</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *frame)</td></tr>
<tr class="memdesc:ad8e942b2d0c309ef352e3e309fe5bf20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback function for writing to a Snoop whisper audiohook.  <a href="#ad8e942b2d0c309ef352e3e309fe5bf20">More...</a><br /></td></tr>
<tr class="separator:ad8e942b2d0c309ef352e3e309fe5bf20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe99c28a854f5be66baa6df2dfdc04c9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#abe99c28a854f5be66baa6df2dfdc04c9">stasis_app_control_snoop</a> (struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, enum <a class="el" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849">stasis_app_snoop_direction</a> spy, enum <a class="el" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849">stasis_app_snoop_direction</a> whisper, const char *<a class="el" href="../../dd/de9/res__agi_8c.html#a9e5f57131367eff409b9e0bd7b31aa1a">app</a>, const char *app_args, const char *snoop_id)</td></tr>
<tr class="memdesc:abe99c28a854f5be66baa6df2dfdc04c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a snoop on the provided channel.  <a href="#abe99c28a854f5be66baa6df2dfdc04c9">More...</a><br /></td></tr>
<tr class="separator:abe99c28a854f5be66baa6df2dfdc04c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> , .description = &quot;Stasis application snoop support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .requires = &quot;res_stasis&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7b8d8b99d184d28a5f0e9fe66a47261"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ad7b8d8b99d184d28a5f0e9fe66a47261">chan_idx</a></td></tr>
<tr class="memdesc:ad7b8d8b99d184d28a5f0e9fe66a47261"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index used to keep Snoop channel names unique.  <a href="#ad7b8d8b99d184d28a5f0e9fe66a47261">More...</a><br /></td></tr>
<tr class="separator:ad7b8d8b99d184d28a5f0e9fe66a47261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38ec205a3e6c4b05785fe5d9ddc1746"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d4/d85/structast__channel__tech.html">ast_channel_tech</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da3/res__stasis__snoop_8c.html#ab38ec205a3e6c4b05785fe5d9ddc1746">snoop_tech</a></td></tr>
<tr class="memdesc:ab38ec205a3e6c4b05785fe5d9ddc1746"><td class="mdescLeft">&#160;</td><td class="mdescRight">Channel interface declaration.  <a href="#ab38ec205a3e6c4b05785fe5d9ddc1746">More...</a><br /></td></tr>
<tr class="separator:ab38ec205a3e6c4b05785fe5d9ddc1746"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Stasis application snoop control support. </p>
<dl class="section author"><dt>Author</dt><dd>Joshua Colp <a href="#" onclick="location.href='mai'+'lto:'+'jco'+'lp'+'@di'+'gi'+'um.'+'co'+'m'; return false;">jcolp<span style="display: none;">.nosp@m.</span>@dig<span style="display: none;">.nosp@m.</span>ium.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afa17561e4b5e6858cbe23ff203c1e685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa17561e4b5e6858cbe23ff203c1e685">&#9670;&nbsp;</a></span>SNOOP_INTERVAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SNOOP_INTERVAL&#160;&#160;&#160;20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The interval (in milliseconds) that the Snoop timer is triggered, also controls length of audio within frames. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00044">44</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">stasis_app_control_snoop()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00451">451</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00451">451</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00451">451</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00436">436</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00441">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div><div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a01f5a85b808b6a1d1dee83678f46e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a01f5a85b808b6a1d1dee83678f46e9">&#9670;&nbsp;</a></span>publish_chanspy_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void publish_chanspy_message </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *&#160;</td>
          <td class="paramname"><em>snoop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00113">113</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga82b40d5d80727f7fd39b6d1fbca3131e">ast_channel_chanspy_start_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#ga689d6e83223f090da8c87e2efd793940">ast_channel_chanspy_stop_type()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00903">ast_channel_snapshot_get_latest()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01502">ast_channel_topic()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00305">ast_channel_uniqueid()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00248">ast_json_null()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00956">ast_multi_channel_blob_add_channel()</a>, <a class="el" href="../../dc/d2b/stasis__channels_8c_source.html#l00881">ast_multi_channel_blob_create()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00068">stasis_app_snoop::chan</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00070">stasis_app_snoop::spyee_chan</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message_create()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01511">stasis_publish()</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00212">snoop_hangup()</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">stasis_app_control_snoop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../df/dcb/structast__multi__channel__blob.html">ast_multi_channel_blob</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, <a class="code" href="../../d8/d9e/structmessage.html">message</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, snoop_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, spyee_snapshot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> = start ? <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga82b40d5d80727f7fd39b6d1fbca3131e">ast_channel_chanspy_start_type</a>(): <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga689d6e83223f090da8c87e2efd793940">ast_channel_chanspy_stop_type</a>();</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   blob = <a class="code" href="../../d4/d05/json_8h.html#a8055cb3a9f4d7d5842826e6157ae00db">ast_json_null</a>();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keywordflow">if</span> (!blob || !type) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;   }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   payload = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafe90e356833a3ec8ba6020a39d0689b9">ast_multi_channel_blob_create</a>(blob);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   snoop_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">chan</a>));</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keywordflow">if</span> (!snoop_snapshot) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga9a3ff91f86f5f2e7e60571246c8e5873">ast_multi_channel_blob_add_channel</a>(payload, <span class="stringliteral">&quot;spyer_channel&quot;</span>, snoop_snapshot);</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   spyee_snapshot = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a9aaa539ad7ec22b6c469c6ddc7383c97">spyee_chan</a>));</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordflow">if</span> (spyee_snapshot) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga9a3ff91f86f5f2e7e60571246c8e5873">ast_multi_channel_blob_add_channel</a>(payload, <span class="stringliteral">&quot;spyee_channel&quot;</span>, spyee_snapshot);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <a class="code" href="../../d8/d9e/structmessage.html">message</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(type, payload);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9e/structmessage.html">message</a>) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../d5/d7b/channel_8h.html#afdeaf9abb1aecc715313a4f62c1cf9c9">ast_channel_topic</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">chan</a>), <a class="code" href="../../d8/d9e/structmessage.html">message</a>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structmessage_html"><div class="ttname"><a href="../../d8/d9e/structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00144">manager.h:144</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a></div><div class="ttdoc">Structure representing a snapshot of channel state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00145">stasis_channels.h:145</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga82b40d5d80727f7fd39b6d1fbca3131e"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga82b40d5d80727f7fd39b6d1fbca3131e">ast_channel_chanspy_start_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_chanspy_start_type(void)</div><div class="ttdoc">Message type for when a channel starts spying on another channel. </div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a9aaa539ad7ec22b6c469c6ddc7383c97"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a9aaa539ad7ec22b6c469c6ddc7383c97">stasis_app_snoop::spyee_chan</a></div><div class="ttdeci">struct ast_channel * spyee_chan</div><div class="ttdoc">The channel that the Snoop channel is snooping on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00070">res_stasis_snoop.c:70</a></div></div>
<div class="ttc" id="json_8h_html_a8055cb3a9f4d7d5842826e6157ae00db"><div class="ttname"><a href="../../d4/d05/json_8h.html#a8055cb3a9f4d7d5842826e6157ae00db">ast_json_null</a></div><div class="ttdeci">struct ast_json * ast_json_null(void)</div><div class="ttdoc">Get the JSON null value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00248">json.c:248</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">stasis_app_snoop::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdoc">Snoop channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00068">res_stasis_snoop.c:68</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga9a3ff91f86f5f2e7e60571246c8e5873"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga9a3ff91f86f5f2e7e60571246c8e5873">ast_multi_channel_blob_add_channel</a></div><div class="ttdeci">void ast_multi_channel_blob_add_channel(struct ast_multi_channel_blob *obj, const char *role, struct ast_channel_snapshot *snapshot)</div><div class="ttdoc">Add a ast_channel_snapshot to a ast_multi_channel_blob object. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00956">stasis_channels.c:956</a></div></div>
<div class="ttc" id="structstasis__message__type_html"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00038">stasis_message.c:38</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="channel_8h_html_afdeaf9abb1aecc715313a4f62c1cf9c9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afdeaf9abb1aecc715313a4f62c1cf9c9">ast_channel_topic</a></div><div class="ttdeci">struct stasis_topic * ast_channel_topic(struct ast_channel *chan)</div><div class="ttdoc">A topic which publishes the events for a particular channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01502">channel_internal_api.c:1502</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga68c55b443ba97dc157b493aafd05c876"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_get_latest(const char *uniqueid)</div><div class="ttdoc">Obtain the latest ast_channel_snapshot from the Stasis Message Bus API cache. This is an ao2 object...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00903">stasis_channels.c:903</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__multi__channel__blob_html"><div class="ttname"><a href="../../df/dcb/structast__multi__channel__blob.html">ast_multi_channel_blob</a></div><div class="ttdoc">A multi channel blob data structure for multi_channel_blob stasis messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00811">stasis_channels.c:811</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafe90e356833a3ec8ba6020a39d0689b9"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafe90e356833a3ec8ba6020a39d0689b9">ast_multi_channel_blob_create</a></div><div class="ttdeci">struct ast_multi_channel_blob * ast_multi_channel_blob_create(struct ast_json *blob)</div><div class="ttdoc">Create a ast_multi_channel_blob suitable for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00881">stasis_channels.c:881</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga689d6e83223f090da8c87e2efd793940"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga689d6e83223f090da8c87e2efd793940">ast_channel_chanspy_stop_type</a></div><div class="ttdeci">struct stasis_message_type * ast_channel_chanspy_stop_type(void)</div><div class="ttdoc">Message type for when a channel stops spying on another channel. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a697ff4e2e7f1677bd5bab17f43f00aa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a697ff4e2e7f1677bd5bab17f43f00aa1">&#9670;&nbsp;</a></span>snoop_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void snoop_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for snoop structure. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00080">80</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00066">stasis_app_snoop::app</a>, <a class="el" href="../../d9/d4f/audiohook_8c_source.html#l00133">ast_audiohook_destroy()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02992">ast_channel_cleanup</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d3/d62/timing_8c_source.html#l00154">ast_timer_close()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00068">stasis_app_snoop::chan</a>, <a class="el" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">ast_frame::ptr</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00076">stasis_app_snoop::silence</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00054">stasis_app_snoop::spy</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00072">stasis_app_snoop::spy_active</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00070">stasis_app_snoop::spyee_chan</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00052">stasis_app_snoop::timer</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">stasis_app_snoop::whisper</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">stasis_app_snoop::whisper_active</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">stasis_app_control_snoop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *snoop = obj;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="../../db/d41/timing_8h.html#a2a5968baf9962dedeeda855fd5ed9c75">ast_timer_close</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a21b1d9eb6f0a7721ae6e307ea31f92c9">spy_active</a>) {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a9fa661730d6fa6b9b12e410d66a3437b">ast_audiohook_destroy</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">whisper_active</a>) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a9fa661730d6fa6b9b12e410d66a3437b">ast_audiohook_destroy</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#ac78bb3075a62ec82d12c9723de310a47">silence</a>.<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#ac78bb3075a62ec82d12c9723de310a47">silence</a>.<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#ac78bb3075a62ec82d12c9723de310a47">silence</a>.<a class="code" href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">data</a>.<a class="code" href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ptr</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a1a802092e270cc0803416cbd0e8091ab">app</a>);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a9aaa539ad7ec22b6c469c6ddc7383c97">spyee_chan</a>);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div><div class="ttc" id="structstasis__app__snoop_html_a2b96a911762f2f9940d33bfa438095cd"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">stasis_app_snoop::spy</a></div><div class="ttdeci">struct ast_audiohook spy</div><div class="ttdoc">Audiohook used to spy on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00054">res_stasis_snoop.c:54</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a1a802092e270cc0803416cbd0e8091ab"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a1a802092e270cc0803416cbd0e8091ab">stasis_app_snoop::app</a></div><div class="ttdeci">struct ast_str * app</div><div class="ttdoc">Stasis application and arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00066">res_stasis_snoop.c:66</a></div></div>
<div class="ttc" id="structast__frame_html_add9af9569af79ec26dd741fb226b38ba"><div class="ttname"><a href="../../d0/d99/structast__frame.html#add9af9569af79ec26dd741fb226b38ba">ast_frame::ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00183">include/asterisk/frame.h:183</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a4e4feb27f4d65499557ad4d94e79fa5e"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">stasis_app_snoop::whisper</a></div><div class="ttdeci">struct ast_audiohook whisper</div><div class="ttdoc">Audiohook used to whisper on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">res_stasis_snoop.c:62</a></div></div>
<div class="ttc" id="timing_8h_html_a2a5968baf9962dedeeda855fd5ed9c75"><div class="ttname"><a href="../../db/d41/timing_8h.html#a2a5968baf9962dedeeda855fd5ed9c75">ast_timer_close</a></div><div class="ttdeci">void ast_timer_close(struct ast_timer *handle)</div><div class="ttdoc">Close an opened timing handle. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d62/timing_8c_source.html#l00154">timing.c:154</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="audiohook_8h_html_a9fa661730d6fa6b9b12e410d66a3437b"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a9fa661730d6fa6b9b12e410d66a3437b">ast_audiohook_destroy</a></div><div class="ttdeci">int ast_audiohook_destroy(struct ast_audiohook *audiohook)</div><div class="ttdoc">Destroys an audiohook structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4f/audiohook_8c_source.html#l00133">audiohook.c:133</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a9aaa539ad7ec22b6c469c6ddc7383c97"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a9aaa539ad7ec22b6c469c6ddc7383c97">stasis_app_snoop::spyee_chan</a></div><div class="ttdeci">struct ast_channel * spyee_chan</div><div class="ttdoc">The channel that the Snoop channel is snooping on. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00070">res_stasis_snoop.c:70</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></div><div class="ttdoc">Structure which contains all of the snoop information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00050">res_stasis_snoop.c:50</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">stasis_app_snoop::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdoc">Snoop channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00068">res_stasis_snoop.c:68</a></div></div>
<div class="ttc" id="channel_8h_html_ae93ebb3372a2d9495ae3c5417dd95cd5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae93ebb3372a2d9495ae3c5417dd95cd5">ast_channel_cleanup</a></div><div class="ttdeci">#define ast_channel_cleanup(c)</div><div class="ttdoc">Cleanup a channel reference. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02992">channel.h:2992</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a9aed6490b63794e6c9c00af4533f255f"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a9aed6490b63794e6c9c00af4533f255f">stasis_app_snoop::timer</a></div><div class="ttdeci">struct ast_timer * timer</div><div class="ttdoc">Timer used for waking up Stasis thread. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00052">res_stasis_snoop.c:52</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_acc912727348c4a47eacd84acb34b3dd5"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">stasis_app_snoop::whisper_active</a></div><div class="ttdeci">unsigned int whisper_active</div><div class="ttdoc">Whether the whisper capability is active or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">res_stasis_snoop.c:74</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a21b1d9eb6f0a7721ae6e307ea31f92c9"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a21b1d9eb6f0a7721ae6e307ea31f92c9">stasis_app_snoop::spy_active</a></div><div class="ttdeci">unsigned int spy_active</div><div class="ttdoc">Whether the spy capability is active or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00072">res_stasis_snoop.c:72</a></div></div>
<div class="ttc" id="structast__frame_html_a4027905f872af30d910929b07e261ca5"><div class="ttname"><a href="../../d0/d99/structast__frame.html#a4027905f872af30d910929b07e261ca5">ast_frame::data</a></div><div class="ttdeci">union ast_frame::@263 data</div></div>
<div class="ttc" id="structstasis__app__snoop_html_ac78bb3075a62ec82d12c9723de310a47"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#ac78bb3075a62ec82d12c9723de310a47">stasis_app_snoop::silence</a></div><div class="ttdeci">struct ast_frame silence</div><div class="ttdoc">A frame of silence to use when the audiohook returns null. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00076">res_stasis_snoop.c:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abfa4d1f6eb8f84d8ba86b6099b43eb7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa4d1f6eb8f84d8ba86b6099b43eb7f">&#9670;&nbsp;</a></span>snoop_determine_format()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void snoop_determine_format </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *&#160;</td>
          <td class="paramname"><em>snoop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function which gets the format for a Snoop channel based on the channel being snooped on. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00300">300</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00848">ast_channel_rawreadformat()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00852">ast_channel_rawwriteformat()</a>, <a class="el" href="../../d9/d29/format__cache_8c_source.html#l00520">ast_format_cache_get_slin_by_rate()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00379">ast_format_get_sample_rate()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00228">MAX</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00617">SCOPED_CHANNELLOCK</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00060">stasis_app_snoop::spy_format</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">stasis_app_control_snoop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#aa11d2e2d6aaa7048d48491842c1de738">SCOPED_CHANNELLOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, chan);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rate = <a class="code" href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ad27c52cda6e6435a121900661ad5bdce">ast_channel_rawwriteformat</a>(chan)),</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aa6ceb6b9067d793c4d00c566ae585f0b">ast_channel_rawreadformat</a>(chan)));</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a03635affcd98b9d04be26c6838ceb267">spy_format</a> = <a class="code" href="../../db/d1c/format__cache_8h.html#ab660f51155ceeabb4abd0e25cd3a11a6">ast_format_cache_get_slin_by_rate</a>(rate);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div><div class="ttc" id="utils_8h_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00228">utils.h:228</a></div></div>
<div class="ttc" id="lock_8h_html_aa11d2e2d6aaa7048d48491842c1de738"><div class="ttname"><a href="../../dd/d42/lock_8h.html#aa11d2e2d6aaa7048d48491842c1de738">SCOPED_CHANNELLOCK</a></div><div class="ttdeci">#define SCOPED_CHANNELLOCK(varname, chan)</div><div class="ttdoc">scoped lock specialization for channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00617">lock.h:617</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="channel_8h_html_aa6ceb6b9067d793c4d00c566ae585f0b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa6ceb6b9067d793c4d00c566ae585f0b">ast_channel_rawreadformat</a></div><div class="ttdeci">struct ast_format * ast_channel_rawreadformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00848">channel_internal_api.c:848</a></div></div>
<div class="ttc" id="format_8h_html_a499e920008f775eebadd958a42e85862"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a></div><div class="ttdeci">unsigned int ast_format_get_sample_rate(const struct ast_format *format)</div><div class="ttdoc">Get the sample rate of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00379">format.c:379</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a03635affcd98b9d04be26c6838ceb267"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a03635affcd98b9d04be26c6838ceb267">stasis_app_snoop::spy_format</a></div><div class="ttdeci">struct ast_format * spy_format</div><div class="ttdoc">Format in use by the spy audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00060">res_stasis_snoop.c:60</a></div></div>
<div class="ttc" id="channel_8h_html_ad27c52cda6e6435a121900661ad5bdce"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ad27c52cda6e6435a121900661ad5bdce">ast_channel_rawwriteformat</a></div><div class="ttdeci">struct ast_format * ast_channel_rawwriteformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00852">channel_internal_api.c:852</a></div></div>
<div class="ttc" id="format__cache_8h_html_ab660f51155ceeabb4abd0e25cd3a11a6"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#ab660f51155ceeabb4abd0e25cd3a11a6">ast_format_cache_get_slin_by_rate</a></div><div class="ttdeci">struct ast_format * ast_format_cache_get_slin_by_rate(unsigned int rate)</div><div class="ttdoc">Retrieve the best signed linear format given a sample rate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00520">format_cache.c:520</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14261cecf287f93ad3ad8f51e2be3e75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14261cecf287f93ad3ad8f51e2be3e75">&#9670;&nbsp;</a></span>snoop_fixup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int snoop_fixup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>oldchan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>newchan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00237">237</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h_source.html#l02970">ast_channel_ref</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00565">ast_channel_tech_pvt()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02981">ast_channel_unref</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00068">stasis_app_snoop::chan</a>.</p>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *snoop = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(oldchan);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">chan</a> != oldchan) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">chan</a>);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(newchan);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">chan</a> = newchan;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div><div class="ttc" id="channel_8h_html_a3dc9d235c0e16ab0a6812b4aa6572cce"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a></div><div class="ttdeci">void * ast_channel_tech_pvt(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00565">channel_internal_api.c:565</a></div></div>
<div class="ttc" id="channel_8h_html_ab733a7825810b895a89b629e0ea89380"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a></div><div class="ttdeci">#define ast_channel_unref(c)</div><div class="ttdoc">Decrease channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02981">channel.h:2981</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></div><div class="ttdoc">Structure which contains all of the snoop information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00050">res_stasis_snoop.c:50</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a84d1435c5b8d387806714ea7079304b7"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a84d1435c5b8d387806714ea7079304b7">stasis_app_snoop::chan</a></div><div class="ttdeci">struct ast_channel * chan</div><div class="ttdoc">Snoop channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00068">res_stasis_snoop.c:68</a></div></div>
<div class="ttc" id="channel_8h_html_a6801c703e767d6f760c54c8b86a30024"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a></div><div class="ttdeci">#define ast_channel_ref(c)</div><div class="ttdoc">Increase channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02970">channel.h:2970</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad73c202da8f8449542835571d6baa8d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad73c202da8f8449542835571d6baa8d0">&#9670;&nbsp;</a></span>snoop_hangup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int snoop_hangup </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function for hanging up a Snoop channel. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00212">212</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d9/d4f/audiohook_8c_source.html#l00579">ast_audiohook_detach()</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00295">ast_audiohook_lock</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00300">ast_audiohook_unlock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00565">ast_channel_tech_pvt()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00569">ast_channel_tech_pvt_set()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00113">publish_chanspy_message()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00054">stasis_app_snoop::spy</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00072">stasis_app_snoop::spy_active</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">stasis_app_snoop::whisper</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">stasis_app_snoop::whisper_active</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *snoop = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(chan);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a21b1d9eb6f0a7721ae6e307ea31f92c9">spy_active</a>) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a6456e346fe813617f13d5bbf7e92db5a">ast_audiohook_lock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a88b9ad3730e7adbc3b396bef4e85b12a">ast_audiohook_detach</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#aae4ac794c0f7ab8decd713cb9c43acf4">ast_audiohook_unlock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">whisper_active</a>) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a6456e346fe813617f13d5bbf7e92db5a">ast_audiohook_lock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a88b9ad3730e7adbc3b396bef4e85b12a">ast_audiohook_detach</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#aae4ac794c0f7ab8decd713cb9c43acf4">ast_audiohook_unlock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#a2a01f5a85b808b6a1d1dee83678f46e9">publish_chanspy_message</a>(snoop, 0);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(snoop);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a929b8b2cb36308e5cf4e51ed880bfcba">ast_channel_tech_pvt_set</a>(chan, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div><div class="ttc" id="structstasis__app__snoop_html_a2b96a911762f2f9940d33bfa438095cd"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">stasis_app_snoop::spy</a></div><div class="ttdeci">struct ast_audiohook spy</div><div class="ttdoc">Audiohook used to spy on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00054">res_stasis_snoop.c:54</a></div></div>
<div class="ttc" id="channel_8h_html_a3dc9d235c0e16ab0a6812b4aa6572cce"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a></div><div class="ttdeci">void * ast_channel_tech_pvt(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00565">channel_internal_api.c:565</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_a2a01f5a85b808b6a1d1dee83678f46e9"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#a2a01f5a85b808b6a1d1dee83678f46e9">publish_chanspy_message</a></div><div class="ttdeci">static void publish_chanspy_message(struct stasis_app_snoop *snoop, int start)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00113">res_stasis_snoop.c:113</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a4e4feb27f4d65499557ad4d94e79fa5e"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">stasis_app_snoop::whisper</a></div><div class="ttdeci">struct ast_audiohook whisper</div><div class="ttdoc">Audiohook used to whisper on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">res_stasis_snoop.c:62</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></div><div class="ttdoc">Structure which contains all of the snoop information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00050">res_stasis_snoop.c:50</a></div></div>
<div class="ttc" id="audiohook_8h_html_aae4ac794c0f7ab8decd713cb9c43acf4"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#aae4ac794c0f7ab8decd713cb9c43acf4">ast_audiohook_unlock</a></div><div class="ttdeci">#define ast_audiohook_unlock(ah)</div><div class="ttdoc">Unlock an audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00300">audiohook.h:300</a></div></div>
<div class="ttc" id="audiohook_8h_html_a88b9ad3730e7adbc3b396bef4e85b12a"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a88b9ad3730e7adbc3b396bef4e85b12a">ast_audiohook_detach</a></div><div class="ttdeci">int ast_audiohook_detach(struct ast_audiohook *audiohook)</div><div class="ttdoc">Detach audiohook from channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4f/audiohook_8c_source.html#l00579">audiohook.c:579</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_acc912727348c4a47eacd84acb34b3dd5"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">stasis_app_snoop::whisper_active</a></div><div class="ttdeci">unsigned int whisper_active</div><div class="ttdoc">Whether the whisper capability is active or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">res_stasis_snoop.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a21b1d9eb6f0a7721ae6e307ea31f92c9"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a21b1d9eb6f0a7721ae6e307ea31f92c9">stasis_app_snoop::spy_active</a></div><div class="ttdeci">unsigned int spy_active</div><div class="ttdoc">Whether the spy capability is active or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00072">res_stasis_snoop.c:72</a></div></div>
<div class="ttc" id="audiohook_8h_html_a6456e346fe813617f13d5bbf7e92db5a"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a6456e346fe813617f13d5bbf7e92db5a">ast_audiohook_lock</a></div><div class="ttdeci">#define ast_audiohook_lock(ah)</div><div class="ttdoc">Lock an audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00295">audiohook.h:295</a></div></div>
<div class="ttc" id="channel_8h_html_a929b8b2cb36308e5cf4e51ed880bfcba"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a929b8b2cb36308e5cf4e51ed880bfcba">ast_channel_tech_pvt_set</a></div><div class="ttdeci">void ast_channel_tech_pvt_set(struct ast_channel *chan, void *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00569">channel_internal_api.c:569</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78ceac74eb40bce5fe1022cb1b2049ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78ceac74eb40bce5fe1022cb1b2049ec">&#9670;&nbsp;</a></span>snoop_read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a>* snoop_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function for reading from a Snoop channel. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00173">173</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00051">AST_AUDIOHOOK_DIRECTION_BOTH</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00049">AST_AUDIOHOOK_DIRECTION_READ</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00050">AST_AUDIOHOOK_DIRECTION_WRITE</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00295">ast_audiohook_lock</a>, <a class="el" href="../../d9/d4f/audiohook_8c_source.html#l00449">ast_audiohook_read_frame()</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00043">AST_AUDIOHOOK_STATUS_RUNNING</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00300">ast_audiohook_unlock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00565">ast_channel_tech_pvt()</a>, <a class="el" href="../../df/d55/main_2frame_8c_source.html#l00187">ast_frame_dtor()</a>, <a class="el" href="../../df/d55/main_2frame_8c_source.html#l00079">ast_null_frame</a>, <a class="el" href="../../d3/d62/timing_8c_source.html#l00171">ast_timer_ack()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00076">stasis_app_snoop::silence</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00054">stasis_app_snoop::spy</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00072">stasis_app_snoop::spy_active</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00056">stasis_app_snoop::spy_direction</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00060">stasis_app_snoop::spy_format</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00058">stasis_app_snoop::spy_samples</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00107">ast_audiohook::status</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00052">stasis_app_snoop::timer</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">stasis_app_snoop::whisper</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">stasis_app_snoop::whisper_active</a>.</p>
<div class="fragment"><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *snoop = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(chan);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> *frame = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="comment">/* If we fail to ack the timer OR if any active audiohooks are done hangup */</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../db/d41/timing_8h.html#a338edb7e927b891ef4aba288d9c07e56">ast_timer_ack</a>(snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>, 1) &lt; 0) ||</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a21b1d9eb6f0a7721ae6e307ea31f92c9">spy_active</a> &amp;&amp; snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>.<a class="code" href="../../d2/d49/structast__audiohook.html#a9c2c1a66c786d5e486ac428388d62e28">status</a> != <a class="code" href="../../d0/d79/audiohook_8h.html#acf2dd361123daa6446ade7c7ecfe55adabcc7793ac9fbdcaa9e727aacfda27f26">AST_AUDIOHOOK_STATUS_RUNNING</a>) ||</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">whisper_active</a> &amp;&amp; snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>.<a class="code" href="../../d2/d49/structast__audiohook.html#a9c2c1a66c786d5e486ac428388d62e28">status</a> != <a class="code" href="../../d0/d79/audiohook_8h.html#acf2dd361123daa6446ade7c7ecfe55adabcc7793ac9fbdcaa9e727aacfda27f26">AST_AUDIOHOOK_STATUS_RUNNING</a>)) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="comment">/* Only get audio from the spy audiohook if it is active */</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">if</span> (!snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a21b1d9eb6f0a7721ae6e307ea31f92c9">spy_active</a>) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <a class="code" href="../../d0/d79/audiohook_8h.html#a6456e346fe813617f13d5bbf7e92db5a">ast_audiohook_lock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#ad43c810950c8927a684723574d626e70">spy_direction</a> != <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360">AST_AUDIOHOOK_DIRECTION_BOTH</a>) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">       * When a singular direction is chosen frames are still written to the</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">       * opposing direction&#39;s queue. Those frames must be read so the queue</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">       * does not continue to grow, however since they are not needed for the</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">       * selected direction they can be dropped.</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899">ast_audiohook_direction</a> opposing_direction =</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;         snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#ad43c810950c8927a684723574d626e70">spy_direction</a> == <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65">AST_AUDIOHOOK_DIRECTION_READ</a> ?</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;         <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586">AST_AUDIOHOOK_DIRECTION_WRITE</a> : <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65">AST_AUDIOHOOK_DIRECTION_READ</a>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a31a8e2bf0224cfe62148232ed25e1aea">ast_frame_dtor</a>(<a class="code" href="../../d0/d79/audiohook_8h.html#a02f2b31337c6e7dc8b8d2c514b64ea0a">ast_audiohook_read_frame</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>, snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4351861a133791d470251669d7624776">spy_samples</a>,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                     opposing_direction, snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a03635affcd98b9d04be26c6838ceb267">spy_format</a>));</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   frame = <a class="code" href="../../d0/d79/audiohook_8h.html#a02f2b31337c6e7dc8b8d2c514b64ea0a">ast_audiohook_read_frame</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>, snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4351861a133791d470251669d7624776">spy_samples</a>, snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#ad43c810950c8927a684723574d626e70">spy_direction</a>, snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a03635affcd98b9d04be26c6838ceb267">spy_format</a>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <a class="code" href="../../d0/d79/audiohook_8h.html#aae4ac794c0f7ab8decd713cb9c43acf4">ast_audiohook_unlock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">spy</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <span class="keywordflow">return</span> frame ? frame : &amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#ac78bb3075a62ec82d12c9723de310a47">silence</a>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div><div class="ttc" id="structstasis__app__snoop_html_a2b96a911762f2f9940d33bfa438095cd"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a2b96a911762f2f9940d33bfa438095cd">stasis_app_snoop::spy</a></div><div class="ttdeci">struct ast_audiohook spy</div><div class="ttdoc">Audiohook used to spy on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00054">res_stasis_snoop.c:54</a></div></div>
<div class="ttc" id="channel_8h_html_a3dc9d235c0e16ab0a6812b4aa6572cce"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a></div><div class="ttdeci">void * ast_channel_tech_pvt(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00565">channel_internal_api.c:565</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a4e4feb27f4d65499557ad4d94e79fa5e"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">stasis_app_snoop::whisper</a></div><div class="ttdeci">struct ast_audiohook whisper</div><div class="ttdoc">Audiohook used to whisper on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">res_stasis_snoop.c:62</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a31a8e2bf0224cfe62148232ed25e1aea"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a31a8e2bf0224cfe62148232ed25e1aea">ast_frame_dtor</a></div><div class="ttdeci">void ast_frame_dtor(struct ast_frame *frame)</div><div class="ttdoc">NULL-safe wrapper for ast_frfree, good for RAII_VAR. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d55/main_2frame_8c_source.html#l00187">main/frame.c:187</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65">AST_AUDIOHOOK_DIRECTION_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00049">audiohook.h:49</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a4351861a133791d470251669d7624776"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a4351861a133791d470251669d7624776">stasis_app_snoop::spy_samples</a></div><div class="ttdeci">unsigned int spy_samples</div><div class="ttdoc">Number of samples to be read in when spying. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00058">res_stasis_snoop.c:58</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></div><div class="ttdoc">Structure which contains all of the snoop information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00050">res_stasis_snoop.c:50</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_ad43c810950c8927a684723574d626e70"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#ad43c810950c8927a684723574d626e70">stasis_app_snoop::spy_direction</a></div><div class="ttdeci">enum ast_audiohook_direction spy_direction</div><div class="ttdoc">Direction for spying. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00056">res_stasis_snoop.c:56</a></div></div>
<div class="ttc" id="audiohook_8h_html_aae4ac794c0f7ab8decd713cb9c43acf4"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#aae4ac794c0f7ab8decd713cb9c43acf4">ast_audiohook_unlock</a></div><div class="ttdeci">#define ast_audiohook_unlock(ah)</div><div class="ttdoc">Unlock an audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00300">audiohook.h:300</a></div></div>
<div class="ttc" id="audiohook_8h_html_acf2dd361123daa6446ade7c7ecfe55adabcc7793ac9fbdcaa9e727aacfda27f26"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#acf2dd361123daa6446ade7c7ecfe55adabcc7793ac9fbdcaa9e727aacfda27f26">AST_AUDIOHOOK_STATUS_RUNNING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00043">audiohook.h:43</a></div></div>
<div class="ttc" id="timing_8h_html_a338edb7e927b891ef4aba288d9c07e56"><div class="ttname"><a href="../../db/d41/timing_8h.html#a338edb7e927b891ef4aba288d9c07e56">ast_timer_ack</a></div><div class="ttdeci">int ast_timer_ack(const struct ast_timer *handle, unsigned int quantity)</div><div class="ttdoc">Acknowledge a timer event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d62/timing_8c_source.html#l00171">timing.c:171</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360">AST_AUDIOHOOK_DIRECTION_BOTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00051">audiohook.h:51</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a9aed6490b63794e6c9c00af4533f255f"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a9aed6490b63794e6c9c00af4533f255f">stasis_app_snoop::timer</a></div><div class="ttdeci">struct ast_timer * timer</div><div class="ttdoc">Timer used for waking up Stasis thread. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00052">res_stasis_snoop.c:52</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899">ast_audiohook_direction</a></div><div class="ttdeci">ast_audiohook_direction</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00048">audiohook.h:48</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_acc912727348c4a47eacd84acb34b3dd5"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">stasis_app_snoop::whisper_active</a></div><div class="ttdeci">unsigned int whisper_active</div><div class="ttdoc">Whether the whisper capability is active or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">res_stasis_snoop.c:74</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_af203379aca2fd704fe8d86a9445596b6"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a></div><div class="ttdeci">struct ast_frame ast_null_frame</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d55/main_2frame_8c_source.html#l00079">main/frame.c:79</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a21b1d9eb6f0a7721ae6e307ea31f92c9"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a21b1d9eb6f0a7721ae6e307ea31f92c9">stasis_app_snoop::spy_active</a></div><div class="ttdeci">unsigned int spy_active</div><div class="ttdoc">Whether the spy capability is active or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00072">res_stasis_snoop.c:72</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586">AST_AUDIOHOOK_DIRECTION_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00050">audiohook.h:50</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="structast__audiohook_html_a9c2c1a66c786d5e486ac428388d62e28"><div class="ttname"><a href="../../d2/d49/structast__audiohook.html#a9c2c1a66c786d5e486ac428388d62e28">ast_audiohook::status</a></div><div class="ttdeci">enum ast_audiohook_status status</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00107">audiohook.h:107</a></div></div>
<div class="ttc" id="audiohook_8h_html_a6456e346fe813617f13d5bbf7e92db5a"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a6456e346fe813617f13d5bbf7e92db5a">ast_audiohook_lock</a></div><div class="ttdeci">#define ast_audiohook_lock(ah)</div><div class="ttdoc">Lock an audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00295">audiohook.h:295</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a03635affcd98b9d04be26c6838ceb267"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a03635affcd98b9d04be26c6838ceb267">stasis_app_snoop::spy_format</a></div><div class="ttdeci">struct ast_format * spy_format</div><div class="ttdoc">Format in use by the spy audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00060">res_stasis_snoop.c:60</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_ac78bb3075a62ec82d12c9723de310a47"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#ac78bb3075a62ec82d12c9723de310a47">stasis_app_snoop::silence</a></div><div class="ttdeci">struct ast_frame silence</div><div class="ttdoc">A frame of silence to use when the audiohook returns null. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00076">res_stasis_snoop.c:76</a></div></div>
<div class="ttc" id="audiohook_8h_html_a02f2b31337c6e7dc8b8d2c514b64ea0a"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a02f2b31337c6e7dc8b8d2c514b64ea0a">ast_audiohook_read_frame</a></div><div class="ttdeci">struct ast_frame * ast_audiohook_read_frame(struct ast_audiohook *audiohook, size_t samples, enum ast_audiohook_direction direction, struct ast_format *format)</div><div class="ttdoc">Reads a frame in from the audiohook structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4f/audiohook_8c_source.html#l00449">audiohook.c:449</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56c2047ab01037d1a1b539a652a216d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56c2047ab01037d1a1b539a652a216d5">&#9670;&nbsp;</a></span>snoop_setup_audiohook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int snoop_setup_audiohook </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d0/d79/audiohook_8h.html#abce1d2faae234aa016905215014542b0">ast_audiohook_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849">stasis_app_snoop_direction</a>&#160;</td>
          <td class="paramname"><em>requested_direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899">ast_audiohook_direction</a> *&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/d49/structast__audiohook.html">ast_audiohook</a> *&#160;</td>
          <td class="paramname"><em>audiohook</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal helper function which sets up and attaches a snoop audiohook. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00281">281</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/d4f/audiohook_8c_source.html#l00501">ast_audiohook_attach()</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00051">AST_AUDIOHOOK_DIRECTION_BOTH</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00049">AST_AUDIOHOOK_DIRECTION_READ</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00050">AST_AUDIOHOOK_DIRECTION_WRITE</a>, <a class="el" href="../../d9/d4f/audiohook_8c_source.html#l00108">ast_audiohook_init()</a>, <a class="el" href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00042">STASIS_SNOOP_DIRECTION_BOTH</a>, <a class="el" href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00040">STASIS_SNOOP_DIRECTION_IN</a>, and <a class="el" href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00038">STASIS_SNOOP_DIRECTION_OUT</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">stasis_app_control_snoop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <a class="code" href="../../d0/d79/audiohook_8h.html#a2cdfa0bb99da5247ab56d5ca67483a8f">ast_audiohook_init</a>(audiohook, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="stringliteral">&quot;Snoop&quot;</span>, 0);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <span class="keywordflow">if</span> (requested_direction == <a class="code" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a322d3eda507ad6f055bcb32562d1a5b6">STASIS_SNOOP_DIRECTION_OUT</a>) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      *<a class="code" href="../../d4/d8b/func__frame__drop_8c.html#a99f26e6ee9fcd62f75203b5402df8098">direction</a> = <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586">AST_AUDIOHOOK_DIRECTION_WRITE</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (requested_direction == <a class="code" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a167d9fac15a022927c949dca249a0bad">STASIS_SNOOP_DIRECTION_IN</a>) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      *<a class="code" href="../../d4/d8b/func__frame__drop_8c.html#a99f26e6ee9fcd62f75203b5402df8098">direction</a> = <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65">AST_AUDIOHOOK_DIRECTION_READ</a>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (requested_direction == <a class="code" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a93e292cf595f437e926d8ef3ce8d1b6d">STASIS_SNOOP_DIRECTION_BOTH</a>) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      *<a class="code" href="../../d4/d8b/func__frame__drop_8c.html#a99f26e6ee9fcd62f75203b5402df8098">direction</a> = <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360">AST_AUDIOHOOK_DIRECTION_BOTH</a>;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d0/d79/audiohook_8h.html#a94abfad20db137f9d6a33f641d37ac31">ast_audiohook_attach</a>(chan, audiohook);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="stasis__app__snoop_8h_html_a919b44edb471d59dba36ac1f9ed20849a167d9fac15a022927c949dca249a0bad"><div class="ttname"><a href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a167d9fac15a022927c949dca249a0bad">STASIS_SNOOP_DIRECTION_IN</a></div><div class="ttdoc">Audio stream in from the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00040">stasis_app_snoop.h:40</a></div></div>
<div class="ttc" id="audiohook_8h_html_a94abfad20db137f9d6a33f641d37ac31"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a94abfad20db137f9d6a33f641d37ac31">ast_audiohook_attach</a></div><div class="ttdeci">int ast_audiohook_attach(struct ast_channel *chan, struct ast_audiohook *audiohook)</div><div class="ttdoc">Attach audiohook to channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4f/audiohook_8c_source.html#l00501">audiohook.c:501</a></div></div>
<div class="ttc" id="stasis__app__snoop_8h_html_a919b44edb471d59dba36ac1f9ed20849a93e292cf595f437e926d8ef3ce8d1b6d"><div class="ttname"><a href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a93e292cf595f437e926d8ef3ce8d1b6d">STASIS_SNOOP_DIRECTION_BOTH</a></div><div class="ttdoc">Audio stream to AND from the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00042">stasis_app_snoop.h:42</a></div></div>
<div class="ttc" id="audiohook_8h_html_a2cdfa0bb99da5247ab56d5ca67483a8f"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a2cdfa0bb99da5247ab56d5ca67483a8f">ast_audiohook_init</a></div><div class="ttdeci">int ast_audiohook_init(struct ast_audiohook *audiohook, enum ast_audiohook_type type, const char *source, enum ast_audiohook_init_flags flags)</div><div class="ttdoc">Initialize an audiohook structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4f/audiohook_8c_source.html#l00108">audiohook.c:108</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65">AST_AUDIOHOOK_DIRECTION_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00049">audiohook.h:49</a></div></div>
<div class="ttc" id="stasis__app__snoop_8h_html_a919b44edb471d59dba36ac1f9ed20849a322d3eda507ad6f055bcb32562d1a5b6"><div class="ttname"><a href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a322d3eda507ad6f055bcb32562d1a5b6">STASIS_SNOOP_DIRECTION_OUT</a></div><div class="ttdoc">Audio stream out to the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00038">stasis_app_snoop.h:38</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360">AST_AUDIOHOOK_DIRECTION_BOTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00051">audiohook.h:51</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586">AST_AUDIOHOOK_DIRECTION_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00050">audiohook.h:50</a></div></div>
<div class="ttc" id="func__frame__drop_8c_html_a99f26e6ee9fcd62f75203b5402df8098"><div class="ttname"><a href="../../d4/d8b/func__frame__drop_8c.html#a99f26e6ee9fcd62f75203b5402df8098">direction</a></div><div class="ttdeci">direction</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d8b/func__frame__drop_8c_source.html#l00137">func_frame_drop.c:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8df9dd0b4144142af14e17a476be737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8df9dd0b4144142af14e17a476be737">&#9670;&nbsp;</a></span>snoop_stasis_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* snoop_stasis_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread used for running the Stasis application. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00263">263</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02548">ast_hangup()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/d16/pbx__app_8c_source.html#l00471">pbx_exec()</a>, <a class="el" href="../../d2/db7/ael__main_8c_source.html#l00165">pbx_findapp()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../d1/d25/app__stasis_8c_source.html#l00080">stasis</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">stasis_app_control_snoop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *, snoop, obj, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/da3/structast__app.html">ast_app</a> *<a class="code" href="../../d1/d25/app__stasis_8c.html#a6721791de482d8b1d92dd47aae0fc0be">stasis</a> = <a class="code" href="../../db/de0/pbx_8h.html#ad4a6912dcd2ad44a186d0a284afafc51">pbx_findapp</a>(<span class="stringliteral">&quot;Stasis&quot;</span>);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keywordflow">if</span> (!stasis) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(snoop-&gt;chan);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a6e3dbc57c03c23543354ef108c31fac8">pbx_exec</a>(snoop-&gt;chan, stasis, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(snoop-&gt;app));</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(snoop-&gt;chan);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="ttc" id="pbx_8h_html_a6e3dbc57c03c23543354ef108c31fac8"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6e3dbc57c03c23543354ef108c31fac8">pbx_exec</a></div><div class="ttdeci">int pbx_exec(struct ast_channel *c, struct ast_app *app, const char *data)</div><div class="ttdoc">Execute an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/pbx__app_8c_source.html#l00471">pbx_app.c:471</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></div><div class="ttdoc">Structure which contains all of the snoop information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00050">res_stasis_snoop.c:50</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="app__stasis_8c_html_a6721791de482d8b1d92dd47aae0fc0be"><div class="ttname"><a href="../../d1/d25/app__stasis_8c.html#a6721791de482d8b1d92dd47aae0fc0be">stasis</a></div><div class="ttdeci">static const char * stasis</div><div class="ttdoc">Dialplan application name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d25/app__stasis_8c_source.html#l00080">app_stasis.c:80</a></div></div>
<div class="ttc" id="channel_8h_html_a29557c4823f5e9c02519a01daf6a289c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a></div><div class="ttdeci">void ast_hangup(struct ast_channel *chan)</div><div class="ttdoc">Hang up a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02548">channel.c:2548</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__app_html"><div class="ttname"><a href="../../d0/da3/structast__app.html">ast_app</a></div><div class="ttdoc">ast_app: A registered application </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d16/pbx__app_8c_source.html#l00045">pbx_app.c:45</a></div></div>
<div class="ttc" id="pbx_8h_html_ad4a6912dcd2ad44a186d0a284afafc51"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ad4a6912dcd2ad44a186d0a284afafc51">pbx_findapp</a></div><div class="ttdeci">struct ast_app * pbx_findapp(const char *app)</div><div class="ttdoc">Look up an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db7/ael__main_8c_source.html#l00165">ael_main.c:165</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8e942b2d0c309ef352e3e309fe5bf20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8e942b2d0c309ef352e3e309fe5bf20">&#9670;&nbsp;</a></span>snoop_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int snoop_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d99/structast__frame.html">ast_frame</a> *&#160;</td>
          <td class="paramname"><em>frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Callback function for writing to a Snoop whisper audiohook. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00152">152</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00051">AST_AUDIOHOOK_DIRECTION_BOTH</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00049">AST_AUDIOHOOK_DIRECTION_READ</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00050">AST_AUDIOHOOK_DIRECTION_WRITE</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00295">ast_audiohook_lock</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00300">ast_audiohook_unlock</a>, <a class="el" href="../../d9/d4f/audiohook_8c_source.html#l00170">ast_audiohook_write_frame()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00565">ast_channel_tech_pvt()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">stasis_app_snoop::whisper</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">stasis_app_snoop::whisper_active</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00064">stasis_app_snoop::whisper_direction</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *snoop = <a class="code" href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a>(chan);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="keywordflow">if</span> (!snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">whisper_active</a>) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <a class="code" href="../../d0/d79/audiohook_8h.html#a6456e346fe813617f13d5bbf7e92db5a">ast_audiohook_lock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> (snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a786afb931221409aed6816e9c542991c">whisper_direction</a> == <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360">AST_AUDIOHOOK_DIRECTION_BOTH</a>) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a3391dbd95c95f041cf14fa30e0f5c73d">ast_audiohook_write_frame</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>, <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65">AST_AUDIOHOOK_DIRECTION_READ</a>, frame);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a3391dbd95c95f041cf14fa30e0f5c73d">ast_audiohook_write_frame</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>, <a class="code" href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586">AST_AUDIOHOOK_DIRECTION_WRITE</a>, frame);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="../../d0/d79/audiohook_8h.html#a3391dbd95c95f041cf14fa30e0f5c73d">ast_audiohook_write_frame</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>, snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a786afb931221409aed6816e9c542991c">whisper_direction</a>, frame);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="../../d0/d79/audiohook_8h.html#aae4ac794c0f7ab8decd713cb9c43acf4">ast_audiohook_unlock</a>(&amp;snoop-&gt;<a class="code" href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">whisper</a>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div><div class="ttc" id="audiohook_8h_html_a3391dbd95c95f041cf14fa30e0f5c73d"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a3391dbd95c95f041cf14fa30e0f5c73d">ast_audiohook_write_frame</a></div><div class="ttdeci">int ast_audiohook_write_frame(struct ast_audiohook *audiohook, enum ast_audiohook_direction direction, struct ast_frame *frame)</div><div class="ttdoc">Writes a frame into the audiohook structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4f/audiohook_8c_source.html#l00170">audiohook.c:170</a></div></div>
<div class="ttc" id="channel_8h_html_a3dc9d235c0e16ab0a6812b4aa6572cce"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3dc9d235c0e16ab0a6812b4aa6572cce">ast_channel_tech_pvt</a></div><div class="ttdeci">void * ast_channel_tech_pvt(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00565">channel_internal_api.c:565</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a4e4feb27f4d65499557ad4d94e79fa5e"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a4e4feb27f4d65499557ad4d94e79fa5e">stasis_app_snoop::whisper</a></div><div class="ttdeci">struct ast_audiohook whisper</div><div class="ttdoc">Audiohook used to whisper on the channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00062">res_stasis_snoop.c:62</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a56916f7012e7fe0ec9b6dd4e4c0e2a65">AST_AUDIOHOOK_DIRECTION_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00049">audiohook.h:49</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></div><div class="ttdoc">Structure which contains all of the snoop information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00050">res_stasis_snoop.c:50</a></div></div>
<div class="ttc" id="audiohook_8h_html_aae4ac794c0f7ab8decd713cb9c43acf4"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#aae4ac794c0f7ab8decd713cb9c43acf4">ast_audiohook_unlock</a></div><div class="ttdeci">#define ast_audiohook_unlock(ah)</div><div class="ttdoc">Unlock an audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00300">audiohook.h:300</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899af84e1c36b65319be79e79b03c8f4a360">AST_AUDIOHOOK_DIRECTION_BOTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00051">audiohook.h:51</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_acc912727348c4a47eacd84acb34b3dd5"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#acc912727348c4a47eacd84acb34b3dd5">stasis_app_snoop::whisper_active</a></div><div class="ttdeci">unsigned int whisper_active</div><div class="ttdoc">Whether the whisper capability is active or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00074">res_stasis_snoop.c:74</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html_a786afb931221409aed6816e9c542991c"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html#a786afb931221409aed6816e9c542991c">stasis_app_snoop::whisper_direction</a></div><div class="ttdeci">enum ast_audiohook_direction whisper_direction</div><div class="ttdoc">Direction for whispering. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00064">res_stasis_snoop.c:64</a></div></div>
<div class="ttc" id="audiohook_8h_html_a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a34d75d3d5e7418b6a772e3d522a16899a8254a5b3fc181d3fe3f2af892010b586">AST_AUDIOHOOK_DIRECTION_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00050">audiohook.h:50</a></div></div>
<div class="ttc" id="audiohook_8h_html_a6456e346fe813617f13d5bbf7e92db5a"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#a6456e346fe813617f13d5bbf7e92db5a">ast_audiohook_lock</a></div><div class="ttdeci">#define ast_audiohook_lock(ah)</div><div class="ttdoc">Lock an audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00295">audiohook.h:295</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe99c28a854f5be66baa6df2dfdc04c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe99c28a854f5be66baa6df2dfdc04c9">&#9670;&nbsp;</a></span>stasis_app_control_snoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a>* stasis_app_control_snoop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../df/d3c/structast__channel.html">ast_channel</a> *&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849">stasis_app_snoop_direction</a>&#160;</td>
          <td class="paramname"><em>spy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849">stasis_app_snoop_direction</a>&#160;</td>
          <td class="paramname"><em>whisper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>app</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>app_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>snoop_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a snoop on the provided channel. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chan</td><td>Channel to snoop on. </td></tr>
    <tr><td class="paramname">spy</td><td>Direction of media that should be spied on. </td></tr>
    <tr><td class="paramname">whisper</td><td>Direction of media that should be whispered into. </td></tr>
    <tr><td class="paramname">app</td><td>Stasis application to execute on the snoop channel. </td></tr>
    <tr><td class="paramname">app_args</td><td>Stasis application arguments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Snoop channel. <a class="el" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380" title="Decrease channel reference count. ">ast_channel_unref()</a> when done. </dd>
<dd>
<code>NULL</code> if snoop channel couldn't be created. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">309</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00755">ast_atomic_fetchadd_int()</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00036">AST_AUDIOHOOK_TYPE_SPY</a>, <a class="el" href="../../d0/d79/audiohook_8h_source.html#l00037">AST_AUDIOHOOK_TYPE_WHISPER</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l01259">ast_channel_alloc</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00677">ast_channel_nativeformats_set()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02970">ast_channel_ref</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02431">ast_channel_set_fd()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00828">ast_channel_set_rawreadformat()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00832">ast_channel_set_rawwriteformat()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00836">ast_channel_set_readformat()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00840">ast_channel_set_writeformat()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00569">ast_channel_tech_pvt_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00773">ast_channel_tech_set()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00305">ast_channel_uniqueid()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00103">ast_format_cap_append</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00379">ast_format_get_sample_rate()</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">AST_FRAME_VOICE</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02548">ast_hangup()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00572">ast_pthread_create_detached_background</a>, <a class="el" href="../../d9/d95/channelstate_8h_source.html#l00042">AST_STATE_UP</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01065">ast_str_set()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d3/d62/timing_8c_source.html#l00161">ast_timer_fd()</a>, <a class="el" href="../../d3/d62/timing_8c_source.html#l00122">ast_timer_open()</a>, <a class="el" href="../../d3/d62/timing_8c_source.html#l00166">ast_timer_set_rate()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00047">chan_idx</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00113">publish_chanspy_message()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00080">snoop_destroy()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00300">snoop_determine_format()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00044">SNOOP_INTERVAL</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00281">snoop_setup_audiohook()</a>, <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00263">snoop_stasis_thread()</a>, <a class="el" href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00036">STASIS_SNOOP_DIRECTION_NONE</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01089">thread</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00606">ast_assigned_ids::uniqueid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/d49/resource__channels_8c_source.html#l01572">ari_channels_handle_snoop_channel()</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;{</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a> *, snoop, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *caps;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   pthread_t <a class="code" href="../../df/d44/app__meetme_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a> assignedids = {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      .<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a> = snoop_id,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   };</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <span class="keywordflow">if</span> (spy == <a class="code" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a348256b6139a7ae39c0ea8993a578a4f">STASIS_SNOOP_DIRECTION_NONE</a> &amp;&amp;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      whisper == <a class="code" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a348256b6139a7ae39c0ea8993a578a4f">STASIS_SNOOP_DIRECTION_NONE</a>) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   snoop = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*snoop), <a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#a697ff4e2e7f1677bd5bab17f43f00aa1">snoop_destroy</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <span class="keywordflow">if</span> (!snoop) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <span class="comment">/* Allocate a buffer to store the Stasis application and arguments in */</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   snoop-&gt;app = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(64);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <span class="keywordflow">if</span> (!snoop-&gt;app) {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;snoop-&gt;app, 0, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(app_args)) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;snoop-&gt;app, 0, <span class="stringliteral">&quot;,%s&quot;</span>, app_args);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="comment">/* Set up a timer for the Snoop channel so it wakes up at a specific interval */</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   snoop-&gt;timer = <a class="code" href="../../db/d41/timing_8h.html#aacc341f127efc0dc0d62f6415694174a">ast_timer_open</a>();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <span class="keywordflow">if</span> (!snoop-&gt;timer) {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <a class="code" href="../../db/d41/timing_8h.html#a4dae39fb5fb680a48a05d7567053eb03">ast_timer_set_rate</a>(snoop-&gt;timer, 1000 / <a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#afa17561e4b5e6858cbe23ff203c1e685">SNOOP_INTERVAL</a>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="comment">/* Determine which signed linear format should be used */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#abfa4d1f6eb8f84d8ba86b6099b43eb7f">snoop_determine_format</a>(chan, snoop);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="comment">/* Allocate a Snoop channel and set up various parameters */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   snoop-&gt;chan = <a class="code" href="../../d5/d7b/channel_8h.html#a2f18aafad0442206e71033ac6676dbb5">ast_channel_alloc</a>(1, <a class="code" href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;assignedids, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <span class="stringliteral">&quot;Snoop/%s-%08x&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan),</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      (<span class="keywordtype">unsigned</span>)<a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>((<span class="keywordtype">int</span> *)&amp;<a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#ad7b8d8b99d184d28a5f0e9fe66a47261">chan_idx</a>, +1));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keywordflow">if</span> (!snoop-&gt;chan) {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <span class="comment">/* To keep the channel valid on the Snoop structure until it is destroyed we bump the ref up here */</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(snoop-&gt;chan);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af0566a4937a5bb1323825e4ef89c0e5a">ast_channel_tech_set</a>(snoop-&gt;chan, &amp;<a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#ab38ec205a3e6c4b05785fe5d9ddc1746">snoop_tech</a>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(snoop, +1);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a929b8b2cb36308e5cf4e51ed880bfcba">ast_channel_tech_pvt_set</a>(snoop-&gt;chan, snoop);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aca37ca2f3d55a223d26617329ed48a3e">ast_channel_set_fd</a>(snoop-&gt;chan, 0, <a class="code" href="../../db/d41/timing_8h.html#aa3aa7580d76e1d3f7927b3f34764dec2">ast_timer_fd</a>(snoop-&gt;timer));</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <span class="comment">/* The format on the Snoop channel will be this signed linear format, and it will never change */</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   caps = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordflow">if</span> (!caps) {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(snoop-&gt;chan);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(snoop-&gt;chan);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(caps, snoop-&gt;spy_format, 0);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a3c9c29fb2bc2b715fee335c1ffa50449">ast_channel_nativeformats_set</a>(snoop-&gt;chan, caps);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(caps, -1);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#afac6d7d115c1edfe3ad8a8c7fa5d59d1">ast_channel_set_writeformat</a>(snoop-&gt;chan, snoop-&gt;spy_format);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aa2df58e77751b741b6891afe210b5b8c">ast_channel_set_rawwriteformat</a>(snoop-&gt;chan, snoop-&gt;spy_format);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ab3786cbbff7a03241fc75dafa0c8a1c1">ast_channel_set_readformat</a>(snoop-&gt;chan, snoop-&gt;spy_format);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a921a2d48faa9ed99a59d33e7aefa7888">ast_channel_set_rawreadformat</a>(snoop-&gt;chan, snoop-&gt;spy_format);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(snoop-&gt;chan);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <span class="keywordflow">if</span> (spy != <a class="code" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a348256b6139a7ae39c0ea8993a578a4f">STASIS_SNOOP_DIRECTION_NONE</a>) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#a56c2047ab01037d1a1b539a652a216d5">snoop_setup_audiohook</a>(chan, <a class="code" href="../../d0/d79/audiohook_8h.html#abce1d2faae234aa016905215014542b0a29865bbf4732a7e78748db47b91e46f5">AST_AUDIOHOOK_TYPE_SPY</a>, spy, &amp;snoop-&gt;spy_direction, &amp;snoop-&gt;spy)) {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(snoop-&gt;chan);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      snoop-&gt;spy_samples = <a class="code" href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a>(snoop-&gt;spy_format) / (1000 / <a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#afa17561e4b5e6858cbe23ff203c1e685">SNOOP_INTERVAL</a>);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      snoop-&gt;spy_active = 1;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      snoop-&gt;silence.frametype = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a>,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      snoop-&gt;silence.datalen = snoop-&gt;spy_samples * <span class="keyword">sizeof</span>(uint16_t),</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      snoop-&gt;silence.samples = snoop-&gt;spy_samples,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      snoop-&gt;silence.mallocd = 0,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      snoop-&gt;silence.offset = 0,</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      snoop-&gt;silence.src = __PRETTY_FUNCTION__,</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      snoop-&gt;silence.subclass.format = snoop-&gt;spy_format,</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      snoop-&gt;silence.data.ptr = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(snoop-&gt;spy_samples, <span class="keyword">sizeof</span>(uint16_t));</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordflow">if</span> (!snoop-&gt;silence.data.ptr) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(snoop-&gt;chan);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="comment">/* If whispering is enabled set up the audiohook */</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <span class="keywordflow">if</span> (whisper != <a class="code" href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a348256b6139a7ae39c0ea8993a578a4f">STASIS_SNOOP_DIRECTION_NONE</a>) {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#a56c2047ab01037d1a1b539a652a216d5">snoop_setup_audiohook</a>(chan, <a class="code" href="../../d0/d79/audiohook_8h.html#abce1d2faae234aa016905215014542b0aecdafbcdb7048512d25cd19089198edd">AST_AUDIOHOOK_TYPE_WHISPER</a>, whisper, &amp;snoop-&gt;whisper_direction, &amp;snoop-&gt;whisper)) {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(snoop-&gt;chan);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      }</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      snoop-&gt;whisper_active = 1;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="comment">/* Create the thread which services the Snoop channel */</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(snoop, +1);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#aa73be876e3a4024b91ce2e09d8b945d1">ast_pthread_create_detached_background</a>(&amp;thread, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#ac8df9dd0b4144142af14e17a476be737">snoop_stasis_thread</a>, snoop)) {</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(snoop);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="comment">/* No other thread is servicing this channel so we can immediately hang it up */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a>(snoop-&gt;chan);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="comment">/* Keep a reference to the channel we are spying on */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   snoop-&gt;spyee_chan = <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(chan);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <a class="code" href="../../dd/da3/res__stasis__snoop_8c.html#a2a01f5a85b808b6a1d1dee83678f46e9">publish_chanspy_message</a>(snoop, 1);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="comment">/* The caller of this has a reference as well */</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a>(snoop-&gt;chan);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="ttc" id="app__meetme_8c_html_a01f75a9ad916f63a94e06a27635ba278"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a></div><div class="ttdeci">pthread_t thread</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01089">app_meetme.c:1089</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="channel_8h_html_afac6d7d115c1edfe3ad8a8c7fa5d59d1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#afac6d7d115c1edfe3ad8a8c7fa5d59d1">ast_channel_set_writeformat</a></div><div class="ttdeci">void ast_channel_set_writeformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00840">channel_internal_api.c:840</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_a2a01f5a85b808b6a1d1dee83678f46e9"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#a2a01f5a85b808b6a1d1dee83678f46e9">publish_chanspy_message</a></div><div class="ttdeci">static void publish_chanspy_message(struct stasis_app_snoop *snoop, int start)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00113">res_stasis_snoop.c:113</a></div></div>
<div class="ttc" id="channel_8h_html_aa2df58e77751b741b6891afe210b5b8c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa2df58e77751b741b6891afe210b5b8c">ast_channel_set_rawwriteformat</a></div><div class="ttdeci">void ast_channel_set_rawwriteformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00832">channel_internal_api.c:832</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0aa457fe7005f11bb7b21453f9bb4caa8f">AST_FRAME_VOICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00101">include/asterisk/frame.h:101</a></div></div>
<div class="ttc" id="structast__assigned__ids_html"><div class="ttname"><a href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a></div><div class="ttdoc">Structure to pass both assignedid values to channel drivers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00605">channel.h:605</a></div></div>
<div class="ttc" id="timing_8h_html_aacc341f127efc0dc0d62f6415694174a"><div class="ttname"><a href="../../db/d41/timing_8h.html#aacc341f127efc0dc0d62f6415694174a">ast_timer_open</a></div><div class="ttdeci">struct ast_timer * ast_timer_open(void)</div><div class="ttdoc">Open a timer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d62/timing_8c_source.html#l00122">timing.c:122</a></div></div>
<div class="ttc" id="stasis__app__snoop_8h_html_a919b44edb471d59dba36ac1f9ed20849a348256b6139a7ae39c0ea8993a578a4f"><div class="ttname"><a href="../../d7/d9b/stasis__app__snoop_8h.html#a919b44edb471d59dba36ac1f9ed20849a348256b6139a7ae39c0ea8993a578a4f">STASIS_SNOOP_DIRECTION_NONE</a></div><div class="ttdoc">No direction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d9b/stasis__app__snoop_8h_source.html#l00036">stasis_app_snoop.h:36</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="structast__assigned__ids_html_af8e97b5c2410839d9826f15f83ac4aa2"><div class="ttname"><a href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">ast_assigned_ids::uniqueid</a></div><div class="ttdeci">const char * uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00606">channel.h:606</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="channelstate_8h_html_a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d"><div class="ttname"><a href="../../d9/d95/channelstate_8h.html#a03585bc87e5bbd0f4d11bc789734c660aa8ab4bcda7378ccc17c39dfd880cba3d">AST_STATE_UP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d95/channelstate_8h_source.html#l00042">channelstate.h:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="utils_8h_html_aa73be876e3a4024b91ce2e09d8b945d1"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aa73be876e3a4024b91ce2e09d8b945d1">ast_pthread_create_detached_background</a></div><div class="ttdeci">#define ast_pthread_create_detached_background(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00572">utils.h:572</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="channel_8h_html_af0566a4937a5bb1323825e4ef89c0e5a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af0566a4937a5bb1323825e4ef89c0e5a">ast_channel_tech_set</a></div><div class="ttdeci">void ast_channel_tech_set(struct ast_channel *chan, const struct ast_channel_tech *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00773">channel_internal_api.c:773</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="structstasis__app__snoop_html"><div class="ttname"><a href="../../d5/d77/structstasis__app__snoop.html">stasis_app_snoop</a></div><div class="ttdoc">Structure which contains all of the snoop information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00050">res_stasis_snoop.c:50</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_ad7b8d8b99d184d28a5f0e9fe66a47261"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#ad7b8d8b99d184d28a5f0e9fe66a47261">chan_idx</a></div><div class="ttdeci">static unsigned int chan_idx</div><div class="ttdoc">Index used to keep Snoop channel names unique. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00047">res_stasis_snoop.c:47</a></div></div>
<div class="ttc" id="channel_8h_html_a921a2d48faa9ed99a59d33e7aefa7888"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a921a2d48faa9ed99a59d33e7aefa7888">ast_channel_set_rawreadformat</a></div><div class="ttdeci">void ast_channel_set_rawreadformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00828">channel_internal_api.c:828</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="channel_8h_html_a3c9c29fb2bc2b715fee335c1ffa50449"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3c9c29fb2bc2b715fee335c1ffa50449">ast_channel_nativeformats_set</a></div><div class="ttdeci">void ast_channel_nativeformats_set(struct ast_channel *chan, struct ast_format_cap *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00677">channel_internal_api.c:677</a></div></div>
<div class="ttc" id="audiohook_8h_html_abce1d2faae234aa016905215014542b0aecdafbcdb7048512d25cd19089198edd"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#abce1d2faae234aa016905215014542b0aecdafbcdb7048512d25cd19089198edd">AST_AUDIOHOOK_TYPE_WHISPER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00037">audiohook.h:37</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="channel_8h_html_ab3786cbbff7a03241fc75dafa0c8a1c1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab3786cbbff7a03241fc75dafa0c8a1c1">ast_channel_set_readformat</a></div><div class="ttdeci">void ast_channel_set_readformat(struct ast_channel *chan, struct ast_format *format)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00836">channel_internal_api.c:836</a></div></div>
<div class="ttc" id="format__cap_8h_html_ab4d69f2179ed5ca138c9b3d85334217f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a></div><div class="ttdeci">#define ast_format_cap_append(cap, format, framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00103">format_cap.h:103</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_ac8df9dd0b4144142af14e17a476be737"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#ac8df9dd0b4144142af14e17a476be737">snoop_stasis_thread</a></div><div class="ttdeci">static void * snoop_stasis_thread(void *obj)</div><div class="ttdoc">Thread used for running the Stasis application. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00263">res_stasis_snoop.c:263</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_ab38ec205a3e6c4b05785fe5d9ddc1746"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#ab38ec205a3e6c4b05785fe5d9ddc1746">snoop_tech</a></div><div class="ttdeci">static struct ast_channel_tech snoop_tech</div><div class="ttdoc">Channel interface declaration. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00253">res_stasis_snoop.c:253</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_abfa4d1f6eb8f84d8ba86b6099b43eb7f"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#abfa4d1f6eb8f84d8ba86b6099b43eb7f">snoop_determine_format</a></div><div class="ttdeci">static void snoop_determine_format(struct ast_channel *chan, struct stasis_app_snoop *snoop)</div><div class="ttdoc">Helper function which gets the format for a Snoop channel based on the channel being snooped on...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00300">res_stasis_snoop.c:300</a></div></div>
<div class="ttc" id="channel_8h_html_a29557c4823f5e9c02519a01daf6a289c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a29557c4823f5e9c02519a01daf6a289c">ast_hangup</a></div><div class="ttdeci">void ast_hangup(struct ast_channel *chan)</div><div class="ttdoc">Hang up a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02548">channel.c:2548</a></div></div>
<div class="ttc" id="audiohook_8h_html_abce1d2faae234aa016905215014542b0a29865bbf4732a7e78748db47b91e46f5"><div class="ttname"><a href="../../d0/d79/audiohook_8h.html#abce1d2faae234aa016905215014542b0a29865bbf4732a7e78748db47b91e46f5">AST_AUDIOHOOK_TYPE_SPY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d79/audiohook_8h_source.html#l00036">audiohook.h:36</a></div></div>
<div class="ttc" id="timing_8h_html_aa3aa7580d76e1d3f7927b3f34764dec2"><div class="ttname"><a href="../../db/d41/timing_8h.html#aa3aa7580d76e1d3f7927b3f34764dec2">ast_timer_fd</a></div><div class="ttdeci">int ast_timer_fd(const struct ast_timer *handle)</div><div class="ttdoc">Get a poll()-able file descriptor for a timer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d62/timing_8c_source.html#l00161">timing.c:161</a></div></div>
<div class="ttc" id="timing_8h_html_a4dae39fb5fb680a48a05d7567053eb03"><div class="ttname"><a href="../../db/d41/timing_8h.html#a4dae39fb5fb680a48a05d7567053eb03">ast_timer_set_rate</a></div><div class="ttdeci">int ast_timer_set_rate(const struct ast_timer *handle, unsigned int rate)</div><div class="ttdoc">Set the timing tick rate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d62/timing_8c_source.html#l00166">timing.c:166</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_afa17561e4b5e6858cbe23ff203c1e685"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#afa17561e4b5e6858cbe23ff203c1e685">SNOOP_INTERVAL</a></div><div class="ttdeci">#define SNOOP_INTERVAL</div><div class="ttdoc">The interval (in milliseconds) that the Snoop timer is triggered, also controls length of audio withi...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00044">res_stasis_snoop.c:44</a></div></div>
<div class="ttc" id="channel_8h_html_aca37ca2f3d55a223d26617329ed48a3e"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aca37ca2f3d55a223d26617329ed48a3e">ast_channel_set_fd</a></div><div class="ttdeci">void ast_channel_set_fd(struct ast_channel *chan, int which, int fd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02431">channel.c:2431</a></div></div>
<div class="ttc" id="channel_8h_html_a6801c703e767d6f760c54c8b86a30024"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6801c703e767d6f760c54c8b86a30024">ast_channel_ref</a></div><div class="ttdeci">#define ast_channel_ref(c)</div><div class="ttdoc">Increase channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02970">channel.h:2970</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="format_8h_html_a499e920008f775eebadd958a42e85862"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a499e920008f775eebadd958a42e85862">ast_format_get_sample_rate</a></div><div class="ttdeci">unsigned int ast_format_get_sample_rate(const struct ast_format *format)</div><div class="ttdoc">Get the sample rate of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00379">format.c:379</a></div></div>
<div class="ttc" id="app__mysql_8c_html_a1d9b1eccfc259a14525ce817482a3f88"><div class="ttname"><a href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a></div><div class="ttdeci">static const char app[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db6/app__mysql_8c_source.html#l00062">app_mysql.c:62</a></div></div>
<div class="ttc" id="channel_8h_html_a2f18aafad0442206e71033ac6676dbb5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2f18aafad0442206e71033ac6676dbb5">ast_channel_alloc</a></div><div class="ttdeci">#define ast_channel_alloc(needqueue, state, cid_num, cid_name, acctcode, exten, context, assignedids, requestor, amaflag,...)</div><div class="ttdoc">Create a channel structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01259">channel.h:1259</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_a56c2047ab01037d1a1b539a652a216d5"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#a56c2047ab01037d1a1b539a652a216d5">snoop_setup_audiohook</a></div><div class="ttdeci">static int snoop_setup_audiohook(struct ast_channel *chan, enum ast_audiohook_type type, enum stasis_app_snoop_direction requested_direction, enum ast_audiohook_direction *direction, struct ast_audiohook *audiohook)</div><div class="ttdoc">Internal helper function which sets up and attaches a snoop audiohook. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00281">res_stasis_snoop.c:281</a></div></div>
<div class="ttc" id="res__stasis__snoop_8c_html_a697ff4e2e7f1677bd5bab17f43f00aa1"><div class="ttname"><a href="../../dd/da3/res__stasis__snoop_8c.html#a697ff4e2e7f1677bd5bab17f43f00aa1">snoop_destroy</a></div><div class="ttdeci">static void snoop_destroy(void *obj)</div><div class="ttdoc">Destructor for snoop structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/da3/res__stasis__snoop_8c_source.html#l00080">res_stasis_snoop.c:80</a></div></div>
<div class="ttc" id="channel_8h_html_a929b8b2cb36308e5cf4e51ed880bfcba"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a929b8b2cb36308e5cf4e51ed880bfcba">ast_channel_tech_pvt_set</a></div><div class="ttdeci">void ast_channel_tech_pvt_set(struct ast_channel *chan, void *value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00569">channel_internal_api.c:569</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00441">441</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d16/module_8h_source.html#l00316">AST_MODFLAG_GLOBAL_SYMBOLS</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, and <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00436">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;{</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> , .description = &quot;Stasis application snoop support&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .requires = &quot;res_stasis&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00451">451</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00451">451</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

</div>
</div>
<a id="ad7b8d8b99d184d28a5f0e9fe66a47261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7b8d8b99d184d28a5f0e9fe66a47261">&#9670;&nbsp;</a></span>chan_idx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int chan_idx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Index used to keep Snoop channel names unique. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00047">47</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00309">stasis_app_control_snoop()</a>.</p>

</div>
</div>
<a id="ab38ec205a3e6c4b05785fe5d9ddc1746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab38ec205a3e6c4b05785fe5d9ddc1746">&#9670;&nbsp;</a></span>snoop_tech</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d85/structast__channel__tech.html">ast_channel_tech</a> snoop_tech</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Channel interface declaration. </p>

<p class="definition">Definition at line <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html#l00253">253</a> of file <a class="el" href="../../dd/da3/res__stasis__snoop_8c_source.html">res_stasis_snoop.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:39 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
