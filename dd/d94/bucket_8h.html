<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: bucket.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_6d4b1cdb59e2db6ad82005b337288fef.html">asterisk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bucket.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Bucket File API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../d8/d25/sorcery_8h_source.html">asterisk/sorcery.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for bucket.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d0e/bucket_8h__incl.png" border="0" usemap="#bucket_8h" alt=""/></div>
<map name="bucket_8h" id="bucket_8h">
<area shape="rect" id="node2" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="182,80,315,107"/>
<area shape="rect" id="node3" href="../../db/dfe/config__options_8h.html" title="Configuration option&#45;handling. " alt="" coords="73,155,253,181"/>
<area shape="rect" id="node7" href="../../dd/d1d/uuid_8h.html" title="Universally unique identifier support. " alt="" coords="278,155,393,181"/>
<area shape="rect" id="node5" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="100,229,227,256"/>
<area shape="rect" id="node6" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="251,229,385,256"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/df8/bucket_8h__dep__incl.png" border="0" usemap="#bucket_8hdep" alt=""/></div>
<map name="bucket_8hdep" id="bucket_8hdep">
<area shape="rect" id="node2" href="../../d5/d03/asterisk_8c.html" title="Top level source file for Asterisk &#45; the Open Source PBX. Implementation of PBX core functions and CL..." alt="" coords="5,80,88,107"/>
<area shape="rect" id="node3" href="../../db/d43/bucket_8c.html" title="Bucket File API. " alt="" coords="113,80,189,107"/>
<area shape="rect" id="node4" href="../../df/dfb/media__cache_8c.html" title="An in&#45;memory media cache. " alt="" coords="213,80,331,107"/>
<area shape="rect" id="node5" href="../../d5/d52/res__http__media__cache_8c.html" title="res_http_media_cache.c" alt="" coords="356,80,535,107"/>
<area shape="rect" id="node6" href="../../d1/d2d/test__bucket_8c.html" title="Bucket Unit Tests. " alt="" coords="559,80,667,107"/>
<area shape="rect" id="node7" href="../../d4/d45/test__http__media__cache_8c.html" title="Tests for the HTTP media cache backend. " alt="" coords="691,80,874,107"/>
<area shape="rect" id="node8" href="../../df/df4/test__media__cache_8c.html" title="Tests for the media cache API. " alt="" coords="898,80,1049,107"/>
</map>
</div>
</div>
<p><a href="../../dd/d94/bucket_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bucket structure, contains other buckets and files.  <a href="../../dd/db1/structast__bucket.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bucket file structure, contains reference to file and information about it.  <a href="../../d9/da9/structast__bucket__file.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bucket metadata structure, AO2 key value pair.  <a href="../../de/d33/structast__bucket__metadata.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a240c41d11c0a5b384a6f4f93885b5ffa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a240c41d11c0a5b384a6f4f93885b5ffa">ast_bucket_scheme_register</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>,  bucket,  file,  create_cb,  destroy_cb)&#160;&#160;&#160;<a class="el" href="../../db/d43/bucket_8c.html#a9744cb1a8bd147d049a10a515c998790">__ast_bucket_scheme_register</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, bucket, file, create_cb, destroy_cb, AST_MODULE_SELF)</td></tr>
<tr class="memdesc:a240c41d11c0a5b384a6f4f93885b5ffa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register support for a specific scheme.  <a href="#a240c41d11c0a5b384a6f4f93885b5ffa">More...</a><br /></td></tr>
<tr class="separator:a240c41d11c0a5b384a6f4f93885b5ffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ae96fef3ee8949ddd17a0b216f4f6d750"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#ae96fef3ee8949ddd17a0b216f4f6d750">bucket_file_create_cb</a>) (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:ae96fef3ee8949ddd17a0b216f4f6d750"><td class="mdescLeft">&#160;</td><td class="mdescRight">A callback function invoked when creating a file snapshot.  <a href="#ae96fef3ee8949ddd17a0b216f4f6d750">More...</a><br /></td></tr>
<tr class="separator:ae96fef3ee8949ddd17a0b216f4f6d750"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e75c5f9fdd2d618a7666ef042b5b92e"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a6e75c5f9fdd2d618a7666ef042b5b92e">bucket_file_destroy_cb</a>) (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:a6e75c5f9fdd2d618a7666ef042b5b92e"><td class="mdescLeft">&#160;</td><td class="mdescRight">A callback function invoked when destroying a file snapshot.  <a href="#a6e75c5f9fdd2d618a7666ef042b5b92e">More...</a><br /></td></tr>
<tr class="separator:a6e75c5f9fdd2d618a7666ef042b5b92e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9744cb1a8bd147d049a10a515c998790"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a9744cb1a8bd147d049a10a515c998790">__ast_bucket_scheme_register</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, struct <a class="el" href="../../dd/d0a/structast__sorcery__wizard.html">ast_sorcery_wizard</a> *bucket, struct <a class="el" href="../../dd/d0a/structast__sorcery__wizard.html">ast_sorcery_wizard</a> *file, <a class="el" href="../../dd/d94/bucket_8h.html#ae96fef3ee8949ddd17a0b216f4f6d750">bucket_file_create_cb</a> create_cb, <a class="el" href="../../dd/d94/bucket_8h.html#a6e75c5f9fdd2d618a7666ef042b5b92e">bucket_file_destroy_cb</a> destroy_cb, struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *module)</td></tr>
<tr class="memdesc:a9744cb1a8bd147d049a10a515c998790"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register support for a specific scheme.  <a href="#a9744cb1a8bd147d049a10a515c998790">More...</a><br /></td></tr>
<tr class="separator:a9744cb1a8bd147d049a10a515c998790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa8bc73759c9c440b9735a36d1ce7a8"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a8aa8bc73759c9c440b9735a36d1ce7a8">ast_bucket_alloc</a> (const char *uri)</td></tr>
<tr class="memdesc:a8aa8bc73759c9c440b9735a36d1ce7a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new bucket.  <a href="#a8aa8bc73759c9c440b9735a36d1ce7a8">More...</a><br /></td></tr>
<tr class="separator:a8aa8bc73759c9c440b9735a36d1ce7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a161e52f71429358e1379f4fe40a05699"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a161e52f71429358e1379f4fe40a05699">ast_bucket_clone</a> (struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *bucket)</td></tr>
<tr class="memdesc:a161e52f71429358e1379f4fe40a05699"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone a bucket.  <a href="#a161e52f71429358e1379f4fe40a05699">More...</a><br /></td></tr>
<tr class="separator:a161e52f71429358e1379f4fe40a05699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588e926422df54eefc733a19ae424267"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a588e926422df54eefc733a19ae424267">ast_bucket_create</a> (struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *bucket)</td></tr>
<tr class="memdesc:a588e926422df54eefc733a19ae424267"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new bucket in backend storage.  <a href="#a588e926422df54eefc733a19ae424267">More...</a><br /></td></tr>
<tr class="separator:a588e926422df54eefc733a19ae424267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff4b113e059daec82062373160b26a4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#aff4b113e059daec82062373160b26a4d">ast_bucket_delete</a> (struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *bucket)</td></tr>
<tr class="memdesc:aff4b113e059daec82062373160b26a4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a bucket from backend storage.  <a href="#aff4b113e059daec82062373160b26a4d">More...</a><br /></td></tr>
<tr class="separator:aff4b113e059daec82062373160b26a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c0cb2467dcf37cb1d0a932d1b86ee1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a06c0cb2467dcf37cb1d0a932d1b86ee1">ast_bucket_file_alloc</a> (const char *uri)</td></tr>
<tr class="memdesc:a06c0cb2467dcf37cb1d0a932d1b86ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new bucket file.  <a href="#a06c0cb2467dcf37cb1d0a932d1b86ee1">More...</a><br /></td></tr>
<tr class="separator:a06c0cb2467dcf37cb1d0a932d1b86ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f43b8ea25fd408f584bfc939f57f383"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a2f43b8ea25fd408f584bfc939f57f383">ast_bucket_file_clone</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:a2f43b8ea25fd408f584bfc939f57f383"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone a bucket file.  <a href="#a2f43b8ea25fd408f584bfc939f57f383">More...</a><br /></td></tr>
<tr class="separator:a2f43b8ea25fd408f584bfc939f57f383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4087c1b9d5975931888fd9c608768538"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a4087c1b9d5975931888fd9c608768538">ast_bucket_file_copy</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file, const char *uri)</td></tr>
<tr class="memdesc:a4087c1b9d5975931888fd9c608768538"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a bucket file to a new URI.  <a href="#a4087c1b9d5975931888fd9c608768538">More...</a><br /></td></tr>
<tr class="separator:a4087c1b9d5975931888fd9c608768538"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d90d500ffd37647c1a4ca9a02003ef8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a5d90d500ffd37647c1a4ca9a02003ef8">ast_bucket_file_create</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:a5d90d500ffd37647c1a4ca9a02003ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new bucket file in backend storage.  <a href="#a5d90d500ffd37647c1a4ca9a02003ef8">More...</a><br /></td></tr>
<tr class="separator:a5d90d500ffd37647c1a4ca9a02003ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0070572ae13f8b9dd6b35da9f8e20f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#aae0070572ae13f8b9dd6b35da9f8e20f">ast_bucket_file_delete</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:aae0070572ae13f8b9dd6b35da9f8e20f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a bucket file from backend storage.  <a href="#aae0070572ae13f8b9dd6b35da9f8e20f">More...</a><br /></td></tr>
<tr class="separator:aae0070572ae13f8b9dd6b35da9f8e20f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af952ea526d717fc81997af722c0b39be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:af952ea526d717fc81997af722c0b39be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve whether or not the backing datastore views the bucket file as stale.  <a href="#af952ea526d717fc81997af722c0b39be">More...</a><br /></td></tr>
<tr class="separator:af952ea526d717fc81997af722c0b39be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a239f2d34f4c2349353c6364388611"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a90a239f2d34f4c2349353c6364388611">ast_bucket_file_json</a> (const struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:a90a239f2d34f4c2349353c6364388611"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a JSON representation of a bucket file.  <a href="#a90a239f2d34f4c2349353c6364388611">More...</a><br /></td></tr>
<tr class="separator:a90a239f2d34f4c2349353c6364388611"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a576351a17dad6ab1bfbb074cf482911d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a576351a17dad6ab1bfbb074cf482911d">ast_bucket_file_metadata_callback</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file, <a class="el" href="../../d5/da5/astobj2_8h.html#a78adb9ce06bb67dc38340c501d439d71">ao2_callback_fn</a> cb, void *arg)</td></tr>
<tr class="memdesc:a576351a17dad6ab1bfbb074cf482911d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a callback function on the metadata associated with a file.  <a href="#a576351a17dad6ab1bfbb074cf482911d">More...</a><br /></td></tr>
<tr class="separator:a576351a17dad6ab1bfbb074cf482911d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9631c13cf74292833016f67fd06306b9"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a9631c13cf74292833016f67fd06306b9">ast_bucket_file_metadata_get</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a9631c13cf74292833016f67fd06306b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a metadata attribute from a file.  <a href="#a9631c13cf74292833016f67fd06306b9">More...</a><br /></td></tr>
<tr class="separator:a9631c13cf74292833016f67fd06306b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b6e8f9435b8b53ce68578c369702980"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a1b6e8f9435b8b53ce68578c369702980">ast_bucket_file_metadata_set</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, const char *<a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a>)</td></tr>
<tr class="memdesc:a1b6e8f9435b8b53ce68578c369702980"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a metadata attribute on a file to a specific value.  <a href="#a1b6e8f9435b8b53ce68578c369702980">More...</a><br /></td></tr>
<tr class="separator:a1b6e8f9435b8b53ce68578c369702980"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d11f4373d1c29363b75122cb6f70e8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a76d11f4373d1c29363b75122cb6f70e8">ast_bucket_file_metadata_unset</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a76d11f4373d1c29363b75122cb6f70e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unset a specific metadata attribute on a file.  <a href="#a76d11f4373d1c29363b75122cb6f70e8">More...</a><br /></td></tr>
<tr class="separator:a76d11f4373d1c29363b75122cb6f70e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a822f08a307bd45facdb512685272cd2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a822f08a307bd45facdb512685272cd2d">ast_bucket_file_observer_add</a> (const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *callbacks)</td></tr>
<tr class="memdesc:a822f08a307bd45facdb512685272cd2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an observer for bucket file creation and deletion operations.  <a href="#a822f08a307bd45facdb512685272cd2d">More...</a><br /></td></tr>
<tr class="separator:a822f08a307bd45facdb512685272cd2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a316074bde82366fe4e910c78ef1df05d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a316074bde82366fe4e910c78ef1df05d">ast_bucket_file_observer_remove</a> (const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *callbacks)</td></tr>
<tr class="memdesc:a316074bde82366fe4e910c78ef1df05d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an observer from bucket file creation and deletion.  <a href="#a316074bde82366fe4e910c78ef1df05d">More...</a><br /></td></tr>
<tr class="separator:a316074bde82366fe4e910c78ef1df05d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af17576a4875c48078ed37990387d1a3b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a> (const char *uri)</td></tr>
<tr class="memdesc:af17576a4875c48078ed37990387d1a3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a bucket file.  <a href="#af17576a4875c48078ed37990387d1a3b">More...</a><br /></td></tr>
<tr class="separator:af17576a4875c48078ed37990387d1a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb22b16d39185b0c7c0f5a574abb506"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a4eb22b16d39185b0c7c0f5a574abb506">ast_bucket_file_temporary_create</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:a4eb22b16d39185b0c7c0f5a574abb506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common file snapshot creation callback for creating a temporary file.  <a href="#a4eb22b16d39185b0c7c0f5a574abb506">More...</a><br /></td></tr>
<tr class="separator:a4eb22b16d39185b0c7c0f5a574abb506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfb027df67d0dc193f2f0cc12f117e05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#acfb027df67d0dc193f2f0cc12f117e05">ast_bucket_file_temporary_destroy</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:acfb027df67d0dc193f2f0cc12f117e05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common file snapshot destruction callback for deleting a temporary file.  <a href="#acfb027df67d0dc193f2f0cc12f117e05">More...</a><br /></td></tr>
<tr class="separator:acfb027df67d0dc193f2f0cc12f117e05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7841adbb1c598c2b68e17918f529356b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a7841adbb1c598c2b68e17918f529356b">ast_bucket_file_update</a> (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td></tr>
<tr class="memdesc:a7841adbb1c598c2b68e17918f529356b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update an existing bucket file in backend storage.  <a href="#a7841adbb1c598c2b68e17918f529356b">More...</a><br /></td></tr>
<tr class="separator:a7841adbb1c598c2b68e17918f529356b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae723d06b2ac225f6a2b514029c10f37c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#ae723d06b2ac225f6a2b514029c10f37c">ast_bucket_init</a> (void)</td></tr>
<tr class="memdesc:ae723d06b2ac225f6a2b514029c10f37c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize bucket support.  <a href="#ae723d06b2ac225f6a2b514029c10f37c">More...</a><br /></td></tr>
<tr class="separator:ae723d06b2ac225f6a2b514029c10f37c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83465ed16e128054eea1c8e784821715"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a83465ed16e128054eea1c8e784821715">ast_bucket_is_stale</a> (struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *bucket)</td></tr>
<tr class="memdesc:a83465ed16e128054eea1c8e784821715"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve whether or not the backing datastore views the bucket as stale.  <a href="#a83465ed16e128054eea1c8e784821715">More...</a><br /></td></tr>
<tr class="separator:a83465ed16e128054eea1c8e784821715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af93b7a25b66772410222582cdc5104b7"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#af93b7a25b66772410222582cdc5104b7">ast_bucket_json</a> (const struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *bucket)</td></tr>
<tr class="memdesc:af93b7a25b66772410222582cdc5104b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a JSON representation of a bucket.  <a href="#af93b7a25b66772410222582cdc5104b7">More...</a><br /></td></tr>
<tr class="separator:af93b7a25b66772410222582cdc5104b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2062020d840734ea5b29a6be9255ffe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#ad2062020d840734ea5b29a6be9255ffe">ast_bucket_observer_add</a> (const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *callbacks)</td></tr>
<tr class="memdesc:ad2062020d840734ea5b29a6be9255ffe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an observer for bucket creation and deletion operations.  <a href="#ad2062020d840734ea5b29a6be9255ffe">More...</a><br /></td></tr>
<tr class="separator:ad2062020d840734ea5b29a6be9255ffe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8de2b0424a91d734bdf63174c13cd6a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a8de2b0424a91d734bdf63174c13cd6a7">ast_bucket_observer_remove</a> (const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *callbacks)</td></tr>
<tr class="memdesc:a8de2b0424a91d734bdf63174c13cd6a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an observer from bucket creation and deletion.  <a href="#a8de2b0424a91d734bdf63174c13cd6a7">More...</a><br /></td></tr>
<tr class="separator:a8de2b0424a91d734bdf63174c13cd6a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5059aedbee0b5f2fa4053977d78525f4"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d94/bucket_8h.html#a5059aedbee0b5f2fa4053977d78525f4">ast_bucket_retrieve</a> (const char *uri)</td></tr>
<tr class="memdesc:a5059aedbee0b5f2fa4053977d78525f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve information about a bucket.  <a href="#a5059aedbee0b5f2fa4053977d78525f4">More...</a><br /></td></tr>
<tr class="separator:a5059aedbee0b5f2fa4053977d78525f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Bucket File API. </p>
<dl class="section author"><dt>Author</dt><dd>Joshua Colp <a href="#" onclick="location.href='mai'+'lto:'+'jco'+'lp'+'@di'+'gi'+'um.'+'co'+'m'; return false;">jcolp<span style="display: none;">.nosp@m.</span>@dig<span style="display: none;">.nosp@m.</span>ium.c<span style="display: none;">.nosp@m.</span>om</a> AstBucket </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../dd/d94/bucket_8h_source.html">bucket.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a240c41d11c0a5b384a6f4f93885b5ffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a240c41d11c0a5b384a6f4f93885b5ffa">&#9670;&nbsp;</a></span>ast_bucket_scheme_register</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ast_bucket_scheme_register</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bucket, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">file, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">create_cb, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">destroy_cb&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../db/d43/bucket_8c.html#a9744cb1a8bd147d049a10a515c998790">__ast_bucket_scheme_register</a>(<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, bucket, file, create_cb, destroy_cb, AST_MODULE_SELF)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register support for a specific scheme. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the scheme, used to find based on scheme in URIs </td></tr>
    <tr><td class="paramname">bucket</td><td>Sorcery wizard used for buckets </td></tr>
    <tr><td class="paramname">file</td><td>Sorcery wizard used for files </td></tr>
    <tr><td class="paramname">create_cb</td><td>Required file snapshot creation callback </td></tr>
    <tr><td class="paramname">destroy_cb</td><td>Optional file snapshot destruction callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Once a scheme has been registered it can not be unregistered </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d94/bucket_8h_source.html#l00137">137</a> of file <a class="el" href="../../dd/d94/bucket_8h_source.html">bucket.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00133">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00425">load_module()</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ae96fef3ee8949ddd17a0b216f4f6d750"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae96fef3ee8949ddd17a0b216f4f6d750">&#9670;&nbsp;</a></span>bucket_file_create_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* bucket_file_create_cb) (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A callback function invoked when creating a file snapshot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Pointer to the file snapshot</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d94/bucket_8h_source.html#l00106">106</a> of file <a class="el" href="../../dd/d94/bucket_8h_source.html">bucket.h</a>.</p>

</div>
</div>
<a id="a6e75c5f9fdd2d618a7666ef042b5b92e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e75c5f9fdd2d618a7666ef042b5b92e">&#9670;&nbsp;</a></span>bucket_file_destroy_cb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* bucket_file_destroy_cb) (struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *file)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A callback function invoked when destroying a file snapshot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Pointer to the file snapshot </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d94/bucket_8h_source.html#l00113">113</a> of file <a class="el" href="../../dd/d94/bucket_8h_source.html">bucket.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9744cb1a8bd147d049a10a515c998790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9744cb1a8bd147d049a10a515c998790">&#9670;&nbsp;</a></span>__ast_bucket_scheme_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __ast_bucket_scheme_register </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d0a/structast__sorcery__wizard.html">ast_sorcery_wizard</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d0a/structast__sorcery__wizard.html">ast_sorcery_wizard</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d94/bucket_8h.html#ae96fef3ee8949ddd17a0b216f4f6d750">bucket_file_create_cb</a>&#160;</td>
          <td class="paramname"><em>create_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d94/bucket_8h.html#a6e75c5f9fdd2d618a7666ef042b5b92e">bucket_file_destroy_cb</a>&#160;</td>
          <td class="paramname"><em>destroy_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td>
          <td class="paramname"><em>module</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register support for a specific scheme. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the scheme, used to find based on scheme in URIs </td></tr>
    <tr><td class="paramname">bucket</td><td>Sorcery wizard used for buckets </td></tr>
    <tr><td class="paramname">file</td><td>Sorcery wizard used for files </td></tr>
    <tr><td class="paramname">create_cb</td><td>Required file snapshot creation callback </td></tr>
    <tr><td class="paramname">destroy_cb</td><td>Optional file snapshot destruction callback </td></tr>
    <tr><td class="paramname">module</td><td>The module which implements this scheme</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Once a scheme has been registered it can not be unregistered </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00277">277</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01572">ao2_link_flags</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00464">ast_module_shutdown_ref</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00463">ast_verb</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00093">ast_bucket_scheme::bucket</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00293">ast_sorcery_wizard::create</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00319">ast_sorcery_wizard::delete</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00095">ast_bucket_scheme::file</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01067">OBJ_NOLOCK</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00296">ast_sorcery_wizard::retrieve_id</a>, and <a class="el" href="../../dd/d42/lock_8h_source.html#l00612">SCOPED_AO2WRLOCK</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a5aafa1e30b1e729e32222ab8b511465e">SCOPED_AO2WRLOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, <a class="code" href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a>);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/da0/structast__bucket__scheme.html">ast_bucket_scheme</a> *, scheme, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) || !bucket || !file ||</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;       !bucket-&gt;<a class="code" href="../../dd/d0a/structast__sorcery__wizard.html#ab9224c5e4ff65f2dda73847ab815219f">create</a> || !bucket-&gt;<a class="code" href="../../dd/d0a/structast__sorcery__wizard.html#abc139706e978f8648f1a32f141370d2d">delete</a> || !bucket-&gt;<a class="code" href="../../dd/d0a/structast__sorcery__wizard.html#a952f0fcef7c2ab963fb99f99293750af">retrieve_id</a> ||</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;       (!bucket-&gt;<a class="code" href="../../dd/d0a/structast__sorcery__wizard.html#ab9224c5e4ff65f2dda73847ab815219f">create</a> &amp;&amp; !create_cb)) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   scheme = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordflow">if</span> (scheme) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   scheme = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*scheme) + strlen(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>) + 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keywordflow">if</span> (!scheme) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   strcpy(scheme-&gt;name, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   scheme-&gt;bucket = bucket;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   scheme-&gt;file = <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   scheme-&gt;create = create_cb;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   scheme-&gt;destroy = destroy_cb;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a>(<a class="code" href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a>, scheme, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Registered bucket scheme &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a>(module);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="astobj2_8h_html_a7ce8563daf84a18540a86504d165b444"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a7ce8563daf84a18540a86504d165b444">ao2_link_flags</a></div><div class="ttdeci">#define ao2_link_flags(container, obj, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01572">astobj2.h:1572</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sorcery__wizard_html_ab9224c5e4ff65f2dda73847ab815219f"><div class="ttname"><a href="../../dd/d0a/structast__sorcery__wizard.html#ab9224c5e4ff65f2dda73847ab815219f">ast_sorcery_wizard::create</a></div><div class="ttdeci">int(* create)(const struct ast_sorcery *sorcery, void *data, void *object)</div><div class="ttdoc">Callback for creating an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00293">sorcery.h:293</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="lock_8h_html_a5aafa1e30b1e729e32222ab8b511465e"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a5aafa1e30b1e729e32222ab8b511465e">SCOPED_AO2WRLOCK</a></div><div class="ttdeci">#define SCOPED_AO2WRLOCK(varname, obj)</div><div class="ttdoc">scoped lock specialization for ao2 write locks. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00612">lock.h:612</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sorcery__wizard_html_abc139706e978f8648f1a32f141370d2d"><div class="ttname"><a href="../../dd/d0a/structast__sorcery__wizard.html#abc139706e978f8648f1a32f141370d2d">ast_sorcery_wizard::delete</a></div><div class="ttdeci">int(* delete)(const struct ast_sorcery *sorcery, void *data, void *object)</div><div class="ttdoc">Callback for deleting an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00319">sorcery.h:319</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="module_8h_html_a9967b09817639f2e15c3f074a60b6379"><div class="ttname"><a href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a></div><div class="ttdeci">#define ast_module_shutdown_ref(mod)</div><div class="ttdoc">Prevent unload of the module before shutdown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00464">module.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structast__sorcery__wizard_html_a952f0fcef7c2ab963fb99f99293750af"><div class="ttname"><a href="../../dd/d0a/structast__sorcery__wizard.html#a952f0fcef7c2ab963fb99f99293750af">ast_sorcery_wizard::retrieve_id</a></div><div class="ttdeci">void *(* retrieve_id)(const struct ast_sorcery *sorcery, void *data, const char *type, const char *id)</div><div class="ttdoc">Callback for retrieving an object using an id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00296">sorcery.h:296</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__bucket__scheme_html"><div class="ttname"><a href="../../d6/da0/structast__bucket__scheme.html">ast_bucket_scheme</a></div><div class="ttdoc">Structure for available schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00091">bucket.c:91</a></div></div>
<div class="ttc" id="bucket_8c_html_a70854cb0002c841cf79aa3aa246cf5ee"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a></div><div class="ttdeci">static struct ao2_container * schemes</div><div class="ttdoc">Container of registered schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00088">bucket.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8aa8bc73759c9c440b9735a36d1ce7a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aa8bc73759c9c440b9735a36d1ce7a8">&#9670;&nbsp;</a></span>ast_bucket_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a>* ast_bucket_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new bucket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uri</td><td>Complete URI for the bucket</td></tr>
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This only creates a local bucket object, to persist in backend storage you must call ast_bucket_create </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00431">431</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01744">ast_sorcery_alloc()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00514">ast_string_field_set</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00093">ast_bucket_scheme::bucket</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00066">ast_bucket::scheme</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00061">ast_bucket::scheme_impl</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l00959">state</a>, and <a class="el" href="../../de/d1e/bt__open_8c_source.html#l00389">tmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00160">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00088">bucket_test_wizard_retrieve_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#ifdef HAVE_URIPARSER</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   UriParserStateA <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   UriUriA full_uri;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(uri);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <span class="keywordtype">char</span> *uri_scheme;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/da0/structast__bucket__scheme.html">ast_bucket_scheme</a> *, scheme, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *bucket;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uri)) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#ifdef HAVE_URIPARSER</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   state.uri = &amp;full_uri;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordflow">if</span> (uriParseUriA(&amp;state, uri) != URI_SUCCESS ||</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      !full_uri.scheme.first || !full_uri.scheme.afterLast ||</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      !full_uri.pathTail) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      uriFreeUriMembersA(&amp;full_uri);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   len = (full_uri.scheme.afterLast - full_uri.scheme.first) + 1;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   uri_scheme = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(len);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(uri_scheme, full_uri.scheme.first, len);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   uriFreeUriMembersA(&amp;full_uri);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   uri_scheme = <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   <span class="keywordflow">if</span> (!(tmp = strchr(uri_scheme, <span class="charliteral">&#39;:&#39;</span>))) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   *tmp = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <a class="code" href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a>, uri_scheme, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>) {</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   bucket = <a class="code" href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, uri);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <span class="keywordflow">if</span> (!bucket) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>, +1);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   bucket-&gt;<a class="code" href="../../dd/db1/structast__bucket.html#af4464d976d7190bab50fa9e392a25ab5">scheme_impl</a> = <a class="code" href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(bucket, <a class="code" href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>, uri_scheme);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <span class="keywordflow">return</span> bucket;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div><div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__bucket_html"><div class="ttname"><a href="../../dd/db1/structast__bucket.html">ast_bucket</a></div><div class="ttdoc">Bucket structure, contains other buckets and files. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00057">bucket.h:57</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb6c97c18566cf94a7ac95a43dd9a816"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a></div><div class="ttdeci">void * ast_sorcery_alloc(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Allocate an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01744">sorcery.c:1744</a></div></div>
<div class="ttc" id="structast__bucket_html_af4464d976d7190bab50fa9e392a25ab5"><div class="ttname"><a href="../../dd/db1/structast__bucket.html#af4464d976d7190bab50fa9e392a25ab5">ast_bucket::scheme_impl</a></div><div class="ttdeci">struct ast_bucket_scheme * scheme_impl</div><div class="ttdoc">Scheme implementation in use. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00061">bucket.h:61</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structast__bucket__scheme_html"><div class="ttname"><a href="../../d6/da0/structast__bucket__scheme.html">ast_bucket_scheme</a></div><div class="ttdoc">Structure for available schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00091">bucket.c:91</a></div></div>
<div class="ttc" id="structast__bucket_html_ac36f0afe2613738b0f0353c0f4fbc265"><div class="ttname"><a href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">ast_bucket::scheme</a></div><div class="ttdeci">const ast_string_field scheme</div><div class="ttdoc">Name of scheme in use. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00066">bucket.h:66</a></div></div>
<div class="ttc" id="bucket_8c_html_a70854cb0002c841cf79aa3aa246cf5ee"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a></div><div class="ttdeci">static struct ao2_container * schemes</div><div class="ttdoc">Container of registered schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00088">bucket.c:88</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a161e52f71429358e1379f4fe40a05699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a161e52f71429358e1379f4fe40a05699">&#9670;&nbsp;</a></span>ast_bucket_clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a>* ast_bucket_clone </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clone a bucket. </p>
<p>This will create a copy of the passed in <code><a class="el" href="../../dd/db1/structast__bucket.html" title="Bucket structure, contains other buckets and files. ">ast_bucket</a></code> structure. While all properties of the <code><a class="el" href="../../dd/db1/structast__bucket.html" title="Bucket structure, contains other buckets and files. ">ast_bucket</a></code> structure are copied, any metadata in the original structure simply has its reference count increased.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket to clone</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operation should be called prior to updating a bucket object, as <code><a class="el" href="../../dd/db1/structast__bucket.html" title="Bucket structure, contains other buckets and files. ">ast_bucket</a></code> instances are immutable </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00510">510</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01778">ast_sorcery_copy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00244">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;{</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#acb3b46997c4a11e6da3ac21e7a38d96c">ast_sorcery_copy</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, bucket);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb3b46997c4a11e6da3ac21e7a38d96c"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb3b46997c4a11e6da3ac21e7a38d96c">ast_sorcery_copy</a></div><div class="ttdeci">void * ast_sorcery_copy(const struct ast_sorcery *sorcery, const void *object)</div><div class="ttdoc">Create a copy of an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01778">sorcery.c:1778</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a588e926422df54eefc733a19ae424267"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a588e926422df54eefc733a19ae424267">&#9670;&nbsp;</a></span>ast_bucket_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new bucket in backend storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bucket</td><td>The bucket</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00488">488</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02057">ast_sorcery_create()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00201">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, bucket);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a575dfe8fd872c033d2b902549df502ea"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a></div><div class="ttdeci">int ast_sorcery_create(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Create and potentially persist an object using an available wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02057">sorcery.c:2057</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff4b113e059daec82062373160b26a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff4b113e059daec82062373160b26a4d">&#9670;&nbsp;</a></span>ast_bucket_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_delete </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a bucket from backend storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bucket</td><td>The bucket</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00539">539</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00288">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;{</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, bucket);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a06c0cb2467dcf37cb1d0a932d1b86ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c0cb2467dcf37cb1d0a932d1b86ee1">&#9670;&nbsp;</a></span>ast_bucket_file_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a>* ast_bucket_file_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new bucket file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uri</td><td>Complete URI for the bucket file</td></tr>
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This only creates a local bucket file object, to persist in backend storage you must call ast_bucket_file_create </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00663">663</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00401">ast_copy_string()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01744">ast_sorcery_alloc()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d1/d0f/stringfields_8h_source.html#l00514">ast_string_field_set</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00095">ast_bucket_scheme::file</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00087">ast_bucket_file::scheme</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00082">ast_bucket_file::scheme_impl</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l00959">state</a>, and <a class="el" href="../../de/d1e/bt__open_8c_source.html#l00389">tmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d43/bucket_8c_source.html#l00791">ast_bucket_file_copy()</a>, <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00285">ast_media_cache_create_or_update()</a>, <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00438">AST_TEST_DEFINE()</a>, <a class="el" href="../../df/df4/test__media__cache_8c_source.html#l00088">bucket_http_test_wizard_retrieve_id()</a>, <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00341">bucket_http_wizard_retrieve_id()</a>, <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00088">bucket_test_wizard_retrieve_id()</a>, and <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00406">media_cache_item_populate_from_astdb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;{</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor">#ifdef HAVE_URIPARSER</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   UriParserStateA <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   UriUriA full_uri;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(uri);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <span class="keywordtype">char</span> *uri_scheme;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/da0/structast__bucket__scheme.html">ast_bucket_scheme</a> *, <a class="code" href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uri)) {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="preprocessor">#ifdef HAVE_URIPARSER</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   state.uri = &amp;full_uri;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordflow">if</span> (uriParseUriA(&amp;state, uri) != URI_SUCCESS ||</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      !full_uri.scheme.first || !full_uri.scheme.afterLast ||</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      !full_uri.pathTail) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      uriFreeUriMembersA(&amp;full_uri);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   len = (full_uri.scheme.afterLast - full_uri.scheme.first) + 1;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   uri_scheme = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(len);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(uri_scheme, full_uri.scheme.first, len);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   uriFreeUriMembersA(&amp;full_uri);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   uri_scheme = <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <span class="keywordflow">if</span> (!(tmp = strchr(uri_scheme, <span class="charliteral">&#39;:&#39;</span>))) {</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   *tmp = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <a class="code" href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a>, uri_scheme, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>) {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   file = <a class="code" href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, uri);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keywordflow">if</span> (!file) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>, +1);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#af4464d976d7190bab50fa9e392a25ab5">scheme_impl</a> = <a class="code" href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(file, <a class="code" href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>, uri_scheme);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>-&gt;create &amp;&amp; <a class="code" href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">scheme</a>-&gt;create(file)) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(file, -1);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   }</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div><div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="structast__bucket__file_html_af4464d976d7190bab50fa9e392a25ab5"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#af4464d976d7190bab50fa9e392a25ab5">ast_bucket_file::scheme_impl</a></div><div class="ttdeci">struct ast_bucket_scheme * scheme_impl</div><div class="ttdoc">Scheme implementation in use. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00082">bucket.h:82</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structast__bucket__file_html_ac36f0afe2613738b0f0353c0f4fbc265"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#ac36f0afe2613738b0f0353c0f4fbc265">ast_bucket_file::scheme</a></div><div class="ttdeci">const ast_string_field scheme</div><div class="ttdoc">Name of scheme in use. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00087">bucket.h:87</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb6c97c18566cf94a7ac95a43dd9a816"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a></div><div class="ttdeci">void * ast_sorcery_alloc(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Allocate an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01744">sorcery.c:1744</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="structast__bucket__scheme_html"><div class="ttname"><a href="../../d6/da0/structast__bucket__scheme.html">ast_bucket_scheme</a></div><div class="ttdoc">Structure for available schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00091">bucket.c:91</a></div></div>
<div class="ttc" id="structast__bucket_html_ac36f0afe2613738b0f0353c0f4fbc265"><div class="ttname"><a href="../../dd/db1/structast__bucket.html#ac36f0afe2613738b0f0353c0f4fbc265">ast_bucket::scheme</a></div><div class="ttdeci">const ast_string_field scheme</div><div class="ttdoc">Name of scheme in use. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00066">bucket.h:66</a></div></div>
<div class="ttc" id="bucket_8c_html_a70854cb0002c841cf79aa3aa246cf5ee"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a></div><div class="ttdeci">static struct ao2_container * schemes</div><div class="ttdoc">Container of registered schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00088">bucket.c:88</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f43b8ea25fd408f584bfc939f57f383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f43b8ea25fd408f584bfc939f57f383">&#9670;&nbsp;</a></span>ast_bucket_file_clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a>* ast_bucket_file_clone </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clone a bucket file. </p>
<p>This will create a copy of the passed in <code><a class="el" href="../../d9/da9/structast__bucket__file.html" title="Bucket file structure, contains reference to file and information about it. ">ast_bucket_file</a></code> structure. While all properties of the <code><a class="el" href="../../d9/da9/structast__bucket__file.html" title="Bucket file structure, contains reference to file and information about it. ">ast_bucket_file</a></code> structure are copied, any metadata in the original structure simply has its reference count increased. Note that this copies the structure, not the underlying file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file to clone</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operation should be called prior to updating a bucket file object, as <code><a class="el" href="../../d9/da9/structast__bucket__file.html" title="Bucket file structure, contains reference to file and information about it. ">ast_bucket_file</a></code> instances are immutable </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00810">810</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01778">ast_sorcery_copy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00285">ast_media_cache_create_or_update()</a>, and <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00527">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;{</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#acb3b46997c4a11e6da3ac21e7a38d96c">ast_sorcery_copy</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, file);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb3b46997c4a11e6da3ac21e7a38d96c"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb3b46997c4a11e6da3ac21e7a38d96c">ast_sorcery_copy</a></div><div class="ttdeci">void * ast_sorcery_copy(const struct ast_sorcery *sorcery, const void *object)</div><div class="ttdoc">Create a copy of an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01778">sorcery.c:1778</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4087c1b9d5975931888fd9c608768538"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4087c1b9d5975931888fd9c608768538">&#9670;&nbsp;</a></span>ast_bucket_file_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a>* ast_bucket_file_copy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy a bucket file to a new URI. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The source bucket file </td></tr>
    <tr><td class="paramname">uri</td><td>The new URI</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operation stages things locally, you must call ast_bucket_file_create on the file that is returned to commit the copy to backend storage </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00791">791</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01430">ao2_container_clone</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00663">ast_bucket_file_alloc()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00731">bucket_copy()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l04629">copy()</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00093">ast_bucket_file::metadata</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00095">ast_bucket_file::path</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00573">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;{</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, <a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>, <a class="code" href="../../db/d43/bucket_8c.html#a06c0cb2467dcf37cb1d0a932d1b86ee1">ast_bucket_file_alloc</a>(uri), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>) {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>-&gt;metadata);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;   <a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>-&gt;metadata = <a class="code" href="../../d5/da5/astobj2_8h.html#afb289446aea47e0ca2b4f54de137b0c7">ao2_container_clone</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">metadata</a>, 0);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>-&gt;metadata ||</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <a class="code" href="../../db/d43/bucket_8c.html#ad3e27e8bf8b4bd244ba33038a488f0f7">bucket_copy</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>, <a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>-&gt;path)) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>, +1);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_afb289446aea47e0ca2b4f54de137b0c7"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#afb289446aea47e0ca2b4f54de137b0c7">ao2_container_clone</a></div><div class="ttdeci">#define ao2_container_clone(orig, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01430">astobj2.h:1430</a></div></div>
<div class="ttc" id="app__voicemail_8c_html_abe15777a07ac747625b018ac01f92531"><div class="ttname"><a href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a></div><div class="ttdeci">static int copy(char *infile, char *outfile)</div><div class="ttdoc">Utility function to copy a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df4/app__voicemail_8c_source.html#l04629">app_voicemail.c:4629</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="bucket_8c_html_ad3e27e8bf8b4bd244ba33038a488f0f7"><div class="ttname"><a href="../../db/d43/bucket_8c.html#ad3e27e8bf8b4bd244ba33038a488f0f7">bucket_copy</a></div><div class="ttdeci">static int bucket_copy(const char *infile, const char *outfile)</div><div class="ttdoc">Copy a file, shamelessly taken from file.c. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00731">bucket.c:731</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structast__bucket__file_html_adcb05a50bf114426eb25420341e180b3"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">ast_bucket_file::metadata</a></div><div class="ttdeci">struct ao2_container * metadata</div><div class="ttdoc">Container of metadata attributes about file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00093">bucket.h:93</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__bucket__file_html_ae8592c5c8f37a4598973aaa27f45dc4c"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">ast_bucket_file::path</a></div><div class="ttdeci">char path[PATH_MAX]</div><div class="ttdoc">Local path to this file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00095">bucket.h:95</a></div></div>
<div class="ttc" id="bucket_8c_html_a06c0cb2467dcf37cb1d0a932d1b86ee1"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a06c0cb2467dcf37cb1d0a932d1b86ee1">ast_bucket_file_alloc</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_alloc(const char *uri)</div><div class="ttdoc">Allocate a new bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00663">bucket.c:663</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d90d500ffd37647c1a4ca9a02003ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d90d500ffd37647c1a4ca9a02003ef8">&#9670;&nbsp;</a></span>ast_bucket_file_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new bucket file in backend storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00725">725</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02057">ast_sorcery_create()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00285">ast_media_cache_create_or_update()</a>, and <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00484">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;{</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, file);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a575dfe8fd872c033d2b902549df502ea"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a></div><div class="ttdeci">int ast_sorcery_create(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Create and potentially persist an object using an available wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02057">sorcery.c:2057</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae0070572ae13f8b9dd6b35da9f8e20f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae0070572ae13f8b9dd6b35da9f8e20f">&#9670;&nbsp;</a></span>ast_bucket_file_delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_delete </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a bucket file from backend storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00844">844</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00364">ast_media_cache_delete()</a>, <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00197">ast_media_cache_retrieve()</a>, <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00715">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;{</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, file);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af952ea526d717fc81997af722c0b39be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af952ea526d717fc81997af722c0b39be">&#9670;&nbsp;</a></span>ast_bucket_file_is_stale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_is_stale </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve whether or not the backing datastore views the bucket file as stale. </p>
<dl class="section since"><dt>Since</dt><dd>14.0.0</dd></dl>
<p>This function will ask whatever data storage backs the bucket file's schema type if the current instance of the object is stale. It will not update the bucket file object itself, as said objects are immutable. If the caller of this function would like to update the object, it should perform a retrieve operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bucket_file</td><td>The bucket file object to check</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if <code>bucket_file</code> is not stale </td></tr>
    <tr><td class="paramname">1</td><td>if <code>bucket_file</code> is stale </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00824">824</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02283">ast_sorcery_is_stale()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00197">ast_media_cache_retrieve()</a>, and <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00758">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;{</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#adf633d11cfc74bd08b324e54476b2b42">ast_sorcery_is_stale</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, file);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;}</div><div class="ttc" id="sorcery_8h_html_adf633d11cfc74bd08b324e54476b2b42"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#adf633d11cfc74bd08b324e54476b2b42">ast_sorcery_is_stale</a></div><div class="ttdeci">int ast_sorcery_is_stale(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Determine if a sorcery object is stale with respect to its backing datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02283">sorcery.c:2283</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90a239f2d34f4c2349353c6364388611"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a239f2d34f4c2349353c6364388611">&#9670;&nbsp;</a></span>ast_bucket_file_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a>* ast_bucket_file_json </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a JSON representation of a bucket file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The specific bucket file</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The returned <a class="el" href="../../d1/da1/structast__json.html" title="Abstract JSON element (object, array, string, int, ...). ">ast_json</a> object must be unreferenced using ast_json_unref </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00849">849</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00534">ao2_iterator_destroy()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00485">ao2_iterator_init()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01933">ao2_iterator_next</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00389">ast_json_object_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00404">ast_json_object_set()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00067">ast_json_ref()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00268">ast_json_string_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01565">ast_sorcery_objectset_json_create()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01507">id</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00093">ast_bucket_file::metadata</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00049">ast_bucket_metadata::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>, and <a class="el" href="../../dd/d94/bucket_8h_source.html#l00051">ast_bucket_metadata::value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00937">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;{</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, json, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>, *metadata;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a> *attribute;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   json = <a class="code" href="../../d8/d25/sorcery_8h.html#a7912b02d883b3ade727afd3aa976bfa0">ast_sorcery_objectset_json_create</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, file);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   }</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;   <span class="keywordtype">id</span> = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(file));</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <span class="keywordflow">if</span> (!<span class="keywordtype">id</span>) {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;   }</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>)) {</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;   }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   metadata = <a class="code" href="../../d4/d05/json_8h.html#a5892d6cd943e00556180fcf15d30788e">ast_json_object_create</a>();</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;   <span class="keywordflow">if</span> (!metadata) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;   }</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <span class="stringliteral">&quot;metadata&quot;</span>, metadata)) {</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">metadata</a>, 0);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;   <span class="keywordflow">for</span> (; (attribute = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(attribute, -1)) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(attribute-&gt;<a class="code" href="../../de/d33/structast__bucket__metadata.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">if</span> (!value || <a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(metadata, attribute-&gt;<a class="code" href="../../de/d33/structast__bucket__metadata.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, value)) {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;         res = -1;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;   }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a>(json);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;   <span class="keywordflow">return</span> json;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div><div class="ttc" id="json_8h_html_a0ca956b7df20127f7e38993c3c06cb2c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a></div><div class="ttdeci">struct ast_json * ast_json_ref(struct ast_json *value)</div><div class="ttdoc">Increase refcount on value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00067">json.c:67</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="json_8h_html_abc8b563c172cfaffa2b555195990f729"><div class="ttname"><a href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a></div><div class="ttdeci">int ast_json_object_set(struct ast_json *object, const char *key, struct ast_json *value)</div><div class="ttdoc">Set a field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00404">json.c:404</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="structast__bucket__metadata_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../de/d33/structast__bucket__metadata.html#a8556878012feffc9e0beb86cd78f424d">ast_bucket_metadata::value</a></div><div class="ttdeci">const char * value</div><div class="ttdoc">Value of the attribute. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00051">bucket.h:51</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="json_8h_html_adc52f8d76b7fdd0c8d12987981fd5bf5"><div class="ttname"><a href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a></div><div class="ttdeci">struct ast_json * ast_json_string_create(const char *value)</div><div class="ttdoc">Construct a JSON string from value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00268">json.c:268</a></div></div>
<div class="ttc" id="structast__bucket__metadata_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../de/d33/structast__bucket__metadata.html#a8f8f80d37794cde9472343e4487ba3eb">ast_bucket_metadata::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">Name of the attribute. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00049">bucket.h:49</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="structast__bucket__file_html_adcb05a50bf114426eb25420341e180b3"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">ast_bucket_file::metadata</a></div><div class="ttdeci">struct ao2_container * metadata</div><div class="ttdoc">Container of metadata attributes about file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00093">bucket.h:93</a></div></div>
<div class="ttc" id="structast__bucket__metadata_html"><div class="ttname"><a href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a></div><div class="ttdoc">Bucket metadata structure, AO2 key value pair. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00047">bucket.h:47</a></div></div>
<div class="ttc" id="json_8h_html_a5892d6cd943e00556180fcf15d30788e"><div class="ttname"><a href="../../d4/d05/json_8h.html#a5892d6cd943e00556180fcf15d30788e">ast_json_object_create</a></div><div class="ttdeci">struct ast_json * ast_json_object_create(void)</div><div class="ttdoc">Create a new JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00389">json.c:389</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="sorcery_8h_html_a7912b02d883b3ade727afd3aa976bfa0"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a7912b02d883b3ade727afd3aa976bfa0">ast_sorcery_objectset_json_create</a></div><div class="ttdeci">struct ast_json * ast_sorcery_objectset_json_create(const struct ast_sorcery *sorcery, const void *object)</div><div class="ttdoc">Create an object set in JSON format for an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01565">sorcery.c:1565</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a576351a17dad6ab1bfbb074cf482911d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a576351a17dad6ab1bfbb074cf482911d">&#9670;&nbsp;</a></span>ast_bucket_file_metadata_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_bucket_file_metadata_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/da5/astobj2_8h.html#a78adb9ce06bb67dc38340c501d439d71">ao2_callback_fn</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute a callback function on the metadata associated with a file. </p>
<dl class="section since"><dt>Since</dt><dd>14.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file </td></tr>
    <tr><td class="paramname">cb</td><td>An ao2 callback function that will be called with each <code><a class="el" href="../../de/d33/structast__bucket__metadata.html" title="Bucket metadata structure, AO2 key value pair. ">ast_bucket_metadata</a></code> associated with <code>file</code> </td></tr>
    <tr><td class="paramname">arg</td><td>An optional argument to pass to <code>cb</code> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00364">364</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, and <a class="el" href="../../dd/d94/bucket_8h_source.html#l00093">ast_bucket_file::metadata</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00096">media_cache_item_sync_to_astdb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;{</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">metadata</a>, 0, cb, arg);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="structast__bucket__file_html_adcb05a50bf114426eb25420341e180b3"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">ast_bucket_file::metadata</a></div><div class="ttdeci">struct ao2_container * metadata</div><div class="ttdoc">Container of metadata attributes about file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00093">bucket.h:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9631c13cf74292833016f67fd06306b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9631c13cf74292833016f67fd06306b9">&#9670;&nbsp;</a></span>ast_bucket_file_metadata_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a>* ast_bucket_file_metadata_get </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a metadata attribute from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file </td></tr>
    <tr><td class="paramname">name</td><td>Name of the attribute</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>if found </td></tr>
    <tr><td class="paramname">NULL</td><td>if not found</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The object is returned with reference count increased </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00359">359</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00093">ast_bucket_file::metadata</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00573">AST_TEST_DEFINE()</a>, <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00161">bucket_file_always_revalidate()</a>, <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00182">bucket_file_expired()</a>, <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00116">bucket_file_set_expiration()</a>, <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00150">bucket_file_update_path()</a>, and <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00290">bucket_http_wizard_is_stale()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">metadata</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__bucket__file_html_adcb05a50bf114426eb25420341e180b3"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">ast_bucket_file::metadata</a></div><div class="ttdeci">struct ao2_container * metadata</div><div class="ttdoc">Container of metadata attributes about file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00093">bucket.h:93</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b6e8f9435b8b53ce68578c369702980"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b6e8f9435b8b53ce68578c369702980">&#9670;&nbsp;</a></span>ast_bucket_file_metadata_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_metadata_set </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a metadata attribute on a file to a specific value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file </td></tr>
    <tr><td class="paramname">name</td><td>Name of the attribute </td></tr>
    <tr><td class="paramname">value</td><td>Value of the attribute</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function will overwrite an existing attribute of the same name, unless an error occurs. If an error occurs the existing attribute is left alone. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00334">334</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00316">bucket_metadata_alloc()</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00093">ast_bucket_file::metadata</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00285">ast_media_cache_create_or_update()</a>, <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00527">AST_TEST_DEFINE()</a>, <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00116">bucket_file_set_expiration()</a>, <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00150">bucket_file_update_path()</a>, <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00058">curl_header_callback()</a>, and <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00406">media_cache_item_populate_from_astdb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a> *, metadata, <a class="code" href="../../db/d43/bucket_8c.html#ae42d6d5a36542363a6d0af1a1f374cd8">bucket_metadata_alloc</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="keywordflow">if</span> (!metadata) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">metadata</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">metadata</a>, metadata);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="bucket_8c_html_ae42d6d5a36542363a6d0af1a1f374cd8"><div class="ttname"><a href="../../db/d43/bucket_8c.html#ae42d6d5a36542363a6d0af1a1f374cd8">bucket_metadata_alloc</a></div><div class="ttdeci">static struct ast_bucket_metadata * bucket_metadata_alloc(const char *name, const char *value)</div><div class="ttdoc">Allocator for metadata attributes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00316">bucket.c:316</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__bucket__file_html_adcb05a50bf114426eb25420341e180b3"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">ast_bucket_file::metadata</a></div><div class="ttdeci">struct ao2_container * metadata</div><div class="ttdoc">Container of metadata attributes about file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00093">bucket.h:93</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structast__bucket__metadata_html"><div class="ttname"><a href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a></div><div class="ttdoc">Bucket metadata structure, AO2 key value pair. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00047">bucket.h:47</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76d11f4373d1c29363b75122cb6f70e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76d11f4373d1c29363b75122cb6f70e8">&#9670;&nbsp;</a></span>ast_bucket_file_metadata_unset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_metadata_unset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unset a specific metadata attribute on a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file </td></tr>
    <tr><td class="paramname">name</td><td>Name of the attribute</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00348">348</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00093">ast_bucket_file::metadata</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00856">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a> *, metadata, <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">metadata</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <span class="keywordflow">if</span> (!metadata) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__bucket__file_html_adcb05a50bf114426eb25420341e180b3"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#adcb05a50bf114426eb25420341e180b3">ast_bucket_file::metadata</a></div><div class="ttdeci">struct ao2_container * metadata</div><div class="ttdoc">Container of metadata attributes about file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00093">bucket.h:93</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structast__bucket__metadata_html"><div class="ttname"><a href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a></div><div class="ttdoc">Bucket metadata structure, AO2 key value pair. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00047">bucket.h:47</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a822f08a307bd45facdb512685272cd2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a822f08a307bd45facdb512685272cd2d">&#9670;&nbsp;</a></span>ast_bucket_file_observer_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_observer_add </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *&#160;</td>
          <td class="paramname"><em>callbacks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an observer for bucket file creation and deletion operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks</td><td>Implementation of the sorcery observer interface</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>You must be ready to accept observer invocations before this function is called </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00829">829</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02386">ast_sorcery_observer_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;{</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, callbacks);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a6c1928d47eae1172f236e8ee421c2db4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a></div><div class="ttdeci">int ast_sorcery_observer_add(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Add an observer to a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02386">sorcery.c:2386</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a316074bde82366fe4e910c78ef1df05d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a316074bde82366fe4e910c78ef1df05d">&#9670;&nbsp;</a></span>ast_bucket_file_observer_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_bucket_file_observer_remove </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *&#160;</td>
          <td class="paramname"><em>callbacks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove an observer from bucket file creation and deletion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks</td><td>Implementation of the sorcery observer interface </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00834">834</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02418">ast_sorcery_observer_remove()</a>.</p>
<div class="fragment"><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;{</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, callbacks);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a18d64c360480b458754fc30f781d5011"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a></div><div class="ttdeci">void ast_sorcery_observer_remove(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Remove an observer from a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02418">sorcery.c:2418</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af17576a4875c48078ed37990387d1a3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af17576a4875c48078ed37990387d1a3b">&#9670;&nbsp;</a></span>ast_bucket_file_retrieve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a>* ast_bucket_file_retrieve </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a bucket file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uri</td><td>Complete URI of the bucket file</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>if found </td></tr>
    <tr><td class="paramname">NULL</td><td>if not found</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The object is returned with reference count increased </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00815">815</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00053">ast_media_cache_exists()</a>, <a class="el" href="../../df/dfb/media__cache_8c_source.html#l00197">ast_media_cache_retrieve()</a>, and <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00648">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;{</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uri)) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, uri);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4eb22b16d39185b0c7c0f5a574abb506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb22b16d39185b0c7c0f5a574abb506">&#9670;&nbsp;</a></span>ast_bucket_file_temporary_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_temporary_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Common file snapshot creation callback for creating a temporary file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Pointer to the file snapshot</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00899">899</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dc5/options_8c_source.html#l00150">ast_config_AST_CACHE_DIR</a>, and <a class="el" href="../../dd/d94/bucket_8h_source.html#l00095">ast_bucket_file::path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00573">AST_TEST_DEFINE()</a>, <a class="el" href="../../df/df4/test__media__cache_8c_source.html#l00088">bucket_http_test_wizard_retrieve_id()</a>, <a class="el" href="../../d5/d52/res__http__media__cache_8c_source.html#l00341">bucket_http_wizard_retrieve_id()</a>, and <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l01010">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;{</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   snprintf(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>, <span class="keyword">sizeof</span>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>), <span class="stringliteral">&quot;%s/bucket-XXXXXX&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#a1de8f27469b9469f968154c725a9f1b3">ast_config_AST_CACHE_DIR</a>);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;   fd = mkstemp(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   <span class="keywordflow">if</span> (fd &lt; 0) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   }</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;   close(fd);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;}</div><div class="ttc" id="paths_8h_html_a1de8f27469b9469f968154c725a9f1b3"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a1de8f27469b9469f968154c725a9f1b3">ast_config_AST_CACHE_DIR</a></div><div class="ttdeci">const char * ast_config_AST_CACHE_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00150">options.c:150</a></div></div>
<div class="ttc" id="structast__bucket__file_html_ae8592c5c8f37a4598973aaa27f45dc4c"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">ast_bucket_file::path</a></div><div class="ttdeci">char path[PATH_MAX]</div><div class="ttdoc">Local path to this file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00095">bucket.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acfb027df67d0dc193f2f0cc12f117e05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfb027df67d0dc193f2f0cc12f117e05">&#9670;&nbsp;</a></span>ast_bucket_file_temporary_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_bucket_file_temporary_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Common file snapshot destruction callback for deleting a temporary file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Pointer to the file snapshot </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00914">914</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l02071">AO2_STRING_FIELD_CMP_FN</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l02055">AO2_STRING_FIELD_HASH_FN</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00101">ast_bucket_scheme::name</a>, and <a class="el" href="../../dd/d94/bucket_8h_source.html#l00095">ast_bucket_file::path</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l01010">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;{</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>)) {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      unlink(file-&gt;<a class="code" href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">path</a>);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;   }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;}</div><div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__bucket__file_html_ae8592c5c8f37a4598973aaa27f45dc4c"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html#ae8592c5c8f37a4598973aaa27f45dc4c">ast_bucket_file::path</a></div><div class="ttdeci">char path[PATH_MAX]</div><div class="ttdoc">Local path to this file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00095">bucket.h:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7841adbb1c598c2b68e17918f529356b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7841adbb1c598c2b68e17918f529356b">&#9670;&nbsp;</a></span>ast_bucket_file_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_file_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update an existing bucket file in backend storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The bucket file</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operation will update both the actual content of the file and the metadata associated with it </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00839">839</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02145">ast_sorcery_update()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00672">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;{</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#ab9184a8cdeb14537309e5e020948ecd3">ast_sorcery_update</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, file);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_ab9184a8cdeb14537309e5e020948ecd3"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ab9184a8cdeb14537309e5e020948ecd3">ast_sorcery_update</a></div><div class="ttdeci">int ast_sorcery_update(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Update an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02145">sorcery.c:2145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae723d06b2ac225f6a2b514029c10f37c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae723d06b2ac225f6a2b514029c10f37c">&#9670;&nbsp;</a></span>ast_bucket_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize bucket support. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00954">954</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l00432">__ast_sorcery_wizard_register()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00367">AO2_ALLOC_OPT_LOCK_RWLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../da/d4d/clicompat_8c_source.html#l00019">ast_register_cleanup()</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00477">ast_sorcery_apply_default</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00426">AST_SORCERY_APPLY_FAIL</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00955">ast_sorcery_object_field_register</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l01005">ast_sorcery_object_field_register_custom</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00838">ast_sorcery_object_register</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01128">ast_sorcery_object_set_copy_handler()</a>, <a class="el" href="../../d8/d25/sorcery_8h_source.html#l00408">ast_sorcery_open</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00402">bucket_alloc()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00928">bucket_cleanup()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00497">bucket_copy_handler()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00640">bucket_file_alloc()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00772">bucket_file_copy_handler()</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00816">FLDSET</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00435">OPT_STRINGFIELD_T</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00079">SCHEME_BUCKETS</a>, <a class="el" href="../../db/dfe/config__options_8h_source.html#l00827">STRFLDSET</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00940">timeval_str2struct()</a>, and <a class="el" href="../../db/d43/bucket_8c_source.html#l00947">timeval_struct2str()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d03/asterisk_8c_source.html#l03947">asterisk_daemon()</a>.</p>
<div class="fragment"><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;{</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(&amp;<a class="code" href="../../db/d43/bucket_8c.html#a26fc46d94ed208867039145443adb8fc">bucket_cleanup</a>);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   <a class="code" href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488">AO2_ALLOC_OPT_LOCK_RWLOCK</a>, 0, <a class="code" href="../../db/d43/bucket_8c.html#aa402eccaf2b846008bb626aa71fc37d2">SCHEME_BUCKETS</a>,</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      ast_bucket_scheme_hash_fn, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, ast_bucket_scheme_cmp_fn);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a>) {</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create container for Bucket schemes\n&quot;</span>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;   }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a6b379e5d778d252c30a4cfde03892ca2">__ast_sorcery_wizard_register</a>(&amp;<a class="code" href="../../db/d43/bucket_8c.html#a4edaac22a3c8cf586eb83d8207017e4f">bucket_wizard</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to register sorcery wizard for &#39;bucket&#39; intermediary\n&quot;</span>);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a6b379e5d778d252c30a4cfde03892ca2">__ast_sorcery_wizard_register</a>(&amp;<a class="code" href="../../db/d43/bucket_8c.html#a41ff880ba9db560b8b0a0b6af2b2d7da">bucket_file_wizard</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to register sorcery wizard for &#39;file&#39; intermediary\n&quot;</span>);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a> = <a class="code" href="../../d8/d25/sorcery_8h.html#ad60f3b81bed748245f8045cb48fadee2">ast_sorcery_open</a>())) {</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to create sorcery instance for Bucket support\n&quot;</span>);</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   }</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, <span class="stringliteral">&quot;bucket&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) == <a class="code" href="../../d8/d25/sorcery_8h.html#af7a3667fd0c15838da1a7bca838f6eeea91a2da248015d81e5d5de609c8afc792">AST_SORCERY_APPLY_FAIL</a>) {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to apply intermediary for &#39;bucket&#39; object type in Bucket sorcery\n&quot;</span>);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a81e1c7f2ac4f797136fb2e44cdcc95fa">bucket_alloc</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to register &#39;bucket&#39; object type in Bucket sorcery\n&quot;</span>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;   }</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, <span class="stringliteral">&quot;scheme&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db1/structast__bucket.html">ast_bucket</a>, scheme));</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, <span class="stringliteral">&quot;created&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a5e8c083af883d4c0904c8e05f016670f">timeval_str2struct</a>, <a class="code" href="../../db/d43/bucket_8c.html#a629309a76f7e4bfd95775e9546474fc7">timeval_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db1/structast__bucket.html">ast_bucket</a>, created));</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, <span class="stringliteral">&quot;modified&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a5e8c083af883d4c0904c8e05f016670f">timeval_str2struct</a>, <a class="code" href="../../db/d43/bucket_8c.html#a629309a76f7e4bfd95775e9546474fc7">timeval_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/db1/structast__bucket.html">ast_bucket</a>, modified));</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a491958842ab12e57b6508a7759e9f8f5">ast_sorcery_object_set_copy_handler</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a65ff871f103f296f35f661828ad5a73a">bucket_copy_handler</a>);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, <span class="stringliteral">&quot;bucket_file&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) == <a class="code" href="../../d8/d25/sorcery_8h.html#af7a3667fd0c15838da1a7bca838f6eeea91a2da248015d81e5d5de609c8afc792">AST_SORCERY_APPLY_FAIL</a>) {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to apply intermediary for &#39;file&#39; object type in Bucket sorcery\n&quot;</span>);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a0813c5c406cdaede321b1e3c28a6b592">bucket_file_alloc</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to register &#39;file&#39; object type in Bucket sorcery\n&quot;</span>);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   }</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, <span class="stringliteral">&quot;scheme&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a>, scheme));</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, <span class="stringliteral">&quot;created&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a5e8c083af883d4c0904c8e05f016670f">timeval_str2struct</a>, <a class="code" href="../../db/d43/bucket_8c.html#a629309a76f7e4bfd95775e9546474fc7">timeval_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a>, created));</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, <span class="stringliteral">&quot;modified&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a5e8c083af883d4c0904c8e05f016670f">timeval_str2struct</a>, <a class="code" href="../../db/d43/bucket_8c.html#a629309a76f7e4bfd95775e9546474fc7">timeval_struct2str</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a>, modified));</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a491958842ab12e57b6508a7759e9f8f5">ast_sorcery_object_set_copy_handler</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;file&quot;</span>, <a class="code" href="../../db/d43/bucket_8c.html#a8e296eac4940b5486440a411f8076e59">bucket_file_copy_handler</a>);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;}</div><div class="ttc" id="bucket_8c_html_aa402eccaf2b846008bb626aa71fc37d2"><div class="ttname"><a href="../../db/d43/bucket_8c.html#aa402eccaf2b846008bb626aa71fc37d2">SCHEME_BUCKETS</a></div><div class="ttdeci">#define SCHEME_BUCKETS</div><div class="ttdoc">Number of buckets for the container of schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00079">bucket.c:79</a></div></div>
<div class="ttc" id="sorcery_8h_html_a6b379e5d778d252c30a4cfde03892ca2"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a6b379e5d778d252c30a4cfde03892ca2">__ast_sorcery_wizard_register</a></div><div class="ttdeci">int __ast_sorcery_wizard_register(const struct ast_sorcery_wizard *interface, struct ast_module *module)</div><div class="ttdoc">Register a sorcery wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l00432">sorcery.c:432</a></div></div>
<div class="ttc" id="structast__bucket_html"><div class="ttname"><a href="../../dd/db1/structast__bucket.html">ast_bucket</a></div><div class="ttdoc">Bucket structure, contains other buckets and files. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00057">bucket.h:57</a></div></div>
<div class="ttc" id="bucket_8c_html_a4edaac22a3c8cf586eb83d8207017e4f"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4edaac22a3c8cf586eb83d8207017e4f">bucket_wizard</a></div><div class="ttdeci">static struct ast_sorcery_wizard bucket_wizard</div><div class="ttdoc">Intermediary bucket wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00178">bucket.c:178</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="bucket_8c_html_a26fc46d94ed208867039145443adb8fc"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a26fc46d94ed208867039145443adb8fc">bucket_cleanup</a></div><div class="ttdeci">static void bucket_cleanup(void)</div><div class="ttdoc">Hashing function for scheme container. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00928">bucket.c:928</a></div></div>
<div class="ttc" id="bucket_8c_html_a8e296eac4940b5486440a411f8076e59"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a8e296eac4940b5486440a411f8076e59">bucket_file_copy_handler</a></div><div class="ttdeci">static int bucket_file_copy_handler(const void *src, void *dst)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00772">bucket.c:772</a></div></div>
<div class="ttc" id="bucket_8c_html_a5e8c083af883d4c0904c8e05f016670f"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a5e8c083af883d4c0904c8e05f016670f">timeval_str2struct</a></div><div class="ttdeci">static int timeval_str2struct(const struct aco_option *opt, struct ast_variable *var, void *obj)</div><div class="ttdoc">Custom handler for translating from a string timeval to actual structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00940">bucket.c:940</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="sorcery_8h_html_a720c9774873ec35bae0a0160954767e7"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a720c9774873ec35bae0a0160954767e7">ast_sorcery_object_field_register_custom</a></div><div class="ttdeci">#define ast_sorcery_object_field_register_custom(sorcery, type, name, default_val, config_handler, sorcery_handler, multiple_handler, flags,...)</div><div class="ttdoc">Register a field within an object with custom handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l01005">sorcery.h:1005</a></div></div>
<div class="ttc" id="bucket_8c_html_a0813c5c406cdaede321b1e3c28a6b592"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a0813c5c406cdaede321b1e3c28a6b592">bucket_file_alloc</a></div><div class="ttdeci">static void * bucket_file_alloc(const char *name)</div><div class="ttdoc">Allocator for bucket files. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00640">bucket.c:640</a></div></div>
<div class="ttc" id="config__options_8h_html_a5793d5d6ccf2df0b2423eb3274af7802"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a5793d5d6ccf2df0b2423eb3274af7802">FLDSET</a></div><div class="ttdeci">#define FLDSET(type,...)</div><div class="ttdoc">Convert a struct and list of fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00816">config_options.h:816</a></div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="sorcery_8h_html_a5ee86f00f6e2240f74772d59edf0f74a"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a5ee86f00f6e2240f74772d59edf0f74a">ast_sorcery_object_register</a></div><div class="ttdeci">#define ast_sorcery_object_register(sorcery, type, alloc, transform, apply)</div><div class="ttdoc">Register an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00838">sorcery.h:838</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="bucket_8c_html_a41ff880ba9db560b8b0a0b6af2b2d7da"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a41ff880ba9db560b8b0a0b6af2b2d7da">bucket_file_wizard</a></div><div class="ttdeci">static struct ast_sorcery_wizard bucket_file_wizard</div><div class="ttdoc">Intermediary file wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00268">bucket.c:268</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad1165cf9d45ed5ffa1555371be9ae770"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad1165cf9d45ed5ffa1555371be9ae770">ast_sorcery_apply_default</a></div><div class="ttdeci">#define ast_sorcery_apply_default(sorcery, type, name, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00477">sorcery.h:477</a></div></div>
<div class="ttc" id="bucket_8c_html_a629309a76f7e4bfd95775e9546474fc7"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a629309a76f7e4bfd95775e9546474fc7">timeval_struct2str</a></div><div class="ttdeci">static int timeval_struct2str(const void *obj, const intptr_t *args, char **buf)</div><div class="ttdoc">Custom handler for translating from an actual structure timeval to string. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00947">bucket.c:947</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a7016a58d1b7524c186ccc72ec48ef488">AO2_ALLOC_OPT_LOCK_RWLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00367">astobj2.h:367</a></div></div>
<div class="ttc" id="sorcery_8h_html_af7a3667fd0c15838da1a7bca838f6eeea91a2da248015d81e5d5de609c8afc792"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#af7a3667fd0c15838da1a7bca838f6eeea91a2da248015d81e5d5de609c8afc792">AST_SORCERY_APPLY_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00426">sorcery.h:426</a></div></div>
<div class="ttc" id="config__options_8h_html_a3e5be807d4a10b6da6382a40a0004ace"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a3e5be807d4a10b6da6382a40a0004ace">STRFLDSET</a></div><div class="ttdeci">#define STRFLDSET(type,...)</div><div class="ttdoc">Convert a struct and a list of stringfield fields to an argument list of field offsets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00827">config_options.h:827</a></div></div>
<div class="ttc" id="sorcery_8h_html_a491958842ab12e57b6508a7759e9f8f5"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a491958842ab12e57b6508a7759e9f8f5">ast_sorcery_object_set_copy_handler</a></div><div class="ttdeci">void ast_sorcery_object_set_copy_handler(struct ast_sorcery *sorcery, const char *type, sorcery_copy_handler copy)</div><div class="ttdoc">Set the copy handler for an object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01128">sorcery.c:1128</a></div></div>
<div class="ttc" id="sorcery_8h_html_aa7102b6e71e4fa6525b24a6123a2f6d4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aa7102b6e71e4fa6525b24a6123a2f6d4">ast_sorcery_object_field_register</a></div><div class="ttdeci">#define ast_sorcery_object_field_register(sorcery, type, name, default_val, opt_type, flags,...)</div><div class="ttdoc">Register a field within an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00955">sorcery.h:955</a></div></div>
<div class="ttc" id="bucket_8c_html_a81e1c7f2ac4f797136fb2e44cdcc95fa"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a81e1c7f2ac4f797136fb2e44cdcc95fa">bucket_alloc</a></div><div class="ttdeci">static void * bucket_alloc(const char *name)</div><div class="ttdoc">Allocator for buckets. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00402">bucket.c:402</a></div></div>
<div class="ttc" id="bucket_8c_html_a65ff871f103f296f35f661828ad5a73a"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a65ff871f103f296f35f661828ad5a73a">bucket_copy_handler</a></div><div class="ttdeci">static int bucket_copy_handler(const void *src, void *dst)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00497">bucket.c:497</a></div></div>
<div class="ttc" id="sorcery_8h_html_ad60f3b81bed748245f8045cb48fadee2"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#ad60f3b81bed748245f8045cb48fadee2">ast_sorcery_open</a></div><div class="ttdeci">#define ast_sorcery_open()</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d25/sorcery_8h_source.html#l00408">sorcery.h:408</a></div></div>
<div class="ttc" id="config__options_8h_html_a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540"><div class="ttname"><a href="../../db/dfe/config__options_8h.html#a61bb4940517e7d00e7104de8273c2144afec8c0a18639b70f2e518bc8ee9f3540">OPT_STRINGFIELD_T</a></div><div class="ttdoc">Type for default option handler for stringfields. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/dfe/config__options_8h_source.html#l00435">config_options.h:435</a></div></div>
<div class="ttc" id="bucket_8c_html_a70854cb0002c841cf79aa3aa246cf5ee"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a70854cb0002c841cf79aa3aa246cf5ee">schemes</a></div><div class="ttdeci">static struct ao2_container * schemes</div><div class="ttdoc">Container of registered schemes. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00088">bucket.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a83465ed16e128054eea1c8e784821715"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83465ed16e128054eea1c8e784821715">&#9670;&nbsp;</a></span>ast_bucket_is_stale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_is_stale </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve whether or not the backing datastore views the bucket as stale. </p>
<dl class="section since"><dt>Since</dt><dd>14.0.0</dd></dl>
<p>This function will ask whatever data storage backs the bucket's schema type if the current instance of the object is stale. It will not update the bucket object itself, as said objects are immutable. If the caller of this function would like to update the object, it should perform a retrieve operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bucket</td><td>The bucket object to check</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>if <code>bucket</code> is not stale </td></tr>
    <tr><td class="paramname">1</td><td>if <code>bucket</code> is stale </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00524">524</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02283">ast_sorcery_is_stale()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00331">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#adf633d11cfc74bd08b324e54476b2b42">ast_sorcery_is_stale</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, bucket);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div><div class="ttc" id="sorcery_8h_html_adf633d11cfc74bd08b324e54476b2b42"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#adf633d11cfc74bd08b324e54476b2b42">ast_sorcery_is_stale</a></div><div class="ttdeci">int ast_sorcery_is_stale(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Determine if a sorcery object is stale with respect to its backing datastore. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02283">sorcery.c:2283</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af93b7a25b66772410222582cdc5104b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93b7a25b66772410222582cdc5104b7">&#9670;&nbsp;</a></span>ast_bucket_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d1/da1/structast__json.html">ast_json</a>* ast_bucket_json </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a JSON representation of a bucket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bucket</td><td>The specific bucket</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The returned <a class="el" href="../../d1/da1/structast__json.html" title="Abstract JSON element (object, array, string, int, ...). ">ast_json</a> object must be unreferenced using ast_json_unref </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00544">544</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00534">ao2_iterator_destroy()</a>, <a class="el" href="../../d7/d22/astobj2__container_8c_source.html#l00485">ao2_iterator_init()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01933">ao2_iterator_next</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l02071">AO2_STRING_FIELD_CMP_FN</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l02055">AO2_STRING_FIELD_HASH_FN</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00368">ast_json_array_append()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00352">ast_json_array_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00404">ast_json_object_set()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00067">ast_json_ref()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00268">ast_json_string_create()</a>, <a class="el" href="../../df/d98/json_8c_source.html#l00073">ast_json_unref()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01565">ast_sorcery_objectset_json_create()</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00072">ast_bucket::buckets</a>, <a class="el" href="../../dd/d94/bucket_8h_source.html#l00074">ast_bucket::files</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01507">id</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00101">ast_bucket_scheme::name</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00363">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, json, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>, *files, *buckets;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="keywordtype">char</span> *uri;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   json = <a class="code" href="../../d8/d25/sorcery_8h.html#a7912b02d883b3ade727afd3aa976bfa0">ast_sorcery_objectset_json_create</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, bucket);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keywordflow">if</span> (!json) {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <span class="keywordtype">id</span> = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(bucket));</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <span class="keywordflow">if</span> (!<span class="keywordtype">id</span>) {</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   }</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <span class="stringliteral">&quot;id&quot;</span>, <span class="keywordtype">id</span>)) {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   buckets = <a class="code" href="../../d4/d05/json_8h.html#a48d874eed79fb2bbeb0557440e33ae67">ast_json_array_create</a>();</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="keywordflow">if</span> (!buckets) {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <span class="stringliteral">&quot;buckets&quot;</span>, buckets)) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   }</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(bucket-&gt;<a class="code" href="../../dd/db1/structast__bucket.html#a078c6cfa8ca4406b8a7ff0ca3a93c4ac">buckets</a>, 0);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keywordflow">for</span> (; (uri = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(uri, -1)) {</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *bucket_uri = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(uri);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">if</span> (!bucket_uri || <a class="code" href="../../d4/d05/json_8h.html#a3d675e52f866630a6a03302df2712b8d">ast_json_array_append</a>(buckets, bucket_uri)) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;         res = -1;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(uri, -1);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      }</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   files = <a class="code" href="../../d4/d05/json_8h.html#a48d874eed79fb2bbeb0557440e33ae67">ast_json_array_create</a>();</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="keywordflow">if</span> (!files) {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   }</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a>(json, <span class="stringliteral">&quot;files&quot;</span>, files)) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(bucket-&gt;<a class="code" href="../../dd/db1/structast__bucket.html#a793ccd88917171c7a51928d9821eee70">files</a>, 0);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="keywordflow">for</span> (; (uri = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(uri, -1)) {</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *file_uri = <a class="code" href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a>(uri);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">if</span> (!file_uri || <a class="code" href="../../d4/d05/json_8h.html#a3d675e52f866630a6a03302df2712b8d">ast_json_array_append</a>(files, file_uri)) {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;         res = -1;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(uri, -1);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a>(json);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="keywordflow">return</span> json;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;}</div><div class="ttc" id="json_8h_html_a0ca956b7df20127f7e38993c3c06cb2c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a></div><div class="ttdeci">struct ast_json * ast_json_ref(struct ast_json *value)</div><div class="ttdoc">Increase refcount on value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00067">json.c:67</a></div></div>
<div class="ttc" id="structast__bucket_html_a793ccd88917171c7a51928d9821eee70"><div class="ttname"><a href="../../dd/db1/structast__bucket.html#a793ccd88917171c7a51928d9821eee70">ast_bucket::files</a></div><div class="ttdeci">struct ao2_container * files</div><div class="ttdoc">Container of string URIs of files within this bucket. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00074">bucket.h:74</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="json_8h_html_abc8b563c172cfaffa2b555195990f729"><div class="ttname"><a href="../../d4/d05/json_8h.html#abc8b563c172cfaffa2b555195990f729">ast_json_object_set</a></div><div class="ttdeci">int ast_json_object_set(struct ast_json *object, const char *key, struct ast_json *value)</div><div class="ttdoc">Set a field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00404">json.c:404</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="structast__bucket_html_a078c6cfa8ca4406b8a7ff0ca3a93c4ac"><div class="ttname"><a href="../../dd/db1/structast__bucket.html#a078c6cfa8ca4406b8a7ff0ca3a93c4ac">ast_bucket::buckets</a></div><div class="ttdeci">struct ao2_container * buckets</div><div class="ttdoc">Container of string URIs of buckets within this bucket. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00072">bucket.h:72</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="json_8h_html_adc52f8d76b7fdd0c8d12987981fd5bf5"><div class="ttname"><a href="../../d4/d05/json_8h.html#adc52f8d76b7fdd0c8d12987981fd5bf5">ast_json_string_create</a></div><div class="ttdeci">struct ast_json * ast_json_string_create(const char *value)</div><div class="ttdoc">Construct a JSON string from value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00268">json.c:268</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="json_8h_html_a48d874eed79fb2bbeb0557440e33ae67"><div class="ttname"><a href="../../d4/d05/json_8h.html#a48d874eed79fb2bbeb0557440e33ae67">ast_json_array_create</a></div><div class="ttdeci">struct ast_json * ast_json_array_create(void)</div><div class="ttdoc">Create a empty JSON array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00352">json.c:352</a></div></div>
<div class="ttc" id="json_8h_html_a3d675e52f866630a6a03302df2712b8d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a3d675e52f866630a6a03302df2712b8d">ast_json_array_append</a></div><div class="ttdeci">int ast_json_array_append(struct ast_json *array, struct ast_json *value)</div><div class="ttdoc">Append to an array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00368">json.c:368</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="sorcery_8h_html_a7912b02d883b3ade727afd3aa976bfa0"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a7912b02d883b3ade727afd3aa976bfa0">ast_sorcery_objectset_json_create</a></div><div class="ttdeci">struct ast_json * ast_sorcery_objectset_json_create(const struct ast_sorcery *sorcery, const void *object)</div><div class="ttdoc">Create an object set in JSON format for an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01565">sorcery.c:1565</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2062020d840734ea5b29a6be9255ffe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2062020d840734ea5b29a6be9255ffe">&#9670;&nbsp;</a></span>ast_bucket_observer_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_bucket_observer_add </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *&#160;</td>
          <td class="paramname"><em>callbacks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an observer for bucket creation and deletion operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks</td><td>Implementation of the sorcery observer interface</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>success </td></tr>
    <tr><td class="paramname">-1</td><td>failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>You must be ready to accept observer invocations before this function is called </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00529">529</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02386">ast_sorcery_observer_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;{</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, callbacks);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a6c1928d47eae1172f236e8ee421c2db4"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a6c1928d47eae1172f236e8ee421c2db4">ast_sorcery_observer_add</a></div><div class="ttdeci">int ast_sorcery_observer_add(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Add an observer to a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02386">sorcery.c:2386</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8de2b0424a91d734bdf63174c13cd6a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8de2b0424a91d734bdf63174c13cd6a7">&#9670;&nbsp;</a></span>ast_bucket_observer_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_bucket_observer_remove </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/ddb/structast__sorcery__observer.html">ast_sorcery_observer</a> *&#160;</td>
          <td class="paramname"><em>callbacks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove an observer from bucket creation and deletion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callbacks</td><td>Implementation of the sorcery observer interface </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00534">534</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02418">ast_sorcery_observer_remove()</a>.</p>
<div class="fragment"><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;{</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, callbacks);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div><div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
<div class="ttc" id="sorcery_8h_html_a18d64c360480b458754fc30f781d5011"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a18d64c360480b458754fc30f781d5011">ast_sorcery_observer_remove</a></div><div class="ttdeci">void ast_sorcery_observer_remove(const struct ast_sorcery *sorcery, const char *type, const struct ast_sorcery_observer *callbacks)</div><div class="ttdoc">Remove an observer from a specific object type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02418">sorcery.c:2418</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5059aedbee0b5f2fa4053977d78525f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5059aedbee0b5f2fa4053977d78525f4">&#9670;&nbsp;</a></span>ast_bucket_retrieve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/db1/structast__bucket.html">ast_bucket</a>* ast_bucket_retrieve </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve information about a bucket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uri</td><td>Complete URI of the bucket</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>if found </td></tr>
    <tr><td class="paramname">NULL</td><td>if not found</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The object is returned with reference count increased </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/d43/bucket_8c_source.html#l00515">515</a> of file <a class="el" href="../../db/d43/bucket_8c_source.html">bucket.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01853">ast_sorcery_retrieve_by_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d2d/test__bucket_8c_source.html#l00414">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;{</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uri)) {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   }</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a>(<a class="code" href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a>, <span class="stringliteral">&quot;bucket&quot;</span>, uri);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="sorcery_8h_html_a100106a82d72aa59a66513ef3ad161c8"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a100106a82d72aa59a66513ef3ad161c8">ast_sorcery_retrieve_by_id</a></div><div class="ttdeci">void * ast_sorcery_retrieve_by_id(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Retrieve an object using its unique identifier. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01853">sorcery.c:1853</a></div></div>
<div class="ttc" id="bucket_8c_html_a4ba21f61adf29d46dcc9aee6d3882f81"><div class="ttname"><a href="../../db/d43/bucket_8c.html#a4ba21f61adf29d46dcc9aee6d3882f81">bucket_sorcery</a></div><div class="ttdeci">static struct ast_sorcery * bucket_sorcery</div><div class="ttdoc">Sorcery instance for all bucket operations. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00085">bucket.c:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:44:55 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
