<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: codec_pref.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_9662a6a166de1dda18179da17db0f05a.html">channels</a></li><li class="navelem"><a class="el" href="../../dir_52c28db306937e6f9e49b34c2ed61fbb.html">iax2</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">codec_pref.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Media Format Bitfield Compatibility API.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d8c/logger_8h_source.html">asterisk/logger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d16/codec_8h_source.html">asterisk/codec.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d0a/format_8h_source.html">asterisk/format.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d18/include_2asterisk_2format__compatibility_8h_source.html">asterisk/format_compatibility.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d1c/format__cache_8h_source.html">asterisk/format_cache.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d3c/format__cap_8h_source.html">asterisk/format_cap.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d06/codec__pref_8h_source.html">include/codec_pref.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/dbc/channels_2iax2_2include_2format__compatibility_8h_source.html">include/format_compatibility.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for codec_pref.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/db1/codec__pref_8c__incl.png" border="0" usemap="#codec__pref_8c" alt=""/></div>
<map name="codec__pref_8c" id="codec__pref_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="17,229,101,256"/>
<area shape="rect" id="node22" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="153,453,279,480"/>
<area shape="rect" id="node24" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1689,229,1823,256"/>
<area shape="rect" id="node33" href="../../d1/d16/codec_8h.html" title="Codec API. " alt="" coords="51,155,178,181"/>
<area shape="rect" id="node34" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="76,80,207,107"/>
<area shape="rect" id="node35" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html" title="Media Format Bitfield Compatibility API. " alt="" coords="469,80,686,107"/>
<area shape="rect" id="node36" href="../../db/d1c/format__cache_8h.html" title="Media Format Cache API. " alt="" coords="711,80,887,107"/>
<area shape="rect" id="node37" href="../../d0/d3c/format__cap_8h.html" title="Format Capabilities API. " alt="" coords="231,80,393,107"/>
<area shape="rect" id="node38" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1337,80,1452,107"/>
<area shape="rect" id="node49" href="../../de/d06/codec__pref_8h.html" title="Media Format Bitfield Compatibility API. " alt="" coords="1793,80,1945,107"/>
<area shape="rect" id="node50" href="../../d4/dbc/channels_2iax2_2include_2format__compatibility_8h.html" title="Media Format Bitfield Compatibility API. " alt="" coords="1970,80,2182,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="139,603,293,629"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="846,304,983,331"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="43,304,178,331"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="143,677,289,704"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="881,453,1023,480"/>
<area shape="rect" id="node23" href="../../d7/d5b/options_8h.html" title="Options provided by main asterisk program. " alt="" coords="149,528,283,555"/>
<area shape="rect" id="node25" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1707,379,1821,405"/>
<area shape="rect" id="node28" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1829,528,1976,555"/>
<area shape="rect" id="node32" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1689,304,1839,331"/>
<area shape="rect" id="node27" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1257,453,1319,480"/>
<area shape="rect" id="node31" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="1581,453,1731,480"/>
<area shape="rect" id="node39" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="959,155,1097,181"/>
<area shape="rect" id="node46" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="1211,155,1357,181"/>
<area shape="rect" id="node47" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1965,304,2123,331"/>
<area shape="rect" id="node48" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1432,155,1563,181"/>
</map>
</div>
</div>
<p><a href="../../d2/d17/codec__pref_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab63cd47d2c15eac78e2468777e1a1dc9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#ab63cd47d2c15eac78e2468777e1a1dc9">codec_pref_remove</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, int format_index)</td></tr>
<tr class="memdesc:ab63cd47d2c15eac78e2468777e1a1dc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove codec from pref list.  <a href="#ab63cd47d2c15eac78e2468777e1a1dc9">More...</a><br /></td></tr>
<tr class="separator:ab63cd47d2c15eac78e2468777e1a1dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa63baa2ae80932bb78f393da9b75c6dc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#aa63baa2ae80932bb78f393da9b75c6dc">codec_pref_remove_index</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, int codec_pref_index)</td></tr>
<tr class="separator:aa63baa2ae80932bb78f393da9b75c6dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9240499a894e8386aae7680ba0228a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a9240499a894e8386aae7680ba0228a1e">iax2_codec_pref_append</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> *<a class="el" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, unsigned int framing)</td></tr>
<tr class="memdesc:a9240499a894e8386aae7680ba0228a1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append a audio codec to a preference list, removing it first if it was already there.  <a href="#a9240499a894e8386aae7680ba0228a1e">More...</a><br /></td></tr>
<tr class="separator:a9240499a894e8386aae7680ba0228a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182202e6cfd6e826a664adff5b22d9fc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a182202e6cfd6e826a664adff5b22d9fc">iax2_codec_pref_append_bitfield</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, uint64_t bitfield, unsigned int framing)</td></tr>
<tr class="separator:a182202e6cfd6e826a664adff5b22d9fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed7f665a46ae662a236ffa36df2fb93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#aeed7f665a46ae662a236ffa36df2fb93">iax2_codec_pref_best_bitfield2cap</a> (uint64_t bitfield, struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *prefs, struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *cap)</td></tr>
<tr class="memdesc:aeed7f665a46ae662a236ffa36df2fb93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a bitfield to a format capabilities structure in the "best" order.  <a href="#aeed7f665a46ae662a236ffa36df2fb93">More...</a><br /></td></tr>
<tr class="separator:aeed7f665a46ae662a236ffa36df2fb93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87516b2d9254f6828e83bf73f4f53daf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a87516b2d9254f6828e83bf73f4f53daf">iax2_codec_pref_convert</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size_t size, int right)</td></tr>
<tr class="memdesc:a87516b2d9254f6828e83bf73f4f53daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shift an audio codec preference list up or down 65 bytes so that it becomes an ASCII string.  <a href="#a87516b2d9254f6828e83bf73f4f53daf">More...</a><br /></td></tr>
<tr class="separator:a87516b2d9254f6828e83bf73f4f53daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404557c438140ccd9b748145519225c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a404557c438140ccd9b748145519225c4">iax2_codec_pref_format_bitfield_to_order_value</a> (uint64_t bitfield)</td></tr>
<tr class="memdesc:a404557c438140ccd9b748145519225c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a format bitfield into an <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> order value.  <a href="#a404557c438140ccd9b748145519225c4">More...</a><br /></td></tr>
<tr class="separator:a404557c438140ccd9b748145519225c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc263e89b9bc85e7119ca3beb768ee2"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a6cc263e89b9bc85e7119ca3beb768ee2">iax2_codec_pref_from_bitfield</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, uint64_t bitfield)</td></tr>
<tr class="memdesc:a6cc263e89b9bc85e7119ca3beb768ee2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create codec preference list from the given bitfield formats.  <a href="#a6cc263e89b9bc85e7119ca3beb768ee2">More...</a><br /></td></tr>
<tr class="separator:a6cc263e89b9bc85e7119ca3beb768ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59d9aed53924782a42290227029a1bcf"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a59d9aed53924782a42290227029a1bcf">iax2_codec_pref_index</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, int idx, struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> **<a class="el" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>)</td></tr>
<tr class="memdesc:a59d9aed53924782a42290227029a1bcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Codec located at a particular place in the preference index.  <a href="#a59d9aed53924782a42290227029a1bcf">More...</a><br /></td></tr>
<tr class="separator:a59d9aed53924782a42290227029a1bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a> (int order_value)</td></tr>
<tr class="memdesc:a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> order value into a format bitfield.  <a href="#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">More...</a><br /></td></tr>
<tr class="separator:a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24728052deae34c84205a1650ec50f2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a24728052deae34c84205a1650ec50f2a">iax2_codec_pref_prepend</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> *<a class="el" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>, unsigned int framing, int only_if_existing)</td></tr>
<tr class="memdesc:a24728052deae34c84205a1650ec50f2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepend an audio codec to a preference list, removing it first if it was already there.  <a href="#a24728052deae34c84205a1650ec50f2a">More...</a><br /></td></tr>
<tr class="separator:a24728052deae34c84205a1650ec50f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f3ec921bd5f53888c418ce8469a67bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a8f3ec921bd5f53888c418ce8469a67bf">iax2_codec_pref_remove_missing</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, uint64_t bitfield)</td></tr>
<tr class="memdesc:a8f3ec921bd5f53888c418ce8469a67bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes format from the pref list that aren't in the bitfield.  <a href="#a8f3ec921bd5f53888c418ce8469a67bf">More...</a><br /></td></tr>
<tr class="separator:a8f3ec921bd5f53888c418ce8469a67bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00d3d213a1c030d5715e9d061164ef2e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#a00d3d213a1c030d5715e9d061164ef2e">iax2_codec_pref_string</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, size_t size)</td></tr>
<tr class="memdesc:a00d3d213a1c030d5715e9d061164ef2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump audio codec preference list into a string.  <a href="#a00d3d213a1c030d5715e9d061164ef2e">More...</a><br /></td></tr>
<tr class="separator:a00d3d213a1c030d5715e9d061164ef2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad52fc4575f23808707fdae36bf517716"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#ad52fc4575f23808707fdae36bf517716">iax2_codec_pref_to_cap</a> (struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *pref, struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *cap)</td></tr>
<tr class="memdesc:ad52fc4575f23808707fdae36bf517716"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a preference structure to a capabilities structure.  <a href="#ad52fc4575f23808707fdae36bf517716">More...</a><br /></td></tr>
<tr class="separator:ad52fc4575f23808707fdae36bf517716"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad1db3f1a9eb795d4e0b834c21491e0be"><td class="memItemLeft" align="right" valign="top">static const uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d17/codec__pref_8c.html#ad1db3f1a9eb795d4e0b834c21491e0be">iax2_supported_formats</a> []</td></tr>
<tr class="memdesc:ad1db3f1a9eb795d4e0b834c21491e0be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Formats supported by IAX2.  <a href="#ad1db3f1a9eb795d4e0b834c21491e0be">More...</a><br /></td></tr>
<tr class="separator:ad1db3f1a9eb795d4e0b834c21491e0be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Media Format Bitfield Compatibility API. </p>
<dl class="section author"><dt>Author</dt><dd>Joshua Colp <a href="#" onclick="location.href='mai'+'lto:'+'jco'+'lp'+'@di'+'gi'+'um.'+'co'+'m'; return false;">jcolp<span style="display: none;">.nosp@m.</span>@dig<span style="display: none;">.nosp@m.</span>ium.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab63cd47d2c15eac78e2468777e1a1dc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab63cd47d2c15eac78e2468777e1a1dc9">&#9670;&nbsp;</a></span>codec_pref_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void codec_pref_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>format_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove codec from pref list. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00268">268</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00246">codec_pref_remove_index()</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00401">iax2_codec_pref_append_bitfield()</a>.</p>
<div class="fragment"><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[0]) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>); ++x) {</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x]) {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">if</span> (pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] == format_index) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         <a class="code" href="../../d2/d17/codec__pref_8c.html#aa63baa2ae80932bb78f393da9b75c6dc">codec_pref_remove_index</a>(pref, x);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
<div class="ttc" id="codec__pref_8c_html_aa63baa2ae80932bb78f393da9b75c6dc"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#aa63baa2ae80932bb78f393da9b75c6dc">codec_pref_remove_index</a></div><div class="ttdeci">static void codec_pref_remove_index(struct iax2_codec_pref *pref, int codec_pref_index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00246">codec_pref.c:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa63baa2ae80932bb78f393da9b75c6dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa63baa2ae80932bb78f393da9b75c6dc">&#9670;&nbsp;</a></span>codec_pref_remove_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void codec_pref_remove_index </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>codec_pref_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00246">246</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00038">iax2_codec_pref::framing</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00268">codec_pref_remove()</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00288">iax2_codec_pref_remove_missing()</a>.</p>
<div class="fragment"><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;{</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   idx = codec_pref_index;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <span class="keywordflow">if</span> (idx == <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>) - 1) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="comment">/* Remove from last array entry. */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx] = 0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[idx] = 0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   }</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <span class="keywordflow">for</span> (; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>); ++idx) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx] = pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx + 1];</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[idx] = pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[idx + 1];</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx]) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aca72ea98a86c000ce3e91ee164f3d966"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">iax2_codec_pref::framing</a></div><div class="ttdeci">unsigned int framing[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00038">codec_pref.h:38</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9240499a894e8386aae7680ba0228a1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9240499a894e8386aae7680ba0228a1e">&#9670;&nbsp;</a></span>iax2_codec_pref_append()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax2_codec_pref_append </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>framing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append a audio codec to a preference list, removing it first if it was already there. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00422">422</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de1/main_2format__compatibility_8c_source.html#l00039">ast_format_compatibility_format2bitfield()</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00401">iax2_codec_pref_append_bitfield()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01929">iax2_parse_allow_disallow()</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;   uint64_t bitfield;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   bitfield = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a2fea9280c775fadc7929b5213dff7f36">ast_format_compatibility_format2bitfield</a>(format);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keywordflow">if</span> (!bitfield) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="../../d2/d17/codec__pref_8c.html#a182202e6cfd6e826a664adff5b22d9fc">iax2_codec_pref_append_bitfield</a>(pref, bitfield, framing);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;}</div><div class="ttc" id="include_2asterisk_2format__compatibility_8h_html_a2fea9280c775fadc7929b5213dff7f36"><div class="ttname"><a href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a2fea9280c775fadc7929b5213dff7f36">ast_format_compatibility_format2bitfield</a></div><div class="ttdeci">uint64_t ast_format_compatibility_format2bitfield(const struct ast_format *format)</div><div class="ttdoc">Convert a format structure to its respective bitfield. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de1/main_2format__compatibility_8c_source.html#l00039">main/format_compatibility.c:39</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a182202e6cfd6e826a664adff5b22d9fc"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a182202e6cfd6e826a664adff5b22d9fc">iax2_codec_pref_append_bitfield</a></div><div class="ttdeci">static void iax2_codec_pref_append_bitfield(struct iax2_codec_pref *pref, uint64_t bitfield, unsigned int framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00401">codec_pref.c:401</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a182202e6cfd6e826a664adff5b22d9fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a182202e6cfd6e826a664adff5b22d9fc">&#9670;&nbsp;</a></span>iax2_codec_pref_append_bitfield()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void iax2_codec_pref_append_bitfield </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bitfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>framing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00401">401</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00268">codec_pref_remove()</a>, <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00038">iax2_codec_pref::framing</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00376">iax2_codec_pref_format_bitfield_to_order_value()</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00422">iax2_codec_pref_append()</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00483">iax2_codec_pref_from_bitfield()</a>.</p>
<div class="fragment"><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="keywordtype">int</span> format_index;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   format_index = <a class="code" href="../../d2/d17/codec__pref_8c.html#a404557c438140ccd9b748145519225c4">iax2_codec_pref_format_bitfield_to_order_value</a>(bitfield);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="keywordflow">if</span> (!format_index) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <a class="code" href="../../d2/d17/codec__pref_8c.html#ab63cd47d2c15eac78e2468777e1a1dc9">codec_pref_remove</a>(pref, format_index);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>); ++x) {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x]) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;         pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] = format_index;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;         pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[x] = framing;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aca72ea98a86c000ce3e91ee164f3d966"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">iax2_codec_pref::framing</a></div><div class="ttdeci">unsigned int framing[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00038">codec_pref.h:38</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a404557c438140ccd9b748145519225c4"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a404557c438140ccd9b748145519225c4">iax2_codec_pref_format_bitfield_to_order_value</a></div><div class="ttdeci">int iax2_codec_pref_format_bitfield_to_order_value(uint64_t bitfield)</div><div class="ttdoc">Convert a format bitfield into an iax2_codec_pref order value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00376">codec_pref.c:376</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
<div class="ttc" id="codec__pref_8c_html_ab63cd47d2c15eac78e2468777e1a1dc9"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#ab63cd47d2c15eac78e2468777e1a1dc9">codec_pref_remove</a></div><div class="ttdeci">static void codec_pref_remove(struct iax2_codec_pref *pref, int format_index)</div><div class="ttdoc">Remove codec from pref list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00268">codec_pref.c:268</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeed7f665a46ae662a236ffa36df2fb93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed7f665a46ae662a236ffa36df2fb93">&#9670;&nbsp;</a></span>iax2_codec_pref_best_bitfield2cap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax2_codec_pref_best_bitfield2cap </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bitfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>prefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *&#160;</td>
          <td class="paramname"><em>cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a bitfield to a format capabilities structure in the "best" order. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bitfield</td><td>The bitfield for the media formats </td></tr>
    <tr><td class="paramname">prefs</td><td>Format preference order to use as a guide. (May be NULL) </td></tr>
    <tr><td class="paramname">cap</td><td>Capabilities structure to place formats into</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If failure occurs the capabilities structure may contain a partial set of formats </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00112">112</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00103">ast_format_cap_append</a>, <a class="el" href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">ast_format_compatibility_bitfield2format()</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00102">format</a>, <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00038">iax2_codec_pref::framing</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00367">iax2_codec_pref_order_value_to_format_bitfield()</a>, <a class="el" href="../../db/d09/channels_2iax2_2format__compatibility_8c_source.html#l00079">iax2_format_compatibility_best()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l05829">ast_iax2_new()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l10083">socket_process_helper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   uint64_t best_bitfield;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d98/structast__format.html">ast_format</a> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="comment">/* Add any user preferred codecs first. */</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="keywordflow">if</span> (prefs) {</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">for</span> (idx = 0; bitfield &amp;&amp; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(prefs-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>); ++idx) {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;         best_bitfield = <a class="code" href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a>(prefs-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx]);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;         <span class="keywordflow">if</span> (!best_bitfield) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;         }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;         <span class="keywordflow">if</span> (best_bitfield &amp; bitfield) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            format = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a>(best_bitfield);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (format &amp;&amp; <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(cap, format, prefs-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[idx])) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;               <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="comment">/* Remove just added codec. */</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            bitfield &amp;= ~best_bitfield;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;         }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="comment">/* Add the hard coded &quot;best&quot; codecs. */</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="keywordflow">while</span> (bitfield) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      best_bitfield = <a class="code" href="../../db/d09/channels_2iax2_2format__compatibility_8c.html#a1d50ec1648ab7e2cfa3f79246b5a4457">iax2_format_compatibility_best</a>(bitfield);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="keywordflow">if</span> (!best_bitfield) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         <span class="comment">/* No more codecs considered best. */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      format = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a>(best_bitfield);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="comment">/* The best_bitfield should always be convertible to a format. */</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(format != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(cap, format, 0)) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">/* Remove just added &quot;best&quot; codec to find the next &quot;best&quot;. */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      bitfield &amp;= ~best_bitfield;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="comment">/* Add any remaining codecs. */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keywordflow">if</span> (bitfield) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">for</span> (bit = 0; bit &lt; 64; ++bit) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         uint64_t mask = (1ULL &lt;&lt; bit);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         <span class="keywordflow">if</span> (mask &amp; bitfield) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            format = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a>(mask);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">if</span> (format &amp;&amp; <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(cap, format, 0)) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;               <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div><div class="ttc" id="include_2asterisk_2format__compatibility_8h_html_a43dc7c73f5f43a8e92005e4461dbcc9e"><div class="ttname"><a href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a></div><div class="ttdeci">struct ast_format * ast_format_compatibility_bitfield2format(uint64_t bitfield)</div><div class="ttdoc">Convert a bitfield to its respective format structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">main/format_compatibility.c:173</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structast__format_html"><div class="ttname"><a href="../../d0/d98/structast__format.html">ast_format</a></div><div class="ttdoc">Definition of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00043">format.c:43</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a></div><div class="ttdeci">uint64_t iax2_codec_pref_order_value_to_format_bitfield(int order_value)</div><div class="ttdoc">Convert an iax2_codec_pref order value into a format bitfield. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00367">codec_pref.c:367</a></div></div>
<div class="ttc" id="format__cap_8h_html_ab4d69f2179ed5ca138c9b3d85334217f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a></div><div class="ttdeci">#define ast_format_cap_append(cap, format, framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00103">format_cap.h:103</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aca72ea98a86c000ce3e91ee164f3d966"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">iax2_codec_pref::framing</a></div><div class="ttdeci">unsigned int framing[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00038">codec_pref.h:38</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
<div class="ttc" id="channels_2iax2_2format__compatibility_8c_html_a1d50ec1648ab7e2cfa3f79246b5a4457"><div class="ttname"><a href="../../db/d09/channels_2iax2_2format__compatibility_8c.html#a1d50ec1648ab7e2cfa3f79246b5a4457">iax2_format_compatibility_best</a></div><div class="ttdeci">uint64_t iax2_format_compatibility_best(uint64_t formats)</div><div class="ttdoc">Pick the best format from the given bitfield formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d09/channels_2iax2_2format__compatibility_8c_source.html#l00079">channels/iax2/format_compatibility.c:79</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a98f5e70e98f6dc48e3c5ba316066d540"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a></div><div class="ttdeci">static snd_pcm_format_t format</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00102">chan_alsa.c:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87516b2d9254f6828e83bf73f4f53daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87516b2d9254f6828e83bf73f4f53daf">&#9670;&nbsp;</a></span>iax2_codec_pref_convert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax2_codec_pref_convert </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shift an audio codec preference list up or down 65 bytes so that it becomes an ASCII string. </p>
<dl class="section note"><dt>Note</dt><dd>Due to a misunderstanding in how codec preferences are stored, this list starts at 'B', not 'A'. For backwards compatibility reasons, this cannot change. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pref</td><td>A codec preference list structure </td></tr>
    <tr><td class="paramname">buf</td><td>A string denoting codec preference, appropriate for use in line transmission </td></tr>
    <tr><td class="paramname">size</td><td>Size of <em>buf</em> </td></tr>
    <tr><td class="paramname">right</td><td>Boolean: if 0, convert from <em>buf</em> to <em>pref</em>; if 1, convert from <em>pref</em> to <em>buf</em>. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00044">44</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00038">iax2_codec_pref::framing</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l07787">check_access()</a>, <a class="el" href="../../d2/d72/parser_8c_source.html#l00130">dump_prefs()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l05076">iax2_call()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l10083">socket_process_helper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="keyword">static</span> <span class="keywordtype">int</span> differential = (int) <span class="charliteral">&#39;A&#39;</span>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   <span class="keywordflow">if</span> (right) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      --size;<span class="comment">/* Save room for the nul string terminator. */</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>) &amp;&amp; x &lt; size; ++x) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x]) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;         }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;         <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[x] = pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] + differential;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[x] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>) &amp;&amp; x &lt; size; ++x) {</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[x] == <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[x] - differential;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;         pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[x] = 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">if</span> (x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>)) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] = 0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[x] = 0;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aca72ea98a86c000ce3e91ee164f3d966"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">iax2_codec_pref::framing</a></div><div class="ttdeci">unsigned int framing[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00038">codec_pref.h:38</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a404557c438140ccd9b748145519225c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404557c438140ccd9b748145519225c4">&#9670;&nbsp;</a></span>iax2_codec_pref_format_bitfield_to_order_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax2_codec_pref_format_bitfield_to_order_value </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bitfield</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a format bitfield into an <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> order value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bitfield</td><td>value being converted</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> order value of the most significant format in the bitfield.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is really meant to be used on single format bitfields. It will work with multiformat bitfields, but it can only return the index of the most significant one if that is the case. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00376">376</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00324">iax2_supported_formats</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00401">iax2_codec_pref_append_bitfield()</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00434">iax2_codec_pref_prepend()</a>.</p>
<div class="fragment"><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;{</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordflow">if</span> (bitfield) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d2/d17/codec__pref_8c.html#ad1db3f1a9eb795d4e0b834c21491e0be">iax2_supported_formats</a>); ++idx) {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d17/codec__pref_8c.html#ad1db3f1a9eb795d4e0b834c21491e0be">iax2_supported_formats</a>[idx] == bitfield) {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">return</span> idx + 1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="codec__pref_8c_html_ad1db3f1a9eb795d4e0b834c21491e0be"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#ad1db3f1a9eb795d4e0b834c21491e0be">iax2_supported_formats</a></div><div class="ttdeci">static const uint64_t iax2_supported_formats[]</div><div class="ttdoc">Formats supported by IAX2. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00324">codec_pref.c:324</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cc263e89b9bc85e7119ca3beb768ee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cc263e89b9bc85e7119ca3beb768ee2">&#9670;&nbsp;</a></span>iax2_codec_pref_from_bitfield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t iax2_codec_pref_from_bitfield </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bitfield</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create codec preference list from the given bitfield formats. </p>
<dl class="section since"><dt>Since</dt><dd>13.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pref</td><td>Codec preference list to setup from the given bitfield. </td></tr>
    <tr><td class="paramname">bitfield</td><td>Format bitfield to guide preference list creation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Updated bitfield with any bits not mapped to a format cleared. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00483">483</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">ast_format_compatibility_bitfield2format()</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00102">format</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00401">iax2_codec_pref_append_bitfield()</a>, <a class="el" href="../../db/d09/channels_2iax2_2format__compatibility_8c_source.html#l00079">iax2_format_compatibility_best()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l13476">set_config()</a>.</p>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <span class="keywordtype">int</span> bit;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   uint64_t working_bitfield;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   uint64_t best_bitfield;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d98/structast__format.html">ast_format</a> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="comment">/* Init the preference list. */</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   memset(pref, 0, <span class="keyword">sizeof</span>(*pref));</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   working_bitfield = bitfield;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="comment">/* Add the &quot;best&quot; codecs first. */</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keywordflow">while</span> (working_bitfield) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      best_bitfield = <a class="code" href="../../db/d09/channels_2iax2_2format__compatibility_8c.html#a1d50ec1648ab7e2cfa3f79246b5a4457">iax2_format_compatibility_best</a>(working_bitfield);</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">if</span> (!best_bitfield) {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;         <span class="comment">/* No more codecs considered best. */</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="comment">/* Remove current &quot;best&quot; codec to find the next &quot;best&quot;. */</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      working_bitfield &amp;= ~best_bitfield;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      format = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a>(best_bitfield);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="comment">/* The best_bitfield should always be convertible to a format. */</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(format != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <a class="code" href="../../d2/d17/codec__pref_8c.html#a182202e6cfd6e826a664adff5b22d9fc">iax2_codec_pref_append_bitfield</a>(pref, best_bitfield, 0);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   <span class="comment">/* Add any remaining codecs. */</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keywordflow">if</span> (working_bitfield) {</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">for</span> (bit = 0; bit &lt; 64; ++bit) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;         uint64_t mask = (1ULL &lt;&lt; bit);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;         <span class="keywordflow">if</span> (mask &amp; working_bitfield) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            format = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a>(mask);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordflow">if</span> (!format) {</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;               <span class="comment">/* The bit is not associated with any format. */</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;               bitfield &amp;= ~mask;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <a class="code" href="../../d2/d17/codec__pref_8c.html#a182202e6cfd6e826a664adff5b22d9fc">iax2_codec_pref_append_bitfield</a>(pref, mask, 0);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <span class="keywordflow">return</span> bitfield;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div><div class="ttc" id="include_2asterisk_2format__compatibility_8h_html_a43dc7c73f5f43a8e92005e4461dbcc9e"><div class="ttname"><a href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a></div><div class="ttdeci">struct ast_format * ast_format_compatibility_bitfield2format(uint64_t bitfield)</div><div class="ttdoc">Convert a bitfield to its respective format structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">main/format_compatibility.c:173</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a182202e6cfd6e826a664adff5b22d9fc"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a182202e6cfd6e826a664adff5b22d9fc">iax2_codec_pref_append_bitfield</a></div><div class="ttdeci">static void iax2_codec_pref_append_bitfield(struct iax2_codec_pref *pref, uint64_t bitfield, unsigned int framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00401">codec_pref.c:401</a></div></div>
<div class="ttc" id="structast__format_html"><div class="ttname"><a href="../../d0/d98/structast__format.html">ast_format</a></div><div class="ttdoc">Definition of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00043">format.c:43</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="channels_2iax2_2format__compatibility_8c_html_a1d50ec1648ab7e2cfa3f79246b5a4457"><div class="ttname"><a href="../../db/d09/channels_2iax2_2format__compatibility_8c.html#a1d50ec1648ab7e2cfa3f79246b5a4457">iax2_format_compatibility_best</a></div><div class="ttdeci">uint64_t iax2_format_compatibility_best(uint64_t formats)</div><div class="ttdoc">Pick the best format from the given bitfield formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d09/channels_2iax2_2format__compatibility_8c_source.html#l00079">channels/iax2/format_compatibility.c:79</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a98f5e70e98f6dc48e3c5ba316066d540"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a></div><div class="ttdeci">static snd_pcm_format_t format</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00102">chan_alsa.c:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59d9aed53924782a42290227029a1bcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59d9aed53924782a42290227029a1bcf">&#9670;&nbsp;</a></span>iax2_codec_pref_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a>* iax2_codec_pref_index </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> **&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Codec located at a particular place in the preference index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pref</td><td>preference structure to get the codec out of </td></tr>
    <tr><td class="paramname">index</td><td>to retrieve from </td></tr>
    <tr><td class="paramname">result</td><td><a class="el" href="../../d0/d98/structast__format.html" title="Definition of a media format. ">ast_format</a> structure to store the index value in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to input <a class="el" href="../../d0/d98/structast__format.html" title="Definition of a media format. ">ast_format</a> on success, NULL on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00077">77</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">ast_format_compatibility_bitfield2format()</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00367">iax2_codec_pref_order_value_to_format_bitfield()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>, and <a class="el" href="../../de/d1b/cel__pgsql_8c_source.html#l00088">result</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l14390">function_iaxpeer()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l10083">socket_process_helper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="keywordflow">if</span> (0 &lt;= idx &amp;&amp; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>) &amp;&amp; pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx]) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      uint64_t pref_bitfield;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      pref_bitfield = <a class="code" href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx]);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      *result = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a>(pref_bitfield);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      *result = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="keywordflow">return</span> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div><div class="ttc" id="include_2asterisk_2format__compatibility_8h_html_a43dc7c73f5f43a8e92005e4461dbcc9e"><div class="ttname"><a href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a></div><div class="ttdeci">struct ast_format * ast_format_compatibility_bitfield2format(uint64_t bitfield)</div><div class="ttdoc">Convert a bitfield to its respective format structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">main/format_compatibility.c:173</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a></div><div class="ttdeci">uint64_t iax2_codec_pref_order_value_to_format_bitfield(int order_value)</div><div class="ttdoc">Convert an iax2_codec_pref order value into a format bitfield. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00367">codec_pref.c:367</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">&#9670;&nbsp;</a></span>iax2_codec_pref_order_value_to_format_bitfield()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t iax2_codec_pref_order_value_to_format_bitfield </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>order_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> order value into a format bitfield. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">order_value</td><td>value being converted</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the bitfield value of the order_value format </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00367">367</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00324">iax2_supported_formats</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01847">codec_choose_from_prefs()</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00112">iax2_codec_pref_best_bitfield2cap()</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00077">iax2_codec_pref_index()</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00288">iax2_codec_pref_remove_missing()</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00091">iax2_codec_pref_to_cap()</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <span class="keywordflow">if</span> (order_value &lt; 1 || <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../d2/d17/codec__pref_8c.html#ad1db3f1a9eb795d4e0b834c21491e0be">iax2_supported_formats</a>) &lt; order_value) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d17/codec__pref_8c.html#ad1db3f1a9eb795d4e0b834c21491e0be">iax2_supported_formats</a>[order_value - 1];</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="codec__pref_8c_html_ad1db3f1a9eb795d4e0b834c21491e0be"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#ad1db3f1a9eb795d4e0b834c21491e0be">iax2_supported_formats</a></div><div class="ttdeci">static const uint64_t iax2_supported_formats[]</div><div class="ttdoc">Formats supported by IAX2. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00324">codec_pref.c:324</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24728052deae34c84205a1650ec50f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24728052deae34c84205a1650ec50f2a">&#9670;&nbsp;</a></span>iax2_codec_pref_prepend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax2_codec_pref_prepend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d98/structast__format.html">ast_format</a> *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>framing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>only_if_existing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepend an audio codec to a preference list, removing it first if it was already there. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00434">434</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d9/de1/main_2format__compatibility_8c_source.html#l00039">ast_format_compatibility_format2bitfield()</a>, <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00038">iax2_codec_pref::framing</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00376">iax2_codec_pref_format_bitfield_to_order_value()</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l04608">create_addr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;{</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   uint64_t bitfield;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   <span class="keywordtype">int</span> format_index;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;   bitfield = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a2fea9280c775fadc7929b5213dff7f36">ast_format_compatibility_format2bitfield</a>(format);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keywordflow">if</span> (!bitfield) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   format_index = <a class="code" href="../../d2/d17/codec__pref_8c.html#a404557c438140ccd9b748145519225c4">iax2_codec_pref_format_bitfield_to_order_value</a>(bitfield);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <span class="keywordflow">if</span> (!format_index) {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="comment">/* Now find any existing occurrence, or the end */</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>); ++x) {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] || pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] == format_index)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">    * The array can never be full without format_index</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">    * also being in the array.</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>));</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="comment">/* If we failed to find any occurrence, set to the end for safety. */</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>) &lt;= x) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      x = <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>) - 1;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordflow">if</span> (only_if_existing &amp;&amp; !pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x]) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="comment">/* Move down to make space to insert - either all the way to the end,</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">      or as far as the existing location (which will be overwritten) */</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="keywordflow">for</span> (; x &gt; 0; --x) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x] = pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[x - 1];</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[x] = pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[x - 1];</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="comment">/* And insert the new entry */</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[0] = format_index;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[0] = framing;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="include_2asterisk_2format__compatibility_8h_html_a2fea9280c775fadc7929b5213dff7f36"><div class="ttname"><a href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a2fea9280c775fadc7929b5213dff7f36">ast_format_compatibility_format2bitfield</a></div><div class="ttdeci">uint64_t ast_format_compatibility_format2bitfield(const struct ast_format *format)</div><div class="ttdoc">Convert a format structure to its respective bitfield. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de1/main_2format__compatibility_8c_source.html#l00039">main/format_compatibility.c:39</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aca72ea98a86c000ce3e91ee164f3d966"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">iax2_codec_pref::framing</a></div><div class="ttdeci">unsigned int framing[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00038">codec_pref.h:38</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a404557c438140ccd9b748145519225c4"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a404557c438140ccd9b748145519225c4">iax2_codec_pref_format_bitfield_to_order_value</a></div><div class="ttdeci">int iax2_codec_pref_format_bitfield_to_order_value(uint64_t bitfield)</div><div class="ttdoc">Convert a format bitfield into an iax2_codec_pref order value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00376">codec_pref.c:376</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f3ec921bd5f53888c418ce8469a67bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f3ec921bd5f53888c418ce8469a67bf">&#9670;&nbsp;</a></span>iax2_codec_pref_remove_missing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void iax2_codec_pref_remove_missing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>bitfield</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes format from the pref list that aren't in the bitfield. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00288">288</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00246">codec_pref_remove_index()</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00367">iax2_codec_pref_order_value_to_format_bitfield()</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01929">iax2_parse_allow_disallow()</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="keywordflow">if</span> (!pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[0]) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">    * Work from the end of the list so we always deal with</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    * unmodified entries in case we have to remove a pref.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordflow">for</span> (idx = <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>); idx--;) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      uint64_t pref_bitfield;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      pref_bitfield = <a class="code" href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx]);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">if</span> (!pref_bitfield) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">/* If this format isn&#39;t in the bitfield, remove it from the prefs. */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">if</span> (!(pref_bitfield &amp; bitfield)) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;         <a class="code" href="../../d2/d17/codec__pref_8c.html#aa63baa2ae80932bb78f393da9b75c6dc">codec_pref_remove_index</a>(pref, idx);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div><div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a></div><div class="ttdeci">uint64_t iax2_codec_pref_order_value_to_format_bitfield(int order_value)</div><div class="ttdoc">Convert an iax2_codec_pref order value into a format bitfield. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00367">codec_pref.c:367</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
<div class="ttc" id="codec__pref_8c_html_aa63baa2ae80932bb78f393da9b75c6dc"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#aa63baa2ae80932bb78f393da9b75c6dc">codec_pref_remove_index</a></div><div class="ttdeci">static void codec_pref_remove_index(struct iax2_codec_pref *pref, int codec_pref_index)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00246">codec_pref.c:246</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a00d3d213a1c030d5715e9d061164ef2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00d3d213a1c030d5715e9d061164ef2e">&#9670;&nbsp;</a></span>iax2_codec_pref_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax2_codec_pref_string </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump audio codec preference list into a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pref</td><td>preference structure to dump string representation of order for </td></tr>
    <tr><td class="paramname">buf</td><td>character buffer to put string into </td></tr>
    <tr><td class="paramname">size</td><td>size of the character buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>-1 on error. Otherwise returns the remaining spaaaaaace in the buffer.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Format is (codec1|codec2|codec3|...) &ndash; if the list is too long for the size of the buffer, codecs will be written until they exceed the length remaining in which case the list will be closed with '...)' after the last writable codec. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00178">178</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00395">ast_format_cap_count()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00400">ast_format_cap_get_format()</a>, <a class="el" href="../../de/da6/format_8c_source.html#l00334">ast_format_get_name()</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00091">iax2_codec_pref_to_cap()</a>, and <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00074">name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d72/parser_8c_source.html#l00130">dump_prefs()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l03815">handle_cli_iax2_show_peer()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l10083">socket_process_helper()</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *cap;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="keywordtype">size_t</span> total_len;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keywordtype">char</span> *cur;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <span class="comment">/* This function is useless if you have less than a 6 character buffer.</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">    * &#39;(...)&#39; is six characters. */</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="keywordflow">if</span> (size &lt; 6) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="comment">/* Convert the preferences into a format cap so that we can read the format names */</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   <span class="keywordflow">if</span> (!cap || <a class="code" href="../../d2/d17/codec__pref_8c.html#ad52fc4575f23808707fdae36bf517716">iax2_codec_pref_to_cap</a>(pref, cap)) {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      strcpy(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="stringliteral">&quot;(...)&quot;</span>); <span class="comment">/* Safe */</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cap);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="comment">/* We know that at a minimum, 3 characters are used - (, ), and \0 */</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   total_len = size - 3;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <span class="comment">/* This character has already been accounted for total_len purposes */</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[0] = <span class="charliteral">&#39;(&#39;</span>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   cur = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> + 1;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <span class="comment">/* Loop through the formats and write as many into the buffer as we can */</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a>(cap); x++) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordtype">size_t</span> name_len;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d98/structast__format.html">ast_format</a> *fmt = <a class="code" href="../../d0/d3c/format__cap_8h.html#a5d2c52e9d892cd7c6488563cf00ba9bc">ast_format_cap_get_format</a>(cap, x);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(fmt);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      name_len = strlen(name);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="comment">/* all entries after the first need a delimiter character */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">if</span> (x) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;         name_len++;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="comment">/* Terminate the list early if we don&#39;t have room for the entry.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">       * If it&#39;s not the last entry in the list, save enough room to write &#39;...&#39;.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">if</span> (((x == <a class="code" href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a>(cap) - 1) &amp;&amp; (total_len &lt; name_len)) ||</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            ((x &lt; <a class="code" href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a>(cap) - 1) &amp;&amp; (total_len &lt; name_len + 3))) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         strcpy(cur, <span class="stringliteral">&quot;...&quot;</span>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         cur += 3;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         total_len -= 3;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(fmt, -1);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      sprintf(cur, <span class="stringliteral">&quot;%s%s&quot;</span>, x ? <span class="stringliteral">&quot;|&quot;</span> : <span class="stringliteral">&quot;&quot;</span>, name);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      cur += name_len;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      total_len -= name_len;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(fmt, -1);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cap, -1);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="comment">/* These two characters have already been accounted for total_len purposes */</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   cur[0] = <span class="charliteral">&#39;)&#39;</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   cur[1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <span class="keywordflow">return</span> size - total_len;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structast__format_html"><div class="ttname"><a href="../../d0/d98/structast__format.html">ast_format</a></div><div class="ttdoc">Definition of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00043">format.c:43</a></div></div>
<div class="ttc" id="format__cap_8h_html_aefb7d3623f4d8a582168e7aaf509459c"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a></div><div class="ttdeci">size_t ast_format_cap_count(const struct ast_format_cap *cap)</div><div class="ttdoc">Get the number of formats present within the capabilities structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00395">format_cap.c:395</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="codec__pref_8c_html_ad52fc4575f23808707fdae36bf517716"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#ad52fc4575f23808707fdae36bf517716">iax2_codec_pref_to_cap</a></div><div class="ttdeci">int iax2_codec_pref_to_cap(struct iax2_codec_pref *pref, struct ast_format_cap *cap)</div><div class="ttdoc">Convert a preference structure to a capabilities structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00091">codec_pref.c:91</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="format__cap_8h_html_a5d2c52e9d892cd7c6488563cf00ba9bc"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a5d2c52e9d892cd7c6488563cf00ba9bc">ast_format_cap_get_format</a></div><div class="ttdeci">struct ast_format * ast_format_cap_get_format(const struct ast_format_cap *cap, int position)</div><div class="ttdoc">Get the format at a specific index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00400">format_cap.c:400</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad52fc4575f23808707fdae36bf517716"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad52fc4575f23808707fdae36bf517716">&#9670;&nbsp;</a></span>iax2_codec_pref_to_cap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iax2_codec_pref_to_cap </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d3f/structiax2__codec__pref.html">iax2_codec_pref</a> *&#160;</td>
          <td class="paramname"><em>pref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *&#160;</td>
          <td class="paramname"><em>cap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a preference structure to a capabilities structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pref</td><td>Formats in preference order to build the capabilities. </td></tr>
    <tr><td class="paramname">cap</td><td>Capabilities structure to place formats into</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If failure occurs the capabilities structure may contain a partial set of formats </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00091">91</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/dfe/isdn__lib_8c_source.html#l00042">ARRAY_LEN</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00103">ast_format_cap_append</a>, <a class="el" href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">ast_format_compatibility_bitfield2format()</a>, <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00038">iax2_codec_pref::framing</a>, <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00367">iax2_codec_pref_order_value_to_format_bitfield()</a>, and <a class="el" href="../../de/d06/codec__pref_8h_source.html#l00036">iax2_codec_pref::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00178">iax2_codec_pref_string()</a>, and <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l01929">iax2_parse_allow_disallow()</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordtype">int</span> idx;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>); ++idx) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      uint64_t pref_bitfield;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d98/structast__format.html">ast_format</a> *pref_format;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      pref_bitfield = <a class="code" href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a>(pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">order</a>[idx]);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordflow">if</span> (!pref_bitfield) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      pref_format = <a class="code" href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a>(pref_bitfield);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (pref_format &amp;&amp; <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(cap, pref_format, pref-&gt;<a class="code" href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">framing</a>[idx])) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div><div class="ttc" id="include_2asterisk_2format__compatibility_8h_html_a43dc7c73f5f43a8e92005e4461dbcc9e"><div class="ttname"><a href="../../d1/d18/include_2asterisk_2format__compatibility_8h.html#a43dc7c73f5f43a8e92005e4461dbcc9e">ast_format_compatibility_bitfield2format</a></div><div class="ttdeci">struct ast_format * ast_format_compatibility_bitfield2format(uint64_t bitfield)</div><div class="ttdoc">Convert a bitfield to its respective format structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de1/main_2format__compatibility_8c_source.html#l00173">main/format_compatibility.c:173</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structast__format_html"><div class="ttname"><a href="../../d0/d98/structast__format.html">ast_format</a></div><div class="ttdoc">Definition of a media format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00043">format.c:43</a></div></div>
<div class="ttc" id="codec__pref_8c_html_a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83"><div class="ttname"><a href="../../d2/d17/codec__pref_8c.html#a6a1eb7ce58f8c5c7f57bbe5fdd7c4f83">iax2_codec_pref_order_value_to_format_bitfield</a></div><div class="ttdeci">uint64_t iax2_codec_pref_order_value_to_format_bitfield(int order_value)</div><div class="ttdoc">Convert an iax2_codec_pref order value into a format bitfield. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d17/codec__pref_8c_source.html#l00367">codec_pref.c:367</a></div></div>
<div class="ttc" id="format__cap_8h_html_ab4d69f2179ed5ca138c9b3d85334217f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a></div><div class="ttdeci">#define ast_format_cap_append(cap, format, framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00103">format_cap.h:103</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aca72ea98a86c000ce3e91ee164f3d966"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aca72ea98a86c000ce3e91ee164f3d966">iax2_codec_pref::framing</a></div><div class="ttdeci">unsigned int framing[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00038">codec_pref.h:38</a></div></div>
<div class="ttc" id="structiax2__codec__pref_html_aefb78611f353969f8f9b795f98e8fa8a"><div class="ttname"><a href="../../d3/d3f/structiax2__codec__pref.html#aefb78611f353969f8f9b795f98e8fa8a">iax2_codec_pref::order</a></div><div class="ttdeci">char order[IAX2_CODEC_PREF_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d06/codec__pref_8h_source.html#l00036">codec_pref.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad1db3f1a9eb795d4e0b834c21491e0be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1db3f1a9eb795d4e0b834c21491e0be">&#9670;&nbsp;</a></span>iax2_supported_formats</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint64_t iax2_supported_formats[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Formats supported by IAX2. </p>
<dl class="section note"><dt>Note</dt><dd>All AST_FORMAT_xxx compatibility bit defines must be represented here.</dd>
<dd>
The order is important because the array index+1 values go out over the wire. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00324">324</a> of file <a class="el" href="../../d2/d17/codec__pref_8c_source.html">codec_pref.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00376">iax2_codec_pref_format_bitfield_to_order_value()</a>, and <a class="el" href="../../d2/d17/codec__pref_8c_source.html#l00367">iax2_codec_pref_order_value_to_format_bitfield()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:45:36 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
