<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: plc.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_6d4b1cdb59e2db6ad82005b337288fef.html">asterisk</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">plc.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>SpanDSP - a series of DSP components for telephony.  
<a href="#details">More...</a></p>
<div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="../../d4/dfe/plc_8h__dep__incl.png" border="0" usemap="#plc_8hdep" alt=""/></div>
<map name="plc_8hdep" id="plc_8hdep">
<area shape="rect" id="node2" href="../../db/d39/translate_8h.html" title="Support for translation of data formats. translate.c. " alt="" coords="3166,80,3257,107"/>
<area shape="rect" id="node50" href="../../d7/d1f/plc_8c.html" title="SpanDSP &#45; a series of DSP components for telephony. " alt="" coords="3281,80,3331,107"/>
<area shape="rect" id="node3" href="../../dc/d5c/app__alarmreceiver_8c.html" title="Central Station Alarm receiver for Ademco Contact ID. " alt="" coords="5,155,156,181"/>
<area shape="rect" id="node4" href="../../dc/d04/app__chanspy_8c.html" title="ChanSpy: Listen in on any channel. " alt="" coords="181,155,295,181"/>
<area shape="rect" id="node5" href="../../d9/d12/app__dial_8c.html" title="dial() &amp; retrydial() &#45; Trivial application to dial a channel and send an URL on answer ..." alt="" coords="320,155,407,181"/>
<area shape="rect" id="node6" href="../../d4/d7e/app__disa_8c.html" title="DISA – Direct Inward System Access Application. " alt="" coords="431,155,522,181"/>
<area shape="rect" id="node7" href="../../d2/ddd/app__dumpchan_8c.html" title="Application to dump channel variables. " alt="" coords="547,155,679,181"/>
<area shape="rect" id="node8" href="../../d0/dd8/app__flash_8c.html" title="App to flash a DAHDI trunk. " alt="" coords="703,155,797,181"/>
<area shape="rect" id="node9" href="../../dd/d55/app__followme_8c.html" title="Find&#45;Me Follow&#45;Me application. " alt="" coords="822,155,942,181"/>
<area shape="rect" id="node10" href="../../da/d8a/app__ices_8c.html" title="Stream to an icecast server via ICES (see contrib/asterisk&#45;ices.xml) " alt="" coords="967,155,1056,181"/>
<area shape="rect" id="node11" href="../../df/d44/app__meetme_8c.html" title="Meet me conference bridge and Shared Line Appearances. " alt="" coords="1080,155,1199,181"/>
<area shape="rect" id="node12" href="../../d1/d9a/app__mp3_8c.html" title="Silly application to play an MP3 file – uses mpg123. " alt="" coords="1223,155,1317,181"/>
<area shape="rect" id="node13" href="../../df/d1d/app__nbscat_8c.html" title="Silly application to play an NBScat file – uses nbscat8k. " alt="" coords="1341,155,1447,181"/>
<area shape="rect" id="node14" href="../../d7/d17/app__privacy_8c.html" title="Block all calls without Caller*ID, require phone # to be entered. " alt="" coords="1471,155,1578,181"/>
<area shape="rect" id="node15" href="../../da/dfb/app__queue_8c.html" title="True call queues with optional send URL on answer. " alt="" coords="1602,155,1706,181"/>
<area shape="rect" id="node16" href="../../d3/dba/app__talkdetect_8c.html" title="Playback a file with audio detect. " alt="" coords="1730,155,1858,181"/>
<area shape="rect" id="node17" href="../../d0/d72/app__zapateller_8c.html" title="Playback the special information tone to get rid of telemarketers. " alt="" coords="1883,155,2009,181"/>
<area shape="rect" id="node18" href="../../d8/df0/bridge__softmix__internal_8h.html" title="Multi&#45;party software based channel mixing (header) " alt="" coords="2033,155,2216,181"/>
<area shape="rect" id="node19" href="../../d5/dff/chan__iax2_8c.html" title="Implementation of Inter&#45;Asterisk eXchange Version 2 as specified in RFC 5456. " alt="" coords="2240,155,2337,181"/>
<area shape="rect" id="node20" href="../../d7/d9b/chan__misdn_8c.html" title="the chan_misdn channel driver for Asterisk " alt="" coords="2361,155,2472,181"/>
<area shape="rect" id="node21" href="../../d0/d29/chan__pjsip_8c.html" title="PSJIP SIP Channel Driver. " alt="" coords="2496,155,2596,181"/>
<area shape="rect" id="node22" href="../../d5/dfe/chan__sip_8c.html" title="Implementation of Session Initiation Protocol. " alt="" coords="2620,155,2709,181"/>
<area shape="rect" id="node23" href="../../d2/d35/codec__a__mu_8c.html" title="codec_a_mu.c &#45; translate between alaw and ulaw directly " alt="" coords="2734,155,2849,181"/>
<area shape="rect" id="node24" href="../../d0/dd5/codec__adpcm_8c.html" title="codec_adpcm.c &#45; translate between signed linear and Dialogic ADPCM " alt="" coords="2873,155,2995,181"/>
<area shape="rect" id="node25" href="../../d2/d58/codec__alaw_8c.html" title="codec_alaw.c &#45; translate between signed linear and alaw " alt="" coords="3020,155,3125,181"/>
<area shape="rect" id="node26" href="../../dc/d47/codec__codec2_8c.html" title="Translate between signed linear and Codec 2. " alt="" coords="3149,155,3273,181"/>
<area shape="rect" id="node27" href="../../de/d52/codec__dahdi_8c.html" title="Translate between various formats natively through DAHDI transcoding. " alt="" coords="3297,155,3411,181"/>
<area shape="rect" id="node28" href="../../d2/dba/codec__g722_8c.html" title="codec_g722.c &#45; translate between signed linear and ITU G.722&#45;64kbps " alt="" coords="3435,155,3545,181"/>
<area shape="rect" id="node29" href="../../d0/d89/codec__g726_8c.html" title="codec_g726.c &#45; translate between signed linear and ITU G.726&#45;32kbps (both RFC3551 and AAL2 codeword p..." alt="" coords="3569,155,3680,181"/>
<area shape="rect" id="node30" href="../../d0/d10/codec__gsm_8c.html" title="Translate between signed linear and Global System for Mobile Communications (GSM) ..." alt="" coords="3705,155,3811,181"/>
<area shape="rect" id="node31" href="../../dc/d8e/codec__ilbc_8c.html" title="Translate between signed linear and Internet Low Bitrate Codec. " alt="" coords="3835,155,3934,181"/>
<area shape="rect" id="node32" href="../../dd/df9/codec__lpc10_8c.html" title="Translate between signed linear and LPC10 (Linear Predictor Code) " alt="" coords="3958,155,4070,181"/>
<area shape="rect" id="node33" href="../../d0/d66/codec__resample_8c.html" title="Resample slinear audio. " alt="" coords="4094,155,4233,181"/>
<area shape="rect" id="node34" href="../../dc/d23/codec__speex_8c.html" title="Translate between signed linear and Speex (Open Codec) " alt="" coords="4257,155,4373,181"/>
<area shape="rect" id="node35" href="../../db/d2a/codec__ulaw_8c.html" title="codec_ulaw.c &#45; translate between signed linear and ulaw " alt="" coords="4397,155,4503,181"/>
<area shape="rect" id="node36" href="../../d5/d03/asterisk_8c.html" title="Top level source file for Asterisk &#45; the Open Source PBX. Implementation of PBX core functions and CL..." alt="" coords="4526,155,4609,181"/>
<area shape="rect" id="node37" href="../../d9/d4f/audiohook_8c.html" title="Audiohooks Architecture. " alt="" coords="4633,155,4731,181"/>
<area shape="rect" id="node38" href="../../d5/d66/autoservice_8c.html" title="Automatic channel service routines. " alt="" coords="4755,155,4862,181"/>
<area shape="rect" id="node39" href="../../d4/d28/channel_8c.html" title="Channel Management. " alt="" coords="4886,155,4969,181"/>
<area shape="rect" id="node40" href="../../df/dd3/main_2cli_8c.html" title="Standard Command Line Interface. " alt="" coords="4993,155,5040,181"/>
<area shape="rect" id="node41" href="../../de/d47/core__local_8c.html" title="Local proxy channel driver. " alt="" coords="5064,155,5161,181"/>
<area shape="rect" id="node42" href="../../d5/d92/features_8c.html" title="Routines implementing call features as call pickup, parking and transfer. " alt="" coords="5185,155,5272,181"/>
<area shape="rect" id="node43" href="../../d6/d13/file_8c.html" title="Generic File Format Support. " alt="" coords="5297,155,5347,181"/>
<area shape="rect" id="node44" href="../../df/d55/main_2frame_8c.html" title="Frame and codec manipulation routines. " alt="" coords="5372,155,5443,181"/>
<area shape="rect" id="node45" href="../../d3/d10/image_8c.html" title="Image Management. " alt="" coords="5467,155,5540,181"/>
<area shape="rect" id="node46" href="../../d4/d10/manager_8c.html" title="The Asterisk Management Interface &#45; AMI. " alt="" coords="5565,155,5655,181"/>
<area shape="rect" id="node47" href="../../da/dbe/rtp__engine_8c.html" title="Pluggable RTP Architecture. " alt="" coords="5679,155,5781,181"/>
<area shape="rect" id="node48" href="../../df/dcf/slinfactory_8c.html" title="A machine to gather up arbitrary frames and convert them to raw slinear on demand. " alt="" coords="5805,155,5901,181"/>
<area shape="rect" id="node49" href="../../dc/d2b/stasis__channels_8c.html" title="Stasis Messages and Data Types for Channel Objects. " alt="" coords="5925,155,6060,181"/>
</map>
</div>
</div>
<p><a href="../../d2/d66/plc_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a310742dc9f5861d619d8e570d9dd7541"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#a310742dc9f5861d619d8e570d9dd7541">CORRELATION_SPAN</a>&#160;&#160;&#160;160</td></tr>
<tr class="separator:a310742dc9f5861d619d8e570d9dd7541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4215d664fa72bc00ac10390bb3981378"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#a4215d664fa72bc00ac10390bb3981378">PLC_HISTORY_LEN</a>&#160;&#160;&#160;(<a class="el" href="../../d2/d66/plc_8h.html#a310742dc9f5861d619d8e570d9dd7541">CORRELATION_SPAN</a> + <a class="el" href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a>)</td></tr>
<tr class="separator:a4215d664fa72bc00ac10390bb3981378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bb17e224b89544d8bb75d77878f1e9d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#a8bb17e224b89544d8bb75d77878f1e9d">PLC_PITCH_MAX</a>&#160;&#160;&#160;40</td></tr>
<tr class="separator:a8bb17e224b89544d8bb75d77878f1e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4303d472f9fea54ceaecb0ea7efea210"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a>&#160;&#160;&#160;120</td></tr>
<tr class="separator:a4303d472f9fea54ceaecb0ea7efea210"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c033f1bda71b5025a4279e12d5b396"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#ac8c033f1bda71b5025a4279e12d5b396">PLC_PITCH_OVERLAP_MAX</a>&#160;&#160;&#160;(<a class="el" href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a> &gt;&gt; 2)</td></tr>
<tr class="separator:ac8c033f1bda71b5025a4279e12d5b396"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1d67d861ec6d5a43808697001e51425e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#a1d67d861ec6d5a43808697001e51425e">plc_fillin</a> (<a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a> *s, <a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a> amp[], int <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</td></tr>
<tr class="memdesc:a1d67d861ec6d5a43808697001e51425e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill-in a block of missing audio samples.  <a href="#a1d67d861ec6d5a43808697001e51425e">More...</a><br /></td></tr>
<tr class="separator:a1d67d861ec6d5a43808697001e51425e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aada6d5ccb00c8c16c28a07b8a68b1b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#a2aada6d5ccb00c8c16c28a07b8a68b1b">plc_init</a> (<a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a> *s)</td></tr>
<tr class="memdesc:a2aada6d5ccb00c8c16c28a07b8a68b1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a block of received V.29 modem audio samples.  <a href="#a2aada6d5ccb00c8c16c28a07b8a68b1b">More...</a><br /></td></tr>
<tr class="separator:a2aada6d5ccb00c8c16c28a07b8a68b1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af99c26d697c92e41dd6a83ada318ee4a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d66/plc_8h.html#af99c26d697c92e41dd6a83ada318ee4a">plc_rx</a> (<a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a> *s, <a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a> amp[], int <a class="el" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</td></tr>
<tr class="memdesc:af99c26d697c92e41dd6a83ada318ee4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process a block of received audio samples.  <a href="#af99c26d697c92e41dd6a83ada318ee4a">More...</a><br /></td></tr>
<tr class="separator:af99c26d697c92e41dd6a83ada318ee4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SpanDSP - a series of DSP components for telephony. </p>
<p><a class="el" href="../../d2/d66/plc_8h.html" title="SpanDSP - a series of DSP components for telephony. ">plc.h</a></p>
<dl class="section author"><dt>Author</dt><dd>Steve Underwood <a href="#" onclick="location.href='mai'+'lto:'+'ste'+'ve'+'u@c'+'op'+'pic'+'e.'+'org'; return false;">steve<span style="display: none;">.nosp@m.</span>u@co<span style="display: none;">.nosp@m.</span>ppice<span style="display: none;">.nosp@m.</span>.org</a></dd></dl>
<p>Copyright (C) 2004 Steve Underwood</p>
<p>All rights reserved.</p>
<p>This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</p>
<p>This version may be optionally licenced under the GNU LGPL licence.</p>
<p>A license has been granted to Digium (via disclaimer) for the use of this code. </p>

<p class="definition">Definition in file <a class="el" href="../../d2/d66/plc_8h_source.html">plc.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a310742dc9f5861d619d8e570d9dd7541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a310742dc9f5861d619d8e570d9dd7541">&#9670;&nbsp;</a></span>CORRELATION_SPAN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRELATION_SPAN&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The length over which the AMDF function looks for similarity (20 ms) </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d66/plc_8h_source.html#l00099">99</a> of file <a class="el" href="../../d2/d66/plc_8h_source.html">plc.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1f/plc_8c_source.html#l00175">plc_fillin()</a>.</p>

</div>
</div>
<a id="a4215d664fa72bc00ac10390bb3981378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4215d664fa72bc00ac10390bb3981378">&#9670;&nbsp;</a></span>PLC_HISTORY_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLC_HISTORY_LEN&#160;&#160;&#160;(<a class="el" href="../../d2/d66/plc_8h.html#a310742dc9f5861d619d8e570d9dd7541">CORRELATION_SPAN</a> + <a class="el" href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>History buffer length. The buffer much also be at leat 1.25 times PLC_PITCH_MIN, but that is much smaller than the buffer needs to be for the pitch assessment. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d66/plc_8h_source.html#l00103">103</a> of file <a class="el" href="../../d2/d66/plc_8h_source.html">plc.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1f/plc_8c_source.html#l00094">normalise_history()</a>, <a class="el" href="../../d7/d1f/plc_8c_source.html#l00175">plc_fillin()</a>, and <a class="el" href="../../d7/d1f/plc_8c_source.html#l00071">save_history()</a>.</p>

</div>
</div>
<a id="a8bb17e224b89544d8bb75d77878f1e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bb17e224b89544d8bb75d77878f1e9d">&#9670;&nbsp;</a></span>PLC_PITCH_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLC_PITCH_MAX&#160;&#160;&#160;40</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum allowed pitch (200 Hz) </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d66/plc_8h_source.html#l00095">95</a> of file <a class="el" href="../../d2/d66/plc_8h_source.html">plc.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1f/plc_8c_source.html#l00175">plc_fillin()</a>.</p>

</div>
</div>
<a id="a4303d472f9fea54ceaecb0ea7efea210"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4303d472f9fea54ceaecb0ea7efea210">&#9670;&nbsp;</a></span>PLC_PITCH_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLC_PITCH_MIN&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Minimum allowed pitch (66 Hz) </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d66/plc_8h_source.html#l00093">93</a> of file <a class="el" href="../../d2/d66/plc_8h_source.html">plc.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d1f/plc_8c_source.html#l00175">plc_fillin()</a>.</p>

</div>
</div>
<a id="ac8c033f1bda71b5025a4279e12d5b396"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c033f1bda71b5025a4279e12d5b396">&#9670;&nbsp;</a></span>PLC_PITCH_OVERLAP_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLC_PITCH_OVERLAP_MAX&#160;&#160;&#160;(<a class="el" href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a> &gt;&gt; 2)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximum pitch OLA window </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d66/plc_8h_source.html#l00097">97</a> of file <a class="el" href="../../d2/d66/plc_8h_source.html">plc.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1d67d861ec6d5a43808697001e51425e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d67d861ec6d5a43808697001e51425e">&#9670;&nbsp;</a></span>plc_fillin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int plc_fillin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a>&#160;</td>
          <td class="paramname"><em>amp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill-in a block of missing audio samples. </p>
<p>Fill-in a block of missing audio samples. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The packet loss concealer context. </td></tr>
    <tr><td class="paramname">amp</td><td>The audio sample buffer. </td></tr>
    <tr><td class="paramname">len</td><td>The number of samples to be synthesised. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of samples synthesized. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1f/plc_8c_source.html#l00175">175</a> of file <a class="el" href="../../d7/d1f/plc_8c_source.html">plc.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d1f/plc_8c_source.html#l00108">amdf_pitch()</a>, <a class="el" href="../../d7/d1f/plc_8c_source.html#l00058">ATTENUATION_INCREMENT</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00099">CORRELATION_SPAN</a>, <a class="el" href="../../d7/d1f/plc_8c_source.html#l00062">fsaturate()</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00116">plc_state_t::history</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00108">plc_state_t::missing_samples</a>, <a class="el" href="../../d7/d1f/plc_8c_source.html#l00094">normalise_history()</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00112">plc_state_t::pitch</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00110">plc_state_t::pitch_offset</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00114">plc_state_t::pitchbuf</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00103">PLC_HISTORY_LEN</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00095">PLC_PITCH_MAX</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00093">PLC_PITCH_MIN</a>, and <a class="el" href="../../d7/d1f/plc_8c_source.html#l00071">save_history()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d28/channel_8c_source.html#l05098">adjust_frame_for_plc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;{</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keywordtype">int</span> pitch_overlap;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordtype">float</span> old_step;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keywordtype">float</span> new_step;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keywordtype">float</span> old_weight;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="keywordtype">float</span> new_weight;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keywordtype">float</span> gain;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <span class="keywordtype">int</span> orig_len;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   orig_len = <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">missing_samples</a> == 0) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">/* As the gap in real speech starts we need to assess the last known pitch,</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">      and prepare the synthetic data we will use for fill-in */</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="../../d7/d1f/plc_8c.html#a619e39f08a819e435bd9cf631d6c2fff">normalise_history</a>(s);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a> = <a class="code" href="../../d7/d1f/plc_8c.html#a8092b276b69e8d95b1665945b3ddc949">amdf_pitch</a>(<a class="code" href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a>, <a class="code" href="../../d2/d66/plc_8h.html#a8bb17e224b89544d8bb75d77878f1e9d">PLC_PITCH_MAX</a>, s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a3723195aa42793a0504eebc1ce3a7a81">history</a> + <a class="code" href="../../d2/d66/plc_8h.html#a4215d664fa72bc00ac10390bb3981378">PLC_HISTORY_LEN</a> - <a class="code" href="../../d2/d66/plc_8h.html#a310742dc9f5861d619d8e570d9dd7541">CORRELATION_SPAN</a> - <a class="code" href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a>, <a class="code" href="../../d2/d66/plc_8h.html#a310742dc9f5861d619d8e570d9dd7541">CORRELATION_SPAN</a>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">/* We overlap a 1/4 wavelength */</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      pitch_overlap = s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a> &gt;&gt; 2;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">/* Cook up a single cycle of pitch, using a single of the real signal with 1/4</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">      cycle OLA&#39;ed to make the ends join up nicely */</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="comment">/* The first 3/4 of the cycle is a simple copy */</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">for</span> (i = 0;  i &lt; s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a> - pitch_overlap;  i++)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;         s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a440aa050931ba2f079f06650c47bbccf">pitchbuf</a>[i] = s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a3723195aa42793a0504eebc1ce3a7a81">history</a>[<a class="code" href="../../d2/d66/plc_8h.html#a4215d664fa72bc00ac10390bb3981378">PLC_HISTORY_LEN</a> - s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a> + i];</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="comment">/* The last 1/4 of the cycle is overlapped with the end of the previous cycle */</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      new_step = 1.0/pitch_overlap;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      new_weight = new_step;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      for ( ; i &lt; s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a>; i++) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a440aa050931ba2f079f06650c47bbccf">pitchbuf</a>[i] = s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a3723195aa42793a0504eebc1ce3a7a81">history</a>[<a class="code" href="../../d2/d66/plc_8h.html#a4215d664fa72bc00ac10390bb3981378">PLC_HISTORY_LEN</a> - s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a> + i] * (1.0 - new_weight) + s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a3723195aa42793a0504eebc1ce3a7a81">history</a>[<a class="code" href="../../d2/d66/plc_8h.html#a4215d664fa72bc00ac10390bb3981378">PLC_HISTORY_LEN</a> - 2 * s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a> + i]*new_weight;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         new_weight += new_step;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">/* We should now be ready to fill in the gap with repeated, decaying cycles</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">      of what is in pitchbuf */</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">/* We need to OLA the first 1/4 wavelength of the synthetic data, to smooth</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">      it into the previous real data. To avoid the need to introduce a delay</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">      in the stream, reverse the last 1/4 wavelength, and OLA with that. */</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      gain = 1.0;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      new_step = 1.0 / pitch_overlap;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      old_step = new_step;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      new_weight = new_step;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      old_weight = 1.0 - new_step;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; pitch_overlap; i++) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;         amp[i] = <a class="code" href="../../d7/d1f/plc_8c.html#a8b07df006c820a75859ea4c3fb35c82b">fsaturate</a>(old_weight * s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a3723195aa42793a0504eebc1ce3a7a81">history</a>[<a class="code" href="../../d2/d66/plc_8h.html#a4215d664fa72bc00ac10390bb3981378">PLC_HISTORY_LEN</a> - 1 - i] + new_weight * s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a440aa050931ba2f079f06650c47bbccf">pitchbuf</a>[i]);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;         new_weight += new_step;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         old_weight -= old_step;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         <span class="keywordflow">if</span> (old_weight &lt; 0.0)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            old_weight = 0.0;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">pitch_offset</a> = i;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      gain = 1.0 - s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">missing_samples</a>*<a class="code" href="../../d7/d1f/plc_8c.html#ad8573d09c0e87bfb6bd374a40cca04a1">ATTENUATION_INCREMENT</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      i = 0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="keywordflow">for</span> ( ; gain &gt; 0.0 &amp;&amp; i &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; i++) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      amp[i] = s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a440aa050931ba2f079f06650c47bbccf">pitchbuf</a>[s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">pitch_offset</a>] * gain;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      gain -= <a class="code" href="../../d7/d1f/plc_8c.html#ad8573d09c0e87bfb6bd374a40cca04a1">ATTENUATION_INCREMENT</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">if</span> (++s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">pitch_offset</a> &gt;= s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a>)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;         s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">pitch_offset</a> = 0;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="keywordflow">for</span> ( ; i &lt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>; i++)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      amp[i] = 0;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">missing_samples</a> += orig_len;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <a class="code" href="../../d7/d1f/plc_8c.html#aa943632c836baf9550bb39d57345cb20">save_history</a>(s, amp, len);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="ttc" id="plc_8c_html_ad8573d09c0e87bfb6bd374a40cca04a1"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#ad8573d09c0e87bfb6bd374a40cca04a1">ATTENUATION_INCREMENT</a></div><div class="ttdeci">#define ATTENUATION_INCREMENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00058">plc.c:58</a></div></div>
<div class="ttc" id="structplc__state__t_html_a05c8b22d2905f7a52fa31b13f85c70f3"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">plc_state_t::pitch</a></div><div class="ttdeci">int pitch</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00112">plc.h:112</a></div></div>
<div class="ttc" id="plc_8c_html_a619e39f08a819e435bd9cf631d6c2fff"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#a619e39f08a819e435bd9cf631d6c2fff">normalise_history</a></div><div class="ttdeci">static void normalise_history(plc_state_t *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00094">plc.c:94</a></div></div>
<div class="ttc" id="plc_8h_html_a8bb17e224b89544d8bb75d77878f1e9d"><div class="ttname"><a href="../../d2/d66/plc_8h.html#a8bb17e224b89544d8bb75d77878f1e9d">PLC_PITCH_MAX</a></div><div class="ttdeci">#define PLC_PITCH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00095">plc.h:95</a></div></div>
<div class="ttc" id="structplc__state__t_html_a3723195aa42793a0504eebc1ce3a7a81"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#a3723195aa42793a0504eebc1ce3a7a81">plc_state_t::history</a></div><div class="ttdeci">int16_t history[PLC_HISTORY_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00116">plc.h:116</a></div></div>
<div class="ttc" id="plc_8h_html_a4215d664fa72bc00ac10390bb3981378"><div class="ttname"><a href="../../d2/d66/plc_8h.html#a4215d664fa72bc00ac10390bb3981378">PLC_HISTORY_LEN</a></div><div class="ttdeci">#define PLC_HISTORY_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00103">plc.h:103</a></div></div>
<div class="ttc" id="plc_8c_html_a8b07df006c820a75859ea4c3fb35c82b"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#a8b07df006c820a75859ea4c3fb35c82b">fsaturate</a></div><div class="ttdeci">static int16_t fsaturate(double damp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00062">plc.c:62</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structplc__state__t_html_ac36f43f35737e608c560f4c855fc0e36"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">plc_state_t::missing_samples</a></div><div class="ttdeci">int missing_samples</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00108">plc.h:108</a></div></div>
<div class="ttc" id="plc_8c_html_aa943632c836baf9550bb39d57345cb20"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#aa943632c836baf9550bb39d57345cb20">save_history</a></div><div class="ttdeci">static void save_history(plc_state_t *s, int16_t *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00071">plc.c:71</a></div></div>
<div class="ttc" id="plc_8h_html_a4303d472f9fea54ceaecb0ea7efea210"><div class="ttname"><a href="../../d2/d66/plc_8h.html#a4303d472f9fea54ceaecb0ea7efea210">PLC_PITCH_MIN</a></div><div class="ttdeci">#define PLC_PITCH_MIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00093">plc.h:93</a></div></div>
<div class="ttc" id="plc_8h_html_a310742dc9f5861d619d8e570d9dd7541"><div class="ttname"><a href="../../d2/d66/plc_8h.html#a310742dc9f5861d619d8e570d9dd7541">CORRELATION_SPAN</a></div><div class="ttdeci">#define CORRELATION_SPAN</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00099">plc.h:99</a></div></div>
<div class="ttc" id="structplc__state__t_html_a0378b3d37277e2f8933570490909075d"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">plc_state_t::pitch_offset</a></div><div class="ttdeci">int pitch_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00110">plc.h:110</a></div></div>
<div class="ttc" id="plc_8c_html_a8092b276b69e8d95b1665945b3ddc949"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#a8092b276b69e8d95b1665945b3ddc949">amdf_pitch</a></div><div class="ttdeci">static int __inline__ amdf_pitch(int min_pitch, int max_pitch, int16_t amp[], int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00108">plc.c:108</a></div></div>
<div class="ttc" id="structplc__state__t_html_a440aa050931ba2f079f06650c47bbccf"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#a440aa050931ba2f079f06650c47bbccf">plc_state_t::pitchbuf</a></div><div class="ttdeci">float pitchbuf[PLC_PITCH_MIN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00114">plc.h:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2aada6d5ccb00c8c16c28a07b8a68b1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aada6d5ccb00c8c16c28a07b8a68b1b">&#9670;&nbsp;</a></span>plc_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a>* plc_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process a block of received V.29 modem audio samples. </p>
<p>Process a block of received V.29 modem audio samples. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The packet loss concealer context. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the he packet loss concealer context. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1f/plc_8c_source.html#l00244">244</a> of file <a class="el" href="../../d7/d1f/plc_8c_source.html">plc.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   memset(s, 0, <span class="keyword">sizeof</span>(*s));</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="keywordflow">return</span> s;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="af99c26d697c92e41dd6a83ada318ee4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af99c26d697c92e41dd6a83ada318ee4a">&#9670;&nbsp;</a></span>plc_rx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int plc_rx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/dc7/structplc__state__t.html">plc_state_t</a> *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d4e/db_8h.html#aa343fa3b3d06292b959ffdd4c4703b06">int16_t</a>&#160;</td>
          <td class="paramname"><em>amp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Process a block of received audio samples. </p>
<p>Process a block of received audio samples. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The packet loss concealer context. </td></tr>
    <tr><td class="paramname">amp</td><td>The audio sample buffer. </td></tr>
    <tr><td class="paramname">len</td><td>The number of samples in the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of samples in the buffer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1f/plc_8c_source.html#l00132">132</a> of file <a class="el" href="../../d7/d1f/plc_8c_source.html">plc.c</a>.</p>

<p class="reference">References <a class="el" href="../../d7/d1f/plc_8c_source.html#l00058">ATTENUATION_INCREMENT</a>, <a class="el" href="../../d7/d1f/plc_8c_source.html#l00062">fsaturate()</a>, <a class="el" href="../../d9/d1e/func__strings_8c_source.html#l01344">len()</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00108">plc_state_t::missing_samples</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00112">plc_state_t::pitch</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00110">plc_state_t::pitch_offset</a>, <a class="el" href="../../d2/d66/plc_8h_source.html#l00114">plc_state_t::pitchbuf</a>, and <a class="el" href="../../d7/d1f/plc_8c_source.html#l00071">save_history()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d28/channel_8c_source.html#l05098">adjust_frame_for_plc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordtype">int</span> pitch_overlap;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keywordtype">float</span> old_step;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keywordtype">float</span> new_step;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keywordtype">float</span> old_weight;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordtype">float</span> new_weight;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="keywordtype">float</span> gain;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">missing_samples</a>) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">/* Although we have a real signal, we need to smooth it to fit well</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">      with the synthetic signal we used for the previous block */</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">/* The start of the real data is overlapped with the next 1/4 cycle</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">         of the synthetic data. */</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      pitch_overlap = s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a> &gt;&gt; 2;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">if</span> (pitch_overlap &gt; <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;         pitch_overlap = <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      gain = 1.0 - s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">missing_samples</a>*<a class="code" href="../../d7/d1f/plc_8c.html#ad8573d09c0e87bfb6bd374a40cca04a1">ATTENUATION_INCREMENT</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">if</span> (gain &lt; 0.0)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;         gain = 0.0;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      new_step = 1.0/pitch_overlap;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      old_step = new_step*gain;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      new_weight = new_step;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      old_weight = (1.0 - new_step)*gain;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; pitch_overlap; i++) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;         amp[i] = <a class="code" href="../../d7/d1f/plc_8c.html#a8b07df006c820a75859ea4c3fb35c82b">fsaturate</a>(old_weight * s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a440aa050931ba2f079f06650c47bbccf">pitchbuf</a>[s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">pitch_offset</a>] + new_weight * amp[i]);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         <span class="keywordflow">if</span> (++s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">pitch_offset</a> &gt;= s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">pitch</a>)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">pitch_offset</a> = 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;         new_weight += new_step;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         old_weight -= old_step;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         <span class="keywordflow">if</span> (old_weight &lt; 0.0)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            old_weight = 0.0;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      s-&gt;<a class="code" href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">missing_samples</a> = 0;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <a class="code" href="../../d7/d1f/plc_8c.html#aa943632c836baf9550bb39d57345cb20">save_history</a>(s, amp, <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div><div class="ttc" id="plc_8c_html_ad8573d09c0e87bfb6bd374a40cca04a1"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#ad8573d09c0e87bfb6bd374a40cca04a1">ATTENUATION_INCREMENT</a></div><div class="ttdeci">#define ATTENUATION_INCREMENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00058">plc.c:58</a></div></div>
<div class="ttc" id="structplc__state__t_html_a05c8b22d2905f7a52fa31b13f85c70f3"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#a05c8b22d2905f7a52fa31b13f85c70f3">plc_state_t::pitch</a></div><div class="ttdeci">int pitch</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00112">plc.h:112</a></div></div>
<div class="ttc" id="plc_8c_html_a8b07df006c820a75859ea4c3fb35c82b"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#a8b07df006c820a75859ea4c3fb35c82b">fsaturate</a></div><div class="ttdeci">static int16_t fsaturate(double damp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00062">plc.c:62</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structplc__state__t_html_ac36f43f35737e608c560f4c855fc0e36"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#ac36f43f35737e608c560f4c855fc0e36">plc_state_t::missing_samples</a></div><div class="ttdeci">int missing_samples</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00108">plc.h:108</a></div></div>
<div class="ttc" id="plc_8c_html_aa943632c836baf9550bb39d57345cb20"><div class="ttname"><a href="../../d7/d1f/plc_8c.html#aa943632c836baf9550bb39d57345cb20">save_history</a></div><div class="ttdeci">static void save_history(plc_state_t *s, int16_t *buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d1f/plc_8c_source.html#l00071">plc.c:71</a></div></div>
<div class="ttc" id="structplc__state__t_html_a0378b3d37277e2f8933570490909075d"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#a0378b3d37277e2f8933570490909075d">plc_state_t::pitch_offset</a></div><div class="ttdeci">int pitch_offset</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00110">plc.h:110</a></div></div>
<div class="ttc" id="structplc__state__t_html_a440aa050931ba2f079f06650c47bbccf"><div class="ttname"><a href="../../d8/dc7/structplc__state__t.html#a440aa050931ba2f079f06650c47bbccf">plc_state_t::pitchbuf</a></div><div class="ttdeci">float pitchbuf[PLC_PITCH_MIN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d66/plc_8h_source.html#l00114">plc.h:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:16 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
