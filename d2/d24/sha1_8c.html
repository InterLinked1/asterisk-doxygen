<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: sha1.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">sha1.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Based on the RFC 6234.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="../../db/db5/sha1_8h_source.html">asterisk/sha1.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for sha1.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/db5/sha1_8c__incl.png" border="0" usemap="#sha1_8c" alt=""/></div>
<map name="sha1_8c" id="sha1_8c">
<area shape="rect" id="node2" href="../../db/db5/sha1_8h.html" title="asterisk/sha1.h" alt="" coords="5,80,124,107"/>
</map>
</div>
</div>
<p><a href="../../d2/d24/sha1_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2a218f0f24d480637792f1730d466656"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(bits,  <a class="el" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>)&#160;&#160;&#160;(((<a class="el" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>) &lt;&lt; (bits)) | ((<a class="el" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>) &gt;&gt; (32-(bits))))</td></tr>
<tr class="separator:a2a218f0f24d480637792f1730d466656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae077f52e29523283028ca096df33ce5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#aae077f52e29523283028ca096df33ce5">SHA1AddLength</a>(<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>,  length)</td></tr>
<tr class="separator:aae077f52e29523283028ca096df33ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aff8578feae521361e1370886af1fa7d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#aff8578feae521361e1370886af1fa7d1">SHA1FinalBits</a> (<a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, uint8_t message_bits, unsigned int length)</td></tr>
<tr class="memdesc:aff8578feae521361e1370886af1fa7d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">SHA1FinalBits Add in any final bits of the message.  <a href="#aff8578feae521361e1370886af1fa7d1">More...</a><br /></td></tr>
<tr class="separator:aff8578feae521361e1370886af1fa7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc46b458e10214625d95d68537d489e4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#afc46b458e10214625d95d68537d489e4">SHA1Finalize</a> (<a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, uint8_t Pad_Byte)</td></tr>
<tr class="memdesc:afc46b458e10214625d95d68537d489e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This helper function finishes off the digest calculations.  <a href="#afc46b458e10214625d95d68537d489e4">More...</a><br /></td></tr>
<tr class="separator:afc46b458e10214625d95d68537d489e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae358bb01d0881df37ef769326330a761"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#ae358bb01d0881df37ef769326330a761">SHA1Input</a> (<a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, const uint8_t *message_array, unsigned length)</td></tr>
<tr class="memdesc:ae358bb01d0881df37ef769326330a761"><td class="mdescLeft">&#160;</td><td class="mdescRight">SHA1Input.  <a href="#ae358bb01d0881df37ef769326330a761">More...</a><br /></td></tr>
<tr class="separator:ae358bb01d0881df37ef769326330a761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d4f2cd87044d3aacaafffefcdace04d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#a1d4f2cd87044d3aacaafffefcdace04d">SHA1PadMessage</a> (<a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, uint8_t Pad_Byte)</td></tr>
<tr class="memdesc:a1d4f2cd87044d3aacaafffefcdace04d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pad message to be 512 bits.  <a href="#a1d4f2cd87044d3aacaafffefcdace04d">More...</a><br /></td></tr>
<tr class="separator:a1d4f2cd87044d3aacaafffefcdace04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecdc932b525fe4d4eb6b3235e9275862"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#aecdc932b525fe4d4eb6b3235e9275862">SHA1ProcessMessageBlock</a> (<a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>)</td></tr>
<tr class="memdesc:aecdc932b525fe4d4eb6b3235e9275862"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the next 512 bits of the message stored in the Message_Block array.  <a href="#aecdc932b525fe4d4eb6b3235e9275862">More...</a><br /></td></tr>
<tr class="separator:aecdc932b525fe4d4eb6b3235e9275862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8140c03de580a1bec25826b04eabe453"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#a8140c03de580a1bec25826b04eabe453">SHA1Reset</a> (<a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>)</td></tr>
<tr class="memdesc:a8140c03de580a1bec25826b04eabe453"><td class="mdescLeft">&#160;</td><td class="mdescRight">SHA1Reset.  <a href="#a8140c03de580a1bec25826b04eabe453">More...</a><br /></td></tr>
<tr class="separator:a8140c03de580a1bec25826b04eabe453"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af362e783958b7070097b58f0372687a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#af362e783958b7070097b58f0372687a9">SHA1Result</a> (<a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *<a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, uint8_t Message_Digest[<a class="el" href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754ae6b440886f3edd40e1854e8bb5406835">SHA1HashSize</a>])</td></tr>
<tr class="separator:af362e783958b7070097b58f0372687a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:aa21a4fea0abf9fdab225facc9d1c8d81"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d24/sha1_8c.html#aa21a4fea0abf9fdab225facc9d1c8d81">addTemp</a></td></tr>
<tr class="separator:aa21a4fea0abf9fdab225facc9d1c8d81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Based on the RFC 6234. </p>
<p>Copyright (c) 2011 IETF Trust and the persons identified as authors of the code. All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p>
<ul>
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of Internet Society, IETF or IETF Trust, nor the names of specific contributors, may be used to endorse or promote products derived from this software without specific prior written permission.</li>
</ul>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>Description: This file implements the Secure Hash Algorithm SHA-1 as defined in the U.S. National Institute of Standards and Technology Federal Information Processing Standards Publication (FIPS PUB) 180-3 published in October 2008 and formerly defined in its predecessors, FIPS PUB 180-1 and FIP PUB 180-2.</p>
<p>A combined document showing all algorithms is available at <a href="http://csrc.nist.gov/publications/fips/">http://csrc.nist.gov/publications/fips/</a> fips180-3/fips180-3_final.pdf</p>
<p>The SHA-1 algorithm produces a 160-bit message digest for a given data stream that can serve as a means of providing a "fingerprint" for a message.</p>
<p>Portability Issues: SHA-1 is defined in terms of 32-bit "words". This code uses &lt;stdint.h&gt; (included via "sha.h") to define 32- and 8-bit unsigned integer types. If your C compiler does not support 32-bit unsigned integers, this code is not appropriate.</p>
<p>Caveats: SHA-1 is designed to work with messages less than 2^64 bits long. This implementation uses <a class="el" href="../../d2/d24/sha1_8c.html#ae358bb01d0881df37ef769326330a761" title="SHA1Input. ">SHA1Input()</a> to hash the bits that are a multiple of the size of an 8-bit octet, and then optionally uses <a class="el" href="../../d2/d24/sha1_8c.html#aff8578feae521361e1370886af1fa7d1" title="SHA1FinalBits Add in any final bits of the message. ">SHA1FinalBits()</a> to hash the final few bits of the input. </p>

<p class="definition">Definition in file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a2a218f0f24d480637792f1730d466656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a218f0f24d480637792f1730d466656">&#9670;&nbsp;</a></span>SHA1_ROTL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHA1_ROTL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bits, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(((<a class="el" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>) &lt;&lt; (bits)) | ((<a class="el" href="../../d6/da0/codecs_2gsm_2inc_2private_8h.html#a0b023cbb2bf7d034c2269d58d7455ac8">word</a>) &gt;&gt; (32-(bits))))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define the SHA1 circular left shift macro </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00074">74</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d24/sha1_8c_source.html#l00260">SHA1ProcessMessageBlock()</a>.</p>

</div>
</div>
<a id="aae077f52e29523283028ca096df33ce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae077f52e29523283028ca096df33ce5">&#9670;&nbsp;</a></span>SHA1AddLength</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHA1AddLength</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../da/dde/chan__phone_8c.html#a579ca8125bbf48d9ce8691d522f99933">context</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">length&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(<a class="code" href="../../d2/d24/sha1_8c.html#aa21a4fea0abf9fdab225facc9d1c8d81">addTemp</a> = (<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>)-&gt;Length_Low,                      \</div><div class="line">     (<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>)-&gt;Corrupted =                                \</div><div class="line">        (((<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>)-&gt;Length_Low += (length)) &lt; <a class="code" href="../../d2/d24/sha1_8c.html#aa21a4fea0abf9fdab225facc9d1c8d81">addTemp</a>) &amp;&amp; \</div><div class="line">        (++(<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>)-&gt;Length_High == 0) ? <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea383493bb8927060f349e11f915cbb636">shaInputTooLong</a>  \</div><div class="line">                                        : (<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>)-&gt;Corrupted )</div><div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4ea383493bb8927060f349e11f915cbb636"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea383493bb8927060f349e11f915cbb636">shaInputTooLong</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00094">sha1.h:94</a></div></div>
<div class="ttc" id="sha1_8c_html_aa21a4fea0abf9fdab225facc9d1c8d81"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#aa21a4fea0abf9fdab225facc9d1c8d81">addTemp</a></div><div class="ttdeci">static uint32_t addTemp</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00081">sha1.c:81</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00082">82</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d24/sha1_8c_source.html#l00179">SHA1FinalBits()</a>, and <a class="el" href="../../d2/d24/sha1_8c_source.html#l00133">SHA1Input()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aff8578feae521361e1370886af1fa7d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff8578feae521361e1370886af1fa7d1">&#9670;&nbsp;</a></span>SHA1FinalBits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SHA1FinalBits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>message_bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SHA1FinalBits Add in any final bits of the message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>[in/out] The SHA context to update. </td></tr>
    <tr><td class="paramname">message_bits</td><td>[in] The final bits of the message, in the upper portion of the byte. (Use 0b###00000 instead of 0b00000### to input the three bits ###.) </td></tr>
    <tr><td class="paramname">length</td><td>[in] * The number of bits in message_bits, between 1 and 7. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sha Error Code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00179">179</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db5/sha1_8h_source.html#l00139">SHA1Context::Computed</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00140">SHA1Context::Corrupted</a>, <a class="el" href="../../d2/d24/sha1_8c_source.html#l00082">SHA1AddLength</a>, <a class="el" href="../../d2/d24/sha1_8c_source.html#l00346">SHA1Finalize()</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00096">shaBadParam</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00093">shaNull</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00095">shaStateError</a>, and <a class="el" href="../../db/db5/sha1_8h_source.html#l00092">shaSuccess</a>.</p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   <span class="keyword">static</span> uint8_t masks[8] = {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="comment">/* 0 0b00000000 */</span> 0x00, <span class="comment">/* 1 0b10000000 */</span> 0x80,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">/* 2 0b11000000 */</span> 0xC0, <span class="comment">/* 3 0b11100000 */</span> 0xE0,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="comment">/* 4 0b11110000 */</span> 0xF0, <span class="comment">/* 5 0b11111000 */</span> 0xF8,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="comment">/* 6 0b11111100 */</span> 0xFC, <span class="comment">/* 7 0b11111110 */</span> 0xFE</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   };</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <span class="keyword">static</span> uint8_t markbit[8] = {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">/* 0 0b10000000 */</span> 0x80, <span class="comment">/* 1 0b01000000 */</span> 0x40,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">/* 2 0b00100000 */</span> 0x20, <span class="comment">/* 3 0b00010000 */</span> 0x10,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="comment">/* 4 0b00001000 */</span> 0x08, <span class="comment">/* 5 0b00000100 */</span> 0x04,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="comment">/* 6 0b00000010 */</span> 0x02, <span class="comment">/* 7 0b00000001 */</span> 0x01</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   };</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keywordflow">if</span> (!context)</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keywordflow">if</span> (!length)</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">return</span> context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a>)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keywordflow">return</span> context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a> = <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eaf95bed729cc00460585fb8d76f0c384d">shaStateError</a>;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="keywordflow">if</span> (length &gt;= 8)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">return</span> context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a> = <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eab338542dac4fd7886c1bcbdfcb58db50">shaBadParam</a>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <a class="code" href="../../d2/d24/sha1_8c.html#aae077f52e29523283028ca096df33ce5">SHA1AddLength</a>(context, length);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   <a class="code" href="../../d2/d24/sha1_8c.html#afc46b458e10214625d95d68537d489e4">SHA1Finalize</a>(context,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;             (uint8_t) ((message_bits &amp; masks[length]) |</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                     markbit[length]));</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="keywordflow">return</span> context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div><div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00093">sha1.h:93</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4eaf95bed729cc00460585fb8d76f0c384d"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eaf95bed729cc00460585fb8d76f0c384d">shaStateError</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00095">sha1.h:95</a></div></div>
<div class="ttc" id="structSHA1Context_html_a4bc60740c300c7929a676f997d9484a9"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">SHA1Context::Corrupted</a></div><div class="ttdeci">int Corrupted</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00140">sha1.h:140</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00092">sha1.h:92</a></div></div>
<div class="ttc" id="sha1_8c_html_aae077f52e29523283028ca096df33ce5"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#aae077f52e29523283028ca096df33ce5">SHA1AddLength</a></div><div class="ttdeci">#define SHA1AddLength(context, length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00082">sha1.c:82</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4eab338542dac4fd7886c1bcbdfcb58db50"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eab338542dac4fd7886c1bcbdfcb58db50">shaBadParam</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00096">sha1.h:96</a></div></div>
<div class="ttc" id="sha1_8c_html_afc46b458e10214625d95d68537d489e4"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#afc46b458e10214625d95d68537d489e4">SHA1Finalize</a></div><div class="ttdeci">static void SHA1Finalize(SHA1Context *context, uint8_t Pad_Byte)</div><div class="ttdoc">This helper function finishes off the digest calculations. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00346">sha1.c:346</a></div></div>
<div class="ttc" id="structSHA1Context_html_aeb5a7a168bb512db53299543094702aa"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">SHA1Context::Computed</a></div><div class="ttdeci">int Computed</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00139">sha1.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc46b458e10214625d95d68537d489e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc46b458e10214625d95d68537d489e4">&#9670;&nbsp;</a></span>SHA1Finalize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void SHA1Finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>Pad_Byte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This helper function finishes off the digest calculations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>[in/out] The context to pad. </td></tr>
    <tr><td class="paramname">Pad_Byte</td><td>[in] The last byte to add to the message block before the 0-padding and length. This will contain the last bits of the message followed by another single bit. If the message was an exact multiple of 8-bits long, Pad_Byte will be 0x80. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sha Error Code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00346">346</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db5/sha1_8h_source.html#l00139">SHA1Context::Computed</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00132">SHA1Context::Length_High</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00133">SHA1Context::Length_Low</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00137">SHA1Context::Message_Block</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00105">SHA1_Message_Block_Size</a>, and <a class="el" href="../../d2/d24/sha1_8c_source.html#l00374">SHA1PadMessage()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d24/sha1_8c_source.html#l00179">SHA1FinalBits()</a>, and <a class="el" href="../../d2/d24/sha1_8c_source.html#l00226">SHA1Result()</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <a class="code" href="../../d2/d24/sha1_8c.html#a1d4f2cd87044d3aacaafffefcdace04d">SHA1PadMessage</a>(context, Pad_Byte);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <span class="comment">/* message may be sensitive, clear it out */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a>; ++i) {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[i] = 0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a> = 0;  <span class="comment">/* and clear length */</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> = 0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a> = 1;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="ttc" id="sha1_8h_html_a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60"><div class="ttname"><a href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00105">sha1.h:105</a></div></div>
<div class="ttc" id="sha1_8c_html_a1d4f2cd87044d3aacaafffefcdace04d"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#a1d4f2cd87044d3aacaafffefcdace04d">SHA1PadMessage</a></div><div class="ttdeci">static void SHA1PadMessage(SHA1Context *context, uint8_t Pad_Byte)</div><div class="ttdoc">Pad message to be 512 bits. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00374">sha1.c:374</a></div></div>
<div class="ttc" id="structSHA1Context_html_a188eef03938236a9a58c9382166aa002"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">SHA1Context::Length_Low</a></div><div class="ttdeci">uint32_t Length_Low</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00133">sha1.h:133</a></div></div>
<div class="ttc" id="structSHA1Context_html_a0b2c571bb062a1c913412115d687b192"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">SHA1Context::Message_Block</a></div><div class="ttdeci">uint8_t Message_Block[SHA1_Message_Block_Size]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00137">sha1.h:137</a></div></div>
<div class="ttc" id="structSHA1Context_html_a73f82f23d8acae6d67b249511811d654"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">SHA1Context::Length_High</a></div><div class="ttdeci">uint32_t Length_High</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00132">sha1.h:132</a></div></div>
<div class="ttc" id="structSHA1Context_html_aeb5a7a168bb512db53299543094702aa"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">SHA1Context::Computed</a></div><div class="ttdeci">int Computed</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00139">sha1.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae358bb01d0881df37ef769326330a761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae358bb01d0881df37ef769326330a761">&#9670;&nbsp;</a></span>SHA1Input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SHA1Input </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>message_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SHA1Input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>[in/out] The SHA context to update </td></tr>
    <tr><td class="paramname">message_array</td><td>[in] An array of characters representing the next portion of the message. </td></tr>
    <tr><td class="paramname">length</td><td>[in] The length of the message in message_array. This function accepts an array of octets as the next portion of the message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sha Error Code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00133">133</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db5/sha1_8h_source.html#l00139">SHA1Context::Computed</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00140">SHA1Context::Corrupted</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00137">SHA1Context::Message_Block</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00135">SHA1Context::Message_Block_Index</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00105">SHA1_Message_Block_Size</a>, <a class="el" href="../../d2/d24/sha1_8c_source.html#l00082">SHA1AddLength</a>, <a class="el" href="../../d2/d24/sha1_8c_source.html#l00260">SHA1ProcessMessageBlock()</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00093">shaNull</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00095">shaStateError</a>, and <a class="el" href="../../db/db5/sha1_8h_source.html#l00092">shaSuccess</a>.</p>
<div class="fragment"><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   <span class="keywordflow">if</span> (!context) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keywordflow">if</span> (!length) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <span class="keywordflow">if</span> (!message_array) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a>) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a> = <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eaf95bed729cc00460585fb8d76f0c384d">shaStateError</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eaf95bed729cc00460585fb8d76f0c384d">shaStateError</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keywordflow">return</span> context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="keywordflow">while</span> (length--) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a>++] =</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;         *message_array;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d24/sha1_8c.html#aae077f52e29523283028ca096df33ce5">SHA1AddLength</a>(context, 8) == <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>) &amp;&amp;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a> == <a class="code" href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a>))</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;         <a class="code" href="../../d2/d24/sha1_8c.html#aecdc932b525fe4d4eb6b3235e9275862">SHA1ProcessMessageBlock</a>(context);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      message_array++;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="keywordflow">return</span> context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div><div class="ttc" id="sha1_8h_html_a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60"><div class="ttname"><a href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00105">sha1.h:105</a></div></div>
<div class="ttc" id="sha1_8c_html_aecdc932b525fe4d4eb6b3235e9275862"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#aecdc932b525fe4d4eb6b3235e9275862">SHA1ProcessMessageBlock</a></div><div class="ttdeci">static void SHA1ProcessMessageBlock(SHA1Context *context)</div><div class="ttdoc">Process the next 512 bits of the message stored in the Message_Block array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00260">sha1.c:260</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00093">sha1.h:93</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4eaf95bed729cc00460585fb8d76f0c384d"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eaf95bed729cc00460585fb8d76f0c384d">shaStateError</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00095">sha1.h:95</a></div></div>
<div class="ttc" id="structSHA1Context_html_a4bc60740c300c7929a676f997d9484a9"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">SHA1Context::Corrupted</a></div><div class="ttdeci">int Corrupted</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00140">sha1.h:140</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00092">sha1.h:92</a></div></div>
<div class="ttc" id="structSHA1Context_html_ad7bf01bcc0244679564a37f2c25ffc8c"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">SHA1Context::Message_Block_Index</a></div><div class="ttdeci">int_least16_t Message_Block_Index</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00135">sha1.h:135</a></div></div>
<div class="ttc" id="sha1_8c_html_aae077f52e29523283028ca096df33ce5"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#aae077f52e29523283028ca096df33ce5">SHA1AddLength</a></div><div class="ttdeci">#define SHA1AddLength(context, length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00082">sha1.c:82</a></div></div>
<div class="ttc" id="structSHA1Context_html_a0b2c571bb062a1c913412115d687b192"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">SHA1Context::Message_Block</a></div><div class="ttdeci">uint8_t Message_Block[SHA1_Message_Block_Size]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00137">sha1.h:137</a></div></div>
<div class="ttc" id="structSHA1Context_html_aeb5a7a168bb512db53299543094702aa"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">SHA1Context::Computed</a></div><div class="ttdeci">int Computed</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00139">sha1.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d4f2cd87044d3aacaafffefcdace04d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d4f2cd87044d3aacaafffefcdace04d">&#9670;&nbsp;</a></span>SHA1PadMessage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void SHA1PadMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>Pad_Byte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pad message to be 512 bits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>[in/out] The context to pad. </td></tr>
    <tr><td class="paramname">Pad_Byte</td><td>[in] Last padding byte.</td></tr>
  </table>
  </dd>
</dl>
<p>According to the standard, the message must be padded to the next even multiple of 512 bits. The first padding bit must be a '1'. The last 64 bits represent the length of the original message. All bits in between should be 0. This helper function will pad the message according to those rules by filling the Message_Block array accordingly. When it returns, it can be assumed that the message digest has been computed.</p>
<dl class="section return"><dt>Returns</dt><dd>nothing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00374">374</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db5/sha1_8h_source.html#l00132">SHA1Context::Length_High</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00133">SHA1Context::Length_Low</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00137">SHA1Context::Message_Block</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00135">SHA1Context::Message_Block_Index</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00105">SHA1_Message_Block_Size</a>, and <a class="el" href="../../d2/d24/sha1_8c_source.html#l00260">SHA1ProcessMessageBlock()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d24/sha1_8c_source.html#l00346">SHA1Finalize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">    *  Check to see if the current message block is too small to hold</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">    *  the initial padding bits and length.  If so, we will pad the</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">    *  block, process it, and then continue padding into a second</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">    *  block.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a> &gt;= (<a class="code" href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a> - 8)) {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a>++] = Pad_Byte;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">while</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a> &lt; <a class="code" href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a>) {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;         context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a>++] = 0;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="../../d2/d24/sha1_8c.html#aecdc932b525fe4d4eb6b3235e9275862">SHA1ProcessMessageBlock</a>(context);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   } <span class="keywordflow">else</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a>++] = Pad_Byte;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <span class="keywordflow">while</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a> &lt; (<a class="code" href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a> - 8)) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a>++] = 0;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">    *  Store the message length as the last 8 octets</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[56] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a> &gt;&gt; 24);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[57] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a> &gt;&gt; 16);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[58] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a> &gt;&gt; 8);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[59] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[60] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> &gt;&gt; 24);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[61] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> &gt;&gt; 16);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[62] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> &gt;&gt; 8);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[63] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a>);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <a class="code" href="../../d2/d24/sha1_8c.html#aecdc932b525fe4d4eb6b3235e9275862">SHA1ProcessMessageBlock</a>(context);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div><div class="ttc" id="sha1_8h_html_a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60"><div class="ttname"><a href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754a394854ff4f1518f8a047ea885d7d4f60">SHA1_Message_Block_Size</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00105">sha1.h:105</a></div></div>
<div class="ttc" id="sha1_8c_html_aecdc932b525fe4d4eb6b3235e9275862"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#aecdc932b525fe4d4eb6b3235e9275862">SHA1ProcessMessageBlock</a></div><div class="ttdeci">static void SHA1ProcessMessageBlock(SHA1Context *context)</div><div class="ttdoc">Process the next 512 bits of the message stored in the Message_Block array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00260">sha1.c:260</a></div></div>
<div class="ttc" id="structSHA1Context_html_ad7bf01bcc0244679564a37f2c25ffc8c"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">SHA1Context::Message_Block_Index</a></div><div class="ttdeci">int_least16_t Message_Block_Index</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00135">sha1.h:135</a></div></div>
<div class="ttc" id="structSHA1Context_html_a188eef03938236a9a58c9382166aa002"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">SHA1Context::Length_Low</a></div><div class="ttdeci">uint32_t Length_Low</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00133">sha1.h:133</a></div></div>
<div class="ttc" id="structSHA1Context_html_a0b2c571bb062a1c913412115d687b192"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">SHA1Context::Message_Block</a></div><div class="ttdeci">uint8_t Message_Block[SHA1_Message_Block_Size]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00137">sha1.h:137</a></div></div>
<div class="ttc" id="structSHA1Context_html_a73f82f23d8acae6d67b249511811d654"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">SHA1Context::Length_High</a></div><div class="ttdeci">uint32_t Length_High</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00132">sha1.h:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aecdc932b525fe4d4eb6b3235e9275862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecdc932b525fe4d4eb6b3235e9275862">&#9670;&nbsp;</a></span>SHA1ProcessMessageBlock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void SHA1ProcessMessageBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the next 512 bits of the message stored in the Message_Block array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>[in/out] The SHA context to update </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Many of the variable names in this code, especially the single character names, were used because those were the names used in the publication. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>nothing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00260">260</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db5/sha1_8h_source.html#l00130">SHA1Context::Intermediate_Hash</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00137">SHA1Context::Message_Block</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00135">SHA1Context::Message_Block_Index</a>, <a class="el" href="../../d2/d24/sha1_8c_source.html#l00074">SHA1_ROTL</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00365">SHA_Ch</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00366">SHA_Maj</a>, and <a class="el" href="../../db/db5/sha1_8h_source.html#l00377">SHA_Parity</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d24/sha1_8c_source.html#l00133">SHA1Input()</a>, and <a class="el" href="../../d2/d24/sha1_8c_source.html#l00374">SHA1PadMessage()</a>.</p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <span class="comment">/* Constants defined in FIPS 180-3, section 4.2.1 */</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <span class="keyword">const</span> uint32_t K[4] = {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      0x5A827999, 0x6ED9EBA1, 0x8F1BBCDC, 0xCA62C1D6</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   };</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <span class="keywordtype">int</span> t;                  <span class="comment">/* Loop counter */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   uint32_t temp;          <span class="comment">/* Temporary word value */</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   uint32_t W[80];            <span class="comment">/* Word sequence */</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   uint32_t A, B, C, D, E;    <span class="comment">/* Word buffers */</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">    * Initialize the first 16 words in the array W</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="keywordflow">for</span> (t = 0; t &lt; 16; t++) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      W[t] = ((uint32_t) context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[t * 4]) &lt;&lt; 24;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      W[t] |= ((uint32_t) context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[t * 4 + 1]) &lt;&lt; 16;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      W[t] |= ((uint32_t) context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[t * 4 + 2]) &lt;&lt; 8;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      W[t] |= ((uint32_t) context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">Message_Block</a>[t * 4 + 3]);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   <span class="keywordflow">for</span> (t = 16; t &lt; 80; t++) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      W[t] = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(1, W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16]);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   A = context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[0];</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   B = context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[1];</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   C = context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[2];</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   D = context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[3];</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   E = context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[4];</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordflow">for</span> (t = 0; t &lt; 20; t++) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      temp = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(5, A) + <a class="code" href="../../db/db5/sha1_8h.html#a6aad1464e4cf4e57f0e2551558f0d783">SHA_Ch</a>(B, C, D) + E + W[t] + K[0];</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      E = D;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      D = C;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      C = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(30, B);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      B = A;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      A = temp;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordflow">for</span> (t = 20; t &lt; 40; t++) {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      temp = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(5, A) + <a class="code" href="../../db/db5/sha1_8h.html#af5541766ecc62b9cb5598ef22f46af2e">SHA_Parity</a>(B, C, D) + E + W[t] + K[1];</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      E = D;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      D = C;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      C = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(30, B);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      B = A;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      A = temp;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordflow">for</span> (t = 40; t &lt; 60; t++) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      temp = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(5, A) + <a class="code" href="../../db/db5/sha1_8h.html#a34c488411532e284913ae6c4ac5c1e75">SHA_Maj</a>(B, C, D) + E + W[t] + K[2];</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      E = D;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      D = C;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      C = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(30, B);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      B = A;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      A = temp;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keywordflow">for</span> (t = 60; t &lt; 80; t++) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      temp = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(5, A) + <a class="code" href="../../db/db5/sha1_8h.html#af5541766ecc62b9cb5598ef22f46af2e">SHA_Parity</a>(B, C, D) + E + W[t] + K[3];</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      E = D;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      D = C;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      C = <a class="code" href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a>(30, B);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      B = A;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      A = temp;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[0] += A;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[1] += B;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[2] += C;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[3] += D;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[4] += E;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a> = 0;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div><div class="ttc" id="structSHA1Context_html_a07326db4ee05a657762a33bfddc58dc1"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">SHA1Context::Intermediate_Hash</a></div><div class="ttdeci">uint32_t Intermediate_Hash[SHA1HashSize/4]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00130">sha1.h:130</a></div></div>
<div class="ttc" id="structSHA1Context_html_ad7bf01bcc0244679564a37f2c25ffc8c"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">SHA1Context::Message_Block_Index</a></div><div class="ttdeci">int_least16_t Message_Block_Index</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00135">sha1.h:135</a></div></div>
<div class="ttc" id="sha1_8c_html_a2a218f0f24d480637792f1730d466656"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#a2a218f0f24d480637792f1730d466656">SHA1_ROTL</a></div><div class="ttdeci">#define SHA1_ROTL(bits, word)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00074">sha1.c:74</a></div></div>
<div class="ttc" id="sha1_8h_html_a34c488411532e284913ae6c4ac5c1e75"><div class="ttname"><a href="../../db/db5/sha1_8h.html#a34c488411532e284913ae6c4ac5c1e75">SHA_Maj</a></div><div class="ttdeci">#define SHA_Maj(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00366">sha1.h:366</a></div></div>
<div class="ttc" id="structSHA1Context_html_a0b2c571bb062a1c913412115d687b192"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a0b2c571bb062a1c913412115d687b192">SHA1Context::Message_Block</a></div><div class="ttdeci">uint8_t Message_Block[SHA1_Message_Block_Size]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00137">sha1.h:137</a></div></div>
<div class="ttc" id="sha1_8h_html_af5541766ecc62b9cb5598ef22f46af2e"><div class="ttname"><a href="../../db/db5/sha1_8h.html#af5541766ecc62b9cb5598ef22f46af2e">SHA_Parity</a></div><div class="ttdeci">#define SHA_Parity(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00377">sha1.h:377</a></div></div>
<div class="ttc" id="sha1_8h_html_a6aad1464e4cf4e57f0e2551558f0d783"><div class="ttname"><a href="../../db/db5/sha1_8h.html#a6aad1464e4cf4e57f0e2551558f0d783">SHA_Ch</a></div><div class="ttdeci">#define SHA_Ch(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00365">sha1.h:365</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8140c03de580a1bec25826b04eabe453"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8140c03de580a1bec25826b04eabe453">&#9670;&nbsp;</a></span>SHA1Reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SHA1Reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SHA1Reset. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>the context to be reset. This function will initialize the <a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> in preparation for computing a new SHA1 message digest. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sha Error Code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00101">101</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db5/sha1_8h_source.html#l00139">SHA1Context::Computed</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00140">SHA1Context::Corrupted</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00130">SHA1Context::Intermediate_Hash</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00132">SHA1Context::Length_High</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00133">SHA1Context::Length_Low</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00135">SHA1Context::Message_Block_Index</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00093">shaNull</a>, and <a class="el" href="../../db/db5/sha1_8h_source.html#l00092">shaSuccess</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l00264">ast_sha1_hash()</a>, and <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l00282">ast_sha1_hash_uint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">if</span> (!context) {</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">Length_High</a> = context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">Length_Low</a> = 0;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">Message_Block_Index</a> = 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="comment">/* Initial Hash Values: FIPS 180-3 section 5.3.1 */</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[0] = 0x67452301;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[1] = 0xEFCDAB89;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[2] = 0x98BADCFE;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[3] = 0x10325476;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[4] = 0xC3D2E1F0;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a> = 0;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a> = <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div><div class="ttc" id="structSHA1Context_html_a07326db4ee05a657762a33bfddc58dc1"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">SHA1Context::Intermediate_Hash</a></div><div class="ttdeci">uint32_t Intermediate_Hash[SHA1HashSize/4]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00130">sha1.h:130</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00093">sha1.h:93</a></div></div>
<div class="ttc" id="structSHA1Context_html_a4bc60740c300c7929a676f997d9484a9"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">SHA1Context::Corrupted</a></div><div class="ttdeci">int Corrupted</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00140">sha1.h:140</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00092">sha1.h:92</a></div></div>
<div class="ttc" id="structSHA1Context_html_ad7bf01bcc0244679564a37f2c25ffc8c"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#ad7bf01bcc0244679564a37f2c25ffc8c">SHA1Context::Message_Block_Index</a></div><div class="ttdeci">int_least16_t Message_Block_Index</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00135">sha1.h:135</a></div></div>
<div class="ttc" id="structSHA1Context_html_a188eef03938236a9a58c9382166aa002"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a188eef03938236a9a58c9382166aa002">SHA1Context::Length_Low</a></div><div class="ttdeci">uint32_t Length_Low</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00133">sha1.h:133</a></div></div>
<div class="ttc" id="structSHA1Context_html_a73f82f23d8acae6d67b249511811d654"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a73f82f23d8acae6d67b249511811d654">SHA1Context::Length_High</a></div><div class="ttdeci">uint32_t Length_High</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00132">sha1.h:132</a></div></div>
<div class="ttc" id="structSHA1Context_html_aeb5a7a168bb512db53299543094702aa"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">SHA1Context::Computed</a></div><div class="ttdeci">int Computed</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00139">sha1.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af362e783958b7070097b58f0372687a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af362e783958b7070097b58f0372687a9">&#9670;&nbsp;</a></span>SHA1Result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int SHA1Result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/d8e/structSHA1Context.html">SHA1Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>Message_Digest</em>[SHA1HashSize]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00226">226</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/db5/sha1_8h_source.html#l00139">SHA1Context::Computed</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00140">SHA1Context::Corrupted</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00130">SHA1Context::Intermediate_Hash</a>, <a class="el" href="../../d2/d24/sha1_8c_source.html#l00346">SHA1Finalize()</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00109">SHA1HashSize</a>, <a class="el" href="../../db/db5/sha1_8h_source.html#l00093">shaNull</a>, and <a class="el" href="../../db/db5/sha1_8h_source.html#l00092">shaSuccess</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l00264">ast_sha1_hash()</a>, and <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l00282">ast_sha1_hash_uint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keywordflow">if</span> (!context) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   <span class="keywordflow">if</span> (!Message_Digest) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;   <span class="keywordflow">if</span> (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>) {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">return</span> context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">Corrupted</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keywordflow">if</span> (!context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">Computed</a>) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="../../d2/d24/sha1_8c.html#afc46b458e10214625d95d68537d489e4">SHA1Finalize</a>(context, 0x80);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754ae6b440886f3edd40e1854e8bb5406835">SHA1HashSize</a>; ++i) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      Message_Digest[i] = (uint8_t) (context-&gt;<a class="code" href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">Intermediate_Hash</a>[i &gt;&gt; 2]</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            &gt;&gt; (8 * (3 - (i &amp; 0x03))));</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div><div class="ttc" id="structSHA1Context_html_a07326db4ee05a657762a33bfddc58dc1"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a07326db4ee05a657762a33bfddc58dc1">SHA1Context::Intermediate_Hash</a></div><div class="ttdeci">uint32_t Intermediate_Hash[SHA1HashSize/4]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00130">sha1.h:130</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4eae801efd0a808fb77467a5bdf8ad5ee70">shaNull</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00093">sha1.h:93</a></div></div>
<div class="ttc" id="structSHA1Context_html_a4bc60740c300c7929a676f997d9484a9"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#a4bc60740c300c7929a676f997d9484a9">SHA1Context::Corrupted</a></div><div class="ttdeci">int Corrupted</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00140">sha1.h:140</a></div></div>
<div class="ttc" id="sha1_8h_html_affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa"><div class="ttname"><a href="../../db/db5/sha1_8h.html#affeecfb4b0548596bafa671799ea3f4ea581d05c0e86b0ca3a00c6e24ea81b3fa">shaSuccess</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00092">sha1.h:92</a></div></div>
<div class="ttc" id="sha1_8h_html_a79b731fd4cfe419a4f26fdd5f3d12754ae6b440886f3edd40e1854e8bb5406835"><div class="ttname"><a href="../../db/db5/sha1_8h.html#a79b731fd4cfe419a4f26fdd5f3d12754ae6b440886f3edd40e1854e8bb5406835">SHA1HashSize</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00109">sha1.h:109</a></div></div>
<div class="ttc" id="sha1_8c_html_afc46b458e10214625d95d68537d489e4"><div class="ttname"><a href="../../d2/d24/sha1_8c.html#afc46b458e10214625d95d68537d489e4">SHA1Finalize</a></div><div class="ttdeci">static void SHA1Finalize(SHA1Context *context, uint8_t Pad_Byte)</div><div class="ttdoc">This helper function finishes off the digest calculations. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/sha1_8c_source.html#l00346">sha1.c:346</a></div></div>
<div class="ttc" id="structSHA1Context_html_aeb5a7a168bb512db53299543094702aa"><div class="ttname"><a href="../../d5/d8e/structSHA1Context.html#aeb5a7a168bb512db53299543094702aa">SHA1Context::Computed</a></div><div class="ttdeci">int Computed</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db5/sha1_8h_source.html#l00139">sha1.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa21a4fea0abf9fdab225facc9d1c8d81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21a4fea0abf9fdab225facc9d1c8d81">&#9670;&nbsp;</a></span>addTemp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t addTemp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d24/sha1_8c_source.html#l00081">81</a> of file <a class="el" href="../../d2/d24/sha1_8c_source.html">sha1.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:46 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
