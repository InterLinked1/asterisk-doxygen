<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: stasis_message_router.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">stasis_message_router.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Stasis message router implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d25/stasis__message__router_8h_source.html">asterisk/stasis_message_router.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d68/vector_8h_source.html">asterisk/vector.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for stasis_message_router.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/dc6/stasis__message__router_8c__incl.png" border="0" usemap="#stasis__message__router_8c" alt=""/></div>
<map name="stasis__message__router_8c" id="stasis__message__router_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="435,244,519,271"/>
<area shape="rect" id="node22" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1825,169,1959,196"/>
<area shape="rect" id="node32" href="../../d4/d25/stasis__message__router_8h.html" title="asterisk/stasis_message\l_router.h" alt="" coords="1393,80,1572,121"/>
<area shape="rect" id="node38" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="1666,87,1793,114"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="5,468,160,495"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="798,319,935,345"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="51,319,186,345"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="9,543,156,569"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1475,393,1618,420"/>
<area shape="rect" id="node23" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1799,319,1913,345"/>
<area shape="rect" id="node26" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="2340,468,2487,495"/>
<area shape="rect" id="node31" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1817,244,1967,271"/>
<area shape="rect" id="node25" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1642,393,1705,420"/>
<area shape="rect" id="node29" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="2225,393,2375,420"/>
<area shape="rect" id="node30" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1729,393,1855,420"/>
<area shape="rect" id="node33" href="../../dd/d79/stasis_8h.html" title="Stasis Message Bus API. See Stasis Message Bus API for detailed documentation. " alt="" coords="1400,169,1525,196"/>
<area shape="rect" id="node34" href="../../d4/d05/json_8h.html" title="Asterisk JSON abstraction layer. " alt="" coords="1117,244,1232,271"/>
<area shape="rect" id="node35" href="../../db/d45/manager_8h.html" title="The AMI &#45; Asterisk Manager Interface &#45; is a TCP protocol created to manage Asterisk with third&#45;party ..." alt="" coords="1545,244,1690,271"/>
<area shape="rect" id="node36" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1405,244,1520,271"/>
<area shape="rect" id="node37" href="../../dd/d20/event_8h.html" title="asterisk/event.h" alt="" coords="1257,244,1381,271"/>
</map>
</div>
</div>
<p><a href="../../d2/d78/stasis__message__router_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a4286a847400bdf26aba7ea62045e5ca4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a4286a847400bdf26aba7ea62045e5ca4">ROUTE_TABLE_ELEM_CLEANUP</a>(elem)&#160;&#160;&#160;<a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>((elem).message_type)</td></tr>
<tr class="memdesc:a4286a847400bdf26aba7ea62045e5ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">route_table vector element cleanup.  <a href="#a4286a847400bdf26aba7ea62045e5ca4">More...</a><br /></td></tr>
<tr class="separator:a4286a847400bdf26aba7ea62045e5ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbcee78909cdbb454630ed0ec82c4383"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#abbcee78909cdbb454630ed0ec82c4383">ROUTE_TABLE_ELEM_CMP</a>(elem,  <a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a>)&#160;&#160;&#160;((elem).message_type == (<a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a>))</td></tr>
<tr class="memdesc:abbcee78909cdbb454630ed0ec82c4383"><td class="mdescLeft">&#160;</td><td class="mdescRight">route_table comparator for <a class="el" href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996" title="Remove an element from a vector that matches the given comparison. ">AST_VECTOR_REMOVE_CMP_UNORDERED()</a>  <a href="#abbcee78909cdbb454630ed0ec82c4383">More...</a><br /></td></tr>
<tr class="separator:abbcee78909cdbb454630ed0ec82c4383"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab4e420fb0f084c6cb9b22ecb4fd1066f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#ab4e420fb0f084c6cb9b22ecb4fd1066f">__stasis_message_router_create</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, const char *file, int lineno, const char *func)</td></tr>
<tr class="memdesc:ab4e420fb0f084c6cb9b22ecb4fd1066f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new message router object.  <a href="#ab4e420fb0f084c6cb9b22ecb4fd1066f">More...</a><br /></td></tr>
<tr class="separator:ab4e420fb0f084c6cb9b22ecb4fd1066f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab78b252c63cb16d1577b5ea4dd3f473d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#ab78b252c63cb16d1577b5ea4dd3f473d">__stasis_message_router_create_pool</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, const char *file, int lineno, const char *func)</td></tr>
<tr class="memdesc:ab78b252c63cb16d1577b5ea4dd3f473d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new message router object.  <a href="#ab78b252c63cb16d1577b5ea4dd3f473d">More...</a><br /></td></tr>
<tr class="separator:ab78b252c63cb16d1577b5ea4dd3f473d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c48c0e41326f1ebc18f0f6391183947"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a9c48c0e41326f1ebc18f0f6391183947">AST_VECTOR</a> (route_table, struct <a class="el" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a>)</td></tr>
<tr class="separator:a9c48c0e41326f1ebc18f0f6391183947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4caf0f6381dd14bf1a9ce022698604b8"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a4caf0f6381dd14bf1a9ce022698604b8">find_route</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>, struct <a class="el" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> *route_out)</td></tr>
<tr class="separator:a4caf0f6381dd14bf1a9ce022698604b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3815308ca9d4444b67fc3496b67eb028"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a3815308ca9d4444b67fc3496b67eb028">route_table_add</a> (struct route_table *<a class="el" href="../../db/d94/cel__sqlite3__custom_8c.html#aa334abe35e252ebf7a2c7c29572bc60f">table</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data)</td></tr>
<tr class="separator:a3815308ca9d4444b67fc3496b67eb028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af00583639ac50ca5e009eaa05338c6e4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#af00583639ac50ca5e009eaa05338c6e4">route_table_dtor</a> (struct route_table *<a class="el" href="../../db/d94/cel__sqlite3__custom_8c.html#aa334abe35e252ebf7a2c7c29572bc60f">table</a>)</td></tr>
<tr class="separator:af00583639ac50ca5e009eaa05338c6e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede99e0080624d1266f8c15fb87f6622"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#aede99e0080624d1266f8c15fb87f6622">route_table_find</a> (struct route_table *<a class="el" href="../../db/d94/cel__sqlite3__custom_8c.html#aa334abe35e252ebf7a2c7c29572bc60f">table</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type)</td></tr>
<tr class="separator:aede99e0080624d1266f8c15fb87f6622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c3dfb1e4161ba413929d0b67583fa7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a67c3dfb1e4161ba413929d0b67583fa7">route_table_remove</a> (struct route_table *<a class="el" href="../../db/d94/cel__sqlite3__custom_8c.html#aa334abe35e252ebf7a2c7c29572bc60f">table</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type)</td></tr>
<tr class="separator:a67c3dfb1e4161ba413929d0b67583fa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94056df340726219c3ea60a34d1edd49"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a94056df340726219c3ea60a34d1edd49">router_dispatch</a> (void *data, struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="separator:a94056df340726219c3ea60a34d1edd49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69031898d3c7366ff6e56e7628ed57a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#ac69031898d3c7366ff6e56e7628ed57a">router_dtor</a> (void *obj)</td></tr>
<tr class="separator:ac69031898d3c7366ff6e56e7628ed57a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94a2022d5de1f2546f4d77307f516b19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a94a2022d5de1f2546f4d77307f516b19">stasis_message_router_accept_formatters</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> formatters)</td></tr>
<tr class="memdesc:a94a2022d5de1f2546f4d77307f516b19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicate to a message router that we are interested in messages with one or more formatters.  <a href="#a94a2022d5de1f2546f4d77307f516b19">More...</a><br /></td></tr>
<tr class="separator:a94a2022d5de1f2546f4d77307f516b19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5adc304e693097ec75b474e6a5309958"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data)</td></tr>
<tr class="memdesc:a5adc304e693097ec75b474e6a5309958"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a route to a message router.  <a href="#a5adc304e693097ec75b474e6a5309958">More...</a><br /></td></tr>
<tr class="separator:a5adc304e693097ec75b474e6a5309958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77e2b34cd6f7daafb7bb43bfd6642cbc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a77e2b34cd6f7daafb7bb43bfd6642cbc">stasis_message_router_add_cache_update</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data)</td></tr>
<tr class="memdesc:a77e2b34cd6f7daafb7bb43bfd6642cbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a route for <a class="el" href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a> messages to a message router.  <a href="#a77e2b34cd6f7daafb7bb43bfd6642cbc">More...</a><br /></td></tr>
<tr class="separator:a77e2b34cd6f7daafb7bb43bfd6642cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da35ce9a8d90fc13f060a554e4f240e"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a4da35ce9a8d90fc13f060a554e4f240e">stasis_message_router_create_internal</a> (struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *topic, int use_thread_pool, const char *file, int lineno, const char *func)</td></tr>
<tr class="separator:a4da35ce9a8d90fc13f060a554e4f240e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eae8af1e9345c9cf828966b3d445d09"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a1eae8af1e9345c9cf828966b3d445d09">stasis_message_router_is_done</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>)</td></tr>
<tr class="memdesc:a1eae8af1e9345c9cf828966b3d445d09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns whether <em>router</em> has received its final message.  <a href="#a1eae8af1e9345c9cf828966b3d445d09">More...</a><br /></td></tr>
<tr class="separator:a1eae8af1e9345c9cf828966b3d445d09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa3a5be12d8f5918aad9d1bb97c23893"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#afa3a5be12d8f5918aad9d1bb97c23893">stasis_message_router_publish_sync</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="el" href="../../d8/d9e/structmessage.html">message</a>)</td></tr>
<tr class="memdesc:afa3a5be12d8f5918aad9d1bb97c23893"><td class="mdescLeft">&#160;</td><td class="mdescRight">Publish a message to a message router's subscription synchronously.  <a href="#afa3a5be12d8f5918aad9d1bb97c23893">More...</a><br /></td></tr>
<tr class="separator:afa3a5be12d8f5918aad9d1bb97c23893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c1f3127c63c6a46154167fbd2e50db9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a3c1f3127c63c6a46154167fbd2e50db9">stasis_message_router_remove</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type)</td></tr>
<tr class="memdesc:a3c1f3127c63c6a46154167fbd2e50db9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a route from a message router.  <a href="#a3c1f3127c63c6a46154167fbd2e50db9">More...</a><br /></td></tr>
<tr class="separator:a3c1f3127c63c6a46154167fbd2e50db9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f963d4041802012f6c0c79b8df219c0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a8f963d4041802012f6c0c79b8df219c0">stasis_message_router_remove_cache_update</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *message_type)</td></tr>
<tr class="memdesc:a8f963d4041802012f6c0c79b8df219c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a cache route from a message router.  <a href="#a8f963d4041802012f6c0c79b8df219c0">More...</a><br /></td></tr>
<tr class="separator:a8f963d4041802012f6c0c79b8df219c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1570c21a07d1309809ae61c723f28a1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a1570c21a07d1309809ae61c723f28a1d">stasis_message_router_set_congestion_limits</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, long low_water, long high_water)</td></tr>
<tr class="memdesc:a1570c21a07d1309809ae61c723f28a1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the high and low alert water marks of the stasis message router.  <a href="#a1570c21a07d1309809ae61c723f28a1d">More...</a><br /></td></tr>
<tr class="separator:a1570c21a07d1309809ae61c723f28a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa59d4e87c66028292722730a82c149ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#aa59d4e87c66028292722730a82c149ab">stasis_message_router_set_default</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data)</td></tr>
<tr class="memdesc:aa59d4e87c66028292722730a82c149ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the default route of a router.  <a href="#aa59d4e87c66028292722730a82c149ab">More...</a><br /></td></tr>
<tr class="separator:aa59d4e87c66028292722730a82c149ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac911cfd927625dfd7d78908aae0fec80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#ac911cfd927625dfd7d78908aae0fec80">stasis_message_router_set_formatters_default</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>, <a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a> callback, void *data, enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> formatters)</td></tr>
<tr class="memdesc:ac911cfd927625dfd7d78908aae0fec80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the default route of a router with formatters.  <a href="#ac911cfd927625dfd7d78908aae0fec80">More...</a><br /></td></tr>
<tr class="separator:ac911cfd927625dfd7d78908aae0fec80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5646e370e39cc29f5faa7a30fda11159"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a5646e370e39cc29f5faa7a30fda11159">stasis_message_router_unsubscribe</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>)</td></tr>
<tr class="memdesc:a5646e370e39cc29f5faa7a30fda11159"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribe the router from the upstream topic.  <a href="#a5646e370e39cc29f5faa7a30fda11159">More...</a><br /></td></tr>
<tr class="separator:a5646e370e39cc29f5faa7a30fda11159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641f77c471ff127e8586247ff6c0d64c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/stasis__message__router_8c.html#a641f77c471ff127e8586247ff6c0d64c">stasis_message_router_unsubscribe_and_join</a> (struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="el" href="../../d6/d6a/res__endpoint__stats_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>)</td></tr>
<tr class="memdesc:a641f77c471ff127e8586247ff6c0d64c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unsubscribe the router from the upstream topic, blocking until the final message has been processed.  <a href="#a641f77c471ff127e8586247ff6c0d64c">More...</a><br /></td></tr>
<tr class="separator:a641f77c471ff127e8586247ff6c0d64c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Stasis message router implementation. </p>
<dl class="section author"><dt>Author</dt><dd>David M. Lee, II <a href="#" onclick="location.href='mai'+'lto:'+'dle'+'e@'+'dig'+'iu'+'m.c'+'om'; return false;">dlee@<span style="display: none;">.nosp@m.</span>digi<span style="display: none;">.nosp@m.</span>um.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a4286a847400bdf26aba7ea62045e5ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4286a847400bdf26aba7ea62045e5ca4">&#9670;&nbsp;</a></span>ROUTE_TABLE_ELEM_CLEANUP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROUTE_TABLE_ELEM_CLEANUP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">elem</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>((elem).message_type)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>route_table vector element cleanup. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">elem</td><td>Element to cleanup</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00088">88</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00097">route_table_add()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00118">route_table_dtor()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00090">route_table_remove()</a>.</p>

</div>
</div>
<a id="abbcee78909cdbb454630ed0ec82c4383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbcee78909cdbb454630ed0ec82c4383">&#9670;&nbsp;</a></span>ROUTE_TABLE_ELEM_CMP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ROUTE_TABLE_ELEM_CMP</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">elem, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((elem).message_type == (<a class="el" href="../../d5/dde/test__func__file_8c.html#a8556878012feffc9e0beb86cd78f424d">value</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>route_table comparator for <a class="el" href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996" title="Remove an element from a vector that matches the given comparison. ">AST_VECTOR_REMOVE_CMP_UNORDERED()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">elem</td><td>Element to compare against </td></tr>
    <tr><td class="paramname">value</td><td>Value to compare with the vector element.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if element does not match. </dd>
<dd>
Non-zero if element matches. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00079">79</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00090">route_table_remove()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab4e420fb0f084c6cb9b22ecb4fd1066f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4e420fb0f084c6cb9b22ecb4fd1066f">&#9670;&nbsp;</a></span>__stasis_message_router_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a>* __stasis_message_router_create </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new message router object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic to subscribe route to.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a>. </dd>
<dd>
<code>NULL</code> on error.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00246">246</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a4da35ce9a8d90fc13f060a554e4f240e">stasis_message_router_create_internal</a>(topic, 0, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, lineno, func);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;}</div><div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a4da35ce9a8d90fc13f060a554e4f240e"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a4da35ce9a8d90fc13f060a554e4f240e">stasis_message_router_create_internal</a></div><div class="ttdeci">static struct stasis_message_router * stasis_message_router_create_internal(struct stasis_topic *topic, int use_thread_pool, const char *file, int lineno, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router.c:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab78b252c63cb16d1577b5ea4dd3f473d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab78b252c63cb16d1577b5ea4dd3f473d">&#9670;&nbsp;</a></span>__stasis_message_router_create_pool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a>* __stasis_message_router_create_pool </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new message router object. </p>
<p>The subscription created for this message router will dispatch callbacks on a thread pool.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic to subscribe route to.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a>. </dd>
<dd>
<code>NULL</code> on error.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>12.8.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00252">252</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;{</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a4da35ce9a8d90fc13f060a554e4f240e">stasis_message_router_create_internal</a>(topic, 1, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, lineno, func);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a4da35ce9a8d90fc13f060a554e4f240e"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a4da35ce9a8d90fc13f060a554e4f240e">stasis_message_router_create_internal</a></div><div class="ttdeci">static struct stasis_message_router * stasis_message_router_create_internal(struct stasis_topic *topic, int use_thread_pool, const char *file, int lineno, const char *func)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router.c:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c48c0e41326f1ebc18f0f6391183947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c48c0e41326f1ebc18f0f6391183947">&#9670;&nbsp;</a></span>AST_VECTOR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_VECTOR </td>
          <td>(</td>
          <td class="paramtype">route_table&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a>&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4caf0f6381dd14bf1a9ce022698604b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4caf0f6381dd14bf1a9ce022698604b8">&#9670;&nbsp;</a></span>find_route()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int find_route </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> *&#160;</td>
          <td class="paramname"><em>route_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00155">155</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router::cache_routes</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_route::callback</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00139">stasis_message_router::default_route</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00048">route_table_find()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router::routes</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00602">SCOPED_AO2LOCK</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message_data()</a>, <a class="el" href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message_type()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00969">stasis_cache_update::type</a>, and <a class="el" href="../../d0/d89/codec__g726_8c_source.html#l00367">update()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00191">router_dispatch()</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> *route = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(message);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, router);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(route_out != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <span class="keywordflow">if</span> (type == <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>()) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="comment">/* Find a cache route */</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a> *<a class="code" href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a> =</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;         <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      route = <a class="code" href="../../d2/d78/stasis__message__router_8c.html#aede99e0080624d1266f8c15fb87f6622">route_table_find</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">cache_routes</a>, update-&gt;<a class="code" href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">type</a>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keywordflow">if</span> (route == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="comment">/* Find a regular route */</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      route = <a class="code" href="../../d2/d78/stasis__message__router_8c.html#aede99e0080624d1266f8c15fb87f6622">route_table_find</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">routes</a>, type);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keywordflow">if</span> (route == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#adf345ce3957d7e90e288d40494c5fdb4">default_route</a>.<a class="code" href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">callback</a>) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">/* Maybe the default route, then? */</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      route = &amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#adf345ce3957d7e90e288d40494c5fdb4">default_route</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keywordflow">if</span> (!route) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   *route_out = *route;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="codec__g726_8c_html_a8c58a1d1fd9436ff5145385d3ef7a430"><div class="ttname"><a href="../../d0/d89/codec__g726_8c.html#a8c58a1d1fd9436ff5145385d3ef7a430">update</a></div><div class="ttdeci">static void update(int code_size, int y, int wi, int fi, int dq, int sr, int dqsez, struct g726_state *state_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d89/codec__g726_8c_source.html#l00367">codec_g726.c:367</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a879559accce4074d382a8d83133c2fdf"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">stasis_message_router::cache_routes</a></div><div class="ttdeci">struct route_table cache_routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router.c:137</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="structstasis__message__route_html"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00037">stasis_message_router.c:37</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab5d1a876f8f0cd0562fb5d5f94c06717"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_update_type(void)</div><div class="ttdoc">Message type for cache update messages. </div></div>
<div class="ttc" id="structstasis__message__type_html"><div class="ttname"><a href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00038">stasis_message.c:38</a></div></div>
<div class="ttc" id="structstasis__cache__update_html"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a></div><div class="ttdoc">Cache update message. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00967">stasis.h:967</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a531bcfa5161db30fc360a51a013beed5"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">stasis_message_router::routes</a></div><div class="ttdeci">struct route_table routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router.c:135</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="structstasis__message__router_html_adf345ce3957d7e90e288d40494c5fdb4"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#adf345ce3957d7e90e288d40494c5fdb4">stasis_message_router::default_route</a></div><div class="ttdeci">struct stasis_message_route default_route</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00139">stasis_message_router.c:139</a></div></div>
<div class="ttc" id="structstasis__cache__update_html_a39694abd1b80d3c9ef0619acf9d493aa"><div class="ttname"><a href="../../de/dfa/structstasis__cache__update.html#a39694abd1b80d3c9ef0619acf9d493aa">stasis_cache_update::type</a></div><div class="ttdeci">struct stasis_message_type * type</div><div class="ttdoc">Convenience reference to snapshot type. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00969">stasis.h:969</a></div></div>
<div class="ttc" id="lock_8h_html_a2cfb325ed371eb6e629446bac4676e9f"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a></div><div class="ttdeci">#define SCOPED_AO2LOCK(varname, obj)</div><div class="ttdoc">scoped lock specialization for ao2 mutexes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00602">lock.h:602</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_aede99e0080624d1266f8c15fb87f6622"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#aede99e0080624d1266f8c15fb87f6622">route_table_find</a></div><div class="ttdeci">static struct stasis_message_route * route_table_find(struct route_table *table, struct stasis_message_type *message_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00048">stasis_message_router.c:48</a></div></div>
<div class="ttc" id="structstasis__message__route_html_a8ef8d0e48190325c057f35cf776673e7"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">stasis_message_route::callback</a></div><div class="ttdeci">stasis_subscription_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_router.c:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3815308ca9d4444b67fc3496b67eb028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3815308ca9d4444b67fc3496b67eb028">&#9670;&nbsp;</a></span>route_table_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int route_table_add </td>
          <td>(</td>
          <td class="paramtype">struct route_table *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00097">97</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_route::callback</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00043">stasis_message_route::data</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00039">stasis_message_route::message_type</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00088">ROUTE_TABLE_ELEM_CLEANUP</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00048">route_table_find()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00310">stasis_message_router_add()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00336">stasis_message_router_add_cache_update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;{</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> route;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">callback</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d2/d78/stasis__message__router_8c.html#aede99e0080624d1266f8c15fb87f6622">route_table_find</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>, message_type) == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   route.message_type = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(message_type);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   route.callback = <a class="code" href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">callback</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   route.data = <a class="code" href="../../d6/d05/structstasis__message__route.html#a735984d41155bc1032e09bece8f8d66d">data</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   res = <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>, route);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a4286a847400bdf26aba7ea62045e5ca4">ROUTE_TABLE_ELEM_CLEANUP</a>(route);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="structstasis__message__route_html"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00037">stasis_message_router.c:37</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="cdr__odbc_8c_html_a68d1e6e752f2cf81551fac543cae108a"><div class="ttname"><a href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a></div><div class="ttdeci">static char * table</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/cdr__odbc_8c_source.html#l00058">cdr_odbc.c:58</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a4286a847400bdf26aba7ea62045e5ca4"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a4286a847400bdf26aba7ea62045e5ca4">ROUTE_TABLE_ELEM_CLEANUP</a></div><div class="ttdeci">#define ROUTE_TABLE_ELEM_CLEANUP(elem)</div><div class="ttdoc">route_table vector element cleanup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00088">stasis_message_router.c:88</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_aede99e0080624d1266f8c15fb87f6622"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#aede99e0080624d1266f8c15fb87f6622">route_table_find</a></div><div class="ttdeci">static struct stasis_message_route * route_table_find(struct route_table *table, struct stasis_message_type *message_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00048">stasis_message_router.c:48</a></div></div>
<div class="ttc" id="structstasis__message__route_html_a8ef8d0e48190325c057f35cf776673e7"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">stasis_message_route::callback</a></div><div class="ttdeci">stasis_subscription_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_router.c:41</a></div></div>
<div class="ttc" id="structstasis__message__route_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html#a735984d41155bc1032e09bece8f8d66d">stasis_message_route::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00043">stasis_message_router.c:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af00583639ac50ca5e009eaa05338c6e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af00583639ac50ca5e009eaa05338c6e4">&#9670;&nbsp;</a></span>route_table_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void route_table_dtor </td>
          <td>(</td>
          <td class="paramtype">struct route_table *&#160;</td>
          <td class="paramname"><em>table</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00118">118</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00088">ROUTE_TABLE_ELEM_CLEANUP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00142">router_dtor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;{</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordtype">size_t</span> idx;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> *route;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>); ++idx) {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      route = <a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>, idx);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a4286a847400bdf26aba7ea62045e5ca4">ROUTE_TABLE_ELEM_CLEANUP</a>(*route);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structstasis__message__route_html"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00037">stasis_message_router.c:37</a></div></div>
<div class="ttc" id="cdr__odbc_8c_html_a68d1e6e752f2cf81551fac543cae108a"><div class="ttname"><a href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a></div><div class="ttdeci">static char * table</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/cdr__odbc_8c_source.html#l00058">cdr_odbc.c:58</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a4286a847400bdf26aba7ea62045e5ca4"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a4286a847400bdf26aba7ea62045e5ca4">ROUTE_TABLE_ELEM_CLEANUP</a></div><div class="ttdeci">#define ROUTE_TABLE_ELEM_CLEANUP(elem)</div><div class="ttdoc">route_table vector element cleanup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00088">stasis_message_router.c:88</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aede99e0080624d1266f8c15fb87f6622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aede99e0080624d1266f8c15fb87f6622">&#9670;&nbsp;</a></span>route_table_find()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a>* route_table_find </td>
          <td>(</td>
          <td class="paramtype">struct route_table *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00048">48</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00039">stasis_message_route::message_type</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00155">find_route()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00097">route_table_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   <span class="keywordtype">size_t</span> idx;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> *route;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="comment">/* While a linear search for routes may seem very inefficient, most</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">    * route tables have six routes or less. For such small data, it&#39;s</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">    * hard to beat a linear search. If we start having larger route</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">    * tables, then we can look into containers with more efficient</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">    * lookups.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">for</span> (idx = 0; idx &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>); ++idx) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      route = <a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>, idx);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">if</span> (route-&gt;<a class="code" href="../../d6/d05/structstasis__message__route.html#add6b02fb3f4bece79957e0b9a1355440">message_type</a> == message_type) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <span class="keywordflow">return</span> route;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div><div class="ttc" id="structstasis__message__route_html"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00037">stasis_message_router.c:37</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cdr__odbc_8c_html_a68d1e6e752f2cf81551fac543cae108a"><div class="ttname"><a href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a></div><div class="ttdeci">static char * table</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/cdr__odbc_8c_source.html#l00058">cdr_odbc.c:58</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="structstasis__message__route_html_add6b02fb3f4bece79957e0b9a1355440"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html#add6b02fb3f4bece79957e0b9a1355440">stasis_message_route::message_type</a></div><div class="ttdeci">struct stasis_message_type * message_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00039">stasis_message_router.c:39</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67c3dfb1e4161ba413929d0b67583fa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67c3dfb1e4161ba413929d0b67583fa7">&#9670;&nbsp;</a></span>route_table_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int route_table_remove </td>
          <td>(</td>
          <td class="paramtype">struct route_table *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00090">90</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00488">AST_VECTOR_REMOVE_CMP_UNORDERED</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00088">ROUTE_TABLE_ELEM_CLEANUP</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00079">ROUTE_TABLE_ELEM_CMP</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00358">stasis_message_router_remove()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00372">stasis_message_router_remove_cache_update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996">AST_VECTOR_REMOVE_CMP_UNORDERED</a>(<a class="code" href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a>, message_type, <a class="code" href="../../d2/d78/stasis__message__router_8c.html#abbcee78909cdbb454630ed0ec82c4383">ROUTE_TABLE_ELEM_CMP</a>,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a4286a847400bdf26aba7ea62045e5ca4">ROUTE_TABLE_ELEM_CLEANUP</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div><div class="ttc" id="vector_8h_html_a671c51a3e6202230ef9d2330624ea996"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996">AST_VECTOR_REMOVE_CMP_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_CMP_UNORDERED(vec, value, cmp, cleanup)</div><div class="ttdoc">Remove an element from a vector that matches the given comparison. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00488">vector.h:488</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_abbcee78909cdbb454630ed0ec82c4383"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#abbcee78909cdbb454630ed0ec82c4383">ROUTE_TABLE_ELEM_CMP</a></div><div class="ttdeci">#define ROUTE_TABLE_ELEM_CMP(elem, value)</div><div class="ttdoc">route_table comparator for AST_VECTOR_REMOVE_CMP_UNORDERED() </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00079">stasis_message_router.c:79</a></div></div>
<div class="ttc" id="cdr__odbc_8c_html_a68d1e6e752f2cf81551fac543cae108a"><div class="ttname"><a href="../../d8/d56/cdr__odbc_8c.html#a68d1e6e752f2cf81551fac543cae108a">table</a></div><div class="ttdeci">static char * table</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d56/cdr__odbc_8c_source.html#l00058">cdr_odbc.c:58</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a4286a847400bdf26aba7ea62045e5ca4"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a4286a847400bdf26aba7ea62045e5ca4">ROUTE_TABLE_ELEM_CLEANUP</a></div><div class="ttdeci">#define ROUTE_TABLE_ELEM_CLEANUP(elem)</div><div class="ttdoc">route_table vector element cleanup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00088">stasis_message_router.c:88</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94056df340726219c3ea60a34d1edd49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94056df340726219c3ea60a34d1edd49">&#9670;&nbsp;</a></span>router_dispatch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void router_dispatch </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *&#160;</td>
          <td class="paramname"><em>sub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00191">191</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_route::callback</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00043">stasis_message_route::data</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00155">find_route()</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00042">router</a>, and <a class="el" href="../../d0/df4/stasis_8c_source.html#l01176">stasis_subscription_final_message()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;{</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a> = data;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a> route;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d2/d78/stasis__message__router_8c.html#a4caf0f6381dd14bf1a9ce022698604b8">find_route</a>(router, message, &amp;route) == 0) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      route.<a class="code" href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">callback</a>(route.data, sub, message);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a>(sub, message)) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(router);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="ttc" id="stasis__message__router_8c_html_a4caf0f6381dd14bf1a9ce022698604b8"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a4caf0f6381dd14bf1a9ce022698604b8">find_route</a></div><div class="ttdeci">static int find_route(struct stasis_message_router *router, struct stasis_message *message, struct stasis_message_route *route_out)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00155">stasis_message_router.c:155</a></div></div>
<div class="ttc" id="pjsip__outbound__registrations_8c_html_a85c07e3e0d15ea99cf0c5dbe1dfdcb24"><div class="ttname"><a href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a></div><div class="ttdeci">static struct stasis_message_router * router</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00042">pjsip_outbound_registrations.c:42</a></div></div>
<div class="ttc" id="structstasis__message__route_html"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html">stasis_message_route</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00037">stasis_message_router.c:37</a></div></div>
<div class="ttc" id="structstasis__message__router_html"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00131">stasis_message_router.c:131</a></div></div>
<div class="ttc" id="stasis_8h_html_a839350445aaa51cedf31f6daec933ee0"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0">stasis_subscription_final_message</a></div><div class="ttdeci">int stasis_subscription_final_message(struct stasis_subscription *sub, struct stasis_message *msg)</div><div class="ttdoc">Determine whether a message is the final message to be received on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01176">stasis.c:1176</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__message__route_html_a8ef8d0e48190325c057f35cf776673e7"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">stasis_message_route::callback</a></div><div class="ttdeci">stasis_subscription_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_router.c:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac69031898d3c7366ff6e56e7628ed57a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac69031898d3c7366ff6e56e7628ed57a">&#9670;&nbsp;</a></span>router_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void router_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00142">142</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router::cache_routes</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00118">route_table_dtor()</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00042">router</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router::routes</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01120">stasis_subscription_is_done()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01152">stasis_subscription_is_subscribed()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">stasis_message_router_create_internal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a> = obj;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!<a class="code" href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../dd/d79/stasis_8h.html#a04c69c471e1b836539f280b80b0000de">stasis_subscription_is_done</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>));</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <a class="code" href="../../d2/d78/stasis__message__router_8c.html#af00583639ac50ca5e009eaa05338c6e4">route_table_dtor</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">routes</a>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <a class="code" href="../../d2/d78/stasis__message__router_8c.html#af00583639ac50ca5e009eaa05338c6e4">route_table_dtor</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">cache_routes</a>);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div><div class="ttc" id="pjsip__outbound__registrations_8c_html_a85c07e3e0d15ea99cf0c5dbe1dfdcb24"><div class="ttname"><a href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a></div><div class="ttdeci">static struct stasis_message_router * router</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00042">pjsip_outbound_registrations.c:42</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a879559accce4074d382a8d83133c2fdf"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">stasis_message_router::cache_routes</a></div><div class="ttdeci">struct route_table cache_routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router.c:137</a></div></div>
<div class="ttc" id="stasis_8h_html_acd5bedbb2212956dac77be47dceef510"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acd5bedbb2212956dac77be47dceef510">stasis_subscription_is_subscribed</a></div><div class="ttdeci">int stasis_subscription_is_subscribed(const struct stasis_subscription *sub)</div><div class="ttdoc">Returns whether a subscription is currently subscribed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01152">stasis.c:1152</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structstasis__message__router_html"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00131">stasis_message_router.c:131</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_af00583639ac50ca5e009eaa05338c6e4"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#af00583639ac50ca5e009eaa05338c6e4">route_table_dtor</a></div><div class="ttdeci">static void route_table_dtor(struct route_table *table)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00118">stasis_message_router.c:118</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a531bcfa5161db30fc360a51a013beed5"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">stasis_message_router::routes</a></div><div class="ttdeci">struct route_table routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router.c:135</a></div></div>
<div class="ttc" id="stasis_8h_html_a04c69c471e1b836539f280b80b0000de"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a04c69c471e1b836539f280b80b0000de">stasis_subscription_is_done</a></div><div class="ttdeci">int stasis_subscription_is_done(struct stasis_subscription *subscription)</div><div class="ttdoc">Returns whether subscription has received its final message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01120">stasis.c:1120</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94a2022d5de1f2546f4d77307f516b19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94a2022d5de1f2546f4d77307f516b19">&#9670;&nbsp;</a></span>stasis_message_router_accept_formatters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_message_router_accept_formatters </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a>&#160;</td>
          <td class="paramname"><em>formatters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Indicate to a message router that we are interested in messages with one or more formatters. </p>
<p>The formatters are passed on to the underlying subscription.</p>
<dl class="section warning"><dt>Warning</dt><dd>With direct subscriptions, adding a formatter filter is an OR operation with any message type filters. In the current implementation of message router however, it's an AND operation. Even when setting a default route, the callback will only get messages that have the formatters provides in this call.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to set the formatters of. </td></tr>
    <tr><td class="paramname">formatters</td><td>A bitmap of <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> we wish to receive.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.25.0 </dd>
<dd>
16.2.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00420">420</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01095">stasis_subscription_accept_formatters()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>
<div class="fragment"><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;{</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(router != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#aaf3a92c10ab654d4a7b11cbf44aa1074">stasis_subscription_accept_formatters</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, formatters);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis_8h_html_aaf3a92c10ab654d4a7b11cbf44aa1074"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aaf3a92c10ab654d4a7b11cbf44aa1074">stasis_subscription_accept_formatters</a></div><div class="ttdeci">void stasis_subscription_accept_formatters(struct stasis_subscription *subscription, enum stasis_subscription_message_formatters formatters)</div><div class="ttdoc">Indicate to a subscription that we are interested in messages with one or more formatters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01095">stasis.c:1095</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5adc304e693097ec75b474e6a5309958"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5adc304e693097ec75b474e6a5309958">&#9670;&nbsp;</a></span>stasis_message_router_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_router_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a route to a message router. </p>
<p>A particular <em>message_type</em> may have at most one route per <em>router</em>. If you route <a class="el" href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a> messages, the callback will only receive updates for types not handled by routes added with <a class="el" href="../../d4/d25/stasis__message__router_8h.html#a77e2b34cd6f7daafb7bb43bfd6642cbc" title="Add a route for stasis_cache_update messages to a message router. ">stasis_message_router_add_cache_update()</a>.</p>
<p>Adding multiple routes for the same message type results in undefined behavior.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to add the route to. </td></tr>
    <tr><td class="paramname">message_type</td><td>Type of message to route. </td></tr>
    <tr><td class="paramname">callback</td><td>Callback to forard messages of <em>message_type</em> to. </td></tr>
    <tr><td class="paramname">data</td><td>Data pointer to pass to <em>callback</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00310">310</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00097">route_table_add()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router::routes</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00300">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00915">app_create()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00511">AST_TEST_DEFINE()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01500">create_routes()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00214">endpoint_internal_create()</a>, <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00199">forwards_create_endpoint()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01177">load_general_config()</a>, <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00246">load_module()</a>, <a class="el" href="../../da/d10/manager__bridges_8c_source.html#l00681">manager_bridging_init()</a>, <a class="el" href="../../d0/d1c/manager__channels_8c_source.html#l01308">manager_channels_init()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00721">manager_confbridge_init()</a>, <a class="el" href="../../df/d10/manager__endpoints_8c_source.html#l00052">manager_endpoints_init()</a>, <a class="el" href="../../d4/d00/manager__mwi_8c_source.html#l00153">manager_mwi_init()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l09053">manager_subscriptions_init()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01157">meetme_stasis_init()</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00342">pjsip_outbound_registration_metrics_init()</a>, and <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06514">setup_stasis_subs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(router != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keywordflow">if</span> (!message_type) {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="comment">/* Cannot route to NULL type. */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(router);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   res = <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a3815308ca9d4444b67fc3496b67eb028">route_table_add</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">routes</a>, message_type, callback, data);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, message_type);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="comment">/* Until a specific message type was added we would already drop the message, so being</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">       * selective now doesn&#39;t harm us. If we have a default route then we are already forced</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">       * to filter nothing and messages will come in regardless.</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(router);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div><div class="ttc" id="stasis__message__router_8c_html_a3815308ca9d4444b67fc3496b67eb028"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a3815308ca9d4444b67fc3496b67eb028">route_table_add</a></div><div class="ttdeci">static int route_table_add(struct route_table *table, struct stasis_message_type *message_type, stasis_subscription_cb callback, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00097">stasis_message_router.c:97</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a531bcfa5161db30fc360a51a013beed5"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">stasis_message_router::routes</a></div><div class="ttdeci">struct route_table routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router.c:135</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a77e2b34cd6f7daafb7bb43bfd6642cbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77e2b34cd6f7daafb7bb43bfd6642cbc">&#9670;&nbsp;</a></span>stasis_message_router_add_cache_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_router_add_cache_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a route for <a class="el" href="../../de/dfa/structstasis__cache__update.html">stasis_cache_update</a> messages to a message router. </p>
<p>A particular <em>message_type</em> may have at most one cache route per <em>router</em>. These are distinct from regular routes, so one could have both a regular route and a cache route for the same <em>message_type</em>.</p>
<p>Adding multiple routes for the same message type results in undefined behavior.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to add the route to. </td></tr>
    <tr><td class="paramname">message_type</td><td>Subtype of cache update to route. </td></tr>
    <tr><td class="paramname">callback</td><td>Callback to forard messages of <em>message_type</em> to. </td></tr>
    <tr><td class="paramname">data</td><td>Data pointer to pass to <em>callback</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00336">336</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router::cache_routes</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00097">route_table_add()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00300">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00915">app_create()</a>, and <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01710">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(router != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   <span class="keywordflow">if</span> (!message_type) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="comment">/* Cannot cache a route to NULL type. */</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   }</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(router);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   res = <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a3815308ca9d4444b67fc3496b67eb028">route_table_add</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">cache_routes</a>, message_type, callback, data);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a>());</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(router);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div><div class="ttc" id="stasis__message__router_8c_html_a3815308ca9d4444b67fc3496b67eb028"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a3815308ca9d4444b67fc3496b67eb028">route_table_add</a></div><div class="ttdeci">static int route_table_add(struct route_table *table, struct stasis_message_type *message_type, stasis_subscription_cb callback, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00097">stasis_message_router.c:97</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a879559accce4074d382a8d83133c2fdf"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">stasis_message_router::cache_routes</a></div><div class="ttdeci">struct route_table cache_routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router.c:137</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gab5d1a876f8f0cd0562fb5d5f94c06717"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gab5d1a876f8f0cd0562fb5d5f94c06717">stasis_cache_update_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_cache_update_type(void)</div><div class="ttdoc">Message type for cache update messages. </div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4da35ce9a8d90fc13f060a554e4f240e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da35ce9a8d90fc13f060a554e4f240e">&#9670;&nbsp;</a></span>stasis_message_router_create_internal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a>* stasis_message_router_create_internal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *&#160;</td>
          <td class="paramname"><em>topic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>use_thread_pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lineno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00207">207</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l00944">__stasis_subscribe()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00955">__stasis_subscribe_pool()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00409">ao2_t_alloc</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router::cache_routes</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00042">router</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00191">router_dispatch()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00142">router_dtor()</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router::routes</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01025">stasis_subscription_accept_message_type()</a>, <a class="el" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type()</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00628">stasis_topic_name()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00246">__stasis_message_router_create()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00252">__stasis_message_router_create_pool()</a>.</p>
<div class="fragment"><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   router = <a class="code" href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a>(<span class="keyword">sizeof</span>(*router), <a class="code" href="../../d2/d78/stasis__message__router_8c.html#ac69031898d3c7366ff6e56e7628ed57a">router_dtor</a>, <a class="code" href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a>(topic));</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordflow">if</span> (!router) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   res = 0;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   res |= <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">routes</a>, 0);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   res |= <a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">cache_routes</a>, 0);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(router, -1);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keywordflow">if</span> (use_thread_pool) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a6b7cbb6df580f2e3cba59eed0400fee4">__stasis_subscribe_pool</a>(topic, <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a94056df340726219c3ea60a34d1edd49">router_dispatch</a>, router, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, lineno, func);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a23dcf25efe633f0f429a1520f066249f">__stasis_subscribe</a>(topic, <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a94056df340726219c3ea60a34d1edd49">router_dispatch</a>, router, <a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, lineno, func);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="keywordflow">if</span> (!router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(router, -1);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="comment">/* We need to receive subscription change messages so we know when our subscription goes away */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a>());</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_ad57326008c326db88dc36779741622b8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a></div><div class="ttdeci">#define ao2_t_alloc(data_size, destructor_fn, debug_msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00409">astobj2.h:409</a></div></div>
<div class="ttc" id="pjsip__outbound__registrations_8c_html_a85c07e3e0d15ea99cf0c5dbe1dfdcb24"><div class="ttname"><a href="../../d6/d5d/pjsip__outbound__registrations_8c.html#a85c07e3e0d15ea99cf0c5dbe1dfdcb24">router</a></div><div class="ttdeci">static struct stasis_message_router * router</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00042">pjsip_outbound_registrations.c:42</a></div></div>
<div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a879559accce4074d382a8d83133c2fdf"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">stasis_message_router::cache_routes</a></div><div class="ttdeci">struct route_table cache_routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router.c:137</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_ac69031898d3c7366ff6e56e7628ed57a"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#ac69031898d3c7366ff6e56e7628ed57a">router_dtor</a></div><div class="ttdeci">static void router_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00142">stasis_message_router.c:142</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="structstasis__message__router_html"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00131">stasis_message_router.c:131</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a531bcfa5161db30fc360a51a013beed5"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">stasis_message_router::routes</a></div><div class="ttdeci">struct route_table routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router.c:135</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a94056df340726219c3ea60a34d1edd49"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a94056df340726219c3ea60a34d1edd49">router_dispatch</a></div><div class="ttdeci">static void router_dispatch(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00191">stasis_message_router.c:191</a></div></div>
<div class="ttc" id="stasis_8h_html_af23deee342575033bc73311b1215d886"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af23deee342575033bc73311b1215d886">stasis_topic_name</a></div><div class="ttdeci">const char * stasis_topic_name(const struct stasis_topic *topic)</div><div class="ttdoc">Return the name of a topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00628">stasis.c:628</a></div></div>
<div class="ttc" id="stasis_8h_html_a6b7cbb6df580f2e3cba59eed0400fee4"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a6b7cbb6df580f2e3cba59eed0400fee4">__stasis_subscribe_pool</a></div><div class="ttdeci">struct stasis_subscription * __stasis_subscribe_pool(struct stasis_topic *topic, stasis_subscription_cb callback, void *data, const char *file, int lineno, const char *func)</div><div class="ttdoc">Create a subscription whose callbacks occur on a thread pool. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00955">stasis.c:955</a></div></div>
<div class="ttc" id="stasis_8h_html_a23dcf25efe633f0f429a1520f066249f"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a23dcf25efe633f0f429a1520f066249f">__stasis_subscribe</a></div><div class="ttdeci">struct stasis_subscription * __stasis_subscribe(struct stasis_topic *topic, stasis_subscription_cb callback, void *data, const char *file, int lineno, const char *func)</div><div class="ttdoc">Create a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00944">stasis.c:944</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gafae630f05995b59b49dc523a5b9ce757"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gafae630f05995b59b49dc523a5b9ce757">stasis_subscription_change_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_subscription_change_type(void)</div><div class="ttdoc">Gets the message type for subscription change notices. </div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1eae8af1e9345c9cf828966b3d445d09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eae8af1e9345c9cf828966b3d445d09">&#9670;&nbsp;</a></span>stasis_message_router_is_done()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_router_is_done </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns whether <em>router</em> has received its final message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True (non-zero) if <a class="el" href="../../dd/d79/stasis_8h.html#a839350445aaa51cedf31f6daec933ee0" title="Determine whether a message is the final message to be received on a subscription. ">stasis_subscription_final_message()</a> has been received. </dd>
<dd>
False (zero) if waiting for the end. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00278">278</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l01120">stasis_subscription_is_done()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00145">endpoint_dtor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordflow">if</span> (!router) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="comment">/* Null router is about as done as you can get */</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d79/stasis_8h.html#a04c69c471e1b836539f280b80b0000de">stasis_subscription_is_done</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a04c69c471e1b836539f280b80b0000de"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a04c69c471e1b836539f280b80b0000de">stasis_subscription_is_done</a></div><div class="ttdeci">int stasis_subscription_is_done(struct stasis_subscription *subscription)</div><div class="ttdoc">Returns whether subscription has received its final message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01120">stasis.c:1120</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa3a5be12d8f5918aad9d1bb97c23893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa3a5be12d8f5918aad9d1bb97c23893">&#9670;&nbsp;</a></span>stasis_message_router_publish_sync()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_message_router_publish_sync </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d7/d55/structstasis__message.html">stasis_message</a> *&#160;</td>
          <td class="paramname"><em>message</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Publish a message to a message router's subscription synchronously. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router </td></tr>
    <tr><td class="paramname">message</td><td>The <a class="el" href="../../dd/dfd/stasis.html">Stasis Message Bus API</a> message</td></tr>
  </table>
  </dd>
</dl>
<p>This should be used when a message needs to be published synchronously to the underlying subscription created by a message router. This is analagous to <a class="el" href="../../d0/df4/stasis_8c.html#a499d7d708fc81464ec55de7c518b02c6">stasis_publish_sync</a>.</p>
<p>Note that the caller will be blocked until the thread servicing the message on the message router's subscription completes handling of the message.</p>
<dl class="section since"><dt>Since</dt><dd>12.1.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00288">288</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01516">stasis_publish_sync()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/df2/cdr_8c_source.html#l04577">ast_cdr_engine_term()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00604">cdr_prop_write()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00448">cdr_read()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00506">cdr_write()</a>, <a class="el" href="../../d2/db9/app__forkcdr_8c_source.html#l00134">forkcdr_exec()</a>, and <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00166">publish_app_cdr_message()</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(router != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(router);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a499d7d708fc81464ec55de7c518b02c6">stasis_publish_sync</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, message);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(router);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="stasis_8h_html_a499d7d708fc81464ec55de7c518b02c6"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a499d7d708fc81464ec55de7c518b02c6">stasis_publish_sync</a></div><div class="ttdeci">void stasis_publish_sync(struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers, synchronizing on the specified subscriber. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01516">stasis.c:1516</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c1f3127c63c6a46154167fbd2e50db9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c1f3127c63c6a46154167fbd2e50db9">&#9670;&nbsp;</a></span>stasis_message_router_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_message_router_remove </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a route from a message router. </p>
<p>If a route is removed from another thread, there is no notification that all messages using this route have been processed. This typically means that the associated <code>data</code> pointer for this route must be kept until the route itself is disposed of.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to remove the route from. </td></tr>
    <tr><td class="paramname">message_type</td><td>Type of message to route.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00358">358</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00090">route_table_remove()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router::routes</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01249">cleanup_module()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01177">load_general_config()</a>, and <a class="el" href="../../d1/da0/app__cdr_8c_source.html#l00233">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(router != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keywordflow">if</span> (!message_type) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">/* Cannot remove a NULL type. */</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(router);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a67c3dfb1e4161ba413929d0b67583fa7">route_table_remove</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">routes</a>, message_type);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(router);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a67c3dfb1e4161ba413929d0b67583fa7"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a67c3dfb1e4161ba413929d0b67583fa7">route_table_remove</a></div><div class="ttdeci">static int route_table_remove(struct route_table *table, struct stasis_message_type *message_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00090">stasis_message_router.c:90</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a531bcfa5161db30fc360a51a013beed5"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a531bcfa5161db30fc360a51a013beed5">stasis_message_router::routes</a></div><div class="ttdeci">struct route_table routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00135">stasis_message_router.c:135</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f963d4041802012f6c0c79b8df219c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f963d4041802012f6c0c79b8df219c0">&#9670;&nbsp;</a></span>stasis_message_router_remove_cache_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_message_router_remove_cache_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d8f/structstasis__message__type.html">stasis_message_type</a> *&#160;</td>
          <td class="paramname"><em>message_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a cache route from a message router. </p>
<p>If a route is removed from another thread, there is no notification that all messages using this route have been processed. This typically means that the associated <code>data</code> pointer for this route must be kept until the route itself is disposed of.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to remove the route from. </td></tr>
    <tr><td class="paramname">message_type</td><td>Type of message to route.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00372">372</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router::cache_routes</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00090">route_table_remove()</a>.</p>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(router != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <span class="keywordflow">if</span> (!message_type) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="comment">/* Cannot remove a NULL type. */</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(router);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <a class="code" href="../../d2/d78/stasis__message__router_8c.html#a67c3dfb1e4161ba413929d0b67583fa7">route_table_remove</a>(&amp;router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">cache_routes</a>, message_type);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(router);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;}</div><div class="ttc" id="structstasis__message__router_html_a879559accce4074d382a8d83133c2fdf"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a879559accce4074d382a8d83133c2fdf">stasis_message_router::cache_routes</a></div><div class="ttdeci">struct route_table cache_routes</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00137">stasis_message_router.c:137</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stasis__message__router_8c_html_a67c3dfb1e4161ba413929d0b67583fa7"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#a67c3dfb1e4161ba413929d0b67583fa7">route_table_remove</a></div><div class="ttdeci">static int route_table_remove(struct route_table *table, struct stasis_message_type *message_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00090">stasis_message_router.c:90</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1570c21a07d1309809ae61c723f28a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1570c21a07d1309809ae61c723f28a1d">&#9670;&nbsp;</a></span>stasis_message_router_set_congestion_limits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_router_set_congestion_limits </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>low_water</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>high_water</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the high and low alert water marks of the stasis message router. </p>
<dl class="section since"><dt>Since</dt><dd>13.10.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Pointer to a stasis message router </td></tr>
    <tr><td class="paramname">low_water</td><td>New queue low water mark. (-1 to set as 90% of high_water) </td></tr>
    <tr><td class="paramname">high_water</td><td>New queue high water mark.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success. </td></tr>
    <tr><td class="paramname">-1</td><td>on error (water marks not changed). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00298">298</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l01013">stasis_subscription_set_congestion_limits()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../da/dc9/cel_8c_source.html#l01500">create_routes()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04522">load_module()</a>, and <a class="el" href="../../d4/d10/manager_8c_source.html#l09053">manager_subscriptions_init()</a>.</p>
<div class="fragment"><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;{</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keywordflow">if</span> (router) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      res = <a class="code" href="../../dd/d79/stasis_8h.html#a2d95cf98ebb8880cc602c801a639888e">stasis_subscription_set_congestion_limits</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;         low_water, high_water);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   }</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a2d95cf98ebb8880cc602c801a639888e"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a2d95cf98ebb8880cc602c801a639888e">stasis_subscription_set_congestion_limits</a></div><div class="ttdeci">int stasis_subscription_set_congestion_limits(struct stasis_subscription *subscription, long low_water, long high_water)</div><div class="ttdoc">Set the high and low alert water marks of the stasis subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01013">stasis.c:1013</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa59d4e87c66028292722730a82c149ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa59d4e87c66028292722730a82c149ab">&#9670;&nbsp;</a></span>stasis_message_router_set_default()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stasis_message_router_set_default </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the default route of a router. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to set the default route of. </td></tr>
    <tr><td class="paramname">callback</td><td>Callback to forward messages which otherwise have no home. </td></tr>
    <tr><td class="paramname">data</td><td>Data pointer to pass to <em>callback</em>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>on success </td></tr>
    <tr><td class="paramname">-1</td><td>on failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Setting a default callback will automatically cause the underlying subscription to receive all messages and not be filtered. If filtering is desired then a specific route for each message type should be provided. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00387">387</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00397">stasis_message_router_set_formatters_default()</a>, and <a class="el" href="../../dd/d79/stasis_8h_source.html#l00312">STASIS_SUBSCRIPTION_FORMATTER_NONE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01505">AST_TEST_DEFINE()</a>, <a class="el" href="../../d0/dff/res__chan__stats_8c_source.html#l00151">load_module()</a>, and <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06514">setup_stasis_subs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <a class="code" href="../../d2/d78/stasis__message__router_8c.html#ac911cfd927625dfd7d78908aae0fec80">stasis_message_router_set_formatters_default</a>(router, callback, data, <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e">STASIS_SUBSCRIPTION_FORMATTER_NONE</a>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="comment">/* While this implementation can never fail, it used to be able to */</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div><div class="ttc" id="stasis__message__router_8c_html_ac911cfd927625dfd7d78908aae0fec80"><div class="ttname"><a href="../../d2/d78/stasis__message__router_8c.html#ac911cfd927625dfd7d78908aae0fec80">stasis_message_router_set_formatters_default</a></div><div class="ttdeci">void stasis_message_router_set_formatters_default(struct stasis_message_router *router, stasis_subscription_cb callback, void *data, enum stasis_subscription_message_formatters formatters)</div><div class="ttdoc">Sets the default route of a router with formatters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00397">stasis_message_router.c:397</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e">STASIS_SUBSCRIPTION_FORMATTER_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00312">stasis.h:312</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac911cfd927625dfd7d78908aae0fec80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac911cfd927625dfd7d78908aae0fec80">&#9670;&nbsp;</a></span>stasis_message_router_set_formatters_default()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_message_router_set_formatters_default </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d79/stasis_8h.html#a2b7854b4fb538be6f885943a24d60c8f">stasis_subscription_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a>&#160;</td>
          <td class="paramname"><em>formatters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the default route of a router with formatters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to set the default route of. </td></tr>
    <tr><td class="paramname">callback</td><td>Callback to forward messages which otherwise have no home. </td></tr>
    <tr><td class="paramname">data</td><td>Data pointer to pass to <em>callback</em>. </td></tr>
    <tr><td class="paramname">formatters</td><td>A bitmap of <a class="el" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814">stasis_subscription_message_formatters</a> we wish to receive.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>13.26.0 </dd>
<dd>
16.3.0</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If formatters are specified then the message router will remain in a selective filtering state. Any explicit routes will receive messages of their message type and the default callback will only receive messages that have one of the given formatters. Explicit routes will not be filtered according to the given formatters. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00397">397</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_route::callback</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00043">stasis_message_route::data</a>, <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00139">stasis_message_router::default_route</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01095">stasis_subscription_accept_formatters()</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00299">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>, <a class="el" href="../../dd/d79/stasis_8h_source.html#l00312">STASIS_SUBSCRIPTION_FORMATTER_NONE</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l01079">stasis_subscription_set_filter()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l00915">app_create()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l09053">manager_subscriptions_init()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00387">stasis_message_router_set_default()</a>.</p>
<div class="fragment"><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(router != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(callback != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#aaf3a92c10ab654d4a7b11cbf44aa1074">stasis_subscription_accept_formatters</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, formatters);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(router);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#adf345ce3957d7e90e288d40494c5fdb4">default_route</a>.<a class="code" href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">callback</a> = callback;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#adf345ce3957d7e90e288d40494c5fdb4">default_route</a>.<a class="code" href="../../d6/d05/structstasis__message__route.html#a735984d41155bc1032e09bece8f8d66d">data</a> = data;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(router);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">if</span> (formatters == <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e">STASIS_SUBSCRIPTION_FORMATTER_NONE</a>) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="comment">/* Formatters govern what messages the default callback get, so it is only if none is</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">       * specified that we accept all messages regardless.</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0f11df7f719d6b220647144b298b1d70">STASIS_SUBSCRIPTION_FILTER_FORCED_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00299">stasis.h:299</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="stasis_8h_html_aaf3a92c10ab654d4a7b11cbf44aa1074"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aaf3a92c10ab654d4a7b11cbf44aa1074">stasis_subscription_accept_formatters</a></div><div class="ttdeci">void stasis_subscription_accept_formatters(struct stasis_subscription *subscription, enum stasis_subscription_message_formatters formatters)</div><div class="ttdoc">Indicate to a subscription that we are interested in messages with one or more formatters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01095">stasis.c:1095</a></div></div>
<div class="ttc" id="structstasis__message__router_html_adf345ce3957d7e90e288d40494c5fdb4"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#adf345ce3957d7e90e288d40494c5fdb4">stasis_message_router::default_route</a></div><div class="ttdeci">struct stasis_message_route default_route</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00139">stasis_message_router.c:139</a></div></div>
<div class="ttc" id="structstasis__message__route_html_a8ef8d0e48190325c057f35cf776673e7"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html#a8ef8d0e48190325c057f35cf776673e7">stasis_message_route::callback</a></div><div class="ttdeci">stasis_subscription_cb callback</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00041">stasis_message_router.c:41</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814ac2632bea7a56a41dbe1f53995f59f78e">STASIS_SUBSCRIPTION_FORMATTER_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00312">stasis.h:312</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
<div class="ttc" id="structstasis__message__route_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d6/d05/structstasis__message__route.html#a735984d41155bc1032e09bece8f8d66d">stasis_message_route::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00043">stasis_message_router.c:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5646e370e39cc29f5faa7a30fda11159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5646e370e39cc29f5faa7a30fda11159">&#9670;&nbsp;</a></span>stasis_message_router_unsubscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_message_router_unsubscribe </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribe the router from the upstream topic. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to unsubscribe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00258">258</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d0/df4/stasis_8c_source.html#l00973">stasis_unsubscribe()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/d5e/res_2stasis_2app_8c_source.html#l01078">app_shutdown()</a>, <a class="el" href="../../d7/d4b/main_2endpoints_8c_source.html#l00350">ast_endpoint_shutdown()</a>, <a class="el" href="../../d6/dd1/test__devicestate_8c_source.html#l00511">AST_TEST_DEFINE()</a>, <a class="el" href="../../dd/d92/confbridge__manager_8c_source.html#l00698">manager_confbridge_shutdown()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01142">meetme_stasis_cleanup()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06011">remove_stasis_subscriptions()</a>, and <a class="el" href="../../da/dfb/app__queue_8c_source.html#l06514">setup_stasis_subs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="keywordflow">if</span> (!router) {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(router);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a> = <a class="code" href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(router);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="stasis_8h_html_a3498301077e2005383f0d261c471388b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3498301077e2005383f0d261c471388b">stasis_unsubscribe</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00973">stasis.c:973</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a641f77c471ff127e8586247ff6c0d64c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a641f77c471ff127e8586247ff6c0d64c">&#9670;&nbsp;</a></span>stasis_message_router_unsubscribe_and_join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stasis_message_router_unsubscribe_and_join </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *&#160;</td>
          <td class="paramname"><em>router</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unsubscribe the router from the upstream topic, blocking until the final message has been processed. </p>
<p>See <a class="el" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67" title="Cancel a subscription, blocking until the last message is processed. ">stasis_unsubscribe_and_join()</a> for info on when to use this vs. <a class="el" href="../../d4/d25/stasis__message__router_8h.html#a5646e370e39cc29f5faa7a30fda11159" title="Unsubscribe the router from the upstream topic. ">stasis_message_router_unsubscribe()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">router</td><td>Router to unsubscribe.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section since"><dt>Since</dt><dd>12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00269">269</a> of file <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html">stasis_message_router.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/df4/stasis_8c_source.html#l01136">stasis_unsubscribe_and_join()</a>, and <a class="el" href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router::subscription</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../db/d00/test__stasis_8c_source.html#l01505">AST_TEST_DEFINE()</a>, <a class="el" href="../../dc/df2/cdr_8c_source.html#l04385">cdr_engine_shutdown()</a>, <a class="el" href="../../d1/da4/res__corosync_8c_source.html#l01249">cleanup_module()</a>, <a class="el" href="../../da/dc9/cel_8c_source.html#l01416">destroy_routes()</a>, <a class="el" href="../../df/d10/manager__endpoints_8c_source.html#l00040">manager_endpoints_shutdown()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l08956">manager_shutdown()</a>, <a class="el" href="../../d6/d5d/pjsip__outbound__registrations_8c_source.html#l00323">pjsip_outbound_registration_metrics_unload_cb()</a>, and <a class="el" href="../../da/dfb/app__queue_8c_source.html#l11250">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;{</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="keywordflow">if</span> (!router) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(router-&gt;<a class="code" href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">subscription</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
<div class="ttc" id="structstasis__message__router_html_a5ab58be17fa287b0af6819e1b85697f3"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html#a5ab58be17fa287b0af6819e1b85697f3">stasis_message_router::subscription</a></div><div class="ttdeci">struct stasis_subscription * subscription</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00133">stasis_message_router.c:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:50 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
