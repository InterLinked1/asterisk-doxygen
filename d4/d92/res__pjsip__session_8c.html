<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: res_pjsip_session.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_7b47cca4d318623bb4270ab1fb592ef5.html">res</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">res_pjsip_session.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;pjsip.h&gt;</code><br />
<code>#include &lt;pjsip_ua.h&gt;</code><br />
<code>#include &lt;pjlib.h&gt;</code><br />
<code>#include &lt;pjmedia.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d8c/res__pjsip_8h_source.html">asterisk/res_pjsip.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html">asterisk/res_pjsip_session.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d20/res__pjsip__session__caps_8h_source.html">asterisk/res_pjsip_session_caps.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d47/callerid_8h_source.html">asterisk/callerid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/db6/datastore_8h_source.html">asterisk/datastore.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d8c/logger_8h_source.html">asterisk/logger.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/da5/astobj2_8h_source.html">asterisk/astobj2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d42/lock_8h_source.html">asterisk/lock.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d1d/uuid_8h_source.html">asterisk/uuid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/de0/pbx_8h_source.html">asterisk/pbx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d1e/taskprocessor_8h_source.html">asterisk/taskprocessor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/da3/causes_8h_source.html">asterisk/causes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d5f/sdp__srtp_8h_source.html">asterisk/sdp_srtp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d08/dsp_8h_source.html">asterisk/dsp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d59/acl_8h_source.html">asterisk/acl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/daa/include_2asterisk_2features__config_8h_source.html">asterisk/features_config.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/dbc/pickup_8h_source.html">asterisk/pickup.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/d95/stream_8h_source.html">asterisk/stream.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d68/vector_8h_source.html">asterisk/vector.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for res_pjsip_session.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/d9e/res__pjsip__session_8c__incl.png" border="0" usemap="#res__pjsip__session_8c" alt=""/></div>
<map name="res__pjsip__session_8c" id="res__pjsip__session_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="209,87,293,114"/>
<area shape="rect" id="node12" href="../../d8/d8c/res__pjsip_8h.html" title="asterisk/res_pjsip.h" alt="" coords="1664,87,1808,114"/>
<area shape="rect" id="node18" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="957,468,1083,495"/>
<area shape="rect" id="node19" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1202,543,1315,569"/>
<area shape="rect" id="node20" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1855,617,1982,644"/>
<area shape="rect" id="node24" href="../../d5/da5/astobj2_8h.html" title="asterisk/astobj2.h" alt="" coords="1829,319,1963,345"/>
<area shape="rect" id="node26" href="../../d9/db6/datastore_8h.html" title="Asterisk datastore objects. " alt="" coords="2619,319,2770,345"/>
<area shape="rect" id="node29" href="../../dd/d1d/uuid_8h.html" title="Universally unique identifier support. " alt="" coords="732,244,847,271"/>
<area shape="rect" id="node35" href="../../d8/d95/stream_8h.html" title="Media Stream API. " alt="" coords="1054,169,1189,196"/>
<area shape="rect" id="node37" href="../../d9/de7/res__pjsip__session_8h.html" title="asterisk/res_pjsip\l_session.h" alt="" coords="2690,80,2822,121"/>
<area shape="rect" id="node38" href="../../de/d5f/sdp__srtp_8h.html" title="SRTP and SDP Security descriptions. " alt="" coords="3113,169,3255,196"/>
<area shape="rect" id="node39" href="../../dd/d20/res__pjsip__session__caps_8h.html" title="asterisk/res_pjsip\l_session_caps.h" alt="" coords="2846,80,2978,121"/>
<area shape="rect" id="node40" href="../../de/d47/callerid_8h.html" title="CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr..." alt="" coords="3651,87,3784,114"/>
<area shape="rect" id="node42" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="496,244,632,271"/>
<area shape="rect" id="node43" href="../../db/de0/pbx_8h.html" title="Core PBX routines and definitions. " alt="" coords="2453,87,2563,114"/>
<area shape="rect" id="node44" href="../../d0/d1e/taskprocessor_8h.html" title="An API for managing task processing threads that can be shared across modules. " alt="" coords="3155,87,3333,114"/>
<area shape="rect" id="node45" href="../../d4/da3/causes_8h.html" title="Internal Asterisk hangup causes. " alt="" coords="3357,87,3491,114"/>
<area shape="rect" id="node46" href="../../d3/d08/dsp_8h.html" title="Convenient Signal Processing routines. " alt="" coords="3515,87,3626,114"/>
<area shape="rect" id="node47" href="../../d5/d59/acl_8h.html" title="Access Control of various sorts. " alt="" coords="3311,244,3417,271"/>
<area shape="rect" id="node48" href="../../d0/daa/include_2asterisk_2features__config_8h.html" title="asterisk/features_config.h" alt="" coords="1137,319,1324,345"/>
<area shape="rect" id="node49" href="../../dd/dbc/pickup_8h.html" title="Call Pickup API. " alt="" coords="3859,87,3989,114"/>
<area shape="rect" id="node50" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="4013,87,4126,114"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="5,169,160,196"/>
<area shape="rect" id="node4" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="233,468,370,495"/>
<area shape="rect" id="node7" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="235,169,370,196"/>
<area shape="rect" id="node5" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1045,617,1187,644"/>
<area shape="rect" id="node16" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1384,393,1541,420"/>
<area shape="rect" id="node21" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="2357,319,2504,345"/>
<area shape="rect" id="node22" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="2545,393,2695,420"/>
<area shape="rect" id="node23" href="../../d5/d7b/channel_8h.html" title="General Asterisk PBX channel definitions. " alt="" coords="1827,244,1965,271"/>
<area shape="rect" id="node27" href="../../d4/d61/endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1501,319,1651,345"/>
<area shape="rect" id="node28" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="896,169,1029,196"/>
<area shape="rect" id="node30" href="../../db/dc4/dnsmgr_8h.html" title="Background DNS update manager. " alt="" coords="2408,244,2544,271"/>
<area shape="rect" id="node31" href="../../d5/da1/udptl_8h.html" title="UDPTL support for T.38. " alt="" coords="2163,169,2283,196"/>
<area shape="rect" id="node32" href="../../d5/dde/rtp__engine_8h.html" title="Pluggable RTP Architecture. " alt="" coords="1990,244,2146,271"/>
<area shape="rect" id="node33" href="../../d9/d4a/stasis__channels_8h.html" title="asterisk/stasis_channels.h" alt="" coords="1315,169,1504,196"/>
<area shape="rect" id="node34" href="../../d7/d44/stasis__endpoints_8h.html" title="Endpoint abstractions. " alt="" coords="1365,244,1560,271"/>
<area shape="rect" id="node17" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1389,617,1536,644"/>
<area shape="rect" id="node25" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="999,319,1113,345"/>
<area shape="rect" id="node36" href="../../d1/d16/codec_8h.html" title="Codec API. " alt="" coords="2857,244,2983,271"/>
<area shape="rect" id="node41" href="../../d0/d0a/format_8h.html" title="Media Format API. " alt="" coords="2907,169,3037,196"/>
</map>
</div>
</div>
<p><a href="../../d4/d92/res__pjsip__session_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure used for sending delayed requests.  <a href="../../d5/dfa/structast__sip__session__delayed__request.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct controlling the suspension of the session's serializer.  <a href="../../dd/da0/structast__sip__session__suspender.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d09/structnew__invite.html">new_invite</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de0/structsip__session__media__bundle__group.html">sip_session_media_bundle_group</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bundle group building structure.  <a href="../../dd/de0/structsip__session__media__bundle__group.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a05c8571bd4931208b4910ee2dcb4b035"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>()</td></tr>
<tr class="separator:a05c8571bd4931208b4910ee2dcb4b035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39fcd37b99a8eafd0aa1c961d8736f88"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a39fcd37b99a8eafd0aa1c961d8736f88">DATASTORE_BUCKETS</a>&#160;&#160;&#160;53</td></tr>
<tr class="separator:a39fcd37b99a8eafd0aa1c961d8736f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3aa3a6565c9201950caa9a3f7b31a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5e3aa3a6565c9201950caa9a3f7b31a6">DEFAULT_NUM_SESSION_MEDIA</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a5e3aa3a6565c9201950caa9a3f7b31a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae69aae1e29fc058dac79e75743f1f927"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae69aae1e29fc058dac79e75743f1f927">FREE_STATE</a>()</td></tr>
<tr class="separator:ae69aae1e29fc058dac79e75743f1f927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb39c08deca8673d9d2e744dc87fd6d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(_stream)&#160;&#160;&#160;(_stream ? <a class="el" href="../../d8/d4d/stream_8c.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(_stream) : &quot;&quot;)</td></tr>
<tr class="separator:a2cb39c08deca8673d9d2e744dc87fd6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89bb30093935e2968abc2ebcfd59d1e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a89bb30093935e2968abc2ebcfd59d1e8">GET_STREAM_SAFE</a>(_topology,  _i)&#160;&#160;&#160;(_i &lt; <a class="el" href="../../d8/d4d/stream_8c.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(_topology) ? <a class="el" href="../../d8/d4d/stream_8c.html#a1f727f403d8899cdb55488a49c9b7841">ast_stream_topology_get_stream</a>(_topology, _i) : <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</td></tr>
<tr class="separator:a89bb30093935e2968abc2ebcfd59d1e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc8c0da7afa44b6f31850aad7bfaaa8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#afc8c0da7afa44b6f31850aad7bfaaa8e">GET_STREAM_STATE_SAFE</a>(_stream)&#160;&#160;&#160;(_stream ? <a class="el" href="../../d8/d4d/stream_8c.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(_stream) : <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47">AST_STREAM_STATE_END</a>)</td></tr>
<tr class="separator:afc8c0da7afa44b6f31850aad7bfaaa8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b5091467205f6fcc8347652088a1812"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a7b5091467205f6fcc8347652088a1812">MEDIA_BUCKETS</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:a7b5091467205f6fcc8347652088a1812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad52575b22f1c0988077001bd1cd37db0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad52575b22f1c0988077001bd1cd37db0">MOD_DATA_NAT_HOOK</a>&#160;&#160;&#160;&quot;nat_hook&quot;</td></tr>
<tr class="separator:ad52575b22f1c0988077001bd1cd37db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929623f98bee0fc9eb242c0bce08d227"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a929623f98bee0fc9eb242c0bce08d227">MOD_DATA_ON_RESPONSE</a>&#160;&#160;&#160;&quot;on_response&quot;</td></tr>
<tr class="separator:a929623f98bee0fc9eb242c0bce08d227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a067e52198c90bacbde0918721c8a8440"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a067e52198c90bacbde0918721c8a8440">print_debug_details</a>(inv,  tsx,  e)&#160;&#160;&#160;<a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a709bcdea84e4bec2f12ee64c2b6a3029">__print_debug_details</a>(__PRETTY_FUNCTION__, (inv), (tsx), (e))</td></tr>
<tr class="separator:a067e52198c90bacbde0918721c8a8440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6d34c98a864a1fbfc95c7c94772523c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(__num)</td></tr>
<tr class="separator:ac6d34c98a864a1fbfc95c7c94772523c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ecfcde443319d00e5bdbe30fed8c1d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a68ecfcde443319d00e5bdbe30fed8c1d">SDP_HANDLER_BUCKETS</a>&#160;&#160;&#160;11</td></tr>
<tr class="separator:a68ecfcde443319d00e5bdbe30fed8c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747da02675876a0e85ab971de1849bde"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a>(_stream_state)&#160;&#160;&#160;(_stream_state == <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47">AST_STREAM_STATE_END</a>)</td></tr>
<tr class="separator:a747da02675876a0e85ab971de1849bde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65ee9e13e68c4fc2191e0a67cee60b4e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a65ee9e13e68c4fc2191e0a67cee60b4e">STATE_REMOVED</a>(_stream_state)&#160;&#160;&#160;(_stream_state == <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>)</td></tr>
<tr class="separator:a65ee9e13e68c4fc2191e0a67cee60b4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54d2a76e6f2247e72619e26b239837d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a54d2a76e6f2247e72619e26b239837d4">STREAM_REMOVED</a>(_stream)&#160;&#160;&#160;(<a class="el" href="../../d8/d4d/stream_8c.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(_stream) == <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>)</td></tr>
<tr class="separator:a54d2a76e6f2247e72619e26b239837d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a5dad843b27d741d62518be05c259d9b4"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a> { <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>, 
<a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a>, 
<a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>
 }</td></tr>
<tr class="separator:a5dad843b27d741d62518be05c259d9b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba73dfdfaa94dc744be18ae4e8b01591"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591">sip_get_destination_result</a> { <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59">SIP_GET_DEST_EXTEN_FOUND</a>, 
<a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229">SIP_GET_DEST_EXTEN_NOT_FOUND</a>, 
<a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa">SIP_GET_DEST_EXTEN_PARTIAL</a>, 
<a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be">SIP_GET_DEST_UNSUPPORTED_URI</a>
 }</td></tr>
<tr class="separator:aba73dfdfaa94dc744be18ae4e8b01591"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a709bcdea84e4bec2f12ee64c2b6a3029"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a709bcdea84e4bec2f12ee64c2b6a3029">__print_debug_details</a> (const char *function, pjsip_inv_session *inv, pjsip_transaction *tsx, pjsip_event *e)</td></tr>
<tr class="separator:a709bcdea84e4bec2f12ee64c2b6a3029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77986e41ff1baa560a998e2b00e55f57"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a77986e41ff1baa560a998e2b00e55f57">add_bundle_groups</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pj_pool_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, pjmedia_sdp_session *<a class="el" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>)</td></tr>
<tr class="separator:a77986e41ff1baa560a998e2b00e55f57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55df57c5fbe99a5af456c2a9aaaccd20"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a55df57c5fbe99a5af456c2a9aaaccd20">add_sdp_streams</a> (struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjmedia_sdp_session *<a class="el" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>, const struct pjmedia_sdp_session *remote, struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream)</td></tr>
<tr class="separator:a55df57c5fbe99a5af456c2a9aaaccd20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95cafef155609ea0d35d60b178902941"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a95cafef155609ea0d35d60b178902941">ast_sip_channel_pvt_alloc</a> (void *pvt, struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a95cafef155609ea0d35d60b178902941"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new SIP channel pvt structure.  <a href="#a95cafef155609ea0d35d60b178902941">More...</a><br /></td></tr>
<tr class="separator:a95cafef155609ea0d35d60b178902941"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a908cdf7ba25c4d6f3d2efdf01f0125ca"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a908cdf7ba25c4d6f3d2efdf01f0125ca">ast_sip_dialog_get_session</a> (pjsip_dialog *dlg)</td></tr>
<tr class="memdesc:a908cdf7ba25c4d6f3d2efdf01f0125ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves a session from a dialog.  <a href="#a908cdf7ba25c4d6f3d2efdf01f0125ca">More...</a><br /></td></tr>
<tr class="separator:a908cdf7ba25c4d6f3d2efdf01f0125ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3bc4b6c4bdd1a98347a2b33a35b517"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a6d3bc4b6c4bdd1a98347a2b33a35b517">ast_sip_session_add_datastore</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore)</td></tr>
<tr class="memdesc:a6d3bc4b6c4bdd1a98347a2b33a35b517"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a datastore to a SIP session.  <a href="#a6d3bc4b6c4bdd1a98347a2b33a35b517">More...</a><br /></td></tr>
<tr class="separator:a6d3bc4b6c4bdd1a98347a2b33a35b517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ae79a585283a422b758eddcd9663c2"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab4ae79a585283a422b758eddcd9663c2">ast_sip_session_alloc</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="el" href="../../d9/d03/structcontact.html">contact</a>, pjsip_inv_session *inv_session, pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:ab4ae79a585283a422b758eddcd9663c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a new SIP session.  <a href="#ab4ae79a585283a422b758eddcd9663c2">More...</a><br /></td></tr>
<tr class="separator:ab4ae79a585283a422b758eddcd9663c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28af3f44693710b56fb141c509a5eb9d"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a28af3f44693710b56fb141c509a5eb9d">ast_sip_session_alloc_datastore</a> (const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> *info, const char *uid)</td></tr>
<tr class="memdesc:a28af3f44693710b56fb141c509a5eb9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Alternative for <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a>  <a href="#a28af3f44693710b56fb141c509a5eb9d">More...</a><br /></td></tr>
<tr class="separator:a28af3f44693710b56fb141c509a5eb9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73c173cbf6b282f81a445ed05050cb9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aa73c173cbf6b282f81a445ed05050cb9">ast_sip_session_create_invite</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data **tdata)</td></tr>
<tr class="memdesc:aa73c173cbf6b282f81a445ed05050cb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an INVITE request.  <a href="#aa73c173cbf6b282f81a445ed05050cb9">More...</a><br /></td></tr>
<tr class="separator:aa73c173cbf6b282f81a445ed05050cb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae415668ea4e21bd1a053dece640e2f46"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae415668ea4e21bd1a053dece640e2f46">ast_sip_session_create_outgoing</a> (struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *<a class="el" href="../../d9/d03/structcontact.html">contact</a>, const char *location, const char *request_user, struct <a class="el" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *req_topology)</td></tr>
<tr class="memdesc:ae415668ea4e21bd1a053dece640e2f46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new outgoing SIP session.  <a href="#ae415668ea4e21bd1a053dece640e2f46">More...</a><br /></td></tr>
<tr class="separator:ae415668ea4e21bd1a053dece640e2f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab099805fb795c60964dff130d6d15165"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab099805fb795c60964dff130d6d15165">ast_sip_session_defer_termination</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:ab099805fb795c60964dff130d6d15165"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defer local termination of a session until remote side terminates, or an amount of time passes.  <a href="#ab099805fb795c60964dff130d6d15165">More...</a><br /></td></tr>
<tr class="separator:ab099805fb795c60964dff130d6d15165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a587c035e9aae3bf37049f886dc29dcb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a587c035e9aae3bf37049f886dc29dcb6">ast_sip_session_defer_termination_cancel</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a587c035e9aae3bf37049f886dc29dcb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cancel a pending deferred termination.  <a href="#a587c035e9aae3bf37049f886dc29dcb6">More...</a><br /></td></tr>
<tr class="separator:a587c035e9aae3bf37049f886dc29dcb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55296422ab86c7de1d7f52e9c227d82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aa55296422ab86c7de1d7f52e9c227d82">ast_sip_session_end_if_deferred</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:aa55296422ab86c7de1d7f52e9c227d82"><td class="mdescLeft">&#160;</td><td class="mdescRight">End the session if it had been previously deferred.  <a href="#aa55296422ab86c7de1d7f52e9c227d82">More...</a><br /></td></tr>
<tr class="separator:aa55296422ab86c7de1d7f52e9c227d82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6e787aa2429e93f12e7be624ec3970"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a0b6e787aa2429e93f12e7be624ec3970">ast_sip_session_get_datastore</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a0b6e787aa2429e93f12e7be624ec3970"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a session datastore.  <a href="#a0b6e787aa2429e93f12e7be624ec3970">More...</a><br /></td></tr>
<tr class="separator:a0b6e787aa2429e93f12e7be624ec3970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95797137ac1484fe2214be36db22f6dd"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a> (const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:a95797137ac1484fe2214be36db22f6dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the channel or endpoint name associated with the session.  <a href="#a95797137ac1484fe2214be36db22f6dd">More...</a><br /></td></tr>
<tr class="separator:a95797137ac1484fe2214be36db22f6dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d96ab8cbcc0f85012300573e3db2900"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a> (const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream)</td></tr>
<tr class="memdesc:a4d96ab8cbcc0f85012300573e3db2900"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines if a provided pending stream will be the default stream or not.  <a href="#a4d96ab8cbcc0f85012300573e3db2900">More...</a><br /></td></tr>
<tr class="separator:a4d96ab8cbcc0f85012300573e3db2900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bfa7d54f046b76d00644d3e650af6cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a6bfa7d54f046b76d00644d3e650af6cd">ast_sip_session_media_add_read_callback</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, int fd, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#afd7121d8247121ec6170e3411bdd98da">ast_sip_session_media_read_cb</a> callback)</td></tr>
<tr class="memdesc:a6bfa7d54f046b76d00644d3e650af6cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a read callback for a media session with a specific file descriptor.  <a href="#a6bfa7d54f046b76d00644d3e650af6cd">More...</a><br /></td></tr>
<tr class="separator:a6bfa7d54f046b76d00644d3e650af6cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29930c927d55f4f7a615a11766a6a09"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aa29930c927d55f4f7a615a11766a6a09">ast_sip_session_media_get_transport</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media)</td></tr>
<tr class="memdesc:aa29930c927d55f4f7a615a11766a6a09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the underlying media session that is acting as transport for a media session.  <a href="#aa29930c927d55f4f7a615a11766a6a09">More...</a><br /></td></tr>
<tr class="separator:aa29930c927d55f4f7a615a11766a6a09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae799be93a0bc786802a9404362b236fa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae799be93a0bc786802a9404362b236fa">ast_sip_session_media_set_write_callback</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ab727426f5a9d91957363388912fe378d">ast_sip_session_media_write_cb</a> callback)</td></tr>
<tr class="memdesc:ae799be93a0bc786802a9404362b236fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a write callback for a media session.  <a href="#ae799be93a0bc786802a9404362b236fa">More...</a><br /></td></tr>
<tr class="separator:ae799be93a0bc786802a9404362b236fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0018e2a2f5cae3abe84426c44fee908"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state, enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, int position)</td></tr>
<tr class="memdesc:ae0018e2a2f5cae3abe84426c44fee908"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate an ast_session_media and add it to the media state's vector.  <a href="#ae0018e2a2f5cae3abe84426c44fee908">More...</a><br /></td></tr>
<tr class="separator:ae0018e2a2f5cae3abe84426c44fee908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9996be2e7d0a6fe7df55098932f5f6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a> (void)</td></tr>
<tr class="memdesc:a0a9996be2e7d0a6fe7df55098932f5f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a session media state structure.  <a href="#a0a9996be2e7d0a6fe7df55098932f5f6">More...</a><br /></td></tr>
<tr class="separator:a0a9996be2e7d0a6fe7df55098932f5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c9ec6c960e59090e7c6301c1bce890"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a> (const struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:a76c9ec6c960e59090e7c6301c1bce890"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clone a media state.  <a href="#a76c9ec6c960e59090e7c6301c1bce890">More...</a><br /></td></tr>
<tr class="separator:a76c9ec6c960e59090e7c6301c1bce890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a52106819ac5621fe89579644d4afd3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a> (struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:a8a52106819ac5621fe89579644d4afd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a session media state structure.  <a href="#a8a52106819ac5621fe89579644d4afd3">More...</a><br /></td></tr>
<tr class="separator:a8a52106819ac5621fe89579644d4afd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02f331ac12ec53a9f072a9862405055"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a> (struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:ae02f331ac12ec53a9f072a9862405055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset a media state to a clean state.  <a href="#ae02f331ac12ec53a9f072a9862405055">More...</a><br /></td></tr>
<tr class="separator:ae02f331ac12ec53a9f072a9862405055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af57bfc75550b1312b46ef584410ae8a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *sip_session, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:af57bfc75550b1312b46ef584410ae8a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a media stats.  <a href="#af57bfc75550b1312b46ef584410ae8a9">More...</a><br /></td></tr>
<tr class="separator:af57bfc75550b1312b46ef584410ae8a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45a3852c5bef6bf3719080907f02a42"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae45a3852c5bef6bf3719080907f02a42">ast_sip_session_refresh</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a> on_request_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a> on_sdp_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response, enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0d">ast_sip_session_refresh_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, int generate_new_sdp, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state)</td></tr>
<tr class="memdesc:ae45a3852c5bef6bf3719080907f02a42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a reinvite or UPDATE on a session.  <a href="#ae45a3852c5bef6bf3719080907f02a42">More...</a><br /></td></tr>
<tr class="separator:ae45a3852c5bef6bf3719080907f02a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c6ebf48a77449c1058861ff70a958a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a11c6ebf48a77449c1058861ff70a958a">ast_sip_session_regenerate_answer</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a> on_sdp_creation)</td></tr>
<tr class="memdesc:a11c6ebf48a77449c1058861ff70a958a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regenerate SDP Answer.  <a href="#a11c6ebf48a77449c1058861ff70a958a">More...</a><br /></td></tr>
<tr class="separator:a11c6ebf48a77449c1058861ff70a958a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30cf6ad5b4d5ad87ecfeb571a24fe8f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a30cf6ad5b4d5ad87ecfeb571a24fe8f8">ast_sip_session_register_sdp_handler</a> (struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, const char *stream_type)</td></tr>
<tr class="memdesc:a30cf6ad5b4d5ad87ecfeb571a24fe8f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register an SDP handler.  <a href="#a30cf6ad5b4d5ad87ecfeb571a24fe8f8">More...</a><br /></td></tr>
<tr class="separator:a30cf6ad5b4d5ad87ecfeb571a24fe8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80752332a327901006cee3a209c03968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a80752332a327901006cee3a209c03968">ast_sip_session_remove_datastore</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="memdesc:a80752332a327901006cee3a209c03968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove a session datastore from the session.  <a href="#a80752332a327901006cee3a209c03968">More...</a><br /></td></tr>
<tr class="separator:a80752332a327901006cee3a209c03968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add9e11223bb5b1c0e9ca30678e97dc0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#add9e11223bb5b1c0e9ca30678e97dc0f">ast_sip_session_resume_reinvite</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:add9e11223bb5b1c0e9ca30678e97dc0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resumes processing of a deferred incoming re-invite.  <a href="#add9e11223bb5b1c0e9ca30678e97dc0f">More...</a><br /></td></tr>
<tr class="separator:add9e11223bb5b1c0e9ca30678e97dc0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a7aa9427f3aea9384c1a481ce6a5f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="memdesc:a35a7aa9427f3aea9384c1a481ce6a5f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a SIP request.  <a href="#a35a7aa9427f3aea9384c1a481ce6a5f3">More...</a><br /></td></tr>
<tr class="separator:a35a7aa9427f3aea9384c1a481ce6a5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e71dd1b8a6901e044953ff9e3a0343d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response)</td></tr>
<tr class="memdesc:a6e71dd1b8a6901e044953ff9e3a0343d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a SIP request and get called back when a response is received.  <a href="#a6e71dd1b8a6901e044953ff9e3a0343d">More...</a><br /></td></tr>
<tr class="separator:a6e71dd1b8a6901e044953ff9e3a0343d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed4c9a6bf6967790981c02027f5f02e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="memdesc:aed4c9a6bf6967790981c02027f5f02e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a SIP response.  <a href="#aed4c9a6bf6967790981c02027f5f02e8">More...</a><br /></td></tr>
<tr class="separator:aed4c9a6bf6967790981c02027f5f02e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07a4b2b3de4cbbd66b09acb55ca3c5e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#af07a4b2b3de4cbbd66b09acb55ca3c5e">ast_sip_session_suspend</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:af07a4b2b3de4cbbd66b09acb55ca3c5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request and wait for the session serializer to be suspended.  <a href="#af07a4b2b3de4cbbd66b09acb55ca3c5e">More...</a><br /></td></tr>
<tr class="separator:af07a4b2b3de4cbbd66b09acb55ca3c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac548e363175ba43f7ad75438729deac3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, int response)</td></tr>
<tr class="memdesc:ac548e363175ba43f7ad75438729deac3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminate a session and, if possible, send the provided response code.  <a href="#ac548e363175ba43f7ad75438729deac3">More...</a><br /></td></tr>
<tr class="separator:ac548e363175ba43f7ad75438729deac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22d632ac85810d8394ad5d54b83a2f87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a22d632ac85810d8394ad5d54b83a2f87">ast_sip_session_unregister_sdp_handler</a> (struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>, const char *stream_type)</td></tr>
<tr class="memdesc:a22d632ac85810d8394ad5d54b83a2f87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unregister an SDP handler.  <a href="#a22d632ac85810d8394ad5d54b83a2f87">More...</a><br /></td></tr>
<tr class="separator:a22d632ac85810d8394ad5d54b83a2f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac37f93342a3e8ca33fb4ca84d4ac3e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac37f93342a3e8ca33fb4ca84d4ac3e58">ast_sip_session_unsuspend</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="memdesc:ac37f93342a3e8ca33fb4ca84d4ac3e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request the session serializer be unsuspended.  <a href="#ac37f93342a3e8ca33fb4ca84d4ac3e58">More...</a><br /></td></tr>
<tr class="separator:ac37f93342a3e8ca33fb4ca84d4ac3e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8dc97b95461d434eb34460bac58036"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#abe8dc97b95461d434eb34460bac58036">AST_TEST_DEFINE</a> (test_resolve_refresh_media_states)</td></tr>
<tr class="separator:abe8dc97b95461d434eb34460bac58036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a31909df5d02859b03a0933131828a3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a0a31909df5d02859b03a0933131828a3">check_content_disposition</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a0a31909df5d02859b03a0933131828a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3b97913f8c270c46f5bfb240471b80"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a2c3b97913f8c270c46f5bfb240471b80">check_content_disposition_in_multipart</a> (pjsip_multipart_part *part)</td></tr>
<tr class="separator:a2c3b97913f8c270c46f5bfb240471b80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2c628c905cb48254948233bf6b13e9a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae2c628c905cb48254948233bf6b13e9a">check_delayed_requests</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, int(*cb)(void *vsession))</td></tr>
<tr class="separator:ae2c628c905cb48254948233bf6b13e9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8abc4564c04174e2a18fbf190cbf051"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab8abc4564c04174e2a18fbf190cbf051">check_request_status</a> (pjsip_inv_session *inv, pjsip_event *e)</td></tr>
<tr class="separator:ab8abc4564c04174e2a18fbf190cbf051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac85e74edae381bd1f6b54af290a9b842"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac85e74edae381bd1f6b54af290a9b842">check_sdp_content_type_supported</a> (pjsip_media_type *content_type)</td></tr>
<tr class="separator:ac85e74edae381bd1f6b54af290a9b842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03b4a0d3ef8e1a50d76725863248cb0c"><td class="memItemLeft" align="right" valign="top">static struct pjmedia_sdp_session *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a> (pjsip_inv_session *inv, struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const pjmedia_sdp_session *offer)</td></tr>
<tr class="separator:a03b4a0d3ef8e1a50d76725863248cb0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac60c8c7a11b9aa2b347630c7d08af17d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac60c8c7a11b9aa2b347630c7d08af17d">datastore_cmp</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:ac60c8c7a11b9aa2b347630c7d08af17d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae586d6908c81e9a59e0e68358c12c9cc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae586d6908c81e9a59e0e68358c12c9cc">datastore_hash</a> (const void *obj, int flags)</td></tr>
<tr class="separator:ae586d6908c81e9a59e0e68358c12c9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a7a6a1e5210478116a640b215ef53b4"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a> on_request, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a> on_sdp_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response, int generate_new_sdp, enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *pending_media_state, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *active_media_state, int queue_head)</td></tr>
<tr class="separator:a3a7a6a1e5210478116a640b215ef53b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a511a1f5d1b239c41b9eb4953ae4386ea"><td class="memItemLeft" align="right" valign="top">static const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a> (enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>)</td></tr>
<tr class="separator:a511a1f5d1b239c41b9eb4953ae4386ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8484802d8796789080e644555eb2d04"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aa8484802d8796789080e644555eb2d04">delayed_request_alloc</a> (enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a> on_request_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a> on_sdp_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response, int generate_new_sdp, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *pending_media_state, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *active_media_state)</td></tr>
<tr class="separator:aa8484802d8796789080e644555eb2d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb87d2e0451ce7382da2c5b23525c73"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a> (struct <a class="el" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay)</td></tr>
<tr class="separator:abdb87d2e0451ce7382da2c5b23525c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfed42a1933e5cd396c5125d2199a14a"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a> (const pj_str_t *<a class="el" href="../../de/d96/res__pjsip_8c.html#a6fdb6e6429a5f709f3b99541190b52c2">message_method</a>, const char *supplement_method)</td></tr>
<tr class="separator:adfed42a1933e5cd396c5125d2199a14a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b830933f0110c5ea0a2c71d1c50b43"><td class="memItemLeft" align="right" valign="top">static pjmedia_sdp_session *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a36b830933f0110c5ea0a2c71d1c50b43">generate_session_refresh_sdp</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="separator:a36b830933f0110c5ea0a2c71d1c50b43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6164e7cb4f4be9ee46724fbdcdd86736"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591">sip_get_destination_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a6164e7cb4f4be9ee46724fbdcdd86736">get_destination</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:a6164e7cb4f4be9ee46724fbdcdd86736"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine where in the dialplan a call should go.  <a href="#a6164e7cb4f4be9ee46724fbdcdd86736">More...</a><br /></td></tr>
<tr class="separator:a6164e7cb4f4be9ee46724fbdcdd86736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a1c15e1dafd2d9d7998acd2b86c1a63"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a9a1c15e1dafd2d9d7998acd2b86c1a63">get_mid_bundle_group</a> (const pjmedia_sdp_session *sdp, const char *mid)</td></tr>
<tr class="separator:a9a1c15e1dafd2d9d7998acd2b86c1a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a19b2f0b2cac772a583a0d31fa434b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae8a19b2f0b2cac772a583a0d31fa434b">handle_incoming</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata, enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195">ast_sip_session_response_priority</a> response_priority)</td></tr>
<tr class="separator:ae8a19b2f0b2cac772a583a0d31fa434b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de6afbe09b1067f050db3c76437be3e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a2de6afbe09b1067f050db3c76437be3e">handle_incoming_before_media</a> (pjsip_inv_session *inv, struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a2de6afbe09b1067f050db3c76437be3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10082c2a0d8b402ea1df1e65c8482ba6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a10082c2a0d8b402ea1df1e65c8482ba6">handle_incoming_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a10082c2a0d8b402ea1df1e65c8482ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01a8f0fed9b24e7b12f7d8a254b3477"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad01a8f0fed9b24e7b12f7d8a254b3477">handle_incoming_response</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_rx_data *rdata, enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195">ast_sip_session_response_priority</a> response_priority)</td></tr>
<tr class="separator:ad01a8f0fed9b24e7b12f7d8a254b3477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a148cffe818b8c47b8233c0c118c116a0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a148cffe818b8c47b8233c0c118c116a0">handle_incoming_sdp</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const pjmedia_sdp_session *sdp)</td></tr>
<tr class="separator:a148cffe818b8c47b8233c0c118c116a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22010f3c564b39568a2645c06386a7f0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a22010f3c564b39568a2645c06386a7f0">handle_negotiated_sdp</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const pjmedia_sdp_session *local, const pjmedia_sdp_session *remote)</td></tr>
<tr class="separator:a22010f3c564b39568a2645c06386a7f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a129af2ac549f40d07d2b7e255b251530"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a129af2ac549f40d07d2b7e255b251530">handle_negotiated_sdp_session_media</a> (struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const pjmedia_sdp_session *local, const pjmedia_sdp_session *remote, int index, struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *asterisk_stream)</td></tr>
<tr class="separator:a129af2ac549f40d07d2b7e255b251530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dfc090cd99367d160beb9518970c0e3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a4dfc090cd99367d160beb9518970c0e3">handle_new_invite_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a4dfc090cd99367d160beb9518970c0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b7d51bdf278a523bbaa5086302552b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae1b7d51bdf278a523bbaa5086302552b">handle_outgoing_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:ae1b7d51bdf278a523bbaa5086302552b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a7f2c555647574c05995ba10788c17"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac8a7f2c555647574c05995ba10788c17">handle_outgoing_response</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, pjsip_tx_data *tdata)</td></tr>
<tr class="separator:ac8a7f2c555647574c05995ba10788c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3533f635938c655112221b97eac4884a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a3533f635938c655112221b97eac4884a">handle_session_begin</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="separator:a3533f635938c655112221b97eac4884a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e81e5efda52a0a77616b0490de568c0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a3e81e5efda52a0a77616b0490de568c0">handle_session_destroy</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="separator:a3e81e5efda52a0a77616b0490de568c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70392ec2e318f5b34273e578fb122d1e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a70392ec2e318f5b34273e578fb122d1e">handle_session_end</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="separator:a70392ec2e318f5b34273e578fb122d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade348d7dc427f391b1e1d86e23cd614c"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ade348d7dc427f391b1e1d86e23cd614c">has_supplement</a> (const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const pjsip_rx_data *rdata)</td></tr>
<tr class="separator:ade348d7dc427f391b1e1d86e23cd614c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8fb456164755b6c4fc3df83e70c805c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a> (size_t <a class="el" href="../../d3/d0a/structsessions.html">sessions</a>, size_t read_callbacks)</td></tr>
<tr class="separator:ad8fb456164755b6c4fc3df83e70c805c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9fd4f3956c10f6728e85fb62c57703"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a0a9fd4f3956c10f6728e85fb62c57703">invite_collision_timeout</a> (void *vsession)</td></tr>
<tr class="separator:a0a9fd4f3956c10f6728e85fb62c57703"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab41b92c23f551a348423f5c0721d963a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab41b92c23f551a348423f5c0721d963a">invite_proceeding</a> (void *vsession)</td></tr>
<tr class="separator:ab41b92c23f551a348423f5c0721d963a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70774e88c7455a8dae6a9b8878916abd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a70774e88c7455a8dae6a9b8878916abd">invite_terminated</a> (void *vsession)</td></tr>
<tr class="separator:a70774e88c7455a8dae6a9b8878916abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92df7a5cec6415bf61773b6a2fdc2043"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a92df7a5cec6415bf61773b6a2fdc2043">is_media_state_valid</a> (const char *session_name, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *<a class="el" href="../../d4/d88/structstate.html">state</a>)</td></tr>
<tr class="separator:a92df7a5cec6415bf61773b6a2fdc2043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8f4c88669e6520cc93dda53b5635eb0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad8f4c88669e6520cc93dda53b5635eb0">is_stream_limitation_reached</a> (enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, const struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint, int *type_streams)</td></tr>
<tr class="separator:ad8f4c88669e6520cc93dda53b5635eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a75356a9f850bf7c497f8a963719457"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a2a75356a9f850bf7c497f8a963719457">media_stats_local_ssrc_cmp</a> (const struct <a class="el" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a> *vec_elem, const struct <a class="el" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a> *srch)</td></tr>
<tr class="separator:a2a75356a9f850bf7c497f8a963719457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9e5a5b3898c8806dcc54e3615df7de"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a0e9e5a5b3898c8806dcc54e3615df7de">new_invite</a> (struct <a class="el" href="../../db/d09/structnew__invite.html">new_invite</a> *invite)</td></tr>
<tr class="separator:a0e9e5a5b3898c8806dcc54e3615df7de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d8c9900de369edecd27e4471403e96"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad5d8c9900de369edecd27e4471403e96">new_invite_initial_answer</a> (pjsip_inv_session *inv_session, pjsip_rx_data *rdata, int answer_code, int terminate_code, pj_bool_t notify)</td></tr>
<tr class="separator:ad5d8c9900de369edecd27e4471403e96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a891fa1c68e014308f0bddde4da12da"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a3a891fa1c68e014308f0bddde4da12da">outbound_invite_auth</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a3a891fa1c68e014308f0bddde4da12da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0487787344caa44e95895bfe5b4d0a"><td class="memItemLeft" align="right" valign="top">static pjsip_inv_session *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a8c0487787344caa44e95895bfe5b4d0a">pre_session_setup</a> (pjsip_rx_data *rdata, const struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *endpoint)</td></tr>
<tr class="separator:a8c0487787344caa44e95895bfe5b4d0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0989647a11cd5cd082cf357a387c47a7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a0989647a11cd5cd082cf357a387c47a7">remove_handler</a> (void *obj, void *arg, void *data, int flags)</td></tr>
<tr class="separator:a0989647a11cd5cd082cf357a387c47a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2fe0223b328b94024025dfaca810bf0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac2fe0223b328b94024025dfaca810bf0">remove_stream_from_bundle</a> (struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream)</td></tr>
<tr class="separator:ac2fe0223b328b94024025dfaca810bf0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee39c44155dc7a15414bdc64dc86127d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aee39c44155dc7a15414bdc64dc86127d">reschedule_reinvite</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response)</td></tr>
<tr class="separator:aee39c44155dc7a15414bdc64dc86127d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff50a4e69bc83a7722fc43132e70b6a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aeff50a4e69bc83a7722fc43132e70b6a">resend_reinvite</a> (pj_timer_heap_t *<a class="el" href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>, pj_timer_entry *<a class="el" href="../../d3/d96/structentry.html">entry</a>)</td></tr>
<tr class="separator:aeff50a4e69bc83a7722fc43132e70b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4bf8de5db02001daabfc303b49c6d3a"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac4bf8de5db02001daabfc303b49c6d3a">resolve_refresh_media_states</a> (const char *session_name, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *delayed_pending_state, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *delayed_active_state, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *current_active_state, int run_post_validation)</td></tr>
<tr class="separator:ac4bf8de5db02001daabfc303b49c6d3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a402de077579a28f56ed42213f8b76c27"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a402de077579a28f56ed42213f8b76c27">sdp_handler_list_cmp</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:a402de077579a28f56ed42213f8b76c27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c73481a00684ae28b5c0eae9e1c07ca"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a9c73481a00684ae28b5c0eae9e1c07ca">sdp_handler_list_hash</a> (const void *obj, int flags)</td></tr>
<tr class="separator:a9c73481a00684ae28b5c0eae9e1c07ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4229c2f5de34a490931841d187ad0625"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a4229c2f5de34a490931841d187ad0625">sdp_requires_deferral</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, const pjmedia_sdp_session *sdp)</td></tr>
<tr class="memdesc:a4229c2f5de34a490931841d187ad0625"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine whether the SDP provided requires deferral of negotiating or not.  <a href="#a4229c2f5de34a490931841d187ad0625">More...</a><br /></td></tr>
<tr class="separator:a4229c2f5de34a490931841d187ad0625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf4b150696c1bfae6887edc478f6ee1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a7cf4b150696c1bfae6887edc478f6ee1">send_delayed_request</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay)</td></tr>
<tr class="separator:a7cf4b150696c1bfae6887edc478f6ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb6b8967d5861edcb38d2a36ad3349b7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#adb6b8967d5861edcb38d2a36ad3349b7">session_datastore_destroy</a> (void *obj)</td></tr>
<tr class="separator:adb6b8967d5861edcb38d2a36ad3349b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d2190ae1fcb37e66c2a445f2fe59ec3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a> (void *obj)</td></tr>
<tr class="separator:a6d2190ae1fcb37e66c2a445f2fe59ec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad11de1bfcc9846e016339bd3b482d16f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a> (void *vsession)</td></tr>
<tr class="separator:ad11de1bfcc9846e016339bd3b482d16f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a219b1d1405e2e3799cc9c784154c688d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a> (void *vsession)</td></tr>
<tr class="separator:a219b1d1405e2e3799cc9c784154c688d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9c8de50ba0b0f1ab0c6a46d914e726"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#afe9c8de50ba0b0f1ab0c6a46d914e726">session_end_if_disconnected</a> (int <a class="el" href="../../d1/da4/res__corosync_8c.html#a2465fd4497a7402ad72da7d6e03f9934">id</a>, pjsip_inv_session *inv)</td></tr>
<tr class="separator:afe9c8de50ba0b0f1ab0c6a46d914e726"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6127f7b1b0fba27dfad92635ec32a199"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a6127f7b1b0fba27dfad92635ec32a199">session_inv_on_create_offer</a> (pjsip_inv_session *inv, pjmedia_sdp_session **p_offer)</td></tr>
<tr class="separator:a6127f7b1b0fba27dfad92635ec32a199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05fd614286dc0661485d46f1c3e5efba"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a05fd614286dc0661485d46f1c3e5efba">session_inv_on_media_update</a> (pjsip_inv_session *inv, pj_status_t <a class="el" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>)</td></tr>
<tr class="separator:a05fd614286dc0661485d46f1c3e5efba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03acea3f63b790f2a2ba54a8387b984"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac03acea3f63b790f2a2ba54a8387b984">session_inv_on_new_session</a> (pjsip_inv_session *inv, pjsip_event *e)</td></tr>
<tr class="separator:ac03acea3f63b790f2a2ba54a8387b984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d25e1ea1f248eb282bf949009bff30f"><td class="memItemLeft" align="right" valign="top">static pjsip_redirect_op&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a2d25e1ea1f248eb282bf949009bff30f">session_inv_on_redirected</a> (pjsip_inv_session *inv, const pjsip_uri *target, const pjsip_event *e)</td></tr>
<tr class="separator:a2d25e1ea1f248eb282bf949009bff30f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab76b5dd0de912abb513039dba97d5e5a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab76b5dd0de912abb513039dba97d5e5a">session_inv_on_rx_offer</a> (pjsip_inv_session *inv, const pjmedia_sdp_session *offer)</td></tr>
<tr class="separator:ab76b5dd0de912abb513039dba97d5e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab75bfd716f60c416a982360033124f06"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab75bfd716f60c416a982360033124f06">session_inv_on_state_changed</a> (pjsip_inv_session *inv, pjsip_event *e)</td></tr>
<tr class="separator:ab75bfd716f60c416a982360033124f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4177e5337aad4d81ab4f9ddfa902c78"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab4177e5337aad4d81ab4f9ddfa902c78">session_inv_on_tsx_state_changed</a> (pjsip_inv_session *inv, pjsip_transaction *tsx, pjsip_event *e)</td></tr>
<tr class="separator:ab4177e5337aad4d81ab4f9ddfa902c78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1020cea0d78fe4969869c10fd93973"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a7a1020cea0d78fe4969869c10fd93973">session_media_dtor</a> (void *obj)</td></tr>
<tr class="separator:a7a1020cea0d78fe4969869c10fd93973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a547f07821c13f67174cb535888d98c0c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a> (struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="el" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>)</td></tr>
<tr class="memdesc:a547f07821c13f67174cb535888d98c0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set an SDP stream handler for a corresponding session media.  <a href="#a547f07821c13f67174cb535888d98c0c">More...</a><br /></td></tr>
<tr class="separator:a547f07821c13f67174cb535888d98c0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e8c771a73013db7cff9add152ed684a"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a3e8c771a73013db7cff9add152ed684a">session_on_rx_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="memdesc:a3e8c771a73013db7cff9add152ed684a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called when a new SIP request comes into PJSIP.  <a href="#a3e8c771a73013db7cff9add152ed684a">More...</a><br /></td></tr>
<tr class="separator:a3e8c771a73013db7cff9add152ed684a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0fa0b18110b8d1525e69d1301846c0f"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ae0fa0b18110b8d1525e69d1301846c0f">session_on_rx_response</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:ae0fa0b18110b8d1525e69d1301846c0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0a65ae9b174424d52db92d6dc8f243f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac0a65ae9b174424d52db92d6dc8f243f">session_on_tsx_state</a> (pjsip_transaction *tsx, pjsip_event *e)</td></tr>
<tr class="separator:ac0a65ae9b174424d52db92d6dc8f243f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af218de4dc85933870fdfe1d91af9261e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#af218de4dc85933870fdfe1d91af9261e">session_outgoing_nat_hook</a> (pjsip_tx_data *tdata, struct <a class="el" href="../../d1/d04/structast__sip__transport.html">ast_sip_transport</a> *transport)</td></tr>
<tr class="memdesc:af218de4dc85933870fdfe1d91af9261e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hook for modifying outgoing messages with SDP to contain the proper address information.  <a href="#af218de4dc85933870fdfe1d91af9261e">More...</a><br /></td></tr>
<tr class="separator:af218de4dc85933870fdfe1d91af9261e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f0a675880777396a49d0da4b96ec06"><td class="memItemLeft" align="right" valign="top">static pj_bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a24f0a675880777396a49d0da4b96ec06">session_reinvite_on_rx_request</a> (pjsip_rx_data *rdata)</td></tr>
<tr class="separator:a24f0a675880777396a49d0da4b96ec06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79606e824455a241d8eaaeef6bcc0a7c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a79606e824455a241d8eaaeef6bcc0a7c">session_termination_cb</a> (pj_timer_heap_t *<a class="el" href="../../d9/d21/res__rtp__asterisk_8c.html#ae9f993fcad1fd49cb50f4a541101ccb7">timer_heap</a>, struct pj_timer_entry *<a class="el" href="../../d3/d96/structentry.html">entry</a>)</td></tr>
<tr class="separator:a79606e824455a241d8eaaeef6bcc0a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31dd7857532c4cdbb2c3e9dec443f62e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a31dd7857532c4cdbb2c3e9dec443f62e">session_termination_task</a> (void *data)</td></tr>
<tr class="separator:a31dd7857532c4cdbb2c3e9dec443f62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74185467f13d0fd3860ef8a8762ca49d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a74185467f13d0fd3860ef8a8762ca49d">set_from_header</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="separator:a74185467f13d0fd3860ef8a8762ca49d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b505dccfd3df8fb39e5819af569046c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a0b505dccfd3df8fb39e5819af569046c">set_mid_and_bundle_group</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, const pjmedia_sdp_session *sdp, const struct pjmedia_sdp_media *stream)</td></tr>
<tr class="separator:a0b505dccfd3df8fb39e5819af569046c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba55edb1fef9239c00fe063a1c9367d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#abba55edb1fef9239c00fe063a1c9367d">set_remote_mslabel_and_stream_group</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media, const pjmedia_sdp_session *sdp, const struct pjmedia_sdp_media *stream, struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *asterisk_stream)</td></tr>
<tr class="separator:abba55edb1fef9239c00fe063a1c9367d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4937945ffae151bc235182493d104c8c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a4937945ffae151bc235182493d104c8c">setup_outbound_invite_auth</a> (pjsip_dialog *dlg)</td></tr>
<tr class="separator:a4937945ffae151bc235182493d104c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92471759f1f84a29c1cf773bb83b7807"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a92471759f1f84a29c1cf773bb83b7807">sip_channel_destroy</a> (void *obj)</td></tr>
<tr class="memdesc:a92471759f1f84a29c1cf773bb83b7807"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for SIP channel.  <a href="#a92471759f1f84a29c1cf773bb83b7807">More...</a><br /></td></tr>
<tr class="separator:a92471759f1f84a29c1cf773bb83b7807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd0100b8c103a8d8633eb0db236f6af"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a8bd0100b8c103a8d8633eb0db236f6af">sip_session_defer_termination_stop_timer</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</td></tr>
<tr class="separator:a8bd0100b8c103a8d8633eb0db236f6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d68a08d3f45966f9c90fa2903aed739"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a> (struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a> on_request_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a> on_sdp_creation, <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> on_response, enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0d">ast_sip_session_refresh_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, int generate_new_sdp, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *pending_media_state, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *active_media_state, int queued)</td></tr>
<tr class="separator:a9d68a08d3f45966f9c90fa2903aed739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5355aaa265e4a9ef57068b7dd8140870"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5355aaa265e4a9ef57068b7dd8140870">sip_session_suspend_task</a> (void *data)</td></tr>
<tr class="separator:a5355aaa265e4a9ef57068b7dd8140870"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7aeb0cc811ca617953f8b4c24a39f6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a6c7aeb0cc811ca617953f8b4c24a39f6">sip_session_suspender_dtor</a> (void *vdoomed)</td></tr>
<tr class="separator:a6c7aeb0cc811ca617953f8b4c24a39f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7feb7dfdc1b1c6d0684931bfc7c5cfe"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#af7feb7dfdc1b1c6d0684931bfc7c5cfe">stream_destroy</a> (void *obj, void *arg, int flags)</td></tr>
<tr class="separator:af7feb7dfdc1b1c6d0684931bfc7c5cfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a503fddc1714b2b2181dfd374fd82d48b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a503fddc1714b2b2181dfd374fd82d48b">test_is_media_session_equal</a> (struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *left, struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *right)</td></tr>
<tr class="separator:a503fddc1714b2b2181dfd374fd82d48b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a665f3aebf906cea9fb5aff0786a4507f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a665f3aebf906cea9fb5aff0786a4507f">test_is_media_state_equal</a> (struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *left, struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *right, int assert_on_failure)</td></tr>
<tr class="separator:a665f3aebf906cea9fb5aff0786a4507f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb3af098344ad4dbf62bff06fcd16630"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a> (struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state, const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, enum <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> <a class="el" href="../../d4/d88/structstate.html">state</a>, int position)</td></tr>
<tr class="separator:abb3af098344ad4dbf62bff06fcd16630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3e0b51d441cd66de7e4a31db44d150"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5f3e0b51d441cd66de7e4a31db44d150">test_stream_alloc</a> (const char *<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#a1c6de65cc31c36fe2ede0d438531d327">type</a>, enum <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> <a class="el" href="../../d4/d88/structstate.html">state</a>)</td></tr>
<tr class="separator:a5f3e0b51d441cd66de7e4a31db44d150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accef4530d306b2c1be2026b84f9f4327"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#accef4530d306b2c1be2026b84f9f4327">update_completed</a> (void *vsession)</td></tr>
<tr class="separator:accef4530d306b2c1be2026b84f9f4327"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Session resource&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_APP_DEPEND, .requires = &quot;res_pjsip&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7434c8ec76e08306dd925b85a655365a"><td class="memItemLeft" align="right" valign="top">static pjsip_inv_callback&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a7434c8ec76e08306dd925b85a655365a">inv_callback</a></td></tr>
<tr class="separator:a7434c8ec76e08306dd925b85a655365a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75076a42e720601f2234ac8a927ea4f9"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/dfb/structast__sip__nat__hook.html">ast_sip_nat_hook</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a></td></tr>
<tr class="memdesc:a75076a42e720601f2234ac8a927ea4f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">NAT hook for modifying outgoing messages with SDP.  <a href="#a75076a42e720601f2234ac8a927ea4f9">More...</a><br /></td></tr>
<tr class="separator:a75076a42e720601f2234ac8a927ea4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a724b2cc287d0952c4bbb94bc14c3d5b6"><td class="memItemLeft" align="right" valign="top">static pjsip_module&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a724b2cc287d0952c4bbb94bc14c3d5b6">outbound_invite_auth_module</a></td></tr>
<tr class="separator:a724b2cc287d0952c4bbb94bc14c3d5b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa34c0d9bc537c0b29225b0e92ccda6c9"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></td></tr>
<tr class="memdesc:aa34c0d9bc537c0b29225b0e92ccda6c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registered SDP stream handlers.  <a href="#aa34c0d9bc537c0b29225b0e92ccda6c9">More...</a><br /></td></tr>
<tr class="separator:aa34c0d9bc537c0b29225b0e92ccda6c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259b93d37fd46042989580ad586ac572"><td class="memItemLeft" align="right" valign="top">static pjsip_module&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></td></tr>
<tr class="separator:a259b93d37fd46042989580ad586ac572"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c77944ce4b545d91f1d14b67fe4d525"><td class="memItemLeft" align="right" valign="top">static pjsip_module&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5c77944ce4b545d91f1d14b67fe4d525">session_reinvite_module</a></td></tr>
<tr class="separator:a5c77944ce4b545d91f1d14b67fe4d525"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a05c8571bd4931208b4910ee2dcb4b035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05c8571bd4931208b4910ee2dcb4b035">&#9670;&nbsp;</a></span>CHECKER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHECKER</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05660">AST_TEST_DEFINE()</a>.</p>

</div>
</div>
<a id="a39fcd37b99a8eafd0aa1c961d8736f88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39fcd37b99a8eafd0aa1c961d8736f88">&#9670;&nbsp;</a></span>DATASTORE_BUCKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATASTORE_BUCKETS&#160;&#160;&#160;53</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01226">1226</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>.</p>

</div>
</div>
<a id="a5e3aa3a6565c9201950caa9a3f7b31a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3aa3a6565c9201950caa9a3f7b31a6">&#9670;&nbsp;</a></span>DEFAULT_NUM_SESSION_MEDIA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEFAULT_NUM_SESSION_MEDIA&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00061">61</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">ast_sip_session_media_state_alloc()</a>.</p>

</div>
</div>
<a id="ae69aae1e29fc058dac79e75743f1f927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae69aae1e29fc058dac79e75743f1f927">&#9670;&nbsp;</a></span>FREE_STATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FREE_STATE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cb39c08deca8673d9d2e744dc87fd6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb39c08deca8673d9d2e744dc87fd6d">&#9670;&nbsp;</a></span>GET_STREAM_NAME_SAFE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_STREAM_NAME_SAFE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_stream</td><td>)</td>
          <td>&#160;&#160;&#160;(_stream ? <a class="el" href="../../d8/d4d/stream_8c.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(_stream) : &quot;&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01739">1739</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01751">is_media_state_valid()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>.</p>

</div>
</div>
<a id="a89bb30093935e2968abc2ebcfd59d1e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89bb30093935e2968abc2ebcfd59d1e8">&#9670;&nbsp;</a></span>GET_STREAM_SAFE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_STREAM_SAFE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_topology, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_i&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(_i &lt; <a class="el" href="../../d8/d4d/stream_8c.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(_topology) ? <a class="el" href="../../d8/d4d/stream_8c.html#a1f727f403d8899cdb55488a49c9b7841">ast_stream_topology_get_stream</a>(_topology, _i) : <a class="el" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01737">1737</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>.</p>

</div>
</div>
<a id="afc8c0da7afa44b6f31850aad7bfaaa8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc8c0da7afa44b6f31850aad7bfaaa8e">&#9670;&nbsp;</a></span>GET_STREAM_STATE_SAFE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GET_STREAM_STATE_SAFE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_stream</td><td>)</td>
          <td>&#160;&#160;&#160;(_stream ? <a class="el" href="../../d8/d4d/stream_8c.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(_stream) : <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47">AST_STREAM_STATE_END</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01738">1738</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>.</p>

</div>
</div>
<a id="a7b5091467205f6fcc8347652088a1812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b5091467205f6fcc8347652088a1812">&#9670;&nbsp;</a></span>MEDIA_BUCKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEDIA_BUCKETS&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01227">1227</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="ad52575b22f1c0988077001bd1cd37db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad52575b22f1c0988077001bd1cd37db0">&#9670;&nbsp;</a></span>MOD_DATA_NAT_HOOK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOD_DATA_NAT_HOOK&#160;&#160;&#160;&quot;nat_hook&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00058">58</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">session_outgoing_nat_hook()</a>.</p>

</div>
</div>
<a id="a929623f98bee0fc9eb242c0bce08d227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a929623f98bee0fc9eb242c0bce08d227">&#9670;&nbsp;</a></span>MOD_DATA_ON_RESPONSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MOD_DATA_ON_RESPONSE&#160;&#160;&#160;&quot;on_response&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00057">57</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">ast_sip_session_send_request_with_cb()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>.</p>

</div>
</div>
<a id="a067e52198c90bacbde0918721c8a8440"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a067e52198c90bacbde0918721c8a8440">&#9670;&nbsp;</a></span>print_debug_details</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define print_debug_details</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">inv, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tsx, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a709bcdea84e4bec2f12ee64c2b6a3029">__print_debug_details</a>(__PRETTY_FUNCTION__, (inv), (tsx), (e))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04396">4396</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">session_inv_on_state_changed()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>.</p>

</div>
</div>
<a id="ac6d34c98a864a1fbfc95c7c94772523c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6d34c98a864a1fbfc95c7c94772523c">&#9670;&nbsp;</a></span>RESET_STATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RESET_STATE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">__num</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05660">AST_TEST_DEFINE()</a>.</p>

</div>
</div>
<a id="a68ecfcde443319d00e5bdbe30fed8c1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68ecfcde443319d00e5bdbe30fed8c1d">&#9670;&nbsp;</a></span>SDP_HANDLER_BUCKETS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SDP_HANDLER_BUCKETS&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00055">55</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06074">load_module()</a>.</p>

</div>
</div>
<a id="a747da02675876a0e85ab971de1849bde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a747da02675876a0e85ab971de1849bde">&#9670;&nbsp;</a></span>STATE_NONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_NONE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_stream_state</td><td>)</td>
          <td>&#160;&#160;&#160;(_stream_state == <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47">AST_STREAM_STATE_END</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01736">1736</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>.</p>

</div>
</div>
<a id="a65ee9e13e68c4fc2191e0a67cee60b4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65ee9e13e68c4fc2191e0a67cee60b4e">&#9670;&nbsp;</a></span>STATE_REMOVED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STATE_REMOVED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_stream_state</td><td>)</td>
          <td>&#160;&#160;&#160;(_stream_state == <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01735">1735</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>.</p>

</div>
</div>
<a id="a54d2a76e6f2247e72619e26b239837d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54d2a76e6f2247e72619e26b239837d4">&#9670;&nbsp;</a></span>STREAM_REMOVED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STREAM_REMOVED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">_stream</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="../../d8/d4d/stream_8c.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(_stream) == <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01734">1734</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01751">is_media_state_valid()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a5dad843b27d741d62518be05c259d9b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dad843b27d741d62518be05c259d9b4">&#9670;&nbsp;</a></span>delayed_method</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"></a>DELAYED_METHOD_INVITE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27"></a>DELAYED_METHOD_UPDATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"></a>DELAYED_METHOD_BYE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01295">1295</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                    {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>,</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a>,</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>,</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;};</div><div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">res_pjsip_session.c:1296</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">res_pjsip_session.c:1297</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aba73dfdfaa94dc744be18ae4e8b01591"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba73dfdfaa94dc744be18ae4e8b01591">&#9670;&nbsp;</a></span>sip_get_destination_result</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591">sip_get_destination_result</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59"></a>SIP_GET_DEST_EXTEN_FOUND&#160;</td><td class="fielddoc"><p>The extension was successfully found </p>
</td></tr>
<tr><td class="fieldname"><a id="aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229"></a>SIP_GET_DEST_EXTEN_NOT_FOUND&#160;</td><td class="fielddoc"><p>The extension specified in the RURI was not found </p>
</td></tr>
<tr><td class="fieldname"><a id="aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa"></a>SIP_GET_DEST_EXTEN_PARTIAL&#160;</td><td class="fielddoc"><p>The extension specified in the RURI was a partial match </p>
</td></tr>
<tr><td class="fieldname"><a id="aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be"></a>SIP_GET_DEST_UNSUPPORTED_URI&#160;</td><td class="fielddoc"><p>The RURI is of an unsupported scheme </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03645">3645</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                                {<span class="comment"></span></div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;<span class="comment">   /*! The extension was successfully found */</span></div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59">SIP_GET_DEST_EXTEN_FOUND</a>,<span class="comment"></span></div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;<span class="comment">   /*! The extension specified in the RURI was not found */</span></div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229">SIP_GET_DEST_EXTEN_NOT_FOUND</a>,<span class="comment"></span></div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="comment">   /*! The extension specified in the RURI was a partial match */</span></div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa">SIP_GET_DEST_EXTEN_PARTIAL</a>,<span class="comment"></span></div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;<span class="comment">   /*! The RURI is of an unsupported scheme */</span></div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be">SIP_GET_DEST_UNSUPPORTED_URI</a>,</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;};</div><div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa">SIP_GET_DEST_EXTEN_PARTIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03651">res_pjsip_session.c:3651</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59">SIP_GET_DEST_EXTEN_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03647">res_pjsip_session.c:3647</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229">SIP_GET_DEST_EXTEN_NOT_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03649">res_pjsip_session.c:3649</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be">SIP_GET_DEST_UNSUPPORTED_URI</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03653">res_pjsip_session.c:3653</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a709bcdea84e4bec2f12ee64c2b6a3029"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a709bcdea84e4bec2f12ee64c2b6a3029">&#9670;&nbsp;</a></span>__print_debug_details()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __print_debug_details </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_transaction *&#160;</td>
          <td class="paramname"><em>tsx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_event *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04347">4347</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00441">DEBUG_ATLEAST</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00241">LOG_DEBUG</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>
<div class="fragment"><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;{</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;   <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id;</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a>(5)) {</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      <span class="comment">/* Debug not spamy enough */</span></div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;   }</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Function %s called on event %s\n&quot;</span>,</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;      <span class="keyword">function</span>, pjsip_event_str(e-&gt;type));</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;   <span class="keywordflow">if</span> (!inv) {</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;Transaction %p does not belong to an inv_session?\n&quot;</span>, tsx);</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The transaction state is %s\n&quot;</span>,</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;         pjsip_tsx_state_str(tsx-&gt;state));</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;   }</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;   <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &gt; -1) {</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;      session = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;   }</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;inv_session %p has no ast session\n&quot;</span>, inv);</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The state change pertains to the endpoint &#39;%s(%s)&#39;\n&quot;</span>,</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>),</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> ? <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;   }</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;   <span class="keywordflow">if</span> (inv-&gt;invite_tsx) {</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The inv session still has an invite_tsx (%p)\n&quot;</span>,</div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;         inv-&gt;invite_tsx);</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The inv session does NOT have an invite_tsx\n&quot;</span>);</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;   }</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;   <span class="keywordflow">if</span> (tsx) {</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The %s %.*s transaction involved in this state change is %p\n&quot;</span>,</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;         pjsip_role_name(tsx-&gt;role),</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;         (<span class="keywordtype">int</span>) pj_strlen(&amp;tsx-&gt;method.name), pj_strbuf(&amp;tsx-&gt;method.name),</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;         tsx);</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The current transaction state is %s\n&quot;</span>,</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;         pjsip_tsx_state_str(tsx-&gt;state));</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The transaction state change event is %s\n&quot;</span>,</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;         pjsip_event_str(e-&gt;body.tsx_state.type));</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;There is no transaction involved in this state change\n&quot;</span>);</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;   }</div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a>, <span class="stringliteral">&quot;The current inv state is %s\n&quot;</span>, pjsip_inv_state_name(inv-&gt;state));</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a6ff63e8955665c4a58b1598f2b07c51a"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6ff63e8955665c4a58b1598f2b07c51a">LOG_DEBUG</a></div><div class="ttdeci">#define LOG_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00241">logger.h:241</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="logger_8h_html_a33f6031de4ab6d1406465a7a3ee18e86"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a33f6031de4ab6d1406465a7a3ee18e86">DEBUG_ATLEAST</a></div><div class="ttdeci">#define DEBUG_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00441">logger.h:441</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06128">6128</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06128">6128</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="a77986e41ff1baa560a998e2b00e55f57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77986e41ff1baa560a998e2b00e55f57">&#9670;&nbsp;</a></span>add_bundle_groups()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int add_bundle_groups </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_pool_t *&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>answer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05011">5011</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01065">ast_str_set()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05008">sip_session_media_bundle_group::attr_string</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00792">ast_sip_endpoint_media_configuration::bundle</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05006">sip_session_media_bundle_group::mids</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00794">ast_sip_endpoint_media_configuration::webrtc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>.</p>
<div class="fragment"><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;{</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;   pj_str_t stmp;</div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;   pjmedia_sdp_attr *attr;</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html">sip_session_media_bundle_group</a> bundle_groups[PJMEDIA_MAX_SDP_MEDIA];</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;   <span class="keywordtype">int</span> index, mid_id;</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html">sip_session_media_bundle_group</a> *bundle_group;</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">webrtc</a>) {</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;      attr = pjmedia_sdp_attr_create(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, <span class="stringliteral">&quot;msid-semantic&quot;</span>, pj_cstr(&amp;stmp, <span class="stringliteral">&quot;WMS *&quot;</span>));</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;      pjmedia_sdp_attr_add(&amp;<a class="code" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>-&gt;attr_count, <a class="code" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>-&gt;attr, attr);</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;   }</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a>) {</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;   }</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;   memset(bundle_groups, 0, <span class="keyword">sizeof</span>(bundle_groups));</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;   <span class="comment">/* Build the bundle group layout so we can then add it to the SDP */</span></div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions); ++index) {</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions, index);</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;      <span class="comment">/* If this stream is not part of a bundle group we can&#39;t add it */</span></div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;      <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> == -1) {</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;      }</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      bundle_group = &amp;bundle_groups[session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a>];</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      <span class="comment">/* If this is the first mid then we need to allocate the attribute string and place BUNDLE in front */</span></div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;      <span class="keywordflow">if</span> (!bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#a2d7afbdceed9fda74a0a85f2e665302f">mids</a>[0]) {</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;         bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#a2d7afbdceed9fda74a0a85f2e665302f">mids</a>[0] = session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>;</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;         bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">attr_string</a> = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(64);</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;         <span class="keywordflow">if</span> (!bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">attr_string</a>) {</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;         }</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">attr_string</a>, 0, <span class="stringliteral">&quot;BUNDLE %s&quot;</span>, session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;      }</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;      <span class="keywordflow">for</span> (mid_id = 1; mid_id &lt; PJMEDIA_MAX_SDP_MEDIA; ++mid_id) {</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;         <span class="keywordflow">if</span> (!bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#a2d7afbdceed9fda74a0a85f2e665302f">mids</a>[mid_id]) {</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;            bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#a2d7afbdceed9fda74a0a85f2e665302f">mids</a>[mid_id] = session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>;</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">attr_string</a>, 0, <span class="stringliteral">&quot; %s&quot;</span>, session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#a2d7afbdceed9fda74a0a85f2e665302f">mids</a>[mid_id], session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>)) {</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;         }</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      }</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;   }</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;   <span class="comment">/* Add all bundle groups that have mids to the SDP */</span></div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; PJMEDIA_MAX_SDP_MEDIA; ++index) {</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;      bundle_group = &amp;bundle_groups[index];</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      <span class="keywordflow">if</span> (!bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">attr_string</a>) {</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      }</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;      attr = pjmedia_sdp_attr_create(<a class="code" href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a>, <span class="stringliteral">&quot;group&quot;</span>, pj_cstr(&amp;stmp, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">attr_string</a>)));</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;      pjmedia_sdp_attr_add(&amp;<a class="code" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>-&gt;attr_count, <a class="code" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>-&gt;attr, attr);</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(bundle_group-&gt;<a class="code" href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">attr_string</a>);</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;   }</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;}</div><div class="ttc" id="structast__sip__endpoint__media__configuration_html_aa64681ccac6f69e15c21471249e68121"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">ast_sip_endpoint_media_configuration::webrtc</a></div><div class="ttdeci">unsigned int webrtc</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00794">res_pjsip.h:794</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structsip__session__media__bundle__group_html"><div class="ttname"><a href="../../dd/de0/structsip__session__media__bundle__group.html">sip_session_media_bundle_group</a></div><div class="ttdoc">Bundle group building structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05004">res_pjsip_session.c:5004</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="res__rtp__asterisk_8c_html_a2e57658a5d3ef6c4ef2774c9d5868e7c"><div class="ttname"><a href="../../d9/d21/res__rtp__asterisk_8c.html#a2e57658a5d3ef6c4ef2774c9d5868e7c">pool</a></div><div class="ttdeci">static pj_pool_t * pool</div><div class="ttdoc">Global memory pool for configuration and timers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d21/res__rtp__asterisk_8c_source.html#l00236">res_rtp_asterisk.c:236</a></div></div>
<div class="ttc" id="structsip__session__media__bundle__group_html_ac95acd4af77a52f829af0ca69259e317"><div class="ttname"><a href="../../dd/de0/structsip__session__media__bundle__group.html#ac95acd4af77a52f829af0ca69259e317">sip_session_media_bundle_group::attr_string</a></div><div class="ttdeci">struct ast_str * attr_string</div><div class="ttdoc">SDP attribute string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05008">res_pjsip_session.c:5008</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="chan__pjsip_8c_html_ab8dde573cc3974acd626c5626fae14b4"><div class="ttname"><a href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a></div><div class="ttdeci">static int answer(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/chan__pjsip_8c_source.html#l00682">chan_pjsip.c:682</a></div></div>
<div class="ttc" id="structsip__session__media__bundle__group_html_a2d7afbdceed9fda74a0a85f2e665302f"><div class="ttname"><a href="../../dd/de0/structsip__session__media__bundle__group.html#a2d7afbdceed9fda74a0a85f2e665302f">sip_session_media_bundle_group::mids</a></div><div class="ttdeci">char * mids[PJMEDIA_MAX_SDP_MEDIA]</div><div class="ttdoc">The media identifiers in this bundle group. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05006">res_pjsip_session.c:5006</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a4b3a62121ed2ff9bebdfb879ad17cdef"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">ast_sip_endpoint_media_configuration::bundle</a></div><div class="ttdeci">unsigned int bundle</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00792">res_pjsip.h:792</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55df57c5fbe99a5af456c2a9aaaccd20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55df57c5fbe99a5af456c2a9aaaccd20">&#9670;&nbsp;</a></span>add_sdp_streams()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int add_sdp_streams </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>remote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04957">4957</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00347">ast_codec_media_type2str()</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00337">ast_stream_to_str()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00423">ast_sip_session_sdp_handler::create_outgoing_sdp_stream</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">ast_sip_session_media::handler</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">ast_sip_session_sdp_handler::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">session_media_set_handler()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">ast_sip_session_media::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>.</p>
<div class="fragment"><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;{</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a> = session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>;</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *, handler_list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Stream: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;   <span class="keywordflow">if</span> (handler) {</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;      <span class="comment">/* if an already assigned handler reports a catastrophic error, fail */</span></div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;      res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a24c72fc017fcab40feb473dbea130d7c">create_outgoing_sdp_stream</a>(session, session_media, <a class="code" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>, remote, stream);</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;      <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Coudn&#39;t create sdp stream\n&quot;</span>);</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;      }</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;Had handler\n&quot;</span>);</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;   }</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;   handler_list = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;   <span class="keywordflow">if</span> (!handler_list) {</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;No handlers\n&quot;</span>);</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;   }</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;   <span class="comment">/* no handler for this stream type and we have a list to search */</span></div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;list, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>) {</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <span class="keywordflow">if</span> (handler == session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;      }</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;      res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a24c72fc017fcab40feb473dbea130d7c">create_outgoing_sdp_stream</a>(session, session_media, <a class="code" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>, remote, stream);</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;      <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;         <span class="comment">/* catastrophic error */</span></div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Coudn&#39;t create sdp stream\n&quot;</span>);</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;      }</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      <span class="keywordflow">if</span> (res &gt; 0) {</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;         <span class="comment">/* Handled by this handler. Move to the next stream */</span></div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a>(session_media, handler);</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;Handled\n&quot;</span>);</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      }</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;   }</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;   <span class="comment">/* streams that weren&#39;t handled won&#39;t be included in generated outbound SDP */</span></div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;Not handled\n&quot;</span>);</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;}</div><div class="ttc" id="stream_8h_html_af793e90c3796564a01574fd9c5e9e208"><div class="ttname"><a href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a></div><div class="ttdeci">const char * ast_stream_to_str(const struct ast_stream *stream, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the stream for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00337">stream.c:337</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="codec_8h_html_a97df2e6b65823085173625553d2e06c5"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a></div><div class="ttdeci">const char * ast_codec_media_type2str(enum ast_media_type type)</div><div class="ttdoc">Conversion function to take a media type and turn it into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00347">codec.c:347</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aaa4f9cdda5dd0b1270fb35523054926c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">ast_sip_session_sdp_handler::next</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">res_pjsip_session.h:460</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a547f07821c13f67174cb535888d98c0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a></div><div class="ttdeci">static void session_media_set_handler(struct ast_sip_session_media *session_media, struct ast_sip_session_sdp_handler *handler)</div><div class="ttdoc">Set an SDP stream handler for a corresponding session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">res_pjsip_session.c:445</a></div></div>
<div class="ttc" id="chan__pjsip_8c_html_ab8dde573cc3974acd626c5626fae14b4"><div class="ttname"><a href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a></div><div class="ttdeci">static int answer(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/chan__pjsip_8c_source.html#l00682">chan_pjsip.c:682</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a57b08a6ad7a004d70eba4a1b6867a084"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">ast_sip_session_media::type</a></div><div class="ttdeci">enum ast_media_type type</div><div class="ttdoc">Media type of this session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">res_pjsip_session.h:105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3b66ccd874aa8ba900ad09f9fb12717d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">ast_sip_session_media::handler</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * handler</div><div class="ttdoc">SDP handler that setup the RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">res_pjsip_session.h:83</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_a24c72fc017fcab40feb473dbea130d7c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#a24c72fc017fcab40feb473dbea130d7c">ast_sip_session_sdp_handler::create_outgoing_sdp_stream</a></div><div class="ttdeci">int(* create_outgoing_sdp_stream)(struct ast_sip_session *session, struct ast_sip_session_media *session_media, struct pjmedia_sdp_session *sdp, const struct pjmedia_sdp_session *remote, struct ast_stream *stream)</div><div class="ttdoc">Create an SDP media stream and add it to the outgoing SDP offer or answer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00423">res_pjsip_session.h:423</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06128">6128</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="a95cafef155609ea0d35d60b178902941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cafef155609ea0d35d60b178902941">&#9670;&nbsp;</a></span>ast_sip_channel_pvt_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a>* ast_sip_channel_pvt_alloc </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new SIP channel pvt structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pvt</td><td>Pointer to channel specific information </td></tr>
    <tr><td class="paramname">session</td><td>Pointer to SIP session</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02974">2974</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00468">ast_sip_channel_pvt::pvt</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00470">ast_sip_channel_pvt::session</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02966">sip_channel_destroy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00547">chan_pjsip_new()</a>.</p>
<div class="fragment"><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;{</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a> *<a class="code" href="../../d4/d84/structchannel.html">channel</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*channel), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a92471759f1f84a29c1cf773bb83b7807">sip_channel_destroy</a>);</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;   <span class="keywordflow">if</span> (!channel) {</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   }</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">pvt</a>, +1);</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;   channel-&gt;<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">pvt</a> = <a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">pvt</a>;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;   channel-&gt;<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a47bd1bb949183a58a194970acaccffbd">session</a> = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;   <span class="keywordflow">return</span> channel;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;}</div><div class="ttc" id="structast__sip__channel__pvt_html_a77153a7ab7ba05031fbbb4e67aa9dcfc"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">ast_sip_channel_pvt::pvt</a></div><div class="ttdeci">void * pvt</div><div class="ttdoc">Pointer to channel specific implementation information, must be ao2 object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00468">res_pjsip_session.h:468</a></div></div>
<div class="ttc" id="structast__sip__channel__pvt_html"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a></div><div class="ttdoc">A structure which contains a channel implementation and session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00466">res_pjsip_session.h:466</a></div></div>
<div class="ttc" id="structast__sip__channel__pvt_html_a47bd1bb949183a58a194970acaccffbd"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html#a47bd1bb949183a58a194970acaccffbd">ast_sip_channel_pvt::session</a></div><div class="ttdeci">struct ast_sip_session * session</div><div class="ttdoc">Pointer to session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00470">res_pjsip_session.h:470</a></div></div>
<div class="ttc" id="structchannel_html"><div class="ttname"><a href="../../d4/d84/structchannel.html">channel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8a/muted_8c_source.html#l00095">muted.c:95</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a92471759f1f84a29c1cf773bb83b7807"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a92471759f1f84a29c1cf773bb83b7807">sip_channel_destroy</a></div><div class="ttdeci">static void sip_channel_destroy(void *obj)</div><div class="ttdoc">Destructor for SIP channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02966">res_pjsip_session.c:2966</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a908cdf7ba25c4d6f3d2efdf01f0125ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a908cdf7ba25c4d6f3d2efdf01f0125ca">&#9670;&nbsp;</a></span>ast_sip_dialog_get_session()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a>* ast_sip_dialog_get_session </td>
          <td>(</td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves a session from a dialog. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dlg</td><td>The dialog to retrieve the session from</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>if session exists </td></tr>
    <tr><td class="paramname">NULL</td><td>if no session</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The reference count of the session is increased when returned</dd>
<dd>
This function <em>must</em> be called with the dialog locked </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03630">3630</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d7/da2/res__hep__pjsip_8c_source.html#l00047">assign_uuid()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00969">refer_incoming_invite_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">session_outgoing_nat_hook()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02733">session_reinvite_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;{</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;   pjsip_inv_session *inv_session = pjsip_dlg_get_inv_session(dlg);</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;   <span class="keywordflow">if</span> (!inv_session ||</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      !(session = inv_session-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id])) {</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;   }</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d3bc4b6c4bdd1a98347a2b33a35b517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d3bc4b6c4bdd1a98347a2b33a35b517">&#9670;&nbsp;</a></span>ast_sip_session_add_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_add_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *&#160;</td>
          <td class="paramname"><em>datastore</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a datastore to a SIP session. </p>
<p>Note that SIP uses reference counted datastores. The datastore passed into this function must have been allocated using <a class="el" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc()</a> or there will be serious problems.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to add the datastore to </td></tr>
    <tr><td class="paramname">datastore</td><td>The datastore to be added to the session </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01273">1273</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00071">ast_datastore::info</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/db6/datastore_8h_source.html#l00069">ast_datastore::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00315">add_header()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02950">chan_pjsip_session_begin()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00125">handle_incoming_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00196">incoming_request()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00231">t38_state_get_or_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;{</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(datastore != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">info</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>) == 0);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, datastore)) {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;   }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_session::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">res_pjsip_session.h:193</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__datastore_html_a2daadcdbac635c83b7bfc6375b4c9be4"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">ast_datastore::uid</a></div><div class="ttdeci">const char * uid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00069">datastore.h:69</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__datastore_html_a03ea21247b5d39b165343431b44131f1"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">ast_datastore::info</a></div><div class="ttdeci">const struct ast_datastore_info * info</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00071">datastore.h:71</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4ae79a585283a422b758eddcd9663c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ae79a585283a422b758eddcd9663c2">&#9670;&nbsp;</a></span>ast_sip_session_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a>* ast_sip_session_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *&#160;</td>
          <td class="paramname"><em>contact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a new SIP session. </p>
<p>This will take care of allocating the datastores container on the session as well as placing all registered supplements onto the session.</p>
<p>The endpoint that is passed in will have its reference count increased by one since the session will be keeping a reference to the endpoint. The session will relinquish this reference when the session is destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endpoint</td><td>The endpoint that this session communicates with </td></tr>
    <tr><td class="paramname">contact</td><td>The contact associated with this session </td></tr>
    <tr><td class="paramname">inv_session</td><td>The PJSIP INVITE session data </td></tr>
    <tr><td class="paramname">rdata</td><td>INVITE request received (NULL if for outgoing allocation) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">2990</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01745">ast_dsp_new()</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01755">ast_dsp_set_features()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00625">AST_LIST_HEAD_INIT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00680">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01757">ast_party_id_init()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05133">ast_sip_create_serializer()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">ast_sip_dialog_set_endpoint()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">ast_sip_dialog_set_serializer()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00419">AST_SIP_DTMF_AUTO</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00415">AST_SIP_DTMF_INBAND</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">ast_sip_get_distributor_serializer()</a>, <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00090">ast_sip_session_add_supplements()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">ast_sip_session_media_state_alloc()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01295">ast_taskprocessor_build_name()</a>, <a class="el" href="../../d0/d1e/taskprocessor_8h_source.html#l00060">AST_TASKPROCESSOR_MAX_NAME</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00239">ast_sip_session::authentication_challenge_count</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00185">ast_sip_session::contact</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01226">DATASTORE_BUCKETS</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02888">datastore_cmp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02878">datastore_hash()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00203">ast_sip_session::direct_media_cap</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00213">ast_sip_session::dsp</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00028">DSP_FEATURE_DIGIT_DETECT</a>, <a class="el" href="../../d3/d08/dsp_8h_source.html#l00029">DSP_FEATURE_FAX_DETECT</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00233">ast_sip_session::dtmf</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00857">ast_sip_endpoint::dtmf</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00869">ast_sip_endpoint::faxdetect</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04415">handle_session_begin()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">ast_sip_session::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00231">ast_sip_session::moh_passthrough</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00879">ast_sip_endpoint::moh_passthrough</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03317">ast_sip_session_create_outgoing()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;{</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *ret_session;</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;   <span class="keywordtype">int</span> dsp_features = 0;</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a>);</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>) {</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;   }</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6f42d3bf45cc9af6f794d9d1cf8c45ca">AST_LIST_HEAD_INIT</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;supplements);</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;delayed_requests);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a2126ac3bbc1a14f6ed5ccdfcbb851776">ast_party_id_init</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;id);</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;direct_media_cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;direct_media_cap) {</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;   }</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;datastores = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a39fcd37b99a8eafd0aa1c961d8736f88">DATASTORE_BUCKETS</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae586d6908c81e9a59e0e68358c12c9cc">datastore_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac60c8c7a11b9aa2b347630c7d08af17d">datastore_cmp</a>);</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;datastores) {</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;   }</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;active_media_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a>();</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;active_media_state) {</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;   }</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a>();</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state) {</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;   }</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;media_stats, 1) &lt; 0) {</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   }</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;   <span class="keywordflow">if</span> (endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">dtmf</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa5e869c7cc77a17055a0f4d14095b95f8">AST_SIP_DTMF_INBAND</a> || endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">dtmf</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa43325569e4e8a4e171dba3f532ff265b">AST_SIP_DTMF_AUTO</a>) {</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      dsp_features |= <a class="code" href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a>;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;   }</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;   <span class="keywordflow">if</span> (endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#af8a29ee5509cdaf8e4a85c7f81fd4b25">faxdetect</a>) {</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      dsp_features |= <a class="code" href="../../d3/d08/dsp_8h.html#a92045e8a8ad56b9b31d24db325fa95ab">DSP_FEATURE_FAX_DETECT</a>;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;   }</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;   <span class="keywordflow">if</span> (dsp_features) {</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dsp = <a class="code" href="../../d3/d08/dsp_8h.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a>();</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dsp) {</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;      }</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      <a class="code" href="../../d3/d08/dsp_8h.html#aedc7fa20fba91e3c018f6989e95c714b">ast_dsp_set_features</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dsp, dsp_features);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;   }</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;endpoint = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(endpoint);</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;   <span class="keywordflow">if</span> (rdata) {</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment">       * We must continue using the serializer that the original</span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment">       * INVITE came in on for the dialog.  There may be</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment">       * retransmissions already enqueued in the original</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment">       * serializer that can result in reentrancy and message</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment">       * sequencing problems.</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a>(rdata);</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <span class="keywordtype">char</span> tps_name[<a class="code" href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a> + 1];</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      <span class="comment">/* Create name with seq number appended. */</span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      <a class="code" href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a>(tps_name, <span class="keyword">sizeof</span>(tps_name), <span class="stringliteral">&quot;pjsip/outsess/%s&quot;</span>,</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a>(tps_name);</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;   }</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer) {</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;   }</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a>(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;serializer);</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a>(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, endpoint);</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;   <span class="comment">/* When a PJSIP INVITE session is created it is created with a reference</span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">    * count of 1, with that reference being managed by the underlying state</span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">    * of the INVITE session itself. When the INVITE session transitions to</span></div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">    * a DISCONNECTED state that reference is released. This means we can not</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">    * rely on that reference to ensure the INVITE session remains for the</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">    * lifetime of our session. To ensure it does we add our own reference</span></div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">    * and release it when our own session goes away, ensuring that the INVITE</span></div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">    * session remains for the lifetime of session.</span></div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;<span class="preprocessor">#ifdef HAVE_PJSIP_INV_SESSION_REF</span></div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_add_ref(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Can&#39;t increase the session reference counter\n&quot;</span>);</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;   }</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;   pjsip_dlg_inc_session(<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>);</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;   <a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id] = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>);</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;contact = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(contact);</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;inv_session = <a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;dtmf = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">dtmf</a>;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;moh_passthrough = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a56458fcd1003f7554cee73c7f0346cbb">moh_passthrough</a>;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a6c6cefb7bfc8ff5bf254b8bbd56c443d">ast_sip_session_add_supplements</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)) {</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <span class="comment">/* Release the ref held by session-&gt;inv_session */</span></div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   }</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;authentication_challenge_count = 0;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;   <span class="comment">/* Fire seesion begin handlers */</span></div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3533f635938c655112221b97eac4884a">handle_session_begin</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>);</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;   <span class="comment">/* Avoid unnecessary ref manipulation to return a session */</span></div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;   ret_session = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;   <span class="keywordflow">return</span> ret_session;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;}</div><div class="ttc" id="structast__sip__endpoint_html_abb7c899dc9afe319240163be2b213813"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#abb7c899dc9afe319240163be2b213813">ast_sip_endpoint::dtmf</a></div><div class="ttdeci">enum ast_sip_dtmf_mode dtmf</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00857">res_pjsip.h:857</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_ab47623e207bf2cdd0edfa613d91894e5"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ab47623e207bf2cdd0edfa613d91894e5">ast_taskprocessor_build_name</a></div><div class="ttdeci">void ast_taskprocessor_build_name(char *buf, unsigned int size, const char *format,...)</div><div class="ttdoc">Build a taskprocessor name with a sequence number on the end. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01295">taskprocessor.c:1295</a></div></div>
<div class="ttc" id="dsp_8h_html_a84818b360426bdd5f588cdca463e15be"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a84818b360426bdd5f588cdca463e15be">DSP_FEATURE_DIGIT_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_DIGIT_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00028">dsp.h:28</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga86c62fe22e3b7fb409c13ec7fd4fee2d"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a></div><div class="ttdeci">void ast_sip_dialog_set_serializer(pjsip_dialog *dlg, struct ast_taskprocessor *serializer)</div><div class="ttdoc">Set a serializer on a SIP dialog so requests and responses are automatically serialized. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">pjsip_distributor.c:266</a></div></div>
<div class="ttc" id="dsp_8h_html_a0a60e93006c8e1ca8fda922ae0e0da2c"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a0a60e93006c8e1ca8fda922ae0e0da2c">ast_dsp_new</a></div><div class="ttdeci">struct ast_dsp * ast_dsp_new(void)</div><div class="ttdoc">Allocates a new dsp, assumes 8khz for internal sample rate. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01745">dsp.c:1745</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga6d8415024c851216fa63fbb94d0aadcf"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a></div><div class="ttdeci">void ast_sip_dialog_set_endpoint(pjsip_dialog *dlg, struct ast_sip_endpoint *endpoint)</div><div class="ttdoc">Set an endpoint on a SIP dialog so in-dialog requests do not undergo endpoint lookup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">pjsip_distributor.c:294</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_adf4c5a237767eb6db5b1db41ccdfc689"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#adf4c5a237767eb6db5b1db41ccdfc689">AST_TASKPROCESSOR_MAX_NAME</a></div><div class="ttdeci">#define AST_TASKPROCESSOR_MAX_NAME</div><div class="ttdoc">Suggested maximum taskprocessor name length (less null terminator). </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00060">taskprocessor.h:60</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a39fcd37b99a8eafd0aa1c961d8736f88"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a39fcd37b99a8eafd0aa1c961d8736f88">DATASTORE_BUCKETS</a></div><div class="ttdeci">#define DATASTORE_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01226">res_pjsip_session.c:1226</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aa545d9a3491f89266f1218b7a07bab1fa5e869c7cc77a17055a0f4d14095b95f8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa5e869c7cc77a17055a0f4d14095b95f8">AST_SIP_DTMF_INBAND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00415">res_pjsip.h:415</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6d2190ae1fcb37e66c2a445f2fe59ec3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a></div><div class="ttdeci">static void session_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">res_pjsip_session.c:2900</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="dsp_8h_html_a92045e8a8ad56b9b31d24db325fa95ab"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a92045e8a8ad56b9b31d24db325fa95ab">DSP_FEATURE_FAX_DETECT</a></div><div class="ttdeci">#define DSP_FEATURE_FAX_DETECT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d08/dsp_8h_source.html#l00029">dsp.h:29</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae586d6908c81e9a59e0e68358c12c9cc"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae586d6908c81e9a59e0e68358c12c9cc">datastore_hash</a></div><div class="ttdeci">static int datastore_hash(const void *obj, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02878">res_pjsip_session.c:2878</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac60c8c7a11b9aa2b347630c7d08af17d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac60c8c7a11b9aa2b347630c7d08af17d">datastore_cmp</a></div><div class="ttdeci">static int datastore_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02888">res_pjsip_session.c:2888</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_gad57aa0b914fbd6adbf8ee2fe176e1fb1"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#gad57aa0b914fbd6adbf8ee2fe176e1fb1">ast_sip_create_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_create_serializer(const char *name)</div><div class="ttdoc">Create a new serializer for SIP tasks. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05133">res_pjsip.c:5133</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_af8a29ee5509cdaf8e4a85c7f81fd4b25"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#af8a29ee5509cdaf8e4a85c7f81fd4b25">ast_sip_endpoint::faxdetect</a></div><div class="ttdeci">unsigned int faxdetect</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00869">res_pjsip.h:869</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga506c31bc071963fa7ef3ed517fa0a533"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga506c31bc071963fa7ef3ed517fa0a533">ast_sip_get_distributor_serializer</a></div><div class="ttdeci">struct ast_taskprocessor * ast_sip_get_distributor_serializer(pjsip_rx_data *rdata)</div><div class="ttdoc">Determine the distributor serializer for the SIP message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00448">pjsip_distributor.c:448</a></div></div>
<div class="ttc" id="dsp_8h_html_aedc7fa20fba91e3c018f6989e95c714b"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#aedc7fa20fba91e3c018f6989e95c714b">ast_dsp_set_features</a></div><div class="ttdeci">void ast_dsp_set_features(struct ast_dsp *dsp, int features)</div><div class="ttdoc">Select feature set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01755">dsp.c:1755</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6f42d3bf45cc9af6f794d9d1cf8c45ca"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6f42d3bf45cc9af6f794d9d1cf8c45ca">AST_LIST_HEAD_INIT</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00625">linkedlists.h:625</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a56458fcd1003f7554cee73c7f0346cbb"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a56458fcd1003f7554cee73c7f0346cbb">ast_sip_endpoint::moh_passthrough</a></div><div class="ttdeci">unsigned int moh_passthrough</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00879">res_pjsip.h:879</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a3533f635938c655112221b97eac4884a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3533f635938c655112221b97eac4884a">handle_session_begin</a></div><div class="ttdeci">static void handle_session_begin(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04415">res_pjsip_session.c:4415</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aa545d9a3491f89266f1218b7a07bab1fa43325569e4e8a4e171dba3f532ff265b"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aa545d9a3491f89266f1218b7a07bab1fa43325569e4e8a4e171dba3f532ff265b">AST_SIP_DTMF_AUTO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00419">res_pjsip.h:419</a></div></div>
<div class="ttc" id="channel_8h_html_a2126ac3bbc1a14f6ed5ccdfcbb851776"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2126ac3bbc1a14f6ed5ccdfcbb851776">ast_party_id_init</a></div><div class="ttdeci">void ast_party_id_init(struct ast_party_id *init)</div><div class="ttdoc">Initialize the given party id structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01757">channel.c:1757</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0d1f922e093ac18824a7863fe3f5fa27"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT_NOLOCK(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00680">linkedlists.h:680</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a6c6cefb7bfc8ff5bf254b8bbd56c443d"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a6c6cefb7bfc8ff5bf254b8bbd56c443d">ast_sip_session_add_supplements</a></div><div class="ttdeci">int ast_sip_session_add_supplements(struct ast_sip_session *session)</div><div class="ttdoc">Add supplements to a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00090">pjsip_session.c:90</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0a9996be2e7d0a6fe7df55098932f5f6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0a9996be2e7d0a6fe7df55098932f5f6">ast_sip_session_media_state_alloc</a></div><div class="ttdeci">struct ast_sip_session_media_state * ast_sip_session_media_state_alloc(void)</div><div class="ttdoc">Allocate a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">res_pjsip_session.c:238</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a28af3f44693710b56fb141c509a5eb9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28af3f44693710b56fb141c509a5eb9d">&#9670;&nbsp;</a></span>ast_sip_session_alloc_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>* ast_sip_session_alloc_datastore </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Alternative for <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a> </p>
<p>There are two major differences between this and <a class="el" href="../../d9/db6/datastore_8h.html#a666afb07fd77d50782cc10f83e029159">ast_datastore_alloc()</a> 1) This allocates a refcounted object 2) This will fill in a uid if one is not provided</p>
<p>DO NOT call <a class="el" href="../../d9/db6/datastore_8h.html#aee27286888b30c6448a9bce928040a14" title="Free a data store object. ">ast_datastore_free()</a> on a datastore allocated in this way since that function will attempt to free the datastore rather than play nicely with its refcount.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">info</td><td>Callbacks for datastore </td></tr>
    <tr><td class="paramname">uid</td><td>Identifier for datastore </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to allocate datastore </td></tr>
    <tr><td class="paramname">non-NULL</td><td>Newly allocated datastore </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01243">1243</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../df/da9/uuid_8c_source.html#l00143">ast_uuid_generate_str()</a>, <a class="el" href="../../dd/d1d/uuid_8h_source.html#l00027">AST_UUID_STR_LEN</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01229">session_datastore_destroy()</a>, and <a class="el" href="../../d9/db6/datastore_8h_source.html#l00069">ast_datastore::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00315">add_header()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02950">chan_pjsip_session_begin()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00125">handle_incoming_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00196">incoming_request()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00231">t38_state_get_or_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;{</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *, datastore, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;   <span class="keywordtype">char</span> uuid_buf[<a class="code" href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a>];</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *uid_ptr = uid;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;   <span class="keywordflow">if</span> (!info) {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;   }</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;   datastore = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*datastore), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#adb6b8967d5861edcb38d2a36ad3349b7">session_datastore_destroy</a>);</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;   <span class="keywordflow">if</span> (!datastore) {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;   }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;   datastore-&gt;info = <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uid)) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">/* They didn&#39;t provide an ID so we&#39;ll provide one ourself */</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      uid_ptr = <a class="code" href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a>(uuid_buf, <span class="keyword">sizeof</span>(uuid_buf));</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;   }</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;   datastore-&gt;uid = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(uid_ptr);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;   <span class="keywordflow">if</span> (!datastore-&gt;uid) {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;   }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(datastore, +1);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;   <span class="keywordflow">return</span> datastore;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;}</div><div class="ttc" id="uuid_8h_html_a127408e53d34dca0c589a099fabf1e13"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#a127408e53d34dca0c589a099fabf1e13">AST_UUID_STR_LEN</a></div><div class="ttdeci">#define AST_UUID_STR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d1d/uuid_8h_source.html#l00027">uuid.h:27</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_adb6b8967d5861edcb38d2a36ad3349b7"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#adb6b8967d5861edcb38d2a36ad3349b7">session_datastore_destroy</a></div><div class="ttdeci">static void session_datastore_destroy(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01229">res_pjsip_session.c:1229</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="uuid_8h_html_abe6d0b550cd9a54964e7891960d1e5bc"><div class="ttname"><a href="../../dd/d1d/uuid_8h.html#abe6d0b550cd9a54964e7891960d1e5bc">ast_uuid_generate_str</a></div><div class="ttdeci">char * ast_uuid_generate_str(char *buf, size_t size)</div><div class="ttdoc">Generate a UUID string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/da9/uuid_8c_source.html#l00143">uuid.c:143</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa73c173cbf6b282f81a445ed05050cb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73c173cbf6b282f81a445ed05050cb9">&#9670;&nbsp;</a></span>ast_sip_session_create_invite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_create_invite </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data **&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates an INVITE request. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Starting session for the INVITE </td></tr>
    <tr><td class="paramname">tdata</td><td>The created request. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02847">2847</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00889">ast_sip_endpoint::preferred_codec_only</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01637">set_from_header()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02358">call()</a>.</p>
<div class="fragment"><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;{</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;   pjmedia_sdp_session *offer;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;   <span class="keywordflow">if</span> (!(offer = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      pjsip_inv_terminate(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 500, PJ_FALSE);</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Couldn&#39;t create offer\n&quot;</span>);</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;   }</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;   pjsip_inv_set_local_sdp(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, offer);</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;   pjmedia_sdp_neg_set_prefer_remote_codec_order(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;neg, PJ_FALSE);</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="preprocessor">#ifdef PJMEDIA_SDP_NEG_ANSWER_MULTIPLE_CODECS</span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a65d1205823395f1a6c4f8c1af4d18a50">preferred_codec_only</a>) {</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      pjmedia_sdp_neg_set_answer_multiple_codecs(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;neg, PJ_TRUE);</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;   }</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment">    * We MUST call set_from_header() before pjsip_inv_invite.  If we don&#39;t, the</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment">    * From in the initial INVITE will be wrong but the rest of the messages will be OK.</span></div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a74185467f13d0fd3860ef8a8762ca49d">set_from_header</a>(session);</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_invite(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;pjsip_inv_invite failed\n&quot;</span>);</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;   }</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0);</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a74185467f13d0fd3860ef8a8762ca49d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a74185467f13d0fd3860ef8a8762ca49d">set_from_header</a></div><div class="ttdeci">static void set_from_header(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01637">res_pjsip_session.c:1637</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a65d1205823395f1a6c4f8c1af4d18a50"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a65d1205823395f1a6c4f8c1af4d18a50">ast_sip_endpoint::preferred_codec_only</a></div><div class="ttdeci">unsigned int preferred_codec_only</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00889">res_pjsip.h:889</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae415668ea4e21bd1a053dece640e2f46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae415668ea4e21bd1a053dece640e2f46">&#9670;&nbsp;</a></span>ast_sip_session_create_outgoing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a>* ast_sip_session_create_outgoing </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *&#160;</td>
          <td class="paramname"><em>contact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>request_user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *&#160;</td>
          <td class="paramname"><em>req_topology</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new outgoing SIP session. </p>
<p>The endpoint that is passed in will have its reference count increased by one since the session will be keeping a reference to the endpoint. The session will relinquish this reference when the session is destroyed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">endpoint</td><td>The endpoint that this session uses for settings </td></tr>
    <tr><td class="paramname">contact</td><td>The contact that this session will communicate with </td></tr>
    <tr><td class="paramname">location</td><td>Name of the location to call, be it named location or explicit URI. Overrides contact if present. </td></tr>
    <tr><td class="paramname">request_user</td><td>Optional request user to place in the request URI if permitted </td></tr>
    <tr><td class="paramname">req_topology</td><td>The requested capabilities </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03317">3317</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00223">ast_sip_session::aor</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00821">ast_sip_endpoint::aors</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01765">ast_party_id_copy()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l01009">AST_SIP_CONTACT_FILTER_REACHABLE</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04028">ast_sip_create_dialog_uac()</a>, <a class="el" href="../../d0/dad/location_8c_source.html#l00272">ast_sip_location_retrieve_contact_and_aor_from_list_filtered()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../dc/d13/pjsip__session__caps_8c_source.html#l00130">ast_sip_session_create_joint_call_stream()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00168">AST_SIP_SESSION_OUTGOING_CALL</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00292">ast_stream_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00358">ast_stream_get_format_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00650">ast_stream_topology_alloc()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00748">ast_stream_topology_append_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00667">ast_stream_topology_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00936">ast_stream_topology_to_str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00241">ast_sip_session::call_direction</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00839">ast_sip_endpoint::extensions</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00578">ast_sip_endpoint_extensions::flags</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">ast_sip_session::id</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00847">ast_sip_endpoint::id</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00565">ast_sip_timer_options::min_se</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00629">ast_sip_endpoint_id_configuration::self</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00567">ast_sip_timer_options::sess_expires</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">session_end_completion()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03306">setup_outbound_invite_auth()</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l00360">timer</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00580">ast_sip_endpoint_extensions::timer</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00772">ast_sip_endpoint_media_configuration::topology</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00303">ast_sip_contact::uri</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02559">request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;{</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *uri = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d4/d03/structast__sip__aor.html">ast_sip_aor</a> *, found_aor, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a> *, found_contact, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;   pjsip_timer_setting <a class="code" href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>;</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;   <span class="keyword">struct </span>pjsip_inv_session *inv_session;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *ret_session;</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s %s Topology: %s\n&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint), request_user,</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(req_topology, &amp;STR_TMP)));</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;   <span class="comment">/* If no location has been provided use the AOR list from the endpoint itself */</span></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;   <span class="keywordflow">if</span> (location || !contact) {</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      location = <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(location, endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">aors</a>);</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac3d09ffbeec1bf7617e6d26084517d70">ast_sip_location_retrieve_contact_and_aor_from_list_filtered</a>(location, <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a8eecba6db028d0775d3208ed8b74926ea517c167e994d3131efdf30ef399c8e75">AST_SIP_CONTACT_FILTER_REACHABLE</a>,</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;         &amp;found_aor, &amp;found_contact);</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      <span class="keywordflow">if</span> (!found_contact || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(found_contact-&gt;uri)) {</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;         uri = location;</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;         uri = found_contact-&gt;uri;</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      }</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;      uri = contact-&gt;<a class="code" href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">uri</a>;</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;   }</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;   <span class="comment">/* If we still have no URI to dial fail to create the session */</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(uri)) {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Endpoint &#39;%s&#39;: No URI available.  Is endpoint registered?\n&quot;</span>,</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;         <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(endpoint));</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;No URI\n&quot;</span>);</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;   }</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;   <span class="keywordflow">if</span> (!(dlg = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a681ca1bf74a943a8009a5c2ad6894831">ast_sip_create_dialog_uac</a>(endpoint, uri, request_user))) {</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t create dialog\n&quot;</span>);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;   }</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a4937945ffae151bc235182493d104c8c">setup_outbound_invite_auth</a>(dlg)) {</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;      pjsip_dlg_terminate(dlg);</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t setup auth\n&quot;</span>);</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;   }</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_create_uac(dlg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>, &amp;inv_session) != PJ_SUCCESS) {</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      pjsip_dlg_terminate(dlg);</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t create uac\n&quot;</span>);</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;   }</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="preprocessor">#if defined(HAVE_PJSIP_REPLACE_MEDIA_STREAM) || defined(PJMEDIA_SDP_NEG_ALLOW_MEDIA_CHANGE)</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;   inv_session-&gt;sdp_neg_flags = PJMEDIA_SDP_NEG_ALLOW_MEDIA_CHANGE;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;   pjsip_timer_setting_default(&amp;timer);</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;   timer.min_se = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">timer</a>.<a class="code" href="../../d1/de1/structast__sip__timer__options.html#abc8cf95684205004f10203166581fc5d">min_se</a>;</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;   timer.sess_expires = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">timer</a>.<a class="code" href="../../d1/de1/structast__sip__timer__options.html#a3033f0fbb7aa3b8fbacf78ae177358d3">sess_expires</a>;</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;   pjsip_timer_init_session(inv_session, &amp;timer);</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ab4ae79a585283a422b758eddcd9663c2">ast_sip_session_alloc</a>(endpoint, found_contact ? found_contact : contact,</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;      inv_session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>) {</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;      pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;   }</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;aor = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(found_aor);</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;call_direction = <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c">AST_SIP_SESSION_OUTGOING_CALL</a>;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a>(&amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;id, &amp;endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">self</a>);</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(req_topology) &gt; 0) {</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      <span class="comment">/* get joint caps between req_topology and endpoint topology */</span></div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(req_topology); ++i) {</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *req_stream;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *clone_stream;</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;         req_stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(req_topology, i);</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(req_stream) == <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;         }</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;         clone_stream = <a class="code" href="../../dd/d20/res__pjsip__session__caps_8h.html#a84b461501e6bd34a40f40ab1a681d40f">ast_sip_session_create_joint_call_stream</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, req_stream);</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;         <span class="keywordflow">if</span> (!clone_stream || <a class="code" href="../../d8/d95/stream_8h.html#a6cc9bce25a44e3d9074337e2c882f445">ast_stream_get_format_count</a>(clone_stream) == 0) {</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a>(clone_stream);</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;         }</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;            <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology = <a class="code" href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a>();</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;               pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t create topology\n&quot;</span>);</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;            }</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;         }</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology, clone_stream) &lt; 0) {</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a>(clone_stream);</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;         }</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      }</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;   }</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      <span class="comment">/* Use the configured topology on the endpoint as the pending one */</span></div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology = <a class="code" href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a>(endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state-&gt;topology) {</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;         pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t clone topology\n&quot;</span>);</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      }</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;   }</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;   <span class="keywordflow">if</span> (pjsip_dlg_add_usage(dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      <span class="comment">/* Since we are not notifying ourselves that the INVITE session is being terminated</span></div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment">       * we need to manually drop its reference to session</span></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, -1);</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t add usage\n&quot;</span>);</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   }</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   <span class="comment">/* Avoid unnecessary ref manipulation to return a session */</span></div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;   ret_session = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;   <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(ret_session);</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_ab4ae79a585283a422b758eddcd9663c2"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ab4ae79a585283a422b758eddcd9663c2">ast_sip_session_alloc</a></div><div class="ttdeci">struct ast_sip_session * ast_sip_session_alloc(struct ast_sip_endpoint *endpoint, struct ast_sip_contact *contact, pjsip_inv_session *inv_session, pjsip_rx_data *rdata)</div><div class="ttdoc">Allocate a new SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">res_pjsip_session.c:2990</a></div></div>
<div class="ttc" id="structast__sip__timer__options_html_a3033f0fbb7aa3b8fbacf78ae177358d3"><div class="ttname"><a href="../../d1/de1/structast__sip__timer__options.html#a3033f0fbb7aa3b8fbacf78ae177358d3">ast_sip_timer_options::sess_expires</a></div><div class="ttdeci">unsigned int sess_expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00567">res_pjsip.h:567</a></div></div>
<div class="ttc" id="structast__sip__aor_html"><div class="ttname"><a href="../../d4/d03/structast__sip__aor.html">ast_sip_aor</a></div><div class="ttdoc">A SIP address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00361">res_pjsip.h:361</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a4937945ffae151bc235182493d104c8c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a4937945ffae151bc235182493d104c8c">setup_outbound_invite_auth</a></div><div class="ttdeci">static int setup_outbound_invite_auth(pjsip_dialog *dlg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03306">res_pjsip_session.c:3306</a></div></div>
<div class="ttc" id="channel_8h_html_abbf5c9830dd3533f3a6d5d35f941effb"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a></div><div class="ttdeci">void ast_party_id_copy(struct ast_party_id *dest, const struct ast_party_id *src)</div><div class="ttdoc">Copy the source party id information to the destination party id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01765">channel.c:1765</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="stream_8h_html_a6cc9bce25a44e3d9074337e2c882f445"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6cc9bce25a44e3d9074337e2c882f445">ast_stream_get_format_count</a></div><div class="ttdeci">int ast_stream_get_format_count(const struct ast_stream *stream)</div><div class="ttdoc">Get the count of the current negotiated formats of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00358">stream.c:358</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stream_8h_html_a452835913f7150a5045dd75ee822b491"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a></div><div class="ttdeci">int ast_stream_topology_append_stream(struct ast_stream_topology *topology, struct ast_stream *stream)</div><div class="ttdoc">Append a stream to the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00748">stream.c:748</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="structast__sip__timer__options_html_abc8cf95684205004f10203166581fc5d"><div class="ttname"><a href="../../d1/de1/structast__sip__timer__options.html#abc8cf95684205004f10203166581fc5d">ast_sip_timer_options::min_se</a></div><div class="ttdeci">unsigned int min_se</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00565">res_pjsip.h:565</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="stream_8h_html_a3da8d8e63718c47d43b9e738c7f6e55a"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a></div><div class="ttdeci">const char * ast_stream_topology_to_str(const struct ast_stream_topology *topology, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the topology for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00936">stream.c:936</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ac3d09ffbeec1bf7617e6d26084517d70"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ac3d09ffbeec1bf7617e6d26084517d70">ast_sip_location_retrieve_contact_and_aor_from_list_filtered</a></div><div class="ttdeci">void ast_sip_location_retrieve_contact_and_aor_from_list_filtered(const char *aor_list, unsigned int flags, struct ast_sip_aor **aor, struct ast_sip_contact **contact)</div><div class="ttdoc">Retrieve the first bound contact AND the AOR chosen from a list of AORs and filter based on flags...</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dad/location_8c_source.html#l00272">location.c:272</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50783ac9bc6f4943369ed254972049ac"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">ast_sip_endpoint::id</a></div><div class="ttdeci">struct ast_sip_endpoint_id_configuration id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00847">res_pjsip.h:847</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stream_8h_html_ad225f95d1de536ba61f43150cfe3bd06"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_alloc(void)</div><div class="ttdoc">Create a stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00650">stream.c:650</a></div></div>
<div class="ttc" id="structast__sip__contact_html"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html">ast_sip_contact</a></div><div class="ttdoc">Contact associated with an address of record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00281">res_pjsip.h:281</a></div></div>
<div class="ttc" id="structast__sip__endpoint__extensions_html_a28a4f505bc0cea6581fa6bde2161bced"><div class="ttname"><a href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">ast_sip_endpoint_extensions::timer</a></div><div class="ttdeci">struct ast_sip_timer_options timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00580">res_pjsip.h:580</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="stream_8h_html_a00b605b453fe5ff538e361126d600303"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_clone(const struct ast_stream_topology *topology)</div><div class="ttdoc">Create a deep clone of an existing stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00667">stream.c:667</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="stream_8h_html_acd53513fe1965d4e5d4581d79ef8d24c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a></div><div class="ttdeci">void ast_stream_free(struct ast_stream *stream)</div><div class="ttdoc">Destroy a media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00292">stream.c:292</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0aa8a8ab7a8e3f306a2b245215d38d218c">AST_SIP_SESSION_OUTGOING_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00168">res_pjsip_session.h:168</a></div></div>
<div class="ttc" id="structast__sip__endpoint__extensions_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../df/de5/structast__sip__endpoint__extensions.html#ac92588540e8c1d014a08cd8a45462b19">ast_sip_endpoint_extensions::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00578">res_pjsip.h:578</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_endpoint_media_configuration::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00772">res_pjsip.h:772</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a179b9758f096dc75be612d5f4e5f07cc"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a179b9758f096dc75be612d5f4e5f07cc">ast_sip_endpoint_id_configuration::self</a></div><div class="ttdeci">struct ast_party_id self</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00629">res_pjsip.h:629</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a76b100c44ffb8b301467785f3dd1c984"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">ast_sip_endpoint::extensions</a></div><div class="ttdeci">struct ast_sip_endpoint_extensions extensions</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00839">res_pjsip.h:839</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a681ca1bf74a943a8009a5c2ad6894831"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a681ca1bf74a943a8009a5c2ad6894831">ast_sip_create_dialog_uac</a></div><div class="ttdeci">pjsip_dialog * ast_sip_create_dialog_uac(const struct ast_sip_endpoint *endpoint, const char *aor_name, const char *request_user)</div><div class="ttdoc">General purpose method for creating a UAC dialog with an endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04028">res_pjsip.c:4028</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a8eecba6db028d0775d3208ed8b74926ea517c167e994d3131efdf30ef399c8e75"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a8eecba6db028d0775d3208ed8b74926ea517c167e994d3131efdf30ef399c8e75">AST_SIP_CONTACT_FILTER_REACHABLE</a></div><div class="ttdoc">Return only reachable or unknown contacts. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l01009">res_pjsip.h:1009</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50edbc089f02d537b9a487f1a62c889e"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50edbc089f02d537b9a487f1a62c889e">ast_sip_endpoint::aors</a></div><div class="ttdeci">const ast_string_field aors</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00821">res_pjsip.h:821</a></div></div>
<div class="ttc" id="structast__sip__contact_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../d8/d8a/structast__sip__contact.html#a19ac71226fac09e87afe31acb4c99214">ast_sip_contact::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00303">res_pjsip.h:303</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_a9aed6490b63794e6c9c00af4533f255f"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a></div><div class="ttdeci">static struct ast_timer * timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l00360">chan_iax2.c:360</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="res__pjsip__session__caps_8h_html_a84b461501e6bd34a40f40ab1a681d40f"><div class="ttname"><a href="../../dd/d20/res__pjsip__session__caps_8h.html#a84b461501e6bd34a40f40ab1a681d40f">ast_sip_session_create_joint_call_stream</a></div><div class="ttdeci">struct ast_stream * ast_sip_session_create_joint_call_stream(const struct ast_sip_session *session, struct ast_stream *remote)</div><div class="ttdoc">Create a new stream of joint capabilities. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d13/pjsip__session__caps_8c_source.html#l00130">pjsip_session_caps.c:130</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab099805fb795c60964dff130d6d15165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab099805fb795c60964dff130d6d15165">&#9670;&nbsp;</a></span>ast_sip_session_defer_termination()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_defer_termination </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defer local termination of a session until remote side terminates, or an amount of time passes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to defer termination on</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03554">3554</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">ast_sip_session::defer_end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">ast_sip_session::defer_terminate</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">ast_sip_session::ended_while_deferred</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00205">ast_sip_session::scheduled_termination</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03545">session_termination_cb()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, and <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00886">refer_incoming_blind_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;{</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;   pj_time_val delay = { .sec = 60, };</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;   <span class="comment">/* The session should not have an active deferred termination request. */</span></div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a>);</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a> = 1;</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">defer_end</a> = 1;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ended_while_deferred</a> = 0;</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;   pj_timer_entry_init(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">scheduled_termination</a>, 0, session, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a79606e824455a241d8eaaeef6bcc0a7c">session_termination_cb</a>);</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;   res = (pjsip_endpt_schedule_timer(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(),</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;      &amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">scheduled_termination</a>, &amp;delay) != PJ_SUCCESS) ? -1 : 0;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a> = 0;</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;   }</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ac2c154a795044fcfbadae5f1bab089df"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">ast_sip_session::defer_end</a></div><div class="ttdeci">unsigned int defer_end</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">res_pjsip_session.h:227</a></div></div>
<div class="ttc" id="structast__sip__session_html_a52a2a3cbcab65965d83205363c8f09d1"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">ast_sip_session::defer_terminate</a></div><div class="ttdeci">unsigned int defer_terminate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">res_pjsip_session.h:215</a></div></div>
<div class="ttc" id="structast__sip__session_html_aef6d512ea85f581bcfd51fba42d6e8e3"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ast_sip_session::ended_while_deferred</a></div><div class="ttdeci">unsigned int ended_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">res_pjsip_session.h:229</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a79606e824455a241d8eaaeef6bcc0a7c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a79606e824455a241d8eaaeef6bcc0a7c">session_termination_cb</a></div><div class="ttdeci">static void session_termination_cb(pj_timer_heap_t *timer_heap, struct pj_timer_entry *entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03545">res_pjsip_session.c:3545</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session_html_a5e674de8b1bb04f45fe397c9bdfe9c78"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">ast_sip_session::scheduled_termination</a></div><div class="ttdeci">pj_timer_entry scheduled_termination</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00205">res_pjsip_session.h:205</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a587c035e9aae3bf37049f886dc29dcb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a587c035e9aae3bf37049f886dc29dcb6">&#9670;&nbsp;</a></span>ast_sip_session_defer_termination_cancel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_defer_termination_cancel </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cancel a pending deferred termination. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to cancel a deferred termination on. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03596">3596</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">ast_sip_session::defer_terminate</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03588">sip_session_defer_termination_stop_timer()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">ast_sip_session::terminate_while_deferred</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00511">defer_termination_cancel_task()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, and <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00886">refer_incoming_blind_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;{</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a>) {</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      <span class="comment">/* Already canceled or timer fired. */</span></div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;   }</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a> = 0;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">terminate_while_deferred</a>) {</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      <span class="comment">/* Complete the termination started by the upper layer. */</span></div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a>(session, 0);</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;   }</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;   <span class="comment">/* Stop the termination timer if it is still running. */</span></div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8bd0100b8c103a8d8633eb0db236f6af">sip_session_defer_termination_stop_timer</a>(session);</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a52a2a3cbcab65965d83205363c8f09d1"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">ast_sip_session::defer_terminate</a></div><div class="ttdeci">unsigned int defer_terminate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">res_pjsip_session.h:215</a></div></div>
<div class="ttc" id="structast__sip__session_html_add232d9657a85f507655cda6c38b9e4a"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">ast_sip_session::terminate_while_deferred</a></div><div class="ttdeci">unsigned int terminate_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">res_pjsip_session.h:217</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8bd0100b8c103a8d8633eb0db236f6af"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8bd0100b8c103a8d8633eb0db236f6af">sip_session_defer_termination_stop_timer</a></div><div class="ttdeci">static void sip_session_defer_termination_stop_timer(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03588">res_pjsip_session.c:3588</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac548e363175ba43f7ad75438729deac3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a></div><div class="ttdeci">void ast_sip_session_terminate(struct ast_sip_session *session, int response)</div><div class="ttdoc">Terminate a session and, if possible, send the provided response code. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">res_pjsip_session.c:3451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa55296422ab86c7de1d7f52e9c227d82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa55296422ab86c7de1d7f52e9c227d82">&#9670;&nbsp;</a></span>ast_sip_session_end_if_deferred()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_end_if_deferred </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>End the session if it had been previously deferred. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to end if it had been deferred </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03614">3614</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">ast_sip_session::defer_end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">ast_sip_session::ended_while_deferred</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00511">defer_termination_cancel_task()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00553">refer_attended_task()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00789">refer_incoming_attended_request()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00886">refer_incoming_blind_request()</a>, and <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00502">session_end_if_deferred_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;{</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">defer_end</a>) {</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;   }</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">defer_end</a> = 0;</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ended_while_deferred</a>) {</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      <span class="comment">/* Complete the session end started by the remote hangup. */</span></div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Ending session after being deferred\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ended_while_deferred</a> = 0;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a>(session);</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;   }</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ac2c154a795044fcfbadae5f1bab089df"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">ast_sip_session::defer_end</a></div><div class="ttdeci">unsigned int defer_end</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">res_pjsip_session.h:227</a></div></div>
<div class="ttc" id="structast__sip__session_html_aef6d512ea85f581bcfd51fba42d6e8e3"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ast_sip_session::ended_while_deferred</a></div><div class="ttdeci">unsigned int ended_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">res_pjsip_session.h:229</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad11de1bfcc9846e016339bd3b482d16f"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a></div><div class="ttdeci">static int session_end(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">res_pjsip_session.c:4525</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b6e787aa2429e93f12e7be624ec3970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b6e787aa2429e93f12e7be624ec3970">&#9670;&nbsp;</a></span>ast_sip_session_get_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>* ast_sip_session_get_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a session datastore. </p>
<p>The datastore retrieved will have its reference count incremented. When the caller is done with the datastore, the reference counted needs to be decremented using <a class="el" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session from which to retrieve the datastore </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to retrieve </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>Failed to find the specified datastore </td></tr>
    <tr><td class="paramname">non-NULL</td><td>The specified datastore </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01285">1285</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00315">add_header()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00171">chan_pjsip_get_rtp_peer()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l00760">channel_read_pjsip()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00268">direct_media_mitigate_glare()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00187">handle_outgoing_response()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00196">incoming_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00576">outgoing_request()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00254">read_header()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00398">remove_header()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00202">t38_automatic_reject()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00231">t38_state_get_or_alloc()</a>, and <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00364">update_header()</a>.</p>
<div class="fragment"><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;{</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__session_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_session::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">res_pjsip_session.h:193</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a95797137ac1484fe2214be36db22f6dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95797137ac1484fe2214be36db22f6dd">&#9670;&nbsp;</a></span>ast_sip_session_get_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_sip_session_get_name </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the channel or endpoint name associated with the session. </p>
<dl class="section since"><dt>Since</dt><dd>18.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Channel</td><td>name or endpoint name or "unknown" </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">115</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04957">add_sdp_streams()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00682">answer()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02847">ast_sip_session_create_invite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03614">ast_sip_session_end_if_deferred()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">ast_sip_session_media_state_add()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02535">ast_sip_session_regenerate_answer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02358">call()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02385">chan_pjsip_call()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03241">chan_pjsip_incoming_ack()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03186">chan_pjsip_incoming_response()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03156">chan_pjsip_incoming_response_update_cause()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00547">chan_pjsip_new()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02950">chan_pjsip_session_begin()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02972">chan_pjsip_session_end()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01704">create_outgoing_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01621">generate_session_refresh_sdp()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00315">get_codecs()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03666">get_destination()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">handle_incoming_before_media()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">handle_incoming_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04449">handle_incoming_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">handle_outgoing_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">handle_outgoing_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01538">invite_collision_timeout()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">invite_proceeding()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01462">negotiate_incoming_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01549">on_topology_change_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03231">outbound_invite_auth()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03115">pbx_start_incoming_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04248">resend_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01575">send_topology_change_refresh()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05324">session_inv_on_media_update()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05236">session_inv_on_rx_offer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">session_inv_on_state_changed()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04215">session_on_rx_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04185">session_on_rx_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04163">session_on_tsx_state()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">session_outgoing_nat_hook()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00485">set_caps()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01637">set_from_header()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00438">set_incoming_call_offer_cap()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;(null session)&quot;</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d96ab8cbcc0f85012300573e3db2900"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d96ab8cbcc0f85012300573e3db2900">&#9670;&nbsp;</a></span>ast_sip_session_is_pending_stream_default()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_is_pending_stream_default </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines if a provided pending stream will be the default stream or not. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to check against </td></tr>
    <tr><td class="paramname">stream</td><td>The pending stream</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>if stream will be default </td></tr>
    <tr><td class="paramname">0</td><td>if stream will NOT be the default </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">359</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00316">ast_stream_get_type()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01704">create_outgoing_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01462">negotiate_incoming_sdp_stream()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>, and <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00485">set_caps()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Pending topology was NULL for channel &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> ? <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) : <span class="stringliteral">&quot;unknown&quot;</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(stream) == <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>); ++index) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index)) !=</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream)) {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index) == stream ? 1 : 0;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="stream_8h_html_a86319542b92fb0dc6b2ed337d83cf8ce"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a></div><div class="ttdeci">enum ast_media_type ast_stream_get_type(const struct ast_stream *stream)</div><div class="ttdoc">Get the media type of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00316">stream.c:316</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6bfa7d54f046b76d00644d3e650af6cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bfa7d54f046b76d00644d3e650af6cd">&#9670;&nbsp;</a></span>ast_sip_session_media_add_read_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_media_add_read_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#afd7121d8247121ec6170e3411bdd98da">ast_sip_session_media_read_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a read callback for a media session with a specific file descriptor. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session </td></tr>
    <tr><td class="paramname">session_media</td><td>The media session </td></tr>
    <tr><td class="paramname">fd</td><td>The file descriptor </td></tr>
    <tr><td class="paramname">callback</td><td>The read callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>the read callback was successfully added </td></tr>
    <tr><td class="paramname">-1</td><td>the read callback could not be added</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operations on the pending media state </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00385">385</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00135">ast_sip_session_media_read_callback_state::fd</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a> callback_state = {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      .<a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a> = <a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a>,</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      .read_callback = callback,</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      .session = session_media,</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   };</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="comment">/* The contents of the vector are whole structs and not pointers */</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;read_callbacks, callback_state);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a></div><div class="ttdoc">Structure which contains read callback information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00133">res_pjsip_session.h:133</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html_a6f8059414f0228f0256115e024eeed4b"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">ast_sip_session_media_read_callback_state::fd</a></div><div class="ttdeci">int fd</div><div class="ttdoc">The file descriptor itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00135">res_pjsip_session.h:135</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa29930c927d55f4f7a615a11766a6a09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa29930c927d55f4f7a615a11766a6a09">&#9670;&nbsp;</a></span>ast_sip_session_media_get_transport()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a>* ast_sip_session_media_get_transport </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the underlying media session that is acting as transport for a media session. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session </td></tr>
    <tr><td class="paramname">session_media</td><td>The media session to retrieve the transport for</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operates on the pending media state</dd>
<dd>
This function is guaranteed to return non-NULL </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00414">414</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00792">ast_sip_endpoint_media_configuration::bundle</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01704">create_outgoing_sdp_stream()</a>, and <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l01462">negotiate_incoming_sdp_stream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a> || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>)) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="keywordflow">return</span> session_media;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions); ++index) {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *bundle_group_session_media;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      bundle_group_session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions, index);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="comment">/* The first session which is in the bundle group is considered the authoritative session for transport */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <span class="keywordflow">if</span> (bundle_group_session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> == session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a>) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;         <span class="keywordflow">return</span> bundle_group_session_media;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">return</span> session_media;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a4b3a62121ed2ff9bebdfb879ad17cdef"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">ast_sip_endpoint_media_configuration::bundle</a></div><div class="ttdeci">unsigned int bundle</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00792">res_pjsip.h:792</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae799be93a0bc786802a9404362b236fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae799be93a0bc786802a9404362b236fa">&#9670;&nbsp;</a></span>ast_sip_session_media_set_write_callback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_media_set_write_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#ab727426f5a9d91957363388912fe378d">ast_sip_session_media_write_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a write callback for a media session. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session </td></tr>
    <tr><td class="paramname">session_media</td><td>The media session </td></tr>
    <tr><td class="paramname">callback</td><td>The write callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>the write callback was successfully add </td></tr>
    <tr><td class="paramname">-1</td><td>the write callback is already set to something different</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This operates on the pending media state </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00398">398</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00107">ast_sip_session_media::write_callback</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02065">apply_negotiated_sdp_stream()</a>.</p>
<div class="fragment"><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">write_callback</a>) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">write_callback</a> == callback) {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   }</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">write_callback</a> = callback;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="ttc" id="structast__sip__session__media_html_a25e03a749a471c5fbd87eab596cce9a7"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a25e03a749a471c5fbd87eab596cce9a7">ast_sip_session_media::write_callback</a></div><div class="ttdeci">ast_sip_session_media_write_cb write_callback</div><div class="ttdoc">The write callback when writing frames. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00107">res_pjsip_session.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0018e2a2f5cae3abe84426c44fee908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0018e2a2f5cae3abe84426c44fee908">&#9670;&nbsp;</a></span>ast_sip_session_media_state_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a>* ast_sip_session_media_state_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate an ast_session_media and add it to the media state's vector. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<p>This allocates a session media of the specified type. The position argument determines where in the vector that the new session media will be inserted.</p>
<dl class="section note"><dt>Note</dt><dd>The returned ast_session_media is the reference held by the vector. Callers of this function must NOT decrement the refcount of the session media.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Session on which to query active media state for </td></tr>
    <tr><td class="paramname">media_state</td><td>Media state to place the session media into </td></tr>
    <tr><td class="paramname">type</td><td>The type of the session media </td></tr>
    <tr><td class="paramname">position</td><td>Position at which to insert the new session media.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The active media state will be queried and if a media session already exists at the given position for the same type it will be reused instead of allocating a new one.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">490</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00347">ast_codec_media_type2str()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00309">ast_stream_get_name()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00792">ast_sip_endpoint_media_configuration::bundle</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">ast_sip_session_media::bundled</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00087">ast_sip_session_media::encryption</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00711">ast_sip_media_rtp_configuration::encryption</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00697">ast_sip_media_rtp_configuration::ice_support</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00091">ast_sip_session_media::keepalive_sched_id</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00103">ast_sip_session_media::remote_ice</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00101">ast_sip_session_media::remote_rtcp_mux</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00786">ast_sip_endpoint_media_configuration::rtcp_mux</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00764">ast_sip_endpoint_media_configuration::rtp</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">session_media_dtor()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00127">ast_sip_session_media::stream_name</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">ast_sip_session_media::stream_num</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00093">ast_sip_session_media::timeout_sched_id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">ast_sip_session_media::type</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00794">ast_sip_endpoint_media_configuration::webrtc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00367">t38_create_media_state()</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *current_session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Adding position %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), position);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="comment">/* It is possible for this media state to already contain a session for the stream. If this</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">    * is the case we simply return it.</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keywordflow">if</span> (position &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions)) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      current_session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;media_state-&gt;sessions, position);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">if</span> (current_session_media &amp;&amp; current_session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> == <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(current_session_media, <span class="stringliteral">&quot;Using existing media_session\n&quot;</span>);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <span class="comment">/* Determine if we can reuse the session media from the active media state if present */</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <span class="keywordflow">if</span> (position &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;sessions)) {</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;sessions, position);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">/* A stream can never exist without an accompanying media session */</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> == <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, +1);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Reusing existing media session\n&quot;</span>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">          * If this session_media was previously removed, its bundle group was probably reset</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">          * to -1 so if bundling is enabled on the endpoint, we need to reset it to 0, set</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">          * the bundled flag and reset its mid.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a> &amp;&amp; session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> == -1) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">bundled</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">webrtc</a>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = 0;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>, <span class="stringliteral">&quot;%s-%d&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>), position) &lt; 0) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, -1);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t alloc mid\n&quot;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Can&#39;t reuse existing media session because the types are different. %s &lt;&gt; %s\n&quot;</span>,</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>));</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;         session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="comment">/* No existing media session we can use so create a new one */</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      session_media = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*session_media), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a7a1020cea0d78fe4969869c10fd93973">session_media_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Creating new media session\n&quot;</span>);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a947ba038dc2e3de1a3d4ce24e88da1d4">encryption</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#a947ba038dc2e3de1a3d4ce24e88da1d4">encryption</a>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a52b71bbc800a8503cfca7eb90f00e23a">remote_ice</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#afc0a4cb1a5b0ecd8d4324bd8466788c2">ice_support</a>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a6f7b8add12e23680b28e4b88f70a1a83">remote_rtcp_mux</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a86ef296f0f63688c8273119a2611f876">rtcp_mux</a>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#af723510e5f7d3a2c82f5b9fe1e16802f">keepalive_sched_id</a> = -1;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a75b67fe2a02f4641321116ad6fa0253d">timeout_sched_id</a> = -1;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">stream_num</a> = position;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a>) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         <span class="comment">/* This is a new stream so create a new mid based on media type and position, which makes it unique.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">          * If this is the result of an offer the mid will just end up getting replaced.</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>, <span class="stringliteral">&quot;%s-%d&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>), position) &lt; 0) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, -1);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t alloc mid\n&quot;</span>);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = 0;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         <span class="comment">/* Some WebRTC clients can&#39;t handle an offer to bundle media streams. Instead they expect them to</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">          * already be bundled. Every client handles this scenario though so if WebRTC is enabled just go</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">          * ahead and treat the streams as having already been bundled.</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">bundled</a> = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">webrtc</a>;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = -1;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">stream_name</a>);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">stream_name</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, position)));</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;media_state-&gt;sessions, position, session_media)) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, -1);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;Couldn&#39;t replace media_session\n&quot;</span>);</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(current_session_media);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="comment">/* If this stream will be active in some way and it is the first of this type then consider this the default media session to match */</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <span class="keywordflow">if</span> (!media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] &amp;&amp; <a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, position)) != <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(1, <span class="stringliteral">&quot;Setting media session as default for %s\n&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>));</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] = session_media;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(session_media, <span class="stringliteral">&quot;Done\n&quot;</span>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div><div class="ttc" id="structast__sip__endpoint__media__configuration_html_aa64681ccac6f69e15c21471249e68121"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aa64681ccac6f69e15c21471249e68121">ast_sip_endpoint_media_configuration::webrtc</a></div><div class="ttdeci">unsigned int webrtc</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00794">res_pjsip.h:794</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__media__rtp__configuration_html_afc0a4cb1a5b0ecd8d4324bd8466788c2"><div class="ttname"><a href="../../dd/d14/structast__sip__media__rtp__configuration.html#afc0a4cb1a5b0ecd8d4324bd8466788c2">ast_sip_media_rtp_configuration::ice_support</a></div><div class="ttdeci">unsigned int ice_support</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00697">res_pjsip.h:697</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a86ef296f0f63688c8273119a2611f876"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a86ef296f0f63688c8273119a2611f876">ast_sip_endpoint_media_configuration::rtcp_mux</a></div><div class="ttdeci">unsigned int rtcp_mux</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00786">res_pjsip.h:786</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="codec_8h_html_a97df2e6b65823085173625553d2e06c5"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a></div><div class="ttdeci">const char * ast_codec_media_type2str(enum ast_media_type type)</div><div class="ttdoc">Conversion function to take a media type and turn it into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00347">codec.c:347</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a947ba038dc2e3de1a3d4ce24e88da1d4"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a947ba038dc2e3de1a3d4ce24e88da1d4">ast_sip_session_media::encryption</a></div><div class="ttdeci">enum ast_sip_session_media_encryption encryption</div><div class="ttdoc">What type of encryption is in use on this stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00087">res_pjsip_session.h:87</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_adde8efbb4df251209d1b3e05e166a025"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">ast_sip_session_media::bundled</a></div><div class="ttdeci">unsigned int bundled</div><div class="ttdoc">Whether this stream is currently bundled or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">res_pjsip_session.h:115</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3a6b074b7eab19c35ccf9ef22fb8e316"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">ast_sip_session_media::stream_name</a></div><div class="ttdeci">char * stream_name</div><div class="ttdoc">Stream name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00127">res_pjsip_session.h:127</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a0728d28b6a031937ed2546296d430561"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">ast_sip_endpoint_media_configuration::rtp</a></div><div class="ttdeci">struct ast_sip_media_rtp_configuration rtp</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00764">res_pjsip.h:764</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__media__rtp__configuration_html_a947ba038dc2e3de1a3d4ce24e88da1d4"><div class="ttname"><a href="../../dd/d14/structast__sip__media__rtp__configuration.html#a947ba038dc2e3de1a3d4ce24e88da1d4">ast_sip_media_rtp_configuration::encryption</a></div><div class="ttdeci">enum ast_sip_session_media_encryption encryption</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00711">res_pjsip.h:711</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a8383e75e786449dd2f4258b0819dd8f1"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">ast_sip_session_media::stream_num</a></div><div class="ttdeci">int stream_num</div><div class="ttdoc">The stream number to place into any resulting frames. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">res_pjsip_session.h:109</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a7a1020cea0d78fe4969869c10fd93973"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a7a1020cea0d78fe4969869c10fd93973">session_media_dtor</a></div><div class="ttdeci">static void session_media_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">res_pjsip_session.c:469</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a75b67fe2a02f4641321116ad6fa0253d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a75b67fe2a02f4641321116ad6fa0253d">ast_sip_session_media::timeout_sched_id</a></div><div class="ttdeci">int timeout_sched_id</div><div class="ttdoc">Scheduler ID for RTP timeout. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00093">res_pjsip_session.h:93</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_af723510e5f7d3a2c82f5b9fe1e16802f"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#af723510e5f7d3a2c82f5b9fe1e16802f">ast_sip_session_media::keepalive_sched_id</a></div><div class="ttdeci">int keepalive_sched_id</div><div class="ttdoc">Scheduler ID for RTP keepalive. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00091">res_pjsip_session.h:91</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a4b3a62121ed2ff9bebdfb879ad17cdef"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">ast_sip_endpoint_media_configuration::bundle</a></div><div class="ttdeci">unsigned int bundle</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00792">res_pjsip.h:792</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a57b08a6ad7a004d70eba4a1b6867a084"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">ast_sip_session_media::type</a></div><div class="ttdeci">enum ast_media_type type</div><div class="ttdoc">Media type of this session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">res_pjsip_session.h:105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a6f7b8add12e23680b28e4b88f70a1a83"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a6f7b8add12e23680b28e4b88f70a1a83">ast_sip_session_media::remote_rtcp_mux</a></div><div class="ttdeci">unsigned int remote_rtcp_mux</div><div class="ttdoc">Does remote support rtcp_mux. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00101">res_pjsip_session.h:101</a></div></div>
<div class="ttc" id="stream_8h_html_afcb45a1d2880128928cfb6d91b19ab46"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a></div><div class="ttdeci">const char * ast_stream_get_name(const struct ast_stream *stream)</div><div class="ttdoc">Get the name of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00309">stream.c:309</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a52b71bbc800a8503cfca7eb90f00e23a"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a52b71bbc800a8503cfca7eb90f00e23a">ast_sip_session_media::remote_ice</a></div><div class="ttdeci">unsigned int remote_ice</div><div class="ttdoc">Does remote support ice. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00103">res_pjsip_session.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a9996be2e7d0a6fe7df55098932f5f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a9996be2e7d0a6fe7df55098932f5f6">&#9670;&nbsp;</a></span>ast_sip_session_media_state_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a>* ast_sip_session_media_state_alloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a session media state structure. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">238</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00061">DEFAULT_NUM_SESSION_MEDIA</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">internal_sip_session_media_state_alloc()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00367">t38_create_media_state()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01524">topology_change_refresh_data_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a>(</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5e3aa3a6565c9201950caa9a3f7b31a6">DEFAULT_NUM_SESSION_MEDIA</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5e3aa3a6565c9201950caa9a3f7b31a6">DEFAULT_NUM_SESSION_MEDIA</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5e3aa3a6565c9201950caa9a3f7b31a6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5e3aa3a6565c9201950caa9a3f7b31a6">DEFAULT_NUM_SESSION_MEDIA</a></div><div class="ttdeci">#define DEFAULT_NUM_SESSION_MEDIA</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00061">res_pjsip_session.c:61</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad8fb456164755b6c4fc3df83e70c805c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a></div><div class="ttdeci">static struct ast_sip_session_media_state * internal_sip_session_media_state_alloc(size_t sessions, size_t read_callbacks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">res_pjsip_session.c:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76c9ec6c960e59090e7c6301c1bce890"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76c9ec6c960e59090e7c6301c1bce890">&#9670;&nbsp;</a></span>ast_sip_session_media_state_clone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a>* ast_sip_session_media_state_clone </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clone a media state. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">media_state</td><td>The media state to clone</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">297</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00316">ast_stream_get_type()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00667">ast_stream_topology_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">internal_sip_session_media_state_alloc()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00137">ast_sip_session_media_read_callback_state::read_callback</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00275">t38_reinvite_sdp_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *cloned;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keywordflow">if</span> (!media_state) {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   cloned = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a>(</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions),</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;read_callbacks));</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordflow">if</span> (!cloned) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="keywordflow">if</span> (media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">if</span> (!cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(cloned);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions); ++index) {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;media_state-&gt;sessions, index);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a> = <a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index));</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>(session_media);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;cloned-&gt;sessions, index, session_media)) {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session_media);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index)) != <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a> &amp;&amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;         !cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[type]) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         cloned-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] = session_media;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;read_callbacks); ++index) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a> *<a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a0d1e34d634c305bcb322d830f71da0af">read_callback</a> = <a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(&amp;media_state-&gt;read_callbacks, index);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;cloned-&gt;read_callbacks, index, *read_callback);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="keywordflow">return</span> cloned;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="stream_8h_html_a86319542b92fb0dc6b2ed337d83cf8ce"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a></div><div class="ttdeci">enum ast_media_type ast_stream_get_type(const struct ast_stream *stream)</div><div class="ttdoc">Get the media type of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00316">stream.c:316</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad8fb456164755b6c4fc3df83e70c805c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad8fb456164755b6c4fc3df83e70c805c">internal_sip_session_media_state_alloc</a></div><div class="ttdeci">static struct ast_sip_session_media_state * internal_sip_session_media_state_alloc(size_t sessions, size_t read_callbacks)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">res_pjsip_session.c:214</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html_a0d1e34d634c305bcb322d830f71da0af"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a0d1e34d634c305bcb322d830f71da0af">ast_sip_session_media_read_callback_state::read_callback</a></div><div class="ttdeci">ast_sip_session_media_read_cb read_callback</div><div class="ttdoc">The callback to invoke. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00137">res_pjsip_session.h:137</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a></div><div class="ttdoc">Structure which contains read callback information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00133">res_pjsip_session.h:133</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="stream_8h_html_a00b605b453fe5ff538e361126d600303"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_clone(const struct ast_stream_topology *topology)</div><div class="ttdoc">Create a deep clone of an existing stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00667">stream.c:667</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a></div><div class="ttdeci">ast_media_type</div><div class="ttdoc">Types of media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00030">codec.h:30</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a52106819ac5621fe89579644d4afd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a52106819ac5621fe89579644d4afd3">&#9670;&nbsp;</a></span>ast_sip_session_media_state_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_media_state_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free a session media state structure. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">344</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, and <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">ast_sip_session_media_state_clone()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">delayed_request_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01063">session_refresh_state_destroy()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00367">t38_create_media_state()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00290">t38_reinvite_response_cb()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00073">t38_state_destroy()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01516">topology_change_refresh_data_free()</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <span class="keywordflow">if</span> (!media_state) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <span class="comment">/* This will reset the internal state so we only have to free persistent things */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(media_state);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;media_state-&gt;sessions);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;media_state-&gt;read_callbacks);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(media_state);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae02f331ac12ec53a9f072a9862405055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae02f331ac12ec53a9f072a9862405055">&#9670;&nbsp;</a></span>ast_sip_session_media_state_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_media_state_reset </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset a media state to a clean state. </p>
<dl class="section since"><dt>Since</dt><dd>15.0.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">media_state</td><td>The media state to reset </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">278</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00036">AST_MEDIA_TYPE_END</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00743">ast_stream_topology_free()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00573">AST_VECTOR_ELEM_CLEANUP_NOOP</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00627">AST_VECTOR_RESET</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01549">on_topology_change_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05324">session_inv_on_media_update()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05236">session_inv_on_rx_offer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02733">session_reinvite_on_rx_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00290">t38_reinvite_response_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <span class="keywordflow">if</span> (!media_state) {</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   }</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a>(&amp;media_state-&gt;sessions, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a>(&amp;media_state-&gt;read_callbacks, <a class="code" href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a>; ++index) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[index] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="../../d8/d95/stream_8h.html#a88eca139ded2d5bbc6cdcf793febc265">ast_stream_topology_free</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;}</div><div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="vector_8h_html_a1885c25b9d767a53d1df9b641f53951a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a1885c25b9d767a53d1df9b641f53951a">AST_VECTOR_ELEM_CLEANUP_NOOP</a></div><div class="ttdeci">#define AST_VECTOR_ELEM_CLEANUP_NOOP(elem)</div><div class="ttdoc">Vector element cleanup that does nothing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00573">vector.h:573</a></div></div>
<div class="ttc" id="vector_8h_html_a0e59aa540254f87575cb1d28821bbd1f"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a></div><div class="ttdeci">#define AST_VECTOR_RESET(vec, cleanup)</div><div class="ttdoc">Reset vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00627">vector.h:627</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00036">codec.h:36</a></div></div>
<div class="ttc" id="stream_8h_html_a88eca139ded2d5bbc6cdcf793febc265"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a88eca139ded2d5bbc6cdcf793febc265">ast_stream_topology_free</a></div><div class="ttdeci">void ast_stream_topology_free(struct ast_stream_topology *topology)</div><div class="ttdoc">Unreference and destroy a stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00743">stream.c:743</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af57bfc75550b1312b46ef584410ae8a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af57bfc75550b1312b46ef584410ae8a9">&#9670;&nbsp;</a></span>ast_sip_session_media_stats_save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_media_stats_save </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>sip_session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a media stats. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">media_state</td><td>The media state to save </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">244</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../da/dbe/rtp__engine_8c_source.html#l02446">ast_rtp_instance_get_stats()</a>, <a class="el" href="../../d5/dde/rtp__engine_8h_source.html#l00182">AST_RTP_INSTANCE_STAT_ALL</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00256">AST_VECTOR_APPEND</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00488">AST_VECTOR_REMOVE_CMP_UNORDERED</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00204">media_stats_local_ssrc_cmp()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00077">ast_sip_session_media::rtp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <span class="keywordflow">if</span> (!media_state || !sip_session) {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;media_state-&gt;sessions); i++) {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a> *stats_tmp = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;media_state-&gt;sessions, i);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span> (!media || !media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      stats_tmp = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a>));</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span> (!stats_tmp) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      ret = <a class="code" href="../../d5/dde/rtp__engine_8h.html#a82a029e03affad8a6e1b322c0b9fe2c3">ast_rtp_instance_get_stats</a>(media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8adb8595b8127cbea2118fada1ef8782">rtp</a>, stats_tmp, <a class="code" href="../../d5/dde/rtp__engine_8h.html#a52d18270f48752558c84d7760c82378faf8772548ca3d011625888eb38c4511e4">AST_RTP_INSTANCE_STAT_ALL</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keywordflow">if</span> (ret) {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(stats_tmp);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="comment">/* remove all the duplicated stats if exist */</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996">AST_VECTOR_REMOVE_CMP_UNORDERED</a>(&amp;sip_session-&gt;media_stats, stats_tmp, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2a75356a9f850bf7c497f8a963719457">media_stats_local_ssrc_cmp</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a>(&amp;sip_session-&gt;media_stats, stats_tmp);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="ttc" id="rtp__engine_8h_html_a52d18270f48752558c84d7760c82378faf8772548ca3d011625888eb38c4511e4"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a52d18270f48752558c84d7760c82378faf8772548ca3d011625888eb38c4511e4">AST_RTP_INSTANCE_STAT_ALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00182">rtp_engine.h:182</a></div></div>
<div class="ttc" id="rtp__engine_8h_html_a82a029e03affad8a6e1b322c0b9fe2c3"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html#a82a029e03affad8a6e1b322c0b9fe2c3">ast_rtp_instance_get_stats</a></div><div class="ttdeci">int ast_rtp_instance_get_stats(struct ast_rtp_instance *instance, struct ast_rtp_instance_stats *stats, enum ast_rtp_instance_stat stat)</div><div class="ttdoc">Retrieve statistics about an RTP instance. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l02446">rtp_engine.c:2446</a></div></div>
<div class="ttc" id="vector_8h_html_a671c51a3e6202230ef9d2330624ea996"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a671c51a3e6202230ef9d2330624ea996">AST_VECTOR_REMOVE_CMP_UNORDERED</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE_CMP_UNORDERED(vec, value, cmp, cleanup)</div><div class="ttdoc">Remove an element from a vector that matches the given comparison. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00488">vector.h:488</a></div></div>
<div class="ttc" id="vector_8h_html_ae9d6199727f88a8c2407cb0e004e634a"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ae9d6199727f88a8c2407cb0e004e634a">AST_VECTOR_APPEND</a></div><div class="ttdeci">#define AST_VECTOR_APPEND(vec, elem)</div><div class="ttdoc">Append an element to a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00256">vector.h:256</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a8adb8595b8127cbea2118fada1ef8782"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a8adb8595b8127cbea2118fada1ef8782">ast_sip_session_media::rtp</a></div><div class="ttdeci">struct ast_rtp_instance * rtp</div><div class="ttdoc">RTP instance itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00077">res_pjsip_session.h:77</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a2a75356a9f850bf7c497f8a963719457"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a2a75356a9f850bf7c497f8a963719457">media_stats_local_ssrc_cmp</a></div><div class="ttdeci">static int media_stats_local_ssrc_cmp(const struct ast_rtp_instance_stats *vec_elem, const struct ast_rtp_instance_stats *srch)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00204">res_pjsip_session.c:204</a></div></div>
<div class="ttc" id="structast__rtp__instance__stats_html"><div class="ttname"><a href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00366">rtp_engine.h:366</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae45a3852c5bef6bf3719080907f02a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45a3852c5bef6bf3719080907f02a42">&#9670;&nbsp;</a></span>ast_sip_session_refresh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_refresh </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_request_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_sdp_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0d">ast_sip_session_refresh_method</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generate_new_sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a reinvite or UPDATE on a session. </p>
<p>This method will inspect the session in order to construct an appropriate session refresh request. As with any outgoing request in res_pjsip_session, this will call into registered supplements in case they wish to add anything.</p>
<p>Note: The on_request_creation callback may or may not be called in the same thread where this function is called. Request creation may need to be delayed due to the current INVITE transaction state.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which the reinvite will be sent </td></tr>
    <tr><td class="paramname">on_request_creation</td><td>Callback called when request is created </td></tr>
    <tr><td class="paramname">on_sdp_creation</td><td>Callback called when SDP is created </td></tr>
    <tr><td class="paramname">on_response</td><td>Callback called when response for request is received </td></tr>
    <tr><td class="paramname">method</td><td>The method that should be used when constructing the session refresh </td></tr>
    <tr><td class="paramname">generate_new_sdp</td><td>Boolean to indicate if a new SDP should be created </td></tr>
    <tr><td class="paramname">media_state</td><td>Optional requested media state for the SDP</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Successfully sent refresh </td></tr>
    <tr><td class="paramname">-1</td><td>Failure to send refresh</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If a media_state is passed in ownership will be taken in all cases </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02524">2524</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01513">dtmf_mode_refresh_cb()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01652">refresh_write_cb()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01490">remote_send_hold_refresh()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00396">send_direct_media_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01575">send_topology_change_refresh()</a>, <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00428">t38_interpret_parameters()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01429">update_connected_line_information()</a>.</p>
<div class="fragment"><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;{</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a>(session, on_request_creation, on_sdp_creation,</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      on_response, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, generate_new_sdp, media_state, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0);</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a9d68a08d3f45966f9c90fa2903aed739"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a></div><div class="ttdeci">static int sip_session_refresh(struct ast_sip_session *session, ast_sip_session_request_creation_cb on_request_creation, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, enum ast_sip_session_refresh_method method, int generate_new_sdp, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state, int queued)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">res_pjsip_session.c:2184</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a11c6ebf48a77449c1058861ff70a958a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c6ebf48a77449c1058861ff70a958a">&#9670;&nbsp;</a></span>ast_sip_session_regenerate_answer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_regenerate_answer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_sdp_creation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regenerate SDP Answer. </p>
<p>This method is used when an SDP offer has been received but an SDP answer has not been sent yet. It requests that a new local SDP be created and set as the SDP answer. As with any outgoing request in res_pjsip_session, this will call into registered supplements in case they wish to add anything.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which the answer will be updated </td></tr>
    <tr><td class="paramname">on_sdp_creation</td><td>Callback called when SDP is created </td></tr>
    <tr><td class="paramname">generate_new_sdp</td><td>Boolean to indicate if a new SDP should be created </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Successfully updated the SDP answer </td></tr>
    <tr><td class="paramname">-1</td><td>Failure to updated the SDP answer </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02535">2535</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01513">dtmf_mode_refresh_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;{</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;   pjsip_inv_session *inv_session = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   pjmedia_sdp_session *new_answer = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;   <span class="keyword">const</span> pjmedia_sdp_session *previous_offer = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;   <span class="comment">/* The SDP answer can only be regenerated if it is still pending to be sent */</span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   <span class="keywordflow">if</span> (!inv_session-&gt;neg || (pjmedia_sdp_neg_get_state(inv_session-&gt;neg) != PJMEDIA_SDP_NEG_STATE_REMOTE_OFFER &amp;&amp;</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      pjmedia_sdp_neg_get_state(inv_session-&gt;neg) != PJMEDIA_SDP_NEG_STATE_WAIT_NEGO)) {</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Requested to regenerate local SDP answer for channel &#39;%s&#39; but negotiation in state &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>), pjmedia_sdp_neg_state_str(pjmedia_sdp_neg_get_state(inv_session-&gt;neg)));</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Bad negotiation state\n&quot;</span>);</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   }</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;   pjmedia_sdp_neg_get_neg_remote(inv_session-&gt;neg, &amp;previous_offer);</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   <span class="keywordflow">if</span> (pjmedia_sdp_neg_get_state(inv_session-&gt;neg) == PJMEDIA_SDP_NEG_STATE_WAIT_NEGO) {</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <span class="comment">/* Transition the SDP negotiator back to when it received the remote offer */</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      pjmedia_sdp_neg_negotiate(inv_session-&gt;pool, inv_session-&gt;neg, 0);</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      pjmedia_sdp_neg_set_remote_offer(inv_session-&gt;pool, inv_session-&gt;neg, previous_offer);</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;   }</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;   new_answer = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(inv_session, session, previous_offer);</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;   <span class="keywordflow">if</span> (!new_answer) {</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Could not create a new local SDP answer for channel &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>));</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Couldn&#39;t create new SDP\n&quot;</span>);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;   }</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;   <span class="keywordflow">if</span> (on_sdp_creation) {</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <span class="keywordflow">if</span> (on_sdp_creation(session, new_answer)) {</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Callback failed\n&quot;</span>);</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      }</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;   }</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;   pjsip_inv_set_sdp_answer(inv_session, new_answer);</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0);</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30cf6ad5b4d5ad87ecfeb571a24fe8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30cf6ad5b4d5ad87ecfeb571a24fe8f8">&#9670;&nbsp;</a></span>ast_sip_session_register_sdp_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ast_sip_session_register_sdp_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>stream_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register an SDP handler. </p>
<p>An SDP handler is responsible for parsing incoming SDP streams and ensuring that Asterisk can cope with the contents. Similarly, the SDP handler will be responsible for constructing outgoing SDP streams.</p>
<p>Multiple handlers for the same stream type may be registered. They will be visited in the order they were registered. Handlers will be visited for each stream type until one claims to have handled the stream.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>The SDP handler to register </td></tr>
    <tr><td class="paramname">stream_type</td><td>The type of media stream for which to call the handler </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00138">138</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01549">ao2_link</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00680">AST_LIST_HEAD_INIT_NOLOCK</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">ast_sip_session_sdp_handler::id</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l01091">lock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">ast_sip_session_sdp_handler::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../dd/d42/lock_8h_source.html#l00602">SCOPED_AO2LOCK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02347">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *, handler_list,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, stream_type, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a>(<a class="code" href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">if</span> (handler_list) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *iter;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">/* Check if this handler is already registered for this stream type */</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;list, iter, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         <span class="keywordflow">if</span> (!strcmp(iter-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>)) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Handler &#39;%s&#39; already registered for stream type &#39;%s&#39;.\n&quot;</span>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, stream_type);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;         }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;handler_list-&gt;list, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Registered SDP stream handler &#39;%s&#39; for stream type &#39;%s&#39;\n&quot;</span>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, stream_type);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="comment">/* No stream of this type has been registered yet, so we need to create a new list */</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   handler_list = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*handler_list) + strlen(stream_type), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> (!handler_list) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="comment">/* Safe use of strcpy */</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   strcpy(handler_list-&gt;stream_type, stream_type);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;handler_list-&gt;list);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;handler_list-&gt;list, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, handler_list)) {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Registered SDP stream handler &#39;%s&#39; for stream type &#39;%s&#39;\n&quot;</span>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, stream_type);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">ast_sip_session_sdp_handler::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">res_pjsip_session.h:382</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aaa4f9cdda5dd0b1270fb35523054926c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">ast_sip_session_sdp_handler::next</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">res_pjsip_session.h:460</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="app__meetme_8c_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../df/d44/app__meetme_8c.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d44/app__meetme_8c_source.html#l01091">app_meetme.c:1091</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="lock_8h_html_a2cfb325ed371eb6e629446bac4676e9f"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a2cfb325ed371eb6e629446bac4676e9f">SCOPED_AO2LOCK</a></div><div class="ttdeci">#define SCOPED_AO2LOCK(varname, obj)</div><div class="ttdoc">scoped lock specialization for ao2 mutexes. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00602">lock.h:602</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0d1f922e093ac18824a7863fe3f5fa27"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT_NOLOCK(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00680">linkedlists.h:680</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a80752332a327901006cee3a209c03968"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80752332a327901006cee3a209c03968">&#9670;&nbsp;</a></span>ast_sip_session_remove_datastore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_remove_datastore </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove a session datastore from the session. </p>
<p>This operation may cause the datastore's <a class="el" href="../../da/dfd/gsm__destroy_8c.html#aafde19f7d36ca163a143579c1b125b6d">free()</a> callback to be called if the reference count reaches zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to remove the datastore from </td></tr>
    <tr><td class="paramname">name</td><td>The name of the datastore to remove </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01290">1290</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, and <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00268">direct_media_mitigate_glare()</a>, <a class="el" href="../../d2/d14/res__pjsip__send__to__voicemail_8c_source.html#l00187">handle_outgoing_response()</a>, <a class="el" href="../../d6/dd6/res__pjsip__header__funcs_8c_source.html#l00576">outgoing_request()</a>, <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01652">refresh_write_cb()</a>, and <a class="el" href="../../de/dfc/pjsip_2dialplan__functions_8c_source.html#l01078">session_refresh_state_get_or_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;{</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, (<span class="keywordtype">void</span> *) <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="structast__sip__session_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_session::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">res_pjsip_session.h:193</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add9e11223bb5b1c0e9ca30678e97dc0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add9e11223bb5b1c0e9ca30678e97dc0f">&#9670;&nbsp;</a></span>ast_sip_session_resume_reinvite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_resume_reinvite </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resumes processing of a deferred incoming re-invite. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session which has a pending incoming re-invite</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>When resuming a re-invite it is given to the pjsip stack as if it had just been received from a transport, this means that the deferral callback will be called again. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02798">2798</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00219">ast_sip_session::deferred_reinvite</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00202">t38_automatic_reject()</a>, and <a class="el" href="../../dc/d80/res__pjsip__t38_8c_source.html#l00428">t38_interpret_parameters()</a>.</p>
<div class="fragment"><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;{</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a>) {</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;   }</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      pjsip_endpt_process_rx_data(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(),</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;   }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;   pjsip_rx_data_free_cloned(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a>);</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">deferred_reinvite</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_a808f5363605eee5ebe8963b7b8ccad52"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a808f5363605eee5ebe8963b7b8ccad52">ast_sip_session::deferred_reinvite</a></div><div class="ttdeci">pjsip_rx_data * deferred_reinvite</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00219">res_pjsip_session.h:219</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35a7aa9427f3aea9384c1a481ce6a5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a7aa9427f3aea9384c1a481ce6a5f3">&#9670;&nbsp;</a></span>ast_sip_session_send_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_send_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a SIP request. </p>
<p>This will send the SIP request specified in tdata and call into any registered supplements' outgoing_request callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to which to send the request </td></tr>
    <tr><td class="paramname">tdata</td><td>The request to send </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">2842</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">ast_sip_session_send_request_with_cb()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02358">call()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04560">check_request_status()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">handle_incoming_before_media()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03231">outbound_invite_auth()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02218">transmit_info_dtmf()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01351">transmit_info_with_vidupdate()</a>.</p>
<div class="fragment"><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;{</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a>(session, tdata, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6e71dd1b8a6901e044953ff9e3a0343d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a></div><div class="ttdeci">void ast_sip_session_send_request_with_cb(struct ast_sip_session *session, pjsip_tx_data *tdata, ast_sip_session_response_cb on_response)</div><div class="ttdoc">Send a SIP request and get called back when a response is received. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">res_pjsip_session.c:2818</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e71dd1b8a6901e044953ff9e3a0343d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e71dd1b8a6901e044953ff9e3a0343d">&#9670;&nbsp;</a></span>ast_sip_session_send_request_with_cb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_send_request_with_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a SIP request and get called back when a response is received. </p>
<p>This will send the request out exactly the same as <a class="el" href="../../d8/d8c/res__pjsip_8h.html#a9302fd362f9d52147d928c5bc4740433" title="General purpose method for sending a SIP request. ">ast_sip_send_request()</a> does. The difference is that when a response arrives, the specified callback will be called into</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which to send the request </td></tr>
    <tr><td class="paramname">tdata</td><td>The request to send </td></tr>
    <tr><td class="paramname">on_response</td><td>Callback to be called when a response is received </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">2818</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02670">ast_sip_mod_data_set</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">handle_outgoing_request()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00057">MOD_DATA_ON_RESPONSE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;{</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;   pjsip_inv_session *inv_session = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;   <span class="comment">/* For every request except BYE we disallow sending of the message when</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment">    * the session has been disconnected. A BYE request is special though</span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">    * because it can be sent again after the session is disconnected except</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment">    * with credentials.</span></div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;   <span class="keywordflow">if</span> (inv_session-&gt;state == PJSIP_INV_STATE_DISCONNECTED &amp;&amp;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      tdata-&gt;msg-&gt;line.req.method.id != PJSIP_BYE_METHOD) {</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;   }</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a>(tdata-&gt;pool, tdata-&gt;mod_data, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id,</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;              <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a929623f98bee0fc9eb242c0bce08d227">MOD_DATA_ON_RESPONSE</a>, on_response);</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae1b7d51bdf278a523bbaa5086302552b">handle_outgoing_request</a>(session, tdata);</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;   pjsip_inv_send_msg(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, tdata);</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a929623f98bee0fc9eb242c0bce08d227"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a929623f98bee0fc9eb242c0bce08d227">MOD_DATA_ON_RESPONSE</a></div><div class="ttdeci">#define MOD_DATA_ON_RESPONSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00057">res_pjsip_session.c:57</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9937f98867d28da0cc0e8590d9c9ffa4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a></div><div class="ttdeci">#define ast_sip_mod_data_set(pool, mod_data, id, key, val)</div><div class="ttdoc">Utilizing a mod_data array for a given id, set the value associated with the given key...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02670">res_pjsip.h:2670</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae1b7d51bdf278a523bbaa5086302552b"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae1b7d51bdf278a523bbaa5086302552b">handle_outgoing_request</a></div><div class="ttdeci">static void handle_outgoing_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">res_pjsip_session.c:4481</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aed4c9a6bf6967790981c02027f5f02e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed4c9a6bf6967790981c02027f5f02e8">&#9670;&nbsp;</a></span>ast_sip_session_send_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_send_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a SIP response. </p>
<p>This will send the SIP response specified in tdata and call into any registered supplements' outgoing_response callback.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session on which to send the response. </td></tr>
    <tr><td class="paramname">tdata</td><td>The response to send </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">2576</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">handle_outgoing_response()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04215">session_on_rx_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04185">session_on_rx_response()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04163">session_on_tsx_state()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00682">answer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01333">indicate()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>, <a class="el" href="../../d1/d75/res__pjsip__refer_8c_source.html#l00969">refer_incoming_invite_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01877">transfer_redirect()</a>, and <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01429">update_connected_line_information()</a>.</p>
<div class="fragment"><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;{</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac8a7f2c555647574c05995ba10788c17">handle_outgoing_response</a>(session, tdata);</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;   pjsip_inv_send_msg(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, tdata);</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;   <span class="keywordflow">return</span>;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac8a7f2c555647574c05995ba10788c17"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac8a7f2c555647574c05995ba10788c17">handle_outgoing_response</a></div><div class="ttdeci">static void handle_outgoing_response(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">res_pjsip_session.c:4498</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af07a4b2b3de4cbbd66b09acb55ca3c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af07a4b2b3de4cbbd66b09acb55ca3c5e">&#9670;&nbsp;</a></span>ast_sip_session_suspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_suspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request and wait for the session serializer to be suspended. </p>
<dl class="section since"><dt>Since</dt><dd>12.7.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Which session to suspend the serializer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>No channel locks can be held while calling without risk of deadlock.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">3155</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00411">ao2_alloc</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00476">ao2_object_get_lockaddr()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00199">ast_cond_init</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00203">ast_cond_wait</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01207">ast_taskprocessor_is_suspended()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01266">ast_taskprocessor_is_task()</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01185">ast_taskprocessor_suspend()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">ast_sip_session_suspender::cond_complete</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">ast_sip_session_suspender::cond_suspended</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03134">sip_session_suspend_task()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03118">sip_session_suspender_dtor()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">ast_sip_session::suspended</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03114">ast_sip_session_suspender::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01612">chan_pjsip_indicate()</a>.</p>
<div class="fragment"><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;{</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a> *suspender;</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>)) {</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="comment">/* I am the session&#39;s serializer thread so I cannot suspend. */</span></div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;   }</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a37f9fcdd63017df32ddb3b2601d1e223">ast_taskprocessor_is_suspended</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>)) {</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      <span class="comment">/* The serializer already suspended. */</span></div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   }</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;   suspender = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*suspender), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6c7aeb0cc811ca617953f8b4c24a39f6">sip_session_suspender_dtor</a>);</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   <span class="keywordflow">if</span> (!suspender) {</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <span class="comment">/* We will just have to hope that the system does not deadlock */</span></div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;   }</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">cond_suspended</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">cond_complete</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(suspender, +1);</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;   res = <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5355aaa265e4a9ef57068b7dd8140870">sip_session_suspend_task</a>, suspender);</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      <span class="comment">/* We will just have to hope that the system does not deadlock */</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(suspender, -2);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;   }</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a> = suspender;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;   <span class="comment">/* Wait for the serializer to get suspended. */</span></div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(suspender);</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;   <span class="keywordflow">while</span> (!suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#af62c9334e77989174caccf53beee4215">suspended</a>) {</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">cond_suspended</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a>(suspender));</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;   }</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(suspender);</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#aeea7131da6b62d2e9b5d91c5de529d6c">ast_taskprocessor_suspend</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;}</div><div class="ttc" id="lock_8h_html_a36233c5520173c095bf732a788356aee"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a></div><div class="ttdeci">#define ast_cond_wait(cond, mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00203">lock.h:203</a></div></div>
<div class="ttc" id="lock_8h_html_a69e9591803d36f5683eb9b084442be9b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a69e9591803d36f5683eb9b084442be9b">ast_cond_init</a></div><div class="ttdeci">#define ast_cond_init(cond, attr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00199">lock.h:199</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a36ab60bbf09cfc0f5a3d5d41ed10cf81"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">ast_sip_session_suspender::cond_complete</a></div><div class="ttdeci">ast_cond_t cond_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">res_pjsip_session.c:3113</a></div></div>
<div class="ttc" id="astobj2_8h_html_a503b6c7ced96f9b56ec59c115cbeb29a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a></div><div class="ttdeci">void * ao2_object_get_lockaddr(void *obj)</div><div class="ttdoc">Return the mutex lock address of an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00476">astobj2.c:476</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_aeea7131da6b62d2e9b5d91c5de529d6c"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#aeea7131da6b62d2e9b5d91c5de529d6c">ast_taskprocessor_suspend</a></div><div class="ttdeci">int ast_taskprocessor_suspend(struct ast_taskprocessor *tps)</div><div class="ttdoc">Indicate the taskprocessor is suspended. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01185">taskprocessor.c:1185</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a4a66670abd8be00ab53bd9125a57574f"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a></div><div class="ttdeci">int ast_taskprocessor_is_task(struct ast_taskprocessor *tps)</div><div class="ttdoc">Am I the given taskprocessor&amp;#39;s current task. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01266">taskprocessor.c:1266</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_ad5a799b56c95ee841cdd4c0cfca4484e"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">ast_sip_session_suspender::cond_suspended</a></div><div class="ttdeci">ast_cond_t cond_suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">res_pjsip_session.c:3112</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a></div><div class="ttdoc">struct controlling the suspension of the session&amp;#39;s serializer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03111">res_pjsip_session.c:3111</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a37f9fcdd63017df32ddb3b2601d1e223"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a37f9fcdd63017df32ddb3b2601d1e223">ast_taskprocessor_is_suspended</a></div><div class="ttdeci">int ast_taskprocessor_is_suspended(struct ast_taskprocessor *tps)</div><div class="ttdoc">Get the task processor suspend status. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01207">taskprocessor.c:1207</a></div></div>
<div class="ttc" id="structast__sip__session_html_a965365a4589d683773f1eb2b6bb8e3f2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">ast_sip_session::suspended</a></div><div class="ttdeci">struct ast_sip_session_suspender * suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">res_pjsip_session.h:197</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6c7aeb0cc811ca617953f8b4c24a39f6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6c7aeb0cc811ca617953f8b4c24a39f6">sip_session_suspender_dtor</a></div><div class="ttdeci">static void sip_session_suspender_dtor(void *vdoomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03118">res_pjsip_session.c:3118</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_af62c9334e77989174caccf53beee4215"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#af62c9334e77989174caccf53beee4215">ast_sip_session_suspender::suspended</a></div><div class="ttdeci">int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03114">res_pjsip_session.c:3114</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5355aaa265e4a9ef57068b7dd8140870"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5355aaa265e4a9ef57068b7dd8140870">sip_session_suspend_task</a></div><div class="ttdeci">static int sip_session_suspend_task(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03134">res_pjsip_session.c:3134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac548e363175ba43f7ad75438729deac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac548e363175ba43f7ad75438729deac3">&#9670;&nbsp;</a></span>ast_sip_session_terminate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_terminate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminate a session and, if possible, send the provided response code. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to terminate </td></tr>
    <tr><td class="paramname">response</td><td>The response code to use for termination if possible</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Calling this function MAY cause the last session reference to be released and the session destructor to be called. If you need to do something with session after this call, be sure to bump the ref count before calling terminate. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">3451</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">ast_sip_session_media_stats_save()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">ast_sip_session_send_response()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">ast_sip_session::defer_terminate</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">DELAYED_METHOD_BYE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">delayed_request_free()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">ast_sip_session_delayed_request::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">session_end_completion()</a>, <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00146">status</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00230">SWAP</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">ast_sip_session::terminate_while_deferred</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03596">ast_sip_session_defer_termination_cancel()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l03007">chan_pjsip_incoming_request()</a>, <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l02483">hangup()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03530">session_termination_task()</a>.</p>
<div class="fragment"><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;{</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;   pj_status_t <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;   pjsip_tx_data *packet = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Response %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), response);</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a>) {</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">terminate_while_deferred</a> = 1;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Deferred\n&quot;</span>);</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;   }</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;   <span class="keywordflow">if</span> (!response) {</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;      response = 603;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;   }</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;   <span class="comment">/* The media sessions need to exist for the lifetime of the underlying channel</span></div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="comment">    * to ensure that anything (such as bridge_native_rtp) has access to them as</span></div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="comment">    * appropriate. Since ast_sip_session_terminate is called by chan_pjsip and other</span></div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">    * places when the session is to be terminated we terminate any existing</span></div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment">    * media sessions here.</span></div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a>(session, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>);</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;   <span class="keywordflow">switch</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;state) {</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;   <span class="keywordflow">case</span> PJSIP_INV_STATE_NULL:</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;invite_tsx) {</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;<span class="comment">          * Normally, it&#39;s pjproject&#39;s transaction cleanup that ultimately causes the</span></div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;<span class="comment">          * final session reference to be released but if both STATE and invite_tsx are NULL,</span></div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;<span class="comment">          * we never created a transaction in the first place.  In this case, we need to</span></div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;<span class="comment">          * do the cleanup ourselves.</span></div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;         <span class="comment">/* Transfer the inv_session session reference to the session_end_task */</span></div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;         pjsip_inv_terminate(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, response, PJ_TRUE);</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a>(session);</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;<span class="comment">          * session_end_completion will cleanup the final session reference unless</span></div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="comment">          * ast_sip_session_terminate&#39;s caller is holding one.</span></div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a>(session);</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;         pjsip_inv_terminate(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, response, PJ_TRUE);</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;      }</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;   <span class="keywordflow">case</span> PJSIP_INV_STATE_CONFIRMED:</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;invite_tsx) {</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Delay sending BYE because of outstanding transaction...\n&quot;</span>,</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;         <span class="comment">/* If this is delayed the only thing that will happen is a BYE request so we don&#39;t</span></div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;<span class="comment">          * actually need to store the response code for when it happens.</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a>(session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1);</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;      }</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      <span class="comment">/* Fall through */</span></div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;      status = pjsip_inv_end_session(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, response, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;packet);</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      <span class="keywordflow">if</span> (status == PJ_SUCCESS &amp;&amp; packet) {</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay;</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;         <span class="comment">/* Flush any delayed requests so they cannot overlap this transaction. */</span></div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;         <span class="keywordflow">while</span> ((delay = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>))) {</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a>(delay);</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;         }</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;         <span class="keywordflow">if</span> (packet-&gt;msg-&gt;type == PJSIP_RESPONSE_MSG) {</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(session, packet);</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a>(session, packet);</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;         }</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      }</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;   }</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>();</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a219b1d1405e2e3799cc9c784154c688d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a></div><div class="ttdeci">static int session_end_completion(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">res_pjsip_session.c:4548</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aed4c9a6bf6967790981c02027f5f02e8"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a></div><div class="ttdeci">void ast_sip_session_send_response(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">res_pjsip_session.c:2576</a></div></div>
<div class="ttc" id="structast__sip__session_html_a52a2a3cbcab65965d83205363c8f09d1"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">ast_sip_session::defer_terminate</a></div><div class="ttdeci">unsigned int defer_terminate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">res_pjsip_session.h:215</a></div></div>
<div class="ttc" id="structast__sip__session_html_add232d9657a85f507655cda6c38b9e4a"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#add232d9657a85f507655cda6c38b9e4a">ast_sip_session::terminate_while_deferred</a></div><div class="ttdeci">unsigned int terminate_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00217">res_pjsip_session.h:217</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a3a7a6a1e5210478116a640b215ef53b4"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a></div><div class="ttdeci">static int delay_request(struct ast_sip_session *session, ast_sip_session_request_creation_cb on_request, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, int generate_new_sdp, enum delayed_method method, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state, int queue_head)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">res_pjsip_session.c:1591</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abdb87d2e0451ce7382da2c5b23525c73"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a></div><div class="ttdeci">static void delayed_request_free(struct ast_sip_session_delayed_request *delay)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">res_pjsip_session.c:1379</a></div></div>
<div class="ttc" id="utils_8h_html_aac9153aee4bdb92701df902e06a74eb3"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a></div><div class="ttdeci">#define SWAP(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00230">utils.h:230</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a6371800ca2b62c38686de1486a19e799"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">ast_sip_session_delayed_request::next</a></div><div class="ttdeci">struct ast_sip_session_delayed_request * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">res_pjsip_session.c:1352</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad11de1bfcc9846e016339bd3b482d16f"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a></div><div class="ttdeci">static int session_end(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">res_pjsip_session.c:4525</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_af57bfc75550b1312b46ef584410ae8a9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a></div><div class="ttdeci">void ast_sip_session_media_stats_save(struct ast_sip_session *sip_session, struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Save a media stats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">res_pjsip_session.c:244</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></div><div class="ttdoc">Structure used for sending delayed requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01336">res_pjsip_session.c:1336</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a35a7aa9427f3aea9384c1a481ce6a5f3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a></div><div class="ttdeci">void ast_sip_session_send_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">res_pjsip_session.c:2842</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a22d632ac85810d8394ad5d54b83a2f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22d632ac85810d8394ad5d54b83a2f87">&#9670;&nbsp;</a></span>ast_sip_session_unregister_sdp_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_unregister_sdp_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>stream_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unregister an SDP handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>The SDP handler to unregister </td></tr>
    <tr><td class="paramname">stream_type</td><td>Stream type for which the SDP handler was registered </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00199">199</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01743">ao2_callback_data</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01048">OBJ_NODATA</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01043">OBJ_UNLINK</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00176">remove_handler()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l02324">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;{</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0989647a11cd5cd082cf357a387c47a7">remove_handler</a>, (<span class="keywordtype">void</span> *)stream_type, handler);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="astobj2_8h_html_a63fd831fe48aed32d3ef992ad8e45293"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a></div><div class="ttdeci">#define ao2_callback_data(container, flags, cb_fn, arg, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01743">astobj2.h:1743</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0989647a11cd5cd082cf357a387c47a7"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0989647a11cd5cd082cf357a387c47a7">remove_handler</a></div><div class="ttdeci">static int remove_handler(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00176">res_pjsip_session.c:176</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac37f93342a3e8ca33fb4ca84d4ac3e58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac37f93342a3e8ca33fb4ca84d4ac3e58">&#9670;&nbsp;</a></span>ast_sip_session_unsuspend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ast_sip_session_unsuspend </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request the session serializer be unsuspended. </p>
<dl class="section since"><dt>Since</dt><dd>12.7.0</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>Which session to unsuspend the serializer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Nothing </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03200">3200</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01196">ast_taskprocessor_unsuspend()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03115">ast_sip_session_suspender::complete</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">ast_sip_session_suspender::cond_complete</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">ast_sip_session::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l01612">chan_pjsip_indicate()</a>.</p>
<div class="fragment"><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;{</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a> *suspender = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a>;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;   <span class="keywordflow">if</span> (!suspender) {</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <span class="comment">/* Nothing to do */</span></div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;   }</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">suspended</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;   <span class="comment">/* Signal that the serializer task suspension is now complete. */</span></div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(suspender);</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;   suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a520408f4775914f7510cc59db5a60b38">complete</a> = 1;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">cond_complete</a>);</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(suspender);</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(suspender, -1);</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a8460a4b877658e3c2a6abbafcfa4c54c">ast_taskprocessor_unsuspend</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a36ab60bbf09cfc0f5a3d5d41ed10cf81"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">ast_sip_session_suspender::cond_complete</a></div><div class="ttdeci">ast_cond_t cond_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">res_pjsip_session.c:3113</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a520408f4775914f7510cc59db5a60b38"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a520408f4775914f7510cc59db5a60b38">ast_sip_session_suspender::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03115">res_pjsip_session.c:3115</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a8460a4b877658e3c2a6abbafcfa4c54c"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a8460a4b877658e3c2a6abbafcfa4c54c">ast_taskprocessor_unsuspend</a></div><div class="ttdeci">int ast_taskprocessor_unsuspend(struct ast_taskprocessor *tps)</div><div class="ttdoc">Indicate the taskprocessor is unsuspended. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01196">taskprocessor.c:1196</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a></div><div class="ttdoc">struct controlling the suspension of the session&amp;#39;s serializer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03111">res_pjsip_session.c:3111</a></div></div>
<div class="ttc" id="structast__sip__session_html_a965365a4589d683773f1eb2b6bb8e3f2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a965365a4589d683773f1eb2b6bb8e3f2">ast_sip_session::suspended</a></div><div class="ttdeci">struct ast_sip_session_suspender * suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00197">res_pjsip_session.h:197</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe8dc97b95461d434eb34460bac58036"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe8dc97b95461d434eb34460bac58036">&#9670;&nbsp;</a></span>AST_TEST_DEFINE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">test_resolve_refresh_media_states&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05660">5660</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00033">AST_MEDIA_TYPE_VIDEO</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00086">AST_STREAM_STATE_SENDONLY</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00082">AST_STREAM_STATE_SENDRECV</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05536">test_media_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;{</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;<span class="preprocessor">#define FREE_STATE() \</span></div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;<span class="preprocessor">({ \</span></div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;<span class="preprocessor">   ast_sip_session_media_state_free(new_pending_state); \</span></div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;<span class="preprocessor">   new_pending_state = NULL; \</span></div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;<span class="preprocessor">   ast_sip_session_media_state_free(delayed_pending_state); \</span></div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;<span class="preprocessor">   delayed_pending_state = NULL; \</span></div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;<span class="preprocessor">   ast_sip_session_media_state_free(delayed_active_state); \</span></div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;<span class="preprocessor">   delayed_active_state = NULL; \</span></div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;<span class="preprocessor">   ast_sip_session_media_state_free(current_active_state); \</span></div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;<span class="preprocessor">   current_active_state = NULL; \</span></div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;<span class="preprocessor">   ast_sip_session_media_state_free(expected_pending_state); \</span></div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;<span class="preprocessor">   expected_pending_state = NULL; \</span></div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;<span class="preprocessor">})</span></div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;<span class="preprocessor">#define RESET_STATE(__num) \</span></div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;<span class="preprocessor">({ \</span></div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;<span class="preprocessor">   testnum=__num; \</span></div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;<span class="preprocessor">   ast_trace(-1, &quot;Test %d\n&quot;, testnum); \</span></div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;<span class="preprocessor">   test_failed = 0; \</span></div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;<span class="preprocessor">   delayed_pending_state = ast_sip_session_media_state_alloc(); \</span></div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;<span class="preprocessor">   delayed_pending_state-&gt;topology = ast_stream_topology_alloc(); \</span></div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;<span class="preprocessor">   delayed_active_state = ast_sip_session_media_state_alloc(); \</span></div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;<span class="preprocessor">   delayed_active_state-&gt;topology = ast_stream_topology_alloc(); \</span></div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;<span class="preprocessor">   current_active_state = ast_sip_session_media_state_alloc(); \</span></div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;<span class="preprocessor">   current_active_state-&gt;topology = ast_stream_topology_alloc(); \</span></div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;<span class="preprocessor">   expected_pending_state = ast_sip_session_media_state_alloc(); \</span></div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;<span class="preprocessor">   expected_pending_state-&gt;topology = ast_stream_topology_alloc(); \</span></div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;<span class="preprocessor">})</span></div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;</div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;<span class="preprocessor">#define CHECKER() \</span></div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;<span class="preprocessor">({ \</span></div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;<span class="preprocessor">   new_pending_state = resolve_refresh_media_states(&quot;unittest&quot;, delayed_pending_state, delayed_active_state, current_active_state, 1); \</span></div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;<span class="preprocessor">   if (!test_is_media_state_equal(new_pending_state, expected_pending_state, 0)) { \</span></div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;<span class="preprocessor">      res = AST_TEST_FAIL; \</span></div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;<span class="preprocessor">      test_failed = 1; \</span></div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;<span class="preprocessor">      ast_test_status_update(test, &quot;da: %s\n&quot;, ast_str_tmp(256, ast_stream_topology_to_str(delayed_active_state-&gt;topology, &amp;STR_TMP))); \</span></div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;<span class="preprocessor">      ast_test_status_update(test, &quot;dp: %s\n&quot;, ast_str_tmp(256, ast_stream_topology_to_str(delayed_pending_state-&gt;topology, &amp;STR_TMP))); \</span></div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;<span class="preprocessor">      ast_test_status_update(test, &quot;ca: %s\n&quot;, ast_str_tmp(256, ast_stream_topology_to_str(current_active_state-&gt;topology, &amp;STR_TMP))); \</span></div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;<span class="preprocessor">      ast_test_status_update(test, &quot;ep: %s\n&quot;, ast_str_tmp(256, ast_stream_topology_to_str(expected_pending_state-&gt;topology, &amp;STR_TMP))); \</span></div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;<span class="preprocessor">      ast_test_status_update(test, &quot;np: %s\n&quot;, ast_str_tmp(256, ast_stream_topology_to_str(new_pending_state-&gt;topology, &amp;STR_TMP))); \</span></div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;<span class="preprocessor">   } \</span></div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;<span class="preprocessor">   ast_test_status_update(test, &quot;Test %d %s\n&quot;, testnum, test_failed ? &quot;FAILED&quot; : &quot;passed&quot;); \</span></div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;<span class="preprocessor">   ast_trace(-1, &quot;Test %d %s\n&quot;, testnum, test_failed ? &quot;FAILED&quot; : &quot;passed&quot;); \</span></div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;<span class="preprocessor">   test_failed = 0; \</span></div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;<span class="preprocessor">   FREE_STATE(); \</span></div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;<span class="preprocessor">})</span></div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> * delayed_pending_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> * delayed_active_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> * current_active_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> * new_pending_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> * expected_pending_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a> res = <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;   <span class="keywordtype">int</span> test_failed = 0;</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;   <span class="keywordtype">int</span> testnum = 0;</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1);</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;</div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = <span class="stringliteral">&quot;merge_refresh_topologies&quot;</span>;</div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <span class="stringliteral">&quot;/res/res_pjsip_session/&quot;</span>;</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test merging of delayed request topologies&quot;</span>;</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description = <span class="stringliteral">&quot;Test merging of delayed request topologies&quot;</span>;</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>);</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;   }</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(1);</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;</div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(2);</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;</div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(3);</div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;</div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;</div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(4);</div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;</div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(5);</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;</div><div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;</div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(6);</div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;</div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;</div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;</div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;</div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(7);</div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;</div><div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;</div><div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo6&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;</div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo6&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;</div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(8);</div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;</div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;</div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;</div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(9);</div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;</div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;</div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;</div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;</div><div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(10);</div><div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;</div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;</div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;</div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>, -1);</div><div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(11);</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;</div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;</div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;</div><div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;myvideo3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;</div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(12);</div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;292-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;296-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;</div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;292-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;296-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;297-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;294-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;</div><div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;292-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;296-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;290-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;297-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;</div><div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;292-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;296-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;290-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;297-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;294-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;</div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(13);</div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;293-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;292-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;294-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;295-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;296-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;</div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;293-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;292-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;294-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;295-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;296-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;298-7&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;</div><div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;293-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;292-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;294-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;295-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;296-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;290-6&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;</div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;293-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;292-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;294-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;295-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;296-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;290-6&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;298-7&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;</div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(14);</div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;297-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;</div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;294-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;295-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;</div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;297-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;291-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;294-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;</div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;297-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;291-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;294-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;295-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;</div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a>(15);</div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_active_state, <span class="stringliteral">&quot;297-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;</div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a>, -1);</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;294-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(delayed_pending_state, <span class="stringliteral">&quot;295-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;</div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;297-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;291-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;294-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(current_active_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;</div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;audio&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;297-2&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;291-3&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;294-4&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;298-1&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a>, -1);</div><div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a>(expected_pending_state, <span class="stringliteral">&quot;295-5&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>, -1);</div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a>();</div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res);</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;}</div><div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac6d34c98a864a1fbfc95c7c94772523c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac6d34c98a864a1fbfc95c7c94772523c">RESET_STATE</a></div><div class="ttdeci">#define RESET_STATE(__num)</div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abb3af098344ad4dbf62bff06fcd16630"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abb3af098344ad4dbf62bff06fcd16630">test_media_add</a></div><div class="ttdeci">static struct ast_sip_session_media * test_media_add(struct ast_sip_session_media_state *media_state, const char *name, enum ast_media_type type, enum ast_stream_state state, int position)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05536">res_pjsip_session.c:5536</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a></div><div class="ttdoc">Set when the stream is sending and receiving media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00082">stream.h:82</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a></div><div class="ttdoc">Set when the stream is sending media only. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00086">stream.h:86</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a05c8571bd4931208b4910ee2dcb4b035"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a05c8571bd4931208b4910ee2dcb4b035">CHECKER</a></div><div class="ttdeci">#define CHECKER()</div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044">ast_test_result_state</a></div><div class="ttdeci">ast_test_result_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00200">test.h:200</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a31909df5d02859b03a0933131828a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a31909df5d02859b03a0933131828a3">&#9670;&nbsp;</a></span>check_content_disposition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_content_disposition </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>if there is required media we don't understand, return 1 </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03891">3891</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03867">check_content_disposition_in_multipart()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>.</p>
<div class="fragment"><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;{</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;   pjsip_msg_body *body = rdata-&gt;msg_info.msg-&gt;body;</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;   pjsip_ctype_hdr *ctype_hdr = rdata-&gt;msg_info.ctype;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;   <span class="keywordflow">if</span> (body &amp;&amp; ctype_hdr &amp;&amp;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      !pj_stricmp2(&amp;ctype_hdr-&gt;media.type, <span class="stringliteral">&quot;multipart&quot;</span>) &amp;&amp;</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      (!pj_stricmp2(&amp;ctype_hdr-&gt;media.subtype, <span class="stringliteral">&quot;mixed&quot;</span>) ||</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;       !pj_stricmp2(&amp;ctype_hdr-&gt;media.subtype, <span class="stringliteral">&quot;alternative&quot;</span>))) {</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      pjsip_multipart_part *part = pjsip_multipart_get_first_part(body);</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      <span class="keywordflow">while</span> (part != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2c3b97913f8c270c46f5bfb240471b80">check_content_disposition_in_multipart</a>(part)) {</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;         }</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;         part = pjsip_multipart_get_next_part(body, part);</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;      }</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;   }</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a2c3b97913f8c270c46f5bfb240471b80"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a2c3b97913f8c270c46f5bfb240471b80">check_content_disposition_in_multipart</a></div><div class="ttdeci">static int check_content_disposition_in_multipart(pjsip_multipart_part *part)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03867">res_pjsip_session.c:3867</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c3b97913f8c270c46f5bfb240471b80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c3b97913f8c270c46f5bfb240471b80">&#9670;&nbsp;</a></span>check_content_disposition_in_multipart()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_content_disposition_in_multipart </td>
          <td>(</td>
          <td class="paramtype">pjsip_multipart_part *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03867">3867</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03855">check_sdp_content_type_supported()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03891">check_content_disposition()</a>.</p>
<div class="fragment"><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;{</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;   pjsip_hdr *hdr = part-&gt;hdr.next;</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t str_handling_required = {<span class="stringliteral">&quot;handling=required&quot;</span>, 16};</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;   <span class="keywordflow">while</span> (hdr != &amp;part-&gt;hdr) {</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;      <span class="keywordflow">if</span> (hdr-&gt;type == PJSIP_H_OTHER) {</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;         pjsip_generic_string_hdr *generic_hdr = (pjsip_generic_string_hdr*)hdr;</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;         <span class="keywordflow">if</span> (!pj_stricmp2(&amp;hdr-&gt;name, <span class="stringliteral">&quot;Content-Disposition&quot;</span>) &amp;&amp;</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;            pj_stristr(&amp;generic_hdr-&gt;hvalue, &amp;str_handling_required) &amp;&amp;</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;            !<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac85e74edae381bd1f6b54af290a9b842">check_sdp_content_type_supported</a>(&amp;part-&gt;body-&gt;content_type)) {</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;         }</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;      }</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;      hdr = hdr-&gt;next;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;   }</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_ac85e74edae381bd1f6b54af290a9b842"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac85e74edae381bd1f6b54af290a9b842">check_sdp_content_type_supported</a></div><div class="ttdeci">static int check_sdp_content_type_supported(pjsip_media_type *content_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03855">res_pjsip_session.c:3855</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2c628c905cb48254948233bf6b13e9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2c628c905cb48254948233bf6b13e9a">&#9670;&nbsp;</a></span>check_delayed_requests()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void check_delayed_requests </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *vsession)&#160;</td>
          <td class="paramname"><em>cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01582">1582</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;{</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, cb, session)) {</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;   }</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8abc4564c04174e2a18fbf190cbf051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8abc4564c04174e2a18fbf190cbf051">&#9670;&nbsp;</a></span>check_request_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_request_status </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_event *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04560">4560</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04871">ast_sip_failover_request()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">session_inv_on_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;{</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;   pjsip_transaction *tsx = e-&gt;body.tsx_state.tsx;</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;   <span class="keywordflow">if</span> (tsx-&gt;status_code != 503 &amp;&amp; tsx-&gt;status_code != 408) {</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;   }</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8c/res__pjsip_8h.html#afa22bc164a1c4108006f96822318ff14">ast_sip_failover_request</a>(tsx-&gt;last_tx)) {</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;   }</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;   pjsip_inv_uac_restart(inv, PJ_FALSE);</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;<span class="comment">    * Bump the ref since it will be on a new transaction and</span></div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;<span class="comment">    * we don&#39;t want it to go away along with the old transaction.</span></div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;   pjsip_tx_data_add_ref(tsx-&gt;last_tx);</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a>(session, tsx-&gt;last_tx);</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;}</div><div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_afa22bc164a1c4108006f96822318ff14"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#afa22bc164a1c4108006f96822318ff14">ast_sip_failover_request</a></div><div class="ttdeci">int ast_sip_failover_request(pjsip_tx_data *tdata)</div><div class="ttdoc">Set a request to use the next value in the list of resolved addresses. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04871">res_pjsip.c:4871</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a35a7aa9427f3aea9384c1a481ce6a5f3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a></div><div class="ttdeci">void ast_sip_session_send_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">res_pjsip_session.c:2842</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac85e74edae381bd1f6b54af290a9b842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac85e74edae381bd1f6b54af290a9b842">&#9670;&nbsp;</a></span>check_sdp_content_type_supported()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int check_sdp_content_type_supported </td>
          <td>(</td>
          <td class="paramtype">pjsip_media_type *&#160;</td>
          <td class="paramname"><em>content_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03855">3855</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03867">check_content_disposition_in_multipart()</a>.</p>
<div class="fragment"><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;{</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;   pjsip_media_type app_sdp;</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;   pjsip_media_type_init2(&amp;app_sdp, <span class="stringliteral">&quot;application&quot;</span>, <span class="stringliteral">&quot;sdp&quot;</span>);</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;   <span class="keywordflow">if</span> (!pjsip_media_type_cmp(content_type, &amp;app_sdp, 0)) {</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;   }</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a03b4a0d3ef8e1a50d76725863248cb0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03b4a0d3ef8e1a50d76725863248cb0c">&#9670;&nbsp;</a></span>create_local_sdp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct pjmedia_sdp_session * create_local_sdp </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>offer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">5081</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05011">add_bundle_groups()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04957">add_sdp_streams()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00758">ast_sip_endpoint_media_configuration::address</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02064">ast_random()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05473">ast_sip_get_host_ip_string()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">ast_sip_session_media_state_add()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00316">ast_stream_get_type()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00337">ast_stream_to_str()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00667">ast_stream_topology_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00743">ast_stream_topology_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00693">ast_sip_media_rtp_configuration::ipv6</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00764">ast_sip_endpoint_media_configuration::rtp</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00085">S_COR</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00834">SCOPE_EXIT_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00946">SCOPE_EXIT_LOG_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00940">SCOPE_EXIT_LOG_RTN_VALUE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00760">ast_sip_endpoint_media_configuration::sdpowner</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00762">ast_sip_endpoint_media_configuration::sdpsession</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00772">ast_sip_endpoint_media_configuration::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02847">ast_sip_session_create_invite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02535">ast_sip_session_regenerate_answer()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01621">generate_session_refresh_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05259">session_inv_on_create_offer()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05236">session_inv_on_rx_offer()</a>.</p>
<div class="fragment"><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;{</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t STR_IN = { <span class="stringliteral">&quot;IN&quot;</span>, 2 };</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t STR_IP4 = { <span class="stringliteral">&quot;IP4&quot;</span>, 3 };</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t STR_IP6 = { <span class="stringliteral">&quot;IP6&quot;</span>, 3 };</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;   pjmedia_sdp_session *local;</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;   <span class="keywordtype">int</span> stream;</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;   <span class="keywordflow">if</span> (inv-&gt;state == PJSIP_INV_STATE_DISCONNECTED) {</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Failed to create session SDP. Session has been already disconnected\n&quot;</span>,</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;   }</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;   <span class="keywordflow">if</span> (!inv-&gt;pool_prov || !(local = PJ_POOL_ZALLOC_T(inv-&gt;pool_prov, pjmedia_sdp_session))) {</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Pool allocation failure\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;   }</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;   <span class="keywordflow">if</span> (!offer) {</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;      local-&gt;origin.version = local-&gt;origin.id = (pj_uint32_t)(<a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>());</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;      local-&gt;origin.version = offer-&gt;origin.version + 1;</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;      local-&gt;origin.id = offer-&gt;origin.id;</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;   }</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;   pj_strdup2(inv-&gt;pool_prov, &amp;local-&gt;origin.user, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a6e7c09df19bdbed364e2b1a79960dd25">sdpowner</a>);</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;   pj_strdup2(inv-&gt;pool_prov, &amp;local-&gt;name, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aea372f8dfed8a35cc3a4d98e15a3b24a">sdpsession</a>);</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> || !<a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>)) {</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;      <span class="comment">/* We&#39;ve encountered a situation where we have been told to create a local SDP but noone has given us any indication</span></div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;<span class="comment">       * of what kind of stream topology they would like. We try to not alter the current state of the SDP negotiation</span></div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;<span class="comment">       * by using what is currently negotiated. If this is unavailable we fall back to what is configured on the endpoint.</span></div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;      <a class="code" href="../../d8/d95/stream_8h.html#a88eca139ded2d5bbc6cdcf793febc265">ast_stream_topology_free</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;      }</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: No pending media state topology\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;      }</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;   }</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Processing streams\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>); ++i) {</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media;</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i);</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> streams = local-&gt;media_count;</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(4, <span class="stringliteral">&quot;%s: Processing stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;      <span class="comment">/* This code does not enforce any maximum stream count limitations as that is done on either</span></div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="comment">       * the handling of an incoming SDP offer or on the handling of a session refresh.</span></div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;      session_media = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a>(session, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>, <a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream), i);</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;         local = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t alloc/add session media for stream %s\n&quot;</span>,</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;      }</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a55df57c5fbe99a5af456c2a9aaaccd20">add_sdp_streams</a>(session_media, session, local, offer, stream)) {</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;         local = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> end, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t add sdp streams for stream %s\n&quot;</span>,</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;      }</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;      <span class="comment">/* If a stream was actually added then add any additional details */</span></div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;      <span class="keywordflow">if</span> (streams != local-&gt;media_count) {</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;         pjmedia_sdp_media *media = local-&gt;media[streams];</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;         pj_str_t stmp;</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;         pjmedia_sdp_attr *attr;</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;         <span class="comment">/* Add the media identifier if present */</span></div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>)) {</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;            attr = pjmedia_sdp_attr_create(inv-&gt;pool_prov, <span class="stringliteral">&quot;mid&quot;</span>, pj_cstr(&amp;stmp, session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>));</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;            pjmedia_sdp_attr_add(&amp;media-&gt;attr_count, media-&gt;attr, attr);</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;         }</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Stream %s added%s%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)),</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>), <span class="stringliteral">&quot; with mid &quot;</span>, <span class="stringliteral">&quot;&quot;</span>), <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;</div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;      }</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;      <span class="comment">/* Ensure that we never exceed the maximum number of streams PJMEDIA will allow. */</span></div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;      <span class="keywordflow">if</span> (local-&gt;media_count == PJMEDIA_MAX_SDP_MEDIA) {</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">break</span>, <span class="stringliteral">&quot;%s: Stream %s exceeded max pjmedia count of %d\n&quot;</span>,</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)),</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;            PJMEDIA_MAX_SDP_MEDIA);</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;      }</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s: Done with %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;   }</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;   <span class="comment">/* Add any bundle groups that are present on the media state */</span></div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Adding bundle groups (if available)\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a77986e41ff1baa560a998e2b00e55f57">add_bundle_groups</a>(session, inv-&gt;pool_prov, local)) {</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t add bundle groups\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;   }</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;   <span class="comment">/* Use the connection details of an available media if possible for SDP level */</span></div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Copying connection details\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;   <span class="keywordflow">for</span> (stream = 0; stream &lt; local-&gt;media_count; stream++) {</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(4, <span class="stringliteral">&quot;%s: Processing media %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), stream);</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      <span class="keywordflow">if</span> (!local-&gt;media[stream]-&gt;conn) {</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Media %d has no connection info\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), stream);</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;      }</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;      <span class="keywordflow">if</span> (local-&gt;conn) {</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;         <span class="keywordflow">if</span> (!pj_strcmp(&amp;local-&gt;conn-&gt;net_type, &amp;local-&gt;media[stream]-&gt;conn-&gt;net_type) &amp;&amp;</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;            !pj_strcmp(&amp;local-&gt;conn-&gt;addr_type, &amp;local-&gt;media[stream]-&gt;conn-&gt;addr_type) &amp;&amp;</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;            !pj_strcmp(&amp;local-&gt;conn-&gt;addr, &amp;local-&gt;media[stream]-&gt;conn-&gt;addr)) {</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;            local-&gt;media[stream]-&gt;conn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;         }</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Media %d has good existing connection info\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), stream);</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;      }</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;      <span class="comment">/* This stream&#39;s connection info will serve as the connection details for SDP level */</span></div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;      local-&gt;conn = local-&gt;media[stream]-&gt;conn;</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;      local-&gt;media[stream]-&gt;conn = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Media %d reset\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), stream);</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;   }</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;   <span class="comment">/* If no SDP level connection details are present then create some */</span></div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;   <span class="keywordflow">if</span> (!local-&gt;conn) {</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Creating connection details\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;      local-&gt;conn = pj_pool_zalloc(inv-&gt;pool_prov, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> pjmedia_sdp_conn));</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;      local-&gt;conn-&gt;net_type = STR_IN;</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;      local-&gt;conn-&gt;addr_type = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#afe8dd140f860d3270f0a530f86521bf2">ipv6</a> ? STR_IP6 : STR_IP4;</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#adfdf62b1e020aa0785512e95b7548093">address</a>)) {</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;         pj_strdup2(inv-&gt;pool_prov, &amp;local-&gt;conn-&gt;addr, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#adfdf62b1e020aa0785512e95b7548093">address</a>);</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;         pj_strdup2(inv-&gt;pool_prov, &amp;local-&gt;conn-&gt;addr, <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ac6da8e5c5006c0a1c81feb1198ab7e6e">ast_sip_get_host_ip_string</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#afe8dd140f860d3270f0a530f86521bf2">ipv6</a> ? pj_AF_INET6() : pj_AF_INET()));</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;      }</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;   }</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;   pj_strassign(&amp;local-&gt;origin.net_type, &amp;local-&gt;conn-&gt;net_type);</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;   pj_strassign(&amp;local-&gt;origin.addr_type, &amp;local-&gt;conn-&gt;addr_type);</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;   pj_strassign(&amp;local-&gt;origin.addr, &amp;local-&gt;conn-&gt;addr);</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(local, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;}</div><div class="ttc" id="logger_8h_html_a5eff4ad268db72883e5e152070c3583f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN_VALUE(__value, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00940">logger.h:940</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="stream_8h_html_af793e90c3796564a01574fd9c5e9e208"><div class="ttname"><a href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a></div><div class="ttdeci">const char * ast_stream_to_str(const struct ast_stream *stream, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the stream for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00337">stream.c:337</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="stream_8h_html_a86319542b92fb0dc6b2ed337d83cf8ce"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a></div><div class="ttdeci">enum ast_media_type ast_stream_get_type(const struct ast_stream *stream)</div><div class="ttdoc">Get the media type of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00316">stream.c:316</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_aea372f8dfed8a35cc3a4d98e15a3b24a"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#aea372f8dfed8a35cc3a4d98e15a3b24a">ast_sip_endpoint_media_configuration::sdpsession</a></div><div class="ttdeci">const ast_string_field sdpsession</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00762">res_pjsip.h:762</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_adfdf62b1e020aa0785512e95b7548093"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#adfdf62b1e020aa0785512e95b7548093">ast_sip_endpoint_media_configuration::address</a></div><div class="ttdeci">const ast_string_field address</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00758">res_pjsip.h:758</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a469acd2a62f3cc8ab2f9f0b5e1c2b8ff"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_EXPR(__expr, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00946">logger.h:946</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ac6da8e5c5006c0a1c81feb1198ab7e6e"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ac6da8e5c5006c0a1c81feb1198ab7e6e">ast_sip_get_host_ip_string</a></div><div class="ttdeci">const char * ast_sip_get_host_ip_string(int af)</div><div class="ttdoc">Retrieve the local host address in string form. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05473">res_pjsip.c:5473</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a6e7c09df19bdbed364e2b1a79960dd25"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a6e7c09df19bdbed364e2b1a79960dd25">ast_sip_endpoint_media_configuration::sdpowner</a></div><div class="ttdeci">const ast_string_field sdpowner</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00760">res_pjsip.h:760</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a0728d28b6a031937ed2546296d430561"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">ast_sip_endpoint_media_configuration::rtp</a></div><div class="ttdeci">struct ast_sip_media_rtp_configuration rtp</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00764">res_pjsip.h:764</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="utils_8h_html_a7b4f10b070e95ba413e258a3e4b03c20"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a></div><div class="ttdeci">long int ast_random(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02064">main/utils.c:2064</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="logger_8h_html_a91ab9408bcc739e24e6eab78d752585c"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_EXPR(__expr,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00834">logger.h:834</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a55df57c5fbe99a5af456c2a9aaaccd20"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a55df57c5fbe99a5af456c2a9aaaccd20">add_sdp_streams</a></div><div class="ttdeci">static int add_sdp_streams(struct ast_sip_session_media *session_media, struct ast_sip_session *session, pjmedia_sdp_session *answer, const struct pjmedia_sdp_session *remote, struct ast_stream *stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04957">res_pjsip_session.c:4957</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae0018e2a2f5cae3abe84426c44fee908"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a></div><div class="ttdeci">struct ast_sip_session_media * ast_sip_session_media_state_add(struct ast_sip_session *session, struct ast_sip_session_media_state *media_state, enum ast_media_type type, int position)</div><div class="ttdoc">Allocate an ast_session_media and add it to the media state&amp;#39;s vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">res_pjsip_session.c:490</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a77986e41ff1baa560a998e2b00e55f57"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a77986e41ff1baa560a998e2b00e55f57">add_bundle_groups</a></div><div class="ttdeci">static int add_bundle_groups(struct ast_sip_session *session, pj_pool_t *pool, pjmedia_sdp_session *answer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05011">res_pjsip_session.c:5011</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="stream_8h_html_a00b605b453fe5ff538e361126d600303"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_clone(const struct ast_stream_topology *topology)</div><div class="ttdoc">Create a deep clone of an existing stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00667">stream.c:667</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_endpoint_media_configuration::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00772">res_pjsip.h:772</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="structast__sip__media__rtp__configuration_html_afe8dd140f860d3270f0a530f86521bf2"><div class="ttname"><a href="../../dd/d14/structast__sip__media__rtp__configuration.html#afe8dd140f860d3270f0a530f86521bf2">ast_sip_media_rtp_configuration::ipv6</a></div><div class="ttdeci">unsigned int ipv6</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00693">res_pjsip.h:693</a></div></div>
<div class="ttc" id="stream_8h_html_a88eca139ded2d5bbc6cdcf793febc265"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a88eca139ded2d5bbc6cdcf793febc265">ast_stream_topology_free</a></div><div class="ttdeci">void ast_stream_topology_free(struct ast_stream_topology *topology)</div><div class="ttdoc">Unreference and destroy a stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00743">stream.c:743</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac60c8c7a11b9aa2b347630c7d08af17d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac60c8c7a11b9aa2b347630c7d08af17d">&#9670;&nbsp;</a></span>datastore_cmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int datastore_cmp </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02888">2888</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01031">CMP_MATCH</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01032">CMP_STOP</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, and <a class="el" href="../../d9/db6/datastore_8h_source.html#l00069">ast_datastore::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;{</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore1 = obj;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore2 = arg;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *uid2 = flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> ? arg : datastore2-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(datastore1-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(uid2 != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;   <span class="keywordflow">return</span> strcmp(datastore1-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>, uid2) ? 0 : <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__datastore_html_a2daadcdbac635c83b7bfc6375b4c9be4"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">ast_datastore::uid</a></div><div class="ttdeci">const char * uid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00069">datastore.h:69</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae586d6908c81e9a59e0e68358c12c9cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae586d6908c81e9a59e0e68358c12c9cc">&#9670;&nbsp;</a></span>datastore_hash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int datastore_hash </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02878">2878</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01206">ast_str_hash()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, and <a class="el" href="../../d9/db6/datastore_8h_source.html#l00069">ast_datastore::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;{</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore = obj;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a> = flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> ? obj : datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(uid != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a>(uid);</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__datastore_html_a2daadcdbac635c83b7bfc6375b4c9be4"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">ast_datastore::uid</a></div><div class="ttdeci">const char * uid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00069">datastore.h:69</a></div></div>
<div class="ttc" id="strings_8h_html_a33ab7fa091d5513d8507d3bd33ef5b55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_hash(const char *str)</div><div class="ttdoc">Compute a hash value on a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01206">strings.h:1206</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a7a6a1e5210478116a640b215ef53b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a7a6a1e5210478116a640b215ef53b4">&#9670;&nbsp;</a></span>delay_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int delay_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_sdp_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generate_new_sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>pending_media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>active_media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>queue_head</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">1591</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00710">AST_LIST_INSERT_HEAD</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">DELAYED_METHOD_BYE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01355">delayed_request_alloc()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">ast_sip_session_delayed_request::next</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00940">SCOPE_EXIT_LOG_RTN_VALUE</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;{</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa8484802d8796789080e644555eb2d04">delayed_request_alloc</a>(<a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>,</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;         on_request, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">on_sdp_creation</a>, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">on_response</a>, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">generate_new_sdp</a>, pending_media_state,</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;         active_media_state);</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;   <span class="keywordflow">if</span> (!delay) {</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to allocate delay request\n&quot;</span>);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;   }</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a> || queue_head) {</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="comment">/* Send BYE as early as possible */</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>, delay, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>, delay, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;   }</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0);</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;}</div><div class="ttc" id="logger_8h_html_a5eff4ad268db72883e5e152070c3583f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN_VALUE(__value, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00940">logger.h:940</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a715bc377d91f54bbdfb6f92b729fe273"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">ast_sip_session_delayed_request::on_sdp_creation</a></div><div class="ttdeci">ast_sip_session_sdp_creation_cb on_sdp_creation</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01342">res_pjsip_session.c:1342</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a6371800ca2b62c38686de1486a19e799"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">ast_sip_session_delayed_request::next</a></div><div class="ttdeci">struct ast_sip_session_delayed_request * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">res_pjsip_session.c:1352</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a25bb4ff3d06ce7d015a8ed92849d2bfc"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">ast_sip_session_delayed_request::generate_new_sdp</a></div><div class="ttdeci">int generate_new_sdp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01346">res_pjsip_session.c:1346</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa2ded2af046bb513f77056c27c083307"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a></div><div class="ttdeci">#define AST_LIST_INSERT_HEAD(head, elm, field)</div><div class="ttdoc">Inserts a list entry at the head of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00710">linkedlists.h:710</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa8484802d8796789080e644555eb2d04"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa8484802d8796789080e644555eb2d04">delayed_request_alloc</a></div><div class="ttdeci">static struct ast_sip_session_delayed_request * delayed_request_alloc(enum delayed_method method, ast_sip_session_request_creation_cb on_request_creation, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, int generate_new_sdp, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01355">res_pjsip_session.c:1355</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></div><div class="ttdoc">Structure used for sending delayed requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01336">res_pjsip_session.c:1336</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_afcd45a052e625a4b6a24d35d47f4c769"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">ast_sip_session_delayed_request::on_response</a></div><div class="ttdeci">ast_sip_session_response_cb on_response</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01344">res_pjsip_session.c:1344</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a511a1f5d1b239c41b9eb4953ae4386ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a511a1f5d1b239c41b9eb4953ae4386ea">&#9670;&nbsp;</a></span>delayed_method2str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static const char* delayed_method2str </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a>&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01310">1310</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">DELAYED_METHOD_BYE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">DELAYED_METHOD_INVITE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">DELAYED_METHOD_UPDATE</a>, and <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00147">str</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">invite_proceeding()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;{</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>) {</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>:</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      str = <span class="stringliteral">&quot;INVITE&quot;</span>;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a>:</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      str = <span class="stringliteral">&quot;UPDATE&quot;</span>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>:</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      str = <span class="stringliteral">&quot;BYE&quot;</span>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;   }</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">res_pjsip_session.c:1296</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">res_pjsip_session.c:1297</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8484802d8796789080e644555eb2d04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8484802d8796789080e644555eb2d04">&#9670;&nbsp;</a></span>delayed_request_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a>* delayed_request_alloc </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4">delayed_method</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_request_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_sdp_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generate_new_sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>pending_media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>active_media_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01355">1355</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01350">ast_sip_session_delayed_request::active_media_state</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01346">ast_sip_session_delayed_request::generate_new_sdp</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">ast_sip_session_delayed_request::method</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04335">method</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01340">ast_sip_session_delayed_request::on_request_creation</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01344">ast_sip_session_delayed_request::on_response</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01342">ast_sip_session_delayed_request::on_sdp_creation</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01348">ast_sip_session_delayed_request::pending_media_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;{</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*delay));</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;   <span class="keywordflow">if</span> (!delay) {</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   }</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a> = <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aea56c55f654c68cb1572e09264e90a57">on_request_creation</a> = <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aea56c55f654c68cb1572e09264e90a57">on_request_creation</a>;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">on_sdp_creation</a> = <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">on_sdp_creation</a>;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;   delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">on_response</a> = <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">on_response</a>;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;   delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">generate_new_sdp</a> = <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">generate_new_sdp</a>;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;   delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a> = <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a> = <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   <span class="keywordflow">return</span> delay;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;}</div><div class="ttc" id="structast__sip__session__delayed__request_html_a715bc377d91f54bbdfb6f92b729fe273"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">ast_sip_session_delayed_request::on_sdp_creation</a></div><div class="ttdeci">ast_sip_session_sdp_creation_cb on_sdp_creation</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01342">res_pjsip_session.c:1342</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session_delayed_request::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01348">res_pjsip_session.c:1348</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_aea56c55f654c68cb1572e09264e90a57"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#aea56c55f654c68cb1572e09264e90a57">ast_sip_session_delayed_request::on_request_creation</a></div><div class="ttdeci">ast_sip_session_request_creation_cb on_request_creation</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01340">res_pjsip_session.c:1340</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_af35ce25e8bd0e6e2c67f9d1d40003973"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">ast_sip_session_delayed_request::method</a></div><div class="ttdeci">enum delayed_method method</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">res_pjsip_session.c:1338</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session_delayed_request::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01350">res_pjsip_session.c:1350</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a25bb4ff3d06ce7d015a8ed92849d2bfc"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">ast_sip_session_delayed_request::generate_new_sdp</a></div><div class="ttdeci">int generate_new_sdp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01346">res_pjsip_session.c:1346</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></div><div class="ttdoc">Structure used for sending delayed requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01336">res_pjsip_session.c:1336</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_afcd45a052e625a4b6a24d35d47f4c769"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">ast_sip_session_delayed_request::on_response</a></div><div class="ttdeci">ast_sip_session_response_cb on_response</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01344">res_pjsip_session.c:1344</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abdb87d2e0451ce7382da2c5b23525c73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdb87d2e0451ce7382da2c5b23525c73">&#9670;&nbsp;</a></span>delayed_request_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void delayed_request_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *&#160;</td>
          <td class="paramname"><em>delay</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">1379</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01350">ast_sip_session_delayed_request::active_media_state</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01348">ast_sip_session_delayed_request::pending_media_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">invite_proceeding()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;{</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>);</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(delay);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;}</div><div class="ttc" id="structast__sip__session__delayed__request_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session_delayed_request::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01348">res_pjsip_session.c:1348</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session_delayed_request::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01350">res_pjsip_session.c:1350</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adfed42a1933e5cd396c5125d2199a14a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfed42a1933e5cd396c5125d2199a14a">&#9670;&nbsp;</a></span>does_method_match()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t does_method_match </td>
          <td>(</td>
          <td class="paramtype">const pj_str_t *&#160;</td>
          <td class="paramname"><em>message_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>supplement_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">4129</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, and <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04335">method</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">handle_incoming_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04449">handle_incoming_response()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">handle_outgoing_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">handle_outgoing_response()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04142">has_supplement()</a>.</p>
<div class="fragment"><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;{</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;   pj_str_t <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>;</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(supplement_method)) {</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;   }</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;   pj_cstr(&amp;method, supplement_method);</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;   <span class="keywordflow">return</span> pj_stristr(&amp;method, <a class="code" href="../../de/d96/res__pjsip_8c.html#a6fdb6e6429a5f709f3b99541190b52c2">message_method</a>) ? PJ_TRUE : PJ_FALSE;</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;}</div><div class="ttc" id="res__pjsip_8c_html_a6fdb6e6429a5f709f3b99541190b52c2"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a6fdb6e6429a5f709f3b99541190b52c2">message_method</a></div><div class="ttdeci">static const pjsip_method message_method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04332">res_pjsip.c:4332</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36b830933f0110c5ea0a2c71d1c50b43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b830933f0110c5ea0a2c71d1c50b43">&#9670;&nbsp;</a></span>generate_session_refresh_sdp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjmedia_sdp_session* generate_session_refresh_sdp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01621">1621</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;{</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;   pjsip_inv_session *inv_session = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;   <span class="keyword">const</span> pjmedia_sdp_session *previous_sdp = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;   <span class="keywordflow">if</span> (inv_session-&gt;neg) {</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      <span class="keywordflow">if</span> (pjmedia_sdp_neg_was_answer_remote(inv_session-&gt;neg)) {</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;         pjmedia_sdp_neg_get_active_remote(inv_session-&gt;neg, &amp;previous_sdp);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;         pjmedia_sdp_neg_get_active_local(inv_session-&gt;neg, &amp;previous_sdp);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      }</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;   }</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(inv_session, session, previous_sdp));</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6164e7cb4f4be9ee46724fbdcdd86736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6164e7cb4f4be9ee46724fbdcdd86736">&#9670;&nbsp;</a></span>get_destination()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591">sip_get_destination_result</a> get_destination </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine where in the dialplan a call should go. </p>
<p>This uses the username in the request URI to try to match an extension in the endpoint's configured context in order to route the call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The inbound SIP session </td></tr>
    <tr><td class="paramname">rdata</td><td>The SIP INVITE </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03666">3666</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00893">ast_sip_endpoint::allow_overlap</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l04194">ast_canmatch_extension()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../db/d94/pbx_8c_source.html#l04179">ast_exists_extension()</a>, <a class="el" href="../../de/d71/features__config_8c_source.html#l01193">ast_get_chan_features_pickup_config()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l03036">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00815">ast_sip_endpoint::context</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00181">ast_sip_session::exten</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d0/daa/include_2asterisk_2features__config_8h_source.html#l00145">ast_features_pickup_config::pickupexten</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00235">ast_sip_session::request_uri</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03647">SIP_GET_DEST_EXTEN_FOUND</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03649">SIP_GET_DEST_EXTEN_NOT_FOUND</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03651">SIP_GET_DEST_EXTEN_PARTIAL</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03653">SIP_GET_DEST_UNSUPPORTED_URI</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>.</p>
<div class="fragment"><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;{</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;   pjsip_uri *ruri = rdata-&gt;msg_info.msg-&gt;line.req.uri;</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;   pjsip_sip_uri *sip_ruri;</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d6f/structast__features__pickup__config.html">ast_features_pickup_config</a> *pickup_cfg;</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/d6f/structast__features__pickup__config.html#aec0574bce765da109ed40b4366079727">pickupexten</a>;</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(ruri) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(ruri)) {</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be">SIP_GET_DEST_UNSUPPORTED_URI</a>;</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;   }</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;   sip_ruri = pjsip_uri_get_uri(ruri);</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>, &amp;sip_ruri-&gt;user, <span class="keyword">sizeof</span>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>));</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;<span class="comment">    * We may want to match in the dialplan without any user</span></div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="comment">    * options getting in the way.</span></div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>);</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;   pickup_cfg = <a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html#ad9d12b10a3d0c3bca1d0b033bc139dab">ast_get_chan_features_pickup_config</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); <span class="comment">/* session-&gt;channel doesn&#39;t exist yet, using NULL */</span></div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;   <span class="keywordflow">if</span> (!pickup_cfg) {</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Unable to retrieve pickup configuration options. Unable to detect call pickup extension\n&quot;</span>,</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;      pickupexten = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      pickupexten = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(pickup_cfg-&gt;<a class="code" href="../../d2/d6f/structast__features__pickup__config.html#aec0574bce765da109ed40b4366079727">pickupexten</a>);</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(pickup_cfg, -1);</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;   }</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;   <span class="keywordflow">if</span> (!strcmp(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>, pickupexten) ||</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a7faec841658b88ad0cfbc684853acad3">context</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;<span class="comment">       * Save off the INVITE Request-URI in case it is</span></div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;<span class="comment">       * needed: CHANNEL(pjsip,request_uri)</span></div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a20e3f2a5414e423d1c7bd2e35656dd6f">request_uri</a> = pjsip_uri_clone(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;pool, ruri);</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59">SIP_GET_DEST_EXTEN_FOUND</a>;</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;   }</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;<span class="comment">    * Check for partial match via overlap dialling (if enabled)</span></div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#ab5d983170cae3fd9766e673353b453bc">allow_overlap</a> &amp;&amp; (</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      !strncmp(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>, pickupexten, strlen(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>)) ||</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a93f9868530c1e8a9d9d367d1ead8782e">ast_canmatch_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a7faec841658b88ad0cfbc684853acad3">context</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>, 1, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      <span class="comment">/* Overlap partial match */</span></div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa">SIP_GET_DEST_EXTEN_PARTIAL</a>;</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;   }</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229">SIP_GET_DEST_EXTEN_NOT_FOUND</a>;</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a6bb5769d100d0348446c7f032eca58c1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a></div><div class="ttdeci">#define AST_SIP_USER_OPTIONS_TRUNCATE_CHECK(str)</div><div class="ttdoc">Truncate the URI user field options string if enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l03036">res_pjsip.h:3036</a></div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html_ad9d12b10a3d0c3bca1d0b033bc139dab"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html#ad9d12b10a3d0c3bca1d0b033bc139dab">ast_get_chan_features_pickup_config</a></div><div class="ttdeci">struct ast_features_pickup_config * ast_get_chan_features_pickup_config(struct ast_channel *chan)</div><div class="ttdoc">Get the pickup configuration options for a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d71/features__config_8c_source.html#l01193">features_config.c:1193</a></div></div>
<div class="ttc" id="structast__sip__session_html_a20e3f2a5414e423d1c7bd2e35656dd6f"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a20e3f2a5414e423d1c7bd2e35656dd6f">ast_sip_session::request_uri</a></div><div class="ttdeci">pjsip_uri * request_uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00235">res_pjsip_session.h:235</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a7faec841658b88ad0cfbc684853acad3"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a7faec841658b88ad0cfbc684853acad3">ast_sip_endpoint::context</a></div><div class="ttdeci">const ast_string_field context</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00815">res_pjsip.h:815</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="structast__sip__session_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">ast_sip_session::exten</a></div><div class="ttdeci">char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00181">res_pjsip_session.h:181</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa">SIP_GET_DEST_EXTEN_PARTIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03651">res_pjsip_session.c:3651</a></div></div>
<div class="ttc" id="pbx_8h_html_a93f9868530c1e8a9d9d367d1ead8782e"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a93f9868530c1e8a9d9d367d1ead8782e">ast_canmatch_extension</a></div><div class="ttdeci">int ast_canmatch_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Looks for a valid matching extension. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04194">pbx.c:4194</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="pbx_8h_html_a64a5b8fdc919806135ad427aca9e71b7"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a></div><div class="ttdeci">int ast_exists_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Determine whether an extension exists. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04179">pbx.c:4179</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59">SIP_GET_DEST_EXTEN_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03647">res_pjsip_session.c:3647</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_ab5d983170cae3fd9766e673353b453bc"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#ab5d983170cae3fd9766e673353b453bc">ast_sip_endpoint::allow_overlap</a></div><div class="ttdeci">unsigned int allow_overlap</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00893">res_pjsip.h:893</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229">SIP_GET_DEST_EXTEN_NOT_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03649">res_pjsip_session.c:3649</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be">SIP_GET_DEST_UNSUPPORTED_URI</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03653">res_pjsip_session.c:3653</a></div></div>
<div class="ttc" id="structast__features__pickup__config_html_aec0574bce765da109ed40b4366079727"><div class="ttname"><a href="../../d2/d6f/structast__features__pickup__config.html#aec0574bce765da109ed40b4366079727">ast_features_pickup_config::pickupexten</a></div><div class="ttdeci">const ast_string_field pickupexten</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/daa/include_2asterisk_2features__config_8h_source.html#l00145">include/asterisk/features_config.h:145</a></div></div>
<div class="ttc" id="structast__features__pickup__config_html"><div class="ttname"><a href="../../d2/d6f/structast__features__pickup__config.html">ast_features_pickup_config</a></div><div class="ttdoc">Configuration relating to call pickup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/daa/include_2asterisk_2features__config_8h_source.html#l00137">include/asterisk/features_config.h:137</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a1c15e1dafd2d9d7998acd2b86c1a63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a1c15e1dafd2d9d7998acd2b86c1a63">&#9670;&nbsp;</a></span>get_mid_bundle_group()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int get_mid_bundle_group </td>
          <td>(</td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>mid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00612">612</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>, and <a class="el" href="../../d4/d2f/syslog_8c_source.html#l00037">value</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00646">set_mid_and_bundle_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;{</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="keywordtype">int</span> bundle_group = 0;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; sdp-&gt;attr_count; ++index) {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      pjmedia_sdp_attr *attr = sdp-&gt;attr[index];</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>[pj_strlen(&amp;attr-&gt;value) + 1], *mids = <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, *attr_mid;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> (pj_strcmp2(&amp;attr-&gt;name, <span class="stringliteral">&quot;group&quot;</span>) || pj_strncmp2(&amp;attr-&gt;value, <span class="stringliteral">&quot;BUNDLE&quot;</span>, 6)) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(value, &amp;attr-&gt;value, <span class="keyword">sizeof</span>(value));</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="comment">/* Skip the BUNDLE at the front */</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      mids += 7;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="keywordflow">while</span> ((attr_mid = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;mids, <span class="stringliteral">&quot; &quot;</span>))) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;         <span class="keywordflow">if</span> (!strcmp(attr_mid, mid)) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="comment">/* The ordering of attributes determines our internal identification of the bundle group based on number,</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">             * with -1 being not in a bundle group. Since this is only exposed internally for response purposes it&#39;s</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">             * actually even fine if things move around.</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="keywordflow">return</span> bundle_group;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      bundle_group++;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8a19b2f0b2cac772a583a0d31fa434b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8a19b2f0b2cac772a583a0d31fa434b">&#9670;&nbsp;</a></span>handle_incoming()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_incoming </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195">ast_sip_session_response_priority</a>&#160;</td>
          <td class="paramname"><em>response_priority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">4469</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">handle_incoming_request()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04449">handle_incoming_response()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">handle_incoming_before_media()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05395">session_inv_on_redirected()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;{</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;   <span class="keywordflow">if</span> (rdata-&gt;msg_info.msg-&gt;type == PJSIP_REQUEST_MSG) {</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a10082c2a0d8b402ea1df1e65c8482ba6">handle_incoming_request</a>(session, rdata);</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad01a8f0fed9b24e7b12f7d8a254b3477">handle_incoming_response</a>(session, rdata, response_priority);</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;   }</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_ad01a8f0fed9b24e7b12f7d8a254b3477"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad01a8f0fed9b24e7b12f7d8a254b3477">handle_incoming_response</a></div><div class="ttdeci">static void handle_incoming_response(struct ast_sip_session *session, pjsip_rx_data *rdata, enum ast_sip_session_response_priority response_priority)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04449">res_pjsip_session.c:4449</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a10082c2a0d8b402ea1df1e65c8482ba6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a10082c2a0d8b402ea1df1e65c8482ba6">handle_incoming_request</a></div><div class="ttdeci">static void handle_incoming_request(struct ast_sip_session *session, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">res_pjsip_session.c:4398</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2de6afbe09b1067f050db3c76437be3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de6afbe09b1067f050db3c76437be3e">&#9670;&nbsp;</a></span>handle_incoming_before_media()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_incoming_before_media </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">4583</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00272">AST_SIP_SESSION_BEFORE_MEDIA</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">handle_incoming()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">session_inv_on_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;{</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;   pjsip_msg *msg;</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Received %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), rdata-&gt;msg_info.msg-&gt;type == PJSIP_REQUEST_MSG ?</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;         <span class="stringliteral">&quot;request&quot;</span> : <span class="stringliteral">&quot;response&quot;</span>);</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae8a19b2f0b2cac772a583a0d31fa434b">handle_incoming</a>(session, rdata, <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6">AST_SIP_SESSION_BEFORE_MEDIA</a>);</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;   msg = rdata-&gt;msg_info.msg;</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;   <span class="keywordflow">if</span> (msg-&gt;type == PJSIP_REQUEST_MSG</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;      &amp;&amp; msg-&gt;line.req.method.id == PJSIP_ACK_METHOD</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;      &amp;&amp; pjmedia_sdp_neg_get_state(inv-&gt;neg) != PJMEDIA_SDP_NEG_STATE_DONE) {</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;      pjsip_tx_data *tdata;</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;<span class="comment">       * SDP negotiation failed on an incoming call that delayed</span></div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;<span class="comment">       * negotiation and then gave us an invalid SDP answer.  We</span></div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;<span class="comment">       * need to send a BYE to end the call because of the invalid</span></div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;<span class="comment">       * SDP answer.</span></div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1,</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;         <span class="stringliteral">&quot;%s: Ending session due to incomplete SDP negotiation.  %s\n&quot;</span>,</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;         pjsip_rx_data_get_info(rdata));</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_end_session(inv, 400, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;         &amp;&amp; tdata) {</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a>(session, tdata);</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      }</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;   }</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8h_html_a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195ae9ebf5a7b7a753f5d0d2586f063c39e6">AST_SIP_SESSION_BEFORE_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00272">res_pjsip_session.h:272</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae8a19b2f0b2cac772a583a0d31fa434b"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae8a19b2f0b2cac772a583a0d31fa434b">handle_incoming</a></div><div class="ttdeci">static int handle_incoming(struct ast_sip_session *session, pjsip_rx_data *rdata, enum ast_sip_session_response_priority response_priority)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">res_pjsip_session.c:4469</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a35a7aa9427f3aea9384c1a481ce6a5f3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a></div><div class="ttdeci">void ast_sip_session_send_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">res_pjsip_session.c:2842</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a10082c2a0d8b402ea1df1e65c8482ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10082c2a0d8b402ea1df1e65c8482ba6">&#9670;&nbsp;</a></span>handle_incoming_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_incoming_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">4398</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">does_method_match()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00327">ast_sip_session_supplement::incoming_request</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">ast_sip_session_supplement::method</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">handle_incoming()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>.</p>
<div class="fragment"><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;{</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *supplement;</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;   <span class="keyword">struct </span>pjsip_request_line req = rdata-&gt;msg_info.msg-&gt;line.req;</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: Method is %.*s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), (<span class="keywordtype">int</span>) pj_strlen(&amp;req.method.name), pj_strbuf(&amp;req.method.name));</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, supplement, next) {</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      <span class="keywordflow">if</span> (supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a77b0ebe28cbabd1a025d29815d053ab0">incoming_request</a> &amp;&amp; <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a>(&amp;req.method.name, supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>)) {</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;         <span class="keywordflow">if</span> (supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a77b0ebe28cbabd1a025d29815d053ab0">incoming_request</a>(session, rdata)) {</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;         }</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;      }</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;   }</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;}</div><div class="ttc" id="structast__sip__session__supplement_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">ast_sip_session_supplement::method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">res_pjsip_session.h:290</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a77b0ebe28cbabd1a025d29815d053ab0"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a77b0ebe28cbabd1a025d29815d053ab0">ast_sip_session_supplement::incoming_request</a></div><div class="ttdeci">int(* incoming_request)(struct ast_sip_session *session, struct pjsip_rx_data *rdata)</div><div class="ttdoc">Called on incoming SIP request This method can indicate a failure in processing in its return...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00327">res_pjsip_session.h:327</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_adfed42a1933e5cd396c5125d2199a14a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a></div><div class="ttdeci">static pj_bool_t does_method_match(const pj_str_t *message_method, const char *supplement_method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">res_pjsip_session.c:4129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad01a8f0fed9b24e7b12f7d8a254b3477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad01a8f0fed9b24e7b12f7d8a254b3477">&#9670;&nbsp;</a></span>handle_incoming_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_incoming_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195">ast_sip_session_response_priority</a>&#160;</td>
          <td class="paramname"><em>response_priority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04449">4449</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">does_method_match()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00343">ast_sip_session_supplement::incoming_response</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">ast_sip_session_supplement::method</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00360">ast_sip_session_supplement::response_priority</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">handle_incoming()</a>.</p>
<div class="fragment"><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;{</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *supplement;</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;   <span class="keyword">struct </span>pjsip_status_line <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = rdata-&gt;msg_info.msg-&gt;line.status;</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: Response is %d %.*s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      status.code, (<span class="keywordtype">int</span>) pj_strlen(&amp;status.reason), pj_strbuf(&amp;status.reason));</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, supplement, next) {</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <span class="keywordflow">if</span> (!(supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a82b06adfc16e93cbdf490670091c18cf">response_priority</a> &amp; response_priority)) {</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;      }</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;      <span class="keywordflow">if</span> (supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a402efd204f9980b2f98839f6ba700aac">incoming_response</a> &amp;&amp; <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a>(&amp;rdata-&gt;msg_info.cseq-&gt;method.name, supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>)) {</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;         supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a402efd204f9980b2f98839f6ba700aac">incoming_response</a>(session, rdata);</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;      }</div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;   }</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;}</div><div class="ttc" id="structast__sip__session__supplement_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">ast_sip_session_supplement::method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">res_pjsip_session.h:290</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a82b06adfc16e93cbdf490670091c18cf"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a82b06adfc16e93cbdf490670091c18cf">ast_sip_session_supplement::response_priority</a></div><div class="ttdeci">enum ast_sip_session_response_priority response_priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00360">res_pjsip_session.h:360</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a402efd204f9980b2f98839f6ba700aac"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a402efd204f9980b2f98839f6ba700aac">ast_sip_session_supplement::incoming_response</a></div><div class="ttdeci">void(* incoming_response)(struct ast_sip_session *session, struct pjsip_rx_data *rdata)</div><div class="ttdoc">Called on an incoming SIP response This method is always called from a SIP servant thread...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00343">res_pjsip_session.h:343</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_adfed42a1933e5cd396c5125d2199a14a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a></div><div class="ttdeci">static pj_bool_t does_method_match(const pj_str_t *message_method, const char *supplement_method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">res_pjsip_session.c:4129</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a148cffe818b8c47b8233c0c118c116a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a148cffe818b8c47b8233c0c118c116a0">&#9670;&nbsp;</a></span>handle_incoming_sdp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_incoming_sdp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>sdp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">764</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00269">ast_asprintf</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00347">ast_codec_media_type2str()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00036">AST_MEDIA_TYPE_END</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00363">ast_media_type_from_str()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">ast_sip_session_is_pending_stream_default()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">ast_sip_session_media_state_add()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00233">ast_stream_alloc()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00292">ast_stream_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00423">ast_stream_get_metadata()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00309">ast_stream_get_name()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00460">ast_stream_set_metadata()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00094">AST_STREAM_STATE_INACTIVE</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00090">AST_STREAM_STATE_RECVONLY</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00086">AST_STREAM_STATE_SENDONLY</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00082">AST_STREAM_STATE_SENDRECV</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00337">ast_stream_to_str()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00650">ast_stream_topology_alloc()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00796">ast_stream_topology_set_stream()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">ast_sip_session_media::handler</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">ast_sip_session_sdp_handler::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00592">is_stream_limitation_reached()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00410">ast_sip_session_sdp_handler::negotiate_incoming_sdp_stream</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00754">remove_stream_from_bundle()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00834">SCOPE_EXIT_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00946">SCOPE_EXIT_LOG_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00940">SCOPE_EXIT_LOG_RTN_VALUE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">session_media_set_handler()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00646">set_mid_and_bundle_group()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00684">set_remote_mslabel_and_stream_group()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05236">session_inv_on_rx_offer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;{</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="keywordtype">int</span> handled = 0;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="keywordtype">int</span> type_streams[<a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a>] = {0};</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: Media count: %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), sdp-&gt;media_count);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a> &amp;&amp; session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;state == PJSIP_INV_STATE_DISCONNECTED) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Failed to handle incoming SDP. Session has been already disconnected\n&quot;</span>,</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <span class="comment">/* It is possible for SDP deferral to have already created a pending topology */</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a>();</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t alloc pending topology\n&quot;</span>,</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;   }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; sdp-&gt;media_count; ++i) {</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      <span class="comment">/* See if there are registered handlers for this media stream type */</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordtype">char</span> media[20];</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *, handler_list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      pjmedia_sdp_media *remote_stream = sdp-&gt;media[i];</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(4, <span class="stringliteral">&quot;%s: Processing stream %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), i);</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="comment">/* We need a null-terminated version of the media string */</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(media, &amp;sdp-&gt;media[i]-&gt;desc.media, <span class="keyword">sizeof</span>(media));</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      type = <a class="code" href="../../d1/d16/codec_8h.html#a153dc7458d6455da24d7d24d8e8a7924">ast_media_type_from_str</a>(media);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <span class="comment">/* See if we have an already existing stream, which can occur from SDP deferral checking */</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordflow">if</span> (i &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>)) {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;         stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Using existing pending stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <span class="keywordflow">if</span> (!stream) {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *existing_stream = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;         <span class="keywordtype">char</span> *stream_name = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *stream_name_allocated = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">char</span> *stream_label = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> &amp;&amp;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            (i &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>))) {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            existing_stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Found existing active stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(existing_stream, &amp;STR_TMP)));</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(existing_stream) != <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;               stream_name = (<span class="keywordtype">char</span> *)<a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(existing_stream);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;               stream_label = <a class="code" href="../../d8/d95/stream_8h.html#a311bed754f00753d0fd141266ee0d282">ast_stream_get_metadata</a>(existing_stream, <span class="stringliteral">&quot;SDP:LABEL&quot;</span>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;         }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(stream_name)) {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;stream_name_allocated, <span class="stringliteral">&quot;%s-%d&quot;</span>, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(type), i) &lt; 0) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;               handled = 0;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t alloc stream name\n&quot;</span>,</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            stream_name = stream_name_allocated;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Using %s for new stream name\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;               stream_name);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;         }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;         stream = <a class="code" href="../../d8/d95/stream_8h.html#afd6abeccf161767b676a3cb54715df2c">ast_stream_alloc</a>(stream_name, type);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(stream_name_allocated);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;         <span class="keywordflow">if</span> (!stream) {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            handled = 0;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t alloc stream\n&quot;</span>,</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;         }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(stream_label)) {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a3190a21208ef7b4137f3355cb13a61f0">ast_stream_set_metadata</a>(stream, <span class="stringliteral">&quot;SDP:LABEL&quot;</span>, stream_label);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Using %s for new stream label\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;               stream_label);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i, stream)) {</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a>(stream);</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            handled = 0;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t set stream in topology\n&quot;</span>,</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;         }</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;         <span class="comment">/* For backwards compatibility with the core the default audio stream is always sendrecv */</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a>(session, stream) || strcmp(media, <span class="stringliteral">&quot;audio&quot;</span>)) {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(remote_stream, <span class="stringliteral">&quot;sendonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;               <span class="comment">/* Stream state reflects our state of a stream, so in the case of</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">                * sendonly and recvonly we store the opposite since that is what ours</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">                * is.</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24">AST_STREAM_STATE_RECVONLY</a>);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(remote_stream, <span class="stringliteral">&quot;recvonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a>);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(remote_stream, <span class="stringliteral">&quot;inactive&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93">AST_STREAM_STATE_INACTIVE</a>);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            }</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;         }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Using new stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      session_media = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a>(session, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>, <a class="code" href="../../d1/d16/codec_8h.html#a153dc7458d6455da24d7d24d8e8a7924">ast_media_type_from_str</a>(media), i);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t alloc session media\n&quot;</span>,</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;             <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      <span class="comment">/* If this stream is already declined mark it as such, or mark it as such if we&#39;ve reached the limit */</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">if</span> (!remote_stream-&gt;desc.port || <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad8f4c88669e6520cc93dda53b5635eb0">is_stream_limitation_reached</a>(type, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>, type_streams)) {</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac2fe0223b328b94024025dfaca810bf0">remove_stream_from_bundle</a>(session_media, stream);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Declining incoming SDP media stream %s&#39;\n&quot;</span>,</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0b505dccfd3df8fb39e5819af569046c">set_mid_and_bundle_group</a>(session, session_media, sdp, remote_stream);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abba55edb1fef9239c00fe063a1c9367d">set_remote_mslabel_and_stream_group</a>(session, session_media, sdp, remote_stream, stream);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;         handler = session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Negotiating incoming SDP media stream %s using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)),</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;         res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aafa05969ab37ab97d0d7f3c598d78ba2">negotiate_incoming_sdp_stream</a>(session, session_media, sdp, i, stream);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;         <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <span class="comment">/* Catastrophic failure. Abort! */</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t negotiate stream %s\n&quot;</span>,</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == 0) {</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac2fe0223b328b94024025dfaca810bf0">remove_stream_from_bundle</a>(session_media, stream);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Declining incoming SDP media stream %s\n&quot;</span>,</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res &gt; 0) {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            handled = 1;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            ++type_streams[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>];</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="comment">/* Handled by this handler. Move to the next stream */</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Media stream %s handled by %s\n&quot;</span>,</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)),</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;               session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;         }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      handler_list = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, media, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keywordflow">if</span> (!handler_list) {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Media stream %s has no registered handlers\n&quot;</span>,</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;list, handler, next) {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;         <span class="keywordflow">if</span> (handler == session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Negotiating incoming SDP media stream %s using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)),</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;         res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aafa05969ab37ab97d0d7f3c598d78ba2">negotiate_incoming_sdp_stream</a>(session, session_media, sdp, i, stream);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <span class="comment">/* Catastrophic failure. Abort! */</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            handled = 0;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> end, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t negotiate stream %s\n&quot;</span>,</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == 0) {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac2fe0223b328b94024025dfaca810bf0">remove_stream_from_bundle</a>(session_media, stream);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Declining incoming SDP media stream %s\n&quot;</span>,</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res &gt; 0) {</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a>(session_media, handler);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            handled = 1;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            ++type_streams[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>];</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Media stream %s handled by %s\n&quot;</span>,</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)),</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;               session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;         }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s: Done with stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(handled ? 0 : -1, <span class="stringliteral">&quot;%s: Handled? %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      handled ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div><div class="ttc" id="logger_8h_html_a5eff4ad268db72883e5e152070c3583f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN_VALUE(__value, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00940">logger.h:940</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0b505dccfd3df8fb39e5819af569046c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0b505dccfd3df8fb39e5819af569046c">set_mid_and_bundle_group</a></div><div class="ttdeci">static int set_mid_and_bundle_group(struct ast_sip_session *session, struct ast_sip_session_media *session_media, const pjmedia_sdp_session *sdp, const struct pjmedia_sdp_media *stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00646">res_pjsip_session.c:646</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="stream_8h_html_af793e90c3796564a01574fd9c5e9e208"><div class="ttname"><a href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a></div><div class="ttdeci">const char * ast_stream_to_str(const struct ast_stream *stream, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the stream for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00337">stream.c:337</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad8f4c88669e6520cc93dda53b5635eb0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad8f4c88669e6520cc93dda53b5635eb0">is_stream_limitation_reached</a></div><div class="ttdeci">static int is_stream_limitation_reached(enum ast_media_type type, const struct ast_sip_endpoint *endpoint, int *type_streams)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00592">res_pjsip_session.c:592</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">ast_sip_session_sdp_handler::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">res_pjsip_session.h:382</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="codec_8h_html_a97df2e6b65823085173625553d2e06c5"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a></div><div class="ttdeci">const char * ast_codec_media_type2str(enum ast_media_type type)</div><div class="ttdoc">Conversion function to take a media type and turn it into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00347">codec.c:347</a></div></div>
<div class="ttc" id="codec_8h_html_a153dc7458d6455da24d7d24d8e8a7924"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a153dc7458d6455da24d7d24d8e8a7924">ast_media_type_from_str</a></div><div class="ttdeci">enum ast_media_type ast_media_type_from_str(const char *media_type_str)</div><div class="ttdoc">Conversion function to take a media string and convert it to a media type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00363">codec.c:363</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93">AST_STREAM_STATE_INACTIVE</a></div><div class="ttdoc">Set when the stream is not sending OR receiving media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00094">stream.h:94</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a469acd2a62f3cc8ab2f9f0b5e1c2b8ff"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_EXPR(__expr, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00946">logger.h:946</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="stream_8h_html_a1bec3fe997f1085a3095cd46e8208b20"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a></div><div class="ttdeci">int ast_stream_topology_set_stream(struct ast_stream_topology *topology, unsigned int position, struct ast_stream *stream)</div><div class="ttdoc">Set a specific position in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00796">stream.c:796</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aafa05969ab37ab97d0d7f3c598d78ba2"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aafa05969ab37ab97d0d7f3c598d78ba2">ast_sip_session_sdp_handler::negotiate_incoming_sdp_stream</a></div><div class="ttdeci">int(* negotiate_incoming_sdp_stream)(struct ast_sip_session *session, struct ast_sip_session_media *session_media, const struct pjmedia_sdp_session *sdp, int index, struct ast_stream *asterisk_stream)</div><div class="ttdoc">Set session details based on a stream in an incoming SDP offer or answer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00410">res_pjsip_session.h:410</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a4d96ab8cbcc0f85012300573e3db2900"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a></div><div class="ttdeci">int ast_sip_session_is_pending_stream_default(const struct ast_sip_session *session, const struct ast_stream *stream)</div><div class="ttdoc">Determines if a provided pending stream will be the default stream or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">res_pjsip_session.c:359</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a547f07821c13f67174cb535888d98c0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a></div><div class="ttdeci">static void session_media_set_handler(struct ast_sip_session_media *session_media, struct ast_sip_session_sdp_handler *handler)</div><div class="ttdoc">Set an SDP stream handler for a corresponding session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">res_pjsip_session.c:445</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="logger_8h_html_a91ab9408bcc739e24e6eab78d752585c"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_EXPR(__expr,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00834">logger.h:834</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac2fe0223b328b94024025dfaca810bf0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac2fe0223b328b94024025dfaca810bf0">remove_stream_from_bundle</a></div><div class="ttdeci">static void remove_stream_from_bundle(struct ast_sip_session_media *session_media, struct ast_stream *stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00754">res_pjsip_session.c:754</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a></div><div class="ttdoc">Set when the stream is sending and receiving media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00082">stream.h:82</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stream_8h_html_ad225f95d1de536ba61f43150cfe3bd06"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_alloc(void)</div><div class="ttdoc">Create a stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00650">stream.c:650</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae0018e2a2f5cae3abe84426c44fee908"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a></div><div class="ttdeci">struct ast_sip_session_media * ast_sip_session_media_state_add(struct ast_sip_session *session, struct ast_sip_session_media_state *media_state, enum ast_media_type type, int position)</div><div class="ttdoc">Allocate an ast_session_media and add it to the media state&amp;#39;s vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">res_pjsip_session.c:490</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a></div><div class="ttdoc">Set when the stream is sending media only. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00086">stream.h:86</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abba55edb1fef9239c00fe063a1c9367d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abba55edb1fef9239c00fe063a1c9367d">set_remote_mslabel_and_stream_group</a></div><div class="ttdeci">static void set_remote_mslabel_and_stream_group(struct ast_sip_session *session, struct ast_sip_session_media *session_media, const pjmedia_sdp_session *sdp, const struct pjmedia_sdp_media *stream, struct ast_stream *asterisk_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00684">res_pjsip_session.c:684</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="stream_8h_html_acd53513fe1965d4e5d4581d79ef8d24c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a></div><div class="ttdeci">void ast_stream_free(struct ast_stream *stream)</div><div class="ttdoc">Destroy a media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00292">stream.c:292</a></div></div>
<div class="ttc" id="stream_8h_html_afd6abeccf161767b676a3cb54715df2c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afd6abeccf161767b676a3cb54715df2c">ast_stream_alloc</a></div><div class="ttdeci">struct ast_stream * ast_stream_alloc(const char *name, enum ast_media_type type)</div><div class="ttdoc">Create a new media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00233">stream.c:233</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3b66ccd874aa8ba900ad09f9fb12717d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">ast_sip_session_media::handler</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * handler</div><div class="ttdoc">SDP handler that setup the RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">res_pjsip_session.h:83</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="stream_8h_html_a3190a21208ef7b4137f3355cb13a61f0"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3190a21208ef7b4137f3355cb13a61f0">ast_stream_set_metadata</a></div><div class="ttdeci">int ast_stream_set_metadata(struct ast_stream *stream, const char *m_key, const char *value)</div><div class="ttdoc">Set a stream metadata value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00460">stream.c:460</a></div></div>
<div class="ttc" id="stream_8h_html_a311bed754f00753d0fd141266ee0d282"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a311bed754f00753d0fd141266ee0d282">ast_stream_get_metadata</a></div><div class="ttdeci">const char * ast_stream_get_metadata(const struct ast_stream *stream, const char *m_key)</div><div class="ttdoc">Get a stream metadata value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00423">stream.c:423</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a></div><div class="ttdeci">ast_media_type</div><div class="ttdoc">Types of media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00030">codec.h:30</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00036">codec.h:36</a></div></div>
<div class="ttc" id="stream_8h_html_afcb45a1d2880128928cfb6d91b19ab46"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a></div><div class="ttdeci">const char * ast_stream_get_name(const struct ast_stream *stream)</div><div class="ttdoc">Get the name of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00309">stream.c:309</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24">AST_STREAM_STATE_RECVONLY</a></div><div class="ttdoc">Set when the stream is receiving media only. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00090">stream.h:90</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a22010f3c564b39568a2645c06386a7f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22010f3c564b39568a2645c06386a7f0">&#9670;&nbsp;</a></span>handle_negotiated_sdp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_negotiated_sdp </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>remote</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">1063</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01174">ast_channel_internal_fd_clear()</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01161">ast_channel_internal_fd_set()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l01591">ast_channel_set_stream_topology()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l11209">ast_channel_stream_topology_changed_externally()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00314">AST_CONTROL_STREAM_TOPOLOGY_SOURCE_CHANGED</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00196">AST_EXTENDED_FDS</a>, <a class="el" href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00105">AST_FRAME_CONTROL</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00034">AST_MEDIA_TYPE_IMAGE</a>, <a class="el" href="../../df/d55/main_2frame_8c_source.html#l00079">ast_null_frame</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01139">ast_queue_frame()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">ast_sip_session_media_state_clone()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">ast_sip_session_media_stats_save()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00667">ast_stream_topology_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00696">ast_stream_topology_equal()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00121">ast_sip_session_media::changed</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00135">ast_sip_session_media_read_callback_state::fd</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">ast_sip_session_media::handler</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">session_media_set_handler()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00230">SWAP</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05324">session_inv_on_media_update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;{</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *topology;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> changed = 0; <span class="comment">/* 0 = unchanged, 1 = new source, 2 = new topology */</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">          * This happens when we have negotiated media after receiving a 183,</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">          * and we&#39;re now receiving a 200 with a new SDP.  In this case, there</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">          * is active_media_state, but the pending_media_state has been reset.</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *active_media_state_clone;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;         active_media_state_clone =</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;         <span class="keywordflow">if</span> (!active_media_state_clone) {</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Unable to clone active media state\n&quot;</span>,</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;         }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a> = active_media_state_clone;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: No pending or active media state\n&quot;</span>,</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;   }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;   <span class="comment">/* If we&#39;re handling negotiated streams, then we should already have set</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">    * up session media instances (and Asterisk streams) that correspond to</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">    * the local SDP, and there should be the same number of session medias</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">    * and streams as there are local SDP streams</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) != local-&gt;media_count</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      || <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions) != local-&gt;media_count) {</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Local SDP contains %d media streams while we expected it to contain %u\n&quot;</span>,</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>), local-&gt;media_count);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Media stream count mismatch\n&quot;</span>);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; local-&gt;media_count; ++i) {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="keywordflow">if</span> (!remote-&gt;media[i]) {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      }</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions, i);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="comment">/* Make sure that this stream is in the correct state. If we need to change</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">       * the state to REMOVED, then our work here is done, so go ahead and move on</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">       * to the next stream.</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <span class="keywordflow">if</span> (!remote-&gt;media[i]-&gt;desc.port) {</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="comment">/* If the stream state is REMOVED, nothing needs to be done, so move on to the</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">       * next stream. This can occur if an internal thing has requested it to be</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">       * removed, or if we remove it as a result of the stream limit being reached.</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(stream) == <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">          * Defer removing the handler until we are ready to activate</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">          * the new topology.  The channel&#39;s thread may still be using</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">          * the stream and we could crash before we are ready.</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a129af2ac549f40d07d2b7e255b251530">handle_negotiated_sdp_session_media</a>(session_media, session, local, remote, i, stream)) {</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;Unable to handle negotiated session media\n&quot;</span>);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      }</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      changed |= session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#af28d4213d4bda49ab19d2451ec6da277">changed</a>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#af28d4213d4bda49ab19d2451ec6da277">changed</a> = 0;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   }</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   <span class="comment">/* Apply the pending media state to the channel and make it active */</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   <span class="comment">/* Now update the stream handler for any declined/removed streams */</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; local-&gt;media_count; ++i) {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="keywordflow">if</span> (!remote-&gt;media[i]) {</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      }</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions, i);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(stream) == <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;         &amp;&amp; session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">          * This stream is no longer being used and the channel&#39;s thread</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">          * is held off because we have the channel lock so release any</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">          * resources the handler may have on it.</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a>(session_media, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      }</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;   }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;   <span class="comment">/* Update the topology on the channel to match the accepted one */</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;   topology = <a class="code" href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;   <span class="keywordflow">if</span> (topology) {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a094d04f1aadb8da25b74880a8cf0645d">ast_channel_set_stream_topology</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, topology);</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="comment">/* If this is a remotely done renegotiation that has changed the stream topology notify what is</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">       * currently handling this channel. Note that fax uses its own process, so if we are transitioning</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">       * between audio and fax or vice versa we don&#39;t notify.</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <span class="keywordflow">if</span> (pjmedia_sdp_neg_was_answer_remote(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;neg) == PJ_FALSE &amp;&amp;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a> &amp;&amp; session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> &amp;&amp;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;         !<a class="code" href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, topology) &amp;&amp;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         !session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a>] &amp;&amp;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;         !session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a>]) {</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;         changed = 2;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;   }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;   <span class="comment">/* Remove all current file descriptors from the channel */</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;read_callbacks); ++i) {</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ad5f3c723a8d5fc5c596852c7dc94be89">ast_channel_internal_fd_clear</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, i + <a class="code" href="../../d5/d7b/channel_8h.html#a12abef15e0e4a3f50b74b7c609e546f8">AST_EXTENDED_FDS</a>);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;   }</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <span class="comment">/* Add all the file descriptors from the pending media state */</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;read_callbacks); ++i) {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a> *callback_state;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      callback_state = <a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;read_callbacks, i);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, i + <a class="code" href="../../d5/d7b/channel_8h.html#a12abef15e0e4a3f50b74b7c609e546f8">AST_EXTENDED_FDS</a>, callback_state-&gt;<a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">fd</a>);</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;   }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;   <span class="comment">/* Active and pending flip flop as needed */</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a>(session, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;   <span class="keywordflow">if</span> (changed == 1) {</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> f = { <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a>, .subclass.integer = <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a248688621fd1a4822c9b36d05b761e4a">AST_CONTROL_STREAM_TOPOLOGY_SOURCE_CHANGED</a> };</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, &amp;f);</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (changed == 2) {</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab973166b1c061782085c2ca9fd87cb5c">ast_channel_stream_topology_changed_externally</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, &amp;<a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a>);</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   }</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;}</div><div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="channel_8h_html_ad5f3c723a8d5fc5c596852c7dc94be89"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ad5f3c723a8d5fc5c596852c7dc94be89">ast_channel_internal_fd_clear</a></div><div class="ttdeci">void ast_channel_internal_fd_clear(struct ast_channel *chan, int which)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01174">channel_internal_api.c:1174</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="utils_8h_html_aac9153aee4bdb92701df902e06a74eb3"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aac9153aee4bdb92701df902e06a74eb3">SWAP</a></div><div class="ttdeci">#define SWAP(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00230">utils.h:230</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a129af2ac549f40d07d2b7e255b251530"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a129af2ac549f40d07d2b7e255b251530">handle_negotiated_sdp_session_media</a></div><div class="ttdeci">static int handle_negotiated_sdp_session_media(struct ast_sip_session_media *session_media, struct ast_sip_session *session, const pjmedia_sdp_session *local, const pjmedia_sdp_session *remote, int index, struct ast_stream *asterisk_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">res_pjsip_session.c:964</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00034">codec.h:34</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a248688621fd1a4822c9b36d05b761e4a"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a248688621fd1a4822c9b36d05b761e4a">AST_CONTROL_STREAM_TOPOLOGY_SOURCE_CHANGED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00314">include/asterisk/frame.h:314</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a547f07821c13f67174cb535888d98c0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a></div><div class="ttdeci">static void session_media_set_handler(struct ast_sip_session_media *session_media, struct ast_sip_session_sdp_handler *handler)</div><div class="ttdoc">Set an SDP stream handler for a corresponding session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">res_pjsip_session.c:445</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a></div><div class="ttdoc">Structure which contains read callback information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00133">res_pjsip_session.h:133</a></div></div>
<div class="ttc" id="channel_8h_html_a6cbcba5661d55216968cde8fdf913c89"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a></div><div class="ttdeci">int ast_queue_frame(struct ast_channel *chan, struct ast_frame *f)</div><div class="ttdoc">Queue one or more frames to a channel&amp;#39;s frame queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01139">channel.c:1139</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#ae2e1a9c4e048da387b761f619312d6e0ae1dae388b0d70825876e137ae95bb0c1">AST_FRAME_CONTROL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00105">include/asterisk/frame.h:105</a></div></div>
<div class="ttc" id="structast__stream__topology_html"><div class="ttname"><a href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00123">stream.c:123</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html_a6f8059414f0228f0256115e024eeed4b"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html#a6f8059414f0228f0256115e024eeed4b">ast_sip_session_media_read_callback_state::fd</a></div><div class="ttdeci">int fd</div><div class="ttdoc">The file descriptor itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00135">res_pjsip_session.h:135</a></div></div>
<div class="ttc" id="channel_8h_html_a12abef15e0e4a3f50b74b7c609e546f8"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a12abef15e0e4a3f50b74b7c609e546f8">AST_EXTENDED_FDS</a></div><div class="ttdeci">#define AST_EXTENDED_FDS</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00196">channel.h:196</a></div></div>
<div class="ttc" id="channel_8h_html_a094d04f1aadb8da25b74880a8cf0645d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a094d04f1aadb8da25b74880a8cf0645d">ast_channel_set_stream_topology</a></div><div class="ttdeci">struct ast_stream_topology * ast_channel_set_stream_topology(struct ast_channel *chan, struct ast_stream_topology *topology)</div><div class="ttdoc">Set the topology of streams on a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01591">channel_internal_api.c:1591</a></div></div>
<div class="ttc" id="stream_8h_html_ae0d846e650b6d3e654c01d61a991c82c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a></div><div class="ttdeci">int ast_stream_topology_equal(const struct ast_stream_topology *left, const struct ast_stream_topology *right)</div><div class="ttdoc">Compare two stream topologies to see if they are equal. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00696">stream.c:696</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_af57bfc75550b1312b46ef584410ae8a9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#af57bfc75550b1312b46ef584410ae8a9">ast_sip_session_media_stats_save</a></div><div class="ttdeci">void ast_sip_session_media_stats_save(struct ast_sip_session *sip_session, struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Save a media stats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">res_pjsip_session.c:244</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a76c9ec6c960e59090e7c6301c1bce890"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a></div><div class="ttdeci">struct ast_sip_session_media_state * ast_sip_session_media_state_clone(const struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Clone a media state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">res_pjsip_session.c:297</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="stream_8h_html_a00b605b453fe5ff538e361126d600303"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a00b605b453fe5ff538e361126d600303">ast_stream_topology_clone</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_clone(const struct ast_stream_topology *topology)</div><div class="ttdoc">Create a deep clone of an existing stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00667">stream.c:667</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_af203379aca2fd704fe8d86a9445596b6"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#af203379aca2fd704fe8d86a9445596b6">ast_null_frame</a></div><div class="ttdeci">struct ast_frame ast_null_frame</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d55/main_2frame_8c_source.html#l00079">main/frame.c:79</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_af28d4213d4bda49ab19d2451ec6da277"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#af28d4213d4bda49ab19d2451ec6da277">ast_sip_session_media::changed</a></div><div class="ttdeci">unsigned int changed</div><div class="ttdoc">The underlying session has been changed in some fashion. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00121">res_pjsip_session.h:121</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3b66ccd874aa8ba900ad09f9fb12717d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">ast_sip_session_media::handler</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * handler</div><div class="ttdoc">SDP handler that setup the RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">res_pjsip_session.h:83</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
<div class="ttc" id="channel_8h_html_a915f6bcc0c9f9a9c214fcb8a400c3063"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a915f6bcc0c9f9a9c214fcb8a400c3063">ast_channel_internal_fd_set</a></div><div class="ttdeci">void ast_channel_internal_fd_set(struct ast_channel *chan, int which, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01161">channel_internal_api.c:1161</a></div></div>
<div class="ttc" id="channel_8h_html_ab973166b1c061782085c2ca9fd87cb5c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab973166b1c061782085c2ca9fd87cb5c">ast_channel_stream_topology_changed_externally</a></div><div class="ttdeci">int ast_channel_stream_topology_changed_externally(struct ast_channel *chan)</div><div class="ttdoc">Provide notice from a channel that the topology has changed on it as a result of the remote party ren...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l11209">channel.c:11209</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a129af2ac549f40d07d2b7e255b251530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a129af2ac549f40d07d2b7e255b251530">&#9670;&nbsp;</a></span>handle_negotiated_sdp_session_media()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int handle_negotiated_sdp_session_media </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>remote</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *&#160;</td>
          <td class="paramname"><em>asterisk_stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">964</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00444">ast_sip_session_sdp_handler::apply_negotiated_sdp_stream</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00347">ast_codec_media_type2str()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">ast_sip_session_is_pending_stream_default()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00094">AST_STREAM_STATE_INACTIVE</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00090">AST_STREAM_STATE_RECVONLY</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00086">AST_STREAM_STATE_SENDONLY</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00082">AST_STREAM_STATE_SENDRECV</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">ast_sip_session_media::handler</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">ast_sip_session_sdp_handler::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">ast_sip_session_sdp_handler::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">session_media_set_handler()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00646">set_mid_and_bundle_group()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00684">set_remote_mslabel_and_stream_group()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00452">ast_sip_session_sdp_handler::stream_stop</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">ast_sip_session_media::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;{</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   <span class="comment">/* See if there are registered handlers for this media stream type */</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="keyword">struct </span>pjmedia_sdp_media *local_stream = local-&gt;media[index];</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;   <span class="keywordtype">char</span> media[20];</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *, handler_list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s\n&quot;</span>, session ? <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session) : <span class="stringliteral">&quot;unknown&quot;</span>);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;   <span class="comment">/* We need a null-terminated version of the media string */</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(media, &amp;local-&gt;media[index]-&gt;desc.media, <span class="keyword">sizeof</span>(media));</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="comment">/* For backwards compatibility we only reflect the stream state correctly on</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">    * the non-default streams and any non-audio streams. This is because the stream</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">    * state of the default audio stream is also used for signaling that someone has</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">    * placed us on hold. This situation is not handled currently and can result in</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">    * the remote side being sorted of placed on hold too.</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a>(session, asterisk_stream) || strcmp(media, <span class="stringliteral">&quot;audio&quot;</span>)) {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="comment">/* Determine the state of the stream based on our local SDP */</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(local_stream, <span class="stringliteral">&quot;sendonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(asterisk_stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a>);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(local_stream, <span class="stringliteral">&quot;recvonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(asterisk_stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24">AST_STREAM_STATE_RECVONLY</a>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(local_stream, <span class="stringliteral">&quot;inactive&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(asterisk_stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93">AST_STREAM_STATE_INACTIVE</a>);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(asterisk_stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      }</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(asterisk_stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0b505dccfd3df8fb39e5819af569046c">set_mid_and_bundle_group</a>(session, session_media, remote, remote-&gt;media[index]);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abba55edb1fef9239c00fe063a1c9367d">set_remote_mslabel_and_stream_group</a>(session, session_media, remote, remote-&gt;media[index], asterisk_stream);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   handler = session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   <span class="keywordflow">if</span> (handler) {</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s: Applying negotiated SDP media stream &#39;%s&#39; using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>),</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;         handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a132a5e87366d82dac4f4d93418b89e92">apply_negotiated_sdp_stream</a>(session, session_media, local, remote, index, asterisk_stream);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="keywordflow">if</span> (res &gt;= 0) {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s: Applied negotiated SDP media stream &#39;%s&#39; using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>),</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0,  <span class="stringliteral">&quot;%s: Applied negotiated SDP media stream &#39;%s&#39; using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>),</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1,  <span class="stringliteral">&quot;%s: Failed to apply negotiated SDP media stream &#39;%s&#39; using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>),</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;         handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   handler_list = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, media, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   <span class="keywordflow">if</span> (!handler_list) {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s: No registered SDP handlers for media type &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), media);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   }</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;list, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">if</span> (handler == session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      }</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s: Applying negotiated SDP media stream &#39;%s&#39; using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>),</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a132a5e87366d82dac4f4d93418b89e92">apply_negotiated_sdp_stream</a>(session, session_media, local, remote, index, asterisk_stream);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;         <span class="comment">/* Catastrophic failure. Abort! */</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;%s: Handler &#39;%s&#39; returned %d\n&quot;</span>,</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, res);</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">if</span> (res &gt; 0) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s: Applied negotiated SDP media stream &#39;%s&#39; using %s SDP handler\n&quot;</span>,</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>),</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;         <span class="comment">/* Handled by this handler. Move to the next stream */</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a>(session_media, handler);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;%s: Handler &#39;%s&#39; handled this sdp stream\n&quot;</span>,</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      }</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;   }</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;   res = 0;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a> &amp;&amp; session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#afb8bd2d3f2512e0625948f3e628897f7">stream_stop</a>) {</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s: Stopping SDP media stream &#39;%s&#39; as it is not currently negotiated\n&quot;</span>,</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>));</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#afb8bd2d3f2512e0625948f3e628897f7">stream_stop</a>(session_media);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;   }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;%s: Media type &#39;%s&#39; %s\n&quot;</span>,</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>),</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      res ? <span class="stringliteral">&quot;not negotiated.  Stopped&quot;</span> : <span class="stringliteral">&quot;handled&quot;</span>);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a0b505dccfd3df8fb39e5819af569046c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0b505dccfd3df8fb39e5819af569046c">set_mid_and_bundle_group</a></div><div class="ttdeci">static int set_mid_and_bundle_group(struct ast_sip_session *session, struct ast_sip_session_media *session_media, const pjmedia_sdp_session *sdp, const struct pjmedia_sdp_media *stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00646">res_pjsip_session.c:646</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">ast_sip_session_sdp_handler::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">res_pjsip_session.h:382</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="codec_8h_html_a97df2e6b65823085173625553d2e06c5"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a></div><div class="ttdeci">const char * ast_codec_media_type2str(enum ast_media_type type)</div><div class="ttdoc">Conversion function to take a media type and turn it into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00347">codec.c:347</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93">AST_STREAM_STATE_INACTIVE</a></div><div class="ttdoc">Set when the stream is not sending OR receiving media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00094">stream.h:94</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aaa4f9cdda5dd0b1270fb35523054926c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">ast_sip_session_sdp_handler::next</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">res_pjsip_session.h:460</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a4d96ab8cbcc0f85012300573e3db2900"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a></div><div class="ttdeci">int ast_sip_session_is_pending_stream_default(const struct ast_sip_session *session, const struct ast_stream *stream)</div><div class="ttdoc">Determines if a provided pending stream will be the default stream or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">res_pjsip_session.c:359</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a547f07821c13f67174cb535888d98c0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a></div><div class="ttdeci">static void session_media_set_handler(struct ast_sip_session_media *session_media, struct ast_sip_session_sdp_handler *handler)</div><div class="ttdoc">Set an SDP stream handler for a corresponding session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">res_pjsip_session.c:445</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a></div><div class="ttdoc">Set when the stream is sending and receiving media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00082">stream.h:82</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a></div><div class="ttdoc">Set when the stream is sending media only. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00086">stream.h:86</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abba55edb1fef9239c00fe063a1c9367d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abba55edb1fef9239c00fe063a1c9367d">set_remote_mslabel_and_stream_group</a></div><div class="ttdeci">static void set_remote_mslabel_and_stream_group(struct ast_sip_session *session, struct ast_sip_session_media *session_media, const pjmedia_sdp_session *sdp, const struct pjmedia_sdp_media *stream, struct ast_stream *asterisk_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00684">res_pjsip_session.c:684</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a57b08a6ad7a004d70eba4a1b6867a084"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">ast_sip_session_media::type</a></div><div class="ttdeci">enum ast_media_type type</div><div class="ttdoc">Media type of this session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">res_pjsip_session.h:105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3b66ccd874aa8ba900ad09f9fb12717d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">ast_sip_session_media::handler</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * handler</div><div class="ttdoc">SDP handler that setup the RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">res_pjsip_session.h:83</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24">AST_STREAM_STATE_RECVONLY</a></div><div class="ttdoc">Set when the stream is receiving media only. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00090">stream.h:90</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_a132a5e87366d82dac4f4d93418b89e92"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#a132a5e87366d82dac4f4d93418b89e92">ast_sip_session_sdp_handler::apply_negotiated_sdp_stream</a></div><div class="ttdeci">int(* apply_negotiated_sdp_stream)(struct ast_sip_session *session, struct ast_sip_session_media *session_media, const struct pjmedia_sdp_session *local, const struct pjmedia_sdp_session *remote, int index, struct ast_stream *asterisk_stream)</div><div class="ttdoc">Apply a negotiated SDP media stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00444">res_pjsip_session.h:444</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_afb8bd2d3f2512e0625948f3e628897f7"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#afb8bd2d3f2512e0625948f3e628897f7">ast_sip_session_sdp_handler::stream_stop</a></div><div class="ttdeci">void(* stream_stop)(struct ast_sip_session_media *session_media)</div><div class="ttdoc">Stop a session_media created by this handler but do not destroy resources. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00452">res_pjsip_session.h:452</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4dfc090cd99367d160beb9518970c0e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dfc090cd99367d160beb9518970c0e3">&#9670;&nbsp;</a></span>handle_new_invite_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_new_invite_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">4050</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">ast_pjsip_rdata_get_endpoint()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00167">AST_SIP_SESSION_INCOMING_CALL</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01266">ast_taskprocessor_is_task()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00241">ast_sip_session::call_direction</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">new_invite()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03742">new_invite_initial_answer()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03789">pre_session_setup()</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03852">new_invite::rdata</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03849">new_invite::session</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00637">TRACE_ATLEAST</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04215">session_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;{</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *, endpoint,</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a>(rdata), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;   pjsip_inv_session *inv_session = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d09/structnew__invite.html">new_invite</a> invite;</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;   <span class="keywordtype">char</span> *req_uri = <a class="code" href="../../d1/d8c/logger_8h.html#a57001f3d33d960dec79dee782b6229a8">TRACE_ATLEAST</a>(1) ? <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(256) : <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;   <span class="keywordtype">int</span> res = <a class="code" href="../../d1/d8c/logger_8h.html#a57001f3d33d960dec79dee782b6229a8">TRACE_ATLEAST</a>(1) ? pjsip_uri_print(PJSIP_URI_IN_REQ_URI, <a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;msg_info.msg-&gt;line.req.uri, req_uri, 256) : 0;</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;Request: %s\n&quot;</span>, res ? req_uri : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(endpoint != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;   inv_session = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8c0487787344caa44e95895bfe5b4d0a">pre_session_setup</a>(<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, endpoint);</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;   <span class="keywordflow">if</span> (!inv_session) {</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;      <span class="comment">/* pre_session_setup() returns a response on failure */</span></div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Failure in pre session setup\n&quot;</span>);</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;   }</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;<span class="comment">    * Upon a successful pre_session_setup the associated dialog is returned locked</span></div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;<span class="comment">    * and with an added reference. Well actually two references. One added when the</span></div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;<span class="comment">    * dialog itself was created, and another added when the pjsip invite session was</span></div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="comment">    * created and the dialog was added to it.</span></div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;<span class="comment">    * In order to ensure the dialog&#39;s, and any of its internal attributes, lifetimes</span></div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;<span class="comment">    * we&#39;ll hold the lock and maintain the reference throughout the entire new invite</span></div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="comment">    * handling process. See ast_sip_create_dialog_uas_locked for more details but,</span></div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="comment">    * basically we do this to make sure a transport failure does not destroy the dialog</span></div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="comment">    * and/or transaction out from underneath us between pjsip calls. Alternatively, we</span></div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="comment">    * could probably release the lock if we needed to, but then we&#39;d have to re-lock and</span></div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="comment">    * check the dialog and transaction prior to every pjsip call.</span></div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;<span class="comment">    * That means any off nominal/failure paths in this function must remove the associated</span></div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;<span class="comment">    * dialog reference added at dialog creation, and remove the lock. As well the</span></div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;<span class="comment">    * referenced pjsip invite session must be &quot;cleaned up&quot;, which should also then</span></div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;<span class="comment">    * remove its reference to the dialog at that time.</span></div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;<span class="comment">    * Nominally we&#39;ll unlock the dialog, and release the reference when all new invite</span></div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;<span class="comment">    * process handling has successfully completed.</span></div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;   session = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ab4ae79a585283a422b758eddcd9663c2">ast_sip_session_alloc</a>(endpoint, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, inv_session, <a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>);</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      <span class="comment">/* Dialog&#39;s lock and reference are removed in new_invite_initial_answer */</span></div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad5d8c9900de369edecd27e4471403e96">new_invite_initial_answer</a>(inv_session, <a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, 500, 500, PJ_FALSE)) {</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;         <span class="comment">/* Terminate the session if it wasn&#39;t done in the answer */</span></div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;         pjsip_inv_terminate(inv_session, 500, PJ_FALSE);</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;      }</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Couldn&#39;t create session\n&quot;</span>);</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;   }</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a0dd1235e55b56ca4871c61f050c1c01e">call_direction</a> = <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9">AST_SIP_SESSION_INCOMING_CALL</a>;</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;<span class="comment">    * The current thread is supposed be the session serializer to prevent</span></div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;<span class="comment">    * any initial INVITE retransmissions from trying to setup the same</span></div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;<span class="comment">    * call again.</span></div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>));</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;   invite.session = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;   invite.rdata = <a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>;</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0e9e5a5b3898c8806dcc54e3615df7de">new_invite</a>(&amp;invite);</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;<span class="comment">    * The dialog lock and reference added at dialog creation time must be</span></div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;<span class="comment">    * maintained throughout the new invite process. Since we&#39;re pretty much</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;<span class="comment">    * done at this point with things it&#39;s safe to go ahead and remove the lock</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;<span class="comment">    * and the reference here. See ast_sip_create_dialog_uas_locked for more info.</span></div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="comment">    * Note, any future functionality added that does work using the dialog must</span></div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="comment">    * be done before this.</span></div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;   pjsip_dlg_dec_lock(inv_session-&gt;dlg);</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;Request: %s Session: %s\n&quot;</span>, req_uri, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_ab4ae79a585283a422b758eddcd9663c2"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ab4ae79a585283a422b758eddcd9663c2">ast_sip_session_alloc</a></div><div class="ttdeci">struct ast_sip_session * ast_sip_session_alloc(struct ast_sip_endpoint *endpoint, struct ast_sip_contact *contact, pjsip_inv_session *inv_session, pjsip_rx_data *rdata)</div><div class="ttdoc">Allocate a new SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">res_pjsip_session.c:2990</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#abe6d95e3b5210140fce96a3985eb77b0af5454601e5aa8331002197d362917cb9">AST_SIP_SESSION_INCOMING_CALL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00167">res_pjsip_session.h:167</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8c0487787344caa44e95895bfe5b4d0a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8c0487787344caa44e95895bfe5b4d0a">pre_session_setup</a></div><div class="ttdeci">static pjsip_inv_session * pre_session_setup(pjsip_rx_data *rdata, const struct ast_sip_endpoint *endpoint)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03789">res_pjsip_session.c:3789</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0e9e5a5b3898c8806dcc54e3615df7de"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0e9e5a5b3898c8806dcc54e3615df7de">new_invite</a></div><div class="ttdeci">static int new_invite(struct new_invite *invite)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">res_pjsip_session.c:3911</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a0dc7590db76dcdc0105abc92072d1b06"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a0dc7590db76dcdc0105abc92072d1b06">ast_pjsip_rdata_get_endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * ast_pjsip_rdata_get_endpoint(pjsip_rx_data *rdata)</div><div class="ttdoc">Get the looked-up endpoint on an out-of dialog request or response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00969">pjsip_distributor.c:969</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structnew__invite_html_a41249c16bd9cc17b36f3719debaf7a67"><div class="ttname"><a href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">new_invite::rdata</a></div><div class="ttdeci">pjsip_rx_data * rdata</div><div class="ttdoc">INVITE request itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03852">res_pjsip_session.c:3852</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a></div><div class="ttdoc">An entity with which Asterisk communicates. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00812">res_pjsip.h:812</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a4a66670abd8be00ab53bd9125a57574f"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a4a66670abd8be00ab53bd9125a57574f">ast_taskprocessor_is_task</a></div><div class="ttdeci">int ast_taskprocessor_is_task(struct ast_taskprocessor *tps)</div><div class="ttdoc">Am I the given taskprocessor&amp;#39;s current task. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01266">taskprocessor.c:1266</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="logger_8h_html_a57001f3d33d960dec79dee782b6229a8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57001f3d33d960dec79dee782b6229a8">TRACE_ATLEAST</a></div><div class="ttdeci">#define TRACE_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00637">logger.h:637</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session_html_a0dd1235e55b56ca4871c61f050c1c01e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a0dd1235e55b56ca4871c61f050c1c01e">ast_sip_session::call_direction</a></div><div class="ttdeci">enum ast_sip_session_call_direction call_direction</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00241">res_pjsip_session.h:241</a></div></div>
<div class="ttc" id="structnew__invite_html"><div class="ttname"><a href="../../db/d09/structnew__invite.html">new_invite</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03847">res_pjsip_session.c:3847</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad5d8c9900de369edecd27e4471403e96"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad5d8c9900de369edecd27e4471403e96">new_invite_initial_answer</a></div><div class="ttdeci">static int new_invite_initial_answer(pjsip_inv_session *inv_session, pjsip_rx_data *rdata, int answer_code, int terminate_code, pj_bool_t notify)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03742">res_pjsip_session.c:3742</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1b7d51bdf278a523bbaa5086302552b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1b7d51bdf278a523bbaa5086302552b">&#9670;&nbsp;</a></span>handle_outgoing_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_outgoing_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04481">4481</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d3/d17/config__transport_8c_source.html#l00301">ast_sip_message_apply_transport()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">does_method_match()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">ast_sip_session_supplement::method</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00348">ast_sip_session_supplement::outgoing_request</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00817">ast_sip_endpoint::transport</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">ast_sip_session_send_request_with_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;{</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *supplement;</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;   <span class="keyword">struct </span>pjsip_request_line req = tdata-&gt;msg-&gt;line.req;</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: Method is %.*s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      (<span class="keywordtype">int</span>) pj_strlen(&amp;req.method.name), pj_strbuf(&amp;req.method.name));</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a594764e7c50b75d6e15709572e06a318">ast_sip_message_apply_transport</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a44cdbda076f37ba09880ba74d942b606">transport</a>, tdata);</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;</div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, supplement, next) {</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      <span class="keywordflow">if</span> (supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#ab273f9aab21414bc938e79fe91d70b19">outgoing_request</a> &amp;&amp; <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a>(&amp;req.method.name, supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>)) {</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;         supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#ab273f9aab21414bc938e79fe91d70b19">outgoing_request</a>(session, tdata);</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;      }</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;   }</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a44cdbda076f37ba09880ba74d942b606"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a44cdbda076f37ba09880ba74d942b606">ast_sip_endpoint::transport</a></div><div class="ttdeci">const ast_string_field transport</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00817">res_pjsip.h:817</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">ast_sip_session_supplement::method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">res_pjsip_session.h:290</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_ab273f9aab21414bc938e79fe91d70b19"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#ab273f9aab21414bc938e79fe91d70b19">ast_sip_session_supplement::outgoing_request</a></div><div class="ttdeci">void(* outgoing_request)(struct ast_sip_session *session, struct pjsip_tx_data *tdata)</div><div class="ttdoc">Called on an outgoing SIP request This method is always called from a SIP servant thread...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00348">res_pjsip_session.h:348</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a594764e7c50b75d6e15709572e06a318"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a594764e7c50b75d6e15709572e06a318">ast_sip_message_apply_transport</a></div><div class="ttdeci">void ast_sip_message_apply_transport(const char *transport_name, pjsip_tx_data *tdata)</div><div class="ttdoc">Apply the configuration for a transport to an outgoing message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l00301">config_transport.c:301</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_adfed42a1933e5cd396c5125d2199a14a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a></div><div class="ttdeci">static pj_bool_t does_method_match(const pj_str_t *message_method, const char *supplement_method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">res_pjsip_session.c:4129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8a7f2c555647574c05995ba10788c17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8a7f2c555647574c05995ba10788c17">&#9670;&nbsp;</a></span>handle_outgoing_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_outgoing_response </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04498">4498</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d3/d17/config__transport_8c_source.html#l00301">ast_sip_message_apply_transport()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">does_method_match()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">ast_sip_session_supplement::method</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00353">ast_sip_session_supplement::outgoing_response</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00934">SCOPE_EXIT_LOG_RTN</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00817">ast_sip_endpoint::transport</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">ast_sip_session_send_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;{</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *supplement;</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;   <span class="keyword">struct </span>pjsip_status_line <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = tdata-&gt;msg-&gt;line.status;</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;   pjsip_cseq_hdr *cseq = pjsip_msg_find_hdr(tdata-&gt;msg, PJSIP_H_CSEQ, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: Method is %.*s, Response is %d %.*s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;      (<span class="keywordtype">int</span>) pj_strlen(&amp;cseq-&gt;method.name),</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;      pj_strbuf(&amp;cseq-&gt;method.name), status.code, (<span class="keywordtype">int</span>) pj_strlen(&amp;status.reason),</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      pj_strbuf(&amp;status.reason));</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;   <span class="keywordflow">if</span> (!cseq) {</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Cannot send response due to missing sequence header&quot;</span>,</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;   }</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a594764e7c50b75d6e15709572e06a318">ast_sip_message_apply_transport</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a44cdbda076f37ba09880ba74d942b606">transport</a>, tdata);</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, supplement, next) {</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      <span class="keywordflow">if</span> (supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#aa009c87ae877f99c791a90cb3de9da50">outgoing_response</a> &amp;&amp; <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a>(&amp;cseq-&gt;method.name, supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>)) {</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;         supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#aa009c87ae877f99c791a90cb3de9da50">outgoing_response</a>(session, tdata);</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;      }</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;   }</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a44cdbda076f37ba09880ba74d942b606"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a44cdbda076f37ba09880ba74d942b606">ast_sip_endpoint::transport</a></div><div class="ttdeci">const ast_string_field transport</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00817">res_pjsip.h:817</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">ast_sip_session_supplement::method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">res_pjsip_session.h:290</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_aa009c87ae877f99c791a90cb3de9da50"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#aa009c87ae877f99c791a90cb3de9da50">ast_sip_session_supplement::outgoing_response</a></div><div class="ttdeci">void(* outgoing_response)(struct ast_sip_session *session, struct pjsip_tx_data *tdata)</div><div class="ttdoc">Called on an outgoing SIP response This method is always called from a SIP servant thread...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00353">res_pjsip_session.h:353</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="logger_8h_html_abfcb52b17737ff39386df5494f74bd0d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN(__log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00934">logger.h:934</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a594764e7c50b75d6e15709572e06a318"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a594764e7c50b75d6e15709572e06a318">ast_sip_message_apply_transport</a></div><div class="ttdeci">void ast_sip_message_apply_transport(const char *transport_name, pjsip_tx_data *tdata)</div><div class="ttdoc">Apply the configuration for a transport to an outgoing message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l00301">config_transport.c:301</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_adfed42a1933e5cd396c5125d2199a14a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a></div><div class="ttdeci">static pj_bool_t does_method_match(const pj_str_t *message_method, const char *supplement_method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">res_pjsip_session.c:4129</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3533f635938c655112221b97eac4884a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3533f635938c655112221b97eac4884a">&#9670;&nbsp;</a></span>handle_session_begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_session_begin </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04415">4415</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">ast_sip_session_supplement::next</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00297">ast_sip_session_supplement::session_begin</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;{</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *iter;</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, iter, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>) {</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a37e27e4c260104858c6a87957138750c">session_begin</a>) {</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;         iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a37e27e4c260104858c6a87957138750c">session_begin</a>(session);</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;      }</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;   }</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a81b0686f876c73dae138a9caf8e3a505"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">ast_sip_session_supplement::next</a></div><div class="ttdeci">struct ast_sip_session_supplement * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">res_pjsip_session.h:355</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a37e27e4c260104858c6a87957138750c"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a37e27e4c260104858c6a87957138750c">ast_sip_session_supplement::session_begin</a></div><div class="ttdeci">void(* session_begin)(struct ast_sip_session *session)</div><div class="ttdoc">Notification that the session has begun This method will always be called from a SIP servant thread...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00297">res_pjsip_session.h:297</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e81e5efda52a0a77616b0490de568c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e81e5efda52a0a77616b0490de568c0">&#9670;&nbsp;</a></span>handle_session_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_session_destroy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04426">4426</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">ast_sip_session_supplement::next</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00309">ast_sip_session_supplement::session_destroy</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">session_destructor()</a>.</p>
<div class="fragment"><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;{</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *iter;</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, iter, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>) {</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a4cb9351d78dd9b9f98738dca3bf2ff61">session_destroy</a>) {</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;         iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a4cb9351d78dd9b9f98738dca3bf2ff61">session_destroy</a>(session);</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;      }</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;   }</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;}</div><div class="ttc" id="structast__sip__session__supplement_html_a4cb9351d78dd9b9f98738dca3bf2ff61"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a4cb9351d78dd9b9f98738dca3bf2ff61">ast_sip_session_supplement::session_destroy</a></div><div class="ttdeci">void(* session_destroy)(struct ast_sip_session *session)</div><div class="ttdoc">Notification that the session is being destroyed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00309">res_pjsip_session.h:309</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a81b0686f876c73dae138a9caf8e3a505"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">ast_sip_session_supplement::next</a></div><div class="ttdeci">struct ast_sip_session_supplement * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">res_pjsip_session.h:355</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a70392ec2e318f5b34273e578fb122d1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70392ec2e318f5b34273e578fb122d1e">&#9670;&nbsp;</a></span>handle_session_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_session_end </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04437">4437</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">ast_sip_session_supplement::next</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00305">ast_sip_session_supplement::session_end</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>.</p>
<div class="fragment"><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;{</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *iter;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;   <span class="comment">/* Session is dead.  Notify the supplements. */</span></div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, iter, <a class="code" href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">next</a>) {</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a655aa949e77ebacbaa7d775894928de8">session_end</a>) {</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;         iter-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a655aa949e77ebacbaa7d775894928de8">session_end</a>(session);</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;      }</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;   }</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a655aa949e77ebacbaa7d775894928de8"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a655aa949e77ebacbaa7d775894928de8">ast_sip_session_supplement::session_end</a></div><div class="ttdeci">void(* session_end)(struct ast_sip_session *session)</div><div class="ttdoc">Notification that the session has ended. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00305">res_pjsip_session.h:305</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="structast__sip__session__supplement_html_a81b0686f876c73dae138a9caf8e3a505"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a81b0686f876c73dae138a9caf8e3a505">ast_sip_session_supplement::next</a></div><div class="ttdeci">struct ast_sip_session_supplement * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00355">res_pjsip_session.h:355</a></div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ade348d7dc427f391b1e1d86e23cd614c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade348d7dc427f391b1e1d86e23cd614c">&#9670;&nbsp;</a></span>has_supplement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t has_supplement </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04142">4142</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">does_method_match()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">ast_sip_session_supplement::method</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04335">method</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04215">session_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;{</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a> *supplement;</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;   <span class="keyword">struct </span>pjsip_method *<a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> = &amp;rdata-&gt;msg_info.msg-&gt;line.req.method;</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;   }</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>, supplement, next) {</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a>(&amp;method-&gt;name, supplement-&gt;<a class="code" href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>)) {</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;         <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;      }</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;   }</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;   <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;}</div><div class="ttc" id="structast__sip__session__supplement_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html#a8b44a03925325ceaf2de7b079b1541a1">ast_sip_session_supplement::method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00290">res_pjsip_session.h:290</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="structast__sip__session__supplement_html"><div class="ttname"><a href="../../df/db8/structast__sip__session__supplement.html">ast_sip_session_supplement</a></div><div class="ttdoc">A supplement to SIP message processing. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00286">res_pjsip_session.h:286</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_adfed42a1933e5cd396c5125d2199a14a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#adfed42a1933e5cd396c5125d2199a14a">does_method_match</a></div><div class="ttdeci">static pj_bool_t does_method_match(const pj_str_t *message_method, const char *supplement_method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04129">res_pjsip_session.c:4129</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8fb456164755b6c4fc3df83e70c805c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8fb456164755b6c4fc3df83e70c805c">&#9670;&nbsp;</a></span>internal_sip_session_media_state_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a>* internal_sip_session_media_state_alloc </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sessions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>read_callbacks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00214">214</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00113">AST_VECTOR_INIT</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00238">ast_sip_session_media_state_alloc()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">ast_sip_session_media_state_clone()</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *media_state;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   media_state = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*media_state));</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <span class="keywordflow">if</span> (!media_state) {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;media_state-&gt;sessions, <a class="code" href="../../d3/d0a/structsessions.html">sessions</a>) &lt; 0) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(media_state);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a>(&amp;media_state-&gt;read_callbacks, read_callbacks) &lt; 0) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;media_state-&gt;sessions);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(media_state);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   <span class="keywordflow">return</span> media_state;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="vector_8h_html_ad9d555fa89da1bfc691181993499f785"><div class="ttname"><a href="../../d6/d68/vector_8h.html#ad9d555fa89da1bfc691181993499f785">AST_VECTOR_INIT</a></div><div class="ttdeci">#define AST_VECTOR_INIT(vec, size)</div><div class="ttdoc">Initialize a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00113">vector.h:113</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structsessions_html"><div class="ttname"><a href="../../d3/d0a/structsessions.html">sessions</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d80/chan__skinny_8c_source.html#l01630">chan_skinny.c:1630</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a9fd4f3956c10f6728e85fb62c57703"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a9fd4f3956c10f6728e85fb62c57703">&#9670;&nbsp;</a></span>invite_collision_timeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int invite_collision_timeout </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vsession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01538">1538</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04248">resend_reinvite()</a>.</p>
<div class="fragment"><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;{</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = vsession;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;invite_tsx) {</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">       * INVITE transaction still active.  Let it send</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">       * the collision re-INVITE when it terminates.</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      res = 0;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a70774e88c7455a8dae6a9b8878916abd">invite_terminated</a>(session);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;   }</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a70774e88c7455a8dae6a9b8878916abd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a70774e88c7455a8dae6a9b8878916abd">invite_terminated</a></div><div class="ttdeci">static int invite_terminated(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">res_pjsip_session.c:1487</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab41b92c23f551a348423f5c0721d963a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41b92c23f551a348423f5c0721d963a">&#9670;&nbsp;</a></span>invite_proceeding()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int invite_proceeding </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vsession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">1440</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01310">delayed_method2str()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">DELAYED_METHOD_BYE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">DELAYED_METHOD_INVITE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">DELAYED_METHOD_UPDATE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">delayed_request_free()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">ast_sip_session_delayed_request::method</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">ast_sip_session_delayed_request::next</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01568">update_completed()</a>.</p>
<div class="fragment"><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;{</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = vsession;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;   <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>, delay, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>) {</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      <span class="keywordflow">switch</span> (delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>) {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>:</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a>:</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>);</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Sending delayed %s request\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a>(delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>));</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;         res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a7cf4b150696c1bfae6887edc478f6ee1">send_delayed_request</a>(session, delay);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a>(delay);</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;         <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            found = 1;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;         }</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>:</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;         <span class="comment">/* A BYE is pending so don&#39;t bother anymore. */</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;         found = 1;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="keywordflow">if</span> (found) {</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      }</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   }</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a7cf4b150696c1bfae6887edc478f6ee1"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a7cf4b150696c1bfae6887edc478f6ee1">send_delayed_request</a></div><div class="ttdeci">static int send_delayed_request(struct ast_sip_session *session, struct ast_sip_session_delayed_request *delay)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">res_pjsip_session.c:1394</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abdb87d2e0451ce7382da2c5b23525c73"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a></div><div class="ttdeci">static void delayed_request_free(struct ast_sip_session_delayed_request *delay)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">res_pjsip_session.c:1379</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a511a1f5d1b239c41b9eb4953ae4386ea"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a></div><div class="ttdeci">static const char * delayed_method2str(enum delayed_method method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01310">res_pjsip_session.c:1310</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_af35ce25e8bd0e6e2c67f9d1d40003973"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">ast_sip_session_delayed_request::method</a></div><div class="ttdeci">enum delayed_method method</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">res_pjsip_session.c:1338</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a6371800ca2b62c38686de1486a19e799"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">ast_sip_session_delayed_request::next</a></div><div class="ttdeci">struct ast_sip_session_delayed_request * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">res_pjsip_session.c:1352</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">res_pjsip_session.c:1296</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></div><div class="ttdoc">Structure used for sending delayed requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01336">res_pjsip_session.c:1336</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">res_pjsip_session.c:1297</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a70774e88c7455a8dae6a9b8878916abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70774e88c7455a8dae6a9b8878916abd">&#9670;&nbsp;</a></span>invite_terminated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int invite_terminated </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vsession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">1487</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01310">delayed_method2str()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">DELAYED_METHOD_BYE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">DELAYED_METHOD_INVITE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">DELAYED_METHOD_UPDATE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">delayed_request_free()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">ast_sip_session_delayed_request::method</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">ast_sip_session_delayed_request::next</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00201">ast_sip_session::rescheduled_reinvite</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01538">invite_collision_timeout()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01568">update_completed()</a>.</p>
<div class="fragment"><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;{</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = vsession;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;   <span class="keywordtype">int</span> found = 0;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;   <span class="keywordtype">int</span> timer_running;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   <span class="comment">/* re-INVITE collision timer running? */</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;   timer_running = pj_timer_entry_running(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a33674a0633d7ab63def106a0c57f2980">rescheduled_reinvite</a>);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>, delay, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>) {</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      <span class="keywordflow">switch</span> (delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>) {</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>:</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;         <span class="keywordflow">if</span> (!timer_running) {</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            found = 1;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;         }</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a>:</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>:</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;         found = 1;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      }</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      <span class="keywordflow">if</span> (found) {</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Sending delayed %s request\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a>(delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>));</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;         res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a7cf4b150696c1bfae6887edc478f6ee1">send_delayed_request</a>(session, delay);</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a>(delay);</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;         <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;         }</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      }</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;   }</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a7cf4b150696c1bfae6887edc478f6ee1"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a7cf4b150696c1bfae6887edc478f6ee1">send_delayed_request</a></div><div class="ttdeci">static int send_delayed_request(struct ast_sip_session *session, struct ast_sip_session_delayed_request *delay)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">res_pjsip_session.c:1394</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abdb87d2e0451ce7382da2c5b23525c73"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a></div><div class="ttdeci">static void delayed_request_free(struct ast_sip_session_delayed_request *delay)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">res_pjsip_session.c:1379</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a511a1f5d1b239c41b9eb4953ae4386ea"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a></div><div class="ttdeci">static const char * delayed_method2str(enum delayed_method method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01310">res_pjsip_session.c:1310</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_af35ce25e8bd0e6e2c67f9d1d40003973"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">ast_sip_session_delayed_request::method</a></div><div class="ttdeci">enum delayed_method method</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">res_pjsip_session.c:1338</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a6371800ca2b62c38686de1486a19e799"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">ast_sip_session_delayed_request::next</a></div><div class="ttdeci">struct ast_sip_session_delayed_request * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">res_pjsip_session.c:1352</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session_html_a33674a0633d7ab63def106a0c57f2980"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a33674a0633d7ab63def106a0c57f2980">ast_sip_session::rescheduled_reinvite</a></div><div class="ttdeci">pj_timer_entry rescheduled_reinvite</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00201">res_pjsip_session.h:201</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">res_pjsip_session.c:1296</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></div><div class="ttdoc">Structure used for sending delayed requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01336">res_pjsip_session.c:1336</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">res_pjsip_session.c:1297</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a92df7a5cec6415bf61773b6a2fdc2043"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92df7a5cec6415bf61773b6a2fdc2043">&#9670;&nbsp;</a></span>is_media_state_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int is_media_state_valid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>session_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01751">1751</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/def/codec_8c_source.html#l00347">ast_codec_media_type2str()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00309">ast_stream_get_name()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00316">ast_stream_get_type()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00337">ast_stream_to_str()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00936">ast_stream_topology_to_str()</a>, <a class="el" href="../../d2/d48/strings_8c_source.html#l00239">ast_strings_equal()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01739">GET_STREAM_NAME_SAFE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00119">ast_sip_session_media::label</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00834">SCOPE_EXIT_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00109">session_count</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">ast_sip_session_media::stream_num</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01734">STREAM_REMOVED</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">ast_sip_session_media::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>.</p>
<div class="fragment"><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;{</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   <span class="keywordtype">int</span> stream_count = <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dd/d43/http_8c.html#a7aa5af3eb4d501b0c44c590507f751e8">session_count</a> = <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;state-&gt;sessions);</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: Topology: %s\n&quot;</span>, session_name,</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;   <span class="keywordflow">if</span> (session_count != stream_count) {</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;%s: %d media sessions but %d streams\n&quot;</span>, session_name,</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;         session_count, stream_count);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;   }</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; stream_count; i++) {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *stream_name = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;      <span class="keywordtype">int</span> j;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(4, <span class="stringliteral">&quot;%s: Checking stream %s\n&quot;</span>, session_name, <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keywordflow">if</span> (!stream) {</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <span class="stringliteral">&quot;%s: stream %d is null\n&quot;</span>, session_name, i);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      }</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      stream_name = <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; stream_count; j++) {</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *possible_dup = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, j);</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;         <span class="keywordflow">if</span> (j == i || !possible_dup) {</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;         }</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a54d2a76e6f2247e72619e26b239837d4">STREAM_REMOVED</a>(stream) &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(stream_name, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(possible_dup))) {</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <span class="stringliteral">&quot;%s: stream %i %s is duplicated to %d\n&quot;</span>, session_name,</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;               i, stream_name, j);</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;         }</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      }</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;      media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;state-&gt;sessions, i);</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      <span class="keywordflow">if</span> (!media) {</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: media %d is null\n&quot;</span>, session_name, i);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      }</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../dd/d43/http_8c.html#a7aa5af3eb4d501b0c44c590507f751e8">session_count</a>; j++) {</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *possible_dup = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;state-&gt;sessions, j);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;         <span class="keywordflow">if</span> (j == i || !possible_dup) {</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;         }</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a>) &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(possible_dup-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a>)</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a>, possible_dup-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a>)) {</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <span class="stringliteral">&quot;%s: media %d %s is duplicated to %d\n&quot;</span>, session_name,</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;               i, media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a>, j);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;         }</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      }</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keywordflow">if</span> (media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">stream_num</a> != i) {</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <span class="stringliteral">&quot;%s: media %d has stream_num %d\n&quot;</span>, session_name,</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            i, media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">stream_num</a>);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      }</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="keywordflow">if</span> (media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> != <a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream)) {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <span class="stringliteral">&quot;%s: media %d has type %s but stream has type %s\n&quot;</span>, stream_name,</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            i, <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a>), <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(<a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream)));</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      }</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s: Done with stream %s\n&quot;</span>, session_name, <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(stream, &amp;STR_TMP)));</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;   }</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;   res = 1;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s: %s\n&quot;</span>, session_name, res ? <span class="stringliteral">&quot;Valid&quot;</span> : <span class="stringliteral">&quot;NOT Valid&quot;</span>);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;}</div><div class="ttc" id="stream_8h_html_af793e90c3796564a01574fd9c5e9e208"><div class="ttname"><a href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a></div><div class="ttdeci">const char * ast_stream_to_str(const struct ast_stream *stream, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the stream for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00337">stream.c:337</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a54d2a76e6f2247e72619e26b239837d4"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a54d2a76e6f2247e72619e26b239837d4">STREAM_REMOVED</a></div><div class="ttdeci">#define STREAM_REMOVED(_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01734">res_pjsip_session.c:1734</a></div></div>
<div class="ttc" id="stream_8h_html_a86319542b92fb0dc6b2ed337d83cf8ce"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a></div><div class="ttdeci">enum ast_media_type ast_stream_get_type(const struct ast_stream *stream)</div><div class="ttdoc">Get the media type of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00316">stream.c:316</a></div></div>
<div class="ttc" id="codec_8h_html_a97df2e6b65823085173625553d2e06c5"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a></div><div class="ttdeci">const char * ast_codec_media_type2str(enum ast_media_type type)</div><div class="ttdoc">Conversion function to take a media type and turn it into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00347">codec.c:347</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="stream_8h_html_a3da8d8e63718c47d43b9e738c7f6e55a"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a></div><div class="ttdeci">const char * ast_stream_topology_to_str(const struct ast_stream_topology *topology, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the topology for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00936">stream.c:936</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="logger_8h_html_a91ab9408bcc739e24e6eab78d752585c"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_EXPR(__expr,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00834">logger.h:834</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a8383e75e786449dd2f4258b0819dd8f1"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">ast_sip_session_media::stream_num</a></div><div class="ttdeci">int stream_num</div><div class="ttdoc">The stream number to place into any resulting frames. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">res_pjsip_session.h:109</a></div></div>
<div class="ttc" id="strings_8h_html_a13824dd1c76e6cbb12dd7f7783fca8fd"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a></div><div class="ttdeci">int ast_strings_equal(const char *str1, const char *str2)</div><div class="ttdoc">Compare strings for equality checking for NULL. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d48/strings_8c_source.html#l00239">strings.c:239</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="http_8c_html_a7aa5af3eb4d501b0c44c590507f751e8"><div class="ttname"><a href="../../dd/d43/http_8c.html#a7aa5af3eb4d501b0c44c590507f751e8">session_count</a></div><div class="ttdeci">static int session_count</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00109">http.c:109</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a57b08a6ad7a004d70eba4a1b6867a084"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">ast_sip_session_media::type</a></div><div class="ttdeci">enum ast_media_type type</div><div class="ttdoc">Media type of this session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">res_pjsip_session.h:105</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a2cb39c08deca8673d9d2e744dc87fd6d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a></div><div class="ttdeci">#define GET_STREAM_NAME_SAFE(_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01739">res_pjsip_session.c:1739</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a45bbe8d6a0166c19b5c4650fc08112ae"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">ast_sip_session_media::label</a></div><div class="ttdeci">char label[AST_UUID_STR_LEN]</div><div class="ttdoc">Track label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00119">res_pjsip_session.h:119</a></div></div>
<div class="ttc" id="stream_8h_html_afcb45a1d2880128928cfb6d91b19ab46"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a></div><div class="ttdeci">const char * ast_stream_get_name(const struct ast_stream *stream)</div><div class="ttdoc">Get the name of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00309">stream.c:309</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8f4c88669e6520cc93dda53b5635eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8f4c88669e6520cc93dda53b5635eb0">&#9670;&nbsp;</a></span>is_stream_limitation_reached()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int is_stream_limitation_reached </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>type_streams</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00592">592</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00034">AST_MEDIA_TYPE_IMAGE</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00035">AST_MEDIA_TYPE_TEXT</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00031">AST_MEDIA_TYPE_UNKNOWN</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00033">AST_MEDIA_TYPE_VIDEO</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00788">ast_sip_endpoint_media_configuration::max_audio_streams</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00790">ast_sip_endpoint_media_configuration::max_video_streams</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;{</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>) {</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a>:</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">return</span> !(type_streams[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] &lt; endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a3db89336e49e888eaf4b3d2add416772">max_audio_streams</a>);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>:</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">return</span> !(type_streams[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] &lt; endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a6ad556d3568ba858fdb4fde5f5203293">max_video_streams</a>);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a>:</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">/* We don&#39;t have an option for image (T.38) streams so cap it to one. */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordflow">return</span> (type_streams[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] &gt; 0);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a>:</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acdcfb16791fa00269621e51c42f5a4c3">AST_MEDIA_TYPE_TEXT</a>:</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="comment">/* We don&#39;t want any unknown or &quot;other&quot; streams on our endpoint,</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">       * so always just say we&#39;ve reached the limit</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   }</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a3db89336e49e888eaf4b3d2add416772"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a3db89336e49e888eaf4b3d2add416772">ast_sip_endpoint_media_configuration::max_audio_streams</a></div><div class="ttdeci">unsigned int max_audio_streams</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00788">res_pjsip.h:788</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00034">codec.h:34</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00031">codec.h:31</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212acdcfb16791fa00269621e51c42f5a4c3"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acdcfb16791fa00269621e51c42f5a4c3">AST_MEDIA_TYPE_TEXT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00035">codec.h:35</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a6ad556d3568ba858fdb4fde5f5203293"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a6ad556d3568ba858fdb4fde5f5203293">ast_sip_endpoint_media_configuration::max_video_streams</a></div><div class="ttdeci">unsigned int max_video_streams</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00790">res_pjsip.h:790</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06074">6074</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00365">AO2_ALLOC_OPT_LOCK_MUTEX</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01310">ao2_container_alloc_hash</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00464">ast_module_shutdown_ref</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03315">ast_sip_register_service()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l01744">ast_sorcery_alloc()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02057">ast_sorcery_create()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00127">AST_TEST_REGISTER</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00275">ast_sip_nat_hook::outgoing_external_message</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00055">SDP_HANDLER_BUCKETS</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00129">sdp_handler_list_cmp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00107">sdp_handler_list_hash()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00342">ast_module_info::self</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">session_outgoing_nat_hook()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06108">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;{</div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;   pjsip_endpoint *endpt;</div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;</div><div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>() || !<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>()) {</div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;   }</div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a> = <a class="code" href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <span class="stringliteral">&quot;nat_hook&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;   }</div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a>-&gt;<a class="code" href="../../d3/dfb/structast__sip__nat__hook.html#a57e6629a9bf4657c8a916f459d776850">outgoing_external_message</a> = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#af218de4dc85933870fdfe1d91af9261e">session_outgoing_nat_hook</a>;</div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a>);</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0,</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a68ecfcde443319d00e5bdbe30fed8c1d">SDP_HANDLER_BUCKETS</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a9c73481a00684ae28b5c0eae9e1c07ca">sdp_handler_list_hash</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a402de077579a28f56ed42213f8b76c27">sdp_handler_list_cmp</a>);</div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>) {</div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;   }</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;   endpt = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>();</div><div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;   pjsip_inv_usage_init(endpt, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a7434c8ec76e08306dd925b85a655365a">inv_callback</a>);</div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;   pjsip_100rel_init_module(endpt);</div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;   pjsip_timer_init_module(endpt);</div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a>(&amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>)) {</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;   }</div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a>(&amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5c77944ce4b545d91f1d14b67fe4d525">session_reinvite_module</a>);</div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a>(&amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a724b2cc287d0952c4bbb94bc14c3d5b6">outbound_invite_auth_module</a>);</div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;</div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;   <a class="code" href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a>(<a class="code" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>-&gt;<a class="code" href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">self</a>);</div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(test_resolve_refresh_media_states);</div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5c77944ce4b545d91f1d14b67fe4d525"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5c77944ce4b545d91f1d14b67fe4d525">session_reinvite_module</a></div><div class="ttdeci">static pjsip_module session_reinvite_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02812">res_pjsip_session.c:2812</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a68ecfcde443319d00e5bdbe30fed8c1d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a68ecfcde443319d00e5bdbe30fed8c1d">SDP_HANDLER_BUCKETS</a></div><div class="ttdeci">#define SDP_HANDLER_BUCKETS</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00055">res_pjsip_session.c:55</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_af218de4dc85933870fdfe1d91af9261e"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#af218de4dc85933870fdfe1d91af9261e">session_outgoing_nat_hook</a></div><div class="ttdeci">static void session_outgoing_nat_hook(pjsip_tx_data *tdata, struct ast_sip_transport *transport)</div><div class="ttdoc">Hook for modifying outgoing messages with SDP to contain the proper address information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">res_pjsip_session.c:5457</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a7434c8ec76e08306dd925b85a655365a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a7434c8ec76e08306dd925b85a655365a">inv_callback</a></div><div class="ttdeci">static pjsip_inv_callback inv_callback</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05446">res_pjsip_session.c:5446</a></div></div>
<div class="ttc" id="structast__module__info_html"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html">ast_module_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00336">module.h:336</a></div></div>
<div class="ttc" id="test_8h_html_a34f64a69c09d98ceb693b077efd7ef97"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a></div><div class="ttdeci">#define AST_TEST_REGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00127">test.h:127</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a402de077579a28f56ed42213f8b76c27"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a402de077579a28f56ed42213f8b76c27">sdp_handler_list_cmp</a></div><div class="ttdeci">static int sdp_handler_list_cmp(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00129">res_pjsip_session.c:129</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a75076a42e720601f2234ac8a927ea4f9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a></div><div class="ttdeci">static struct ast_sip_nat_hook * nat_hook</div><div class="ttdoc">NAT hook for modifying outgoing messages with SDP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00084">res_pjsip_session.c:84</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="sorcery_8h_html_a575dfe8fd872c033d2b902549df502ea"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a575dfe8fd872c033d2b902549df502ea">ast_sorcery_create</a></div><div class="ttdeci">int ast_sorcery_create(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Create and potentially persist an object using an available wizard. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02057">sorcery.c:2057</a></div></div>
<div class="ttc" id="structast__module__info_html_a1aff0615d43e1dfa5c72c1c7d1c6d709"><div class="ttname"><a href="../../dd/d5f/structast__module__info.html#a1aff0615d43e1dfa5c72c1c7d1c6d709">ast_module_info::self</a></div><div class="ttdeci">struct ast_module * self</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00342">module.h:342</a></div></div>
<div class="ttc" id="structast__sip__nat__hook_html_a57e6629a9bf4657c8a916f459d776850"><div class="ttname"><a href="../../d3/dfb/structast__sip__nat__hook.html#a57e6629a9bf4657c8a916f459d776850">ast_sip_nat_hook::outgoing_external_message</a></div><div class="ttdeci">void(* outgoing_external_message)(struct pjsip_tx_data *tdata, struct ast_sip_transport *transport)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00275">res_pjsip.h:275</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d923ef44f62dffc05178f762b88f084"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d923ef44f62dffc05178f762b88f084">ast_sip_register_service</a></div><div class="ttdeci">int ast_sip_register_service(pjsip_module *module)</div><div class="ttdoc">Register a SIP service in Asterisk. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03315">res_pjsip.c:3315</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="module_8h_html_a9967b09817639f2e15c3f074a60b6379"><div class="ttname"><a href="../../d5/d16/module_8h.html#a9967b09817639f2e15c3f074a60b6379">ast_module_shutdown_ref</a></div><div class="ttdeci">#define ast_module_shutdown_ref(mod)</div><div class="ttdoc">Prevent unload of the module before shutdown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00464">module.h:464</a></div></div>
<div class="ttc" id="sorcery_8h_html_acb6c97c18566cf94a7ac95a43dd9a816"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#acb6c97c18566cf94a7ac95a43dd9a816">ast_sorcery_alloc</a></div><div class="ttdeci">void * ast_sorcery_alloc(const struct ast_sorcery *sorcery, const char *type, const char *id)</div><div class="ttdoc">Allocate an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l01744">sorcery.c:1744</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a9c73481a00684ae28b5c0eae9e1c07ca"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a9c73481a00684ae28b5c0eae9e1c07ca">sdp_handler_list_hash</a></div><div class="ttdeci">static int sdp_handler_list_hash(const void *obj, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00107">res_pjsip_session.c:107</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a724b2cc287d0952c4bbb94bc14c3d5b6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a724b2cc287d0952c4bbb94bc14c3d5b6">outbound_invite_auth_module</a></div><div class="ttdeci">static pjsip_module outbound_invite_auth_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03290">res_pjsip_session.c:3290</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a75356a9f850bf7c497f8a963719457"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a75356a9f850bf7c497f8a963719457">&#9670;&nbsp;</a></span>media_stats_local_ssrc_cmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int media_stats_local_ssrc_cmp </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a> *&#160;</td>
          <td class="paramname"><em>vec_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/db0/structast__rtp__instance__stats.html">ast_rtp_instance_stats</a> *&#160;</td>
          <td class="paramname"><em>srch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00204">204</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/dde/rtp__engine_8h_source.html#l00422">ast_rtp_instance_stats::local_ssrc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00244">ast_sip_session_media_stats_save()</a>.</p>
<div class="fragment"><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;{</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="keywordflow">if</span> (vec_elem-&gt;<a class="code" href="../../d0/db0/structast__rtp__instance__stats.html#a345269c0d57add15c919b781d140e011">local_ssrc</a> == srch-&gt;<a class="code" href="../../d0/db0/structast__rtp__instance__stats.html#a345269c0d57add15c919b781d140e011">local_ssrc</a>) {</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;   }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div><div class="ttc" id="structast__rtp__instance__stats_html_a345269c0d57add15c919b781d140e011"><div class="ttname"><a href="../../d0/db0/structast__rtp__instance__stats.html#a345269c0d57add15c919b781d140e011">ast_rtp_instance_stats::local_ssrc</a></div><div class="ttdeci">unsigned int local_ssrc</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/rtp__engine_8h_source.html#l00422">rtp_engine.h:422</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e9e5a5b3898c8806dcc54e3615df7de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9e5a5b3898c8806dcc54e3615df7de">&#9670;&nbsp;</a></span>new_invite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int <a class="el" href="../../db/d09/structnew__invite.html">new_invite</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../db/d09/structnew__invite.html">new_invite</a> *&#160;</td>
          <td class="paramname"><em>invite</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03911">3911</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">ast_sip_session_send_response()</a>, <a class="el" href="../../db/df1/netsock2_8h_source.html#l00046">AST_SOCKADDR_BUFLEN</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00952">ast_trace_log</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03891">check_content_disposition()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00815">ast_sip_endpoint::context</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00181">ast_sip_session::exten</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00839">ast_sip_endpoint::extensions</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03666">get_destination()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">handle_incoming_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00263">LOG_NOTICE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00565">ast_sip_timer_options::min_se</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00889">ast_sip_endpoint::preferred_codec_only</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03852">new_invite::rdata</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00567">ast_sip_timer_options::sess_expires</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03849">new_invite::session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03647">SIP_GET_DEST_EXTEN_FOUND</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03649">SIP_GET_DEST_EXTEN_NOT_FOUND</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03651">SIP_GET_DEST_EXTEN_PARTIAL</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03653">SIP_GET_DEST_UNSUPPORTED_URI</a>, <a class="el" href="../../d5/dff/chan__iax2_8c_source.html#l00360">timer</a>, and <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00580">ast_sip_endpoint_extensions::timer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;{</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;   pjsip_tx_data *tdata = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;   pjsip_timer_setting <a class="code" href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a>;</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;   pjsip_rdata_sdp_info *sdp_info;</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;   pjmedia_sdp_session *local = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;   <span class="keywordtype">char</span> buffer[<a class="code" href="../../db/df1/netsock2_8h.html#aded4d9ff3f772448b4716fd90ed47c8d">AST_SOCKADDR_BUFLEN</a>];</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>));</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;   <span class="comment">/* From this point on, any calls to pjsip_inv_terminate have the last argument as PJ_TRUE</span></div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<span class="comment">    * so that we will be notified so we can destroy the session properly</span></div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;   <span class="keywordflow">if</span> (invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;state == PJSIP_INV_STATE_DISCONNECTED) {</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5d49448c8fb67653b262908711eb31b5">ast_trace_log</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Session already DISCONNECTED [reason=%d (%s)]\n&quot;</span>,</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>),</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;cause,</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;         pjsip_get_status_text(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;cause)-&gt;ptr);</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1);</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;   }</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6164e7cb4f4be9ee46724fbdcdd86736">get_destination</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>)) {</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59">SIP_GET_DEST_EXTEN_FOUND</a>:</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;      <span class="comment">/* Things worked. Keep going */</span></div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be">SIP_GET_DEST_UNSUPPORTED_URI</a>:</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Call (%s:%s) to extension &#39;%s&#39; - unsupported uri\n&quot;</span>,</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>),</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;type_name,</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;         pj_sockaddr_print(&amp;invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;pkt_info.src_addr, buffer, <span class="keyword">sizeof</span>(buffer), 3),</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_initial_answer(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, 416, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, tdata);</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;      } <span class="keywordflow">else</span>  {</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;         pjsip_inv_terminate(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 416, PJ_TRUE);</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      }</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa">SIP_GET_DEST_EXTEN_PARTIAL</a>:</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Call (%s:%s) to extension &#39;%s&#39; - partial match\n&quot;</span>,</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>),</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;type_name,</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;         pj_sockaddr_print(&amp;invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;pkt_info.src_addr, buffer, <span class="keyword">sizeof</span>(buffer), 3),</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>);</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_initial_answer(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, 484, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, tdata);</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      } <span class="keywordflow">else</span>  {</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;         pjsip_inv_terminate(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 484, PJ_TRUE);</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;      }</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229">SIP_GET_DEST_EXTEN_NOT_FOUND</a>:</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5d49448c8fb67653b262908711eb31b5">ast_trace_log</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s: Call (%s:%s) to extension &#39;%s&#39; rejected because extension not found in context &#39;%s&#39;.\n&quot;</span>,</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>),</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;type_name,</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;         pj_sockaddr_print(&amp;invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;pkt_info.src_addr, buffer, <span class="keyword">sizeof</span>(buffer), 3),</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>,</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;         invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a7faec841658b88ad0cfbc684853acad3">context</a>);</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_initial_answer(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, 404, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, tdata);</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      } <span class="keywordflow">else</span>  {</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;         pjsip_inv_terminate(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 404, PJ_TRUE);</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      }</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;   };</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0a31909df5d02859b03a0933131828a3">check_content_disposition</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>)) {</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_initial_answer(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, 415, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, tdata);</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      } <span class="keywordflow">else</span>  {</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;         pjsip_inv_terminate(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 415, PJ_TRUE);</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;      }</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;   }</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;   pjsip_timer_setting_default(&amp;timer);</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;   timer.min_se = invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">timer</a>.<a class="code" href="../../d1/de1/structast__sip__timer__options.html#abc8cf95684205004f10203166581fc5d">min_se</a>;</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;   timer.sess_expires = invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">timer</a>.<a class="code" href="../../d1/de1/structast__sip__timer__options.html#a3033f0fbb7aa3b8fbacf78ae177358d3">sess_expires</a>;</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;   pjsip_timer_init_session(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, &amp;timer);</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="comment">    * At this point, we&#39;ve verified what we can that won&#39;t take awhile,</span></div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="comment">    * so let&#39;s go ahead and send a 100 Trying out to stop any</span></div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="comment">    * retransmissions.</span></div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Call (%s:%s) to extension &#39;%s&#39; sending 100 Trying\n&quot;</span>,</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>),</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;      invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;tp_info.transport-&gt;type_name,</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;      pj_sockaddr_print(&amp;invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>-&gt;pkt_info.src_addr, buffer, <span class="keyword">sizeof</span>(buffer), 3),</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;      invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">exten</a>);</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_initial_answer(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>, 100, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;      pjsip_inv_terminate(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 500, PJ_TRUE);</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;   }</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, tdata);</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;   sdp_info = pjsip_rdata_get_sdp_info(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>);</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;   <span class="keywordflow">if</span> (sdp_info &amp;&amp; (sdp_info-&gt;sdp_err == PJ_SUCCESS) &amp;&amp; sdp_info-&gt;sdp) {</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a148cffe818b8c47b8233c0c118c116a0">handle_incoming_sdp</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, sdp_info-&gt;sdp)) {</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;         tdata = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;         <span class="keywordflow">if</span> (pjsip_inv_end_session(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 488, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;            &amp;&amp; tdata) {</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, tdata);</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;         }</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      }</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      <span class="comment">/* We are creating a local SDP which is an answer to their offer */</span></div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;      local = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, sdp_info-&gt;sdp);</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      <span class="comment">/* We are creating a local SDP which is an offer */</span></div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      local = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;   }</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;   <span class="comment">/* If we were unable to create a local SDP terminate the session early, it won&#39;t go anywhere */</span></div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;   <span class="keywordflow">if</span> (!local) {</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      tdata = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_end_session(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;         &amp;&amp; tdata) {</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, tdata);</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;      }</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>;</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;   }</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;   pjsip_inv_set_local_sdp(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, local);</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;   pjmedia_sdp_neg_set_prefer_remote_codec_order(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;neg, PJ_FALSE);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="preprocessor">#ifdef PJMEDIA_SDP_NEG_ANSWER_MULTIPLE_CODECS</span></div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;   <span class="keywordflow">if</span> (!invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a65d1205823395f1a6c4f8c1af4d18a50">preferred_codec_only</a>) {</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;      pjmedia_sdp_neg_set_answer_multiple_codecs(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;neg, PJ_TRUE);</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;   }</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a10082c2a0d8b402ea1df1e65c8482ba6">handle_incoming_request</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>, invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">rdata</a>);</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(invite-&gt;<a class="code" href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">session</a>));</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;}</div><div class="ttc" id="netsock2_8h_html_aded4d9ff3f772448b4716fd90ed47c8d"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aded4d9ff3f772448b4716fd90ed47c8d">AST_SOCKADDR_BUFLEN</a></div><div class="ttdeci">#define AST_SOCKADDR_BUFLEN</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00046">netsock2.h:46</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__timer__options_html_a3033f0fbb7aa3b8fbacf78ae177358d3"><div class="ttname"><a href="../../d1/de1/structast__sip__timer__options.html#a3033f0fbb7aa3b8fbacf78ae177358d3">ast_sip_timer_options::sess_expires</a></div><div class="ttdeci">unsigned int sess_expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00567">res_pjsip.h:567</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aed4c9a6bf6967790981c02027f5f02e8"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aed4c9a6bf6967790981c02027f5f02e8">ast_sip_session_send_response</a></div><div class="ttdeci">void ast_sip_session_send_response(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP response. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">res_pjsip_session.c:2576</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a148cffe818b8c47b8233c0c118c116a0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a148cffe818b8c47b8233c0c118c116a0">handle_incoming_sdp</a></div><div class="ttdeci">static int handle_incoming_sdp(struct ast_sip_session *session, const pjmedia_sdp_session *sdp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">res_pjsip_session.c:764</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0a31909df5d02859b03a0933131828a3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0a31909df5d02859b03a0933131828a3">check_content_disposition</a></div><div class="ttdeci">static int check_content_disposition(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03891">res_pjsip_session.c:3891</a></div></div>
<div class="ttc" id="structnew__invite_html_a47bd1bb949183a58a194970acaccffbd"><div class="ttname"><a href="../../db/d09/structnew__invite.html#a47bd1bb949183a58a194970acaccffbd">new_invite::session</a></div><div class="ttdeci">struct ast_sip_session * session</div><div class="ttdoc">Session created for the new INVITE. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03849">res_pjsip_session.c:3849</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a7faec841658b88ad0cfbc684853acad3"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a7faec841658b88ad0cfbc684853acad3">ast_sip_endpoint::context</a></div><div class="ttdeci">const ast_string_field context</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00815">res_pjsip.h:815</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6164e7cb4f4be9ee46724fbdcdd86736"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6164e7cb4f4be9ee46724fbdcdd86736">get_destination</a></div><div class="ttdeci">static enum sip_get_destination_result get_destination(struct ast_sip_session *session, pjsip_rx_data *rdata)</div><div class="ttdoc">Determine where in the dialplan a call should go. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03666">res_pjsip_session.c:3666</a></div></div>
<div class="ttc" id="structast__sip__session_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a78d4847658b695383d849efd12399b38">ast_sip_session::exten</a></div><div class="ttdeci">char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00181">res_pjsip_session.h:181</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a277fcf92f3cfbc1891fbb840eb44f9fa">SIP_GET_DEST_EXTEN_PARTIAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03651">res_pjsip_session.c:3651</a></div></div>
<div class="ttc" id="structast__sip__timer__options_html_abc8cf95684205004f10203166581fc5d"><div class="ttname"><a href="../../d1/de1/structast__sip__timer__options.html#abc8cf95684205004f10203166581fc5d">ast_sip_timer_options::min_se</a></div><div class="ttdeci">unsigned int min_se</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00565">res_pjsip.h:565</a></div></div>
<div class="ttc" id="logger_8h_html_a5d49448c8fb67653b262908711eb31b5"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5d49448c8fb67653b262908711eb31b5">ast_trace_log</a></div><div class="ttdeci">#define ast_trace_log(__level, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00952">logger.h:952</a></div></div>
<div class="ttc" id="structnew__invite_html_a41249c16bd9cc17b36f3719debaf7a67"><div class="ttname"><a href="../../db/d09/structnew__invite.html#a41249c16bd9cc17b36f3719debaf7a67">new_invite::rdata</a></div><div class="ttdeci">pjsip_rx_data * rdata</div><div class="ttdoc">INVITE request itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03852">res_pjsip_session.c:3852</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a1acf9446e8201b6865a811e32f3ffd59">SIP_GET_DEST_EXTEN_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03647">res_pjsip_session.c:3647</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a65d1205823395f1a6c4f8c1af4d18a50"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a65d1205823395f1a6c4f8c1af4d18a50">ast_sip_endpoint::preferred_codec_only</a></div><div class="ttdeci">unsigned int preferred_codec_only</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00889">res_pjsip.h:889</a></div></div>
<div class="ttc" id="structast__sip__endpoint__extensions_html_a28a4f505bc0cea6581fa6bde2161bced"><div class="ttname"><a href="../../df/de5/structast__sip__endpoint__extensions.html#a28a4f505bc0cea6581fa6bde2161bced">ast_sip_endpoint_extensions::timer</a></div><div class="ttdeci">struct ast_sip_timer_options timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00580">res_pjsip.h:580</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591aad1d87b474f3c3e600ca6fdc55abc229">SIP_GET_DEST_EXTEN_NOT_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03649">res_pjsip_session.c:3649</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a10082c2a0d8b402ea1df1e65c8482ba6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a10082c2a0d8b402ea1df1e65c8482ba6">handle_incoming_request</a></div><div class="ttdeci">static void handle_incoming_request(struct ast_sip_session *session, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04398">res_pjsip_session.c:4398</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a76b100c44ffb8b301467785f3dd1c984"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">ast_sip_endpoint::extensions</a></div><div class="ttdeci">struct ast_sip_endpoint_extensions extensions</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00839">res_pjsip.h:839</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aba73dfdfaa94dc744be18ae4e8b01591a39531f2aeb55fd106c9543b4a9a704be">SIP_GET_DEST_UNSUPPORTED_URI</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03653">res_pjsip_session.c:3653</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_a9aed6490b63794e6c9c00af4533f255f"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#a9aed6490b63794e6c9c00af4533f255f">timer</a></div><div class="ttdeci">static struct ast_timer * timer</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l00360">chan_iax2.c:360</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5d8c9900de369edecd27e4471403e96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d8c9900de369edecd27e4471403e96">&#9670;&nbsp;</a></span>new_invite_initial_answer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int new_invite_initial_answer </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv_session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>answer_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>terminate_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_bool_t&#160;</td>
          <td class="paramname"><em>notify</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03742">3742</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03789">pre_session_setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;{</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;   pjsip_tx_data *tdata = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;   <span class="keywordflow">if</span> (inv_session-&gt;state != PJSIP_INV_STATE_DISCONNECTED) {</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_initial_answer(</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;            inv_session, rdata, answer_code, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;         pjsip_inv_terminate(inv_session, terminate_code ? terminate_code : answer_code, notify);</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;         res = -1;</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;         pjsip_inv_send_msg(inv_session, tdata);</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;      }</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;   }</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;   <span class="keywordflow">if</span> (answer_code &gt;= 300) {</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="comment">       * A session is ending. The dialog has a reference that needs to be</span></div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="comment">       * removed and holds a lock that needs to be unlocked before returning.</span></div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      pjsip_dlg_dec_lock(inv_session-&gt;dlg);</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;   }</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a891fa1c68e014308f0bddde4da12da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a891fa1c68e014308f0bddde4da12da">&#9670;&nbsp;</a></span>outbound_invite_auth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t outbound_invite_auth </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03231">3231</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03412">ast_sip_create_request_with_auth()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00239">ast_sip_session::authentication_challenge_count</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00080">MAX_RX_CHALLENGES</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00855">ast_sip_endpoint::outbound_auths</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>
<div class="fragment"><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;{</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;   pjsip_transaction *tsx;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;   pjsip_inv_session *inv;</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;   <span class="keywordflow">if</span> (rdata-&gt;msg_info.msg-&gt;line.status.code != 401</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      &amp;&amp; rdata-&gt;msg_info.msg-&gt;line.status.code != 407) {</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <span class="comment">/* Doesn&#39;t pertain to us. Move on */</span></div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;   }</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;   tsx = pjsip_rdata_get_tsx(rdata);</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;   dlg = pjsip_rdata_get_dlg(rdata);</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;   <span class="keywordflow">if</span> (!dlg || !tsx) {</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;   }</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;   <span class="keywordflow">if</span> (tsx-&gt;method.id != PJSIP_INVITE_METHOD) {</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      <span class="comment">/* Not an INVITE that needs authentication */</span></div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;   }</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;   inv = pjsip_dlg_get_inv_session(dlg);</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;   session = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;   <span class="keywordflow">if</span> (PJSIP_INV_STATE_CONFIRMED &lt;= inv-&gt;<a class="code" href="../../d4/d88/structstate.html">state</a>) {</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment">       * We cannot handle reINVITE authentication at this</span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">       * time because the reINVITE transaction is still in</span></div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment">       * progress.</span></div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: A reINVITE is being challenged\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;   }</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Initial INVITE is being challenged.\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;   <span class="keywordflow">if</span> (++session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3539fdfd1818b8bcd20845575d624b2b">authentication_challenge_count</a> &gt; <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad20119f55c48a211b2a552abdcada8ea">MAX_RX_CHALLENGES</a>) {</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Initial INVITE reached maximum number of auth attempts.\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;   }</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a4810e8d609e3e1a5dd97faaca36d55ee">ast_sip_create_request_with_auth</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>, rdata,</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;      tsx-&gt;last_tx, &amp;tdata)) {</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;   }</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;<span class="comment">    * Restart the outgoing initial INVITE transaction to deal</span></div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="comment">    * with authentication.</span></div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;   pjsip_inv_uac_restart(inv, PJ_FALSE);</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a>(session, tdata);</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;   <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a045e92a13d3f4b1e0d061b4b6e64f1e1"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">ast_sip_endpoint::outbound_auths</a></div><div class="ttdeci">struct ast_sip_auth_vector outbound_auths</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00855">res_pjsip.h:855</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip_8h_html_a4810e8d609e3e1a5dd97faaca36d55ee"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a4810e8d609e3e1a5dd97faaca36d55ee">ast_sip_create_request_with_auth</a></div><div class="ttdeci">int ast_sip_create_request_with_auth(const struct ast_sip_auth_vector *auths, pjsip_rx_data *challenge, pjsip_tx_data *tdata, pjsip_tx_data **new_request)</div><div class="ttdoc">Create a response to an authentication challenge. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03412">res_pjsip.c:3412</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ad20119f55c48a211b2a552abdcada8ea"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ad20119f55c48a211b2a552abdcada8ea">MAX_RX_CHALLENGES</a></div><div class="ttdeci">#define MAX_RX_CHALLENGES</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00080">res_pjsip.h:80</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3539fdfd1818b8bcd20845575d624b2b"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3539fdfd1818b8bcd20845575d624b2b">ast_sip_session::authentication_challenge_count</a></div><div class="ttdeci">unsigned int authentication_challenge_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00239">res_pjsip_session.h:239</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a35a7aa9427f3aea9384c1a481ce6a5f3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a></div><div class="ttdeci">void ast_sip_session_send_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">res_pjsip_session.c:2842</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c0487787344caa44e95895bfe5b4d0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c0487787344caa44e95895bfe5b4d0a">&#9670;&nbsp;</a></span>pre_session_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_inv_session* pre_session_setup </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d3/d46/structast__sip__endpoint.html">ast_sip_endpoint</a> *&#160;</td>
          <td class="paramname"><em>endpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03789">3789</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l04249">ast_sip_create_dialog_uas_locked()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00839">ast_sip_endpoint::extensions</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00578">ast_sip_endpoint_extensions::flags</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03742">new_invite_initial_answer()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;{</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;   pjsip_inv_session *<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a> = endpoint-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">extensions</a>.<a class="code" href="../../df/de5/structast__sip__endpoint__extensions.html#ac92588540e8c1d014a08cd8a45462b19">flags</a>;</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;   pj_status_t dlg_status = PJ_EUNKNOWN;</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_verify_request(rdata, &amp;options, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), &amp;tdata) != PJ_SUCCESS) {</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      <span class="keywordflow">if</span> (tdata) {</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;         <span class="keywordflow">if</span> (pjsip_endpt_send_response2(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, tdata, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;            pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;         }</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;         pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;      }</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;   }</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;   dlg = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9d885d67aea1a6b3419ea96692cd2527">ast_sip_create_dialog_uas_locked</a>(endpoint, rdata, &amp;dlg_status);</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;   <span class="keywordflow">if</span> (!dlg) {</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;      <span class="keywordflow">if</span> (dlg_status != PJ_EEXISTS) {</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;         pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;      }</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;   }</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="comment">    * The returned dialog holds a lock and has a reference added. Any paths where the</span></div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<span class="comment">    * dialog invite session is not returned must unlock the dialog and remove its reference.</span></div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;   <span class="keywordflow">if</span> (pjsip_inv_create_uas(dlg, rdata, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, options, &amp;inv_session) != PJ_SUCCESS) {</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      pjsip_endpt_respond_stateless(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;<span class="comment">       * The acquired dialog holds a lock, and a reference. Since the dialog is not</span></div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;<span class="comment">       * going to be returned here it must first be unlocked and de-referenced. This</span></div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;<span class="comment">       * must be done prior to calling dialog termination.</span></div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      pjsip_dlg_dec_lock(dlg);</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      pjsip_dlg_terminate(dlg);</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;   }</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="preprocessor">#if defined(HAVE_PJSIP_REPLACE_MEDIA_STREAM) || defined(PJMEDIA_SDP_NEG_ALLOW_MEDIA_CHANGE)</span></div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;   inv_session-&gt;sdp_neg_flags = PJMEDIA_SDP_NEG_ALLOW_MEDIA_CHANGE;</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;   <span class="keywordflow">if</span> (pjsip_dlg_add_usage(dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;      <span class="comment">/* Dialog&#39;s lock and a reference are removed in new_invite_initial_answer */</span></div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad5d8c9900de369edecd27e4471403e96">new_invite_initial_answer</a>(inv_session, rdata, 500, 500, PJ_FALSE);</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      <span class="comment">/* Remove 2nd reference added at inv_session creation */</span></div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;      pjsip_dlg_dec_session(inv_session-&gt;dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>);</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;   }</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9d885d67aea1a6b3419ea96692cd2527"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9d885d67aea1a6b3419ea96692cd2527">ast_sip_create_dialog_uas_locked</a></div><div class="ttdeci">pjsip_dialog * ast_sip_create_dialog_uas_locked(const struct ast_sip_endpoint *endpoint, pjsip_rx_data *rdata, pj_status_t *status)</div><div class="ttdoc">General purpose method for creating a UAS dialog with an endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04249">res_pjsip.c:4249</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="structast__sip__endpoint__extensions_html_ac92588540e8c1d014a08cd8a45462b19"><div class="ttname"><a href="../../df/de5/structast__sip__endpoint__extensions.html#ac92588540e8c1d014a08cd8a45462b19">ast_sip_endpoint_extensions::flags</a></div><div class="ttdeci">unsigned int flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00578">res_pjsip.h:578</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a76b100c44ffb8b301467785f3dd1c984"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a76b100c44ffb8b301467785f3dd1c984">ast_sip_endpoint::extensions</a></div><div class="ttdeci">struct ast_sip_endpoint_extensions extensions</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00839">res_pjsip.h:839</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad5d8c9900de369edecd27e4471403e96"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad5d8c9900de369edecd27e4471403e96">new_invite_initial_answer</a></div><div class="ttdeci">static int new_invite_initial_answer(pjsip_inv_session *inv_session, pjsip_rx_data *rdata, int answer_code, int terminate_code, pj_bool_t notify)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03742">res_pjsip_session.c:3742</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0989647a11cd5cd082cf357a387c47a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0989647a11cd5cd082cf357a387c47a7">&#9670;&nbsp;</a></span>remove_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int remove_handler </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00176">176</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00449">AST_LIST_EMPTY</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01031">CMP_MATCH</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01032">CMP_STOP</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">ast_sip_session_sdp_handler::id</a>, <a class="el" href="../../d9/d38/structsdp__handler__list.html#a0089e5f7869c0acbf1c7790efa24c198">sdp_handler_list::list</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">ast_sip_session_sdp_handler::next</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00102">sdp_handler_list::stream_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00199">ast_sip_session_unregister_sdp_handler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;{</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *handler_list = obj;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a> = data;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *iter;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *stream_type = arg;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;handler_list-&gt;<a class="code" href="../../d9/d38/structsdp__handler__list.html#a0089e5f7869c0acbf1c7790efa24c198">list</a>, iter, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">if</span> (!strcmp(iter-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>)) {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Unregistered SDP stream handler &#39;%s&#39; for stream type &#39;%s&#39;\n&quot;</span>, handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">id</a>, stream_type);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;handler_list-&gt;<a class="code" href="../../d9/d38/structsdp__handler__list.html#a0089e5f7869c0acbf1c7790efa24c198">list</a>)) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;No more handlers exist for stream type &#39;%s&#39;\n&quot;</span>, stream_type);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div><div class="ttc" id="structast__sip__session__sdp__handler_html_aeffa2f0815ce90fecbda9aac199143db"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aeffa2f0815ce90fecbda9aac199143db">ast_sip_session_sdp_handler::id</a></div><div class="ttdeci">const char * id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00382">res_pjsip_session.h:382</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4a1884cde93e53bef32ca85c194a1d05"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a></div><div class="ttdeci">#define AST_LIST_EMPTY(head)</div><div class="ttdoc">Checks whether the specified list contains any entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00449">linkedlists.h:449</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aaa4f9cdda5dd0b1270fb35523054926c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">ast_sip_session_sdp_handler::next</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">res_pjsip_session.h:460</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="structsdp__handler__list_html_a0089e5f7869c0acbf1c7790efa24c198"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html#a0089e5f7869c0acbf1c7790efa24c198">sdp_handler_list::list</a></div><div class="ttdeci">struct sdp_handler_list::@487 list</div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2fe0223b328b94024025dfaca810bf0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2fe0223b328b94024025dfaca810bf0">&#9670;&nbsp;</a></span>remove_stream_from_bundle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void remove_stream_from_bundle </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00754">754</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">ast_sip_session_media::bundled</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>.</p>
<div class="fragment"><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;{</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = -1;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">bundled</a> = 0;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;}</div><div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_adde8efbb4df251209d1b3e05e166a025"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">ast_sip_session_media::bundled</a></div><div class="ttdeci">unsigned int bundled</div><div class="ttdoc">Whether this stream is currently bundled or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">res_pjsip_session.h:115</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aee39c44155dc7a15414bdc64dc86127d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee39c44155dc7a15414bdc64dc86127d">&#9670;&nbsp;</a></span>reschedule_reinvite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void reschedule_reinvite </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">4269</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l02064">ast_random()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">ast_sip_session_media_state_clone()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00696">ast_stream_topology_equal()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">DELAYED_METHOD_INVITE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00201">ast_sip_session::rescheduled_reinvite</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04248">resend_reinvite()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00934">SCOPE_EXIT_LOG_RTN</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;{</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;   pjsip_inv_session *inv = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;   pj_time_val tv;</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *pending_media_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *active_media_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *session_name = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session);</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;   <span class="keywordtype">int</span> use_pending = 0;</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;   <span class="keywordtype">int</span> use_active = 0;</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, session_name);</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="comment">    * If the two media state topologies are the same this means that the session refresh request</span></div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<span class="comment">    * did not specify a desired topology, so it does not care. If that is the case we don&#39;t even</span></div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;<span class="comment">    * pass one in here resulting in the current topology being used.  It&#39;s possible though that</span></div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="comment">    * either one of the topologies could be NULL so we have to test for that before we check for</span></div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="comment">    * equality.</span></div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;   <span class="comment">/* We only want to clone a media state if its topology is not null */</span></div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;   use_pending = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;   use_active = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;<span class="comment">    * If both media states have topologies, we can test for equality.  If they&#39;re equal we&#39;re not going to</span></div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;<span class="comment">    * clone either states.</span></div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;   <span class="keywordflow">if</span> (use_pending &amp;&amp; use_active &amp;&amp; <a class="code" href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>)) {</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      use_pending = 0;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;      use_active = 0;</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;   }</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;   <span class="keywordflow">if</span> (use_pending) {</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      pending_media_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;      <span class="keywordflow">if</span> (!pending_media_state) {</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Failed to clone pending media state\n&quot;</span>, session_name);</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;      }</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;   }</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;   <span class="keywordflow">if</span> (use_active) {</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;      active_media_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>);</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;      <span class="keywordflow">if</span> (!active_media_state) {</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Failed to clone active media state\n&quot;</span>, session_name);</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      }</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;   }</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a>(session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, on_response, 1, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>, pending_media_state,</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;      active_media_state, 1)) {</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Failed to add delayed request\n&quot;</span>, session_name);</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;   }</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;</div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;   <span class="keywordflow">if</span> (pj_timer_entry_running(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a33674a0633d7ab63def106a0c57f2980">rescheduled_reinvite</a>)) {</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;      <span class="comment">/* Timer already running.  Something weird is going on. */</span></div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: re-INVITE collision while timer running!!!\n&quot;</span>, session_name);</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;   }</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;   tv.sec = 0;</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;   <span class="keywordflow">if</span> (inv-&gt;role == PJSIP_ROLE_UAC) {</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;      tv.msec = 2100 + <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>() % 2000;</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;      tv.msec = <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>() % 2000;</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;   }</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;   pj_timer_entry_init(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a33674a0633d7ab63def106a0c57f2980">rescheduled_reinvite</a>, 0, session, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aeff50a4e69bc83a7722fc43132e70b6a">resend_reinvite</a>);</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, +1);</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;   <span class="keywordflow">if</span> (pjsip_endpt_schedule_timer(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(),</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;      &amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a33674a0633d7ab63def106a0c57f2980">rescheduled_reinvite</a>, &amp;tv) != PJ_SUCCESS) {</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t schedule timer\n&quot;</span>, session_name);</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;   }</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>();</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;}</div><div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a3a7a6a1e5210478116a640b215ef53b4"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a></div><div class="ttdeci">static int delay_request(struct ast_sip_session *session, ast_sip_session_request_creation_cb on_request, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, int generate_new_sdp, enum delayed_method method, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state, int queue_head)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">res_pjsip_session.c:1591</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aeff50a4e69bc83a7722fc43132e70b6a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aeff50a4e69bc83a7722fc43132e70b6a">resend_reinvite</a></div><div class="ttdeci">static void resend_reinvite(pj_timer_heap_t *timer, pj_timer_entry *entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04248">res_pjsip_session.c:4248</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session_html_a33674a0633d7ab63def106a0c57f2980"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a33674a0633d7ab63def106a0c57f2980">ast_sip_session::rescheduled_reinvite</a></div><div class="ttdeci">pj_timer_entry rescheduled_reinvite</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00201">res_pjsip_session.h:201</a></div></div>
<div class="ttc" id="utils_8h_html_a7b4f10b070e95ba413e258a3e4b03c20"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a></div><div class="ttdeci">long int ast_random(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02064">main/utils.c:2064</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">res_pjsip_session.c:1296</a></div></div>
<div class="ttc" id="logger_8h_html_abfcb52b17737ff39386df5494f74bd0d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abfcb52b17737ff39386df5494f74bd0d">SCOPE_EXIT_LOG_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN(__log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00934">logger.h:934</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="stream_8h_html_ae0d846e650b6d3e654c01d61a991c82c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a></div><div class="ttdeci">int ast_stream_topology_equal(const struct ast_stream_topology *left, const struct ast_stream_topology *right)</div><div class="ttdoc">Compare two stream topologies to see if they are equal. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00696">stream.c:696</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a76c9ec6c960e59090e7c6301c1bce890"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a></div><div class="ttdeci">struct ast_sip_session_media_state * ast_sip_session_media_state_clone(const struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Clone a media state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">res_pjsip_session.c:297</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeff50a4e69bc83a7722fc43132e70b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeff50a4e69bc83a7722fc43132e70b6a">&#9670;&nbsp;</a></span>resend_reinvite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void resend_reinvite </td>
          <td>(</td>
          <td class="paramtype">pj_timer_heap_t *&#160;</td>
          <td class="paramname"><em>timer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_timer_entry *&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04248">4248</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00449">AST_LIST_EMPTY</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01538">invite_collision_timeout()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>.</p>
<div class="fragment"><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;{</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../d3/d96/structentry.html">entry</a>-&gt;user_data;</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: re-INVITE collision timer expired.\n&quot;</span>,</div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>)) {</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;      <span class="comment">/* No delayed request pending, so just return */</span></div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;   }</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a0a9fd4f3956c10f6728e85fb62c57703">invite_collision_timeout</a>, session)) {</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;<span class="comment">       * Uh oh.  We now have nothing in the foreseeable future</span></div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;<span class="comment">       * to trigger sending the delayed requests.</span></div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;   }</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;}</div><div class="ttc" id="linkedlists_8h_html_a4a1884cde93e53bef32ca85c194a1d05"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a></div><div class="ttdeci">#define AST_LIST_EMPTY(head)</div><div class="ttdoc">Checks whether the specified list contains any entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00449">linkedlists.h:449</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a0a9fd4f3956c10f6728e85fb62c57703"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a0a9fd4f3956c10f6728e85fb62c57703">invite_collision_timeout</a></div><div class="ttdeci">static int invite_collision_timeout(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01538">res_pjsip_session.c:1538</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4bf8de5db02001daabfc303b49c6d3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4bf8de5db02001daabfc303b49c6d3a">&#9670;&nbsp;</a></span>resolve_refresh_media_states()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a>* resolve_refresh_media_states </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>session_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>delayed_pending_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>delayed_active_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>current_active_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>run_post_validation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">1835</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00036">AST_MEDIA_TYPE_END</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">ast_sip_session_media_state_clone()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00257">ast_stream_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00309">ast_stream_get_name()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00388">ast_stream_state2str()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00098">AST_STREAM_STATE_END</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00337">ast_stream_to_str()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00748">ast_stream_topology_append_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00796">ast_stream_topology_set_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00936">ast_stream_topology_to_str()</a>, <a class="el" href="../../d2/d48/strings_8c_source.html#l00239">ast_strings_equal()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01739">GET_STREAM_NAME_SAFE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01737">GET_STREAM_SAFE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01738">GET_STREAM_STATE_SAFE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01751">is_media_state_valid()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00228">MAX</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00834">SCOPE_EXIT_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00940">SCOPE_EXIT_LOG_RTN_VALUE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01736">STATE_NONE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01735">STATE_REMOVED</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01734">STREAM_REMOVED</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">ast_sip_session_media::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>
<div class="fragment"><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;{</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *, new_pending_state, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *returned_media_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *delayed_pending = delayed_pending_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *delayed_active = delayed_active_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *current_active = current_active_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a> *new_pending = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;   <span class="keywordtype">int</span> max_stream_count;</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(2, <span class="stringliteral">&quot;%s: DP: %s  DA: %s  CA: %s\n&quot;</span>, session_name,</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(delayed_pending, &amp;STR_TMP)),</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(delayed_active, &amp;STR_TMP)),</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(current_active, &amp;STR_TMP))</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;   );</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;   max_stream_count = <a class="code" href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(<a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(delayed_pending),</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(delayed_active));</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;   max_stream_count = <a class="code" href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>(max_stream_count, <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(current_active));</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">    * The new_pending_state is always based on the currently negotiated state because</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">    * the stream ordering in its topology must be preserved.</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;   new_pending_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(current_active_state);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   <span class="keywordflow">if</span> (!new_pending_state) {</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t clone current_active_state to new_pending_state\n&quot;</span>, session_name);</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;   }</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;   new_pending = new_pending_state-&gt;topology;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; max_stream_count; i++) {</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *dp_stream = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a89bb30093935e2968abc2ebcfd59d1e8">GET_STREAM_SAFE</a>(delayed_pending, i);</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *da_stream = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a89bb30093935e2968abc2ebcfd59d1e8">GET_STREAM_SAFE</a>(delayed_active, i);</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *ca_stream = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a89bb30093935e2968abc2ebcfd59d1e8">GET_STREAM_SAFE</a>(current_active, i);</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *np_stream = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a89bb30093935e2968abc2ebcfd59d1e8">GET_STREAM_SAFE</a>(new_pending, i);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *found_da_stream = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *found_np_stream = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> dp_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#afc8c0da7afa44b6f31850aad7bfaaa8e">GET_STREAM_STATE_SAFE</a>(dp_stream);</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> da_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#afc8c0da7afa44b6f31850aad7bfaaa8e">GET_STREAM_STATE_SAFE</a>(da_stream);</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> ca_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#afc8c0da7afa44b6f31850aad7bfaaa8e">GET_STREAM_STATE_SAFE</a>(ca_stream);</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> np_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#afc8c0da7afa44b6f31850aad7bfaaa8e">GET_STREAM_STATE_SAFE</a>(np_stream);</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> found_da_state = <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47">AST_STREAM_STATE_END</a>;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a> found_np_state = <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47">AST_STREAM_STATE_END</a>;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *da_name = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(da_stream);</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *dp_name = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(dp_stream);</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *ca_name = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(ca_stream);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *np_name = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(np_stream);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *found_da_name __attribute__((unused)) = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *found_np_name __attribute__((unused)) = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;      <span class="keywordtype">int</span> found_da_slot __attribute__((unused)) = -1;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <span class="keywordtype">int</span> found_np_slot = -1;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      <span class="keywordtype">int</span> removed_np_slot = -1;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="keywordtype">int</span> j;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: slot: %d DP: %s  DA: %s  CA: %s\n&quot;</span>, session_name, i,</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(dp_stream, &amp;STR_TMP)),</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(da_stream, &amp;STR_TMP)),</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(128, <a class="code" href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a>(ca_stream, &amp;STR_TMP)));</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a>(da_state) &amp;&amp; <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a>(dp_state) &amp;&amp; <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a>(ca_state)) {</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">break</span>, <span class="stringliteral">&quot;%s: All gone\n&quot;</span>, session_name);</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      }</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment">       * Simple cases are handled first to avoid having to search the NP and DA</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment">       * topologies for streams with the same name but not in the same position.</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a>(dp_state) &amp;&amp; !<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a>(da_state)) {</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;          <span class="comment">/*</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">           * The slot in the delayed pending topology can&#39;t be empty if the delayed</span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment">           * active topology has a stream there.  Streams can&#39;t just go away.  They</span></div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment">           * can be reused or marked &quot;removed&quot; but they can&#39;t go away.</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;          <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: DP slot is empty but DA is not\n&quot;</span>, session_name);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      }</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a>(dp_state)) {</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;          <span class="comment">/*</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">           * The current active topology can certainly have streams that weren&#39;t</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">           * in existence when the delayed request was queued.  In this case,</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">           * no action is needed since we already copied the current active topology</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">           * to the new pending one.</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;          <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: No DP stream so use CA stream as is\n&quot;</span>, session_name);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      }</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(dp_name, da_name) &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(da_name, ca_name)) {</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment">          * The delayed pending stream in this slot matches by name, the streams</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment">          * in the same slot in the other two topologies.  Easy case.</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Same stream in all 3 states\n&quot;</span>, session_name);</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;         <span class="keywordflow">if</span> (dp_state == da_state &amp;&amp; da_state == ca_state) {</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            <span class="comment">/* All the same state, no need to update. */</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: All in the same state so nothing to do\n&quot;</span>, session_name);</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;         }</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;         <span class="keywordflow">if</span> (da_state != ca_state) {</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">             * Something set the CA state between the time this request was queued</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">             * and now.  The CA state wins so we don&#39;t do anything.</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Ignoring request to change state from %s to %s\n&quot;</span>,</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;               session_name, <a class="code" href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a>(ca_state), <a class="code" href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a>(dp_state));</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;         }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;         <span class="keywordflow">if</span> (dp_state != da_state) {</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            <span class="comment">/* DP needs to update the state */</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(np_stream, dp_state);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Changed NP stream state from %s to %s\n&quot;</span>,</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;               session_name, <a class="code" href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a>(ca_state), <a class="code" href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a>(dp_state));</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;         }</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      }</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">       * We&#39;re done with the simple cases.  For the rest, we need to identify if the</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment">       * DP stream we&#39;re trying to take action on is already in the other topologies</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">       * possibly in a different slot.  To do that, if the stream in the DA or CA slots</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">       * doesn&#39;t match the current DP stream, we need to iterate over the topology</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">       * looking for a stream with the same name.</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment">       * Since we already copied all of the CA streams to the NP topology, we&#39;ll use it</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="comment">       * instead of CA because we&#39;ll be updating the NP as we go.</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(dp_name, np_name)) {</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">          * The NP stream in this slot doesn&#39;t have the same name as the DP stream</span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">          * so we need to see if it&#39;s in another NP slot.  We&#39;re not going to stop</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">          * when we find a matching stream because we also want to find the first</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">          * removed removed slot, if any, so we can re-use this slot.  We&#39;ll break</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">          * early if we find both before we reach the end.</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Checking if DP is already in NP somewhere\n&quot;</span>, session_name);</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(new_pending); j++) {</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *possible_existing = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(new_pending, j);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *possible_existing_name = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(possible_existing);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Checking %s against %s\n&quot;</span>, session_name, dp_name, possible_existing_name);</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <span class="keywordflow">if</span> (found_np_slot == -1 &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(dp_name, possible_existing_name)) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Pending stream %s slot %d is in NP slot %d\n&quot;</span>, session_name,</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;               dp_name, i, j);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;               found_np_slot = j;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;               found_np_stream = possible_existing;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;               found_np_state = <a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(possible_existing);</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;               found_np_name = <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(possible_existing);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            }</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a54d2a76e6f2247e72619e26b239837d4">STREAM_REMOVED</a>(possible_existing) &amp;&amp; removed_np_slot == -1) {</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;               removed_np_slot = j;</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            }</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <span class="keywordflow">if</span> (removed_np_slot &gt;= 0 &amp;&amp; found_np_slot &gt;= 0) {</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            }</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;         }</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;         <span class="comment">/* Makes the subsequent code easier */</span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;         found_np_slot = i;</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;         found_np_stream = np_stream;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;         found_np_state = np_state;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;         found_np_name = np_name;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      }</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(dp_name, da_name)) {</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">          * The DA stream in this slot doesn&#39;t have the same name as the DP stream</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">          * so we need to see if it&#39;s in another DA slot.  In real life, the DA stream</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment">          * in this slot could have a different name but there shouldn&#39;t be a case</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment">          * where the DP stream is another slot in the DA topology.  Just in case though.</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">          * We don&#39;t care about removed slots in the DA topology.</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Checking if DP is already in DA somewhere\n&quot;</span>, session_name);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(delayed_active); j++) {</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *possible_existing = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(delayed_active, j);</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *possible_existing_name = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a>(possible_existing);</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Checking %s against %s\n&quot;</span>, session_name, dp_name, possible_existing_name);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a>(dp_name, possible_existing_name)) {</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Pending stream %s slot %d is already in delayed active slot %d\n&quot;</span>,</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                  session_name, dp_name, i, j);</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;               found_da_slot = j;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;               found_da_stream = possible_existing;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;               found_da_state = <a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(possible_existing);</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;               found_da_name = <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(possible_existing);</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            }</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;         }</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;         <span class="comment">/* Makes the subsequent code easier */</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;         found_da_slot = i;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;         found_da_stream = da_stream;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;         found_da_state = da_state;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;         found_da_name = da_name;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      }</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Found NP slot: %d  Found removed NP slot: %d Found DA slot: %d\n&quot;</span>,</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;         session_name, found_np_slot, removed_np_slot, found_da_slot);</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">       * Now we know whether the DP stream is new or changing state and we know if the DP</span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">       * stream exists in the other topologies and if so, where in those topologies it exists.</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="keywordflow">if</span> (!found_da_stream) {</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">          * The DP stream isn&#39;t in the DA topology which would imply that the intention of the</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">          * request was to add the stream, not change its state.  It&#39;s possible though that</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">          * the stream was added by another request between the time this request was queued</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">          * and now so we need to check the CA topology as well.</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: There was no corresponding DA stream so the request was to add a stream\n&quot;</span>, session_name);</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;         <span class="keywordflow">if</span> (found_np_stream) {</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">             * We found it in the CA topology.  Since the intention was to add it</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">             * and it&#39;s already there, there&#39;s nothing to do.</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: New stream requested but it&#39;s already in CA\n&quot;</span>, session_name);</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;            <span class="comment">/* OK, it&#39;s not in either which would again imply that the intention of the</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">             * request was to add the stream.</span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: There was no corresponding NP stream\n&quot;</span>, session_name);</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a65ee9e13e68c4fc2191e0a67cee60b4e">STATE_REMOVED</a>(dp_state)) {</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;               <span class="comment">/*</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">                * How can DP request to remove a stream that doesn&#39;t seem to exist anythere?</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">                * It&#39;s not.  It&#39;s possible that the stream was already removed and the slot</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">                * reused in the CA topology, but it would still have to exist in the DA</span></div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">                * topology.  Bail.</span></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>,</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                  <span class="stringliteral">&quot;%s: Attempting to remove stream %d:%s but it doesn&#39;t exist anywhere.\n&quot;</span>, session_name, i, dp_name);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;               <span class="comment">/*</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">                * We&#39;re now sure we want to add the the stream.  Since we can re-use</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">                * slots in the CA topology that have streams marked as &quot;removed&quot;, we</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">                * use the slot we saved in removed_np_slot if it exists.</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Checking for open slot\n&quot;</span>, session_name);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;               <span class="keywordflow">if</span> (removed_np_slot &gt;= 0) {</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                  <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *old_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;new_pending_state-&gt;sessions, removed_np_slot);</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                  res = <a class="code" href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a>(new_pending, removed_np_slot, <a class="code" href="../../d8/d95/stream_8h.html#a9dcdd3db33377db2e845ada4c281d1d6">ast_stream_clone</a>(dp_stream, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                  <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t set stream in new topology\n&quot;</span>, session_name);</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                  }</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                  <span class="comment">/*</span></div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment">                   * Since we&#39;re reusing the removed_np_slot slot for something else, we need</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">                   * to free and remove any session media already in it.</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">                   * ast_stream_topology_set_stream() took care of freeing the old stream.</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                  res = <a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;new_pending_state-&gt;sessions, removed_np_slot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                  <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t replace media session\n&quot;</span>, session_name);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                  }</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                  <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(old_media);</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Replaced removed stream in slot %d\n&quot;</span>,</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                     session_name, removed_np_slot);</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                  <span class="keywordtype">int</span> new_slot = <a class="code" href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a>(new_pending, <a class="code" href="../../d8/d95/stream_8h.html#a9dcdd3db33377db2e845ada4c281d1d6">ast_stream_clone</a>(dp_stream, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                  <span class="keywordflow">if</span> (new_slot &lt; 0) {</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t append stream in new topology\n&quot;</span>, session_name);</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                  }</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                  res = <a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;new_pending_state-&gt;sessions, new_slot, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                  <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Couldn&#39;t replace media session\n&quot;</span>, session_name);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                  }</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Appended new stream to slot %d\n&quot;</span>,</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                     session_name, new_slot);</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;               }</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            }</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;         }</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">          * The DP stream exists in the DA topology so it&#39;s a change of some sort.</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: There was a corresponding DA stream so the request was to change/remove a stream\n&quot;</span>, session_name);</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;         <span class="keywordflow">if</span> (dp_state == found_da_state) {</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            <span class="comment">/* No change? Let&#39;s see if it&#39;s in CA */</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            <span class="keywordflow">if</span> (!found_np_stream) {</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;               <span class="comment">/*</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">                * The DP and DA state are the same which would imply that the stream</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">                * already exists but it&#39;s not in the CA topology.  It&#39;s possible that</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">                * between the time this request was queued and now the stream was removed</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">                * from the CA topology and the slot used for something else.  Nothing</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="comment">                * we can do here.</span></div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Stream doesn&#39;t exist in CA so nothing to do\n&quot;</span>, session_name);</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dp_state == found_np_state) {</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: States are the same all around so nothing to do\n&quot;</span>, session_name);</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Something changed the CA state so we&#39;re going to leave it as is\n&quot;</span>, session_name);</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;            }</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            <span class="comment">/* We have a state change. */</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Requesting state change to %s\n&quot;</span>, session_name, <a class="code" href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a>(dp_state));</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            <span class="keywordflow">if</span> (!found_np_stream) {</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Stream doesn&#39;t exist in CA so nothing to do\n&quot;</span>, session_name);</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (da_state == found_np_state) {</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(found_np_stream, dp_state);</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Changed NP stream state from %s to %s\n&quot;</span>,</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                  session_name, <a class="code" href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a>(found_np_state), <a class="code" href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a>(dp_state));</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Something changed the CA state so we&#39;re going to leave it as is\n&quot;</span>,</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                  session_name);</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            }</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;         }</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      }</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s: Done with slot %d\n&quot;</span>, session_name, i);</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;   }</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Resetting default media states\n&quot;</span>, session_name);</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a>; i++) {</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      <span class="keywordtype">int</span> j;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      new_pending_state-&gt;default_session[i] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;new_pending_state-&gt;sessions); j++) {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;new_pending_state-&gt;sessions, j);</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(new_pending_state-&gt;topology, j);</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;         <span class="keywordflow">if</span> (media &amp;&amp; media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> == i &amp;&amp; !<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a54d2a76e6f2247e72619e26b239837d4">STREAM_REMOVED</a>(stream)) {</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            new_pending_state-&gt;default_session[i] = media;</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;         }</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      }</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;   }</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;   <span class="keywordflow">if</span> (run_post_validation) {</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Running post-validation\n&quot;</span>, session_name);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a92df7a5cec6415bf61773b6a2fdc2043">is_media_state_valid</a>(session_name, new_pending_state)) {</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;State not consistent\n&quot;</span>);</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      }</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;   }</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">    * We need to move the new pending state to another variable and set new_pending_state to NULL</span></div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">    * so RAII_VAR doesn&#39;t free it.</span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   returned_media_state = new_pending_state;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;   new_pending_state = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(returned_media_state, <span class="stringliteral">&quot;%s: NP: %s\n&quot;</span>, session_name,</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(new_pending, &amp;STR_TMP)));</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;}</div><div class="ttc" id="logger_8h_html_a5eff4ad268db72883e5e152070c3583f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN_VALUE(__value, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00940">logger.h:940</a></div></div>
<div class="ttc" id="stream_8h_html_af793e90c3796564a01574fd9c5e9e208"><div class="ttname"><a href="../../d8/d95/stream_8h.html#af793e90c3796564a01574fd9c5e9e208">ast_stream_to_str</a></div><div class="ttdeci">const char * ast_stream_to_str(const struct ast_stream *stream, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the stream for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00337">stream.c:337</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a92df7a5cec6415bf61773b6a2fdc2043"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a92df7a5cec6415bf61773b6a2fdc2043">is_media_state_valid</a></div><div class="ttdeci">static int is_media_state_valid(const char *session_name, struct ast_sip_session_media_state *state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01751">res_pjsip_session.c:1751</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a54d2a76e6f2247e72619e26b239837d4"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a54d2a76e6f2247e72619e26b239837d4">STREAM_REMOVED</a></div><div class="ttdeci">#define STREAM_REMOVED(_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01734">res_pjsip_session.c:1734</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a747da02675876a0e85ab971de1849bde"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a747da02675876a0e85ab971de1849bde">STATE_NONE</a></div><div class="ttdeci">#define STATE_NONE(_stream_state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01736">res_pjsip_session.c:1736</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a></div><div class="ttdeci">ast_stream_state</div><div class="ttdoc">States that a stream may be in. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00074">stream.h:74</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stream_8h_html_a452835913f7150a5045dd75ee822b491"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a></div><div class="ttdeci">int ast_stream_topology_append_stream(struct ast_stream_topology *topology, struct ast_stream *stream)</div><div class="ttdoc">Append a stream to the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00748">stream.c:748</a></div></div>
<div class="ttc" id="stream_8h_html_a1bec3fe997f1085a3095cd46e8208b20"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a></div><div class="ttdeci">int ast_stream_topology_set_stream(struct ast_stream_topology *topology, unsigned int position, struct ast_stream *stream)</div><div class="ttdoc">Set a specific position in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00796">stream.c:796</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="utils_8h_html_afa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="../../d5/d60/utils_8h.html#afa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00228">utils.h:228</a></div></div>
<div class="ttc" id="stream_8h_html_a3da8d8e63718c47d43b9e738c7f6e55a"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a></div><div class="ttdeci">const char * ast_stream_topology_to_str(const struct ast_stream_topology *topology, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the topology for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00936">stream.c:936</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="logger_8h_html_a91ab9408bcc739e24e6eab78d752585c"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_EXPR(__expr,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00834">logger.h:834</a></div></div>
<div class="ttc" id="structast__stream__topology_html"><div class="ttname"><a href="../../da/d35/structast__stream__topology.html">ast_stream_topology</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00123">stream.c:123</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288aa02cd262fe09a7a8c5c3806033e03f47">AST_STREAM_STATE_END</a></div><div class="ttdoc">Sentinel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00098">stream.h:98</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="strings_8h_html_a13824dd1c76e6cbb12dd7f7783fca8fd"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a13824dd1c76e6cbb12dd7f7783fca8fd">ast_strings_equal</a></div><div class="ttdeci">int ast_strings_equal(const char *str1, const char *str2)</div><div class="ttdoc">Compare strings for equality checking for NULL. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d48/strings_8c_source.html#l00239">strings.c:239</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a89bb30093935e2968abc2ebcfd59d1e8"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a89bb30093935e2968abc2ebcfd59d1e8">GET_STREAM_SAFE</a></div><div class="ttdeci">#define GET_STREAM_SAFE(_topology, _i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01737">res_pjsip_session.c:1737</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a65ee9e13e68c4fc2191e0a67cee60b4e"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a65ee9e13e68c4fc2191e0a67cee60b4e">STATE_REMOVED</a></div><div class="ttdeci">#define STATE_REMOVED(_stream_state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01735">res_pjsip_session.c:1735</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a76c9ec6c960e59090e7c6301c1bce890"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a></div><div class="ttdeci">struct ast_sip_session_media_state * ast_sip_session_media_state_clone(const struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Clone a media state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">res_pjsip_session.c:297</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_afc8c0da7afa44b6f31850aad7bfaaa8e"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#afc8c0da7afa44b6f31850aad7bfaaa8e">GET_STREAM_STATE_SAFE</a></div><div class="ttdeci">#define GET_STREAM_STATE_SAFE(_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01738">res_pjsip_session.c:1738</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a57b08a6ad7a004d70eba4a1b6867a084"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">ast_sip_session_media::type</a></div><div class="ttdeci">enum ast_media_type type</div><div class="ttdoc">Media type of this session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">res_pjsip_session.h:105</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stream_8h_html_a9dcdd3db33377db2e845ada4c281d1d6"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a9dcdd3db33377db2e845ada4c281d1d6">ast_stream_clone</a></div><div class="ttdeci">struct ast_stream * ast_stream_clone(const struct ast_stream *stream, const char *name)</div><div class="ttdoc">Create a deep clone of an existing stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00257">stream.c:257</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a2cb39c08deca8673d9d2e744dc87fd6d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a2cb39c08deca8673d9d2e744dc87fd6d">GET_STREAM_NAME_SAFE</a></div><div class="ttdeci">#define GET_STREAM_NAME_SAFE(_stream)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01739">res_pjsip_session.c:1739</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="stream_8h_html_ae96305003700b238d098ad2296a24416"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ae96305003700b238d098ad2296a24416">ast_stream_state2str</a></div><div class="ttdeci">const char * ast_stream_state2str(enum ast_stream_state state)</div><div class="ttdoc">Convert the state of a stream into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00388">stream.c:388</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00036">codec.h:36</a></div></div>
<div class="ttc" id="stream_8h_html_afcb45a1d2880128928cfb6d91b19ab46"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a></div><div class="ttdeci">const char * ast_stream_get_name(const struct ast_stream *stream)</div><div class="ttdoc">Get the name of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00309">stream.c:309</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a402de077579a28f56ed42213f8b76c27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a402de077579a28f56ed42213f8b76c27">&#9670;&nbsp;</a></span>sdp_handler_list_cmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sdp_handler_list_cmp </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00129">129</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01031">CMP_MATCH</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01032">CMP_STOP</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00102">sdp_handler_list::stream_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06074">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *handler_list1 = obj;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *handler_list2 = arg;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *stream_type2 = flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> ? arg : handler_list2-&gt;<a class="code" href="../../d9/d38/structsdp__handler__list.html#ae7eed312e6b4fe39e81b6c802553a5bc">stream_type</a>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordflow">return</span> strcmp(handler_list1-&gt;<a class="code" href="../../d9/d38/structsdp__handler__list.html#ae7eed312e6b4fe39e81b6c802553a5bc">stream_type</a>, stream_type2) ? 0 : <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="structsdp__handler__list_html_ae7eed312e6b4fe39e81b6c802553a5bc"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html#ae7eed312e6b4fe39e81b6c802553a5bc">sdp_handler_list::stream_type</a></div><div class="ttdeci">char stream_type[1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00102">res_pjsip_session.c:102</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c73481a00684ae28b5c0eae9e1c07ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c73481a00684ae28b5c0eae9e1c07ca">&#9670;&nbsp;</a></span>sdp_handler_list_hash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sdp_handler_list_hash </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00107">107</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d6/d90/strings_8h_source.html#l01206">ast_str_hash()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00102">sdp_handler_list::stream_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06074">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *handler_list = obj;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d38/structsdp__handler__list.html#ae7eed312e6b4fe39e81b6c802553a5bc">stream_type</a> = flags &amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a> ? obj : handler_list-&gt;<a class="code" href="../../d9/d38/structsdp__handler__list.html#ae7eed312e6b4fe39e81b6c802553a5bc">stream_type</a>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a>(stream_type);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structsdp__handler__list_html_ae7eed312e6b4fe39e81b6c802553a5bc"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html#ae7eed312e6b4fe39e81b6c802553a5bc">sdp_handler_list::stream_type</a></div><div class="ttdeci">char stream_type[1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00102">res_pjsip_session.c:102</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="strings_8h_html_a33ab7fa091d5513d8507d3bd33ef5b55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_hash(const char *str)</div><div class="ttdoc">Compute a hash value on a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01206">strings.h:1206</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4229c2f5de34a490931841d187ad0625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4229c2f5de34a490931841d187ad0625">&#9670;&nbsp;</a></span>sdp_requires_deferral()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sdp_requires_deferral </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>sdp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine whether the SDP provided requires deferral of negotiating or not. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>re-invite should be deferred and resumed later </td></tr>
    <tr><td class="paramname">0</td><td>re-invite should not be deferred </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">2600</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00347">ast_codec_media_type2str()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d5/def/codec_8c_source.html#l00363">ast_media_type_from_str()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">ast_sip_session_is_pending_stream_default()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">ast_sip_session_media_state_add()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00367">AST_SIP_SESSION_SDP_DEFER_ERROR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00371">AST_SIP_SESSION_SDP_DEFER_NEEDED</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00365">AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00369">AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00233">ast_stream_alloc()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00292">ast_stream_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00423">ast_stream_get_metadata()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00309">ast_stream_get_name()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00460">ast_stream_set_metadata()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00094">AST_STREAM_STATE_INACTIVE</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00090">AST_STREAM_STATE_RECVONLY</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00086">AST_STREAM_STATE_SENDONLY</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00082">AST_STREAM_STATE_SENDRECV</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00650">ast_stream_topology_alloc()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00796">ast_stream_topology_set_stream()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00398">ast_sip_session_sdp_handler::defer_incoming_sdp_stream</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">ast_sip_session_media::handler</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">session_media_set_handler()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02733">session_reinvite_on_rx_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;{</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> = <a class="code" href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a>();</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;      }</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;   }</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; sdp-&gt;media_count; ++i) {</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      <span class="comment">/* See if there are registered handlers for this media stream type */</span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      <span class="keywordtype">char</span> media[20];</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *, handler_list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *existing_stream = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a> <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      <span class="keyword">enum</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933">ast_sip_session_sdp_stream_defer</a> res;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      pjmedia_sdp_media *remote_stream = sdp-&gt;media[i];</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <span class="comment">/* We need a null-terminated version of the media string */</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(media, &amp;sdp-&gt;media[i]-&gt;desc.media, <span class="keyword">sizeof</span>(media));</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> &amp;&amp;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;         (i &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>))) {</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;         existing_stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i);</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      }</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      type = <a class="code" href="../../d1/d16/codec_8h.html#a153dc7458d6455da24d7d24d8e8a7924">ast_media_type_from_str</a>(media);</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      stream = <a class="code" href="../../d8/d95/stream_8h.html#afd6abeccf161767b676a3cb54715df2c">ast_stream_alloc</a>(existing_stream ? <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(existing_stream) : <a class="code" href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a>(type), type);</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      <span class="keywordflow">if</span> (!stream) {</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      }</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <span class="comment">/* As this is only called on an incoming SDP offer before processing it is not possible</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment">       * for streams and their media sessions to exist.</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, i, stream)) {</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a>(stream);</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      }</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <span class="keywordflow">if</span> (existing_stream) {</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">char</span> *stream_label = <a class="code" href="../../d8/d95/stream_8h.html#a311bed754f00753d0fd141266ee0d282">ast_stream_get_metadata</a>(existing_stream, <span class="stringliteral">&quot;SDP:LABEL&quot;</span>);</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(stream_label)) {</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a3190a21208ef7b4137f3355cb13a61f0">ast_stream_set_metadata</a>(stream, <span class="stringliteral">&quot;SDP:LABEL&quot;</span>, stream_label);</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;         }</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      }</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;      session_media = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a>(session, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>, <a class="code" href="../../d1/d16/codec_8h.html#a153dc7458d6455da24d7d24d8e8a7924">ast_media_type_from_str</a>(media), i);</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      }</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      <span class="comment">/* For backwards compatibility with the core the default audio stream is always sendrecv */</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a>(session, stream) || strcmp(media, <span class="stringliteral">&quot;audio&quot;</span>)) {</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;         <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(remote_stream, <span class="stringliteral">&quot;sendonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;            <span class="comment">/* Stream state reflects our state of a stream, so in the case of</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">             * sendonly and recvonly we store the opposite since that is what ours</span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">             * is.</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24">AST_STREAM_STATE_RECVONLY</a>);</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(remote_stream, <span class="stringliteral">&quot;recvonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a>);</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjmedia_sdp_media_find_attr2(remote_stream, <span class="stringliteral">&quot;inactive&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93">AST_STREAM_STATE_INACTIVE</a>);</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;            <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>);</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;         }</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;         <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a>);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      }</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;      <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;         handler = session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;         <span class="keywordflow">if</span> (handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a714bfc56504aea40fe33d1c94436a366">defer_incoming_sdp_stream</a>) {</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a714bfc56504aea40fe33d1c94436a366">defer_incoming_sdp_stream</a>(session, session_media, sdp,</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;               sdp-&gt;media[i]);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;            <span class="keywordflow">switch</span> (res) {</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846">AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED</a>:</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529">AST_SIP_SESSION_SDP_DEFER_ERROR</a>:</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;               <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a">AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED</a>:</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a">AST_SIP_SESSION_SDP_DEFER_NEEDED</a>:</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;               <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            }</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;         }</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;         <span class="comment">/* Handled by this handler. Move to the next stream */</span></div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      }</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      handler_list = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, media, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="keywordflow">if</span> (!handler_list) {</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: No registered SDP handlers for media type &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), media);</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      }</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;list, handler, next) {</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;         <span class="keywordflow">if</span> (handler == session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;         }</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;         <span class="keywordflow">if</span> (!handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a714bfc56504aea40fe33d1c94436a366">defer_incoming_sdp_stream</a>) {</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;         }</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;         res = handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a714bfc56504aea40fe33d1c94436a366">defer_incoming_sdp_stream</a>(session, session_media, sdp,</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;            sdp-&gt;media[i]);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;         <span class="keywordflow">switch</span> (res) {</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846">AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED</a>:</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529">AST_SIP_SESSION_SDP_DEFER_ERROR</a>:</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a>(session_media, handler);</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a">AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED</a>:</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            <span class="comment">/* Handled by this handler. */</span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a>(session_media, handler);</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a">AST_SIP_SESSION_SDP_DEFER_NEEDED</a>:</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;            <span class="comment">/* Handled by this handler. */</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a>(session_media, handler);</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;         }</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;         <span class="comment">/* Move to the next stream */</span></div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      }</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;   }</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="codec_8h_html_a97df2e6b65823085173625553d2e06c5"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a97df2e6b65823085173625553d2e06c5">ast_codec_media_type2str</a></div><div class="ttdeci">const char * ast_codec_media_type2str(enum ast_media_type type)</div><div class="ttdoc">Conversion function to take a media type and turn it into a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00347">codec.c:347</a></div></div>
<div class="ttc" id="codec_8h_html_a153dc7458d6455da24d7d24d8e8a7924"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a153dc7458d6455da24d7d24d8e8a7924">ast_media_type_from_str</a></div><div class="ttdeci">enum ast_media_type ast_media_type_from_str(const char *media_type_str)</div><div class="ttdoc">Conversion function to take a media string and convert it to a media type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00363">codec.c:363</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ab9ff868b434da3a67f28c50766cb3c93">AST_STREAM_STATE_INACTIVE</a></div><div class="ttdoc">Set when the stream is not sending OR receiving media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00094">stream.h:94</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a1407c2ea952ef0b4d6ae0cd0391f7e0a">AST_SIP_SESSION_SDP_DEFER_NEEDED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00371">res_pjsip_session.h:371</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stream_8h_html_a1bec3fe997f1085a3095cd46e8208b20"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a></div><div class="ttdeci">int ast_stream_topology_set_stream(struct ast_stream_topology *topology, unsigned int position, struct ast_stream *stream)</div><div class="ttdoc">Set a specific position in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00796">stream.c:796</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933aa48d4383ffde99ae584f67ead7afcb7a">AST_SIP_SESSION_SDP_DEFER_NOT_NEEDED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00369">res_pjsip_session.h:369</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a4d96ab8cbcc0f85012300573e3db2900"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a4d96ab8cbcc0f85012300573e3db2900">ast_sip_session_is_pending_stream_default</a></div><div class="ttdeci">int ast_sip_session_is_pending_stream_default(const struct ast_sip_session *session, const struct ast_stream *stream)</div><div class="ttdoc">Determines if a provided pending stream will be the default stream or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00359">res_pjsip_session.c:359</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a547f07821c13f67174cb535888d98c0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a547f07821c13f67174cb535888d98c0c">session_media_set_handler</a></div><div class="ttdeci">static void session_media_set_handler(struct ast_sip_session_media *session_media, struct ast_sip_session_sdp_handler *handler)</div><div class="ttdoc">Set an SDP stream handler for a corresponding session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">res_pjsip_session.c:445</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288ae82f7244a7d4557091b08952d6a9cb80">AST_STREAM_STATE_SENDRECV</a></div><div class="ttdoc">Set when the stream is sending and receiving media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00082">stream.h:82</a></div></div>
<div class="ttc" id="stream_8h_html_ad225f95d1de536ba61f43150cfe3bd06"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ad225f95d1de536ba61f43150cfe3bd06">ast_stream_topology_alloc</a></div><div class="ttdeci">struct ast_stream_topology * ast_stream_topology_alloc(void)</div><div class="ttdoc">Create a stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00650">stream.c:650</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae0018e2a2f5cae3abe84426c44fee908"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae0018e2a2f5cae3abe84426c44fee908">ast_sip_session_media_state_add</a></div><div class="ttdeci">struct ast_sip_session_media * ast_sip_session_media_state_add(struct ast_sip_session *session, struct ast_sip_session_media_state *media_state, enum ast_media_type type, int position)</div><div class="ttdoc">Allocate an ast_session_media and add it to the media state&amp;#39;s vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">res_pjsip_session.c:490</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933">ast_sip_session_sdp_stream_defer</a></div><div class="ttdeci">ast_sip_session_sdp_stream_defer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00363">res_pjsip_session.h:363</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288afaf3d3b8e7792a1332821dbbebf2d443">AST_STREAM_STATE_SENDONLY</a></div><div class="ttdoc">Set when the stream is sending media only. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00086">stream.h:86</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933ae99344dcabd202b75970c298137f9529">AST_SIP_SESSION_SDP_DEFER_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00367">res_pjsip_session.h:367</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="stream_8h_html_acd53513fe1965d4e5d4581d79ef8d24c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a></div><div class="ttdeci">void ast_stream_free(struct ast_stream *stream)</div><div class="ttdoc">Destroy a media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00292">stream.c:292</a></div></div>
<div class="ttc" id="stream_8h_html_afd6abeccf161767b676a3cb54715df2c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afd6abeccf161767b676a3cb54715df2c">ast_stream_alloc</a></div><div class="ttdeci">struct ast_stream * ast_stream_alloc(const char *name, enum ast_media_type type)</div><div class="ttdoc">Create a new media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00233">stream.c:233</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3b66ccd874aa8ba900ad09f9fb12717d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">ast_sip_session_media::handler</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * handler</div><div class="ttdoc">SDP handler that setup the RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">res_pjsip_session.h:83</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="stream_8h_html_a3190a21208ef7b4137f3355cb13a61f0"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3190a21208ef7b4137f3355cb13a61f0">ast_stream_set_metadata</a></div><div class="ttdeci">int ast_stream_set_metadata(struct ast_stream *stream, const char *m_key, const char *value)</div><div class="ttdoc">Set a stream metadata value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00460">stream.c:460</a></div></div>
<div class="ttc" id="stream_8h_html_a311bed754f00753d0fd141266ee0d282"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a311bed754f00753d0fd141266ee0d282">ast_stream_get_metadata</a></div><div class="ttdeci">const char * ast_stream_get_metadata(const struct ast_stream *stream, const char *m_key)</div><div class="ttdoc">Get a stream metadata value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00423">stream.c:423</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_a714bfc56504aea40fe33d1c94436a366"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#a714bfc56504aea40fe33d1c94436a366">ast_sip_session_sdp_handler::defer_incoming_sdp_stream</a></div><div class="ttdeci">enum ast_sip_session_sdp_stream_defer(* defer_incoming_sdp_stream)(struct ast_sip_session *session, struct ast_sip_session_media *session_media, const struct pjmedia_sdp_session *sdp, const struct pjmedia_sdp_media *stream)</div><div class="ttdoc">Determine whether a stream requires that the re-invite be deferred. If a stream can not be immediatel...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00398">res_pjsip_session.h:398</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a></div><div class="ttdeci">ast_media_type</div><div class="ttdoc">Types of media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00030">codec.h:30</a></div></div>
<div class="ttc" id="stream_8h_html_afcb45a1d2880128928cfb6d91b19ab46"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a></div><div class="ttdeci">const char * ast_stream_get_name(const struct ast_stream *stream)</div><div class="ttdoc">Get the name of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00309">stream.c:309</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#ad4598b72ea4cbd27ae1254725d291933a7bfbf71af002e98fd586246271629846">AST_SIP_SESSION_SDP_DEFER_NOT_HANDLED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00365">res_pjsip_session.h:365</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288a5c7755c7947aed47c123f459311deb24">AST_STREAM_STATE_RECVONLY</a></div><div class="ttdoc">Set when the stream is receiving media only. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00090">stream.h:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cf4b150696c1bfae6887edc478f6ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf4b150696c1bfae6887edc478f6ee1">&#9670;&nbsp;</a></span>send_delayed_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int send_delayed_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *&#160;</td>
          <td class="paramname"><em>delay</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">1394</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01350">ast_sip_session_delayed_request::active_media_state</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00486">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00488">AST_SIP_SESSION_REFRESH_METHOD_UPDATE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01310">delayed_method2str()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">DELAYED_METHOD_BYE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">DELAYED_METHOD_INVITE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">DELAYED_METHOD_UPDATE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01346">ast_sip_session_delayed_request::generate_new_sdp</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">ast_sip_session_delayed_request::method</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01340">ast_sip_session_delayed_request::on_request_creation</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01344">ast_sip_session_delayed_request::on_response</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01342">ast_sip_session_delayed_request::on_sdp_creation</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01348">ast_sip_session_delayed_request::pending_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00940">SCOPE_EXIT_LOG_RTN_VALUE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">sip_session_refresh()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">invite_proceeding()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>.</p>
<div class="fragment"><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;{</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: sending delayed %s request\n&quot;</span>,</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a>(delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>));</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;   <span class="keywordflow">switch</span> (delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>) {</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>:</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a>(session, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aea56c55f654c68cb1572e09264e90a57">on_request_creation</a>,</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;         delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">on_sdp_creation</a>, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">on_response</a>,</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a>, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">generate_new_sdp</a>, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>,</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;         delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>, 1);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="comment">/* Ownership of media state transitions to ast_sip_session_refresh */</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a>:</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a>(session, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aea56c55f654c68cb1572e09264e90a57">on_request_creation</a>,</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;         delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">on_sdp_creation</a>, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">on_response</a>,</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0da02ccc9b52f326c27f7fd3ee072f4f6f1">AST_SIP_SESSION_REFRESH_METHOD_UPDATE</a>, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">generate_new_sdp</a>, delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>,</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;         delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>, 1);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <span class="comment">/* Ownership of media state transitions to ast_sip_session_refresh */</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a>:</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a>(session, 0);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;%s: Terminating session on delayed BYE\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;   }</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Don&#39;t know how to send delayed %s(%d) request.\n&quot;</span>,</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a>(delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>), delay-&gt;<a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">method</a>);</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00486">res_pjsip.h:486</a></div></div>
<div class="ttc" id="logger_8h_html_a5eff4ad268db72883e5e152070c3583f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN_VALUE(__value, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00940">logger.h:940</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a9970af9a7baebf1694eab703be54e7cd">DELAYED_METHOD_BYE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01298">res_pjsip_session.c:1298</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a715bc377d91f54bbdfb6f92b729fe273"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a715bc377d91f54bbdfb6f92b729fe273">ast_sip_session_delayed_request::on_sdp_creation</a></div><div class="ttdeci">ast_sip_session_sdp_creation_cb on_sdp_creation</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01342">res_pjsip_session.c:1342</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session_delayed_request::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01348">res_pjsip_session.c:1348</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_aea56c55f654c68cb1572e09264e90a57"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#aea56c55f654c68cb1572e09264e90a57">ast_sip_session_delayed_request::on_request_creation</a></div><div class="ttdeci">ast_sip_session_request_creation_cb on_request_creation</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01340">res_pjsip_session.c:1340</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a511a1f5d1b239c41b9eb4953ae4386ea"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a511a1f5d1b239c41b9eb4953ae4386ea">delayed_method2str</a></div><div class="ttdeci">static const char * delayed_method2str(enum delayed_method method)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01310">res_pjsip_session.c:1310</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_afb35a66aecb7cc6a143f8075c3992e0da02ccc9b52f326c27f7fd3ee072f4f6f1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0da02ccc9b52f326c27f7fd3ee072f4f6f1">AST_SIP_SESSION_REFRESH_METHOD_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00488">res_pjsip.h:488</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_af35ce25e8bd0e6e2c67f9d1d40003973"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#af35ce25e8bd0e6e2c67f9d1d40003973">ast_sip_session_delayed_request::method</a></div><div class="ttdeci">enum delayed_method method</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01338">res_pjsip_session.c:1338</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session_delayed_request::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01350">res_pjsip_session.c:1350</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a9d68a08d3f45966f9c90fa2903aed739"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a9d68a08d3f45966f9c90fa2903aed739">sip_session_refresh</a></div><div class="ttdeci">static int sip_session_refresh(struct ast_sip_session *session, ast_sip_session_request_creation_cb on_request_creation, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, enum ast_sip_session_refresh_method method, int generate_new_sdp, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state, int queued)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">res_pjsip_session.c:2184</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">res_pjsip_session.c:1296</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a25bb4ff3d06ce7d015a8ed92849d2bfc"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a25bb4ff3d06ce7d015a8ed92849d2bfc">ast_sip_session_delayed_request::generate_new_sdp</a></div><div class="ttdeci">int generate_new_sdp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01346">res_pjsip_session.c:1346</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_afcd45a052e625a4b6a24d35d47f4c769"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#afcd45a052e625a4b6a24d35d47f4c769">ast_sip_session_delayed_request::on_response</a></div><div class="ttdeci">ast_sip_session_response_cb on_response</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01344">res_pjsip_session.c:1344</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">res_pjsip_session.c:1297</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac548e363175ba43f7ad75438729deac3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a></div><div class="ttdeci">void ast_sip_session_terminate(struct ast_sip_session *session, int response)</div><div class="ttdoc">Terminate a session and, if possible, send the provided response code. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">res_pjsip_session.c:3451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb6b8967d5861edcb38d2a36ad3349b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb6b8967d5861edcb38d2a36ad3349b7">&#9670;&nbsp;</a></span>session_datastore_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_datastore_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01229">1229</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00070">ast_datastore::data</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00034">ast_datastore_info::destroy</a>, <a class="el" href="../../d9/db6/datastore_8h_source.html#l00071">ast_datastore::info</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../d9/db6/datastore_8h_source.html#l00069">ast_datastore::uid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01243">ast_sip_session_alloc_datastore()</a>.</p>
<div class="fragment"><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore = obj;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;   <span class="comment">/* Using the destroy function (if present) destroy the data */</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;   <span class="keywordflow">if</span> (datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">info</a>-&gt;<a class="code" href="../../d9/dfb/structast__datastore__info.html#afdad821535486a599c1df88ef7be69bb">destroy</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">info</a>-&gt;<a class="code" href="../../d9/dfb/structast__datastore__info.html#afdad821535486a599c1df88ef7be69bb">destroy</a>(datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a>);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">data</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;   }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">void</span> *) datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>);</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;   datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div><div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__datastore_html_a2daadcdbac635c83b7bfc6375b4c9be4"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">ast_datastore::uid</a></div><div class="ttdeci">const char * uid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00069">datastore.h:69</a></div></div>
<div class="ttc" id="structast__datastore_html_a03ea21247b5d39b165343431b44131f1"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">ast_datastore::info</a></div><div class="ttdeci">const struct ast_datastore_info * info</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00071">datastore.h:71</a></div></div>
<div class="ttc" id="structast__datastore__info_html_afdad821535486a599c1df88ef7be69bb"><div class="ttname"><a href="../../d9/dfb/structast__datastore__info.html#afdad821535486a599c1df88ef7be69bb">ast_datastore_info::destroy</a></div><div class="ttdeci">void(* destroy)(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00034">datastore.h:34</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__datastore_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a735984d41155bc1032e09bece8f8d66d">ast_datastore::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00070">datastore.h:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d2190ae1fcb37e66c2a445f2fe59ec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d2190ae1fcb37e66c2a445f2fe59ec3">&#9670;&nbsp;</a></span>session_destructor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_destructor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02900">2900</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00223">ast_sip_session::aor</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d3b/dsp_8c_source.html#l01770">ast_dsp_free()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00652">AST_LIST_HEAD_DESTROY</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00832">AST_LIST_REMOVE_HEAD</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01811">ast_party_id_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d2/dc0/pjsip__session_8c_source.html#l00111">ast_sip_session_remove_supplements()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00300">ast_strdupa</a>, <a class="el" href="../../d4/deb/taskprocessor_8c_source.html#l01109">ast_taskprocessor_unreference()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00174">AST_VECTOR_FREE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00627">AST_VECTOR_RESET</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00185">ast_sip_session::contact</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">ast_sip_session::datastores</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">delayed_request_free()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00203">ast_sip_session::direct_media_cap</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00213">ast_sip_session::dsp</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04426">handle_session_destroy()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">ast_sip_session::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">ast_sip_session_delayed_request::next</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, and <a class="el" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02990">ast_sip_session_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;{</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = obj;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a> *delay;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;   <span class="comment">/* We dup the endpoint ID in case the endpoint gets freed out from under us */</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *endpoint_name = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a> ?</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>)) : <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Destroying SIP session\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;SESSION_DESTROYING&quot;</span>,</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="stringliteral">&quot;Endpoint: %s\r\n&quot;</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;      <span class="stringliteral">&quot;AOR: %s\r\n&quot;</span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;      <span class="stringliteral">&quot;Contact: %s&quot;</span></div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;      , endpoint_name</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      , session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abe62f945c2acd871dc5077f2db363bb7">aor</a> ? <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abe62f945c2acd871dc5077f2db363bb7">aor</a>) : <span class="stringliteral">&quot;&lt;none&gt;&quot;</span></div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      , session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a0181805d3b31d6f1859ef7784c67fcf2">contact</a> ? <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a0181805d3b31d6f1859ef7784c67fcf2">contact</a>) : <span class="stringliteral">&quot;&lt;none&gt;&quot;</span></div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      );</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;   <span class="comment">/* fire session destroy handler */</span></div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3e81e5efda52a0a77616b0490de568c0">handle_session_destroy</a>(session);</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;   <span class="comment">/* remove all registered supplements */</span></div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a4c6b10ea506d88abcd42bb8373dcb2c4">ast_sip_session_remove_supplements</a>(session);</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a47bafe663a14b91827082787d7654d7c">AST_LIST_HEAD_DESTROY</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">supplements</a>);</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   <span class="comment">/* remove all saved media stats */</span></div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a>(&amp;session-&gt;media_stats, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;   <a class="code" href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a>(&amp;session-&gt;media_stats);</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;   <a class="code" href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>);</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">datastores</a>);</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>);</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;   <span class="keywordflow">while</span> ((delay = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>, <a class="code" href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">next</a>))) {</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a>(delay);</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;   }</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a5399dc7357197254794b990b263a2b7b">ast_party_id_free</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a8791d240f8a9c2dc271a1c8542cfe8cc">id</a>);</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>);</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#abe62f945c2acd871dc5077f2db363bb7">aor</a>);</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a0181805d3b31d6f1859ef7784c67fcf2">contact</a>);</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aea104bc5edcb830fe465bc8a7f6aed45">direct_media_cap</a>);</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;   <a class="code" href="../../d3/d08/dsp_8h.html#a0a57a1e374549eb2705068688f4046db">ast_dsp_free</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9deccb020b39c3f7ac94b1af99cac5d">dsp</a>);</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>) {</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <span class="keyword">struct </span>pjsip_dialog *dlg = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      <span class="comment">/* The INVITE session uses the dialog pool for memory, so we need to</span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="comment">       * decrement its reference first before that of the dialog.</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="preprocessor">#ifdef HAVE_PJSIP_INV_SESSION_REF</span></div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;      pjsip_inv_dec_ref(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>);</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      pjsip_dlg_dec_session(dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>);</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;   }</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;SESSION_DESTROYED&quot;</span>, <span class="stringliteral">&quot;Endpoint: %s&quot;</span>, endpoint_name);</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;}</div><div class="ttc" id="vector_8h_html_a66aaa4efda59c52384b03c38e781124d"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a66aaa4efda59c52384b03c38e781124d">AST_VECTOR_FREE</a></div><div class="ttdeci">#define AST_VECTOR_FREE(vec)</div><div class="ttdoc">Deallocates this vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00174">vector.h:174</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="dsp_8h_html_a0a57a1e374549eb2705068688f4046db"><div class="ttname"><a href="../../d3/d08/dsp_8h.html#a0a57a1e374549eb2705068688f4046db">ast_dsp_free</a></div><div class="ttdeci">void ast_dsp_free(struct ast_dsp *dsp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d3b/dsp_8c_source.html#l01770">dsp.c:1770</a></div></div>
<div class="ttc" id="structast__sip__session_html_abc32956d82e246471f4e5edbb3dda759"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abc32956d82e246471f4e5edbb3dda759">ast_sip_session::datastores</a></div><div class="ttdeci">struct ao2_container * datastores</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00193">res_pjsip_session.h:193</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_abdb87d2e0451ce7382da2c5b23525c73"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#abdb87d2e0451ce7382da2c5b23525c73">delayed_request_free</a></div><div class="ttdeci">static void delayed_request_free(struct ast_sip_session_delayed_request *delay)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01379">res_pjsip_session.c:1379</a></div></div>
<div class="ttc" id="channel_8h_html_a5399dc7357197254794b990b263a2b7b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5399dc7357197254794b990b263a2b7b">ast_party_id_free</a></div><div class="ttdeci">void ast_party_id_free(struct ast_party_id *doomed)</div><div class="ttdoc">Destroy the party id contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01811">channel.c:1811</a></div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html_a6371800ca2b62c38686de1486a19e799"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html#a6371800ca2b62c38686de1486a19e799">ast_sip_session_delayed_request::next</a></div><div class="ttdeci">struct ast_sip_session_delayed_request * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01352">res_pjsip_session.c:1352</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="structast__sip__session_html_aea104bc5edcb830fe465bc8a7f6aed45"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aea104bc5edcb830fe465bc8a7f6aed45">ast_sip_session::direct_media_cap</a></div><div class="ttdeci">struct ast_format_cap * direct_media_cap</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00203">res_pjsip_session.h:203</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a47bafe663a14b91827082787d7654d7c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a47bafe663a14b91827082787d7654d7c">AST_LIST_HEAD_DESTROY</a></div><div class="ttdeci">#define AST_LIST_HEAD_DESTROY(head)</div><div class="ttdoc">Destroys a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00652">linkedlists.h:652</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9deccb020b39c3f7ac94b1af99cac5d"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9deccb020b39c3f7ac94b1af99cac5d">ast_sip_session::dsp</a></div><div class="ttdeci">struct ast_dsp * dsp</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00213">res_pjsip_session.h:213</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a3e81e5efda52a0a77616b0490de568c0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3e81e5efda52a0a77616b0490de568c0">handle_session_destroy</a></div><div class="ttdeci">static void handle_session_destroy(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04426">res_pjsip_session.c:4426</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a4c6b10ea506d88abcd42bb8373dcb2c4"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a4c6b10ea506d88abcd42bb8373dcb2c4">ast_sip_session_remove_supplements</a></div><div class="ttdeci">void ast_sip_session_remove_supplements(struct ast_sip_session *session)</div><div class="ttdoc">Remove supplements from a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dc0/pjsip__session_8c_source.html#l00111">pjsip_session.c:111</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="vector_8h_html_a0e59aa540254f87575cb1d28821bbd1f"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0e59aa540254f87575cb1d28821bbd1f">AST_VECTOR_RESET</a></div><div class="ttdeci">#define AST_VECTOR_RESET(vec, cleanup)</div><div class="ttdoc">Reset vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00627">vector.h:627</a></div></div>
<div class="ttc" id="structast__sip__session_html_a963de57af2591091b0de0e52dd9537a2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a963de57af2591091b0de0e52dd9537a2">ast_sip_session::supplements</a></div><div class="ttdeci">struct ast_sip_session::@308 supplements</div></div>
<div class="ttc" id="structast__sip__session__delayed__request_html"><div class="ttname"><a href="../../d5/dfa/structast__sip__session__delayed__request.html">ast_sip_session_delayed_request</a></div><div class="ttdoc">Structure used for sending delayed requests. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01336">res_pjsip_session.c:1336</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_a32492eb2480cb8c46ad669622cff8556"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#a32492eb2480cb8c46ad669622cff8556">ast_taskprocessor_unreference</a></div><div class="ttdeci">void * ast_taskprocessor_unreference(struct ast_taskprocessor *tps)</div><div class="ttdoc">Unreference the specified taskprocessor and its reference count will decrement. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/deb/taskprocessor_8c_source.html#l01109">taskprocessor.c:1109</a></div></div>
<div class="ttc" id="structast__sip__session_html_a0181805d3b31d6f1859ef7784c67fcf2"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a0181805d3b31d6f1859ef7784c67fcf2">ast_sip_session::contact</a></div><div class="ttdeci">struct ast_sip_contact * contact</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00185">res_pjsip_session.h:185</a></div></div>
<div class="ttc" id="structast__sip__session_html_abe62f945c2acd871dc5077f2db363bb7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#abe62f945c2acd871dc5077f2db363bb7">ast_sip_session::aor</a></div><div class="ttdeci">struct ast_sip_aor * aor</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00223">res_pjsip_session.h:223</a></div></div>
<div class="ttc" id="structast__sip__session_html_a8791d240f8a9c2dc271a1c8542cfe8cc"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a8791d240f8a9c2dc271a1c8542cfe8cc">ast_sip_session::id</a></div><div class="ttdeci">struct ast_party_id id</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00207">res_pjsip_session.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad11de1bfcc9846e016339bd3b482d16f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad11de1bfcc9846e016339bd3b482d16f">&#9670;&nbsp;</a></span>session_end()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int session_end </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vsession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">4525</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04437">handle_session_end()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03588">sip_session_defer_termination_stop_timer()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03317">ast_sip_session_create_outgoing()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03614">ast_sip_session_end_if_deferred()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">session_inv_on_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;{</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = vsession;</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;   <span class="comment">/* Stop the scheduled termination */</span></div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8bd0100b8c103a8d8633eb0db236f6af">sip_session_defer_termination_stop_timer</a>(session);</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;   <span class="comment">/* Session is dead.  Notify the supplements. */</span></div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a70392ec2e318f5b34273e578fb122d1e">handle_session_end</a>(session);</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a70392ec2e318f5b34273e578fb122d1e"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a70392ec2e318f5b34273e578fb122d1e">handle_session_end</a></div><div class="ttdeci">static void handle_session_end(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04437">res_pjsip_session.c:4437</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8bd0100b8c103a8d8633eb0db236f6af"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8bd0100b8c103a8d8633eb0db236f6af">sip_session_defer_termination_stop_timer</a></div><div class="ttdeci">static void sip_session_defer_termination_stop_timer(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03588">res_pjsip_session.c:3588</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a219b1d1405e2e3799cc9c784154c688d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a219b1d1405e2e3799cc9c784154c688d">&#9670;&nbsp;</a></span>session_end_completion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int session_end_completion </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vsession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">4548</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">ast_sip_dialog_set_endpoint()</a>, <a class="el" href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">ast_sip_dialog_set_serializer()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03317">ast_sip_session_create_outgoing()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04701">session_end_if_disconnected()</a>.</p>
<div class="fragment"><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;{</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = vsession;</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;   <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;   <span class="comment">/* Now we can release the ref that was held by session-&gt;inv_session */</span></div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session);</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;}</div><div class="ttc" id="group__pjsip__threading_html_ga86c62fe22e3b7fb409c13ec7fd4fee2d"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga86c62fe22e3b7fb409c13ec7fd4fee2d">ast_sip_dialog_set_serializer</a></div><div class="ttdeci">void ast_sip_dialog_set_serializer(pjsip_dialog *dlg, struct ast_taskprocessor *serializer)</div><div class="ttdoc">Set a serializer on a SIP dialog so requests and responses are automatically serialized. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00266">pjsip_distributor.c:266</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga6d8415024c851216fa63fbb94d0aadcf"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga6d8415024c851216fa63fbb94d0aadcf">ast_sip_dialog_set_endpoint</a></div><div class="ttdeci">void ast_sip_dialog_set_endpoint(pjsip_dialog *dlg, struct ast_sip_endpoint *endpoint)</div><div class="ttdoc">Set an endpoint on a SIP dialog so in-dialog requests do not undergo endpoint lookup. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dad/pjsip__distributor_8c_source.html#l00294">pjsip_distributor.c:294</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe9c8de50ba0b0f1ab0c6a46d914e726"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe9c8de50ba0b0f1ab0c6a46d914e726">&#9670;&nbsp;</a></span>session_end_if_disconnected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int session_end_if_disconnected </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04701">4701</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01507">id</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">session_end_completion()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;{</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;   <span class="keywordflow">if</span> (inv-&gt;state != PJSIP_INV_STATE_DISCONNECTED) {</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;   }</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;<span class="comment">    * We are locking because ast_sip_dialog_get_session() needs</span></div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;<span class="comment">    * the dialog locked to get the session by other threads.</span></div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;   pjsip_dlg_inc_lock(inv-&gt;dlg);</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;   session = inv-&gt;mod_data[<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>];</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;   inv-&gt;mod_data[<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;   pjsip_dlg_dec_lock(inv-&gt;dlg);</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;<span class="comment">    * Pass the session ref held by session-&gt;inv_session to</span></div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;<span class="comment">    * session_end_completion().</span></div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;   <span class="keywordflow">if</span> (session</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;      &amp;&amp; <a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a>, session)) {</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;      <span class="comment">/* Do it anyway even though this is not the right thread. */</span></div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a>(session);</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;   }</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a219b1d1405e2e3799cc9c784154c688d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a219b1d1405e2e3799cc9c784154c688d">session_end_completion</a></div><div class="ttdeci">static int session_end_completion(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04548">res_pjsip_session.c:4548</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6127f7b1b0fba27dfad92635ec32a199"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6127f7b1b0fba27dfad92635ec32a199">&#9670;&nbsp;</a></span>session_inv_on_create_offer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_inv_on_create_offer </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjmedia_sdp_session **&#160;</td>
          <td class="paramname"><em>p_offer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05259">5259</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d28/channel_8c_source.html#l01216">ast_queue_unhold()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>
<div class="fragment"><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;{</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;   <span class="keyword">const</span> pjmedia_sdp_session *previous_sdp = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;   pjmedia_sdp_session *offer;</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;   <span class="keywordflow">if</span> (inv-&gt;neg) {</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      <span class="keywordflow">if</span> (pjmedia_sdp_neg_was_answer_remote(inv-&gt;neg)) {</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;         pjmedia_sdp_neg_get_active_remote(inv-&gt;neg, &amp;previous_sdp);</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;         pjmedia_sdp_neg_get_active_local(inv-&gt;neg, &amp;previous_sdp);</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      }</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;   }</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;   offer = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(inv, session, previous_sdp);</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;   <span class="keywordflow">if</span> (!offer) {</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;   }</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#aada21a9f55151c285a1537613ff9197a">ast_queue_unhold</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;<span class="comment">    * Some devices indicate hold with deferred SDP reinvites (i.e. no SDP in the reinvite).</span></div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;<span class="comment">    * When hold is initially indicated, we</span></div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;<span class="comment">    * - Receive an INVITE with no SDP</span></div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;<span class="comment">    * - Send a 200 OK with SDP, indicating sendrecv in the media streams</span></div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;<span class="comment">    * - Receive an ACK with SDP, indicating sendonly in the media streams</span></div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;<span class="comment">    * At this point, the pjmedia negotiator saves the state of the media direction so that</span></div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;<span class="comment">    * if we are to send any offers, we&#39;ll offer recvonly in the media streams. This is</span></div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;<span class="comment">    * problematic if the device is attempting to unhold, though. If the device unholds</span></div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;<span class="comment">    * by sending a reinvite with no SDP, then we will respond with a 200 OK with recvonly.</span></div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;<span class="comment">    * According to RFC 3264, if an offerer offers recvonly, then the answerer MUST respond</span></div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;<span class="comment">    * with sendonly or inactive. The result of this is that the stream is not off hold.</span></div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;<span class="comment">    *</span></div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;<span class="comment">    * Therefore, in this case, when we receive a reinvite while the stream is on hold, we</span></div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;<span class="comment">    * need to be sure to offer sendrecv. This way, the answerer can respond with sendrecv</span></div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;<span class="comment">    * in order to get the stream off hold. If this is actually a different purpose reinvite</span></div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;<span class="comment">    * (like a session timer refresh), then the answerer can respond to our sendrecv with</span></div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;<span class="comment">    * sendonly, keeping the stream on hold.</span></div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; offer-&gt;media_count; ++i) {</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;      pjmedia_sdp_media *m = offer-&gt;media[i];</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;      pjmedia_sdp_attr *recvonly;</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;      pjmedia_sdp_attr *inactive;</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      pjmedia_sdp_attr *sendonly;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;      recvonly = pjmedia_sdp_attr_find2(m-&gt;attr_count, m-&gt;attr, <span class="stringliteral">&quot;recvonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;      inactive = pjmedia_sdp_attr_find2(m-&gt;attr_count, m-&gt;attr, <span class="stringliteral">&quot;inactive&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;      sendonly = pjmedia_sdp_attr_find2(m-&gt;attr_count, m-&gt;attr, <span class="stringliteral">&quot;sendonly&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;      <span class="keywordflow">if</span> (recvonly || inactive || sendonly) {</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;         pjmedia_sdp_attr *to_remove = recvonly ?: inactive ?: sendonly;</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;         pjmedia_sdp_attr *sendrecv;</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;         pjmedia_sdp_attr_remove(&amp;m-&gt;attr_count, m-&gt;attr, to_remove);</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;         sendrecv = pjmedia_sdp_attr_create(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;pool, <span class="stringliteral">&quot;sendrecv&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;         pjmedia_sdp_media_add_attr(m, sendrecv);</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;      }</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;   }</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;   *p_offer = offer;</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;}</div><div class="ttc" id="channel_8h_html_aada21a9f55151c285a1537613ff9197a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aada21a9f55151c285a1537613ff9197a">ast_queue_unhold</a></div><div class="ttdeci">int ast_queue_unhold(struct ast_channel *chan)</div><div class="ttdoc">Queue an unhold frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01216">channel.c:1216</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a05fd614286dc0661485d46f1c3e5efba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05fd614286dc0661485d46f1c3e5efba">&#9670;&nbsp;</a></span>session_inv_on_media_update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_inv_on_media_update </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pj_status_t&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05324">5324</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00723">ast_sip_media_rtp_configuration::accept_multiple_sdp_answers</a>, <a class="el" href="../../d4/da3/causes_8h_source.html#l00129">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00431">ast_channel_hangupcause_set()</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01150">ast_queue_hangup()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l02504">ast_set_hangupsource()</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01829">ast_shutdown_final()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00721">ast_sip_media_rtp_configuration::follow_early_media_fork</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00764">ast_sip_endpoint_media_configuration::rtp</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>.</p>
<div class="fragment"><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;{</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;   <span class="keyword">const</span> pjmedia_sdp_session *local, *remote;</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a>()) {</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: Shutdown in progress\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;   }</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;   session = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;   <span class="keywordflow">if</span> (!session || !session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;<span class="comment">       * If we don&#39;t have a session or channel then we really</span></div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;<span class="comment">       * don&#39;t care about media updates.</span></div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="comment">       * Just ignore</span></div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: No channel or session\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;   }</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>) {</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;      <span class="keywordtype">int</span> bail = 0;</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;<span class="comment">       * If following_fork is set, then this is probably the result of a</span></div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;<span class="comment">       * forked INVITE and SDP asnwers coming from the different fork UAS</span></div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;<span class="comment">       * destinations.  In this case updated_sdp_answer will also be set.</span></div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;<span class="comment">       * If only updated_sdp_answer is set, then this is the non-forking</span></div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;<span class="comment">       * scenario where the same UAS just needs to change something like</span></div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;<span class="comment">       * the media port.</span></div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;      <span class="keywordflow">if</span> (inv-&gt;following_fork) {</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#a9f835639c6fb52397b3e89b2c09bb41e">follow_early_media_fork</a>) {</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Following early media fork with different To tags\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Not following early media fork with different To tags\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;            bail = 1;</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;         }</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      }</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;<span class="preprocessor">#ifdef HAVE_PJSIP_INV_ACCEPT_MULTIPLE_SDP_ANSWERS</span></div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inv-&gt;updated_sdp_answer) {</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">rtp</a>.<a class="code" href="../../dd/d14/structast__sip__media__rtp__configuration.html#af394e74a8f33c47aebf631ea72cd76d8">accept_multiple_sdp_answers</a>) {</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Accepting updated SDP with same To tag\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Ignoring updated SDP answer with same To tag\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;            bail = 1;</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;         }</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;      }</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;      <span class="keywordflow">if</span> (bail) {</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: Bailing\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;      }</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;   }</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;   <span class="keywordflow">if</span> ((<a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> != PJ_SUCCESS) || (pjmedia_sdp_neg_get_active_local(inv-&gt;neg, &amp;local) != PJ_SUCCESS) ||</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;      (pjmedia_sdp_neg_get_active_remote(inv-&gt;neg, &amp;remote) != PJ_SUCCESS)) {</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, <a class="code" href="../../d4/da3/causes_8h.html#a208e4fc34932b91fc9e90d9008329e87">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a>);</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#aa9a1d01546e0fc0047e56ba589790b6f">ast_set_hangupsource</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>), 0);</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a30bcf0418189567bc84ff32034f79f28">ast_queue_hangup</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: Couldn&#39;t get active or local or remote negotiator.  Hanging up\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;   }</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a22010f3c564b39568a2645c06386a7f0">handle_negotiated_sdp</a>(session, local, remote)) {</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: handle_negotiated_sdp failed.  Resetting pending media state\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;   }</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;}</div><div class="ttc" id="channel_8h_html_a30bcf0418189567bc84ff32034f79f28"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a30bcf0418189567bc84ff32034f79f28">ast_queue_hangup</a></div><div class="ttdeci">int ast_queue_hangup(struct ast_channel *chan)</div><div class="ttdoc">Queue a hangup frame. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01150">channel.c:1150</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="channel_8h_html_ae6b4b7ba458e88fdbb2df9f39d935337"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae6b4b7ba458e88fdbb2df9f39d935337">ast_channel_hangupcause_set</a></div><div class="ttdeci">void ast_channel_hangupcause_set(struct ast_channel *chan, int value)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00431">channel_internal_api.c:431</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a22010f3c564b39568a2645c06386a7f0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a22010f3c564b39568a2645c06386a7f0">handle_negotiated_sdp</a></div><div class="ttdeci">static int handle_negotiated_sdp(struct ast_sip_session *session, const pjmedia_sdp_session *local, const pjmedia_sdp_session *remote)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">res_pjsip_session.c:1063</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="structast__sip__media__rtp__configuration_html_af394e74a8f33c47aebf631ea72cd76d8"><div class="ttname"><a href="../../dd/d14/structast__sip__media__rtp__configuration.html#af394e74a8f33c47aebf631ea72cd76d8">ast_sip_media_rtp_configuration::accept_multiple_sdp_answers</a></div><div class="ttdeci">unsigned int accept_multiple_sdp_answers</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00723">res_pjsip.h:723</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="structast__sip__media__rtp__configuration_html_a9f835639c6fb52397b3e89b2c09bb41e"><div class="ttname"><a href="../../dd/d14/structast__sip__media__rtp__configuration.html#a9f835639c6fb52397b3e89b2c09bb41e">ast_sip_media_rtp_configuration::follow_early_media_fork</a></div><div class="ttdeci">unsigned int follow_early_media_fork</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00721">res_pjsip.h:721</a></div></div>
<div class="ttc" id="channel_8h_html_aa9a1d01546e0fc0047e56ba589790b6f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa9a1d01546e0fc0047e56ba589790b6f">ast_set_hangupsource</a></div><div class="ttdeci">void ast_set_hangupsource(struct ast_channel *chan, const char *source, int force)</div><div class="ttdoc">Set the source of the hangup in this channel and it&amp;#39;s bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l02504">channel.c:2504</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a0728d28b6a031937ed2546296d430561"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a0728d28b6a031937ed2546296d430561">ast_sip_endpoint_media_configuration::rtp</a></div><div class="ttdeci">struct ast_sip_media_rtp_configuration rtp</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00764">res_pjsip.h:764</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="asterisk_8h_html_a0eb0441c04955094ce5845fb0258645a"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a></div><div class="ttdeci">int ast_shutdown_final(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01829">asterisk.c:1829</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
<div class="ttc" id="causes_8h_html_a208e4fc34932b91fc9e90d9008329e87"><div class="ttname"><a href="../../d4/da3/causes_8h.html#a208e4fc34932b91fc9e90d9008329e87">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a></div><div class="ttdeci">#define AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00129">causes.h:129</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac03acea3f63b790f2a2ba54a8387b984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac03acea3f63b790f2a2ba54a8387b984">&#9670;&nbsp;</a></span>session_inv_on_new_session()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_inv_on_new_session </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_event *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04696">4696</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>
<div class="fragment"><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;{</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;   <span class="comment">/* XXX STUB */</span></div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a2d25e1ea1f248eb282bf949009bff30f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d25e1ea1f248eb282bf949009bff30f">&#9670;&nbsp;</a></span>session_inv_on_redirected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pjsip_redirect_op session_inv_on_redirected </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_uri *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjsip_event *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05395">5395</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00135">AST_MAX_EXTENSION</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01829">ast_shutdown_final()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00519">AST_SIP_REDIRECT_URI_CORE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00521">AST_SIP_REDIRECT_URI_PJSIP</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00517">AST_SIP_REDIRECT_USER</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00264">AST_SIP_SESSION_BEFORE_REDIRECTING</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l03036">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../da/d45/chan__alsa_8c_source.html#l00118">exten</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">handle_incoming()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00873">ast_sip_endpoint::redirect_method</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>
<div class="fragment"><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;{</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;   <span class="keyword">const</span> pjsip_sip_uri *uri;</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;</div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a>()) {</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;      <span class="keywordflow">return</span> PJSIP_REDIRECT_STOP;</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;   }</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;   session = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;   <span class="keywordflow">if</span> (!session || !session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) {</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;      <span class="keywordflow">return</span> PJSIP_REDIRECT_STOP;</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;   }</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a41815ca9d0473a80421fbb7d7f8e5668">redirect_method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d1013345205788e6f0134a24b96483fa585e9f700a59c854bd2e60a20bd771b3">AST_SIP_REDIRECT_URI_PJSIP</a>) {</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;      <span class="keywordflow">return</span> PJSIP_REDIRECT_ACCEPT;</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;   }</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;   <span class="keywordflow">if</span> (!PJSIP_URI_SCHEME_IS_SIP(target) &amp;&amp; !PJSIP_URI_SCHEME_IS_SIPS(target)) {</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;      <span class="keywordflow">return</span> PJSIP_REDIRECT_STOP;</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;   }</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae8a19b2f0b2cac772a583a0d31fa434b">handle_incoming</a>(session, e-&gt;body.rx_msg.rdata, <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e">AST_SIP_SESSION_BEFORE_REDIRECTING</a>);</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;   uri = pjsip_uri_get_uri(target);</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a41815ca9d0473a80421fbb7d7f8e5668">redirect_method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d1013345205788e6f0134a24b96483faacea24f679395c50d7467f5bbf4a7e6b">AST_SIP_REDIRECT_USER</a>) {</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>[<a class="code" href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a>];</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(exten, &amp;uri-&gt;user, <span class="keyword">sizeof</span>(exten));</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;<span class="comment">       * We may want to match in the dialplan without any user</span></div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;<span class="comment">       * options getting in the way.</span></div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a>(exten);</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      ast_channel_call_forward_set(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, exten);</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a41815ca9d0473a80421fbb7d7f8e5668">redirect_method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a2d1013345205788e6f0134a24b96483fa3c079756396cee2aeac8db347f06d28d">AST_SIP_REDIRECT_URI_CORE</a>) {</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      <span class="keywordtype">char</span> target_uri[PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;      <span class="comment">/* PJSIP/ + endpoint length + / + max URL size */</span></div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;      <span class="keywordtype">char</span> forward[8 + strlen(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>)) + PJSIP_MAX_URL_SIZE];</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;      pjsip_uri_print(PJSIP_URI_IN_REQ_URI, uri, target_uri, <span class="keyword">sizeof</span>(target_uri));</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;      sprintf(forward, <span class="stringliteral">&quot;PJSIP/%s/%s&quot;</span>, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>), target_uri);</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;      ast_channel_call_forward_set(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, forward);</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;   }</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;   <span class="keywordflow">return</span> PJSIP_REDIRECT_STOP;</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;}</div><div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a6bb5769d100d0348446c7f032eca58c1"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a6bb5769d100d0348446c7f032eca58c1">AST_SIP_USER_OPTIONS_TRUNCATE_CHECK</a></div><div class="ttdeci">#define AST_SIP_USER_OPTIONS_TRUNCATE_CHECK(str)</div><div class="ttdoc">Truncate the URI user field options string if enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l03036">res_pjsip.h:3036</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d1013345205788e6f0134a24b96483fa585e9f700a59c854bd2e60a20bd771b3"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d1013345205788e6f0134a24b96483fa585e9f700a59c854bd2e60a20bd771b3">AST_SIP_REDIRECT_URI_PJSIP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00521">res_pjsip.h:521</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae8a19b2f0b2cac772a583a0d31fa434b"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae8a19b2f0b2cac772a583a0d31fa434b">handle_incoming</a></div><div class="ttdeci">static int handle_incoming(struct ast_sip_session *session, pjsip_rx_data *rdata, enum ast_sip_session_response_priority response_priority)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">res_pjsip_session.c:4469</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="channel_8h_html_af4e59494f74ad9e0c50170d9e276ad31"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af4e59494f74ad9e0c50170d9e276ad31">AST_MAX_EXTENSION</a></div><div class="ttdeci">#define AST_MAX_EXTENSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00135">channel.h:135</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="asterisk_8h_html_a0eb0441c04955094ce5845fb0258645a"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a></div><div class="ttdeci">int ast_shutdown_final(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01829">asterisk.c:1829</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195a706b3600a5c7b4eae13e7013e7f0aa8e">AST_SIP_SESSION_BEFORE_REDIRECTING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00264">res_pjsip_session.h:264</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d1013345205788e6f0134a24b96483faacea24f679395c50d7467f5bbf4a7e6b"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d1013345205788e6f0134a24b96483faacea24f679395c50d7467f5bbf4a7e6b">AST_SIP_REDIRECT_USER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00517">res_pjsip.h:517</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a2d1013345205788e6f0134a24b96483fa3c079756396cee2aeac8db347f06d28d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a2d1013345205788e6f0134a24b96483fa3c079756396cee2aeac8db347f06d28d">AST_SIP_REDIRECT_URI_CORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00519">res_pjsip.h:519</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a41815ca9d0473a80421fbb7d7f8e5668"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a41815ca9d0473a80421fbb7d7f8e5668">ast_sip_endpoint::redirect_method</a></div><div class="ttdeci">enum ast_sip_session_redirect redirect_method</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00873">res_pjsip.h:873</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab76b5dd0de912abb513039dba97d5e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab76b5dd0de912abb513039dba97d5e5a">&#9670;&nbsp;</a></span>session_inv_on_rx_offer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_inv_on_rx_offer </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>offer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05236">5236</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d0/d29/chan__pjsip_8c_source.html#l00682">answer()</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01829">ast_shutdown_final()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">create_local_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>.</p>
<div class="fragment"><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;{</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;   pjmedia_sdp_session *<a class="code" href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a>;</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a>()) {</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: Shutdown in progress\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;   }</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;   session = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a148cffe818b8c47b8233c0c118c116a0">handle_incoming_sdp</a>(session, offer)) {</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: handle_incoming_sdp failed\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;   }</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;   <span class="keywordflow">if</span> ((answer = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a>(inv, session, offer))) {</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;      pjsip_inv_set_sdp_answer(inv, answer);</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: Set SDP answer\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;   }</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;%s: create_local_sdp failed\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a148cffe818b8c47b8233c0c118c116a0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a148cffe818b8c47b8233c0c118c116a0">handle_incoming_sdp</a></div><div class="ttdeci">static int handle_incoming_sdp(struct ast_sip_session *session, const pjmedia_sdp_session *sdp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">res_pjsip_session.c:764</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="chan__pjsip_8c_html_ab8dde573cc3974acd626c5626fae14b4"><div class="ttname"><a href="../../d0/d29/chan__pjsip_8c.html#ab8dde573cc3974acd626c5626fae14b4">answer</a></div><div class="ttdeci">static int answer(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/chan__pjsip_8c_source.html#l00682">chan_pjsip.c:682</a></div></div>
<div class="ttc" id="asterisk_8h_html_a0eb0441c04955094ce5845fb0258645a"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a></div><div class="ttdeci">int ast_shutdown_final(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01829">asterisk.c:1829</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a03b4a0d3ef8e1a50d76725863248cb0c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a03b4a0d3ef8e1a50d76725863248cb0c">create_local_sdp</a></div><div class="ttdeci">static struct pjmedia_sdp_session * create_local_sdp(pjsip_inv_session *inv, struct ast_sip_session *session, const pjmedia_sdp_session *offer)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05081">res_pjsip_session.c:5081</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab75bfd716f60c416a982360033124f06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab75bfd716f60c416a982360033124f06">&#9670;&nbsp;</a></span>session_inv_on_state_changed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_inv_on_state_changed </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_event *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04615">4615</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01829">ast_shutdown_final()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04560">check_request_status()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">ast_sip_session::defer_end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">ast_sip_session::ended_while_deferred</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">handle_incoming_before_media()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04396">print_debug_details</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>
<div class="fragment"><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;{</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;   pjsip_event_id_e <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Event: %s  Inv State: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;      pjsip_event_str(e-&gt;type), pjsip_inv_state_name(inv-&gt;state));</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a>()) {</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Shutting down\n&quot;</span>);</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;   }</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;   <span class="keywordflow">if</span> (e) {</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a067e52198c90bacbde0918721c8a8440">print_debug_details</a>(inv, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, e);</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;      type = e-&gt;type;</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      type = PJSIP_EVENT_UNKNOWN;</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;   }</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;   session = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;No session\n&quot;</span>);</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;   }</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;   <span class="keywordflow">switch</span>(type) {</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TX_MSG:</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_RX_MSG:</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2de6afbe09b1067f050db3c76437be3e">handle_incoming_before_media</a>(inv, session, e-&gt;body.rx_msg.rdata);</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TSX_STATE:</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Source of transaction state change is %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;         pjsip_event_str(e-&gt;body.tsx_state.type));</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      <span class="comment">/* Transaction state changes are prompted by some other underlying event. */</span></div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;      <span class="keywordflow">switch</span>(e-&gt;body.tsx_state.type) {</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;      <span class="keywordflow">case</span> PJSIP_EVENT_TX_MSG:</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;      <span class="keywordflow">case</span> PJSIP_EVENT_RX_MSG:</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ab8abc4564c04174e2a18fbf190cbf051">check_request_status</a>(inv, e)) {</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a2de6afbe09b1067f050db3c76437be3e">handle_incoming_before_media</a>(inv, session, e-&gt;body.tsx_state.src.rdata);</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;         }</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;      <span class="keywordflow">case</span> PJSIP_EVENT_TRANSPORT_ERROR:</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;      <span class="keywordflow">case</span> PJSIP_EVENT_TIMER:</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="comment">          * Check the request status on transport error or timeout. A transport</span></div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;<span class="comment">          * error can occur when a TCP socket closes and that can be the result</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="comment">          * of a 503. Also we may need to failover on a timeout (408).</span></div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ab8abc4564c04174e2a18fbf190cbf051">check_request_status</a>(inv, e);</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;      <span class="keywordflow">case</span> PJSIP_EVENT_USER:</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;      <span class="keywordflow">case</span> PJSIP_EVENT_UNKNOWN:</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;      <span class="keywordflow">case</span> PJSIP_EVENT_TSX_STATE:</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;         <span class="comment">/* Inception? */</span></div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;      }</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TRANSPORT_ERROR:</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TIMER:</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_UNKNOWN:</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_USER:</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;   }</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;   <span class="keywordflow">if</span> (inv-&gt;state == PJSIP_INV_STATE_DISCONNECTED) {</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">defer_end</a>) {</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: Deferring session end\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ended_while_deferred</a> = 1;</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Deferring\n&quot;</span>);</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;      }</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a>, session)) {</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;         <span class="comment">/* Do it anyway even though this is not the right thread. */</span></div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a>(session);</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;      }</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;   }</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>();</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ac2c154a795044fcfbadae5f1bab089df"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac2c154a795044fcfbadae5f1bab089df">ast_sip_session::defer_end</a></div><div class="ttdeci">unsigned int defer_end</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00227">res_pjsip_session.h:227</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a067e52198c90bacbde0918721c8a8440"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a067e52198c90bacbde0918721c8a8440">print_debug_details</a></div><div class="ttdeci">#define print_debug_details(inv, tsx, e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04396">res_pjsip_session.c:4396</a></div></div>
<div class="ttc" id="structast__sip__session_html_aef6d512ea85f581bcfd51fba42d6e8e3"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aef6d512ea85f581bcfd51fba42d6e8e3">ast_sip_session::ended_while_deferred</a></div><div class="ttdeci">unsigned int ended_while_deferred</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00229">res_pjsip_session.h:229</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad11de1bfcc9846e016339bd3b482d16f"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad11de1bfcc9846e016339bd3b482d16f">session_end</a></div><div class="ttdeci">static int session_end(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">res_pjsip_session.c:4525</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ab8abc4564c04174e2a18fbf190cbf051"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ab8abc4564c04174e2a18fbf190cbf051">check_request_status</a></div><div class="ttdeci">static int check_request_status(pjsip_inv_session *inv, pjsip_event *e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04560">res_pjsip_session.c:4560</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a2de6afbe09b1067f050db3c76437be3e"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a2de6afbe09b1067f050db3c76437be3e">handle_incoming_before_media</a></div><div class="ttdeci">static void handle_incoming_before_media(pjsip_inv_session *inv, struct ast_sip_session *session, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04583">res_pjsip_session.c:4583</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="asterisk_8h_html_a0eb0441c04955094ce5845fb0258645a"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a></div><div class="ttdeci">int ast_shutdown_final(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01829">asterisk.c:1829</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab4177e5337aad4d81ab4f9ddfa902c78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4177e5337aad4d81ab4f9ddfa902c78">&#9670;&nbsp;</a></span>session_inv_on_tsx_state_changed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_inv_on_tsx_state_changed </td>
          <td>(</td>
          <td class="paramtype">pjsip_inv_session *&#160;</td>
          <td class="paramname"><em>inv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_transaction *&#160;</td>
          <td class="paramname"><em>tsx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_event *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">4731</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/da3/causes_8h_source.html#l00129">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a>, <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00427">ast_channel_hangupcause()</a>, <a class="el" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00449">AST_LIST_EMPTY</a>, <a class="el" href="../../d5/d03/asterisk_8c_source.html#l01829">ast_shutdown_final()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03412">ast_sip_create_request_with_auth()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02638">ast_sip_mod_data_get</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00277">AST_SIP_SESSION_AFTER_MEDIA</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">ast_sip_session_send_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">ast_sip_session_send_request_with_cb()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00196">ast_test_suite_event_notify</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00239">ast_sip_session::authentication_challenge_count</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01582">check_delayed_requests()</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">handle_incoming()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l01507">id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">invite_proceeding()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00080">MAX_RX_CHALLENGES</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00057">MOD_DATA_ON_RESPONSE</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00855">ast_sip_endpoint::outbound_auths</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04396">print_debug_details</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">reschedule_reinvite()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04701">session_end_if_disconnected()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01568">update_completed()</a>.</p>
<div class="fragment"><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;{</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;   <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a> cb;</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;   <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id;</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = inv-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id];</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s TSX State: %s  Inv State: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      pjsip_tsx_state_str(tsx-&gt;state), pjsip_inv_state_name(inv-&gt;state));</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a>()) {</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Shutting down\n&quot;</span>);</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;   }</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;   session = inv-&gt;mod_data[<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>];</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a067e52198c90bacbde0918721c8a8440">print_debug_details</a>(inv, tsx, e);</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;   <span class="keywordflow">if</span> (!session) {</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      <span class="comment">/* The session has ended.  Ignore the transaction change. */</span></div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Session ended\n&quot;</span>);</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;   }</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;<span class="comment">    * If the session is disconnected really nothing else to do unless currently transacting</span></div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;<span class="comment">    * a BYE. If a BYE then hold off destruction until the transaction timeout occurs. This</span></div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;<span class="comment">    * has to be done for BYEs because sometimes the dialog can be in a disconnected</span></div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;<span class="comment">    * state but the BYE request transaction has not yet completed.</span></div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;   <span class="keywordflow">if</span> (tsx-&gt;method.id != PJSIP_BYE_METHOD &amp;&amp; <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#afe9c8de50ba0b0f1ab0c6a46d914e726">session_end_if_disconnected</a>(<span class="keywordtype">id</span>, inv)) {</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Disconnected\n&quot;</span>);</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;   }</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;   <span class="keywordflow">switch</span> (e-&gt;body.tsx_state.type) {</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TX_MSG:</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;      <span class="comment">/* When we create an outgoing request, we do not have access to the transaction that</span></div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;<span class="comment">       * is created. Instead, We have to place transaction-specific data in the tdata. Here,</span></div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;<span class="comment">       * we transfer the data into the transaction. This way, when we receive a response, we</span></div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;<span class="comment">       * can dig this data out again</span></div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;      tsx-&gt;mod_data[<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>] = e-&gt;body.tsx_state.src.tdata-&gt;mod_data[<a class="code" href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a>];</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_RX_MSG:</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;      cb = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a>(tsx-&gt;mod_data, <span class="keywordtype">id</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a929623f98bee0fc9eb242c0bce08d227">MOD_DATA_ON_RESPONSE</a>);</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;      <span class="comment">/* As the PJSIP invite session implementation responds with a 200 OK before we have a</span></div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;<span class="comment">       * chance to be invoked session supplements for BYE requests actually end up executing</span></div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;<span class="comment">       * in the invite session state callback as well. To prevent session supplements from</span></div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;<span class="comment">       * running on the BYE request again we explicitly squash invocation of them here.</span></div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;      <span class="keywordflow">if</span> ((e-&gt;body.tsx_state.src.rdata-&gt;msg_info.msg-&gt;type != PJSIP_REQUEST_MSG) ||</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;         (tsx-&gt;method.id != PJSIP_BYE_METHOD)) {</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae8a19b2f0b2cac772a583a0d31fa434b">handle_incoming</a>(session, e-&gt;body.tsx_state.src.rdata,</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;            <a class="code" href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0">AST_SIP_SESSION_AFTER_MEDIA</a>);</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;      }</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;      <span class="keywordflow">if</span> (tsx-&gt;method.id == PJSIP_INVITE_METHOD) {</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;         <span class="keywordflow">if</span> (tsx-&gt;role == PJSIP_ROLE_UAC) {</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;            <span class="keywordflow">if</span> (tsx-&gt;state == PJSIP_TSX_STATE_COMPLETED) {</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;               <span class="comment">/* This means we got a non 2XX final response to our outgoing INVITE */</span></div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;               <span class="keywordflow">if</span> (tsx-&gt;status_code == PJSIP_SC_REQUEST_PENDING) {</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aee39c44155dc7a15414bdc64dc86127d">reschedule_reinvite</a>(session, cb);</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Non 2XX final response\n&quot;</span>);</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;               }</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;               <span class="keywordflow">if</span> (inv-&gt;state == PJSIP_INV_STATE_CONFIRMED) {</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: reINVITE received final response code %d\n&quot;</span>,</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;                     <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                     tsx-&gt;status_code);</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;                  <span class="keywordflow">if</span> ((tsx-&gt;status_code == 401 || tsx-&gt;status_code == 407)</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                     &amp;&amp; ++session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3539fdfd1818b8bcd20845575d624b2b">authentication_challenge_count</a> &lt; <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad20119f55c48a211b2a552abdcada8ea">MAX_RX_CHALLENGES</a></div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                     &amp;&amp; !<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a4810e8d609e3e1a5dd97faaca36d55ee">ast_sip_create_request_with_auth</a>(</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                        &amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>,</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;                        e-&gt;body.tsx_state.src.rdata, tsx-&gt;last_tx, &amp;tdata)) {</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                     <span class="comment">/* Send authed reINVITE */</span></div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                     <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a>(session, tdata, cb);</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Sending authed reinvite\n&quot;</span>);</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                  }</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                  <span class="comment">/* Per RFC3261 14.1 a response to a re-INVITE should only terminate</span></div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;<span class="comment">                   * the dialog if a 481 or 408 occurs. All other responses should leave</span></div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="comment">                   * the dialog untouched.</span></div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;                  <span class="keywordflow">if</span> (tsx-&gt;status_code == 481 || tsx-&gt;status_code == 408) {</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                     <span class="keywordflow">if</span> (pjsip_inv_end_session(inv, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                        &amp;&amp; tdata) {</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;                        <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a>(session, tdata);</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                     }</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                  }</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;               }</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tsx-&gt;state == PJSIP_TSX_STATE_TERMINATED) {</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;               <span class="keywordflow">if</span> (!inv-&gt;cancelling</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;                  &amp;&amp; inv-&gt;role == PJSIP_ROLE_UAC</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;                  &amp;&amp; inv-&gt;state == PJSIP_INV_STATE_CONFIRMED</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                  &amp;&amp; pjmedia_sdp_neg_was_answer_remote(inv-&gt;neg)</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;                  &amp;&amp; pjmedia_sdp_neg_get_state(inv-&gt;neg) == PJMEDIA_SDP_NEG_STATE_DONE</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                  &amp;&amp; (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) == <a class="code" href="../../d4/da3/causes_8h.html#a208e4fc34932b91fc9e90d9008329e87">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a>)</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;                  ) {</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;                  <span class="comment">/*</span></div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;<span class="comment">                   * We didn&#39;t send a CANCEL but the UAS sent us the 200 OK with an invalid or unacceptable codec SDP.</span></div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;<span class="comment">                   * In this case the SDP negotiation is incomplete and PJPROJECT has already sent the ACK.</span></div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;<span class="comment">                   * So, we send the BYE with 503 status code here. And the actual hangup cause code is already set</span></div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;<span class="comment">                   * to AST_CAUSE_BEARERCAPABILITY_NOTAVAIL by the session_inv_on_media_update(), setting the 503</span></div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;<span class="comment">                   * status code doesn&#39;t affect to hangup cause code.</span></div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Endpoint &#39;%s(%s)&#39;: Ending session due to 200 OK with incomplete SDP negotiation.  %s\n&quot;</span>,</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;                     <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>),</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;                     session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> ? <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;                     pjsip_rx_data_get_info(e-&gt;body.tsx_state.src.rdata));</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;                  pjsip_inv_end_session(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>, 503, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata);</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Incomplete SDP negotiation\n&quot;</span>);</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;               }</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;               <span class="keywordflow">if</span> (inv-&gt;cancelling &amp;&amp; tsx-&gt;status_code == PJSIP_SC_OK) {</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;                  <span class="keywordtype">int</span> sdp_negotiation_done =</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;                     pjmedia_sdp_neg_get_state(inv-&gt;neg) == PJMEDIA_SDP_NEG_STATE_DONE;</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;                  <span class="comment">/*</span></div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;<span class="comment">                   * We can get here for the following reasons.</span></div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;<span class="comment">                   *</span></div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;<span class="comment">                   * 1) The race condition detailed in RFC5407 section 3.1.2.</span></div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;<span class="comment">                   * We sent a CANCEL at the same time that the UAS sent us a</span></div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;<span class="comment">                   * 200 OK with a valid SDP for the original INVITE.  As a</span></div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;<span class="comment">                   * result, we have now received a 200 OK for a cancelled</span></div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="comment">                   * call and the SDP negotiation is complete.  We need to</span></div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;<span class="comment">                   * immediately send a BYE to end the dialog.</span></div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;<span class="comment">                   *</span></div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;<span class="comment">                   * 2) We sent a CANCEL and hit the race condition but the</span></div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;<span class="comment">                   * UAS sent us an invalid SDP with the 200 OK.  In this case</span></div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;<span class="comment">                   * the SDP negotiation is incomplete and PJPROJECT has</span></div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;<span class="comment">                   * already sent the BYE for us because of the invalid SDP.</span></div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;<span class="comment">                   */</span></div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;                  <a class="code" href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a>(<span class="stringliteral">&quot;PJSIP_SESSION_CANCELED&quot;</span>,</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;                     <span class="stringliteral">&quot;Endpoint: %s\r\n&quot;</span></div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;                     <span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;                     <span class="stringliteral">&quot;Message: %s\r\n&quot;</span></div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;                     <span class="stringliteral">&quot;SDP: %s&quot;</span>,</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;                     <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>),</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;                     session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> ? <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>) : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;                     pjsip_rx_data_get_info(e-&gt;body.tsx_state.src.rdata),</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;                     sdp_negotiation_done ? <span class="stringliteral">&quot;complete&quot;</span> : <span class="stringliteral">&quot;incomplete&quot;</span>);</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;                  <span class="keywordflow">if</span> (!sdp_negotiation_done) {</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: Incomplete SDP negotiation cancelled session.  %s\n&quot;</span>,</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;                        <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;                        pjsip_rx_data_get_info(e-&gt;body.tsx_state.src.rdata));</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjsip_inv_end_session(inv, 500, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;                     &amp;&amp; tdata) {</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: Ending session due to RFC5407 race condition.  %s\n&quot;</span>,</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;                        <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;                        pjsip_rx_data_get_info(e-&gt;body.tsx_state.src.rdata));</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;                     <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a>(session, tdata);</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;                  }</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;               }</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;            }</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;         }</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;         <span class="comment">/* All other methods */</span></div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;         <span class="keywordflow">if</span> (tsx-&gt;role == PJSIP_ROLE_UAC) {</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;            <span class="keywordflow">if</span> (tsx-&gt;state == PJSIP_TSX_STATE_COMPLETED) {</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;               <span class="comment">/* This means we got a final response to our outgoing method */</span></div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s: %.*s received final response code %d\n&quot;</span>,</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                  (<span class="keywordtype">int</span>) pj_strlen(&amp;tsx-&gt;method.name), pj_strbuf(&amp;tsx-&gt;method.name),</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                  tsx-&gt;status_code);</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;               <span class="keywordflow">if</span> ((tsx-&gt;status_code == 401 || tsx-&gt;status_code == 407)</div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;                  &amp;&amp; ++session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3539fdfd1818b8bcd20845575d624b2b">authentication_challenge_count</a> &lt; <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ad20119f55c48a211b2a552abdcada8ea">MAX_RX_CHALLENGES</a></div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;                  &amp;&amp; !<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a4810e8d609e3e1a5dd97faaca36d55ee">ast_sip_create_request_with_auth</a>(</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;                     &amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">outbound_auths</a>,</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;                     e-&gt;body.tsx_state.src.rdata, tsx-&gt;last_tx, &amp;tdata)) {</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;                  <span class="comment">/* Send authed version of the method */</span></div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a>(session, tdata, cb);</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Sending authed %.*s\n&quot;</span>,</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;                     (<span class="keywordtype">int</span>) pj_strlen(&amp;tsx-&gt;method.name), pj_strbuf(&amp;tsx-&gt;method.name));</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;               }</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;            }</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;         }</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;      }</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      <span class="keywordflow">if</span> (cb) {</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;         cb(session, e-&gt;body.tsx_state.src.rdata);</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;      }</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TRANSPORT_ERROR:</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TIMER:</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;<span class="comment">       * The timer event is run by the pjsip monitor thread and not</span></div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="comment">       * by the session serializer.</span></div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#afe9c8de50ba0b0f1ab0c6a46d914e726">session_end_if_disconnected</a>(<span class="keywordtype">id</span>, inv)) {</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Disconnected\n&quot;</span>);</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;      }</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_USER:</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_UNKNOWN:</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;   <span class="keywordflow">case</span> PJSIP_EVENT_TSX_STATE:</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;      <span class="comment">/* Inception? */</span></div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;   }</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>)) {</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;      <span class="comment">/* No delayed request pending, so just return */</span></div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>(<span class="stringliteral">&quot;Nothing delayed\n&quot;</span>);</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;   }</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;   <span class="keywordflow">if</span> (tsx-&gt;method.id == PJSIP_INVITE_METHOD) {</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;      <span class="keywordflow">if</span> (tsx-&gt;state == PJSIP_TSX_STATE_PROCEEDING) {</div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: INVITE delay check. tsx-state:%s\n&quot;</span>,</div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;            pjsip_tsx_state_str(tsx-&gt;state));</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae2c628c905cb48254948233bf6b13e9a">check_delayed_requests</a>(session, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ab41b92c23f551a348423f5c0721d963a">invite_proceeding</a>);</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tsx-&gt;state == PJSIP_TSX_STATE_TERMINATED) {</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;<span class="comment">          * Terminated INVITE transactions always should result in</span></div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;<span class="comment">          * queuing delayed requests, no matter what event caused</span></div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;<span class="comment">          * the transaction to terminate.</span></div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: INVITE delay check. tsx-state:%s\n&quot;</span>,</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;            pjsip_tsx_state_str(tsx-&gt;state));</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae2c628c905cb48254948233bf6b13e9a">check_delayed_requests</a>(session, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a70774e88c7455a8dae6a9b8878916abd">invite_terminated</a>);</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;      }</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tsx-&gt;role == PJSIP_ROLE_UAC</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;      &amp;&amp; tsx-&gt;state == PJSIP_TSX_STATE_COMPLETED</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;      &amp;&amp; !pj_strcmp2(&amp;tsx-&gt;method.name, <span class="stringliteral">&quot;UPDATE&quot;</span>)) {</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: UPDATE delay check. tsx-state:%s\n&quot;</span>,</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;         pjsip_tsx_state_str(tsx-&gt;state));</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae2c628c905cb48254948233bf6b13e9a">check_delayed_requests</a>(session, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#accef4530d306b2c1be2026b84f9f4327">update_completed</a>);</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;   }</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>();</div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aee39c44155dc7a15414bdc64dc86127d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aee39c44155dc7a15414bdc64dc86127d">reschedule_reinvite</a></div><div class="ttdeci">static void reschedule_reinvite(struct ast_sip_session *session, ast_sip_session_response_cb on_response)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04269">res_pjsip_session.c:4269</a></div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a83e35cdda0bf863afb19d1d954f309e5"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a></div><div class="ttdeci">int(* ast_sip_session_response_cb)(struct ast_sip_session *session, pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00247">res_pjsip_session.h:247</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a067e52198c90bacbde0918721c8a8440"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a067e52198c90bacbde0918721c8a8440">print_debug_details</a></div><div class="ttdeci">#define print_debug_details(inv, tsx, e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04396">res_pjsip_session.c:4396</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a045e92a13d3f4b1e0d061b4b6e64f1e1"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a045e92a13d3f4b1e0d061b4b6e64f1e1">ast_sip_endpoint::outbound_auths</a></div><div class="ttdeci">struct ast_sip_auth_vector outbound_auths</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00855">res_pjsip.h:855</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a929623f98bee0fc9eb242c0bce08d227"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a929623f98bee0fc9eb242c0bce08d227">MOD_DATA_ON_RESPONSE</a></div><div class="ttdeci">#define MOD_DATA_ON_RESPONSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00057">res_pjsip_session.c:57</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4a1884cde93e53bef32ca85c194a1d05"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a></div><div class="ttdeci">#define AST_LIST_EMPTY(head)</div><div class="ttdoc">Checks whether the specified list contains any entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00449">linkedlists.h:449</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a70774e88c7455a8dae6a9b8878916abd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a70774e88c7455a8dae6a9b8878916abd">invite_terminated</a></div><div class="ttdeci">static int invite_terminated(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">res_pjsip_session.c:1487</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae2c628c905cb48254948233bf6b13e9a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae2c628c905cb48254948233bf6b13e9a">check_delayed_requests</a></div><div class="ttdeci">static void check_delayed_requests(struct ast_sip_session *session, int(*cb)(void *vsession))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01582">res_pjsip_session.c:1582</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae8a19b2f0b2cac772a583a0d31fa434b"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae8a19b2f0b2cac772a583a0d31fa434b">handle_incoming</a></div><div class="ttdeci">static int handle_incoming(struct ast_sip_session *session, pjsip_rx_data *rdata, enum ast_sip_session_response_priority response_priority)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04469">res_pjsip_session.c:4469</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a4810e8d609e3e1a5dd97faaca36d55ee"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a4810e8d609e3e1a5dd97faaca36d55ee">ast_sip_create_request_with_auth</a></div><div class="ttdeci">int ast_sip_create_request_with_auth(const struct ast_sip_auth_vector *auths, pjsip_rx_data *challenge, pjsip_tx_data *tdata, pjsip_tx_data **new_request)</div><div class="ttdoc">Create a response to an authentication challenge. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03412">res_pjsip.c:3412</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aad194ead974937834375b0ac8d37a7c2"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a></div><div class="ttdeci">#define ast_sip_mod_data_get(mod_data, id, key)</div><div class="ttdoc">Using the dictionary stored in mod_data array at a given id, retrieve the value associated with the g...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02638">res_pjsip.h:2638</a></div></div>
<div class="ttc" id="test_8h_html_a9482d93ea3931853331bdbc745ce7cb4"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a9482d93ea3931853331bdbc745ce7cb4">ast_test_suite_event_notify</a></div><div class="ttdeci">#define ast_test_suite_event_notify(s, f,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00196">test.h:196</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ab41b92c23f551a348423f5c0721d963a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ab41b92c23f551a348423f5c0721d963a">invite_proceeding</a></div><div class="ttdeci">static int invite_proceeding(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">res_pjsip_session.c:1440</a></div></div>
<div class="ttc" id="asterisk_8h_html_a0eb0441c04955094ce5845fb0258645a"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a0eb0441c04955094ce5845fb0258645a">ast_shutdown_final</a></div><div class="ttdeci">int ast_shutdown_final(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01829">asterisk.c:1829</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ad20119f55c48a211b2a552abdcada8ea"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ad20119f55c48a211b2a552abdcada8ea">MAX_RX_CHALLENGES</a></div><div class="ttdeci">#define MAX_RX_CHALLENGES</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00080">res_pjsip.h:80</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_afe9c8de50ba0b0f1ab0c6a46d914e726"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#afe9c8de50ba0b0f1ab0c6a46d914e726">session_end_if_disconnected</a></div><div class="ttdeci">static int session_end_if_disconnected(int id, pjsip_inv_session *inv)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04701">res_pjsip_session.c:4701</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="res__pjsip__session_8h_html_a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0"><div class="ttname"><a href="../../d9/de7/res__pjsip__session_8h.html#a7c6e261e955a17cce047bc3080fae195adde0ab4f7a7d2ee3cfacf951e8ccd2d0">AST_SIP_SESSION_AFTER_MEDIA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00277">res_pjsip_session.h:277</a></div></div>
<div class="ttc" id="channel_8h_html_aa04afa262d7e1b211ee32d17c949a275"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa04afa262d7e1b211ee32d17c949a275">ast_channel_hangupcause</a></div><div class="ttdeci">int ast_channel_hangupcause(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00427">channel_internal_api.c:427</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6e71dd1b8a6901e044953ff9e3a0343d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a></div><div class="ttdeci">void ast_sip_session_send_request_with_cb(struct ast_sip_session *session, pjsip_tx_data *tdata, ast_sip_session_response_cb on_response)</div><div class="ttdoc">Send a SIP request and get called back when a response is received. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">res_pjsip_session.c:2818</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3539fdfd1818b8bcd20845575d624b2b"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3539fdfd1818b8bcd20845575d624b2b">ast_sip_session::authentication_challenge_count</a></div><div class="ttdeci">unsigned int authentication_challenge_count</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00239">res_pjsip_session.h:239</a></div></div>
<div class="ttc" id="app__queue_8c_html_acd1f0e9b4730ec60f62cb0806cb06ef1"><div class="ttname"><a href="../../da/dfb/app__queue_8c.html#acd1f0e9b4730ec60f62cb0806cb06ef1">id</a></div><div class="ttdeci">enum queue_result id</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfb/app__queue_8c_source.html#l01507">app_queue.c:1507</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a35a7aa9427f3aea9384c1a481ce6a5f3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a35a7aa9427f3aea9384c1a481ce6a5f3">ast_sip_session_send_request</a></div><div class="ttdeci">void ast_sip_session_send_request(struct ast_sip_session *session, pjsip_tx_data *tdata)</div><div class="ttdoc">Send a SIP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02842">res_pjsip_session.c:2842</a></div></div>
<div class="ttc" id="causes_8h_html_a208e4fc34932b91fc9e90d9008329e87"><div class="ttname"><a href="../../d4/da3/causes_8h.html#a208e4fc34932b91fc9e90d9008329e87">AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</a></div><div class="ttdeci">#define AST_CAUSE_BEARERCAPABILITY_NOTAVAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/da3/causes_8h_source.html#l00129">causes.h:129</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_accef4530d306b2c1be2026b84f9f4327"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#accef4530d306b2c1be2026b84f9f4327">update_completed</a></div><div class="ttdeci">static int update_completed(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01568">res_pjsip_session.c:1568</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a1020cea0d78fe4969869c10fd93973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a1020cea0d78fe4969869c10fd93973">&#9670;&nbsp;</a></span>session_media_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_media_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">469</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01716">ao2_callback</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d4/d3c/sdp__srtp_8c_source.html#l00051">ast_sdp_srtp_destroy()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00125">ast_sip_session_media::remote_label</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00123">ast_sip_session_media::remote_mslabel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00085">ast_sip_session_media::srtp</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00456">stream_destroy()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00127">ast_sip_session_media::stream_name</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00490">ast_sip_session_media_state_add()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05536">test_media_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;{</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = obj;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="comment">/* It is possible for multiple handlers to have allocated memory on the</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">    * session media (usually through a stream changing types). Therefore, we</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">    * traverse all the SDP handlers and let them all call stream_destroy on</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">    * the session_media</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, 0, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#af7feb7dfdc1b1c6d0684931bfc7c5cfe">stream_destroy</a>, session_media);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a2f87df48a0208ce2b1108d0135e09a72">srtp</a>) {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <a class="code" href="../../de/d5f/sdp__srtp_8h.html#ac247402b4ff033a7973ef7fde92568a0">ast_sdp_srtp_destroy</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a2f87df48a0208ce2b1108d0135e09a72">srtp</a>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a70e1508d190eb74f9da879ad5bd371d9">remote_label</a>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">stream_name</a>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_af7feb7dfdc1b1c6d0684931bfc7c5cfe"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#af7feb7dfdc1b1c6d0684931bfc7c5cfe">stream_destroy</a></div><div class="ttdeci">static int stream_destroy(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00456">res_pjsip_session.c:456</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3a6b074b7eab19c35ccf9ef22fb8e316"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3a6b074b7eab19c35ccf9ef22fb8e316">ast_sip_session_media::stream_name</a></div><div class="ttdeci">char * stream_name</div><div class="ttdoc">Stream name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00127">res_pjsip_session.h:127</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a2f87df48a0208ce2b1108d0135e09a72"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a2f87df48a0208ce2b1108d0135e09a72">ast_sip_session_media::srtp</a></div><div class="ttdeci">struct ast_sdp_srtp * srtp</div><div class="ttdoc">Holds SRTP information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00085">res_pjsip_session.h:85</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a99eb7597d759e980c36f446c252c1aa0"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">ast_sip_session_media::remote_mslabel</a></div><div class="ttdeci">char * remote_mslabel</div><div class="ttdoc">Remote media stream label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00123">res_pjsip_session.h:123</a></div></div>
<div class="ttc" id="sdp__srtp_8h_html_ac247402b4ff033a7973ef7fde92568a0"><div class="ttname"><a href="../../de/d5f/sdp__srtp_8h.html#ac247402b4ff033a7973ef7fde92568a0">ast_sdp_srtp_destroy</a></div><div class="ttdeci">void ast_sdp_srtp_destroy(struct ast_sdp_srtp *srtp)</div><div class="ttdoc">free a ast_sdp_srtp structure </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3c/sdp__srtp_8c_source.html#l00051">sdp_srtp.c:51</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a70e1508d190eb74f9da879ad5bd371d9"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a70e1508d190eb74f9da879ad5bd371d9">ast_sip_session_media::remote_label</a></div><div class="ttdeci">char * remote_label</div><div class="ttdoc">Remote stream label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00125">res_pjsip_session.h:125</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a547f07821c13f67174cb535888d98c0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a547f07821c13f67174cb535888d98c0c">&#9670;&nbsp;</a></span>session_media_set_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_media_set_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set an SDP stream handler for a corresponding session media. </p>
<dl class="section note"><dt>Note</dt><dd>Always use this function to set the SDP handler for a session media.</dd></dl>
<p>This function will properly free resources on the SDP handler currently being used by the session media, then set the session media to use the new SDP handler. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00445">445</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">ast_sip_session_media::handler</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00458">ast_sip_session_sdp_handler::stream_destroy</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04957">add_sdp_streams()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01063">handle_negotiated_sdp()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>.</p>
<div class="fragment"><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;{</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a> != handler);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordflow">if</span> (session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a>-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a679b31623d9592818d5713da9a768d61">stream_destroy</a>(session_media);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   }</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">handler</a> = <a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div><div class="ttc" id="structast__sip__session__sdp__handler_html_a679b31623d9592818d5713da9a768d61"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#a679b31623d9592818d5713da9a768d61">ast_sip_session_sdp_handler::stream_destroy</a></div><div class="ttdeci">void(* stream_destroy)(struct ast_sip_session_media *session_media)</div><div class="ttdoc">Destroy a session_media created by this handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00458">res_pjsip_session.h:458</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a3b66ccd874aa8ba900ad09f9fb12717d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a3b66ccd874aa8ba900ad09f9fb12717d">ast_sip_session_media::handler</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * handler</div><div class="ttdoc">SDP handler that setup the RTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00083">res_pjsip_session.h:83</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e8c771a73013db7cff9add152ed684a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e8c771a73013db7cff9add152ed684a">&#9670;&nbsp;</a></span>session_on_rx_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t session_on_rx_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called when a new SIP request comes into PJSIP. </p>
<p>This function is called under two circumstances 1) An out-of-dialog request is received by PJSIP 2) An in-dialog request that the inv_session layer does not handle is received (such as an in-dialog INFO)</p>
<p>Except for INVITEs, there is very little we actually do in this function 1) For requests we don't handle, we return PJ_FALSE 2) For new INVITEs, handle them now to prevent retransmissions from trying to setup the same call again. 3) For in-dialog requests we handle, we process them in the .on_state_changed = session_inv_on_state_changed or .on_tsx_state_changed = session_inv_on_tsx_state_changed callbacks instead. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04215">4215</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">handle_new_invite_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04142">has_supplement()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00637">TRACE_ATLEAST</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">ast_sip_session_send_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;{</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;   pj_status_t handled = PJ_FALSE;</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;   <span class="keyword">struct </span>pjsip_request_line req = rdata-&gt;msg_info.msg-&gt;line.req;</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;   pjsip_dialog *dlg = pjsip_rdata_get_dlg(rdata);</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;   pjsip_inv_session *inv_session = (dlg ? pjsip_dlg_get_inv_session(dlg) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = (inv_session ? inv_session-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id] : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;   <span class="keywordtype">char</span> *req_uri = <a class="code" href="../../d1/d8c/logger_8h.html#a57001f3d33d960dec79dee782b6229a8">TRACE_ATLEAST</a>(1) ? <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(256) : <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;   <span class="keywordtype">int</span> res = <a class="code" href="../../d1/d8c/logger_8h.html#a57001f3d33d960dec79dee782b6229a8">TRACE_ATLEAST</a>(1) ? pjsip_uri_print(PJSIP_URI_IN_REQ_URI, rdata-&gt;msg_info.msg-&gt;line.req.uri, req_uri, 256) : 0;</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Request: %.*s %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;      (<span class="keywordtype">int</span>) pj_strlen(&amp;req.method.name), pj_strbuf(&amp;req.method.name), res ? req_uri : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;   <span class="keywordflow">switch</span> (req.method.id) {</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;   <span class="keywordflow">case</span> PJSIP_INVITE_METHOD:</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;      <span class="keywordflow">if</span> (dlg) {</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;on_rx_request called for INVITE in mid-dialog?\n&quot;</span>);</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;      }</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;      handled = PJ_TRUE;</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a4dfc090cd99367d160beb9518970c0e3">handle_new_invite_request</a>(rdata);</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;      <span class="comment">/* Handle other in-dialog methods if their supplements have been registered */</span></div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;      handled = dlg &amp;&amp; (inv_session = pjsip_dlg_get_inv_session(dlg)) &amp;&amp;</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ade348d7dc427f391b1e1d86e23cd614c">has_supplement</a>(inv_session-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id], rdata);</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;   }</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(handled, <span class="stringliteral">&quot;%s Handled request %.*s %s ? %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;      (<span class="keywordtype">int</span>) pj_strlen(&amp;req.method.name), pj_strbuf(&amp;req.method.name), req_uri,</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;      handled == PJ_TRUE ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;}</div><div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ade348d7dc427f391b1e1d86e23cd614c"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ade348d7dc427f391b1e1d86e23cd614c">has_supplement</a></div><div class="ttdeci">static pj_bool_t has_supplement(const struct ast_sip_session *session, const pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04142">res_pjsip_session.c:4142</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="logger_8h_html_a57001f3d33d960dec79dee782b6229a8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57001f3d33d960dec79dee782b6229a8">TRACE_ATLEAST</a></div><div class="ttdeci">#define TRACE_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00637">logger.h:637</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a4dfc090cd99367d160beb9518970c0e3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a4dfc090cd99367d160beb9518970c0e3">handle_new_invite_request</a></div><div class="ttdeci">static void handle_new_invite_request(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l04050">res_pjsip_session.c:4050</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae0fa0b18110b8d1525e69d1301846c0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0fa0b18110b8d1525e69d1301846c0f">&#9670;&nbsp;</a></span>session_on_rx_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t session_on_rx_response </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04185">4185</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, and <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">ast_sip_session_send_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;{</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;   <span class="keyword">struct </span>pjsip_status_line <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a> = rdata-&gt;msg_info.msg-&gt;line.status;</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;   pjsip_dialog *dlg = pjsip_rdata_get_dlg(rdata);</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;   pjsip_inv_session *inv_session = dlg ? pjsip_dlg_get_inv_session(dlg) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = (inv_session ? inv_session-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id] : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s Method: %.*s Status: %d\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;      (<span class="keywordtype">int</span>)rdata-&gt;msg_info.cseq-&gt;method.name.slen, rdata-&gt;msg_info.cseq-&gt;method.name.ptr, status.code);</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(PJ_FALSE);</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0a65ae9b174424d52db92d6dc8f243f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0a65ae9b174424d52db92d6dc8f243f">&#9670;&nbsp;</a></span>session_on_tsx_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_on_tsx_state </td>
          <td>(</td>
          <td class="paramtype">pjsip_transaction *&#160;</td>
          <td class="paramname"><em>tsx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pjsip_event *&#160;</td>
          <td class="paramname"><em>e</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04163">4163</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00936">ast_stream_topology_to_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00854">SCOPE_EXIT_RTN</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02576">ast_sip_session_send_response()</a>.</p>
<div class="fragment"><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;{</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;   pjsip_dialog *dlg = pjsip_tsx_get_dlg(tsx);</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;   pjsip_inv_session *<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a> = (dlg ? pjsip_dlg_get_inv_session(dlg) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = (inv_session ? inv_session-&gt;mod_data[<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id] : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(1, <span class="stringliteral">&quot;%s TSX State: %s  Inv State: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;         pjsip_tsx_state_str(tsx-&gt;state), inv_session ? pjsip_inv_state_name(inv_session-&gt;state) : <span class="stringliteral">&quot;unknown&quot;</span>);</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;   <span class="keywordflow">if</span> (session) {</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(2, <span class="stringliteral">&quot;Topology: Pending: %s  Active: %s\n&quot;</span>,</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)),</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;   }</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a>();</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="stream_8h_html_a3da8d8e63718c47d43b9e738c7f6e55a"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a></div><div class="ttdeci">const char * ast_stream_topology_to_str(const struct ast_stream_topology *topology, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the topology for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00936">stream.c:936</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="logger_8h_html_a519e9e626663d0bf89c04738e0353a9d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a519e9e626663d0bf89c04738e0353a9d">SCOPE_EXIT_RTN</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN(...)</div><div class="ttdoc">Scope Exit with return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00854">logger.h:854</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af218de4dc85933870fdfe1d91af9261e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af218de4dc85933870fdfe1d91af9261e">&#9670;&nbsp;</a></span>session_outgoing_nat_hook()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_outgoing_nat_hook </td>
          <td>(</td>
          <td class="paramtype">pjsip_tx_data *&#160;</td>
          <td class="paramname"><em>tdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/d04/structast__sip__transport.html">ast_sip_transport</a> *&#160;</td>
          <td class="paramname"><em>transport</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hook for modifying outgoing messages with SDP to contain the proper address information. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05457">5457</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01756">ao2_find</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03630">ast_sip_dialog_get_session()</a>, <a class="el" href="../../d3/d17/config__transport_8c_source.html#l01564">ast_sip_get_transport_state()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05259">ast_sip_is_content_type()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02638">ast_sip_mod_data_get</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l02670">ast_sip_mod_data_set</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00165">ast_sip_transport_is_local</a>, <a class="el" href="../../d4/d27/netsock2_8c_source.html#l00230">ast_sockaddr_parse()</a>, <a class="el" href="../../db/df1/netsock2_8h_source.html#l00331">ast_sockaddr_stringify_host()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00431">ast_sip_session_sdp_handler::change_outgoing_sdp_stream_media_address</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00191">ast_sip_transport::external_media_address</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d0/d8a/muted_8c_source.html#l00077">host</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00058">MOD_DATA_NAT_HOOK</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">ast_sip_session_sdp_handler::next</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01155">OBJ_KEY</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01135">PARSE_PORT_FORBID</a>, and <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06074">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;{</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../db/dac/structast__sip__transport__state.html">ast_sip_transport_state</a> *, transport_state, <a class="code" href="../../d8/d8c/res__pjsip_8h.html#ab6000ab7fe69594070bb59b995ccb5ee">ast_sip_get_transport_state</a>(<a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(transport)), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/dfb/structast__sip__nat__hook.html">ast_sip_nat_hook</a> *hook = <a class="code" href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a>(</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;      tdata-&gt;mod_data, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad52575b22f1c0988077001bd1cd37db0">MOD_DATA_NAT_HOOK</a>);</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;   <span class="keyword">struct </span>pjmedia_sdp_session *sdp;</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;   pjsip_dialog *dlg = pjsip_tdata_get_dlg(tdata);</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, dlg ? <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a908cdf7ba25c4d6f3d2efdf01f0125ca">ast_sip_dialog_get_session</a>(dlg) : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;   <span class="keywordtype">int</span> stream;</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;   <span class="comment">/* SDP produced by us directly will never be multipart */</span></div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;   <span class="keywordflow">if</span> (!transport_state || hook || !tdata-&gt;msg-&gt;body ||</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;      !<a class="code" href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a>(&amp;tdata-&gt;msg-&gt;body-&gt;content_type, <span class="stringliteral">&quot;application&quot;</span>, <span class="stringliteral">&quot;sdp&quot;</span>) ||</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(transport-&gt;<a class="code" href="../../d1/d04/structast__sip__transport.html#aafb26f286f23cda0930351614b6a7a3a">external_media_address</a>)) {</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;   }</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;   sdp = tdata-&gt;msg-&gt;body-&gt;data;</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;</div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;   <span class="keywordflow">if</span> (sdp-&gt;conn) {</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../d0/d8a/muted_8c.html#a41c3a180b50c6b2ddcc1b6843a48f205">host</a>[NI_MAXHOST];</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> our_sdp_addr = { { 0, } };</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(host, &amp;sdp-&gt;conn-&gt;addr, <span class="keyword">sizeof</span>(host));</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#aad98818272870e12d48fe4347aaa46d0">ast_sockaddr_parse</a>(&amp;our_sdp_addr, host, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa42789f26318ec8def793a3df3a35efe3">PARSE_PORT_FORBID</a>);</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;      <span class="comment">/* Reversed check here. We don&#39;t check the remote</span></div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;<span class="comment">       * endpoint being in our local net, but whether our</span></div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;<span class="comment">       * outgoing session IP is local. If it is, we&#39;ll do</span></div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;<span class="comment">       * rewriting. No localnet configured? Always rewrite. */</span></div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#af1f1558eb7c730d0f51b7832568c9c90">ast_sip_transport_is_local</a>(transport_state, &amp;our_sdp_addr) || !transport_state-&gt;localnet) {</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;%s: Setting external media address to %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>),</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;            <a class="code" href="../../db/df1/netsock2_8h.html#a7803a01afa4404e275a2fac3c91bf7e8">ast_sockaddr_stringify_host</a>(&amp;transport_state-&gt;external_media_address));</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;         pj_strdup2(tdata-&gt;pool, &amp;sdp-&gt;conn-&gt;addr, <a class="code" href="../../db/df1/netsock2_8h.html#a7803a01afa4404e275a2fac3c91bf7e8">ast_sockaddr_stringify_host</a>(&amp;transport_state-&gt;external_media_address));</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;         pj_strassign(&amp;sdp-&gt;origin.addr, &amp;sdp-&gt;conn-&gt;addr);</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;      }</div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;   }</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;   <span class="keywordflow">for</span> (stream = 0; stream &lt; sdp-&gt;media_count; ++stream) {</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;      <span class="comment">/* See if there are registered handlers for this media stream type */</span></div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;      <span class="keywordtype">char</span> media[20];</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *, handler_list, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;      <span class="comment">/* We need a null-terminated version of the media string */</span></div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(media, &amp;sdp-&gt;media[stream]-&gt;desc.media, <span class="keyword">sizeof</span>(media));</div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;      handler_list = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>, media, <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>);</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;      <span class="keywordflow">if</span> (!handler_list) {</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;%s: No registered SDP handlers for media type &#39;%s&#39;\n&quot;</span>,  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>),</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;            media);</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;      }</div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;list, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>) {</div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;         <span class="keywordflow">if</span> (handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#ae53937268cc800155e6831445051084c">change_outgoing_sdp_stream_media_address</a>) {</div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;            handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#ae53937268cc800155e6831445051084c">change_outgoing_sdp_stream_media_address</a>(tdata, sdp-&gt;media[stream], transport);</div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;         }</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;      }</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;   }</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;   <span class="comment">/* We purposely do this so that the hook will not be invoked multiple times, ie: if a retransmit occurs */</span></div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a>(tdata-&gt;pool, tdata-&gt;mod_data, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>.id, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad52575b22f1c0988077001bd1cd37db0">MOD_DATA_NAT_HOOK</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a>);</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a908cdf7ba25c4d6f3d2efdf01f0125ca"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a908cdf7ba25c4d6f3d2efdf01f0125ca">ast_sip_dialog_get_session</a></div><div class="ttdeci">struct ast_sip_session * ast_sip_dialog_get_session(pjsip_dialog *dlg)</div><div class="ttdoc">Retrieves a session from a dialog. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03630">res_pjsip_session.c:3630</a></div></div>
<div class="ttc" id="netsock2_8h_html_aad98818272870e12d48fe4347aaa46d0"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aad98818272870e12d48fe4347aaa46d0">ast_sockaddr_parse</a></div><div class="ttdeci">int ast_sockaddr_parse(struct ast_sockaddr *addr, const char *str, int flags)</div><div class="ttdoc">Parse an IPv4 or IPv6 address string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d27/netsock2_8c_source.html#l00230">netsock2.c:230</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="structast__sip__transport_html_aafb26f286f23cda0930351614b6a7a3a"><div class="ttname"><a href="../../d1/d04/structast__sip__transport.html#aafb26f286f23cda0930351614b6a7a3a">ast_sip_transport::external_media_address</a></div><div class="ttdeci">const ast_string_field external_media_address</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00191">res_pjsip.h:191</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_ae53937268cc800155e6831445051084c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#ae53937268cc800155e6831445051084c">ast_sip_session_sdp_handler::change_outgoing_sdp_stream_media_address</a></div><div class="ttdeci">void(* change_outgoing_sdp_stream_media_address)(struct pjsip_tx_data *tdata, struct pjmedia_sdp_media *stream, struct ast_sip_transport *transport)</div><div class="ttdoc">Update media stream with external address if applicable. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00431">res_pjsip_session.h:431</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a75076a42e720601f2234ac8a927ea4f9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a></div><div class="ttdeci">static struct ast_sip_nat_hook * nat_hook</div><div class="ttdoc">NAT hook for modifying outgoing messages with SDP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00084">res_pjsip_session.c:84</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad60d9d8c34b4f61493c1d85ae02d569fa42789f26318ec8def793a3df3a35efe3"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa42789f26318ec8def793a3df3a35efe3">PARSE_PORT_FORBID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01135">include/asterisk/config.h:1135</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sockaddr_html"><div class="ttname"><a href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a></div><div class="ttdoc">Socket address structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00097">netsock2.h:97</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="structast__sip__nat__hook_html"><div class="ttname"><a href="../../d3/dfb/structast__sip__nat__hook.html">ast_sip_nat_hook</a></div><div class="ttdoc">Structure for SIP nat hook information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00271">res_pjsip.h:271</a></div></div>
<div class="ttc" id="muted_8c_html_a41c3a180b50c6b2ddcc1b6843a48f205"><div class="ttname"><a href="../../d0/d8a/muted_8c.html#a41c3a180b50c6b2ddcc1b6843a48f205">host</a></div><div class="ttdeci">static char host[256]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8a/muted_8c_source.html#l00077">muted.c:77</a></div></div>
<div class="ttc" id="structast__sip__transport__state_html"><div class="ttname"><a href="../../db/dac/structast__sip__transport__state.html">ast_sip_transport_state</a></div><div class="ttdoc">Structure for SIP transport information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00087">res_pjsip.h:87</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aaa4f9cdda5dd0b1270fb35523054926c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">ast_sip_session_sdp_handler::next</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">res_pjsip_session.h:460</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a9937f98867d28da0cc0e8590d9c9ffa4"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a9937f98867d28da0cc0e8590d9c9ffa4">ast_sip_mod_data_set</a></div><div class="ttdeci">#define ast_sip_mod_data_set(pool, mod_data, id, key, val)</div><div class="ttdoc">Utilizing a mod_data array for a given id, set the value associated with the given key...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02670">res_pjsip.h:2670</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_aad194ead974937834375b0ac8d37a7c2"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#aad194ead974937834375b0ac8d37a7c2">ast_sip_mod_data_get</a></div><div class="ttdeci">#define ast_sip_mod_data_get(mod_data, id, key)</div><div class="ttdoc">Using the dictionary stored in mod_data array at a given id, retrieve the value associated with the g...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l02638">res_pjsip.h:2638</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ae47a39537fdf10ceba2fad9d9c380179"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ae47a39537fdf10ceba2fad9d9c380179">ast_sip_is_content_type</a></div><div class="ttdeci">int ast_sip_is_content_type(pjsip_media_type *content_type, char *type, char *subtype)</div><div class="ttdoc">Checks if the given content type matches type/subtype. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05259">res_pjsip.c:5259</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_af1f1558eb7c730d0f51b7832568c9c90"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#af1f1558eb7c730d0f51b7832568c9c90">ast_sip_transport_is_local</a></div><div class="ttdeci">#define ast_sip_transport_is_local(transport_state, addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00165">res_pjsip.h:165</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_ab6000ab7fe69594070bb59b995ccb5ee"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#ab6000ab7fe69594070bb59b995ccb5ee">ast_sip_get_transport_state</a></div><div class="ttdeci">struct ast_sip_transport_state * ast_sip_get_transport_state(const char *transport_id)</div><div class="ttdoc">Retrieve transport state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d17/config__transport_8c_source.html#l01564">config_transport.c:1564</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad52575b22f1c0988077001bd1cd37db0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad52575b22f1c0988077001bd1cd37db0">MOD_DATA_NAT_HOOK</a></div><div class="ttdeci">#define MOD_DATA_NAT_HOOK</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00058">res_pjsip_session.c:58</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="netsock2_8h_html_a7803a01afa4404e275a2fac3c91bf7e8"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#a7803a01afa4404e275a2fac3c91bf7e8">ast_sockaddr_stringify_host</a></div><div class="ttdeci">static char * ast_sockaddr_stringify_host(const struct ast_sockaddr *addr)</div><div class="ttdoc">Wrapper around ast_sockaddr_stringify_fmt() to return an address only, suitable for a URL (with brack...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00331">netsock2.h:331</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24f0a675880777396a49d0da4b96ec06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f0a675880777396a49d0da4b96ec06">&#9670;&nbsp;</a></span>session_reinvite_on_rx_request()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static pj_bool_t session_reinvite_on_rx_request </td>
          <td>(</td>
          <td class="paramtype">pjsip_rx_data *&#160;</td>
          <td class="paramname"><em>rdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02733">2733</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03630">ast_sip_dialog_get_session()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00219">ast_sip_session::deferred_reinvite</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">sdp_requires_deferral()</a>.</p>
<div class="fragment"><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;{</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;   pjsip_dialog *dlg;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *, <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;   pjsip_rdata_sdp_info *sdp_info;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;   <span class="keywordtype">int</span> deferred;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;   <span class="keywordflow">if</span> (rdata-&gt;msg_info.msg-&gt;line.req.method.id != PJSIP_INVITE_METHOD ||</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;      !(dlg = pjsip_ua_find_dialog(&amp;rdata-&gt;msg_info.cid-&gt;id, &amp;rdata-&gt;msg_info.to-&gt;tag, &amp;rdata-&gt;msg_info.from-&gt;tag, PJ_FALSE)) ||</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      !(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a908cdf7ba25c4d6f3d2efdf01f0125ca">ast_sip_dialog_get_session</a>(dlg)) ||</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      !<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;channel) {</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   }</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;inv_session-&gt;invite_tsx) {</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="comment">/* There&#39;s a transaction in progress so bail now and let pjproject send 491 */</span></div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;   }</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;deferred_reinvite) {</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      pj_str_t key, deferred_key;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;      pjsip_tx_data *tdata;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;      <span class="comment">/* We use memory from the new request on purpose so the deferred reinvite pool does not grow uncontrollably */</span></div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      pjsip_tsx_create_key(rdata-&gt;tp_info.pool, &amp;key, PJSIP_ROLE_UAS, &amp;rdata-&gt;msg_info.cseq-&gt;method, rdata);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      pjsip_tsx_create_key(rdata-&gt;tp_info.pool, &amp;deferred_key, PJSIP_ROLE_UAS, &amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;deferred_reinvite-&gt;msg_info.cseq-&gt;method,</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;         <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;deferred_reinvite);</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="comment">/* If this is a retransmission ignore it */</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <span class="keywordflow">if</span> (!pj_strcmp(&amp;key, &amp;deferred_key)) {</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;         <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      }</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;      <span class="comment">/* Otherwise this is a new re-invite, so reject it */</span></div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;      <span class="keywordflow">if</span> (pjsip_dlg_create_response(dlg, rdata, 491, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;tdata) == PJ_SUCCESS) {</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;         <span class="keywordflow">if</span> (pjsip_endpt_send_response2(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>(), rdata, tdata, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) != PJ_SUCCESS) {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;            pjsip_tx_data_dec_ref(tdata);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;         }</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      }</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;   }</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;   <span class="keywordflow">if</span> (!(sdp_info = pjsip_rdata_get_sdp_info(rdata)) ||</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      (sdp_info-&gt;sdp_err != PJ_SUCCESS)) {</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;   }</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;   <span class="keywordflow">if</span> (!sdp_info-&gt;sdp) {</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;   }</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;   deferred = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a4229c2f5de34a490931841d187ad0625">sdp_requires_deferral</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>, sdp_info-&gt;sdp);</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;   <span class="keywordflow">if</span> (deferred == -1) {</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;pending_media_state);</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!deferred) {</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      <span class="keywordflow">return</span> PJ_FALSE;</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;   }</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;   pjsip_rx_data_clone(rdata, 0, &amp;<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>-&gt;deferred_reinvite);</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;   <span class="keywordflow">return</span> PJ_TRUE;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a908cdf7ba25c4d6f3d2efdf01f0125ca"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a908cdf7ba25c4d6f3d2efdf01f0125ca">ast_sip_dialog_get_session</a></div><div class="ttdeci">struct ast_sip_session * ast_sip_dialog_get_session(pjsip_dialog *dlg)</div><div class="ttdoc">Retrieves a session from a dialog. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03630">res_pjsip_session.c:3630</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a4229c2f5de34a490931841d187ad0625"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a4229c2f5de34a490931841d187ad0625">sdp_requires_deferral</a></div><div class="ttdeci">static int sdp_requires_deferral(struct ast_sip_session *session, const pjmedia_sdp_session *sdp)</div><div class="ttdoc">Determine whether the SDP provided requires deferral of negotiating or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02600">res_pjsip_session.c:2600</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a79606e824455a241d8eaaeef6bcc0a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79606e824455a241d8eaaeef6bcc0a7c">&#9670;&nbsp;</a></span>session_termination_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void session_termination_cb </td>
          <td>(</td>
          <td class="paramtype">pj_timer_heap_t *&#160;</td>
          <td class="paramname"><em>timer_heap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct pj_timer_entry *&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03545">3545</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05138">ast_sip_push_task()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">ast_sip_session::serializer</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03530">session_termination_task()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03554">ast_sip_session_defer_termination()</a>.</p>
<div class="fragment"><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;{</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../d3/d96/structentry.html">entry</a>-&gt;user_data;</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">serializer</a>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a31dd7857532c4cdbb2c3e9dec443f62e">session_termination_task</a>, session)) {</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session);</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;   }</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;}</div><div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="structast__sip__session_html_ac23e23ba60f358de78a893d537c0afa4"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ac23e23ba60f358de78a893d537c0afa4">ast_sip_session::serializer</a></div><div class="ttdeci">struct ast_taskprocessor * serializer</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00195">res_pjsip_session.h:195</a></div></div>
<div class="ttc" id="group__pjsip__threading_html_ga4f0a0629fa2ca084812772356d8e3565"><div class="ttname"><a href="../../d7/dfa/group__pjsip__threading.html#ga4f0a0629fa2ca084812772356d8e3565">ast_sip_push_task</a></div><div class="ttdeci">int ast_sip_push_task(struct ast_taskprocessor *serializer, int(*sip_task)(void *), void *task_data)</div><div class="ttdoc">Pushes a task to SIP servants. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05138">res_pjsip.c:5138</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a31dd7857532c4cdbb2c3e9dec443f62e"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a31dd7857532c4cdbb2c3e9dec443f62e">session_termination_task</a></div><div class="ttdeci">static int session_termination_task(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03530">res_pjsip_session.c:3530</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a31dd7857532c4cdbb2c3e9dec443f62e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31dd7857532c4cdbb2c3e9dec443f62e">&#9670;&nbsp;</a></span>session_termination_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int session_termination_task </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03530">3530</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">ast_sip_session_terminate()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">ast_sip_session::defer_terminate</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03545">session_termination_cb()</a>.</p>
<div class="fragment"><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;{</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = data;</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a>) {</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;      session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">defer_terminate</a> = 0;</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>) {</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a>(session, 0);</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;      }</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;   }</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a52a2a3cbcab65965d83205363c8f09d1"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a52a2a3cbcab65965d83205363c8f09d1">ast_sip_session::defer_terminate</a></div><div class="ttdeci">unsigned int defer_terminate</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00215">res_pjsip_session.h:215</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac548e363175ba43f7ad75438729deac3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac548e363175ba43f7ad75438729deac3">ast_sip_session_terminate</a></div><div class="ttdeci">void ast_sip_session_terminate(struct ast_sip_session *session, int response)</div><div class="ttdoc">Terminate a session and, if possible, send the provided response code. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03451">res_pjsip_session.c:3451</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74185467f13d0fd3860ef8a8762ca49d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74185467f13d0fd3860ef8a8762ca49d">&#9670;&nbsp;</a></span>set_from_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_from_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01637">1637</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/de2/channel__internal__api_8c_source.html#l00900">ast_channel_connected_effective_id()</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02945">ast_channel_lock</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l02946">ast_channel_unlock</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00452">ast_debug</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01765">ast_party_id_copy()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01811">ast_party_id_free()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01757">ast_party_id_init()</a>, <a class="el" href="../../d4/d28/channel_8c_source.html#l01821">ast_party_id_presentation()</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00324">AST_PRES_ALLOWED</a>, <a class="el" href="../../de/d47/callerid_8h_source.html#l00323">AST_PRES_RESTRICTION</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03994">ast_sip_add_usereqphone()</a>, <a class="el" href="../../dd/dfd/config__global_8c_source.html#l00462">ast_sip_get_use_callerid_contact()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05587">ast_sip_modify_id_header()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">ast_sip_session::channel</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00887">ast_sip_endpoint::contact_user</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00831">ast_sip_endpoint::fromdomain</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00829">ast_sip_endpoint::fromuser</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00847">ast_sip_endpoint::id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00343">ast_party_id::number</a>, <a class="el" href="../../d3/d8c/pbx__variables_8c_source.html#l01000">pbx_builtin_getvar_helper()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00085">S_COR</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00225">ast_sip_session::saved_from_hdr</a>, <a class="el" href="../../d5/d7b/channel_8h_source.html#l00292">ast_party_number::str</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00633">ast_sip_endpoint_id_configuration::trust_outbound</a>, and <a class="el" href="../../d5/d7b/channel_8h_source.html#l00298">ast_party_number::valid</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02847">ast_sip_session_create_invite()</a>.</p>
<div class="fragment"><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;{</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> effective_id;</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> connected_id;</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;   pj_pool_t *dlg_pool;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;   pjsip_fromto_hdr *dlg_info;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;   pjsip_contact_hdr *dlg_contact;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;   pjsip_name_addr *dlg_info_name_addr;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;   pjsip_sip_uri *dlg_info_uri;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;   pjsip_sip_uri *dlg_contact_uri;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;   <span class="keywordtype">int</span> restricted;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *pjsip_from_domain;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a> || session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a8e41e237863941cd7595151b3e9b558a">saved_from_hdr</a>) {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;   }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;   <span class="comment">/* We need to save off connected_id for RPID/PAI generation */</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a2126ac3bbc1a14f6ed5ccdfcbb851776">ast_party_id_init</a>(&amp;connected_id);</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   effective_id = <a class="code" href="../../d5/d7b/channel_8h.html#abd6165fa9617e1bb5efee3befa3e963d">ast_channel_connected_effective_id</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a>(&amp;connected_id, &amp;effective_id);</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;   restricted =</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;      ((<a class="code" href="../../d5/d7b/channel_8h.html#a39aac47fef1240391fd97e055522fd83">ast_party_id_presentation</a>(&amp;connected_id) &amp; <a class="code" href="../../de/d47/callerid_8h.html#aec2d69e281c81503bc532e107ca26f66">AST_PRES_RESTRICTION</a>) != <a class="code" href="../../de/d47/callerid_8h.html#a4b8463f8be514e1134291b2a9ddaeb35">AST_PRES_ALLOWED</a>);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;   <span class="comment">/* Now set up dlg-&gt;local.info so pjsip can correctly generate From */</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;   dlg_pool = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg-&gt;pool;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;   dlg_info = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg-&gt;local.info;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;   dlg_contact = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;dlg-&gt;local.contact;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;   dlg_info_name_addr = (pjsip_name_addr *) dlg_info-&gt;uri;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;   dlg_info_uri = pjsip_uri_get_uri(dlg_info_name_addr);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   dlg_contact_uri = (pjsip_sip_uri*)pjsip_uri_get_uri(dlg_contact-&gt;uri);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">id</a>.<a class="code" href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a54f1b35ed47fddbc454a90daa3b879c7">trust_outbound</a> || !restricted) {</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afe1cbe99a485f1e003ecc829b5885eeb">ast_sip_modify_id_header</a>(dlg_pool, dlg_info, &amp;connected_id);</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a8d563129fecea04e6b7feae05d32470e">ast_sip_get_use_callerid_contact</a>() &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a331b0897216e7fa779ac247698ae299d">contact_user</a>)) {</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;         pj_strdup2(dlg_pool, &amp;dlg_contact_uri-&gt;user, <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(connected_id.number.valid, connected_id.number.str, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      }</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;   }</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a5399dc7357197254794b990b263a2b7b">ast_party_id_free</a>(&amp;connected_id);</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#ac73c8898b4e904caa12dd1adcab40126">fromuser</a>)) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      dlg_info_name_addr-&gt;display.ptr = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      dlg_info_name_addr-&gt;display.slen = 0;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      pj_strdup2(dlg_pool, &amp;dlg_info_uri-&gt;user, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#ac73c8898b4e904caa12dd1adcab40126">fromuser</a>);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;   }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#aa46f02b6ae40c29d58bff7e415ad9a1b">fromdomain</a>)) {</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      pj_strdup2(dlg_pool, &amp;dlg_info_uri-&gt;host, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#aa46f02b6ae40c29d58bff7e415ad9a1b">fromdomain</a>);</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;   }</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">    * Channel variable for compatibility with chan_sip SIPFROMDOMAIN</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   pjsip_from_domain = <a class="code" href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>, <span class="stringliteral">&quot;SIPFROMDOMAIN&quot;</span>);</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pjsip_from_domain)) {</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;%s: From header domain reset by channel variable SIPFROMDOMAIN (%s)\n&quot;</span>,</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), pjsip_from_domain);</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      pj_strdup2(dlg_pool, &amp;dlg_info_uri-&gt;host, pjsip_from_domain);</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;   }</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">channel</a>);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;   <span class="comment">/* We need to save off the non-anonymized From for RPID/PAI generation (for domain) */</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;   session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a8e41e237863941cd7595151b3e9b558a">saved_from_hdr</a> = pjsip_hdr_clone(dlg_pool, dlg_info);</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a080baa12d788eb807467308a6cd5c3ac">ast_sip_add_usereqphone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>, dlg_pool, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a8e41e237863941cd7595151b3e9b558a">saved_from_hdr</a>-&gt;uri);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;   <span class="comment">/* In chan_sip, fromuser and fromdomain trump restricted so we only</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">    * anonymize if they&#39;re not set.</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;   <span class="keywordflow">if</span> (restricted) {</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="comment">/* fromuser doesn&#39;t provide a display name so we always set it */</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      pj_strdup2(dlg_pool, &amp;dlg_info_name_addr-&gt;display, <span class="stringliteral">&quot;Anonymous&quot;</span>);</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#ac73c8898b4e904caa12dd1adcab40126">fromuser</a>)) {</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;         pj_strdup2(dlg_pool, &amp;dlg_info_uri-&gt;user, <span class="stringliteral">&quot;anonymous&quot;</span>);</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      }</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a8d563129fecea04e6b7feae05d32470e">ast_sip_get_use_callerid_contact</a>() &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a331b0897216e7fa779ac247698ae299d">contact_user</a>)) {</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;         pj_strdup2(dlg_pool, &amp;dlg_contact_uri-&gt;user, <span class="stringliteral">&quot;anonymous&quot;</span>);</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      }</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#aa46f02b6ae40c29d58bff7e415ad9a1b">fromdomain</a>)) {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;         pj_strdup2(dlg_pool, &amp;dlg_info_uri-&gt;host, <span class="stringliteral">&quot;anonymous.invalid&quot;</span>);</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      }</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a080baa12d788eb807467308a6cd5c3ac">ast_sip_add_usereqphone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>, dlg_pool, dlg_info-&gt;uri);</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;}</div><div class="ttc" id="structast__party__id_html"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html">ast_party_id</a></div><div class="ttdoc">Information needed to identify an endpoint in a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00339">channel.h:339</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a080baa12d788eb807467308a6cd5c3ac"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a080baa12d788eb807467308a6cd5c3ac">ast_sip_add_usereqphone</a></div><div class="ttdeci">void ast_sip_add_usereqphone(const struct ast_sip_endpoint *endpoint, pj_pool_t *pool, pjsip_uri *uri)</div><div class="ttdoc">Add &amp;#39;user=phone&amp;#39; parameter to URI if enabled and user is a phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03994">res_pjsip.c:3994</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_ac73c8898b4e904caa12dd1adcab40126"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#ac73c8898b4e904caa12dd1adcab40126">ast_sip_endpoint::fromuser</a></div><div class="ttdeci">const ast_string_field fromuser</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00829">res_pjsip.h:829</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a331b0897216e7fa779ac247698ae299d"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a331b0897216e7fa779ac247698ae299d">ast_sip_endpoint::contact_user</a></div><div class="ttdeci">char * contact_user</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00887">res_pjsip.h:887</a></div></div>
<div class="ttc" id="channel_8h_html_a39aac47fef1240391fd97e055522fd83"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a39aac47fef1240391fd97e055522fd83">ast_party_id_presentation</a></div><div class="ttdeci">int ast_party_id_presentation(const struct ast_party_id *id)</div><div class="ttdoc">Determine the overall presentation value for the given party. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01821">channel.c:1821</a></div></div>
<div class="ttc" id="channel_8h_html_abbf5c9830dd3533f3a6d5d35f941effb"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abbf5c9830dd3533f3a6d5d35f941effb">ast_party_id_copy</a></div><div class="ttdeci">void ast_party_id_copy(struct ast_party_id *dest, const struct ast_party_id *src)</div><div class="ttdoc">Copy the source party id information to the destination party id. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01765">channel.c:1765</a></div></div>
<div class="ttc" id="channel_8h_html_a5399dc7357197254794b990b263a2b7b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5399dc7357197254794b990b263a2b7b">ast_party_id_free</a></div><div class="ttdeci">void ast_party_id_free(struct ast_party_id *doomed)</div><div class="ttdoc">Destroy the party id contents. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01811">channel.c:1811</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="pbx_8h_html_a98c5425b90ec7c5e136a40f529170b1b"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a98c5425b90ec7c5e136a40f529170b1b">pbx_builtin_getvar_helper</a></div><div class="ttdeci">const char * pbx_builtin_getvar_helper(struct ast_channel *chan, const char *name)</div><div class="ttdoc">Return a pointer to the value of the corresponding channel variable. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01000">pbx_variables.c:1000</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="structast__sip__session_html_a48371aaa1ad1144e564ebcd179a2db2e"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a48371aaa1ad1144e564ebcd179a2db2e">ast_sip_session::channel</a></div><div class="ttdeci">struct ast_channel * channel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00189">res_pjsip_session.h:189</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a8d563129fecea04e6b7feae05d32470e"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a8d563129fecea04e6b7feae05d32470e">ast_sip_get_use_callerid_contact</a></div><div class="ttdeci">unsigned int ast_sip_get_use_callerid_contact(void)</div><div class="ttdoc">Retrieve the global setting &amp;#39;use_callerid_contact&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dfd/config__global_8c_source.html#l00462">config_global.c:462</a></div></div>
<div class="ttc" id="structast__sip__endpoint__id__configuration_html_a54f1b35ed47fddbc454a90daa3b879c7"><div class="ttname"><a href="../../d4/df6/structast__sip__endpoint__id__configuration.html#a54f1b35ed47fddbc454a90daa3b879c7">ast_sip_endpoint_id_configuration::trust_outbound</a></div><div class="ttdeci">unsigned int trust_outbound</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00633">res_pjsip.h:633</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a50783ac9bc6f4943369ed254972049ac"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a50783ac9bc6f4943369ed254972049ac">ast_sip_endpoint::id</a></div><div class="ttdeci">struct ast_sip_endpoint_id_configuration id</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00847">res_pjsip.h:847</a></div></div>
<div class="ttc" id="channel_8h_html_abd6165fa9617e1bb5efee3befa3e963d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abd6165fa9617e1bb5efee3befa3e963d">ast_channel_connected_effective_id</a></div><div class="ttdeci">struct ast_party_id ast_channel_connected_effective_id(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00900">channel_internal_api.c:900</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="channel_8h_html_a2126ac3bbc1a14f6ed5ccdfcbb851776"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a2126ac3bbc1a14f6ed5ccdfcbb851776">ast_party_id_init</a></div><div class="ttdeci">void ast_party_id_init(struct ast_party_id *init)</div><div class="ttdoc">Initialize the given party id structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01757">channel.c:1757</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_afe1cbe99a485f1e003ecc829b5885eeb"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#afe1cbe99a485f1e003ecc829b5885eeb">ast_sip_modify_id_header</a></div><div class="ttdeci">void ast_sip_modify_id_header(pj_pool_t *pool, pjsip_fromto_hdr *id_hdr, const struct ast_party_id *id)</div><div class="ttdoc">Set name and number information on an identity header. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05587">res_pjsip.c:5587</a></div></div>
<div class="ttc" id="callerid_8h_html_aec2d69e281c81503bc532e107ca26f66"><div class="ttname"><a href="../../de/d47/callerid_8h.html#aec2d69e281c81503bc532e107ca26f66">AST_PRES_RESTRICTION</a></div><div class="ttdeci">#define AST_PRES_RESTRICTION</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00323">callerid.h:323</a></div></div>
<div class="ttc" id="callerid_8h_html_a4b8463f8be514e1134291b2a9ddaeb35"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a4b8463f8be514e1134291b2a9ddaeb35">AST_PRES_ALLOWED</a></div><div class="ttdeci">#define AST_PRES_ALLOWED</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d47/callerid_8h_source.html#l00324">callerid.h:324</a></div></div>
<div class="ttc" id="structast__sip__session_html_a8e41e237863941cd7595151b3e9b558a"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a8e41e237863941cd7595151b3e9b558a">ast_sip_session::saved_from_hdr</a></div><div class="ttdeci">pjsip_fromto_hdr * saved_from_hdr</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00225">res_pjsip_session.h:225</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_aa46f02b6ae40c29d58bff7e415ad9a1b"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#aa46f02b6ae40c29d58bff7e415ad9a1b">ast_sip_endpoint::fromdomain</a></div><div class="ttdeci">const ast_string_field fromdomain</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00831">res_pjsip.h:831</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b505dccfd3df8fb39e5819af569046c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b505dccfd3df8fb39e5819af569046c">&#9670;&nbsp;</a></span>set_mid_and_bundle_group()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int set_mid_and_bundle_group </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct pjmedia_sdp_media *&#160;</td>
          <td class="paramname"><em>stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00646">646</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00792">ast_sip_endpoint_media_configuration::bundle</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">ast_sip_session_media::bundled</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00612">get_mid_bundle_group()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">ast_sip_session_media::mid</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>.</p>
<div class="fragment"><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;{</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   pjmedia_sdp_attr *attr;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;   <span class="keywordflow">if</span> (!session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">bundle</a>) {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="comment">/* By default on an incoming negotiation we assume no mid and bundle group is present */</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = -1;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">bundled</a> = 0;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <span class="comment">/* Grab the media identifier for the stream */</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   attr = pjmedia_sdp_media_find_attr2(stream, <span class="stringliteral">&quot;mid&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <span class="keywordflow">if</span> (!attr) {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, attr-&gt;value.slen + 1);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <span class="keywordflow">if</span> (!session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>, &amp;attr-&gt;value, attr-&gt;value.slen + 1);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   <span class="comment">/* Determine what bundle group this is part of */</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a9a1c15e1dafd2d9d7998acd2b86c1a63">get_mid_bundle_group</a>(sdp, session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">mid</a>);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="comment">/* If this is actually part of a bundle group then the other side requested or accepted the bundle request */</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">bundled</a> = session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> != -1;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_afa3a7e28366368335195e1b806d587a2"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#afa3a7e28366368335195e1b806d587a2">ast_sip_session_media::mid</a></div><div class="ttdeci">char * mid</div><div class="ttdoc">Media identifier for this stream (may be shared across multiple streams) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00111">res_pjsip_session.h:111</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a9a1c15e1dafd2d9d7998acd2b86c1a63"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a9a1c15e1dafd2d9d7998acd2b86c1a63">get_mid_bundle_group</a></div><div class="ttdeci">static int get_mid_bundle_group(const pjmedia_sdp_session *sdp, const char *mid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00612">res_pjsip_session.c:612</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_adde8efbb4df251209d1b3e05e166a025"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#adde8efbb4df251209d1b3e05e166a025">ast_sip_session_media::bundled</a></div><div class="ttdeci">unsigned int bundled</div><div class="ttdoc">Whether this stream is currently bundled or not. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00115">res_pjsip_session.h:115</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a4b3a62121ed2ff9bebdfb879ad17cdef"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a4b3a62121ed2ff9bebdfb879ad17cdef">ast_sip_endpoint_media_configuration::bundle</a></div><div class="ttdeci">unsigned int bundle</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00792">res_pjsip.h:792</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abba55edb1fef9239c00fe063a1c9367d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba55edb1fef9239c00fe063a1c9367d">&#9670;&nbsp;</a></span>set_remote_mslabel_and_stream_group()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_remote_mslabel_and_stream_group </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>session_media</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const pjmedia_sdp_session *&#160;</td>
          <td class="paramname"><em>sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct pjmedia_sdp_media *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a> *&#160;</td>
          <td class="paramname"><em>asterisk_stream</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00684">684</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l05240">ast_copy_pj_str()</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00243">ast_strdup</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l01084">ast_stream_set_group()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00125">ast_sip_session_media::remote_label</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00123">ast_sip_session_media::remote_mslabel</a>, <a class="el" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep()</a>, and <a class="el" href="../../de/d1e/bt__open_8c_source.html#l00389">tmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00764">handle_incoming_sdp()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00964">handle_negotiated_sdp_session_media()</a>.</p>
<div class="fragment"><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;{</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <span class="keywordtype">int</span> index;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a>);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a70e1508d190eb74f9da879ad5bd371d9">remote_label</a>);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a70e1508d190eb74f9da879ad5bd371d9">remote_label</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; stream-&gt;attr_count; ++index) {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      pjmedia_sdp_attr *attr = stream-&gt;attr[index];</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordtype">char</span> attr_value[pj_strlen(&amp;attr-&gt;value) + 1];</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordtype">char</span> *ssrc_attribute_name, *ssrc_attribute_value = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordtype">char</span> *msid, *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = attr_value;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t STR_msid = { <span class="stringliteral">&quot;msid&quot;</span>, 4 };</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t STR_ssrc = { <span class="stringliteral">&quot;ssrc&quot;</span>, 4 };</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keyword">static</span> <span class="keyword">const</span> pj_str_t STR_label = { <span class="stringliteral">&quot;label&quot;</span>, 5 };</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">if</span> (!pj_strcmp(&amp;attr-&gt;name, &amp;STR_label)) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(attr_value, &amp;attr-&gt;value, <span class="keyword">sizeof</span>(attr_value));</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a70e1508d190eb74f9da879ad5bd371d9">remote_label</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(attr_value);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pj_strcmp(&amp;attr-&gt;name, &amp;STR_msid)) {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(attr_value, &amp;attr-&gt;value, <span class="keyword">sizeof</span>(attr_value));</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;         msid = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;tmp, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;         session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(msid);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pj_strcmp(&amp;attr-&gt;name, &amp;STR_ssrc)) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;         <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a>(attr_value, &amp;attr-&gt;value, <span class="keyword">sizeof</span>(attr_value));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         <span class="keywordflow">if</span> ((ssrc_attribute_name = strchr(attr_value, <span class="charliteral">&#39; &#39;</span>))) {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="comment">/* This has an actual attribute */</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            *ssrc_attribute_name++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            ssrc_attribute_value = strchr(ssrc_attribute_name, <span class="charliteral">&#39;:&#39;</span>);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">if</span> (ssrc_attribute_value) {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;               <span class="comment">/* Values are actually optional according to the spec */</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;               *ssrc_attribute_value++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(ssrc_attribute_name, <span class="stringliteral">&quot;mslabel&quot;</span>) &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(ssrc_attribute_value)) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;               session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(ssrc_attribute_value);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            }</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;         }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a>)) {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="comment">/* Iterate through the existing streams looking for a match and if so then group this with it */</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions); ++index) {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *group_session_media;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      group_session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;sessions, index);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(group_session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a>) ||</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;         strcmp(group_session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a>, session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">remote_mslabel</a>)) {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      }</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <a class="code" href="../../d8/d95/stream_8h.html#ad4d76202e9622c9812699ae76e3f9a24">ast_stream_set_group</a>(asterisk_stream, index);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a7da3e1f7ee3fcb77f29d41a76a7528fe"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a7da3e1f7ee3fcb77f29d41a76a7528fe">ast_copy_pj_str</a></div><div class="ttdeci">void ast_copy_pj_str(char *dest, const pj_str_t *src, size_t size)</div><div class="ttdoc">Copy a pj_str_t into a standard character buffer. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l05240">res_pjsip.c:5240</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="stream_8h_html_ad4d76202e9622c9812699ae76e3f9a24"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ad4d76202e9622c9812699ae76e3f9a24">ast_stream_set_group</a></div><div class="ttdeci">void ast_stream_set_group(struct ast_stream *stream, int group)</div><div class="ttdoc">Set the stream group for a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l01084">stream.c:1084</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a99eb7597d759e980c36f446c252c1aa0"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a99eb7597d759e980c36f446c252c1aa0">ast_sip_session_media::remote_mslabel</a></div><div class="ttdeci">char * remote_mslabel</div><div class="ttdoc">Remote media stream label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00123">res_pjsip_session.h:123</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="structast__sip__session__media_html_a70e1508d190eb74f9da879ad5bd371d9"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a70e1508d190eb74f9da879ad5bd371d9">ast_sip_session_media::remote_label</a></div><div class="ttdeci">char * remote_label</div><div class="ttdoc">Remote stream label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00125">res_pjsip_session.h:125</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4937945ffae151bc235182493d104c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4937945ffae151bc235182493d104c8c">&#9670;&nbsp;</a></span>setup_outbound_invite_auth()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int setup_outbound_invite_auth </td>
          <td>(</td>
          <td class="paramtype">pjsip_dialog *&#160;</td>
          <td class="paramname"><em>dlg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03306">3306</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, and <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00146">status</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03317">ast_sip_session_create_outgoing()</a>.</p>
<div class="fragment"><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;{</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;   pj_status_t <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;   ++dlg-&gt;sess_count;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;   status = pjsip_dlg_add_usage(dlg, &amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a724b2cc287d0952c4bbb94bc14c3d5b6">outbound_invite_auth_module</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;   --dlg-&gt;sess_count;</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;   <span class="keywordflow">return</span> status != PJ_SUCCESS ? -1 : 0;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;}</div><div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a724b2cc287d0952c4bbb94bc14c3d5b6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a724b2cc287d0952c4bbb94bc14c3d5b6">outbound_invite_auth_module</a></div><div class="ttdeci">static pjsip_module outbound_invite_auth_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03290">res_pjsip_session.c:3290</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a92471759f1f84a29c1cf773bb83b7807"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92471759f1f84a29c1cf773bb83b7807">&#9670;&nbsp;</a></span>sip_channel_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sip_channel_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for SIP channel. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02966">2966</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00468">ast_sip_channel_pvt::pvt</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00470">ast_sip_channel_pvt::session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02974">ast_sip_channel_pvt_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;{</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a> *<a class="code" href="../../d4/d84/structchannel.html">channel</a> = obj;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(channel-&gt;<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">pvt</a>);</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(channel-&gt;<a class="code" href="../../d4/d51/structast__sip__channel__pvt.html#a47bd1bb949183a58a194970acaccffbd">session</a>);</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;}</div><div class="ttc" id="structast__sip__channel__pvt_html_a77153a7ab7ba05031fbbb4e67aa9dcfc"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html#a77153a7ab7ba05031fbbb4e67aa9dcfc">ast_sip_channel_pvt::pvt</a></div><div class="ttdeci">void * pvt</div><div class="ttdoc">Pointer to channel specific implementation information, must be ao2 object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00468">res_pjsip_session.h:468</a></div></div>
<div class="ttc" id="structast__sip__channel__pvt_html"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html">ast_sip_channel_pvt</a></div><div class="ttdoc">A structure which contains a channel implementation and session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00466">res_pjsip_session.h:466</a></div></div>
<div class="ttc" id="structast__sip__channel__pvt_html_a47bd1bb949183a58a194970acaccffbd"><div class="ttname"><a href="../../d4/d51/structast__sip__channel__pvt.html#a47bd1bb949183a58a194970acaccffbd">ast_sip_channel_pvt::session</a></div><div class="ttdeci">struct ast_sip_session * session</div><div class="ttdoc">Pointer to session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00470">res_pjsip_session.h:470</a></div></div>
<div class="ttc" id="structchannel_html"><div class="ttname"><a href="../../d4/d84/structchannel.html">channel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8a/muted_8c_source.html#l00095">muted.c:95</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bd0100b8c103a8d8633eb0db236f6af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bd0100b8c103a8d8633eb0db236f6af">&#9670;&nbsp;</a></span>sip_session_defer_termination_stop_timer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sip_session_defer_termination_stop_timer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03588">3588</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03718">ast_sip_get_pjsip_endpoint()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00205">ast_sip_session::scheduled_termination</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03596">ast_sip_session_defer_termination_cancel()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04525">session_end()</a>.</p>
<div class="fragment"><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;{</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;   <span class="keywordflow">if</span> (pj_timer_heap_cancel_if_active(pjsip_endpt_get_timer_heap(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a>()),</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;      &amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">scheduled_termination</a>, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">scheduled_termination</a>.id)) {</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session, -1);</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;   }</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session_html_a5e674de8b1bb04f45fe397c9bdfe9c78"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a5e674de8b1bb04f45fe397c9bdfe9c78">ast_sip_session::scheduled_termination</a></div><div class="ttdeci">pj_timer_entry scheduled_termination</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00205">res_pjsip_session.h:205</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a785afb501e315c8a97ad476fb6a8be1d"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a785afb501e315c8a97ad476fb6a8be1d">ast_sip_get_pjsip_endpoint</a></div><div class="ttdeci">pjsip_endpoint * ast_sip_get_pjsip_endpoint(void)</div><div class="ttdoc">Get a pointer to the PJSIP endpoint. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03718">res_pjsip.c:3718</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d68a08d3f45966f9c90fa2903aed739"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d68a08d3f45966f9c90fa2903aed739">&#9670;&nbsp;</a></span>sip_session_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sip_session_refresh </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a10d9345e8ae94af746bf9b8cae9ae4e0">ast_sip_session_request_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_request_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a12b69e365ef6deab260e02cdf2b3ba29">ast_sip_session_sdp_creation_cb</a>&#160;</td>
          <td class="paramname"><em>on_sdp_creation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d9/de7/res__pjsip__session_8h.html#a83e35cdda0bf863afb19d1d954f309e5">ast_sip_session_response_cb</a>&#160;</td>
          <td class="paramname"><em>on_response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0d">ast_sip_session_refresh_method</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>generate_new_sdp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>pending_media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>active_media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>queued</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02184">2184</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">ast_sip_session::active_media_state</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00491">ao2_bump</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00052">ast_format_cap_alloc</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00395">ast_format_cap_count()</a>, <a class="el" href="../../d0/d3c/format__cap_8h_source.html#l00038">AST_FORMAT_CAP_FLAG_DEFAULT</a>, <a class="el" href="../../d3/dc9/format__cap_8c_source.html#l00630">ast_format_cap_get_compatible()</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00449">AST_LIST_EMPTY</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00032">AST_MEDIA_TYPE_AUDIO</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00036">AST_MEDIA_TYPE_END</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00034">AST_MEDIA_TYPE_IMAGE</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00033">AST_MEDIA_TYPE_VIDEO</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">ast_sip_session_get_name()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">ast_sip_session_media_state_clone()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">ast_sip_session_media_state_free()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">ast_sip_session_media_state_reset()</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00486">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">ast_sip_session_send_request_with_cb()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01136">ast_str_tmp</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00257">ast_stream_clone()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00292">ast_stream_free()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00330">ast_stream_get_formats()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00423">ast_stream_get_metadata()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00309">ast_stream_get_name()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00316">ast_stream_get_type()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00365">ast_stream_set_formats()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00748">ast_stream_topology_append_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00825">ast_stream_topology_del_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00696">ast_stream_topology_equal()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00936">ast_stream_topology_to_str()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00692">ast_trace</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00412">AST_VECTOR_REMOVE</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00770">ast_sip_endpoint_media_configuration::codecs</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">delay_request()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">DELAYED_METHOD_INVITE</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">DELAYED_METHOD_UPDATE</a>, <a class="el" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">end</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">ast_sip_session::endpoint</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01621">generate_session_refresh_sdp()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00592">is_stream_limitation_reached()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00274">LOG_WARNING</a>, <a class="el" href="../../d8/d8c/res__pjsip_8h_source.html#l00841">ast_sip_endpoint::media</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">ast_sip_session::pending_media_state</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00090">ast_stream::position</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">resolve_refresh_media_states()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00805">SCOPE_EXIT</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00834">SCOPE_EXIT_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00946">SCOPE_EXIT_LOG_EXPR</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00940">SCOPE_EXIT_LOG_RTN_VALUE</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02524">ast_sip_session_refresh()</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01394">send_delayed_request()</a>.</p>
<div class="fragment"><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;{</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;   pjsip_inv_session *inv_session = session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   pjmedia_sdp_session *new_sdp = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;   pjsip_tx_data *tdata;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;   <span class="keywordtype">int</span> res = -1;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(3, <span class="stringliteral">&quot;%s: New SDP? %s  Queued? %s DP: %s  DA: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;      generate_new_sdp ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>, queued ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>,</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      pending_media_state ? <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)) : <span class="stringliteral">&quot;none&quot;</span>,</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      active_media_state ? <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(active_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)) : <span class="stringliteral">&quot;none&quot;</span>);</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;   <span class="keywordflow">if</span> (pending_media_state &amp;&amp; (!pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> || !generate_new_sdp)) {</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(-1, <span class="stringliteral">&quot;%s: Not sending reinvite because %s%s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;         pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? <span class="stringliteral">&quot;pending topology is null &quot;</span> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;            !generate_new_sdp ? <span class="stringliteral">&quot;generate_new_sdp is false&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;   }</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;   <span class="keywordflow">if</span> (inv_session-&gt;state == PJSIP_INV_STATE_DISCONNECTED) {</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      <span class="comment">/* Don&#39;t try to do anything with a hung-up call */</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;%s: Not sending reinvite because of disconnected state\n&quot;</span>,</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;   }</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   <span class="comment">/* If the dialog has not yet been established we have to defer until it has */</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;   <span class="keywordflow">if</span> (inv_session-&gt;dlg-&gt;state != PJSIP_DIALOG_STATE_ESTABLISHED) {</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a>(session, on_request_creation, on_sdp_creation, on_response,</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;         generate_new_sdp,</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;         <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            ? <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a> : <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a>,</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;         pending_media_state, active_media_state ? active_media_state : <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>), queued);</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s: Delay sending reinvite because dialog has not been established\n&quot;</span>,</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;   }</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a>) {</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keywordflow">if</span> (inv_session-&gt;invite_tsx) {</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;         <span class="comment">/* We can&#39;t send a reinvite yet, so delay it */</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;         res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a>(session, on_request_creation, on_sdp_creation,</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            on_response, generate_new_sdp, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a>, pending_media_state,</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;            active_media_state ? active_media_state : <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>), queued);</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s: Delay sending reinvite because of outstanding transaction\n&quot;</span>,</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inv_session-&gt;state != PJSIP_INV_STATE_CONFIRMED) {</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;         <span class="comment">/* Initial INVITE transaction failed to progress us to a confirmed state</span></div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="comment">          * which means re-invites are not possible</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;%s: Not sending reinvite because not in confirmed state\n&quot;</span>,</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      }</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;   }</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;   <span class="keywordflow">if</span> (generate_new_sdp) {</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;      <span class="comment">/* SDP can only be generated if current negotiation has already completed */</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      <span class="keywordflow">if</span> (inv_session-&gt;neg</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;         &amp;&amp; pjmedia_sdp_neg_get_state(inv_session-&gt;neg)</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            != PJMEDIA_SDP_NEG_STATE_DONE) {</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;         res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a>(session, on_request_creation, on_sdp_creation,</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;            on_response, generate_new_sdp,</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;            <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;               ? <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a> : DELAYED_METHOD_UPDATE, pending_media_state,</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;            active_media_state ? active_media_state : <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>), queued);</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s: Delay session refresh with new SDP because SDP negotiation is not yet done\n&quot;</span>,</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;      }</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;      <span class="comment">/* If an explicitly requested media state has been provided use it instead of any pending one */</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="keywordflow">if</span> (pending_media_state) {</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;         <span class="keywordtype">int</span> index;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;         <span class="keywordtype">int</span> type_streams[<a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a>] = {0};</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Pending media state exists\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;         <span class="comment">/* Media state conveys a desired media state, so if there are outstanding</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">          * delayed requests we need to ensure we go into the queue and not jump</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">          * ahead. If we sent this media state now then updates could go out of</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">          * order.</span></div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;         <span class="keywordflow">if</span> (!queued &amp;&amp; !<a class="code" href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a>(&amp;session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">delayed_requests</a>)) {</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a>(session, on_request_creation, on_sdp_creation,</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;               on_response, generate_new_sdp,</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;               <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                  ? <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a> : DELAYED_METHOD_UPDATE, pending_media_state,</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                  active_media_state ? active_media_state : <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>), queued);</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s: Delay sending reinvite because of outstanding requests\n&quot;</span>,</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;         }</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">          * Attempt to resolve only if objects are available, and it&#39;s not</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">          * switching to or from an image type.</span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;         <span class="keywordflow">if</span> (active_media_state &amp;&amp; active_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> &amp;&amp;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            (!active_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a>] ==</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;             !pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a>])) {</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *new_pending_state;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Active media state exists and is%s equal to pending\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;               !<a class="code" href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a>(active_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>,pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) ? <span class="stringliteral">&quot; not&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: DP: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: DA: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(active_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: CP: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: CA: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            new_pending_state = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ac4bf8de5db02001daabfc303b49c6d3a">resolve_refresh_media_states</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;               pending_media_state, active_media_state, session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>, 1);</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            <span class="keywordflow">if</span> (new_pending_state) {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: NP: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(new_pending_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;               pending_media_state = new_pending_state;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(pending_media_state);</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Unable to merge media states\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;            }</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;         }</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;         <span class="comment">/* Prune the media state so the number of streams fit within the configured limits - we do it here</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment">          * so that the index of the resulting streams in the SDP match. If we simply left the streams out</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment">          * of the SDP when producing it we&#39;d be in trouble. We also enforce formats here for media types that</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">          * are configurable on the endpoint.</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Pruning and checking formats of streams\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;         <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>); ++index) {</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *existing_stream = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index);</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(4, <span class="stringliteral">&quot;%s: Checking stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream));</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a> &amp;&amp;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;               index &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>)) {</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;               existing_stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index);</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Found existing stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                  <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(existing_stream));</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            }</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ad8f4c88669e6520cc93dda53b5635eb0">is_stream_limitation_reached</a>(<a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream), session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>, type_streams)) {</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;               <span class="keywordflow">if</span> (index &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;pending_media_state-&gt;sessions)) {</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                  <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;pending_media_state-&gt;sessions, index);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                  <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(session_media);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                  <a class="code" href="../../d6/d68/vector_8h.html#abe6d979239bef1a97d069b1a10c7d35c">AST_VECTOR_REMOVE</a>(&amp;pending_media_state-&gt;sessions, index, 1);</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;               }</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a71a656802bd6b8e87846b42a5fb35a79">ast_stream_topology_del_stream</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index);</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Dropped overlimit stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                  <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream));</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;               <span class="comment">/* A stream has potentially moved into our spot so we need to jump back so we process it */</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;               index -= 1;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>);</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            }</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="comment">/* No need to do anything with stream if it&#39;s media state is removed */</span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(stream) == <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;               <span class="comment">/* If there is no existing stream we can just not have this stream in the topology at all. */</span></div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;               <span class="keywordflow">if</span> (!existing_stream) {</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: Dropped removed stream %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                     <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream));</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                  <a class="code" href="../../d8/d95/stream_8h.html#a71a656802bd6b8e87846b42a5fb35a79">ast_stream_topology_del_stream</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                  <span class="comment">/* TODO: Do we need to remove the corresponding media state? */</span></div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                  index -= 1;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;               }</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>);</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;            }</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <span class="comment">/* Enforce the configured allowed codecs on audio and video streams */</span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a> || <a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream) == <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a>) &amp;&amp;</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;               !<a class="code" href="../../d8/d95/stream_8h.html#a311bed754f00753d0fd141266ee0d282">ast_stream_get_metadata</a>(stream, <span class="stringliteral">&quot;pjsip_session_refresh&quot;</span>)) {</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;               <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *joint_cap;</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;               joint_cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;               <span class="keywordflow">if</span> (!joint_cap) {</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                  res = -1;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Unable to alloc format caps\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;               }</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;               <a class="code" href="../../d0/d3c/format__cap_8h.html#a43950f716385bc78a73de04acd6a7eb4">ast_format_cap_get_compatible</a>(<a class="code" href="../../d8/d95/stream_8h.html#ae8e2f46d218285e0f0ec97ba8ab77ffb">ast_stream_get_formats</a>(stream), session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">endpoint</a>-&gt;<a class="code" href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">media</a>.<a class="code" href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a250b131731bf019fe96a44c9473437f0">codecs</a>, joint_cap);</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;               <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a>(joint_cap)) {</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                  <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(joint_cap, -1);</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                  <span class="keywordflow">if</span> (!existing_stream) {</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                     <span class="comment">/* If there is no existing stream we can just not have this stream in the topology</span></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment">                      * at all.</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment">                      */</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                     <a class="code" href="../../d8/d95/stream_8h.html#a71a656802bd6b8e87846b42a5fb35a79">ast_stream_topology_del_stream</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index);</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                     index -= 1;</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Dropped incompatible stream %s\n&quot;</span>,</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                        <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream));</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(stream) != <a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(existing_stream) ||</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                        strcmp(<a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream), <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(existing_stream))) {</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                     <span class="comment">/* If the underlying stream is a different type or different name then we have to</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">                      * mark it as removed, as it is replacing an existing stream. We do this so order</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">                      * is preserved.</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment">                      */</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                     <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                     <a class="code" href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a>(<span class="keywordflow">continue</span>, <span class="stringliteral">&quot;%s: Dropped incompatible stream %s\n&quot;</span>,</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                        <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream));</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;                     <span class="comment">/* However if the stream is otherwise remaining the same we can keep the formats</span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment">                      * that exist on it already which allows media to continue to flow. We don&#39;t modify</span></div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment">                      * the format capabilities but do need to cast it so that ao2_bump can raise the</span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment">                      * reference count.</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">                      */</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                     joint_cap = <a class="code" href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a>((<span class="keyword">struct</span> <a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *)<a class="code" href="../../d8/d95/stream_8h.html#ae8e2f46d218285e0f0ec97ba8ab77ffb">ast_stream_get_formats</a>(existing_stream));</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                  }</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;               }</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a8dc44f43dab4a5484631812d9bbc3ae9">ast_stream_set_formats</a>(stream, joint_cap);</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(joint_cap);</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;            }</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            ++type_streams[<a class="code" href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a>(stream)];</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>();</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;         }</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>) {</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            <span class="comment">/* SDP is a fun thing. Take for example the fact that streams are never removed. They just become</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">             * declined. To better handle this in the case where something requests a topology change for fewer</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">             * streams than are currently present we fill in the topology to match the current number of streams</span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">             * that are active.</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;            <span class="keywordflow">for</span> (index = <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>);</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;               index &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>); ++index) {</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;               <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream = <a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, index);</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;               <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *cloned;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;               <span class="keywordtype">int</span> <a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a>;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(4, <span class="stringliteral">&quot;%s: Stream %s not in pending\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                  <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream));</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;               cloned = <a class="code" href="../../d8/d95/stream_8h.html#a9dcdd3db33377db2e845ada4c281d1d6">ast_stream_clone</a>(stream, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;               <span class="keywordflow">if</span> (!cloned) {</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                  res = -1;</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Unable to clone stream %s\n&quot;</span>,</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                     <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a>(stream));</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;               }</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;               <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(cloned, <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;               position = <a class="code" href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, cloned);</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;               <span class="keywordflow">if</span> (position &lt; 0) {</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                  <a class="code" href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a>(cloned);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                  res = -1;</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a>(<span class="keywordflow">goto</span> end, <a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Unable to append cloned stream\n&quot;</span>,</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                     <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;               }</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a>(<span class="stringliteral">&quot;%s: Appended empty stream in position %d to make counts match\n&quot;</span>,</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), position);</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            }</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;            <span class="comment">/*</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">             * We can suppress this re-invite if the pending topology is equal to the currently</span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">             * active topology.</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>)) {</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: CA: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">active_media_state</a>-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a>(-1, <span class="stringliteral">&quot;%s: NP: %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session), <a class="code" href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a>(256, <a class="code" href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a>(pending_media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, &amp;STR_TMP)));</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(pending_media_state);</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;               <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;               <span class="comment">/* For external consumers we return 0 to say success, but internally for</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment">                * send_delayed_request we return a separate value to indicate that this</span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment">                * session refresh would be redundant so we didn&#39;t send it</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(queued ? 1 : 0, <span class="stringliteral">&quot;%s: Topologies are equal. Not sending re-invite\n&quot;</span>,</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                  <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            }</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;         }</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;         session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a> = pending_media_state;</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      }</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      new_sdp = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a36b830933f0110c5ea0a2c71d1c50b43">generate_session_refresh_sdp</a>(session);</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="keywordflow">if</span> (!new_sdp) {</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Failed to generate session refresh SDP. Not sending session refresh\n&quot;</span>,</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      }</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      <span class="keywordflow">if</span> (on_sdp_creation) {</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;         <span class="keywordflow">if</span> (on_sdp_creation(session, new_sdp)) {</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: on_sdp_creation failed\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;         }</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      }</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;   }</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a>) {</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;      <span class="keywordflow">if</span> (pjsip_inv_reinvite(inv_session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, new_sdp, &amp;tdata)) {</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;         <span class="keywordflow">if</span> (generate_new_sdp) {</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;         }</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Failed to create reinvite properly\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      }</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pjsip_inv_update(inv_session, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, new_sdp, &amp;tdata)) {</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      <span class="keywordflow">if</span> (generate_new_sdp) {</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      }</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: Failed to create UPDATE properly\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   }</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   <span class="keywordflow">if</span> (on_request_creation) {</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keywordflow">if</span> (on_request_creation(session, tdata)) {</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;         <span class="keywordflow">if</span> (generate_new_sdp) {</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a>(session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">pending_media_state</a>);</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;         }</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;         <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a>(-1, <a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;%s: on_request_creation failed.\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session));</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      }</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;   }</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a>(session, tdata, on_response);</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;   <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a>(active_media_state);</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>:</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(res, <span class="stringliteral">&quot;%s: Sending session refresh SDP via %s\n&quot;</span>, <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a>(session),</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a> ? <span class="stringliteral">&quot;re-INVITE&quot;</span> : <span class="stringliteral">&quot;UPDATE&quot;</span>);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;}</div><div class="ttc" id="res__pjsip_8h_html_afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#afb35a66aecb7cc6a143f8075c3992e0dae9c19ba5b085de7f7cf9a0e1f278f8cc">AST_SIP_SESSION_REFRESH_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00486">res_pjsip.h:486</a></div></div>
<div class="ttc" id="logger_8h_html_a5eff4ad268db72883e5e152070c3583f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a5eff4ad268db72883e5e152070c3583f">SCOPE_EXIT_LOG_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_RTN_VALUE(__value, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00940">logger.h:940</a></div></div>
<div class="ttc" id="structast__sip__session_html_a3960205b2a4e7e012dc9f0eae1855f01"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a3960205b2a4e7e012dc9f0eae1855f01">ast_sip_session::endpoint</a></div><div class="ttdeci">struct ast_sip_endpoint * endpoint</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00183">res_pjsip_session.h:183</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a></div><div class="ttdoc">Structure which contains media state information (streams, sessions) </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00145">res_pjsip_session.h:145</a></div></div>
<div class="ttc" id="structast__sip__session_html_aac4ee0b861f67a3db82eb3600c0f1624"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#aac4ee0b861f67a3db82eb3600c0f1624">ast_sip_session::pending_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * pending_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00211">res_pjsip_session.h:211</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ad8f4c88669e6520cc93dda53b5635eb0"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ad8f4c88669e6520cc93dda53b5635eb0">is_stream_limitation_reached</a></div><div class="ttdeci">static int is_stream_limitation_reached(enum ast_media_type type, const struct ast_sip_endpoint *endpoint, int *type_streams)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00592">res_pjsip_session.c:592</a></div></div>
<div class="ttc" id="stream_8h_html_a86319542b92fb0dc6b2ed337d83cf8ce"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a86319542b92fb0dc6b2ed337d83cf8ce">ast_stream_get_type</a></div><div class="ttdeci">enum ast_media_type ast_stream_get_type(const struct ast_stream *stream)</div><div class="ttdoc">Get the media type of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00316">stream.c:316</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a8a52106819ac5621fe89579644d4afd3"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a8a52106819ac5621fe89579644d4afd3">ast_sip_session_media_state_free</a></div><div class="ttdeci">void ast_sip_session_media_state_free(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Free a session media state structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00344">res_pjsip_session.c:344</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a3a7a6a1e5210478116a640b215ef53b4"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3a7a6a1e5210478116a640b215ef53b4">delay_request</a></div><div class="ttdeci">static int delay_request(struct ast_sip_session *session, ast_sip_session_request_creation_cb on_request, ast_sip_session_sdp_creation_cb on_sdp_creation, ast_sip_session_response_cb on_response, int generate_new_sdp, enum delayed_method method, struct ast_sip_session_media_state *pending_media_state, struct ast_sip_session_media_state *active_media_state, int queue_head)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01591">res_pjsip_session.c:1591</a></div></div>
<div class="ttc" id="structast__sip__endpoint__media__configuration_html_a250b131731bf019fe96a44c9473437f0"><div class="ttname"><a href="../../d3/d35/structast__sip__endpoint__media__configuration.html#a250b131731bf019fe96a44c9473437f0">ast_sip_endpoint_media_configuration::codecs</a></div><div class="ttdeci">struct ast_format_cap * codecs</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00770">res_pjsip.h:770</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="logger_8h_html_ac300475e729a060042d5fae346e6d966"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ac300475e729a060042d5fae346e6d966">ast_trace</a></div><div class="ttdeci">#define ast_trace(level,...)</div><div class="ttdoc">Print a basic trace message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00692">logger.h:692</a></div></div>
<div class="ttc" id="format__cap_8h_html_aefb7d3623f4d8a582168e7aaf509459c"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aefb7d3623f4d8a582168e7aaf509459c">ast_format_cap_count</a></div><div class="ttdeci">size_t ast_format_cap_count(const struct ast_format_cap *cap)</div><div class="ttdoc">Get the number of formats present within the capabilities structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00395">format_cap.c:395</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4a1884cde93e53bef32ca85c194a1d05"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4a1884cde93e53bef32ca85c194a1d05">AST_LIST_EMPTY</a></div><div class="ttdeci">#define AST_LIST_EMPTY(head)</div><div class="ttdoc">Checks whether the specified list contains any entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00449">linkedlists.h:449</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stream_8h_html_a452835913f7150a5045dd75ee822b491"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a></div><div class="ttdeci">int ast_stream_topology_append_stream(struct ast_stream_topology *topology, struct ast_stream *stream)</div><div class="ttdoc">Append a stream to the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00748">stream.c:748</a></div></div>
<div class="ttc" id="logger_8h_html_a469acd2a62f3cc8ab2f9f0b5e1c2b8ff"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a469acd2a62f3cc8ab2f9f0b5e1c2b8ff">SCOPE_EXIT_LOG_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_LOG_EXPR(__expr, __log_level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00946">logger.h:946</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
<div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="stream_8h_html_a8dc44f43dab4a5484631812d9bbc3ae9"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a8dc44f43dab4a5484631812d9bbc3ae9">ast_stream_set_formats</a></div><div class="ttdeci">void ast_stream_set_formats(struct ast_stream *stream, struct ast_format_cap *caps)</div><div class="ttdoc">Set the current negotiated formats of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00365">stream.c:365</a></div></div>
<div class="ttc" id="structast__sip__session_html_a88e7edbcbdea0569dc8ff0b74129c5f7"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a88e7edbcbdea0569dc8ff0b74129c5f7">ast_sip_session::active_media_state</a></div><div class="ttdeci">struct ast_sip_session_media_state * active_media_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00209">res_pjsip_session.h:209</a></div></div>
<div class="ttc" id="structast__sip__endpoint_html_a853a124d9bfb1a64ae46e067f5103381"><div class="ttname"><a href="../../d3/d46/structast__sip__endpoint.html#a853a124d9bfb1a64ae46e067f5103381">ast_sip_endpoint::media</a></div><div class="ttdeci">struct ast_sip_endpoint_media_configuration media</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8c/res__pjsip_8h_source.html#l00841">res_pjsip.h:841</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac438c3fcd3150481fad38689fd813a15"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac438c3fcd3150481fad38689fd813a15">ao2_bump</a></div><div class="ttdeci">#define ao2_bump(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00491">astobj2.h:491</a></div></div>
<div class="ttc" id="strings_8h_html_a68ab38eef5d5958cae536ba7589093cc"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a68ab38eef5d5958cae536ba7589093cc">ast_str_tmp</a></div><div class="ttdeci">#define ast_str_tmp(init_len, __expr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01136">strings.h:1136</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212acab76c9fe8b00719aa5276d92922f2ca">AST_MEDIA_TYPE_IMAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00034">codec.h:34</a></div></div>
<div class="ttc" id="stream_8h_html_a3da8d8e63718c47d43b9e738c7f6e55a"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a3da8d8e63718c47d43b9e738c7f6e55a">ast_stream_topology_to_str</a></div><div class="ttdeci">const char * ast_stream_topology_to_str(const struct ast_stream_topology *topology, struct ast_str **buf)</div><div class="ttdoc">Get a string representing the topology for debugging/display purposes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00936">stream.c:936</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4a45ea2ed73b0d235b9c47a857e727d00a">DELAYED_METHOD_INVITE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01296">res_pjsip_session.c:1296</a></div></div>
<div class="ttc" id="logger_8h_html_abcedcf1b206ca670f328a1d28c5af7a0"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#abcedcf1b206ca670f328a1d28c5af7a0">SCOPE_EXIT</a></div><div class="ttdeci">#define SCOPE_EXIT(...)</div><div class="ttdoc">Scope Exit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00805">logger.h:805</a></div></div>
<div class="ttc" id="stream_8h_html_ae8e2f46d218285e0f0ec97ba8ab77ffb"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ae8e2f46d218285e0f0ec97ba8ab77ffb">ast_stream_get_formats</a></div><div class="ttdeci">const struct ast_format_cap * ast_stream_get_formats(const struct ast_stream *stream)</div><div class="ttdoc">Get the current negotiated formats of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00330">stream.c:330</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="logger_8h_html_a91ab9408bcc739e24e6eab78d752585c"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a91ab9408bcc739e24e6eab78d752585c">SCOPE_EXIT_EXPR</a></div><div class="ttdeci">#define SCOPE_EXIT_EXPR(__expr,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00834">logger.h:834</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a36b830933f0110c5ea0a2c71d1c50b43"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a36b830933f0110c5ea0a2c71d1c50b43">generate_session_refresh_sdp</a></div><div class="ttdeci">static pjmedia_sdp_session * generate_session_refresh_sdp(struct ast_sip_session *session)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01621">res_pjsip_session.c:1621</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="stream_8h_html_ae0d846e650b6d3e654c01d61a991c82c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a></div><div class="ttdeci">int ast_stream_topology_equal(const struct ast_stream_topology *left, const struct ast_stream_topology *right)</div><div class="ttdoc">Compare two stream topologies to see if they are equal. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00696">stream.c:696</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a044356ace82a79fd7d127e97b03c7841">AST_MEDIA_TYPE_AUDIO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00032">codec.h:32</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a76c9ec6c960e59090e7c6301c1bce890"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a76c9ec6c960e59090e7c6301c1bce890">ast_sip_session_media_state_clone</a></div><div class="ttdeci">struct ast_sip_session_media_state * ast_sip_session_media_state_clone(const struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Clone a media state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00297">res_pjsip_session.c:297</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a95797137ac1484fe2214be36db22f6dd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a95797137ac1484fe2214be36db22f6dd">ast_sip_session_get_name</a></div><div class="ttdeci">const char * ast_sip_session_get_name(const struct ast_sip_session *session)</div><div class="ttdoc">Get the channel or endpoint name associated with the session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00115">res_pjsip_session.c:115</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="structast__sip__session_html_a398d12e89320d518a44032504f3e3298"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#a398d12e89320d518a44032504f3e3298">ast_sip_session::delayed_requests</a></div><div class="ttdeci">struct ast_sip_session::@309 delayed_requests</div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="stream_8h_html_acd53513fe1965d4e5d4581d79ef8d24c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#acd53513fe1965d4e5d4581d79ef8d24c">ast_stream_free</a></div><div class="ttdeci">void ast_stream_free(struct ast_stream *stream)</div><div class="ttdoc">Destroy a media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00292">stream.c:292</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a4086fb0449fa236dbbf9041e5a818e99">AST_MEDIA_TYPE_VIDEO</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00033">codec.h:33</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="stream_8h_html_a9dcdd3db33377db2e845ada4c281d1d6"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a9dcdd3db33377db2e845ada4c281d1d6">ast_stream_clone</a></div><div class="ttdeci">struct ast_stream * ast_stream_clone(const struct ast_stream *stream, const char *name)</div><div class="ttdoc">Create a deep clone of an existing stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00257">stream.c:257</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="stream_8h_html_a311bed754f00753d0fd141266ee0d282"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a311bed754f00753d0fd141266ee0d282">ast_stream_get_metadata</a></div><div class="ttdeci">const char * ast_stream_get_metadata(const struct ast_stream *stream, const char *m_key)</div><div class="ttdoc">Get a stream metadata value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00423">stream.c:423</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a6e71dd1b8a6901e044953ff9e3a0343d"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a6e71dd1b8a6901e044953ff9e3a0343d">ast_sip_session_send_request_with_cb</a></div><div class="ttdeci">void ast_sip_session_send_request_with_cb(struct ast_sip_session *session, pjsip_tx_data *tdata, ast_sip_session_response_cb on_response)</div><div class="ttdoc">Send a SIP request and get called back when a response is received. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02818">res_pjsip_session.c:2818</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ae02f331ac12ec53a9f072a9862405055"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ae02f331ac12ec53a9f072a9862405055">ast_sip_session_media_state_reset</a></div><div class="ttdeci">void ast_sip_session_media_state_reset(struct ast_sip_session_media_state *media_state)</div><div class="ttdoc">Reset a media state to a clean state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00278">res_pjsip_session.c:278</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00036">codec.h:36</a></div></div>
<div class="ttc" id="stream_8h_html_afcb45a1d2880128928cfb6d91b19ab46"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afcb45a1d2880128928cfb6d91b19ab46">ast_stream_get_name</a></div><div class="ttdeci">const char * ast_stream_get_name(const struct ast_stream *stream)</div><div class="ttdoc">Get the name of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00309">stream.c:309</a></div></div>
<div class="ttc" id="vector_8h_html_abe6d979239bef1a97d069b1a10c7d35c"><div class="ttname"><a href="../../d6/d68/vector_8h.html#abe6d979239bef1a97d069b1a10c7d35c">AST_VECTOR_REMOVE</a></div><div class="ttdeci">#define AST_VECTOR_REMOVE(vec, idx, preserve_ordered)</div><div class="ttdoc">Remove an element from a vector by index. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00412">vector.h:412</a></div></div>
<div class="ttc" id="format__cap_8h_html_a43950f716385bc78a73de04acd6a7eb4"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a43950f716385bc78a73de04acd6a7eb4">ast_format_cap_get_compatible</a></div><div class="ttdeci">int ast_format_cap_get_compatible(const struct ast_format_cap *cap1, const struct ast_format_cap *cap2, struct ast_format_cap *result)</div><div class="ttdoc">Find the compatible formats between two capabilities structures. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00630">format_cap.c:630</a></div></div>
<div class="ttc" id="stream_8h_html_a71a656802bd6b8e87846b42a5fb35a79"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a71a656802bd6b8e87846b42a5fb35a79">ast_stream_topology_del_stream</a></div><div class="ttdeci">int ast_stream_topology_del_stream(struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Delete a specified stream from the given topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00825">stream.c:825</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
<div class="ttc" id="structast__stream_html_a1d7b72031fa39d396d531503904f337b"><div class="ttname"><a href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">ast_stream::position</a></div><div class="ttdeci">unsigned int position</div><div class="ttdoc">The position of the stream in the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00090">stream.c:90</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5dad843b27d741d62518be05c259d9b4ad9326545608de73e4bdefd8b65972e27">DELAYED_METHOD_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01297">res_pjsip_session.c:1297</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ac4bf8de5db02001daabfc303b49c6d3a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ac4bf8de5db02001daabfc303b49c6d3a">resolve_refresh_media_states</a></div><div class="ttdeci">static struct ast_sip_session_media_state * resolve_refresh_media_states(const char *session_name, struct ast_sip_session_media_state *delayed_pending_state, struct ast_sip_session_media_state *delayed_active_state, struct ast_sip_session_media_state *current_active_state, int run_post_validation)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01835">res_pjsip_session.c:1835</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5355aaa265e4a9ef57068b7dd8140870"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5355aaa265e4a9ef57068b7dd8140870">&#9670;&nbsp;</a></span>sip_session_suspend_task()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int sip_session_suspend_task </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03134">3134</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00718">ao2_lock</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00476">ao2_object_get_lockaddr()</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00730">ao2_unlock</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00201">ast_cond_signal</a>, <a class="el" href="../../dd/d42/lock_8h_source.html#l00203">ast_cond_wait</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03115">ast_sip_session_suspender::complete</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">ast_sip_session_suspender::cond_complete</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">ast_sip_session_suspender::cond_suspended</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03114">ast_sip_session_suspender::suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">ast_sip_session_suspend()</a>.</p>
<div class="fragment"><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;{</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a> *suspender = data;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(suspender);</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;   <span class="comment">/* Signal that the serializer task is now suspended. */</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;   suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#af62c9334e77989174caccf53beee4215">suspended</a> = 1;</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">cond_suspended</a>);</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;   <span class="comment">/* Wait for the serializer suspension to be completed. */</span></div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;   <span class="keywordflow">while</span> (!suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a520408f4775914f7510cc59db5a60b38">complete</a>) {</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a>(&amp;suspender-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">cond_complete</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a>(suspender));</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;   }</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(suspender);</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(suspender, -1);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;}</div><div class="ttc" id="lock_8h_html_a36233c5520173c095bf732a788356aee"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a36233c5520173c095bf732a788356aee">ast_cond_wait</a></div><div class="ttdeci">#define ast_cond_wait(cond, mutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00203">lock.h:203</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="lock_8h_html_ae2cdf274a5da241c3ad7324d82bf6af0"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ae2cdf274a5da241c3ad7324d82bf6af0">ast_cond_signal</a></div><div class="ttdeci">#define ast_cond_signal(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00201">lock.h:201</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a36ab60bbf09cfc0f5a3d5d41ed10cf81"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">ast_sip_session_suspender::cond_complete</a></div><div class="ttdeci">ast_cond_t cond_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">res_pjsip_session.c:3113</a></div></div>
<div class="ttc" id="astobj2_8h_html_a503b6c7ced96f9b56ec59c115cbeb29a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a503b6c7ced96f9b56ec59c115cbeb29a">ao2_object_get_lockaddr</a></div><div class="ttdeci">void * ao2_object_get_lockaddr(void *obj)</div><div class="ttdoc">Return the mutex lock address of an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00476">astobj2.c:476</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_a520408f4775914f7510cc59db5a60b38"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a520408f4775914f7510cc59db5a60b38">ast_sip_session_suspender::complete</a></div><div class="ttdeci">int complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03115">res_pjsip_session.c:3115</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_ad5a799b56c95ee841cdd4c0cfca4484e"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">ast_sip_session_suspender::cond_suspended</a></div><div class="ttdeci">ast_cond_t cond_suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">res_pjsip_session.c:3112</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a></div><div class="ttdoc">struct controlling the suspension of the session&amp;#39;s serializer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03111">res_pjsip_session.c:3111</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_af62c9334e77989174caccf53beee4215"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#af62c9334e77989174caccf53beee4215">ast_sip_session_suspender::suspended</a></div><div class="ttdeci">int suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03114">res_pjsip_session.c:3114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c7aeb0cc811ca617953f8b4c24a39f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c7aeb0cc811ca617953f8b4c24a39f6">&#9670;&nbsp;</a></span>sip_session_suspender_dtor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void sip_session_suspender_dtor </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vdoomed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03118">3118</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d42/lock_8h_source.html#l00200">ast_cond_destroy</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">ast_sip_session_suspender::cond_complete</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">ast_sip_session_suspender::cond_suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03155">ast_sip_session_suspend()</a>.</p>
<div class="fragment"><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;{</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a> *doomed = vdoomed;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a>(&amp;doomed-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">cond_suspended</a>);</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a>(&amp;doomed-&gt;<a class="code" href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">cond_complete</a>);</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;}</div><div class="ttc" id="structast__sip__session__suspender_html_a36ab60bbf09cfc0f5a3d5d41ed10cf81"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#a36ab60bbf09cfc0f5a3d5d41ed10cf81">ast_sip_session_suspender::cond_complete</a></div><div class="ttdeci">ast_cond_t cond_complete</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03113">res_pjsip_session.c:3113</a></div></div>
<div class="ttc" id="lock_8h_html_a1ea2f4040a736cddbecea48b30ffedfd"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a1ea2f4040a736cddbecea48b30ffedfd">ast_cond_destroy</a></div><div class="ttdeci">#define ast_cond_destroy(cond)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00200">lock.h:200</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html_ad5a799b56c95ee841cdd4c0cfca4484e"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html#ad5a799b56c95ee841cdd4c0cfca4484e">ast_sip_session_suspender::cond_suspended</a></div><div class="ttdeci">ast_cond_t cond_suspended</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03112">res_pjsip_session.c:3112</a></div></div>
<div class="ttc" id="structast__sip__session__suspender_html"><div class="ttname"><a href="../../dd/da0/structast__sip__session__suspender.html">ast_sip_session_suspender</a></div><div class="ttdoc">struct controlling the suspension of the session&amp;#39;s serializer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03111">res_pjsip_session.c:3111</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af7feb7dfdc1b1c6d0684931bfc7c5cfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7feb7dfdc1b1c6d0684931bfc7c5cfe">&#9670;&nbsp;</a></span>stream_destroy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int stream_destroy </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00456">456</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../da/d03/test__ari_8c_source.html#l00059">handler()</a>, <a class="el" href="../../d9/d38/structsdp__handler__list.html#a0089e5f7869c0acbf1c7790efa24c198">sdp_handler_list::list</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">ast_sip_session_sdp_handler::next</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00458">ast_sip_session_sdp_handler::stream_destroy</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">session_media_dtor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a> *handler_list = obj;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = arg;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a> *<a class="code" href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;handler_list-&gt;<a class="code" href="../../d9/d38/structsdp__handler__list.html#a0089e5f7869c0acbf1c7790efa24c198">list</a>, handler, <a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">next</a>) {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      handler-&gt;<a class="code" href="../../d2/d29/structast__sip__session__sdp__handler.html#a679b31623d9592818d5713da9a768d61">stream_destroy</a>(session_media);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div><div class="ttc" id="structast__sip__session__sdp__handler_html_a679b31623d9592818d5713da9a768d61"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#a679b31623d9592818d5713da9a768d61">ast_sip_session_sdp_handler::stream_destroy</a></div><div class="ttdeci">void(* stream_destroy)(struct ast_sip_session_media *session_media)</div><div class="ttdoc">Destroy a session_media created by this handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00458">res_pjsip_session.h:458</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html">ast_sip_session_sdp_handler</a></div><div class="ttdoc">A handler for SDPs in SIP sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00380">res_pjsip_session.h:380</a></div></div>
<div class="ttc" id="structast__sip__session__sdp__handler_html_aaa4f9cdda5dd0b1270fb35523054926c"><div class="ttname"><a href="../../d2/d29/structast__sip__session__sdp__handler.html#aaa4f9cdda5dd0b1270fb35523054926c">ast_sip_session_sdp_handler::next</a></div><div class="ttdeci">struct ast_sip_session_sdp_handler * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00460">res_pjsip_session.h:460</a></div></div>
<div class="ttc" id="structsdp__handler__list_html_a0089e5f7869c0acbf1c7790efa24c198"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html#a0089e5f7869c0acbf1c7790efa24c198">sdp_handler_list::list</a></div><div class="ttdeci">struct sdp_handler_list::@487 list</div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structsdp__handler__list_html"><div class="ttname"><a href="../../d9/d38/structsdp__handler__list.html">sdp_handler_list</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00098">res_pjsip_session.c:98</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="test__ari_8c_html_a695cc202c7a2869aa8202bb20726ea3c"><div class="ttname"><a href="../../da/d03/test__ari_8c.html#a695cc202c7a2869aa8202bb20726ea3c">handler</a></div><div class="ttdeci">static void handler(const char *name, int response_code, struct ast_variable *get_params, struct ast_variable *path_vars, struct ast_variable *headers, struct ast_json *body, struct ast_ari_response *response)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d03/test__ari_8c_source.html#l00059">test_ari.c:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a503fddc1714b2b2181dfd374fd82d48b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a503fddc1714b2b2181dfd374fd82d48b">&#9670;&nbsp;</a></span>test_is_media_session_equal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_is_media_session_equal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *&#160;</td>
          <td class="paramname"><em>right</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05580">5580</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05596">test_is_media_state_equal()</a>.</p>
<div class="fragment"><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;{</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;   <span class="keywordflow">if</span> (left == right) {</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;   }</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;   <span class="keywordflow">if</span> (!left) {</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;   }</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;   <span class="keywordflow">if</span> (!right) {</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;   }</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;   <span class="keywordflow">return</span> memcmp(left, right, <span class="keyword">sizeof</span>(*left)) == 0;</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a665f3aebf906cea9fb5aff0786a4507f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a665f3aebf906cea9fb5aff0786a4507f">&#9670;&nbsp;</a></span>test_is_media_state_equal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int test_is_media_state_equal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>left</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>right</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>assert_on_failure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05596">5596</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d1/d16/codec_8h_source.html#l00036">AST_MEDIA_TYPE_END</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00696">ast_stream_topology_equal()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00682">AST_VECTOR_GET</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00670">AST_VECTOR_GET_ADDR</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00611">AST_VECTOR_SIZE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00119">ast_sip_session_media::label</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00780">SCOPE_ENTER</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00875">SCOPE_EXIT_RTN_VALUE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">ast_sip_session_media::stream_num</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05580">test_is_media_session_equal()</a>, and <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>.</p>
<div class="fragment"><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;{</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a>(2);</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;   <span class="keywordflow">if</span> (left == right) {</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(1, <span class="stringliteral">&quot;equal\n&quot;</span>);</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;   }</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;   <span class="keywordflow">if</span> (!(left &amp;&amp; right)) {</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!assert_on_failure);</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;one is null: left: %p  right: %p\n&quot;</span>, left, right);</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;   }</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a>(left-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, right-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>)) {</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!assert_on_failure);</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;topologies differ\n&quot;</span>);</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;   }</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;left-&gt;sessions) != <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;right-&gt;sessions)) {</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!assert_on_failure);</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;session vector sizes different: left %zu != right %zu\n&quot;</span>,</div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;left-&gt;sessions),</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;right-&gt;sessions));</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;   }</div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;left-&gt;read_callbacks) != <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;right-&gt;read_callbacks)) {</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!assert_on_failure);</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;read_callback vector sizes different: left %zu != right %zu\n&quot;</span>,</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;left-&gt;read_callbacks),</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;         <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;right-&gt;read_callbacks));</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;   }</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;left-&gt;sessions) ; i++) {</div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a503fddc1714b2b2181dfd374fd82d48b">test_is_media_session_equal</a>(<a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;left-&gt;sessions, i), <a class="code" href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a>(&amp;right-&gt;sessions, i))) {</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!assert_on_failure);</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;Media session %d different\n&quot;</span>, i);</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;      }</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;   }</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;</div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a>(&amp;left-&gt;read_callbacks) ; i++) {</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      <span class="keywordflow">if</span> (memcmp(<a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(&amp;left-&gt;read_callbacks, i),</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;            <a class="code" href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a>(&amp;right-&gt;read_callbacks, i),</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a>)) != 0) {</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!assert_on_failure);</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;read_callback %d different\n&quot;</span>, i);</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      }</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;   }</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a>; i++) {</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;      <span class="keywordflow">if</span> (!(left-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i] &amp;&amp; right-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i])) {</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;      }</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;      <span class="keywordflow">if</span> (!left-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i] || !right-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i]</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;         || left-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i]-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">stream_num</a> != right-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i]-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">stream_num</a>) {</div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(!assert_on_failure);</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(0, <span class="stringliteral">&quot;Default media session %d different.  Left: %s  Right: %s\n&quot;</span>, i,</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;            left-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i] ? left-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i]-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a> : <span class="stringliteral">&quot;null&quot;</span>,</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;            right-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i] ? right-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[i]-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a> : <span class="stringliteral">&quot;null&quot;</span>);</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      }</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;   }</div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;</div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a>(1, <span class="stringliteral">&quot;equal\n&quot;</span>);</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;}</div><div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a503fddc1714b2b2181dfd374fd82d48b"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a503fddc1714b2b2181dfd374fd82d48b">test_is_media_session_equal</a></div><div class="ttdeci">static int test_is_media_session_equal(struct ast_sip_session_media *left, struct ast_sip_session_media *right)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05580">res_pjsip_session.c:5580</a></div></div>
<div class="ttc" id="vector_8h_html_af613aa5306ff5ad101734708861d634e"><div class="ttname"><a href="../../d6/d68/vector_8h.html#af613aa5306ff5ad101734708861d634e">AST_VECTOR_GET_ADDR</a></div><div class="ttdeci">#define AST_VECTOR_GET_ADDR(vec, idx)</div><div class="ttdoc">Get an address of element in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00670">vector.h:670</a></div></div>
<div class="ttc" id="structast__sip__session__media__read__callback__state_html"><div class="ttname"><a href="../../d2/d7e/structast__sip__session__media__read__callback__state.html">ast_sip_session_media_read_callback_state</a></div><div class="ttdoc">Structure which contains read callback information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00133">res_pjsip_session.h:133</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a8383e75e786449dd2f4258b0819dd8f1"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">ast_sip_session_media::stream_num</a></div><div class="ttdeci">int stream_num</div><div class="ttdoc">The stream number to place into any resulting frames. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">res_pjsip_session.h:109</a></div></div>
<div class="ttc" id="stream_8h_html_ae0d846e650b6d3e654c01d61a991c82c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#ae0d846e650b6d3e654c01d61a991c82c">ast_stream_topology_equal</a></div><div class="ttdeci">int ast_stream_topology_equal(const struct ast_stream_topology *left, const struct ast_stream_topology *right)</div><div class="ttdoc">Compare two stream topologies to see if they are equal. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00696">stream.c:696</a></div></div>
<div class="ttc" id="logger_8h_html_a6b8ff8a8d4420d96aa103bc4b01b965f"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a6b8ff8a8d4420d96aa103bc4b01b965f">SCOPE_ENTER</a></div><div class="ttdeci">#define SCOPE_ENTER(level,...)</div><div class="ttdoc">Non RAII_VAR Scope Trace macros The advantage of these macros is that the EXITs will have the actual ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00780">logger.h:780</a></div></div>
<div class="ttc" id="logger_8h_html_a57e630b146704e4ca08289ff7b9c91f8"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a57e630b146704e4ca08289ff7b9c91f8">SCOPE_EXIT_RTN_VALUE</a></div><div class="ttdeci">#define SCOPE_EXIT_RTN_VALUE(__return_value,...)</div><div class="ttdoc">Scope Exit with return value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00875">logger.h:875</a></div></div>
<div class="ttc" id="vector_8h_html_aef32ac52c3e8a530d16eb92cde22cacd"><div class="ttname"><a href="../../d6/d68/vector_8h.html#aef32ac52c3e8a530d16eb92cde22cacd">AST_VECTOR_GET</a></div><div class="ttdeci">#define AST_VECTOR_GET(vec, idx)</div><div class="ttdoc">Get an element from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00682">vector.h:682</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a45bbe8d6a0166c19b5c4650fc08112ae"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">ast_sip_session_media::label</a></div><div class="ttdeci">char label[AST_UUID_STR_LEN]</div><div class="ttdoc">Track label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00119">res_pjsip_session.h:119</a></div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a412130c13f852573e1e662864d35b55c">AST_MEDIA_TYPE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00036">codec.h:36</a></div></div>
<div class="ttc" id="vector_8h_html_a20b08af81cc9452fb721c9a698f81bdf"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a20b08af81cc9452fb721c9a698f81bdf">AST_VECTOR_SIZE</a></div><div class="ttdeci">#define AST_VECTOR_SIZE(vec)</div><div class="ttdoc">Get the number of elements in a vector. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00611">vector.h:611</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb3af098344ad4dbf62bff06fcd16630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb3af098344ad4dbf62bff06fcd16630">&#9670;&nbsp;</a></span>test_media_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a>* test_media_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../de/dd5/structast__sip__session__media__state.html">ast_sip_session_media_state</a> *&#160;</td>
          <td class="paramname"><em>media_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>position</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05536">5536</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00369">AO2_ALLOC_OPT_LOCK_NOLOCK</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00406">ao2_alloc_options</a>, <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00373">ast_stream_get_state()</a>, <a class="el" href="../../d8/d95/stream_8h_source.html#l00078">AST_STREAM_STATE_REMOVED</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00748">ast_stream_topology_append_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00765">ast_stream_topology_get_count()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00788">ast_stream_topology_get_stream()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00796">ast_stream_topology_set_stream()</a>, <a class="el" href="../../d6/d68/vector_8h_source.html#l00284">AST_VECTOR_REPLACE</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">ast_sip_session_media::bundle_group</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">ast_sip_session_media_state::default_session</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00091">ast_sip_session_media::keepalive_sched_id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00119">ast_sip_session_media::label</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00090">ast_stream::position</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">session_media_dtor()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">ast_sip_session_media::stream_num</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05523">test_stream_alloc()</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00093">ast_sip_session_media::timeout_sched_id</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">ast_sip_session_media_state::topology</a>, <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">ast_sip_session_media::type</a>, and <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00109">type</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05660">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;{</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a> *session_media = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;   stream = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5f3e0b51d441cd66de7e4a31db44d150">test_stream_alloc</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <a class="code" href="../../d4/d88/structstate.html">state</a>);</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;   <span class="keywordflow">if</span> (!stream) {</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;   }</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a> &gt;= 0 &amp;&amp; <a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a> &lt; <a class="code" href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>)) {</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;      <a class="code" href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, <a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a>, stream);</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;      <a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a> = <a class="code" href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, stream);</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;   }</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;   session_media = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*session_media), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a7a1020cea0d78fe4969869c10fd93973">session_media_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;   <span class="keywordflow">if</span> (!session_media) {</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;   }</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#af723510e5f7d3a2c82f5b9fe1e16802f">keepalive_sched_id</a> = -1;</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a75b67fe2a02f4641321116ad6fa0253d">timeout_sched_id</a> = -1;</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">type</a> = <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">stream_num</a> = <a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a>;</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;   session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">bundle_group</a> = -1;</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;   strcpy(session_media-&gt;<a class="code" href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">label</a>, <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a>(&amp;media_state-&gt;sessions, <a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a>, session_media)) {</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(session_media, -1);</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;   }</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;   <span class="comment">/* If this stream will be active in some way and it is the first of this type then consider this the default media session to match */</span></div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;   <span class="keywordflow">if</span> (!media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] &amp;&amp; <a class="code" href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a>(<a class="code" href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a>(media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">topology</a>, <a class="code" href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">position</a>)) != <a class="code" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a>) {</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;      media_state-&gt;<a class="code" href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">default_session</a>[<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>] = session_media;</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;   }</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;   <span class="keywordflow">return</span> session_media;</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="stream_8h_html_a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288adda44d968899f20b2f5c167d38ab23e7">AST_STREAM_STATE_REMOVED</a></div><div class="ttdoc">Set when the stream has been removed/declined. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d95/stream_8h_source.html#l00078">stream.h:78</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a8ce77d5f41c03bf330b7699e41fac6c3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a8ce77d5f41c03bf330b7699e41fac6c3">ast_sip_session_media_state::default_session</a></div><div class="ttdeci">struct ast_sip_session_media * default_session[AST_MEDIA_TYPE_END]</div><div class="ttdoc">Default media sessions for each type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00151">res_pjsip_session.h:151</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="stream_8h_html_aa4a9c0de95417c5db8eda8544cd1631d"><div class="ttname"><a href="../../d8/d95/stream_8h.html#aa4a9c0de95417c5db8eda8544cd1631d">ast_stream_topology_get_stream</a></div><div class="ttdeci">struct ast_stream * ast_stream_topology_get_stream(const struct ast_stream_topology *topology, unsigned int position)</div><div class="ttdoc">Get a specific stream from the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00788">stream.c:788</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="stream_8h_html_a452835913f7150a5045dd75ee822b491"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a452835913f7150a5045dd75ee822b491">ast_stream_topology_append_stream</a></div><div class="ttdeci">int ast_stream_topology_append_stream(struct ast_stream_topology *topology, struct ast_stream *stream)</div><div class="ttdoc">Append a stream to the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00748">stream.c:748</a></div></div>
<div class="ttc" id="stream_8h_html_a1bec3fe997f1085a3095cd46e8208b20"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a1bec3fe997f1085a3095cd46e8208b20">ast_stream_topology_set_stream</a></div><div class="ttdeci">int ast_stream_topology_set_stream(struct ast_stream_topology *topology, unsigned int position, struct ast_stream *stream)</div><div class="ttdoc">Set a specific position in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00796">stream.c:796</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a8383e75e786449dd2f4258b0819dd8f1"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a8383e75e786449dd2f4258b0819dd8f1">ast_sip_session_media::stream_num</a></div><div class="ttdeci">int stream_num</div><div class="ttdoc">The stream number to place into any resulting frames. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00109">res_pjsip_session.h:109</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a7a1020cea0d78fe4969869c10fd93973"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a7a1020cea0d78fe4969869c10fd93973">session_media_dtor</a></div><div class="ttdeci">static void session_media_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00469">res_pjsip_session.c:469</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a5f3e0b51d441cd66de7e4a31db44d150"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5f3e0b51d441cd66de7e4a31db44d150">test_stream_alloc</a></div><div class="ttdeci">static struct ast_stream * test_stream_alloc(const char *name, enum ast_media_type type, enum ast_stream_state state)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l05523">res_pjsip_session.c:5523</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a75b67fe2a02f4641321116ad6fa0253d"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a75b67fe2a02f4641321116ad6fa0253d">ast_sip_session_media::timeout_sched_id</a></div><div class="ttdeci">int timeout_sched_id</div><div class="ttdoc">Scheduler ID for RTP timeout. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00093">res_pjsip_session.h:93</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a881aec0b280ab825a2019a19e7886a20"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a881aec0b280ab825a2019a19e7886a20">ast_sip_session_media::bundle_group</a></div><div class="ttdeci">int bundle_group</div><div class="ttdoc">The bundle group the stream belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00113">res_pjsip_session.h:113</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="stream_8h_html_a5eb43440630db819220df97b01f48922"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a5eb43440630db819220df97b01f48922">ast_stream_topology_get_count</a></div><div class="ttdeci">int ast_stream_topology_get_count(const struct ast_stream_topology *topology)</div><div class="ttdoc">Get the number of streams in a topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00765">stream.c:765</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_af723510e5f7d3a2c82f5b9fe1e16802f"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#af723510e5f7d3a2c82f5b9fe1e16802f">ast_sip_session_media::keepalive_sched_id</a></div><div class="ttdeci">int keepalive_sched_id</div><div class="ttdoc">Scheduler ID for RTP keepalive. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00091">res_pjsip_session.h:91</a></div></div>
<div class="ttc" id="structast__sip__session__media_html"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html">ast_sip_session_media</a></div><div class="ttdoc">A structure containing SIP session media information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00075">res_pjsip_session.h:75</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a57b08a6ad7a004d70eba4a1b6867a084"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a57b08a6ad7a004d70eba4a1b6867a084">ast_sip_session_media::type</a></div><div class="ttdeci">enum ast_media_type type</div><div class="ttdoc">Media type of this session media. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00105">res_pjsip_session.h:105</a></div></div>
<div class="ttc" id="structast__sip__session__media__state_html_a15d14a20c2f5eb81b8b933304dce2ea3"><div class="ttname"><a href="../../de/dd5/structast__sip__session__media__state.html#a15d14a20c2f5eb81b8b933304dce2ea3">ast_sip_session_media_state::topology</a></div><div class="ttdeci">struct ast_stream_topology * topology</div><div class="ttdoc">The media stream topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00153">res_pjsip_session.h:153</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
<div class="ttc" id="vector_8h_html_a0ae01511d65b3fa02bb10165a28f9581"><div class="ttname"><a href="../../d6/d68/vector_8h.html#a0ae01511d65b3fa02bb10165a28f9581">AST_VECTOR_REPLACE</a></div><div class="ttdeci">#define AST_VECTOR_REPLACE(vec, idx, elem)</div><div class="ttdoc">Replace an element at a specific position in a vector, growing the vector if needed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d68/vector_8h_source.html#l00284">vector.h:284</a></div></div>
<div class="ttc" id="structast__sip__session__media_html_a45bbe8d6a0166c19b5c4650fc08112ae"><div class="ttname"><a href="../../d0/d23/structast__sip__session__media.html#a45bbe8d6a0166c19b5c4650fc08112ae">ast_sip_session_media::label</a></div><div class="ttdeci">char label[AST_UUID_STR_LEN]</div><div class="ttdoc">Track label. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00119">res_pjsip_session.h:119</a></div></div>
<div class="ttc" id="stream_8h_html_a6fdfb5754dad81680c197d5c9df44971"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a6fdfb5754dad81680c197d5c9df44971">ast_stream_get_state</a></div><div class="ttdeci">enum ast_stream_state ast_stream_get_state(const struct ast_stream *stream)</div><div class="ttdoc">Get the current state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00373">stream.c:373</a></div></div>
<div class="ttc" id="structast__stream_html_a1d7b72031fa39d396d531503904f337b"><div class="ttname"><a href="../../d4/d17/structast__stream.html#a1d7b72031fa39d396d531503904f337b">ast_stream::position</a></div><div class="ttdeci">unsigned int position</div><div class="ttdoc">The position of the stream in the topology. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00090">stream.c:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f3e0b51d441cd66de7e4a31db44d150"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f3e0b51d441cd66de7e4a31db44d150">&#9670;&nbsp;</a></span>test_stream_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="../../d4/d17/structast__stream.html">ast_stream</a>* test_stream_alloc </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212">ast_media_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../d8/d95/stream_8h.html#a343d6a412f1391cbbe60bbc1736f3288">ast_stream_state</a>&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05523">5523</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d4d/stream_8c_source.html#l00233">ast_stream_alloc()</a>, <a class="el" href="../../d8/d4d/stream_8c_source.html#l00380">ast_stream_set_state()</a>, and <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05536">test_media_add()</a>.</p>
<div class="fragment"><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;{</div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d17/structast__stream.html">ast_stream</a> *stream;</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;   stream = <a class="code" href="../../d8/d95/stream_8h.html#afd6abeccf161767b676a3cb54715df2c">ast_stream_alloc</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>, <a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>);</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;   <span class="keywordflow">if</span> (!stream) {</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;   }</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;   <a class="code" href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a>(stream, <a class="code" href="../../d4/d88/structstate.html">state</a>);</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;   <span class="keywordflow">return</span> stream;</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;}</div><div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="stream_8h_html_a4459bba3b00250f5c5b2b4ae265909ee"><div class="ttname"><a href="../../d8/d95/stream_8h.html#a4459bba3b00250f5c5b2b4ae265909ee">ast_stream_set_state</a></div><div class="ttdeci">void ast_stream_set_state(struct ast_stream *stream, enum ast_stream_state state)</div><div class="ttdoc">Set the state of a stream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00380">stream.c:380</a></div></div>
<div class="ttc" id="structstate_html"><div class="ttname"><a href="../../d4/d88/structstate.html">state</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l00158">localtime.c:158</a></div></div>
<div class="ttc" id="stream_8h_html_afd6abeccf161767b676a3cb54715df2c"><div class="ttname"><a href="../../d8/d95/stream_8h.html#afd6abeccf161767b676a3cb54715df2c">ast_stream_alloc</a></div><div class="ttdeci">struct ast_stream * ast_stream_alloc(const char *name, enum ast_media_type type)</div><div class="ttdoc">Create a new media stream representation. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00233">stream.c:233</a></div></div>
<div class="ttc" id="structast__stream_html"><div class="ttname"><a href="../../d4/d17/structast__stream.html">ast_stream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4d/stream_8c_source.html#l00081">stream.c:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06108">6108</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l01958">ao2_cleanup</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00316">AST_MODFLAG_GLOBAL_SYMBOLS</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00317">AST_MODFLAG_LOAD_ORDER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00328">AST_MODPRI_APP_DEPEND</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">ast_sip_get_sorcery()</a>, <a class="el" href="../../de/d96/res__pjsip_8c_source.html#l03331">ast_sip_unregister_service()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02233">ast_sorcery_delete()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00128">AST_TEST_UNREGISTER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, and <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06074">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;{</div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(test_resolve_refresh_media_states);</div><div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a724b2cc287d0952c4bbb94bc14c3d5b6">outbound_invite_auth_module</a>);</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a5c77944ce4b545d91f1d14b67fe4d525">session_reinvite_module</a>);</div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;   <a class="code" href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a>(&amp;<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a>);</div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;   <a class="code" href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a>(<a class="code" href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a>(), <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a>);</div><div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a>);</div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(<a class="code" href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a>);</div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;}</div><div class="ttc" id="res__pjsip__session_8c_html_a5c77944ce4b545d91f1d14b67fe4d525"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a5c77944ce4b545d91f1d14b67fe4d525">session_reinvite_module</a></div><div class="ttdeci">static pjsip_module session_reinvite_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02812">res_pjsip_session.c:2812</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a75076a42e720601f2234ac8a927ea4f9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a75076a42e720601f2234ac8a927ea4f9">nat_hook</a></div><div class="ttdeci">static struct ast_sip_nat_hook * nat_hook</div><div class="ttdoc">NAT hook for modifying outgoing messages with SDP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00084">res_pjsip_session.c:84</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a259b93d37fd46042989580ad586ac572"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a259b93d37fd46042989580ad586ac572">session_module</a></div><div class="ttdeci">static pjsip_module session_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">res_pjsip_session.c:2587</a></div></div>
<div class="ttc" id="sorcery_8h_html_aeb9bd9c0bcdaff27ac438a02d472c3b1"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#aeb9bd9c0bcdaff27ac438a02d472c3b1">ast_sorcery_delete</a></div><div class="ttdeci">int ast_sorcery_delete(const struct ast_sorcery *sorcery, void *object)</div><div class="ttdoc">Delete an object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02233">sorcery.c:2233</a></div></div>
<div class="ttc" id="test_8h_html_a79bc64a935b14b1b181156e5ada58ead"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a></div><div class="ttdeci">#define AST_TEST_UNREGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00128">test.h:128</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a5572d52daf1a841b0f9308df901448c8"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a5572d52daf1a841b0f9308df901448c8">ast_sip_get_sorcery</a></div><div class="ttdeci">struct ast_sorcery * ast_sip_get_sorcery(void)</div><div class="ttdoc">Get a pointer to the SIP sorcery structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df6/pjsip__configuration_8c_source.html#l02404">pjsip_configuration.c:2404</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="res__pjsip_8h_html_a15aa09d9084763cdd20b7467a4cd381a"><div class="ttname"><a href="../../d8/d8c/res__pjsip_8h.html#a15aa09d9084763cdd20b7467a4cd381a">ast_sip_unregister_service</a></div><div class="ttdeci">void ast_sip_unregister_service(pjsip_module *module)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l03331">res_pjsip.c:3331</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_aa34c0d9bc537c0b29225b0e92ccda6c9"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#aa34c0d9bc537c0b29225b0e92ccda6c9">sdp_handlers</a></div><div class="ttdeci">static struct ao2_container * sdp_handlers</div><div class="ttdoc">Registered SDP stream handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">res_pjsip_session.c:93</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a724b2cc287d0952c4bbb94bc14c3d5b6"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a724b2cc287d0952c4bbb94bc14c3d5b6">outbound_invite_auth_module</a></div><div class="ttdeci">static pjsip_module outbound_invite_auth_module</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03290">res_pjsip_session.c:3290</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="accef4530d306b2c1be2026b84f9f4327"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accef4530d306b2c1be2026b84f9f4327">&#9670;&nbsp;</a></span>update_completed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int update_completed </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vsession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01568">1568</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

<p class="reference">References <a class="el" href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">ast_sip_session::inv_session</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">invite_proceeding()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">invite_terminated()</a>, and <a class="el" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l04731">session_inv_on_tsx_state_changed()</a>.</p>
<div class="fragment"><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;{</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dec/structast__sip__session.html">ast_sip_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = vsession;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">inv_session</a>-&gt;invite_tsx) {</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;      res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#ab41b92c23f551a348423f5c0721d963a">invite_proceeding</a>(session);</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      res = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a70774e88c7455a8dae6a9b8878916abd">invite_terminated</a>(session);</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;   }</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;}</div><div class="ttc" id="structast__sip__session_html_ab9fd713b198a122cb52c7f10bd66d1c6"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html#ab9fd713b198a122cb52c7f10bd66d1c6">ast_sip_session::inv_session</a></div><div class="ttdeci">struct pjsip_inv_session * inv_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00187">res_pjsip_session.h:187</a></div></div>
<div class="ttc" id="res__pjsip__session_8c_html_a70774e88c7455a8dae6a9b8878916abd"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a70774e88c7455a8dae6a9b8878916abd">invite_terminated</a></div><div class="ttdeci">static int invite_terminated(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01487">res_pjsip_session.c:1487</a></div></div>
<div class="ttc" id="structast__sip__session_html"><div class="ttname"><a href="../../d2/dec/structast__sip__session.html">ast_sip_session</a></div><div class="ttdoc">A structure describing a SIP session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/res__pjsip__session_8h_source.html#l00179">res_pjsip_session.h:179</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="res__pjsip__session_8c_html_ab41b92c23f551a348423f5c0721d963a"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#ab41b92c23f551a348423f5c0721d963a">invite_proceeding</a></div><div class="ttdeci">static int invite_proceeding(void *vsession)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l01440">res_pjsip_session.c:1440</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a> , .description = &quot;PJSIP Session resource&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = &quot;30ef0c93b36035ec78c9cfd712d36d9b&quot; , .support_level = AST_MODULE_SUPPORT_CORE, .load = load_module, .unload = unload_module, .load_pri = AST_MODPRI_APP_DEPEND, .requires = &quot;res_pjsip&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06128">6128</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l06128">6128</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="a7434c8ec76e08306dd925b85a655365a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7434c8ec76e08306dd925b85a655365a">&#9670;&nbsp;</a></span>inv_callback</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_inv_callback inv_callback</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l05446">5446</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="a75076a42e720601f2234ac8a927ea4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75076a42e720601f2234ac8a927ea4f9">&#9670;&nbsp;</a></span>nat_hook</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/dfb/structast__sip__nat__hook.html">ast_sip_nat_hook</a>* nat_hook</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>NAT hook for modifying outgoing messages with SDP. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00084">84</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="a724b2cc287d0952c4bbb94bc14c3d5b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a724b2cc287d0952c4bbb94bc14c3d5b6">&#9670;&nbsp;</a></span>outbound_invite_auth_module</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_module outbound_invite_auth_module</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .name = {<span class="stringliteral">&quot;Outbound INVITE Auth&quot;</span>, 20},</div><div class="line">   .priority = PJSIP_MOD_PRIORITY_DIALOG_USAGE,</div><div class="line">   .on_rx_response = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a3a891fa1c68e014308f0bddde4da12da">outbound_invite_auth</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__session_8c_html_a3a891fa1c68e014308f0bddde4da12da"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a3a891fa1c68e014308f0bddde4da12da">outbound_invite_auth</a></div><div class="ttdeci">static pj_bool_t outbound_invite_auth(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l03231">res_pjsip_session.c:3231</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03290">3290</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="aa34c0d9bc537c0b29225b0e92ccda6c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa34c0d9bc537c0b29225b0e92ccda6c9">&#9670;&nbsp;</a></span>sdp_handlers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d2/da9/structao2__container.html">ao2_container</a>* sdp_handlers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Registered SDP stream handlers. </p>
<p>This container is keyed on stream types. Each object in the container is a linked list of handlers for the stream type. </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l00093">93</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="a259b93d37fd46042989580ad586ac572"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259b93d37fd46042989580ad586ac572">&#9670;&nbsp;</a></span>session_module</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_module session_module</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02587">2587</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
<a id="a5c77944ce4b545d91f1d14b67fe4d525"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c77944ce4b545d91f1d14b67fe4d525">&#9670;&nbsp;</a></span>session_reinvite_module</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pjsip_module session_reinvite_module</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">   .name = { <span class="stringliteral">&quot;Session Re-Invite Module&quot;</span>, 24 },</div><div class="line">   .priority = PJSIP_MOD_PRIORITY_UA_PROXY_LAYER - 1,</div><div class="line">   .on_rx_request = <a class="code" href="../../d4/d92/res__pjsip__session_8c.html#a24f0a675880777396a49d0da4b96ec06">session_reinvite_on_rx_request</a>,</div><div class="line">}</div><div class="ttc" id="res__pjsip__session_8c_html_a24f0a675880777396a49d0da4b96ec06"><div class="ttname"><a href="../../d4/d92/res__pjsip__session_8c.html#a24f0a675880777396a49d0da4b96ec06">session_reinvite_on_rx_request</a></div><div class="ttdeci">static pj_bool_t session_reinvite_on_rx_request(pjsip_rx_data *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d92/res__pjsip__session_8c_source.html#l02733">res_pjsip_session.c:2733</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l02812">2812</a> of file <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html">res_pjsip_session.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:35 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
