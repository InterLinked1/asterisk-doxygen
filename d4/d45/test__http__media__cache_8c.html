<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: test_http_media_cache.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_59425e443f801f1f2fd8bbe4959a3ccf.html">tests</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">test_http_media_cache.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Tests for the HTTP media cache backend.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d16/module_8h_source.html">asterisk/module.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d56/http_8h_source.html">asterisk/http.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d94/bucket_8h_source.html">asterisk/bucket.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/ddc/test_8h_source.html">asterisk/test.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test_http_media_cache.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/ded/test__http__media__cache_8c__incl.png" border="0" usemap="#test__http__media__cache_8c" alt=""/></div>
<map name="test__http__media__cache_8c" id="test__http__media__cache_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="605,453,689,480"/>
<area shape="rect" id="node23" href="../../d5/d16/module_8h.html" title="Asterisk module definitions. " alt="" coords="1308,155,1444,181"/>
<area shape="rect" id="node35" href="../../dd/d56/http_8h.html" title="Support for Private Asterisk HTTP Servers. " alt="" coords="1117,229,1232,256"/>
<area shape="rect" id="node41" href="../../dd/d94/bucket_8h.html" title="Bucket File API. " alt="" coords="1359,80,1489,107"/>
<area shape="rect" id="node45" href="../../d2/ddc/test_8h.html" title="Test Framework API. " alt="" coords="1257,229,1370,256"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="1443,603,1597,629"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="578,528,715,555"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="419,528,554,555"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="1447,677,1593,704"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="969,603,1111,629"/>
<area shape="rect" id="node24" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1445,379,1560,405"/>
<area shape="rect" id="node25" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="1701,453,1840,480"/>
<area shape="rect" id="node26" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1630,528,1693,555"/>
<area shape="rect" id="node28" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="1035,453,1149,480"/>
<area shape="rect" id="node31" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1178,528,1305,555"/>
<area shape="rect" id="node32" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="1429,453,1576,480"/>
<area shape="rect" id="node33" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1915,453,2072,480"/>
<area shape="rect" id="node34" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1224,453,1355,480"/>
<area shape="rect" id="node27" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1805,603,1952,629"/>
<area shape="rect" id="node36" href="../../d3/de6/include_2asterisk_2config_8h.html" title="Configuration File Parser. " alt="" coords="1529,304,1655,331"/>
<area shape="rect" id="node37" href="../../d4/ddf/tcptls_8h.html" title="Generic support for tcp/tls servers in Asterisk. " alt="" coords="901,304,1024,331"/>
<area shape="rect" id="node40" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="1115,379,1266,405"/>
<area shape="rect" id="node38" href="../../dd/d27/iostream_8h.html" title="Generic abstraction for input/output streams. " alt="" coords="673,379,818,405"/>
<area shape="rect" id="node39" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="944,379,1091,405"/>
<area shape="rect" id="node42" href="../../d8/d25/sorcery_8h.html" title="Sorcery Data Access Layer API. " alt="" coords="1468,155,1601,181"/>
<area shape="rect" id="node43" href="../../db/dfe/config__options_8h.html" title="Configuration option&#45;handling. " alt="" coords="1585,229,1765,256"/>
<area shape="rect" id="node44" href="../../dd/d1d/uuid_8h.html" title="Universally unique identifier support. " alt="" coords="1445,229,1560,256"/>
<area shape="rect" id="node46" href="../../dc/db0/cli_8h.html" title="Standard Command Line Interface. " alt="" coords="1216,304,1317,331"/>
</map>
</div>
</div>
<p><a href="../../d4/d45/test__http__media__cache_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/d0f/structtest__options.html">test_options</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a60d401f420413a119c88879ab1a4ab58"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>&#160;&#160;&#160;&quot;/res/http_media_cache/&quot;</td></tr>
<tr class="separator:a60d401f420413a119c88879ab1a4ab58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53934cc973a65b6f9933df842d2e76e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a53934cc973a65b6f9933df842d2e76e6">SET_OR_APPEND_CACHE_CONTROL</a>(<a class="el" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</td></tr>
<tr class="separator:a53934cc973a65b6f9933df842d2e76e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9a253c76d173e6cd7b4a8d6e29b7e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a3b9a253c76d173e6cd7b4a8d6e29b7e0">TEST_URI</a>&#160;&#160;&#160;&quot;test_media_cache&quot;</td></tr>
<tr class="separator:a3b9a253c76d173e6cd7b4a8d6e29b7e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a506115da78d81781bf90e9399d9c7ea1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="el" href="../../d8/d89/structtest.html">test</a>,  bucket_file,  expected,  delta)</td></tr>
<tr class="separator:a506115da78d81781bf90e9399d9c7ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f56612a054c55910bee0800524bf19"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a60f56612a054c55910bee0800524bf19">VALIDATE_STR_METADATA</a>(<a class="el" href="../../d8/d89/structtest.html">test</a>,  bucket_file,  key,  expected)</td></tr>
<tr class="separator:a60f56612a054c55910bee0800524bf19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a88b7c88fed6b80fd18f34f97757dfc04">__reg_module</a> (void)</td></tr>
<tr class="separator:a88b7c88fed6b80fd18f34f97757dfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeab1257bd17282b95875499393a147a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#afeab1257bd17282b95875499393a147a">__unreg_module</a> (void)</td></tr>
<tr class="separator:afeab1257bd17282b95875499393a147a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae">AST_MODULE_SELF_SYM</a> (void)</td></tr>
<tr class="separator:a4fb0aca9bbcdb9709fa52a70aded6cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af80bacd7c6baa4ab4c18303c7bab3b3c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#af80bacd7c6baa4ab4c18303c7bab3b3c">AST_TEST_DEFINE</a> (retrieve_cache_control_directives)</td></tr>
<tr class="separator:af80bacd7c6baa4ab4c18303c7bab3b3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae26824f410ac303ec036e0e9d89cb777"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#ae26824f410ac303ec036e0e9d89cb777">AST_TEST_DEFINE</a> (retrieve_cache_control_age)</td></tr>
<tr class="separator:ae26824f410ac303ec036e0e9d89cb777"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2815b5fb5463d202a4963cb392796c0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a2815b5fb5463d202a4963cb392796c0d">AST_TEST_DEFINE</a> (retrieve_etag_expired)</td></tr>
<tr class="separator:a2815b5fb5463d202a4963cb392796c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9b08233d09644777584461d6cdd407"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#aef9b08233d09644777584461d6cdd407">AST_TEST_DEFINE</a> (retrieve_expires)</td></tr>
<tr class="separator:aef9b08233d09644777584461d6cdd407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2a120e28c772d91e18e0b6c3ca155bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#ac2a120e28c772d91e18e0b6c3ca155bd">AST_TEST_DEFINE</a> (retrieve_etag)</td></tr>
<tr class="separator:ac2a120e28c772d91e18e0b6c3ca155bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c5bd51e1f511ea8da21a827cb19309"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a35c5bd51e1f511ea8da21a827cb19309">AST_TEST_DEFINE</a> (retrieve_nominal)</td></tr>
<tr class="separator:a35c5bd51e1f511ea8da21a827cb19309"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab9e52a43bb66f4ae34114679f3ad50"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a2ab9e52a43bb66f4ae34114679f3ad50">AST_TEST_DEFINE</a> (create_nominal)</td></tr>
<tr class="separator:a2ab9e52a43bb66f4ae34114679f3ad50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b0e62d57732186d12968b918cb78190"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a> (void *obj)</td></tr>
<tr class="separator:a5b0e62d57732186d12968b918cb78190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3af291d12b8e3d76b8341d4b9a5e7983"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a3af291d12b8e3d76b8341d4b9a5e7983">http_callback</a> (struct <a class="el" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, const struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, const char *uri, enum <a class="el" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="el" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params, struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</td></tr>
<tr class="separator:a3af291d12b8e3d76b8341d4b9a5e7983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a> (void)</td></tr>
<tr class="separator:ac3382bf6da54c56b37069bd76bbdf4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32bf13420b4b2f84baa26ae58e5173a0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a32bf13420b4b2f84baa26ae58e5173a0">pre_test_cb</a> (struct <a class="el" href="../../dc/d62/structast__test__info.html">ast_test_info</a> *info, struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *<a class="el" href="../../d8/d89/structtest.html">test</a>)</td></tr>
<tr class="separator:a32bf13420b4b2f84baa26ae58e5173a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c29a0c6da3b09b04d3f801bd44673e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a> (int <a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>)</td></tr>
<tr class="separator:a23c29a0c6da3b09b04d3f801bd44673e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a> (void)</td></tr>
<tr class="separator:a7c6ac25ea7536c0bc9ed18cbcf917527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09fa931f468002152a3cc2d5ce25eae"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a> (void)</td></tr>
<tr class="separator:ad09fa931f468002152a3cc2d5ce25eae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab22f32016155f7f403e7178767163d7d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a> = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a54af2a9b29d140908cc9dffd0618951b">AST_MODFLAG_DEFAULT</a> , .description = &quot;HTTP Media Cache Backend Tests&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .<a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .requires = &quot;res_http_media_cache&quot;, }</td></tr>
<tr class="separator:ab22f32016155f7f403e7178767163d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad60e83b9aa660040fed4d5377966cc21"><td class="memItemLeft" align="right" valign="top">static const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#ad60e83b9aa660040fed4d5377966cc21">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td></tr>
<tr class="separator:ad60e83b9aa660040fed4d5377966cc21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80c8e3ae5087d90d422675d034eeebc7"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d3/d0f/structtest__options.html">test_options</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></td></tr>
<tr class="separator:a80c8e3ae5087d90d422675d034eeebc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af04e2af06333eeaa204e80f690383b30"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a> [512]</td></tr>
<tr class="separator:af04e2af06333eeaa204e80f690383b30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af049c3259ac9104c878aecac6f9489cc"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d45/test__http__media__cache_8c.html#af049c3259ac9104c878aecac6f9489cc">test_uri</a></td></tr>
<tr class="separator:af049c3259ac9104c878aecac6f9489cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Tests for the HTTP media cache backend. </p>
<dl class="section author"><dt>Author</dt><dd><pre class="fragment">Matt Jordan &lt;mjordan@digium.com&gt; </pre> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a60d401f420413a119c88879ab1a4ab58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60d401f420413a119c88879ab1a4ab58">&#9670;&nbsp;</a></span>CATEGORY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CATEGORY&#160;&#160;&#160;&quot;/res/http_media_cache/&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">44</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00223">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00655">load_module()</a>.</p>

</div>
</div>
<a id="a53934cc973a65b6f9933df842d2e76e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53934cc973a65b6f9933df842d2e76e6">&#9670;&nbsp;</a></span>SET_OR_APPEND_CACHE_CONTROL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SET_OR_APPEND_CACHE_CONTROL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d8/d30/main_2security__events_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00083">83</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00091">http_callback()</a>.</p>

</div>
</div>
<a id="a3b9a253c76d173e6cd7b4a8d6e29b7e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9a253c76d173e6cd7b4a8d6e29b7e0">&#9670;&nbsp;</a></span>TEST_URI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEST_URI&#160;&#160;&#160;&quot;test_media_cache&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00046">46</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00607">process_config()</a>.</p>

</div>
</div>
<a id="a506115da78d81781bf90e9399d9c7ea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a506115da78d81781bf90e9399d9c7ea1">&#9670;&nbsp;</a></span>VALIDATE_EXPIRES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VALIDATE_EXPIRES</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d8/d89/structtest.html">test</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bucket_file, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">expected, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">delta&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">66</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00223">AST_TEST_DEFINE()</a>.</p>

</div>
</div>
<a id="a60f56612a054c55910bee0800524bf19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60f56612a054c55910bee0800524bf19">&#9670;&nbsp;</a></span>VALIDATE_STR_METADATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VALIDATE_STR_METADATA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="../../d8/d89/structtest.html">test</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">bucket_file, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">key, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">expected&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div><div class="line">   RAII_VAR(<span class="keyword">struct</span> <a class="code" href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a> *, metadata, <a class="code" href="../../dd/d94/bucket_8h.html#a9631c13cf74292833016f67fd06306b9">ast_bucket_file_metadata_get</a>((bucket_file), (key)), <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>); \</div><div class="line">   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, metadata != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>); \</div><div class="line">   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(metadata-&gt;value, (expected))); \</div><div class="line">} <span class="keywordflow">while</span> (0)</div><div class="ttc" id="bucket_8h_html_a9631c13cf74292833016f67fd06306b9"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#a9631c13cf74292833016f67fd06306b9">ast_bucket_file_metadata_get</a></div><div class="ttdeci">struct ast_bucket_metadata * ast_bucket_file_metadata_get(struct ast_bucket_file *file, const char *name)</div><div class="ttdoc">Retrieve a metadata attribute from a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00359">bucket.c:359</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__bucket__metadata_html"><div class="ttname"><a href="../../de/d33/structast__bucket__metadata.html">ast_bucket_metadata</a></div><div class="ttdoc">Bucket metadata structure, AO2 key value pair. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00047">bucket.h:47</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00077">77</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00406">AST_TEST_DEFINE()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a88b7c88fed6b80fd18f34f97757dfc04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88b7c88fed6b80fd18f34f97757dfc04">&#9670;&nbsp;</a></span>__reg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __reg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00701">701</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

</div>
</div>
<a id="afeab1257bd17282b95875499393a147a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeab1257bd17282b95875499393a147a">&#9670;&nbsp;</a></span>__unreg_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void __unreg_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00701">701</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

</div>
</div>
<a id="a4fb0aca9bbcdb9709fa52a70aded6cae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb0aca9bbcdb9709fa52a70aded6cae">&#9670;&nbsp;</a></span>AST_MODULE_SELF_SYM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d9/df5/structast__module.html">ast_module</a>* AST_MODULE_SELF_SYM </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00701">701</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

</div>
</div>
<a id="af80bacd7c6baa4ab4c18303c7bab3b3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af80bacd7c6baa4ab4c18303c7bab3b3c">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[1/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">retrieve_cache_control_directives&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00223">223</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d43/bucket_8c_source.html#l00824">ast_bucket_file_is_stale()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00815">ast_bucket_file_retrieve()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>, <a class="el" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">test_options::cache_control</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_options::etag</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00053">test_options::maxage</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00055">test_options::must_revalidate</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00054">test_options::no_cache</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">VALIDATE_EXPIRES</a>.</p>
<div class="fragment"><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;{</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, bucket_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="keywordtype">char</span> uri[1024];</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test retrieval of a resource with Cache-Control directives that affect staleness&quot;</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;         <span class="stringliteral">&quot;This test covers retrieval of a resource with the Cache-Control header,\n&quot;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;         <span class="stringliteral">&quot;which specifies no-cache and/or must-revalidate.&quot;</span>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   snprintf(uri, <span class="keyword">sizeof</span>(uri), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="stringliteral">&quot;foo.wav&quot;</span>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> = 1;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a> = 200;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a> = <span class="stringliteral">&quot;OK&quot;</span>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing no-cache...\n&quot;</span>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a00f641baa2f9579f13c48f4d922ed2eb">no_cache</a> = 1;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 1);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing no-cache with ETag...\n&quot;</span>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a00f641baa2f9579f13c48f4d922ed2eb">no_cache</a> = 1;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a> = <span class="stringliteral">&quot;123456789&quot;</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing no-cache with max-age...\n&quot;</span>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a00f641baa2f9579f13c48f4d922ed2eb">no_cache</a> = 1;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 300;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 300, 3);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 1);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 0;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a00f641baa2f9579f13c48f4d922ed2eb">no_cache</a> = 0;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing must-revalidate...\n&quot;</span>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#acf98f4abf2738f757e2d73344941877a">must_revalidate</a> = 1;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 1);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing must-revalidate with ETag...\n&quot;</span>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#acf98f4abf2738f757e2d73344941877a">must_revalidate</a> = 1;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a> = <span class="stringliteral">&quot;123456789&quot;</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing must-revalidate with max-age...\n&quot;</span>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#acf98f4abf2738f757e2d73344941877a">must_revalidate</a> = 1;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 300;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 300, 3);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 1);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="structtest__options_html_a00f641baa2f9579f13c48f4d922ed2eb"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a00f641baa2f9579f13c48f4d922ed2eb">test_options::no_cache</a></div><div class="ttdeci">int no_cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00054">test_http_media_cache.c:54</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="structtest__options_html_a47dc325043a4f591a2896864e9ddd73e"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">test_options::cache_control</a></div><div class="ttdeci">struct test_options::@511 cache_control</div></div>
<div class="ttc" id="bucket_8h_html_af17576a4875c48078ed37990387d1a3b"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_retrieve(const char *uri)</div><div class="ttdoc">Retrieve a bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00815">bucket.c:815</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structtest__options_html_acf98f4abf2738f757e2d73344941877a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#acf98f4abf2738f757e2d73344941877a">test_options::must_revalidate</a></div><div class="ttdeci">int must_revalidate</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00055">test_http_media_cache.c:55</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a5b0e62d57732186d12968b918cb78190"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a></div><div class="ttdeci">static void bucket_file_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">test_http_media_cache.c:213</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="structtest__options_html_ac7d2971b67839cb41f3538032b447cbe"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">test_options::etag</a></div><div class="ttdeci">const char * etag</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_http_media_cache.c:59</a></div></div>
<div class="ttc" id="bucket_8h_html_af952ea526d717fc81997af722c0b39be"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a></div><div class="ttdeci">int ast_bucket_file_is_stale(struct ast_bucket_file *file)</div><div class="ttdoc">Retrieve whether or not the backing datastore views the bucket file as stale. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00824">bucket.c:824</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a506115da78d81781bf90e9399d9c7ea1"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a></div><div class="ttdeci">#define VALIDATE_EXPIRES(test, bucket_file, expected, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">test_http_media_cache.c:66</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="structtest__options_html_ab6de14e2407b9c3028a0b7510eb0bdfe"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">test_options::maxage</a></div><div class="ttdeci">int maxage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00053">test_http_media_cache.c:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae26824f410ac303ec036e0e9d89cb777"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae26824f410ac303ec036e0e9d89cb777">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[2/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">retrieve_cache_control_age&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00305">305</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d43/bucket_8c_source.html#l00824">ast_bucket_file_is_stale()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00815">ast_bucket_file_retrieve()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00129">ast_test_status_update</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>, <a class="el" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">test_options::cache_control</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_options::expires</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00053">test_options::maxage</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00052">test_options::s_maxage</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">VALIDATE_EXPIRES</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, bucket_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordtype">char</span> uri[1024];</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test retrieval of a resource with age specifiers in Cache-Control&quot;</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         <span class="stringliteral">&quot;This test covers retrieval of a resource with the Cache-Control header,\n&quot;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;         <span class="stringliteral">&quot;which specifies max-age and/or s-maxage. The test verifies proper precedence\n&quot;</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         <span class="stringliteral">&quot;ordering of the header attributes, along with its relation if the Expires\n&quot;</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;         <span class="stringliteral">&quot;header is present.&quot;</span>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   snprintf(uri, <span class="keyword">sizeof</span>(uri), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="stringliteral">&quot;foo.wav&quot;</span>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> = 1;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a> = 200;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a> = <span class="stringliteral">&quot;OK&quot;</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing max-age...\n&quot;</span>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 300;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 300, 3);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing s-maxage...\n&quot;</span>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 0;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a> = 300;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 300, 3);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing max-age and s-maxage...\n&quot;</span>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 300;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a> = 600;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 600, 3);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing max-age and Expires...\n&quot;</span>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 300;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a> = 0;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec = now.tv_sec + 3000;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 300, 3);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing s-maxage and Expires...\n&quot;</span>);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 0;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a> = 300;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec = now.tv_sec + 3000;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 300, 3);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing s-maxage and Expires...\n&quot;</span>);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 0;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a> = 300;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec = now.tv_sec + 3000;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 300, 3);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, <span class="stringliteral">&quot;Testing max-age, s-maxage, and Expires...\n&quot;</span>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a> = 300;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a> = 600;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec = now.tv_sec + 3000;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 600, 3);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div><div class="ttc" id="structtest__options_html_a07e01c41920447d2640eab1cb2bf6692"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">test_options::s_maxage</a></div><div class="ttdeci">int s_maxage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00052">test_http_media_cache.c:52</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="structtest__options_html_a47dc325043a4f591a2896864e9ddd73e"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">test_options::cache_control</a></div><div class="ttdeci">struct test_options::@511 cache_control</div></div>
<div class="ttc" id="bucket_8h_html_af17576a4875c48078ed37990387d1a3b"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_retrieve(const char *uri)</div><div class="ttdoc">Retrieve a bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00815">bucket.c:815</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a5b0e62d57732186d12968b918cb78190"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a></div><div class="ttdeci">static void bucket_file_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">test_http_media_cache.c:213</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="test_8h_html_a5e8fddded61f6989172c981256e7c9bd"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a5e8fddded61f6989172c981256e7c9bd">ast_test_status_update</a></div><div class="ttdeci">#define ast_test_status_update(a, b, c...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00129">test.h:129</a></div></div>
<div class="ttc" id="bucket_8h_html_af952ea526d717fc81997af722c0b39be"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a></div><div class="ttdeci">int ast_bucket_file_is_stale(struct ast_bucket_file *file)</div><div class="ttdoc">Retrieve whether or not the backing datastore views the bucket file as stale. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00824">bucket.c:824</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structtest__options_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">test_options::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_http_media_cache.c:57</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a506115da78d81781bf90e9399d9c7ea1"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a></div><div class="ttdeci">#define VALIDATE_EXPIRES(test, bucket_file, expected, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">test_http_media_cache.c:66</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="structtest__options_html_ab6de14e2407b9c3028a0b7510eb0bdfe"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">test_options::maxage</a></div><div class="ttdeci">int maxage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00053">test_http_media_cache.c:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2815b5fb5463d202a4963cb392796c0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2815b5fb5463d202a4963cb392796c0d">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[3/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">retrieve_etag_expired&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00406">406</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d43/bucket_8c_source.html#l00824">ast_bucket_file_is_stale()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00815">ast_bucket_file_retrieve()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_options::etag</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_options::expires</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">VALIDATE_EXPIRES</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00077">VALIDATE_STR_METADATA</a>.</p>
<div class="fragment"><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;{</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, bucket_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <span class="keywordtype">char</span> uri[1024];</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test retrieval of an expired resource with an ETag&quot;</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         <span class="stringliteral">&quot;This test covers a staleness check of a resource with an ETag\n&quot;</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;         <span class="stringliteral">&quot;that has also expired. It guarantees that even if a resource\n&quot;</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;         <span class="stringliteral">&quot;is expired, we will still not consider it stale if the resource\n&quot;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;         <span class="stringliteral">&quot;has not changed per the ETag value.&quot;</span>;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> = 1;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a> = 200;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a> = <span class="stringliteral">&quot;OK&quot;</span>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a> = <span class="stringliteral">&quot;123456789&quot;</span>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec = now.tv_sec - 1;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   snprintf(uri, <span class="keyword">sizeof</span>(uri), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="stringliteral">&quot;foo.wav&quot;</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(uri, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(bucket_file)));</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(bucket_file-&gt;path));</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60f56612a054c55910bee0800524bf19">VALIDATE_STR_METADATA</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, <span class="stringliteral">&quot;etag&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a>);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec - 1, 3);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="bucket_8h_html_af17576a4875c48078ed37990387d1a3b"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_retrieve(const char *uri)</div><div class="ttdoc">Retrieve a bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00815">bucket.c:815</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a5b0e62d57732186d12968b918cb78190"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a></div><div class="ttdeci">static void bucket_file_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">test_http_media_cache.c:213</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a60f56612a054c55910bee0800524bf19"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60f56612a054c55910bee0800524bf19">VALIDATE_STR_METADATA</a></div><div class="ttdeci">#define VALIDATE_STR_METADATA(test, bucket_file, key, expected)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00077">test_http_media_cache.c:77</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structtest__options_html_ac7d2971b67839cb41f3538032b447cbe"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">test_options::etag</a></div><div class="ttdeci">const char * etag</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_http_media_cache.c:59</a></div></div>
<div class="ttc" id="bucket_8h_html_af952ea526d717fc81997af722c0b39be"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a></div><div class="ttdeci">int ast_bucket_file_is_stale(struct ast_bucket_file *file)</div><div class="ttdoc">Retrieve whether or not the backing datastore views the bucket file as stale. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00824">bucket.c:824</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structtest__options_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">test_options::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_http_media_cache.c:57</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a506115da78d81781bf90e9399d9c7ea1"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a></div><div class="ttdeci">#define VALIDATE_EXPIRES(test, bucket_file, expected, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">test_http_media_cache.c:66</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef9b08233d09644777584461d6cdd407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef9b08233d09644777584461d6cdd407">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[4/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">retrieve_expires&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00447">447</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d43/bucket_8c_source.html#l00824">ast_bucket_file_is_stale()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00815">ast_bucket_file_retrieve()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_options::expires</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">VALIDATE_EXPIRES</a>.</p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;{</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, bucket_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <span class="keywordtype">char</span> uri[1024];</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test retrieval with explicit expiration&quot;</span>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <span class="stringliteral">&quot;This test covers retrieving a resource that has an Expires.\n&quot;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         <span class="stringliteral">&quot;After retrieval of the resource, staleness is checked. With\n&quot;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;         <span class="stringliteral">&quot;a non-expired resource, we expect the resource to not be stale.\n&quot;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;         <span class="stringliteral">&quot;When the expiration has occurred, we expect the staleness check\n&quot;</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;         <span class="stringliteral">&quot;to fail.&quot;</span>;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> = 1;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a> = 200;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a> = <span class="stringliteral">&quot;OK&quot;</span>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec = now.tv_sec + 3000;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   snprintf(uri, <span class="keyword">sizeof</span>(uri), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="stringliteral">&quot;foo.wav&quot;</span>);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(uri, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(bucket_file)));</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(bucket_file-&gt;path));</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec + 3000, 3);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   <span class="comment">/* Clean up previous result */</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>(bucket_file);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec = now.tv_sec - 1;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec - 1, 3);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 1);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="bucket_8h_html_af17576a4875c48078ed37990387d1a3b"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_retrieve(const char *uri)</div><div class="ttdoc">Retrieve a bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00815">bucket.c:815</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a5b0e62d57732186d12968b918cb78190"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a></div><div class="ttdeci">static void bucket_file_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">test_http_media_cache.c:213</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="bucket_8h_html_af952ea526d717fc81997af722c0b39be"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a></div><div class="ttdeci">int ast_bucket_file_is_stale(struct ast_bucket_file *file)</div><div class="ttdoc">Retrieve whether or not the backing datastore views the bucket file as stale. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00824">bucket.c:824</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structtest__options_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">test_options::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_http_media_cache.c:57</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a506115da78d81781bf90e9399d9c7ea1"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a></div><div class="ttdeci">#define VALIDATE_EXPIRES(test, bucket_file, expected, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">test_http_media_cache.c:66</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2a120e28c772d91e18e0b6c3ca155bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2a120e28c772d91e18e0b6c3ca155bd">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[5/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">retrieve_etag&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00497">497</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d43/bucket_8c_source.html#l00824">ast_bucket_file_is_stale()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00815">ast_bucket_file_retrieve()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_options::etag</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">VALIDATE_EXPIRES</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00077">VALIDATE_STR_METADATA</a>.</p>
<div class="fragment"><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;{</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, bucket_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <span class="keywordtype">char</span> uri[1024];</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test retrieval with an ETag&quot;</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         <span class="stringliteral">&quot;This test covers retrieving a resource that has an ETag.\n&quot;</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;         <span class="stringliteral">&quot;After retrieval of the resource, staleness is checked. With\n&quot;</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;         <span class="stringliteral">&quot;matching ETags, we expect the resource to not be stale. When\n&quot;</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         <span class="stringliteral">&quot;the ETag does not match, we expect the resource to be stale.&quot;</span>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> = 1;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a> = 200;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a> = <span class="stringliteral">&quot;OK&quot;</span>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a> = <span class="stringliteral">&quot;123456789&quot;</span>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   snprintf(uri, <span class="keyword">sizeof</span>(uri), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="stringliteral">&quot;foo.wav&quot;</span>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(uri, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(bucket_file)));</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(bucket_file-&gt;path));</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60f56612a054c55910bee0800524bf19">VALIDATE_STR_METADATA</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, <span class="stringliteral">&quot;etag&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a>);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec, 3);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 0);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a> = <span class="stringliteral">&quot;99999999&quot;</span>;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a>(bucket_file) == 1);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="bucket_8h_html_af17576a4875c48078ed37990387d1a3b"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_retrieve(const char *uri)</div><div class="ttdoc">Retrieve a bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00815">bucket.c:815</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a5b0e62d57732186d12968b918cb78190"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a></div><div class="ttdeci">static void bucket_file_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">test_http_media_cache.c:213</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a60f56612a054c55910bee0800524bf19"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60f56612a054c55910bee0800524bf19">VALIDATE_STR_METADATA</a></div><div class="ttdeci">#define VALIDATE_STR_METADATA(test, bucket_file, key, expected)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00077">test_http_media_cache.c:77</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structtest__options_html_ac7d2971b67839cb41f3538032b447cbe"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">test_options::etag</a></div><div class="ttdeci">const char * etag</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_http_media_cache.c:59</a></div></div>
<div class="ttc" id="bucket_8h_html_af952ea526d717fc81997af722c0b39be"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af952ea526d717fc81997af722c0b39be">ast_bucket_file_is_stale</a></div><div class="ttdeci">int ast_bucket_file_is_stale(struct ast_bucket_file *file)</div><div class="ttdoc">Retrieve whether or not the backing datastore views the bucket file as stale. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00824">bucket.c:824</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a506115da78d81781bf90e9399d9c7ea1"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a></div><div class="ttdeci">#define VALIDATE_EXPIRES(test, bucket_file, expected, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">test_http_media_cache.c:66</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35c5bd51e1f511ea8da21a827cb19309"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35c5bd51e1f511ea8da21a827cb19309">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[6/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">retrieve_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00540">540</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d43/bucket_8c_source.html#l00815">ast_bucket_file_retrieve()</a>, <a class="el" href="../../d7/d69/sorcery_8c_source.html#l02312">ast_sorcery_object_get_id()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">VALIDATE_EXPIRES</a>.</p>
<div class="fragment"><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;{</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, bucket_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <span class="keywordtype">char</span> uri[1024];</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test nominal retrieval&quot;</span>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;         <span class="stringliteral">&quot;Test nominal retrieval of a resource.&quot;</span>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> = 1;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a> = 200;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a> = <span class="stringliteral">&quot;OK&quot;</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   snprintf(uri, <span class="keyword">sizeof</span>(uri), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="stringliteral">&quot;foo.wav&quot;</span>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a>(uri);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !strcmp(uri, <a class="code" href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a>(bucket_file)));</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(bucket_file-&gt;path));</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec, 3);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="bucket_8h_html_af17576a4875c48078ed37990387d1a3b"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#af17576a4875c48078ed37990387d1a3b">ast_bucket_file_retrieve</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_retrieve(const char *uri)</div><div class="ttdoc">Retrieve a bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00815">bucket.c:815</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a5b0e62d57732186d12968b918cb78190"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a></div><div class="ttdeci">static void bucket_file_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">test_http_media_cache.c:213</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="sorcery_8h_html_a97706283a06cbb44e4f0f9620dd5cf07"><div class="ttname"><a href="../../d8/d25/sorcery_8h.html#a97706283a06cbb44e4f0f9620dd5cf07">ast_sorcery_object_get_id</a></div><div class="ttdeci">const char * ast_sorcery_object_get_id(const void *object)</div><div class="ttdoc">Get the unique identifier of a sorcery object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/sorcery_8c_source.html#l02312">sorcery.c:2312</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a506115da78d81781bf90e9399d9c7ea1"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a></div><div class="ttdeci">#define VALIDATE_EXPIRES(test, bucket_file, expected, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">test_http_media_cache.c:66</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ab9e52a43bb66f4ae34114679f3ad50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab9e52a43bb66f4ae34114679f3ad50">&#9670;&nbsp;</a></span>AST_TEST_DEFINE() <span class="overload">[7/7]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AST_TEST_DEFINE </td>
          <td>(</td>
          <td class="paramtype">create_nominal&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00573">573</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../db/d43/bucket_8c_source.html#l00663">ast_bucket_file_alloc()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00725">ast_bucket_file_create()</a>, <a class="el" href="../../db/d43/bucket_8c_source.html#l00899">ast_bucket_file_temporary_create()</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00201">AST_TEST_NOT_RUN</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00202">AST_TEST_PASS</a>, <a class="el" href="../../de/df7/time_8h_source.html#l00150">ast_tvnow()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">bucket_file_cleanup()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip::info()</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00911">RAII_VAR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00208">TEST_EXECUTE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00207">TEST_INIT</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">VALIDATE_EXPIRES</a>.</p>
<div class="fragment"><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *, bucket_file, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keywordtype">char</span> uri[1024];</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a>:</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;name = __func__;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;category = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;summary = <span class="stringliteral">&quot;Test nominal creation&quot;</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>-&gt;description =</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;         <span class="stringliteral">&quot;Test nominal creation of a resource.&quot;</span>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a>;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a>:</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> = 1;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a> = 200;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a> = <span class="stringliteral">&quot;OK&quot;</span>;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   snprintf(uri, <span class="keyword">sizeof</span>(uri), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="stringliteral">&quot;foo.wav&quot;</span>);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   bucket_file = <a class="code" href="../../dd/d94/bucket_8h.html#a06c0cb2467dcf37cb1d0a932d1b86ee1">ast_bucket_file_alloc</a>(uri);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#a4eb22b16d39185b0c7c0f5a574abb506">ast_bucket_file_temporary_create</a>(bucket_file) == 0);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   ast_test_validate(<a class="code" href="../../d8/d89/structtest.html">test</a>, <a class="code" href="../../dd/d94/bucket_8h.html#a5d90d500ffd37647c1a4ca9a02003ef8">ast_bucket_file_create</a>(bucket_file) == 0);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a>(<a class="code" href="../../d8/d89/structtest.html">test</a>, bucket_file, now.tv_sec, 3);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2adb2586ef58bb9dd2f84a7d592ecf3e0e">TEST_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00208">test.h:208</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="bucket_8h_html_a06c0cb2467dcf37cb1d0a932d1b86ee1"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#a06c0cb2467dcf37cb1d0a932d1b86ee1">ast_bucket_file_alloc</a></div><div class="ttdeci">struct ast_bucket_file * ast_bucket_file_alloc(const char *uri)</div><div class="ttdoc">Allocate a new bucket file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00663">bucket.c:663</a></div></div>
<div class="ttc" id="test_8h_html_a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a0689ac4326c7a771e1b6ed1e4cde53e2a21df97525a6ac371a7fb604dfa8ea67b">TEST_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00207">test.h:207</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a8cf2ae27807baf798d726d630693cc8c">AST_TEST_NOT_RUN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00201">test.h:201</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a5b0e62d57732186d12968b918cb78190"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a5b0e62d57732186d12968b918cb78190">bucket_file_cleanup</a></div><div class="ttdeci">static void bucket_file_cleanup(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">test_http_media_cache.c:213</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="test_8h_html_aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b"><div class="ttname"><a href="../../d2/ddc/test_8h.html#aad2aec78205d328d23894a6598cc4044a7a3ab73c870a7ce6cf1a0f3cfd42a37b">AST_TEST_PASS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00202">test.h:202</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="bucket_8h_html_a4eb22b16d39185b0c7c0f5a574abb506"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#a4eb22b16d39185b0c7c0f5a574abb506">ast_bucket_file_temporary_create</a></div><div class="ttdeci">int ast_bucket_file_temporary_create(struct ast_bucket_file *file)</div><div class="ttdoc">Common file snapshot creation callback for creating a temporary file. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00899">bucket.c:899</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="structtest_html"><div class="ttname"><a href="../../d8/d89/structtest.html">test</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/test__logger_8c_source.html#l00043">test_logger.c:43</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a506115da78d81781bf90e9399d9c7ea1"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a506115da78d81781bf90e9399d9c7ea1">VALIDATE_EXPIRES</a></div><div class="ttdeci">#define VALIDATE_EXPIRES(test, bucket_file, expected, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00066">test_http_media_cache.c:66</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="bucket_8h_html_a5d90d500ffd37647c1a4ca9a02003ef8"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#a5d90d500ffd37647c1a4ca9a02003ef8">ast_bucket_file_create</a></div><div class="ttdeci">int ast_bucket_file_create(struct ast_bucket_file *file)</div><div class="ttdoc">Create a new bucket file in backend storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00725">bucket.c:725</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b0e62d57732186d12968b918cb78190"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b0e62d57732186d12968b918cb78190">&#9670;&nbsp;</a></span>bucket_file_cleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void bucket_file_cleanup </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00213">213</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/da5/astobj2_8h_source.html#l00464">ao2_ref</a>, and <a class="el" href="../../db/d43/bucket_8c_source.html#l00844">ast_bucket_file_delete()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00223">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a> *bucket_file = obj;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keywordflow">if</span> (bucket_file) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      <a class="code" href="../../dd/d94/bucket_8h.html#aae0070572ae13f8b9dd6b35da9f8e20f">ast_bucket_file_delete</a>(bucket_file);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(bucket_file, -1);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div><div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="bucket_8h_html_aae0070572ae13f8b9dd6b35da9f8e20f"><div class="ttname"><a href="../../dd/d94/bucket_8h.html#aae0070572ae13f8b9dd6b35da9f8e20f">ast_bucket_file_delete</a></div><div class="ttdeci">int ast_bucket_file_delete(struct ast_bucket_file *file)</div><div class="ttdoc">Delete a bucket file from backend storage. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/bucket_8c_source.html#l00844">bucket.c:844</a></div></div>
<div class="ttc" id="structast__bucket__file_html"><div class="ttname"><a href="../../d9/da9/structast__bucket__file.html">ast_bucket_file</a></div><div class="ttdoc">Bucket file structure, contains reference to file and information about it. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d94/bucket_8h_source.html#l00078">bucket.h:78</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3af291d12b8e3d76b8341d4b9a5e7983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3af291d12b8e3d76b8341d4b9a5e7983">&#9670;&nbsp;</a></span>http_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int http_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *&#160;</td>
          <td class="paramname"><em>ser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *&#160;</td>
          <td class="paramname"><em>urih</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a>&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>get_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../dd/d02/structast__variable.html">ast_variable</a> *&#160;</td>
          <td class="paramname"><em>headers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00091">91</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00182">ast_free</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00648">ast_http_error()</a>, <a class="el" href="../../dd/d56/http_8h_source.html#l00058">AST_HTTP_GET</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00836">ast_http_request_close_on_completion()</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00456">ast_http_send()</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l01739">ast_localtime()</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l01091">ast_str_append()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00714">ast_str_buffer()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00620">ast_str_create</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00688">ast_str_strlen()</a>, <a class="el" href="../../d9/df8/localtime_8c_source.html#l02524">ast_strftime()</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00052">ast_strlen_zero</a>, <a class="el" href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">buf</a>, <a class="el" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">test_options::cache_control</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d6/d47/utils_2frame_8c_source.html#l00999">error()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_options::etag</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_options::expires</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00053">test_options::maxage</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00055">test_options::must_revalidate</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">ast_variable::name</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">ast_variable::next</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00054">test_options::no_cache</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00052">test_options::s_maxage</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_options::send_file</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00083">SET_OR_APPEND_CACHE_CONTROL</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_options::status_code</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_options::status_text</a>, and <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">ast_variable::value</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordtype">char</span> file_name[64] = <span class="stringliteral">&quot;/tmp/test-media-cache-XXXXXX&quot;</span>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *http_header = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *cache_control = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <span class="keywordtype">int</span> fd = -1;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <span class="keywordtype">int</span> unmodified = 0;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <span class="keywordtype">int</span> send_file = <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">send_file</a> &amp;&amp; <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a> == <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa74b1cb5c2ecb5e0bd9af5d46a7b78fd2">AST_HTTP_GET</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;   <span class="keywordflow">if</span> (!http_header) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="keywordflow">if</span> (send_file) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[1024];</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      fd = mkstemp(file_name);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> (fd == -1) {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to open temp file for testing: %s (%d)&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>), <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      memset(buf, 1, <span class="keyword">sizeof</span>(buf));</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span> (write(fd, buf, <span class="keyword">sizeof</span>(buf)) != <span class="keyword">sizeof</span>(buf)) {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to write expected number of bytes to pipe\n&quot;</span>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;         close(fd);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      close(fd);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      fd = open(file_name, 0);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">if</span> (fd == -1) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to open temp file for testing: %s (%d)&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>), <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;         <span class="keywordflow">goto</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a>) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a53934cc973a65b6f9933df842d2e76e6">SET_OR_APPEND_CACHE_CONTROL</a>(cache_control);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;cache_control, 0, <span class="stringliteral">&quot;max-age=%d&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">maxage</a>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a>) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a53934cc973a65b6f9933df842d2e76e6">SET_OR_APPEND_CACHE_CONTROL</a>(cache_control);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;cache_control, 0, <span class="stringliteral">&quot;s-maxage=%d&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">s_maxage</a>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;   }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a00f641baa2f9579f13c48f4d922ed2eb">no_cache</a>) {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a53934cc973a65b6f9933df842d2e76e6">SET_OR_APPEND_CACHE_CONTROL</a>(cache_control);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;cache_control, 0, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;no-cache&quot;</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">cache_control</a>.<a class="code" href="../../d3/d0f/structtest__options.html#acf98f4abf2738f757e2d73344941877a">must_revalidate</a>) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a53934cc973a65b6f9933df842d2e76e6">SET_OR_APPEND_CACHE_CONTROL</a>(cache_control);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;cache_control, 0, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;must-revalidate&quot;</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;   }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(cache_control)) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;http_header, 0, <span class="stringliteral">&quot;%s\r\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(cache_control));</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   }</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>.tv_sec) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> now_time;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">char</span> tmbuf[64];</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">expires</a>, &amp;now_time, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <a class="code" href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a>(tmbuf, <span class="keyword">sizeof</span>(tmbuf), <span class="stringliteral">&quot;%a, %d %b %Y %T %z&quot;</span>, &amp;now_time);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;http_header, 0, <span class="stringliteral">&quot;Expires: %s\r\n&quot;</span>, tmbuf);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a>)) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;http_header, 0, <span class="stringliteral">&quot;ETag: %s\r\n&quot;</span>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keywordflow">for</span> (v = headers; v; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;If-None-Match&quot;</span>) &amp;&amp; !strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">etag</a>)) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            unmodified = 1;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;         }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keywordflow">if</span> (!unmodified) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">status_code</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>.<a class="code" href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">status_text</a>, http_header, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, send_file ? fd : 0, 1);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, 304, <span class="stringliteral">&quot;Not Modified&quot;</span>, http_header, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 1);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   }</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordflow">if</span> (send_file) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      close(fd);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      unlink(file_name);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cache_control);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>:</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(http_header);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(cache_control);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 418, <span class="stringliteral">&quot;I&#39;m a Teapot&quot;</span>, <span class="stringliteral">&quot;Please don&#39;t ask me to brew coffee.&quot;</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div><div class="ttc" id="structast__variable_html_afaaf66cc5029a563bd0bb9df076ea14b"><div class="ttname"><a href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">ast_variable::next</a></div><div class="ttdeci">struct ast_variable * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">include/asterisk/config.h:90</a></div></div>
<div class="ttc" id="structtest__options_html_a07e01c41920447d2640eab1cb2bf6692"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a07e01c41920447d2640eab1cb2bf6692">test_options::s_maxage</a></div><div class="ttdeci">int s_maxage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00052">test_http_media_cache.c:52</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a53934cc973a65b6f9933df842d2e76e6"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a53934cc973a65b6f9933df842d2e76e6">SET_OR_APPEND_CACHE_CONTROL</a></div><div class="ttdeci">#define SET_OR_APPEND_CACHE_CONTROL(str)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00083">test_http_media_cache.c:83</a></div></div>
<div class="ttc" id="http_8h_html_ab0f7966324a592e02d53f01e7bb9cc17"><div class="ttname"><a href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a></div><div class="ttdeci">void ast_http_error(struct ast_tcptls_session_instance *ser, int status, const char *title, const char *text)</div><div class="ttdoc">Send HTTP error message and close socket. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00648">http.c:648</a></div></div>
<div class="ttc" id="structtest__options_html_a00f641baa2f9579f13c48f4d922ed2eb"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a00f641baa2f9579f13c48f4d922ed2eb">test_options::no_cache</a></div><div class="ttdeci">int no_cache</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00054">test_http_media_cache.c:54</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structtest__options_html_a47dc325043a4f591a2896864e9ddd73e"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a47dc325043a4f591a2896864e9ddd73e">test_options::cache_control</a></div><div class="ttdeci">struct test_options::@511 cache_control</div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="localtime_8h_html_ae9fbda728350a9a5b9c09b29214d718e"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a></div><div class="ttdeci">struct ast_tm * ast_localtime(const struct timeval *timep, struct ast_tm *p_tm, const char *zone)</div><div class="ttdoc">Timezone-independent version of localtime_r(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l01739">localtime.c:1739</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structtest__options_html_acf98f4abf2738f757e2d73344941877a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#acf98f4abf2738f757e2d73344941877a">test_options::must_revalidate</a></div><div class="ttdeci">int must_revalidate</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00055">test_http_media_cache.c:55</a></div></div>
<div class="ttc" id="http_8h_html_a0448c9f4a66b6ee7994870b187e185b4"><div class="ttname"><a href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a></div><div class="ttdeci">void ast_http_send(struct ast_tcptls_session_instance *ser, enum ast_http_method method, int status_code, const char *status_title, struct ast_str *http_header, struct ast_str *out, int fd, unsigned int static_content)</div><div class="ttdoc">Generic function for sending HTTP/1.1 response. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00456">http.c:456</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="structtest__options_html_ac7d2971b67839cb41f3538032b447cbe"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac7d2971b67839cb41f3538032b447cbe">test_options::etag</a></div><div class="ttdeci">const char * etag</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00059">test_http_media_cache.c:59</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="http_8h_html_a16fb43ed7e6093a9dc96477ba37b80efa74b1cb5c2ecb5e0bd9af5d46a7b78fd2"><div class="ttname"><a href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa74b1cb5c2ecb5e0bd9af5d46a7b78fd2">AST_HTTP_GET</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00058">http.h:58</a></div></div>
<div class="ttc" id="structtest__options_html_a7814e4900b15b2edc31554bbb7b61b3e"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a7814e4900b15b2edc31554bbb7b61b3e">test_options::expires</a></div><div class="ttdeci">struct timeval expires</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00057">test_http_media_cache.c:57</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structtest__options_html_a02f62480fb9b4a963d2cc2d8d4f6616a"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a02f62480fb9b4a963d2cc2d8d4f6616a">test_options::status_text</a></div><div class="ttdeci">const char * status_text</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00058">test_http_media_cache.c:58</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="localtime_8h_html_aa8e63928b14a347bd3973d680b885f93"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a></div><div class="ttdeci">int ast_strftime(char *buf, size_t len, const char *format, const struct ast_tm *tm)</div><div class="ttdoc">Special version of strftime(3) that handles fractions of a second. Takes the same arguments as strfti...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l02524">localtime.c:2524</a></div></div>
<div class="ttc" id="structtest__options_html_ac275fb0ffa19246e789b4c3c9febcf00"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ac275fb0ffa19246e789b4c3c9febcf00">test_options::status_code</a></div><div class="ttdeci">int status_code</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00049">test_http_media_cache.c:49</a></div></div>
<div class="ttc" id="strings_8h_html_aabc005bd1c7e249e8f8659d57d4500b6"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a></div><div class="ttdeci">size_t ast_str_strlen(const struct ast_str *buf)</div><div class="ttdoc">Returns the current length of the string stored within buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00688">strings.h:688</a></div></div>
<div class="ttc" id="structtest__options_html_a4e7252b657208119f5540a07c2e75135"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#a4e7252b657208119f5540a07c2e75135">test_options::send_file</a></div><div class="ttdeci">int send_file</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00050">test_http_media_cache.c:50</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a4a9391ee88e57361b613c4c2fd2bf4aa"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a></div><div class="ttdeci">int error(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00999">utils/frame.c:999</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="structtest__options_html_ab6de14e2407b9c3028a0b7510eb0bdfe"><div class="ttname"><a href="../../d3/d0f/structtest__options.html#ab6de14e2407b9c3028a0b7510eb0bdfe">test_options::maxage</a></div><div class="ttdeci">int maxage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00053">test_http_media_cache.c:53</a></div></div>
<div class="ttc" id="http_8h_html_ab0286838ed2b93e0d77fe9d7af8a37b5"><div class="ttname"><a href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a></div><div class="ttdeci">void ast_http_request_close_on_completion(struct ast_tcptls_session_instance *ser)</div><div class="ttdoc">Request the HTTP connection be closed after this HTTP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00836">http.c:836</a></div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3382bf6da54c56b37069bd76bbdf4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3382bf6da54c56b37069bd76bbdf4f9">&#9670;&nbsp;</a></span>load_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int load_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00655">655</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d43/http_8c_source.html#l00673">ast_http_uri_link()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00078">AST_MODULE_LOAD_DECLINE</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00070">AST_MODULE_LOAD_SUCCESS</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00127">AST_TEST_REGISTER</a>, <a class="el" href="../../d8/db9/test_8c_source.html#l00160">ast_test_register_init()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">CATEGORY</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00206">pre_test_cb()</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00607">process_config()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00679">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;{</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a>(0)) {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af049c3259ac9104c878aecac6f9489cc">test_uri</a>)) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(create_nominal);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(retrieve_nominal);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(retrieve_etag);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(retrieve_expires);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(retrieve_etag_expired);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(retrieve_cache_control_age);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a>(retrieve_cache_control_directives);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <a class="code" href="../../d8/db9/test_8c.html#a4e75c29c042ce5aa6c80cff24fa7f078">ast_test_register_init</a>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a>, <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a32bf13420b4b2f84baa26ae58e5173a0">pre_test_cb</a>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div><div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a60d401f420413a119c88879ab1a4ab58"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a60d401f420413a119c88879ab1a4ab58">CATEGORY</a></div><div class="ttdeci">#define CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00044">test_http_media_cache.c:44</a></div></div>
<div class="ttc" id="test_8c_html_a4e75c29c042ce5aa6c80cff24fa7f078"><div class="ttname"><a href="../../d8/db9/test_8c.html#a4e75c29c042ce5aa6c80cff24fa7f078">ast_test_register_init</a></div><div class="ttdeci">int ast_test_register_init(const char *category, ast_test_init_cb_t *cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/db9/test_8c_source.html#l00160">test.c:160</a></div></div>
<div class="ttc" id="http_8h_html_ac99d56925cf94f8cf3ed0acac52e2d75"><div class="ttname"><a href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a></div><div class="ttdeci">int ast_http_uri_link(struct ast_http_uri *urihandler)</div><div class="ttdoc">Register a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00673">http.c:673</a></div></div>
<div class="ttc" id="test_8h_html_a34f64a69c09d98ceb693b077efd7ef97"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a34f64a69c09d98ceb693b077efd7ef97">AST_TEST_REGISTER</a></div><div class="ttdeci">#define AST_TEST_REGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00127">test.h:127</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a23c29a0c6da3b09b04d3f801bd44673e"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a></div><div class="ttdeci">static int process_config(int reload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00607">test_http_media_cache.c:607</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a32bf13420b4b2f84baa26ae58e5173a0"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a32bf13420b4b2f84baa26ae58e5173a0">pre_test_cb</a></div><div class="ttdeci">static int pre_test_cb(struct ast_test_info *info, struct ast_test *test)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00206">test_http_media_cache.c:206</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfac742921e9f9512d28f62c74ea2affe57">AST_MODULE_LOAD_DECLINE</a></div><div class="ttdoc">Module has failed to load, may be in an inconsistent state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00078">module.h:78</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af049c3259ac9104c878aecac6f9489cc"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af049c3259ac9104c878aecac6f9489cc">test_uri</a></div><div class="ttdeci">static struct ast_http_uri test_uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00197">test_http_media_cache.c:197</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a32bf13420b4b2f84baa26ae58e5173a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32bf13420b4b2f84baa26ae58e5173a0">&#9670;&nbsp;</a></span>pre_test_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pre_test_cb </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dc/d62/structast__test__info.html">ast_test_info</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d9/d79/structast__test.html">ast_test</a> *&#160;</td>
          <td class="paramname"><em>test</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00206">206</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">options</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00655">load_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   memset(&amp;<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>));</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a23c29a0c6da3b09b04d3f801bd44673e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23c29a0c6da3b09b04d3f801bd44673e">&#9670;&nbsp;</a></span>process_config()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int process_config </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reload</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00607">607</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/dc5/extconf_8c_source.html#l01290">ast_config_destroy()</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">ast_config_load</a>, <a class="el" href="../../d2/d9d/main_2config_8c_source.html#l00684">ast_config_option()</a>, <a class="el" href="../../de/d1f/main_2utils_8c_source.html#l01968">ast_false()</a>, <a class="el" href="../../d7/d49/chan__ooh323_8c_source.html#l00353">bindaddr</a>, <a class="el" href="../../de/dcc/conf2ael_8c_source.html#l00066">config</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">CONFIG_FLAG_FILEUNCHANGED</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">CONFIG_STATUS_FILEINVALID</a>, <a class="el" href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">CONFIG_STATUS_FILEUNCHANGED</a>, <a class="el" href="../../d0/d5d/dnsmgr_8c_source.html#l00091">enabled</a>, <a class="el" href="../../dd/d43/http_8c_source.html#l00141">prefix</a>, <a class="el" href="../../d6/d90/strings_8h_source.html#l00079">S_OR</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">server_uri</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00046">TEST_URI</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00655">load_module()</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00650">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;{</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *<a class="code" href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a>;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> ? <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a80ca8badd36b5edc83592e8f017817a4">bindaddr</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *bindport;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dd/d43/http_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d5d/dnsmgr_8c.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a>;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   config = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a>(<span class="stringliteral">&quot;http.conf&quot;</span>, config_flags);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="keywordflow">if</span> (!config || config == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   enabled = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;enabled&quot;</span>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <span class="keywordflow">if</span> (!enabled || <a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(enabled)) {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="comment">/* Construct our Server URI */</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   bindaddr = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;bindaddr&quot;</span>);</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   <span class="keywordflow">if</span> (!bindaddr) {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   bindport = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;bindport&quot;</span>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="keywordflow">if</span> (!bindport) {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      bindport = <span class="stringliteral">&quot;8088&quot;</span>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   prefix = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a>(config, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;prefix&quot;</span>);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   snprintf(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a>), <span class="stringliteral">&quot;http://%s:%s%s/%s&quot;</span>, bindaddr, bindport, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(prefix, <span class="stringliteral">&quot;&quot;</span>), <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a3b9a253c76d173e6cd7b4a8d6e29b7e0">TEST_URI</a>);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(config);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;}</div><div class="ttc" id="conf2ael_8c_html_a74bb62276efdf39dd94048e007fca05b"><div class="ttname"><a href="../../de/dcc/conf2ael_8c.html#a74bb62276efdf39dd94048e007fca05b">config</a></div><div class="ttdeci">char * config</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcc/conf2ael_8c_source.html#l00066">conf2ael.c:66</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8d1a63cdf2c7aff22a77b6e75d93b377"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEINVALID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">include/asterisk/config.h:60</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a0a07ddd6bbcf44485e01c14c96109482"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a0a07ddd6bbcf44485e01c14c96109482">ast_config_load</a></div><div class="ttdeci">#define ast_config_load(filename, flags)</div><div class="ttdoc">Load a config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00179">include/asterisk/config.h:179</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6b4d4d929013de7812fbba4e58353078"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a></div><div class="ttdeci">void ast_config_destroy(struct ast_config *config)</div><div class="ttdoc">Destroys a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01290">extconf.c:1290</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a846844eb2c4eb44554445936b3770711"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEUNCHANGED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">include/asterisk/config.h:59</a></div></div>
<div class="ttc" id="structast__config_html"><div class="ttname"><a href="../../dd/d18/structast__config.html">ast_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00249">main/config.c:249</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a3b9a253c76d173e6cd7b4a8d6e29b7e0"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a3b9a253c76d173e6cd7b4a8d6e29b7e0">TEST_URI</a></div><div class="ttdeci">#define TEST_URI</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00046">test_http_media_cache.c:46</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af04e2af06333eeaa204e80f690383b30"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af04e2af06333eeaa204e80f690383b30">server_uri</a></div><div class="ttdeci">static char server_uri[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">test_http_media_cache.c:64</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_ad1982509765f4870f1f63412a53ea668"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00741">cdr_mysql.c:741</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="strings_8h_html_a6c3dc0bad204e9dd9890325c1c861e38"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a></div><div class="ttdeci">int attribute_pure ast_false(const char *val)</div><div class="ttdoc">Make sure something is false. Determine if a string containing a boolean value is &quot;false&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01968">main/utils.c:1968</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad9fd2625614158b152434e45acf1d78b"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad9fd2625614158b152434e45acf1d78b">ast_config_option</a></div><div class="ttdeci">const char * ast_config_option(struct ast_config *cfg, const char *cat, const char *var)</div><div class="ttdoc">Retrieve a configuration variable within the configuration set. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00684">main/config.c:684</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a80ca8badd36b5edc83592e8f017817a4"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a80ca8badd36b5edc83592e8f017817a4">bindaddr</a></div><div class="ttdeci">struct ast_sockaddr bindaddr</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00353">chan_ooh323.c:353</a></div></div>
<div class="ttc" id="http_8c_html_a6f25bc812d09fedb86bf394c01061c56"><div class="ttname"><a href="../../dd/d43/http_8c.html#a6f25bc812d09fedb86bf394c01061c56">prefix</a></div><div class="ttdeci">static char prefix[MAX_PREFIX]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00141">http.c:141</a></div></div>
<div class="ttc" id="dnsmgr_8c_html_a03e6cca0c879c0443efb431c30c14f76"><div class="ttname"><a href="../../d0/d5d/dnsmgr_8c.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a></div><div class="ttdeci">static int enabled</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d5d/dnsmgr_8c_source.html#l00091">dnsmgr.c:91</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">include/asterisk/config.h:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c6ac25ea7536c0bc9ed18cbcf917527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c6ac25ea7536c0bc9ed18cbcf917527">&#9670;&nbsp;</a></span>reload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int reload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00650">650</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00607">process_config()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00679">unload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;{</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a>(1);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div><div class="ttc" id="test__http__media__cache_8c_html_a23c29a0c6da3b09b04d3f801bd44673e"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a23c29a0c6da3b09b04d3f801bd44673e">process_config</a></div><div class="ttdeci">static int process_config(int reload)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00607">test_http_media_cache.c:607</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09fa931f468002152a3cc2d5ce25eae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09fa931f468002152a3cc2d5ce25eae">&#9670;&nbsp;</a></span>unload_module()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int unload_module </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00679">679</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">References <a class="el" href="../../dd/d43/http_8c_source.html#l00705">ast_http_uri_unlink()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00315">AST_MODFLAG_DEFAULT</a>, <a class="el" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO()</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00121">AST_MODULE_SUPPORT_CORE</a>, <a class="el" href="../../d2/ddc/test_8h_source.html#l00128">AST_TEST_UNREGISTER</a>, <a class="el" href="../../d5/d16/module_8h_source.html#l00046">ASTERISK_GPL_KEY</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00655">load_module()</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00741">reload()</a>, and <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00650">reload_module()</a>.</p>
<div class="fragment"><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;{</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#af049c3259ac9104c878aecac6f9489cc">test_uri</a>);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(create_nominal);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(retrieve_nominal);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(retrieve_etag);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(retrieve_expires);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(retrieve_etag_expired);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(retrieve_cache_control_age);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;   <a class="code" href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a>(retrieve_cache_control_directives);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;}</div><div class="ttc" id="http_8h_html_a33e436ed8aeb33287f1e6cb1c5288a14"><div class="ttname"><a href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a></div><div class="ttdeci">void ast_http_uri_unlink(struct ast_http_uri *urihandler)</div><div class="ttdoc">Unregister a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00705">http.c:705</a></div></div>
<div class="ttc" id="test_8h_html_a79bc64a935b14b1b181156e5ada58ead"><div class="ttname"><a href="../../d2/ddc/test_8h.html#a79bc64a935b14b1b181156e5ada58ead">AST_TEST_UNREGISTER</a></div><div class="ttdeci">#define AST_TEST_UNREGISTER(cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/ddc/test_8h_source.html#l00128">test.h:128</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_af049c3259ac9104c878aecac6f9489cc"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#af049c3259ac9104c878aecac6f9489cc">test_uri</a></div><div class="ttdeci">static struct ast_http_uri test_uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00197">test_http_media_cache.c:197</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab22f32016155f7f403e7178767163d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab22f32016155f7f403e7178767163d7d">&#9670;&nbsp;</a></span>__mod_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> __mod_info = { .<a class="el" href="../../d1/da4/res__corosync_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a> = <a class="el" href="../../da/ddd/named__acl_8c.html#aec23fc5034c3bb08140fc021f4955877">AST_MODULE</a>, .flags = <a class="el" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a54af2a9b29d140908cc9dffd0618951b">AST_MODFLAG_DEFAULT</a> , .description = &quot;HTTP Media Cache Backend Tests&quot; , .key = &quot;This paragraph is copyright (<a class="el" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>) 2006 by Digium, Inc. \In <a class="el" href="../../d5/d14/voicin_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> for your module to load, it must return this \key via <a class="el" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a> function called \&quot;key\&quot;. Any code which \includes this paragraph must <a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a39730e90126aad69cfc9ca4d6fcdb3a6">be</a> licensed under the GNU \General Public License <a class="el" href="../../da/d7c/utils_2frame_8h.html#a56abfaab87c46691c1ef3ad0df23e864">version</a> 2 or later (at your \option). In addition to Digium's general reservations \of rights, Digium expressly reserves the right to \allow other parties to license this paragraph under \different terms. Any use of Digium, Inc. trademarks or \logos (including \&quot;Asterisk\&quot; or \&quot;Digium\&quot;) without \express written <a class="el" href="../../d4/d4c/structpermission.html">permission</a> of Digium, Inc. is prohibited.\n&quot; , .buildopt_sum = <a class="el" href="../../da/d84/res__pjsip__stir__shaken_8c.html#a6e79b87e069c15a5fb21826e5eed0971">AST_BUILDOPT_SUM</a>, .support_level = <a class="el" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>, .load = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>, .<a class="el" href="../../dc/d6b/res__xmpp_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = <a class="el" href="../../d6/d80/test__res__prometheus_8c.html#a7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>, .unload = <a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>, .requires = &quot;res_http_media_cache&quot;, }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00701">701</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

</div>
</div>
<a id="ad60e83b9aa660040fed4d5377966cc21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e83b9aa660040fed4d5377966cc21">&#9670;&nbsp;</a></span>ast_module_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a>* <a class="el" href="../../dd/d5f/structast__module__info.html">ast_module_info</a> = &amp;<a class="el" href="../../d6/d7a/test__xml__escape_8c.html#ab22f32016155f7f403e7178767163d7d">__mod_info</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00701">701</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

</div>
</div>
<a id="a80c8e3ae5087d90d422675d034eeebc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80c8e3ae5087d90d422675d034eeebc7">&#9670;&nbsp;</a></span>options</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/d0f/structtest__options.html">test_options</a> options</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="../../d4/dca/_2usr_2src_2asterisk-18_85_80_2main_2app_8c-example.html#a417">/usr/src/asterisk-18.5.0/main/app.c</a>.</dd>
</dl>
<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">62</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d9b/tcptls_8c_source.html#l00382">__ssl_setup()</a>, <a class="el" href="../../de/d11/app__agent__pool_8c_source.html#l02112">agent_login_exec()</a>, <a class="el" href="../../de/d26/app__externalivr_8c_source.html#l00392">app_exec()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l08025">aqm_exec()</a>, <a class="el" href="../../db/d0b/resource__bridges_8c_source.html#l00634">ast_ari_bridges_record()</a>, <a class="el" href="../../da/d49/resource__channels_8c_source.html#l00748">ast_ari_channels_record()</a>, <a class="el" href="../../d7/d01/say_8c_source.html#l00525">ast_get_number_str()</a>, <a class="el" href="../../d8/d9c/config__parser_8c_source.html#l00861">AST_TEST_DEFINE()</a>, <a class="el" href="../../dd/d8a/chan__audiosocket_8c_source.html#l00139">audiosocket_request()</a>, <a class="el" href="../../d6/d0f/app__authenticate_8c_source.html#l00116">auth_exec()</a>, <a class="el" href="../../d5/d92/features_8c_source.html#l01007">bridge_exec()</a>, <a class="el" href="../../dc/d22/app__bridgewait_8c_source.html#l00416">bridgewait_exec()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00400">cdr_prop_write_callback()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00248">cdr_read_callback()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00506">cdr_write()</a>, <a class="el" href="../../d7/dd2/func__cdr_8c_source.html#l00357">cdr_write_callback()</a>, <a class="el" href="../../d2/d43/app__chanisavail_8c_source.html#l00102">chanavail_exec()</a>, <a class="el" href="../../dc/d04/app__chanspy_8c_source.html#l01203">chanspy_exec()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l04837">conf_exec()</a>, <a class="el" href="../../d6/dde/app__controlplayback_8c_source.html#l00197">controlplayback_exec()</a>, <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00399">detect_write()</a>, <a class="el" href="../../d9/d12/app__dial_8c_source.html#l02254">dial_exec_full()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00847">directory_exec()</a>, <a class="el" href="../../d4/d7e/app__disa_8c_source.html#l00146">disa_exec()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04215">dundi_query_read()</a>, <a class="el" href="../../d1/dc0/pbx__dundi_8c_source.html#l04137">dundifunc_read()</a>, <a class="el" href="../../de/dcd/app__jack_8c_source.html#l00875">enable_jack_hook()</a>, <a class="el" href="../../dc/d04/app__chanspy_8c_source.html#l01322">extenspy_exec()</a>, <a class="el" href="../../d9/d45/bridge__builtin__features_8c_source.html#l00408">feature_automixmonitor()</a>, <a class="el" href="../../d9/d45/bridge__builtin__features_8c_source.html#l00220">feature_automonitor()</a>, <a class="el" href="../../d4/daa/func__env_8c_source.html#l00486">file_read()</a>, <a class="el" href="../../d4/daa/func__env_8c_source.html#l00746">file_write()</a>, <a class="el" href="../../d2/db9/app__forkcdr_8c_source.html#l00134">forkcdr_exec()</a>, <a class="el" href="../../d9/d5e/func__enum_8c_source.html#l00156">function_enum()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00614">generate_rtpmap_attr()</a>, <a class="el" href="../../d5/d82/res__pjsip__sdp__rtp_8c_source.html#l00315">get_codecs()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00366">handle_cli_presencestate_change()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00295">handle_cli_presencestate_list()</a>, <a class="el" href="../../d5/dfe/chan__sip_8c_source.html#l28575">handle_request_subscribe()</a>, <a class="el" href="../../d4/d10/manager_8c_source.html#l03819">handle_updates()</a>, <a class="el" href="../../d6/dbf/astobj2__hash_8c_source.html#l01057">hash_ao2_container_init()</a>, <a class="el" href="../../d6/dbf/astobj2__hash_8c_source.html#l00239">hash_ao2_insert_node()</a>, <a class="el" href="../../d7/d0b/func__devstate_8c_source.html#l00146">hint_read()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00091">http_callback()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l01500">manager_mixmonitor()</a>, <a class="el" href="../../db/dfe/app__milliwatt_8c_source.html#l00150">milliwatt_exec()</a>, <a class="el" href="../../d8/d93/app__mixmonitor_8c_source.html#l01115">mixmonitor_exec()</a>, <a class="el" href="../../d0/d2b/chan__rtp_8c_source.html#l00139">multicast_rtp_request()</a>, <a class="el" href="../../da/db1/app__originate_8c_source.html#l00173">originate_exec()</a>, <a class="el" href="../../d6/d27/app__osplookup_8c_source.html#l02257">ospauth_exec()</a>, <a class="el" href="../../d6/d27/app__osplookup_8c_source.html#l02811">ospfinished_exec()</a>, <a class="el" href="../../d6/d27/app__osplookup_8c_source.html#l02337">osplookup_exec()</a>, <a class="el" href="../../d6/d27/app__osplookup_8c_source.html#l02629">ospnext_exec()</a>, <a class="el" href="../../d3/da4/app__page_8c_source.html#l00235">page_state_callback()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00892">park_and_announce_app_exec()</a>, <a class="el" href="../../da/ded/parking__applications_8c_source.html#l00278">park_app_parse_data()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01144">pbx_builtin_background()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l00806">pbx_builtin_incomplete()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01380">pbx_builtin_saycharacters_case()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01293">pbx_builtin_saynumber()</a>, <a class="el" href="../../df/d1d/pbx__builtins_8c_source.html#l01068">pbx_builtin_waitexten()</a>, <a class="el" href="../../d9/db1/app__directed__pickup_8c_source.html#l00420">pickupchan_exec()</a>, <a class="el" href="../../d7/d1b/app__playback_8c_source.html#l00442">playback_exec()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l07882">pqm_exec()</a>, <a class="el" href="../../d4/d92/res__pjsip__session_8c_source.html#l03789">pre_session_setup()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00206">pre_test_cb()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00102">presence_read()</a>, <a class="el" href="../../d0/d81/func__presencestate_8c_source.html#l00207">presence_write()</a>, <a class="el" href="../../d7/d17/app__privacy_8c_source.html#l00087">privacy_exec()</a>, <a class="el" href="../../d1/d97/chan__dahdi_8c_source.html#l17728">process_echocancel()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l08183">queue_exec()</a>, <a class="el" href="../../d7/d53/astobj2__rbtree_8c_source.html#l02021">rb_ao2_container_init()</a>, <a class="el" href="../../d7/d53/astobj2__rbtree_8c_source.html#l01022">rb_ao2_insert_node()</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00906">rcvfax_exec()</a>, <a class="el" href="../../d6/dbb/app__read_8c_source.html#l00127">read_exec()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00551">read_mf_exec()</a>, <a class="el" href="../../d7/d1d/app__mf_8c_source.html#l00472">read_sf_exec()</a>, <a class="el" href="../../d2/de3/app__readexten_8c_source.html#l00119">readexten_exec()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l02082">receivefax_exec()</a>, <a class="el" href="../../dd/dd5/app__record_8c_source.html#l00221">record_exec()</a>, <a class="el" href="../../da/df8/app__sayunixtime_8c_source.html#l00118">sayunixtime_exec()</a>, <a class="el" href="../../d0/de2/app__directory_8c_source.html#l00606">search_directory_sub()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l02590">sendfax_exec()</a>, <a class="el" href="../../d8/d22/app__url_8c_source.html#l00095">sendurl_exec()</a>, <a class="el" href="../../d0/d60/res__fax_8c_source.html#l04390">set_general_options()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l07562">sla_add_trunk_to_station()</a>, <a class="el" href="../../df/d44/app__meetme_8c_source.html#l07228">sla_trunk_exec()</a>, <a class="el" href="../../d8/d96/res__smdi_8c_source.html#l01202">smdi_msg_retrieve_read()</a>, <a class="el" href="../../d7/d81/app__sms_8c_source.html#l01881">sms_exec()</a>, <a class="el" href="../../df/dde/app__fax_8c_source.html#l00837">sndfax_exec()</a>, <a class="el" href="../../dc/d05/app__softhangup_8c_source.html#l00074">softhangup_exec()</a>, <a class="el" href="../../d7/d30/res__sorcery__memory__cache_8c_source.html#l01508">sorcery_memory_cache_open()</a>, <a class="el" href="../../d2/d1b/res__monitor_8c_source.html#l00693">start_monitor_exec()</a>, <a class="el" href="../../d5/d58/stir__shaken_8c_source.html#l00035">stir_shaken_cli_show()</a>, <a class="el" href="../../d0/d2b/chan__rtp_8c_source.html#l00269">unicast_rtp_request()</a>, <a class="el" href="../../da/dfb/app__queue_8c_source.html#l07918">upqm_exec()</a>, <a class="el" href="../../dc/df4/app__voicemail_8c_source.html#l12765">vmauthenticate()</a>, <a class="el" href="../../db/d57/func__volume_8c_source.html#l00224">volume_read()</a>, <a class="el" href="../../db/d57/func__volume_8c_source.html#l00150">volume_write()</a>, <a class="el" href="../../d9/d4a/app__tonedetect_8c_source.html#l00524">wait_exec()</a>, <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01071">xmpp_pubsub_build_publish_skeleton()</a>, <a class="el" href="../../dc/d6b/res__xmpp_8c_source.html#l01414">xmpp_pubsub_subscribe()</a>, and <a class="el" href="../../d0/d72/app__zapateller_8c_source.html#l00079">zapateller_exec()</a>.</p>

</div>
</div>
<a id="af04e2af06333eeaa204e80f690383b30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af04e2af06333eeaa204e80f690383b30">&#9670;&nbsp;</a></span>server_uri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char server_uri[512]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00064">64</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00223">AST_TEST_DEFINE()</a>, <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l01647">load_module()</a>, <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00607">process_config()</a>, and <a class="el" href="../../df/d3a/res__pjsip__outbound__publish_8c_source.html#l00935">sip_outbound_publisher_init()</a>.</p>

</div>
</div>
<a id="af049c3259ac9104c878aecac6f9489cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af049c3259ac9104c878aecac6f9489cc">&#9670;&nbsp;</a></span>test_uri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> test_uri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html#l00197">197</a> of file <a class="el" href="../../d4/d45/test__http__media__cache_8c_source.html">test_http_media_cache.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:46:55 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
