<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: manager.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">manager.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d10/manager_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Asterisk -- An open source telephony toolkit.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Copyright (C) 1999 - 2006, Digium, Inc.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * Mark Spencer &lt;markster@digium.com&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * See http://www.asterisk.org for more information about</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Asterisk project. Please do not directly contact</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * any of the maintainers of this project for assistance;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * the project provides a web site, mailing lists and IRC</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * channels for your use.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * This program is free software, distributed under the terms of</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * the GNU General Public License Version 2. See the LICENSE file</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * at the top of the source tree.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/*! \file</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * \brief The Asterisk Management Interface - AMI</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * \author Mark Spencer &lt;markster@digium.com&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * OpenSSL http://www.openssl.org - for AMI/SSL</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * At the moment this file contains a number of functions, namely:</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * - data structures storing AMI state</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * - AMI-related API functions, used by internal asterisk components</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * - handlers for AMI-related CLI functions</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * - handlers for AMI functions (available through the AMI socket)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * - the code for the main AMI listener thread and individual session threads</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * - the http handlers invoked for AMI-over-HTTP by the threads in main/http.c</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * \ref amiconf</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/*! \li \ref manager.c uses the configuration file \ref manager.conf and \ref users.conf</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * \addtogroup configuration_file</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/*! \page manager.conf manager.conf</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * \verbinclude manager.conf.sample</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/*! \page users.conf users.conf</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * \verbinclude users.conf.sample</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/*** MODULEINFO</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">   &lt;support_level&gt;core&lt;/support_level&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/db2/asterisk_8h.html">asterisk.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/df2/paths_8h.html">asterisk/paths.h</a>&quot;</span>   <span class="comment">/* use various ast_config_AST_* */</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;sys/time.h&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &lt;sys/mman.h&gt;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &lt;regex.h&gt;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d7b/channel_8h.html">asterisk/channel.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d4d/file_8h.html">asterisk/file.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d45/manager_8h.html">asterisk/manager.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d16/module_8h.html">asterisk/module.h</a>&quot;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html">asterisk/config.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/callerid_8h.html">asterisk/callerid.h</a>&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d42/lock_8h.html">asterisk/lock.h</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/db0/cli_8h.html">asterisk/cli.h</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html">asterisk/app.h</a>&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d33/mwi_8h.html">asterisk/mwi.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/de0/pbx_8h.html">asterisk/pbx.h</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/db0/md5_8h.html">asterisk/md5.h</a>&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d59/acl_8h.html">asterisk/acl.h</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d60/utils_8h.html">asterisk/utils.h</a>&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/ddf/tcptls_8h.html">asterisk/tcptls.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d56/http_8h.html">asterisk/http.h</a>&quot;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/db9/ast__version_8h.html">asterisk/ast_version.h</a>&quot;</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d7d/threadstorage_8h.html">asterisk/threadstorage.h</a>&quot;</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d90/linkedlists_8h.html">asterisk/linkedlists.h</a>&quot;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d45/term_8h.html">asterisk/term.h</a>&quot;</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/da5/astobj2_8h.html">asterisk/astobj2.h</a>&quot;</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d47/features_8h.html">asterisk/features.h</a>&quot;</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html">asterisk/security_events.h</a>&quot;</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/db3/aoc_8h.html">asterisk/aoc.h</a>&quot;</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/d90/strings_8h.html">asterisk/strings.h</a>&quot;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d0f/stringfields_8h.html">asterisk/stringfields.h</a>&quot;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d6/dd7/presencestate_8h.html">asterisk/presencestate.h</a>&quot;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d25/stasis__message__router_8h.html">asterisk/stasis_message_router.h</a>&quot;</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d4a/stasis__channels_8h.html">asterisk/stasis_channels.h</a>&quot;</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/d4e/stasis__bridges_8h.html">asterisk/stasis_bridges.h</a>&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/ddc/test_8h.html">asterisk/test.h</a>&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d05/json_8h.html">asterisk/json.h</a>&quot;</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/d56/bridge_8h.html">asterisk/bridge.h</a>&quot;</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html">asterisk/features_config.h</a>&quot;</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dde/rtp__engine_8h.html">asterisk/rtp_engine.h</a>&quot;</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d1c/format__cache_8h.html">asterisk/format_cache.h</a>&quot;</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d39/translate_8h.html">asterisk/translate.h</a>&quot;</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d1e/taskprocessor_8h.html">asterisk/taskprocessor.h</a>&quot;</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/d0d/message_8h.html">asterisk/message.h</a>&quot;</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">/*** DOCUMENTATION</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">   &lt;manager name=&quot;Ping&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">         Keepalive command.</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">         &lt;para&gt;A &#39;Ping&#39; action will ellicit a &#39;Pong&#39; response. Used to keep the</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">         manager connection open.&lt;/para&gt;</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">   &lt;manager name=&quot;Events&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">         Control Event Flow.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">         &lt;parameter name=&quot;EventMask&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">               &lt;enum name=&quot;on&quot;&gt;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">                  &lt;para&gt;If all events should be sent.&lt;/para&gt;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">               &lt;enum name=&quot;off&quot;&gt;</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">                  &lt;para&gt;If no events should be sent.&lt;/para&gt;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">               &lt;enum name=&quot;system,call,log,...&quot;&gt;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">                  &lt;para&gt;To select which flags events should have to be sent.&lt;/para&gt;</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">         &lt;para&gt;Enable/Disable sending of events to this manager client.&lt;/para&gt;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">   &lt;manager name=&quot;Logoff&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">         Logoff Manager.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">         &lt;para&gt;Logoff the current manager session.&lt;/para&gt;</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;Login&lt;/ref&gt;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">   &lt;manager name=&quot;Login&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">         Login Manager.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">         &lt;parameter name=&quot;ActionID&quot;&gt;</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">            &lt;para&gt;ActionID for this transaction. Will be returned.&lt;/para&gt;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">         &lt;parameter name=&quot;Username&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">            &lt;para&gt;Username to login with as specified in manager.conf.&lt;/para&gt;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">         &lt;parameter name=&quot;Secret&quot;&gt;</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">            &lt;para&gt;Secret to login with as specified in manager.conf.&lt;/para&gt;</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">         &lt;para&gt;Login Manager.&lt;/para&gt;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;Logoff&lt;/ref&gt;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">   &lt;manager name=&quot;Challenge&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">         Generate Challenge for MD5 Auth.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">         &lt;parameter name=&quot;AuthType&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">            &lt;para&gt;Digest algorithm to use in the challenge. Valid values are:&lt;/para&gt;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">               &lt;enum name=&quot;MD5&quot; /&gt;</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">         &lt;para&gt;Generate a challenge for MD5 authentication.&lt;/para&gt;</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">   &lt;manager name=&quot;Hangup&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">         Hangup channel.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">            &lt;para&gt;The exact channel name to be hungup, or to use a regular expression, set this parameter to: /regex/&lt;/para&gt;</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">            &lt;para&gt;Example exact channel: SIP/provider-0000012a&lt;/para&gt;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">            &lt;para&gt;Example regular expression: /^SIP/provider-.*$/&lt;/para&gt;</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">         &lt;parameter name=&quot;Cause&quot;&gt;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">            &lt;para&gt;Numeric hangup cause.&lt;/para&gt;</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">         &lt;para&gt;Hangup a channel.&lt;/para&gt;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">   &lt;manager name=&quot;Status&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">         List channel status.</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;false&quot;&gt;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">            &lt;para&gt;The name of the channel to query for status.&lt;/para&gt;</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">         &lt;parameter name=&quot;Variables&quot;&gt;</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">            &lt;para&gt;Comma &lt;literal&gt;,&lt;/literal&gt; separated list of variable to include.&lt;/para&gt;</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">         &lt;parameter name=&quot;AllVariables&quot;&gt;</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">            &lt;para&gt;If set to &quot;true&quot;, the Status event will include all channel variables for</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">            the requested channel(s).&lt;/para&gt;</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">               &lt;enum name=&quot;true&quot;/&gt;</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">               &lt;enum name=&quot;false&quot;/&gt;</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">         &lt;para&gt;Will return the status information of each channel along with the</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">         value for the specified channel variables.&lt;/para&gt;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">      &lt;responses&gt;</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">         &lt;list-elements&gt;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;Status&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">         &lt;/list-elements&gt;</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;StatusComplete&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">      &lt;/responses&gt;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;Status&quot;&gt;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_CALL&quot;&gt;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised in response to a Status command.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">            &lt;parameter name=&quot;ActionID&quot; required=&quot;false&quot;/&gt;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">            &lt;parameter name=&quot;Type&quot;&gt;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">               &lt;para&gt;Type of channel&lt;/para&gt;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">            &lt;parameter name=&quot;DNID&quot;&gt;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">               &lt;para&gt;Dialed number identifier&lt;/para&gt;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">            &lt;parameter name=&quot;EffectiveConnectedLineNum&quot;&gt;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">            &lt;parameter name=&quot;EffectiveConnectedLineName&quot;&gt;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">            &lt;parameter name=&quot;TimeToHangup&quot;&gt;</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">               &lt;para&gt;Absolute lifetime of the channel&lt;/para&gt;</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">            &lt;parameter name=&quot;BridgeID&quot;&gt;</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">               &lt;para&gt;Identifier of the bridge the channel is in, may be empty if not in one&lt;/para&gt;</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">            &lt;parameter name=&quot;Application&quot;&gt;</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">               &lt;para&gt;Application currently executing on the channel&lt;/para&gt;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">            &lt;parameter name=&quot;Data&quot;&gt;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">               &lt;para&gt;Data given to the currently executing channel&lt;/para&gt;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">            &lt;parameter name=&quot;Nativeformats&quot;&gt;</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">               &lt;para&gt;Media formats the connected party is willing to send or receive&lt;/para&gt;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">            &lt;parameter name=&quot;Readformat&quot;&gt;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">               &lt;para&gt;Media formats that frames from the channel are received in&lt;/para&gt;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">            &lt;parameter name=&quot;Readtrans&quot;&gt;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">               &lt;para&gt;Translation path for media received in native formats&lt;/para&gt;</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">            &lt;parameter name=&quot;Writeformat&quot;&gt;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">               &lt;para&gt;Media formats that frames to the channel are accepted in&lt;/para&gt;</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">            &lt;parameter name=&quot;Writetrans&quot;&gt;</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">               &lt;para&gt;Translation path for media sent to the connected party&lt;/para&gt;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">            &lt;parameter name=&quot;Callgroup&quot;&gt;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">               &lt;para&gt;Configured call group on the channel&lt;/para&gt;</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">            &lt;parameter name=&quot;Pickupgroup&quot;&gt;</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">               &lt;para&gt;Configured pickup group on the channel&lt;/para&gt;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">            &lt;parameter name=&quot;Seconds&quot;&gt;</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">               &lt;para&gt;Number of seconds the channel has been active&lt;/para&gt;</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;Status&lt;/ref&gt;</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;StatusComplete&quot;&gt;</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_CALL&quot;&gt;</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised in response to a Status command.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">            &lt;parameter name=&quot;Items&quot;&gt;</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">               &lt;para&gt;Number of Status events returned&lt;/para&gt;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;Status&lt;/ref&gt;</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">   &lt;manager name=&quot;Setvar&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">         Sets a channel variable or function value.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot;&gt;</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">            &lt;para&gt;Channel to set variable for.&lt;/para&gt;</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">         &lt;parameter name=&quot;Variable&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">            &lt;para&gt;Variable name, function or expression.&lt;/para&gt;</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">         &lt;parameter name=&quot;Value&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">            &lt;para&gt;Variable or function value.&lt;/para&gt;</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">         &lt;para&gt;This command can be used to set the value of channel variables or dialplan</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">         functions.&lt;/para&gt;</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">         &lt;note&gt;</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">            &lt;para&gt;If a channel name is not provided then the variable is considered global.&lt;/para&gt;</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">         &lt;/note&gt;</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;Getvar&lt;/ref&gt;</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">   &lt;manager name=&quot;Getvar&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">         Gets a channel variable or function value.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot;&gt;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">            &lt;para&gt;Channel to read variable from.&lt;/para&gt;</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">         &lt;parameter name=&quot;Variable&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">            &lt;para&gt;Variable name, function or expression.&lt;/para&gt;</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">         &lt;para&gt;Get the value of a channel variable or function return.&lt;/para&gt;</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">         &lt;note&gt;</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">            &lt;para&gt;If a channel name is not provided then the variable is considered global.&lt;/para&gt;</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">         &lt;/note&gt;</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;Setvar&lt;/ref&gt;</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">   &lt;manager name=&quot;GetConfig&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">         Retrieve configuration.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">         &lt;parameter name=&quot;Filename&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">            &lt;para&gt;Configuration filename (e.g. &lt;filename&gt;foo.conf&lt;/filename&gt;).&lt;/para&gt;</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">         &lt;parameter name=&quot;Category&quot;&gt;</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">            &lt;para&gt;Category in configuration file.&lt;/para&gt;</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">         &lt;parameter name=&quot;Filter&quot;&gt;</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">            &lt;para&gt;A comma separated list of</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">            &lt;replaceable&gt;name_regex&lt;/replaceable&gt;=&lt;replaceable&gt;value_regex&lt;/replaceable&gt;</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">            expressions which will cause only categories whose variables match all expressions</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">            to be considered.  The special variable name &lt;literal&gt;TEMPLATES&lt;/literal&gt;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">            can be used to control whether templates are included.  Passing</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">            &lt;literal&gt;include&lt;/literal&gt; as the value will include templates</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">            along with normal categories. Passing</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">            &lt;literal&gt;restrict&lt;/literal&gt; as the value will restrict the operation to</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">            ONLY templates.  Not specifying a &lt;literal&gt;TEMPLATES&lt;/literal&gt; expression</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">            results in the default behavior which is to not include templates.&lt;/para&gt;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">         &lt;para&gt;This action will dump the contents of a configuration</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">         file by category and contents or optionally by specified category only.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">         In the case where a category name is non-unique, a filter may be specified</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">         to match only categories with matching variable values.&lt;/para&gt;</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfigJSON&lt;/ref&gt;</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;UpdateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;CreateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;ListCategories&lt;/ref&gt;</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">   &lt;manager name=&quot;GetConfigJSON&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">         Retrieve configuration (JSON format).</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">         &lt;parameter name=&quot;Filename&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">            &lt;para&gt;Configuration filename (e.g. &lt;filename&gt;foo.conf&lt;/filename&gt;).&lt;/para&gt;</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">         &lt;parameter name=&quot;Category&quot;&gt;</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">            &lt;para&gt;Category in configuration file.&lt;/para&gt;</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">         &lt;parameter name=&quot;Filter&quot;&gt;</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;GetConfig&#39;]/syntax/parameter[@name=&#39;Filter&#39;]/para[1])&quot; /&gt;</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">         &lt;para&gt;This action will dump the contents of a configuration file by category</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">         and contents in JSON format or optionally by specified category only.</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">         This only makes sense to be used using rawman over the HTTP interface.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">         In the case where a category name is non-unique, a filter may be specified</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">         to match only categories with matching variable values.&lt;/para&gt;</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;UpdateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;CreateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;ListCategories&lt;/ref&gt;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">   &lt;manager name=&quot;UpdateConfig&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">         Update basic configuration.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">         &lt;parameter name=&quot;SrcFilename&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">            &lt;para&gt;Configuration filename to read (e.g. &lt;filename&gt;foo.conf&lt;/filename&gt;).&lt;/para&gt;</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">         &lt;parameter name=&quot;DstFilename&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">            &lt;para&gt;Configuration filename to write (e.g. &lt;filename&gt;foo.conf&lt;/filename&gt;)&lt;/para&gt;</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">         &lt;parameter name=&quot;Reload&quot;&gt;</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">            &lt;para&gt;Whether or not a reload should take place (or name of specific module).&lt;/para&gt;</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">         &lt;parameter name=&quot;PreserveEffectiveContext&quot;&gt;</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">            &lt;para&gt;Whether the effective category contents should be preserved on template change. Default is true (pre 13.2 behavior).&lt;/para&gt;</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">         &lt;parameter name=&quot;Action-000000&quot;&gt;</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">            &lt;para&gt;Action to take.&lt;/para&gt;</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">            &lt;para&gt;0&#39;s represent 6 digit number beginning with 000000.&lt;/para&gt;</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">               &lt;enum name=&quot;NewCat&quot; /&gt;</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">               &lt;enum name=&quot;RenameCat&quot; /&gt;</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">               &lt;enum name=&quot;DelCat&quot; /&gt;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">               &lt;enum name=&quot;EmptyCat&quot; /&gt;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">               &lt;enum name=&quot;Update&quot; /&gt;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">               &lt;enum name=&quot;Delete&quot; /&gt;</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">               &lt;enum name=&quot;Append&quot; /&gt;</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">               &lt;enum name=&quot;Insert&quot; /&gt;</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">         &lt;parameter name=&quot;Cat-000000&quot;&gt;</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">            &lt;para&gt;Category to operate on.&lt;/para&gt;</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;UpdateConfig&#39;]/syntax/parameter[@name=&#39;Action-000000&#39;]/para[2])&quot; /&gt;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">         &lt;parameter name=&quot;Var-000000&quot;&gt;</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">            &lt;para&gt;Variable to work on.&lt;/para&gt;</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;UpdateConfig&#39;]/syntax/parameter[@name=&#39;Action-000000&#39;]/para[2])&quot; /&gt;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">         &lt;parameter name=&quot;Value-000000&quot;&gt;</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">            &lt;para&gt;Value to work on.&lt;/para&gt;</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;UpdateConfig&#39;]/syntax/parameter[@name=&#39;Action-000000&#39;]/para[2])&quot; /&gt;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">         &lt;parameter name=&quot;Match-000000&quot;&gt;</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">            &lt;para&gt;Extra match required to match line.&lt;/para&gt;</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;UpdateConfig&#39;]/syntax/parameter[@name=&#39;Action-000000&#39;]/para[2])&quot; /&gt;</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">         &lt;parameter name=&quot;Line-000000&quot;&gt;</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">            &lt;para&gt;Line in category to operate on (used with delete and insert actions).&lt;/para&gt;</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;UpdateConfig&#39;]/syntax/parameter[@name=&#39;Action-000000&#39;]/para[2])&quot; /&gt;</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">         &lt;parameter name=&quot;Options-000000&quot;&gt;</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">            &lt;para&gt;A comma separated list of action-specific options.&lt;/para&gt;</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">                  &lt;enum name=&quot;NewCat&quot;&gt;&lt;para&gt;One or more of the following... &lt;/para&gt;</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">                     &lt;enumlist&gt;</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">                        &lt;enum name=&quot;allowdups&quot;&gt;&lt;para&gt;Allow duplicate category names.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">                        &lt;enum name=&quot;template&quot;&gt;&lt;para&gt;This category is a template.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">                        &lt;enum name=&quot;inherit=&amp;quot;template[,...]&amp;quot;&quot;&gt;&lt;para&gt;Templates from which to inherit.&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">                     &lt;/enumlist&gt;</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">               &lt;para&gt; &lt;/para&gt;</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">                  &lt;para&gt;The following actions share the same options...&lt;/para&gt;</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">                  &lt;enum name=&quot;RenameCat&quot;/&gt;</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">                  &lt;enum name=&quot;DelCat&quot;/&gt;</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">                  &lt;enum name=&quot;EmptyCat&quot;/&gt;</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">                  &lt;enum name=&quot;Update&quot;/&gt;</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">                  &lt;enum name=&quot;Delete&quot;/&gt;</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">                  &lt;enum name=&quot;Append&quot;/&gt;</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">                  &lt;enum name=&quot;Insert&quot;&gt;&lt;para&gt; &lt;/para&gt;</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">                     &lt;enumlist&gt;</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">                        &lt;enum name=&quot;catfilter=&amp;quot;&amp;lt;expression&amp;gt;[,...]&amp;quot;&quot;&gt;&lt;para&gt; &lt;/para&gt;</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">                           &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;GetConfig&#39;]/syntax/parameter[@name=&#39;Filter&#39;]/para[1])&quot; /&gt;</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">                           &lt;para&gt;&lt;literal&gt;catfilter&lt;/literal&gt; is most useful when a file</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">                           contains multiple categories with the same name and you wish to</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">                           operate on specific ones instead of all of them.&lt;/para&gt;</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">                        &lt;/enum&gt;</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">                     &lt;/enumlist&gt;</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;UpdateConfig&#39;]/syntax/parameter[@name=&#39;Action-000000&#39;]/para[2])&quot; /&gt;</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">         &lt;para&gt;This action will modify, create, or delete configuration elements</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">         in Asterisk configuration files.&lt;/para&gt;</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfigJSON&lt;/ref&gt;</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;CreateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;ListCategories&lt;/ref&gt;</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">   &lt;manager name=&quot;CreateConfig&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">         Creates an empty file in the configuration directory.</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">         &lt;parameter name=&quot;Filename&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">            &lt;para&gt;The configuration filename to create (e.g. &lt;filename&gt;foo.conf&lt;/filename&gt;).&lt;/para&gt;</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">         &lt;para&gt;This action will create an empty file in the configuration</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">         directory. This action is intended to be used before an UpdateConfig</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">         action.&lt;/para&gt;</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfigJSON&lt;/ref&gt;</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;UpdateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;ListCategories&lt;/ref&gt;</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">   &lt;manager name=&quot;ListCategories&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">         List categories in configuration file.</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">         &lt;parameter name=&quot;Filename&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">            &lt;para&gt;Configuration filename (e.g. &lt;filename&gt;foo.conf&lt;/filename&gt;).&lt;/para&gt;</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">         &lt;para&gt;This action will dump the categories in a given file.&lt;/para&gt;</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;GetConfigJSON&lt;/ref&gt;</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;UpdateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;CreateConfig&lt;/ref&gt;</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">   &lt;manager name=&quot;Redirect&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">         Redirect (transfer) a call.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">            &lt;para&gt;Channel to redirect.&lt;/para&gt;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">         &lt;parameter name=&quot;ExtraChannel&quot;&gt;</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">            &lt;para&gt;Second call leg to transfer (optional).&lt;/para&gt;</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">         &lt;parameter name=&quot;Exten&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">            &lt;para&gt;Extension to transfer to.&lt;/para&gt;</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">         &lt;parameter name=&quot;ExtraExten&quot;&gt;</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">            &lt;para&gt;Extension to transfer extrachannel to (optional).&lt;/para&gt;</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">         &lt;parameter name=&quot;Context&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">            &lt;para&gt;Context to transfer to.&lt;/para&gt;</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">         &lt;parameter name=&quot;ExtraContext&quot;&gt;</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">            &lt;para&gt;Context to transfer extrachannel to (optional).&lt;/para&gt;</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">         &lt;parameter name=&quot;Priority&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">            &lt;para&gt;Priority to transfer to.&lt;/para&gt;</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">         &lt;parameter name=&quot;ExtraPriority&quot;&gt;</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">            &lt;para&gt;Priority to transfer extrachannel to (optional).&lt;/para&gt;</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">         &lt;para&gt;Redirect (transfer) a call.&lt;/para&gt;</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;BlindTransfer&lt;/ref&gt;</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">   &lt;manager name=&quot;Atxfer&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">         Attended transfer.</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">            &lt;para&gt;Transferer&#39;s channel.&lt;/para&gt;</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">         &lt;parameter name=&quot;Exten&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">            &lt;para&gt;Extension to transfer to.&lt;/para&gt;</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">         &lt;parameter name=&quot;Context&quot;&gt;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">            &lt;para&gt;Context to transfer to.&lt;/para&gt;</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">         &lt;para&gt;Attended transfer.&lt;/para&gt;</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;AttendedTransfer&lt;/ref&gt;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">   &lt;manager name=&quot;CancelAtxfer&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">         Cancel an attended transfer.</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">            &lt;para&gt;The transferer channel.&lt;/para&gt;</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">         &lt;para&gt;Cancel an attended transfer. Note, this uses the configured cancel attended transfer</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">         feature option (atxferabort) to cancel the transfer. If not available this action will fail.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">         &lt;/para&gt;</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;AttendedTransfer&lt;/ref&gt;</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">   &lt;manager name=&quot;Originate&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">         Originate a call.</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">            &lt;para&gt;Channel name to call.&lt;/para&gt;</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">         &lt;parameter name=&quot;Exten&quot;&gt;</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">            &lt;para&gt;Extension to use (requires &lt;literal&gt;Context&lt;/literal&gt; and</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">            &lt;literal&gt;Priority&lt;/literal&gt;)&lt;/para&gt;</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">         &lt;parameter name=&quot;Context&quot;&gt;</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">            &lt;para&gt;Context to use (requires &lt;literal&gt;Exten&lt;/literal&gt; and</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">            &lt;literal&gt;Priority&lt;/literal&gt;)&lt;/para&gt;</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">         &lt;parameter name=&quot;Priority&quot;&gt;</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">            &lt;para&gt;Priority to use (requires &lt;literal&gt;Exten&lt;/literal&gt; and</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">            &lt;literal&gt;Context&lt;/literal&gt;)&lt;/para&gt;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">         &lt;parameter name=&quot;Application&quot;&gt;</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">            &lt;para&gt;Application to execute.&lt;/para&gt;</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">         &lt;parameter name=&quot;Data&quot;&gt;</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">            &lt;para&gt;Data to use (requires &lt;literal&gt;Application&lt;/literal&gt;).&lt;/para&gt;</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">         &lt;parameter name=&quot;Timeout&quot; default=&quot;30000&quot;&gt;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">            &lt;para&gt;How long to wait for call to be answered (in ms.).&lt;/para&gt;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">         &lt;parameter name=&quot;CallerID&quot;&gt;</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">            &lt;para&gt;Caller ID to be set on the outgoing channel.&lt;/para&gt;</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">         &lt;parameter name=&quot;Variable&quot;&gt;</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">            &lt;para&gt;Channel variable to set, multiple Variable: headers are allowed.&lt;/para&gt;</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">         &lt;parameter name=&quot;Account&quot;&gt;</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">            &lt;para&gt;Account code.&lt;/para&gt;</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">         &lt;parameter name=&quot;EarlyMedia&quot;&gt;</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">            &lt;para&gt;Set to &lt;literal&gt;true&lt;/literal&gt; to force call bridge on early media..&lt;/para&gt;</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">         &lt;parameter name=&quot;Async&quot;&gt;</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">            &lt;para&gt;Set to &lt;literal&gt;true&lt;/literal&gt; for fast origination.&lt;/para&gt;</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">         &lt;parameter name=&quot;Codecs&quot;&gt;</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">            &lt;para&gt;Comma-separated list of codecs to use for this call.&lt;/para&gt;</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">         &lt;parameter name=&quot;ChannelId&quot;&gt;</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">            &lt;para&gt;Channel UniqueId to be set on the channel.&lt;/para&gt;</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">         &lt;parameter name=&quot;OtherChannelId&quot;&gt;</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">            &lt;para&gt;Channel UniqueId to be set on the second local channel.&lt;/para&gt;</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">         &lt;para&gt;Generates an outgoing call to a</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">         &lt;replaceable&gt;Extension&lt;/replaceable&gt;/&lt;replaceable&gt;Context&lt;/replaceable&gt;/&lt;replaceable&gt;Priority&lt;/replaceable&gt;</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">         or &lt;replaceable&gt;Application&lt;/replaceable&gt;/&lt;replaceable&gt;Data&lt;/replaceable&gt;&lt;/para&gt;</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;OriginateResponse&lt;/ref&gt;</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;OriginateResponse&quot;&gt;</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_CALL&quot;&gt;</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised in response to an Originate command.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">            &lt;parameter name=&quot;ActionID&quot; required=&quot;false&quot;/&gt;</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">            &lt;parameter name=&quot;Response&quot;&gt;</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">                  &lt;enum name=&quot;Failure&quot;/&gt;</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">                  &lt;enum name=&quot;Success&quot;/&gt;</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">            &lt;parameter name=&quot;Channel&quot;/&gt;</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">            &lt;parameter name=&quot;Context&quot;/&gt;</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">            &lt;parameter name=&quot;Exten&quot;/&gt;</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">            &lt;parameter name=&quot;Application&quot;/&gt;</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">            &lt;parameter name=&quot;Data&quot;/&gt;</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">            &lt;parameter name=&quot;Reason&quot;/&gt;</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">            &lt;parameter name=&quot;Uniqueid&quot;/&gt;</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">            &lt;parameter name=&quot;CallerIDNum&quot;/&gt;</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment">            &lt;parameter name=&quot;CallerIDName&quot;/&gt;</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;Originate&lt;/ref&gt;</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">   &lt;manager name=&quot;Command&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">         Execute Asterisk CLI Command.</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">         &lt;parameter name=&quot;Command&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">            &lt;para&gt;Asterisk CLI command to run.&lt;/para&gt;</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">         &lt;para&gt;Run a CLI command.&lt;/para&gt;</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">   &lt;manager name=&quot;ExtensionState&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">         Check Extension Status.</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">         &lt;parameter name=&quot;Exten&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">            &lt;para&gt;Extension to check state on.&lt;/para&gt;</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">         &lt;parameter name=&quot;Context&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">            &lt;para&gt;Context for extension.&lt;/para&gt;</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">         &lt;para&gt;Report the extension state for given extension. If the extension has a hint,</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">         will use devicestate to check the status of the device connected to the extension.&lt;/para&gt;</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">         &lt;para&gt;Will return an &lt;literal&gt;Extension Status&lt;/literal&gt; message. The response will include</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment">         the hint for the extension and the status.&lt;/para&gt;</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;ExtensionStatus&lt;/ref&gt;</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">   &lt;manager name=&quot;PresenceState&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">         Check Presence State</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">         &lt;parameter name=&quot;Provider&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">            &lt;para&gt;Presence Provider to check the state of&lt;/para&gt;</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">         &lt;para&gt;Report the presence state for the given presence provider.&lt;/para&gt;</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">         &lt;para&gt;Will return a &lt;literal&gt;Presence State&lt;/literal&gt; message. The response will include the</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">         presence state and, if set, a presence subtype and custom message.&lt;/para&gt;</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;PresenceStatus&lt;/ref&gt;</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">   &lt;manager name=&quot;AbsoluteTimeout&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">         Set absolute timeout.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">            &lt;para&gt;Channel name to hangup.&lt;/para&gt;</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">         &lt;parameter name=&quot;Timeout&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">            &lt;para&gt;Maximum duration of the call (sec).&lt;/para&gt;</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">         &lt;para&gt;Hangup a channel after a certain time. Acknowledges set time with</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">         &lt;literal&gt;Timeout Set&lt;/literal&gt; message.&lt;/para&gt;</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">   &lt;manager name=&quot;MailboxStatus&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">         Check mailbox.</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">         &lt;parameter name=&quot;Mailbox&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">            &lt;para&gt;Full mailbox ID &lt;replaceable&gt;mailbox&lt;/replaceable&gt;@&lt;replaceable&gt;vm-context&lt;/replaceable&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">         &lt;para&gt;Checks a voicemail account for status.&lt;/para&gt;</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">         &lt;para&gt;Returns whether there are messages waiting.&lt;/para&gt;</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">         &lt;para&gt;Message: Mailbox Status.&lt;/para&gt;</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">         &lt;para&gt;Mailbox: &lt;replaceable&gt;mailboxid&lt;/replaceable&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">         &lt;para&gt;Waiting: &lt;literal&gt;0&lt;/literal&gt; if messages waiting, &lt;literal&gt;1&lt;/literal&gt;</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">         if no messages waiting.&lt;/para&gt;</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;MailboxCount&lt;/ref&gt;</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">   &lt;manager name=&quot;MailboxCount&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">         Check Mailbox Message Count.</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">         &lt;parameter name=&quot;Mailbox&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">            &lt;para&gt;Full mailbox ID &lt;replaceable&gt;mailbox&lt;/replaceable&gt;@&lt;replaceable&gt;vm-context&lt;/replaceable&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">         &lt;para&gt;Checks a voicemail account for new messages.&lt;/para&gt;</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">         &lt;para&gt;Returns number of urgent, new and old messages.&lt;/para&gt;</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">         &lt;para&gt;Message: Mailbox Message Count&lt;/para&gt;</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">         &lt;para&gt;Mailbox: &lt;replaceable&gt;mailboxid&lt;/replaceable&gt;&lt;/para&gt;</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">         &lt;para&gt;UrgentMessages: &lt;replaceable&gt;count&lt;/replaceable&gt;&lt;/para&gt;</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">         &lt;para&gt;NewMessages: &lt;replaceable&gt;count&lt;/replaceable&gt;&lt;/para&gt;</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">         &lt;para&gt;OldMessages: &lt;replaceable&gt;count&lt;/replaceable&gt;&lt;/para&gt;</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;MailboxStatus&lt;/ref&gt;</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">   &lt;manager name=&quot;ListCommands&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">         List available manager commands.</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">         &lt;para&gt;Returns the action name and synopsis for every action that</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">         is available to the user.&lt;/para&gt;</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">   &lt;manager name=&quot;SendText&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">         Sends a text message to channel. A content type can be optionally specified. If not set</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">         it is set to an empty string allowing a custom handler to default it as it sees fit.</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">            &lt;para&gt;Channel to send message to.&lt;/para&gt;</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">         &lt;parameter name=&quot;Message&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">            &lt;para&gt;Message to send.&lt;/para&gt;</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">         &lt;parameter name=&quot;Content-Type&quot; required=&quot;false&quot; default=&quot;&quot;&gt;</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">            &lt;para&gt;The type of content in the message&lt;/para&gt;</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">         &lt;para&gt;Sends A Text Message to a channel while in a call.&lt;/para&gt;</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;SendText&lt;/ref&gt;</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">   &lt;manager name=&quot;UserEvent&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">         Send an arbitrary event.</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">         &lt;parameter name=&quot;UserEvent&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">            &lt;para&gt;Event string to send.&lt;/para&gt;</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">         &lt;parameter name=&quot;Header1&quot;&gt;</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">            &lt;para&gt;Content1.&lt;/para&gt;</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">         &lt;parameter name=&quot;HeaderN&quot;&gt;</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">            &lt;para&gt;ContentN.&lt;/para&gt;</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">         &lt;para&gt;Send an event to manager sessions.&lt;/para&gt;</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;UserEvent&lt;/ref&gt;</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment">         &lt;ref type=&quot;application&quot;&gt;UserEvent&lt;/ref&gt;</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">   &lt;manager name=&quot;WaitEvent&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment">         Wait for an event to occur.</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">         &lt;parameter name=&quot;Timeout&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">            &lt;para&gt;Maximum time (in seconds) to wait for events, &lt;literal&gt;-1&lt;/literal&gt; means forever.&lt;/para&gt;</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="comment">         &lt;para&gt;This action will ellicit a &lt;literal&gt;Success&lt;/literal&gt; response. Whenever</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment">         a manager event is queued. Once WaitEvent has been called on an HTTP manager</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">         session, events will be generated and queued.&lt;/para&gt;</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">   &lt;manager name=&quot;CoreSettings&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">         Show PBX core settings (version etc).</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">         &lt;para&gt;Query for Core PBX settings.&lt;/para&gt;</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">   &lt;manager name=&quot;CoreStatus&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">         Show PBX core status variables.</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">         &lt;para&gt;Query for Core PBX status.&lt;/para&gt;</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">   &lt;manager name=&quot;Reload&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">         Send a reload event.</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">         &lt;parameter name=&quot;Module&quot;&gt;</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">            &lt;para&gt;Name of the module to reload.&lt;/para&gt;</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">         &lt;para&gt;Send a reload event.&lt;/para&gt;</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;ModuleLoad&lt;/ref&gt;</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;CoreShowChannel&quot;&gt;</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_CALL&quot;&gt;</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised in response to a CoreShowChannels command.&lt;/synopsis&gt;</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">            &lt;channel_snapshot/&gt;</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">            &lt;parameter name=&quot;BridgeId&quot;&gt;</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">               &lt;para&gt;Identifier of the bridge the channel is in, may be empty if not in one&lt;/para&gt;</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">            &lt;parameter name=&quot;Application&quot;&gt;</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">               &lt;para&gt;Application currently executing on the channel&lt;/para&gt;</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">            &lt;parameter name=&quot;ApplicationData&quot;&gt;</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">               &lt;para&gt;Data given to the currently executing application&lt;/para&gt;</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">            &lt;parameter name=&quot;Duration&quot;&gt;</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">               &lt;para&gt;The amount of time the channel has existed&lt;/para&gt;</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;CoreShowChannels&lt;/ref&gt;</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;CoreShowChannelsComplete&lt;/ref&gt;</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">   &lt;managerEvent language=&quot;en_US&quot; name=&quot;CoreShowChannelsComplete&quot;&gt;</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_CALL&quot;&gt;</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised at the end of the CoreShowChannel list produced by the CoreShowChannels command.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">            &lt;parameter name=&quot;EventList&quot;&gt;</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">               &lt;para&gt;Conveys the status of the command reponse list&lt;/para&gt;</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">            &lt;parameter name=&quot;ListItems&quot;&gt;</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">               &lt;para&gt;The total number of list items produced&lt;/para&gt;</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;CoreShowChannels&lt;/ref&gt;</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">            &lt;ref type=&quot;managerEvent&quot;&gt;CoreShowChannel&lt;/ref&gt;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">   &lt;manager name=&quot;CoreShowChannels&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">         List currently active channels.</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">         &lt;para&gt;List currently defined channels and some information about them.&lt;/para&gt;</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">      &lt;responses&gt;</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">         &lt;list-elements&gt;</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">            &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;CoreShowChannel&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">         &lt;/list-elements&gt;</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/managerEvent[@name=&#39;CoreShowChannelsComplete&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">      &lt;/responses&gt;</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">   &lt;manager name=&quot;LoggerRotate&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">         Reload and rotate the Asterisk logger.</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">         &lt;para&gt;Reload and rotate the logger. Analogous to the CLI command &#39;logger rotate&#39;.&lt;/para&gt;</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">   &lt;manager name=&quot;ModuleLoad&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">         Module management.</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">         &lt;parameter name=&quot;Module&quot;&gt;</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">            &lt;para&gt;Asterisk module name (including .so extension) or subsystem identifier:&lt;/para&gt;</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">               &lt;enum name=&quot;cdr&quot; /&gt;</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">               &lt;enum name=&quot;dnsmgr&quot; /&gt;</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">               &lt;enum name=&quot;extconfig&quot; /&gt;</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">               &lt;enum name=&quot;enum&quot; /&gt;</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">               &lt;enum name=&quot;acl&quot; /&gt;</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">               &lt;enum name=&quot;manager&quot; /&gt;</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">               &lt;enum name=&quot;http&quot; /&gt;</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">               &lt;enum name=&quot;logger&quot; /&gt;</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">               &lt;enum name=&quot;features&quot; /&gt;</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">               &lt;enum name=&quot;dsp&quot; /&gt;</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">               &lt;enum name=&quot;udptl&quot; /&gt;</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">               &lt;enum name=&quot;indications&quot; /&gt;</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">               &lt;enum name=&quot;cel&quot; /&gt;</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">               &lt;enum name=&quot;plc&quot; /&gt;</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">         &lt;parameter name=&quot;LoadType&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">            &lt;para&gt;The operation to be done on module. Subsystem identifiers may only</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment">            be reloaded.&lt;/para&gt;</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">               &lt;enum name=&quot;load&quot; /&gt;</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">               &lt;enum name=&quot;unload&quot; /&gt;</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">               &lt;enum name=&quot;reload&quot; /&gt;</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">            &lt;para&gt;If no module is specified for a &lt;literal&gt;reload&lt;/literal&gt; loadtype,</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">            all modules are reloaded.&lt;/para&gt;</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">         &lt;para&gt;Loads, unloads or reloads an Asterisk module in a running system.&lt;/para&gt;</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;Reload&lt;/ref&gt;</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;ModuleCheck&lt;/ref&gt;</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">   &lt;manager name=&quot;ModuleCheck&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">         Check if module is loaded.</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">         &lt;parameter name=&quot;Module&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">            &lt;para&gt;Asterisk module name (not including extension).&lt;/para&gt;</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">         &lt;para&gt;Checks if Asterisk module is loaded. Will return Success/Failure.</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">         For success returns, the module revision number is included.&lt;/para&gt;</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;ModuleLoad&lt;/ref&gt;</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">   &lt;manager name=&quot;AOCMessage&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">         Generate an Advice of Charge message on a channel.</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">            &lt;para&gt;Channel name to generate the AOC message on.&lt;/para&gt;</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">         &lt;parameter name=&quot;ChannelPrefix&quot;&gt;</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">            &lt;para&gt;Partial channel prefix.  By using this option one can match the beginning part</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">            of a channel name without having to put the entire name in.  For example</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">            if a channel name is SIP/snom-00000001 and this value is set to SIP/snom, then</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">            that channel matches and the message will be sent.  Note however that only</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">            the first matched channel has the message sent on it. &lt;/para&gt;</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment">         &lt;parameter name=&quot;MsgType&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment">            &lt;para&gt;Defines what type of AOC message to create, AOC-D or AOC-E&lt;/para&gt;</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">               &lt;enum name=&quot;D&quot; /&gt;</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">               &lt;enum name=&quot;E&quot; /&gt;</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="comment">         &lt;parameter name=&quot;ChargeType&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="comment">            &lt;para&gt;Defines what kind of charge this message represents.&lt;/para&gt;</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="comment">               &lt;enum name=&quot;NA&quot; /&gt;</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">               &lt;enum name=&quot;FREE&quot; /&gt;</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">               &lt;enum name=&quot;Currency&quot; /&gt;</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">               &lt;enum name=&quot;Unit&quot; /&gt;</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">         &lt;parameter name=&quot;UnitAmount(0)&quot;&gt;</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">            &lt;para&gt;This represents the amount of units charged. The ETSI AOC standard specifies that</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">            this value along with the optional UnitType value are entries in a list.  To accommodate this</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">            these values take an index value starting at 0 which can be used to generate this list of</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">            unit entries.  For Example, If two unit entires were required this could be achieved by setting the</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">            paramter UnitAmount(0)=1234 and UnitAmount(1)=5678.  Note that UnitAmount at index 0 is</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">            required when ChargeType=Unit, all other entries in the list are optional.</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">            &lt;/para&gt;</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="comment">         &lt;parameter name=&quot;UnitType(0)&quot;&gt;</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="comment">            &lt;para&gt;Defines the type of unit.  ETSI AOC standard specifies this as an integer</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="comment">            value between 1 and 16, but this value is left open to accept any positive</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">            integer.  Like the UnitAmount parameter, this value represents a list entry</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="comment">            and has an index parameter that starts at 0.</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="comment">            &lt;/para&gt;</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">         &lt;parameter name=&quot;CurrencyName&quot;&gt;</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">            &lt;para&gt;Specifies the currency&#39;s name.  Note that this value is truncated after 10 characters.&lt;/para&gt;</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment">         &lt;parameter name=&quot;CurrencyAmount&quot;&gt;</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment">            &lt;para&gt;Specifies the charge unit amount as a positive integer.  This value is required</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">            when ChargeType==Currency.&lt;/para&gt;</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">         &lt;parameter name=&quot;CurrencyMultiplier&quot;&gt;</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment">            &lt;para&gt;Specifies the currency multiplier.  This value is required when ChargeType==Currency.&lt;/para&gt;</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="comment">               &lt;enum name=&quot;OneThousandth&quot; /&gt;</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">               &lt;enum name=&quot;OneHundredth&quot; /&gt;</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="comment">               &lt;enum name=&quot;OneTenth&quot; /&gt;</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="comment">               &lt;enum name=&quot;One&quot; /&gt;</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">               &lt;enum name=&quot;Ten&quot; /&gt;</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">               &lt;enum name=&quot;Hundred&quot; /&gt;</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">               &lt;enum name=&quot;Thousand&quot; /&gt;</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">         &lt;parameter name=&quot;TotalType&quot; default=&quot;Total&quot;&gt;</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">            &lt;para&gt;Defines what kind of AOC-D total is represented.&lt;/para&gt;</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">               &lt;enum name=&quot;Total&quot; /&gt;</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">               &lt;enum name=&quot;SubTotal&quot; /&gt;</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">         &lt;parameter name=&quot;AOCBillingId&quot;&gt;</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">            &lt;para&gt;Represents a billing ID associated with an AOC-D or AOC-E message. Note</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">            that only the first 3 items of the enum are valid AOC-D billing IDs&lt;/para&gt;</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">               &lt;enum name=&quot;Normal&quot; /&gt;</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">               &lt;enum name=&quot;ReverseCharge&quot; /&gt;</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="comment">               &lt;enum name=&quot;CreditCard&quot; /&gt;</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">               &lt;enum name=&quot;CallFwdUnconditional&quot; /&gt;</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">               &lt;enum name=&quot;CallFwdBusy&quot; /&gt;</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">               &lt;enum name=&quot;CallFwdNoReply&quot; /&gt;</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">               &lt;enum name=&quot;CallDeflection&quot; /&gt;</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">               &lt;enum name=&quot;CallTransfer&quot; /&gt;</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">         &lt;parameter name=&quot;ChargingAssociationId&quot;&gt;</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">            &lt;para&gt;Charging association identifier.  This is optional for AOC-E and can be</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">            set to any value between -32768 and 32767&lt;/para&gt;</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">         &lt;parameter name=&quot;ChargingAssociationNumber&quot;&gt;</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">            &lt;para&gt;Represents the charging association party number.  This value is optional</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">            for AOC-E.&lt;/para&gt;</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">         &lt;parameter name=&quot;ChargingAssociationPlan&quot;&gt;</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">            &lt;para&gt;Integer representing the charging plan associated with the ChargingAssociationNumber.</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">            The value is bits 7 through 1 of the Q.931 octet containing the type-of-number and</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">            numbering-plan-identification fields.&lt;/para&gt;</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">         &lt;para&gt;Generates an AOC-D or AOC-E message on a channel.&lt;/para&gt;</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;AOC-D&lt;/ref&gt;</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;AOC-E&lt;/ref&gt;</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">   &lt;function name=&quot;AMI_CLIENT&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">         Checks attributes of manager accounts</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">         &lt;parameter name=&quot;loginname&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">            &lt;para&gt;Login name, specified in manager.conf&lt;/para&gt;</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="comment">         &lt;parameter name=&quot;field&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="comment">            &lt;para&gt;The manager account attribute to return&lt;/para&gt;</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">               &lt;enum name=&quot;sessions&quot;&gt;&lt;para&gt;The number of sessions for this AMI account&lt;/para&gt;&lt;/enum&gt;</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="comment">         &lt;para&gt;</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="comment">            Currently, the only supported  parameter is &quot;sessions&quot; which will return the current number of</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">            active sessions for this AMI account.</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="comment">         &lt;/para&gt;</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">   &lt;/function&gt;</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="comment">   &lt;manager name=&quot;Filter&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">         Dynamically add filters for the current manager session.</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment">         &lt;xi:include xpointer=&quot;xpointer(/docs/manager[@name=&#39;Login&#39;]/syntax/parameter[@name=&#39;ActionID&#39;])&quot; /&gt;</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment">         &lt;parameter name=&quot;Operation&quot;&gt;</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">            &lt;enumlist&gt;</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">               &lt;enum name=&quot;Add&quot;&gt;</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">                  &lt;para&gt;Add a filter.&lt;/para&gt;</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">               &lt;/enum&gt;</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">            &lt;/enumlist&gt;</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">         &lt;parameter name=&quot;Filter&quot;&gt;</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">            &lt;para&gt;Filters can be whitelist or blacklist&lt;/para&gt;</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">            &lt;para&gt;Example whitelist filter: &quot;Event: Newchannel&quot;&lt;/para&gt;</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">            &lt;para&gt;Example blacklist filter: &quot;!Channel: DAHDI.*&quot;&lt;/para&gt;</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">            &lt;para&gt;This filter option is used to whitelist or blacklist events per user to be</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">            reported with regular expressions and are allowed if both the regex matches</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">            and the user has read access as defined in manager.conf. Filters are assumed to be for whitelisting</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">            unless preceeded by an exclamation point, which marks it as being black.</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">            Evaluation of the filters is as follows:&lt;/para&gt;</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">            &lt;para&gt;- If no filters are configured all events are reported as normal.&lt;/para&gt;</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">            &lt;para&gt;- If there are white filters only: implied black all filter processed first, then white filters.&lt;/para&gt;</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">            &lt;para&gt;- If there are black filters only: implied white all filter processed first, then black filters.&lt;/para&gt;</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">            &lt;para&gt;- If there are both white and black filters: implied black all filter processed first, then white</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">            filters, and lastly black filters.&lt;/para&gt;</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">         &lt;para&gt;The filters added are only used for the current session.</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">         Once the connection is closed the filters are removed.&lt;/para&gt;</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">         &lt;para&gt;This comand requires the system permission because</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">         this command can be used to create filters that may bypass</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">         filters defined in manager.conf&lt;/para&gt;</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;FilterList&lt;/ref&gt;</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">   &lt;manager name=&quot;FilterList&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">         Show current event filters for this session</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">         &lt;para&gt;The filters displayed are for the current session.  Only those filters defined in</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">                        manager.conf will be present upon starting a new session.&lt;/para&gt;</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;Filter&lt;/ref&gt;</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">   &lt;manager name=&quot;BlindTransfer&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">      &lt;synopsis&gt;</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">         Blind transfer channel(s) to the given destination</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">      &lt;/synopsis&gt;</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">      &lt;syntax&gt;</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">         &lt;parameter name=&quot;Channel&quot; required=&quot;true&quot;&gt;</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">         &lt;parameter name=&quot;Context&quot;&gt;</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">         &lt;parameter name=&quot;Exten&quot;&gt;</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">         &lt;/parameter&gt;</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">      &lt;/syntax&gt;</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">      &lt;description&gt;</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">         &lt;para&gt;Redirect all channels currently bridged to the specified channel to the specified destination.&lt;/para&gt;</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">      &lt;/description&gt;</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">      &lt;see-also&gt;</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">         &lt;ref type=&quot;manager&quot;&gt;Redirect&lt;/ref&gt;</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">         &lt;ref type=&quot;managerEvent&quot;&gt;BlindTransfer&lt;/ref&gt;</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">      &lt;/see-also&gt;</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">   &lt;/manager&gt;</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">   &lt;managerEvent name=&quot;ExtensionStatus&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_CALL&quot;&gt;</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a hint changes due to a device state change.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">            &lt;parameter name=&quot;Exten&quot;&gt;</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">               &lt;para&gt;Name of the extension.&lt;/para&gt;</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">            &lt;parameter name=&quot;Context&quot;&gt;</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">               &lt;para&gt;Context that owns the extension.&lt;/para&gt;</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">            &lt;parameter name=&quot;Hint&quot;&gt;</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">               &lt;para&gt;Hint set for the extension&lt;/para&gt;</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">            &lt;parameter name=&quot;Status&quot;&gt;</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">               &lt;para&gt;Numerical value of the extension status. Extension</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">               status is determined by the combined device state of all items</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">               contained in the hint.&lt;/para&gt;</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">                  &lt;enum name=&quot;-2&quot;&gt;</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">                     &lt;para&gt;The extension was removed from the dialplan.&lt;/para&gt;</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">                  &lt;enum name=&quot;-1&quot;&gt;</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">                     &lt;para&gt;The extension&#39;s hint was removed from the dialplan.&lt;/para&gt;</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">                  &lt;enum name=&quot;0&quot;&gt;</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;Idle&lt;/literal&gt; - Related device(s) are in an idle</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment">                     state.&lt;/para&gt;</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">                  &lt;enum name=&quot;1&quot;&gt;</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;InUse&lt;/literal&gt; - Related device(s) are in active</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">                     calls but may take more calls.&lt;/para&gt;</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">                  &lt;enum name=&quot;2&quot;&gt;</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;Busy&lt;/literal&gt; - Related device(s) are in active</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">                     calls and may not take any more calls.&lt;/para&gt;</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">                  &lt;enum name=&quot;4&quot;&gt;</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;Unavailable&lt;/literal&gt; - Related device(s) are</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">                     not reachable.&lt;/para&gt;</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">                  &lt;enum name=&quot;8&quot;&gt;</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;Ringing&lt;/literal&gt; - Related device(s) are</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">                     currently ringing.&lt;/para&gt;</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">                  &lt;enum name=&quot;9&quot;&gt;</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;InUse&amp;amp;Ringing&lt;/literal&gt; - Related device(s)</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">                     are currently ringing and in active calls.&lt;/para&gt;</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment">                  &lt;enum name=&quot;16&quot;&gt;</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;Hold&lt;/literal&gt; - Related device(s) are</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">                     currently on hold.&lt;/para&gt;</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">                  &lt;enum name=&quot;17&quot;&gt;</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">                     &lt;para&gt;&lt;literal&gt;InUse&amp;amp;Hold&lt;/literal&gt; - Related device(s)</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">                     are currently on hold and in active calls.&lt;/para&gt;</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">            &lt;parameter name=&quot;StatusText&quot;&gt;</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">               &lt;para&gt;Text representation of &lt;literal&gt;Status&lt;/literal&gt;.&lt;/para&gt;</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">               &lt;enumlist&gt;</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">                  &lt;enum name=&quot;Idle&quot; /&gt;</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">                  &lt;enum name=&quot;InUse&quot; /&gt;</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">                  &lt;enum name=&quot;Busy&quot; /&gt;</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">                  &lt;enum name=&quot;Unavailable&quot; /&gt;</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">                  &lt;enum name=&quot;Ringing&quot; /&gt;</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">                  &lt;enum name=&quot;InUse&amp;amp;Ringing&quot; /&gt;</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">                  &lt;enum name=&quot;Hold&quot; /&gt;</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">                  &lt;enum name=&quot;InUse&amp;amp;Hold&quot; /&gt;</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">                  &lt;enum name=&quot;Unknown&quot;&gt;</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="comment">                     &lt;para&gt;Status does not match any of the above values.&lt;/para&gt;</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="comment">                  &lt;/enum&gt;</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">               &lt;/enumlist&gt;</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">            &lt;/parameter&gt;</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;ExtensionState&lt;/ref&gt;</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">   &lt;managerEvent name=&quot;PresenceStatus&quot; language=&quot;en_US&quot;&gt;</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">      &lt;managerEventInstance class=&quot;EVENT_FLAG_CALL&quot;&gt;</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">         &lt;synopsis&gt;Raised when a hint changes due to a presence state change.&lt;/synopsis&gt;</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">         &lt;syntax&gt;</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">            &lt;parameter name=&quot;Exten&quot; /&gt;</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">            &lt;parameter name=&quot;Context&quot; /&gt;</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">            &lt;parameter name=&quot;Hint&quot; /&gt;</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">            &lt;parameter name=&quot;Status&quot; /&gt;</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">            &lt;parameter name=&quot;Subtype&quot; /&gt;</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">            &lt;parameter name=&quot;Message&quot; /&gt;</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">         &lt;/syntax&gt;</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">         &lt;see-also&gt;</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="comment">            &lt;ref type=&quot;manager&quot;&gt;PresenceState&lt;/ref&gt;</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">         &lt;/see-also&gt;</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">      &lt;/managerEventInstance&gt;</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">   &lt;/managerEvent&gt;</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment"> ***/</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">/*! \addtogroup Group_AMI AMI functions</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">*/</span><span class="comment"></span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">/*! @{</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment"> Doxygen group */</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div><div class="line"><a name="l01419"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92"> 1419</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92">error_type</a> {</div><div class="line"><a name="l01420"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ae16d79bf07a3994731f4ac1a6ece5ec8"> 1420</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ae16d79bf07a3994731f4ac1a6ece5ec8">UNKNOWN_ACTION</a> = 1,</div><div class="line"><a name="l01421"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935"> 1421</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>,</div><div class="line"><a name="l01422"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac327a21855ab9428a0a4ec3b2bc9e4da"> 1422</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac327a21855ab9428a0a4ec3b2bc9e4da">UNSPECIFIED_CATEGORY</a>,</div><div class="line"><a name="l01423"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e"> 1423</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>,</div><div class="line"><a name="l01424"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec"> 1424</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a>,</div><div class="line"><a name="l01425"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9"> 1425</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9">FAILURE_NEWCAT</a>,</div><div class="line"><a name="l01426"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92aa8e1a46fc31ba23e18080284f3938d75"> 1426</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92aa8e1a46fc31ba23e18080284f3938d75">FAILURE_DELCAT</a>,</div><div class="line"><a name="l01427"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a468f85e937d9a9d14172b0239d212125"> 1427</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a468f85e937d9a9d14172b0239d212125">FAILURE_EMPTYCAT</a>,</div><div class="line"><a name="l01428"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9"> 1428</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9">FAILURE_UPDATE</a>,</div><div class="line"><a name="l01429"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a873b7dc80f148550a62038a0f860f31d"> 1429</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a873b7dc80f148550a62038a0f860f31d">FAILURE_DELETE</a>,</div><div class="line"><a name="l01430"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a97ea9672929721f6b45f60f058465bd9"> 1430</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a97ea9672929721f6b45f60f058465bd9">FAILURE_APPEND</a>,</div><div class="line"><a name="l01431"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac22fdd80fd7df09af8999f6e429e29fb"> 1431</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac22fdd80fd7df09af8999f6e429e29fb">FAILURE_TEMPLATE</a></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;};</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga8d9eefd35c6b7be4f64a4b4dc9d92fd8"> 1434</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga8d9eefd35c6b7be4f64a4b4dc9d92fd8">add_filter_result</a> {</div><div class="line"><a name="l01435"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a11037e5e5ecf59d690cb6db101376995"> 1435</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a11037e5e5ecf59d690cb6db101376995">FILTER_SUCCESS</a>,</div><div class="line"><a name="l01436"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8ae465b39e083c5cc742896c9941dc5a6f"> 1436</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8ae465b39e083c5cc742896c9941dc5a6f">FILTER_ALLOC_FAILED</a>,</div><div class="line"><a name="l01437"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a49c6dd43bada70d0caac95894f037660"> 1437</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a49c6dd43bada70d0caac95894f037660">FILTER_COMPILE_FAIL</a>,</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;};</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment"> * Linked list of events.</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment"> * Global events are appended to the list by append_event().</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment"> * The usecount is the number of stored pointers to the element,</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="comment"> * excluding the list pointers. So an element that is only in</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="comment"> * the list has a usecount of 0, not 1.</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="comment"> * Clients have a pointer to the last event processed, and for each</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment"> * of these clients we track the usecount of the elements.</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment"> * If we have a pointer to an entry in the list, it is safe to navigate</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="comment"> * it forward because elements will not be deleted, but only appended.</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment"> * The worst that can happen is seeing the pointer still NULL.</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment"> * When the usecount of an element drops to 0, and the element is the</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment"> * first in the list, we can remove it. Removal is done within the</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment"> * main thread, which is woken up for the purpose.</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment"> * For simplicity of implementation, we make sure the list is never empty.</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01459"></a><span class="lineno"><a class="line" href="../../d9/d94/structeventqent.html"> 1459</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> {</div><div class="line"><a name="l01460"></a><span class="lineno"><a class="line" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b"> 1460</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a>;     <span class="comment">/*!&lt; # of clients who still need the event */</span></div><div class="line"><a name="l01461"></a><span class="lineno"><a class="line" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1"> 1461</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>;</div><div class="line"><a name="l01462"></a><span class="lineno"><a class="line" href="../../d9/d94/structeventqent.html#a1db4845df10d789835dcc97c392a2fe6"> 1462</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a1db4845df10d789835dcc97c392a2fe6">seq</a>; <span class="comment">/*!&lt; sequence number */</span></div><div class="line"><a name="l01463"></a><span class="lineno"><a class="line" href="../../d9/d94/structeventqent.html#a9cf96982557d56650f0f4cd3762f05a0"> 1463</a></span>&#160;   <span class="keyword">struct </span>timeval <a class="code" href="../../d9/d94/structeventqent.html#a9cf96982557d56650f0f4cd3762f05a0">tv</a>;  <span class="comment">/*!&lt; When event was allocated */</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ac63e9e237da22b6faf3be4edfc4f5a11">AST_RWLIST_ENTRY</a>(<a class="code" href="../../d9/d94/structeventqent.html">eventqent</a>) eq_next;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;   <span class="keywordtype">char</span> eventdata[1];   <span class="comment">/*!&lt; really variable size, allocated by append_event() */</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;};</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"><a class="line" href="../../d2/d3e/structall__events.html#ace4e0066a5b24f84b90536e9906619f6"> 1468</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d90/linkedlists_8h.html#a39918fd433ac42184b152c86016ef139">AST_RWLIST_HEAD_STATIC</a>(<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>, <a class="code" href="../../d9/d94/structeventqent.html">eventqent</a>);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5"> 1470</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = 1;</div><div class="line"><a name="l01471"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87"> 1471</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = 1;</div><div class="line"><a name="l01472"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab"> 1472</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab">timestampevents</a>;</div><div class="line"><a name="l01473"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba"> 1473</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> = 60;</div><div class="line"><a name="l01474"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab362ced8cd2bc839a9a1782ae31a9166"> 1474</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab362ced8cd2bc839a9a1782ae31a9166">broken_events_action</a> = 0;</div><div class="line"><a name="l01475"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247"> 1475</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> = 0;</div><div class="line"><a name="l01476"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab96bdf674e2ebee782bfde795f93062e"> 1476</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab96bdf674e2ebee782bfde795f93062e">subscribed</a> = 0;</div><div class="line"><a name="l01477"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd"> 1477</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a> = 0;</div><div class="line"><a name="l01478"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9"> 1478</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a> = 0; <span class="comment">/*!&lt; enable some debugging code in the manager */</span></div><div class="line"><a name="l01479"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87"> 1479</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a>;</div><div class="line"><a name="l01480"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga8f05cdf013e1e5fe03ea2615e681bf58"> 1480</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga8f05cdf013e1e5fe03ea2615e681bf58">authlimit</a>;</div><div class="line"><a name="l01481"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e"> 1481</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e">manager_channelvars</a>;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9c6c0e75254e2641e579bba0068626de"> 1483</a></span>&#160;<span class="preprocessor">#define DEFAULT_REALM      &quot;asterisk&quot;</span></div><div class="line"><a name="l01484"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa6da807cb7fb332127a4896dd423ed6d"> 1484</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa6da807cb7fb332127a4896dd423ed6d">global_realm</a>[<a class="code" href="../../d9/d94/network_8h.html#afd80ecbe3170ca4fc85b65cda8659f82">MAXHOSTNAMELEN</a>]; <span class="comment">/*!&lt; Default realm */</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div><div class="line"><a name="l01486"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f"> 1486</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a> = 0;</div><div class="line"><a name="l01487"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga322eb26fcd507fe69297e038d584db02"> 1487</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga322eb26fcd507fe69297e038d584db02">acl_change_sub</a>;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">/*! \brief A \ref stasis_topic that all topics AMI cares about will be forwarded to */</span></div><div class="line"><a name="l01490"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gadeff73697d2789905f4c3a21671ef6d3"> 1490</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#gadeff73697d2789905f4c3a21671ef6d3">manager_topic</a>;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">/*! \brief The \ref stasis_message_router for all \ref stasis messages */</span></div><div class="line"><a name="l01493"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga6d6d7bdd31cb1b6f84f2e447a7a2c6c2"> 1493</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga6d6d7bdd31cb1b6f84f2e447a7a2c6c2">stasis_router</a>;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">/*! \brief The \ref stasis_subscription for forwarding the RTP topic to the AMI topic */</span></div><div class="line"><a name="l01496"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga8f085d5905794e05f39eb6056fcba447"> 1496</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga8f085d5905794e05f39eb6056fcba447">rtp_topic_forwarder</a>;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">/*! \brief The \ref stasis_subscription for forwarding the Security topic to the AMI topic */</span></div><div class="line"><a name="l01499"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga97a54a9ee7d7446e6be8a9371fcd2a19"> 1499</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga97a54a9ee7d7446e6be8a9371fcd2a19">security_topic_forwarder</a>;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">/*! \brief The \ref stasis_subscription for forwarding the Test topic to the AMI topic */</span></div><div class="line"><a name="l01503"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga6833175e09cefe8b9dfaa5ead96fb7b6"> 1503</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d54/structstasis__forward.html">stasis_forward</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga6833175e09cefe8b9dfaa5ead96fb7b6">test_suite_forwarder</a>;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5d7004574318e8b76738d6a158a447a9"> 1506</a></span>&#160;<span class="preprocessor">#define MGR_SHOW_TERMINAL_WIDTH 80</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5c707deff4e68c7283f2ed73665e0c77"> 1508</a></span>&#160;<span class="preprocessor">#define MAX_VARS 128</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">/*! \brief Fake event class used to end sessions at shutdown */</span></div><div class="line"><a name="l01511"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac6a246405a298682d5f34f8856b68461"> 1511</a></span>&#160;<span class="preprocessor">#define EVENT_FLAG_SHUTDOWN -1</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">/*! \brief</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment"> * Descriptor for a manager session, either on the AMI socket or over HTTP.</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment"> * \note</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment"> * AMI session have managerid == 0; the entry is created upon a connect,</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment"> * and destroyed with the socket.</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment"> * HTTP sessions have managerid != 0, the value is used as a search key</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment"> * to lookup sessions (using the mansession_id cookie, or nonce key from</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment"> * Digest Authentication http header).</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01523"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaacec20eeac5fcdb47de6e5f98bab33df"> 1523</a></span>&#160;<span class="preprocessor">#define MAX_BLACKLIST_CMD_LEN 2</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>{</div><div class="line"><a name="l01525"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a2c50d07b002a16d9ddfa6eb70ac5f977"> 1525</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d10/manager_8c.html#a2c50d07b002a16d9ddfa6eb70ac5f977">words</a>[<a class="code" href="../../dc/db0/cli_8h.html#ae88634c402fdd8b46fd5d686dad8bfb9">AST_MAX_CMD_LEN</a>];</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;} <a class="code" href="../../df/d72/group__Group__AMI.html#gaae263799a76e54f46b173f039ee1053d">command_blacklist</a>[] = {</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;   {{ <span class="stringliteral">&quot;module&quot;</span>, <span class="stringliteral">&quot;load&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> }},</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;   {{ <span class="stringliteral">&quot;module&quot;</span>, <span class="stringliteral">&quot;unload&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> }},</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;   {{ <span class="stringliteral">&quot;restart&quot;</span>, <span class="stringliteral">&quot;gracefully&quot;</span>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> }},</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;};</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaf4adfeec3f6af24e2ede7e730bee32eb">acl_change_stasis_cb</a>(<span class="keywordtype">void</span> *data, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *<a class="code" href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a>, <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *<a class="code" href="../../d8/d9e/structmessage.html">message</a>);</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div><div class="line"><a name="l01534"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga12e82c44fa806bdf33e7e4d92c04f707"> 1534</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga12e82c44fa806bdf33e7e4d92c04f707">acl_change_stasis_subscribe</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;{</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;   <span class="keywordflow">if</span> (!acl_change_sub) {</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      acl_change_sub = <a class="code" href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a>(<a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a>(),</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gaf4adfeec3f6af24e2ede7e730bee32eb">acl_change_stasis_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a>(acl_change_sub, <a class="code" href="../../d5/d59/acl_8h.html#a1d3de55deab4206400a7df534511fcf7">ast_named_acl_change_type</a>());</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <a class="code" href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a>(acl_change_sub, <a class="code" href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a>);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;   }</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;}</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga7c363bd89e1d8a7c36513fa83f3d08af"> 1544</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c363bd89e1d8a7c36513fa83f3d08af">acl_change_stasis_unsubscribe</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;{</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;   acl_change_sub = <a class="code" href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a>(acl_change_sub);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;}</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">/* In order to understand what the heck is going on with the</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment"> * mansession_session and mansession structs, we need to have a bit of a history</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment"> * lesson.</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment"> * In the beginning, there was the mansession. The mansession contained data that was</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment"> * intrinsic to a manager session, such as the time that it started, the name of the logged-in</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment"> * user, etc. In addition to these parameters were the f and fd parameters. For typical manager</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment"> * sessions, these were used to represent the TCP socket over which the AMI session was taking</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment"> * place. It makes perfect sense for these fields to be a part of the session-specific data since</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment"> * the session actually defines this information.</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment"> * Then came the HTTP AMI sessions. With these, the f and fd fields need to be opened and closed</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment"> * for every single action that occurs. Thus the f and fd fields aren&#39;t really specific to the session</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment"> * but rather to the action that is being executed. Because a single session may execute many commands</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment"> * at once, some sort of safety needed to be added in order to be sure that we did not end up with fd</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment"> * leaks from one action overwriting the f and fd fields used by a previous action before the previous action</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment"> * has had a chance to properly close its handles.</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment"> * The initial idea to solve this was to use thread synchronization, but this prevented multiple actions</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment"> * from being run at the same time in a single session. Some manager actions may block for a long time, thus</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"> * creating a large queue of actions to execute. In addition, this fix did not address the basic architectural</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment"> * issue that for HTTP manager sessions, the f and fd variables are not really a part of the session, but are</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment"> * part of the action instead.</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="comment"> * The new idea was to create a structure on the stack for each HTTP Manager action. This structure would</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment"> * contain the action-specific information, such as which file to write to. In order to maintain expectations</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment"> * of action handlers and not have to change the public API of the manager code, we would need to name this</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment"> * new stacked structure &#39;mansession&#39; and contain within it the old mansession struct that we used to use.</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment"> * We renamed the old mansession struct &#39;mansession_session&#39; to hopefully convey that what is in this structure</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="comment"> * is session-specific data. The structure that it is wrapped in, called a &#39;mansession&#39; really contains action-specific</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="comment"> * data.</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01581"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html"> 1581</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> {<span class="comment"></span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">            /*! \todo XXX need to document which fields it is protecting */</span></div><div class="line"><a name="l01583"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379"> 1583</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> addr;  <span class="comment">/*!&lt; address we are connecting from */</span></div><div class="line"><a name="l01584"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5"> 1584</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d03/structast__iostream.html">ast_iostream</a> *<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>;  <span class="comment">/*!&lt; AMI stream */</span></div><div class="line"><a name="l01585"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834"> 1585</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>;     <span class="comment">/*!&lt; number of HTTP sessions using this entry */</span></div><div class="line"><a name="l01586"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f"> 1586</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a>;  <span class="comment">/*!&lt; Whether an HTTP session should be destroyed */</span></div><div class="line"><a name="l01587"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e"> 1587</a></span>&#160;   pthread_t <a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a>;  <span class="comment">/*!&lt; Sleeping thread using this descriptor */</span></div><div class="line"><a name="l01588"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e"> 1588</a></span>&#160;   uint32_t <a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a>;  <span class="comment">/*!&lt; Unique manager identifier, 0 for AMI sessions */</span></div><div class="line"><a name="l01589"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a6886313a6b114cbcf7cb60676533c405"> 1589</a></span>&#160;   time_t <a class="code" href="../../df/d05/structmansession__session.html#a6886313a6b114cbcf7cb60676533c405">sessionstart</a>;    <span class="comment">/*!&lt; Session start time */</span></div><div class="line"><a name="l01590"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534"> 1590</a></span>&#160;   <span class="keyword">struct </span>timeval sessionstart_tv; <span class="comment">/*!&lt; Session start time */</span></div><div class="line"><a name="l01591"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee"> 1591</a></span>&#160;   time_t <a class="code" href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">sessiontimeout</a>;  <span class="comment">/*!&lt; Session timeout if HTTP */</span></div><div class="line"><a name="l01592"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c"> 1592</a></span>&#160;   <span class="keywordtype">char</span> username[80];   <span class="comment">/*!&lt; Logged in username */</span></div><div class="line"><a name="l01593"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51"> 1593</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad920f57db5e8c4e82e415be692af48a8">challenge</a>[10];  <span class="comment">/*!&lt; Authentication challenge */</span></div><div class="line"><a name="l01594"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095"> 1594</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>;   <span class="comment">/*!&lt; Authentication status */</span></div><div class="line"><a name="l01595"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4"> 1595</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a>;     <span class="comment">/*!&lt; Authorization for reading */</span></div><div class="line"><a name="l01596"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f"> 1596</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>;    <span class="comment">/*!&lt; Authorization for writing */</span></div><div class="line"><a name="l01597"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#ac56f44f8863e74f246f657bdcf7bdcd1"> 1597</a></span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dc/df4/app__voicemail_8c.html#ac70fbae4ed48b5b48ff4b49f01e29f86">inbuf</a>[1025]; <span class="comment">/*!&lt; Buffer -  we use the extra byte to add a &#39;\\0&#39; and simplify parsing */</span></div><div class="line"><a name="l01598"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6"> 1598</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a>;     <span class="comment">/*!&lt; number of buffered bytes */</span></div><div class="line"><a name="l01599"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a"> 1599</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>; <span class="comment">/*!&lt; Manager event filters - white list */</span></div><div class="line"><a name="l01600"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133"> 1600</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>; <span class="comment">/*!&lt; Manager event filters - black list */</span></div><div class="line"><a name="l01601"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c"> 1601</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>;  <span class="comment">/*!&lt; Channel variables to set for originate */</span></div><div class="line"><a name="l01602"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449"> 1602</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a>;  <span class="comment">/*!&lt;  XXX what ? */</span></div><div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3"> 1603</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a>; <span class="comment">/*!&lt; last event processed. */</span></div><div class="line"><a name="l01604"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a67c9d5e7f3b13cfc7fe3b4e395c81443"> 1604</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a>; <span class="comment">/*!&lt; Timeout for ast_carefulwrite() */</span></div><div class="line"><a name="l01605"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a6bafd2f5dfdc170245b389db21bd81f8"> 1605</a></span>&#160;   time_t <a class="code" href="../../df/d05/structmansession__session.html#a6bafd2f5dfdc170245b389db21bd81f8">authstart</a>;</div><div class="line"><a name="l01606"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a77d36f7d3efdab912ada2ef54a75cc65"> 1606</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a77d36f7d3efdab912ada2ef54a75cc65">pending_event</a>;         <span class="comment">/*!&lt; Pending events indicator in case when waiting_thread is NULL */</span></div><div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a7782a214e6947ec252279744b2b13484"> 1607</a></span>&#160;   time_t <a class="code" href="../../df/d05/structmansession__session.html#a7782a214e6947ec252279744b2b13484">noncetime</a>; <span class="comment">/*!&lt; Timer for nonce value expiration */</span></div><div class="line"><a name="l01608"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a69130d68427d2c01991cac28b2f20ac3"> 1608</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../df/d05/structmansession__session.html#a69130d68427d2c01991cac28b2f20ac3">oldnonce</a>; <span class="comment">/*!&lt; Stale nonce value */</span></div><div class="line"><a name="l01609"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a805140f5455ca9a45685d306eb9f8834"> 1609</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="../../df/d05/structmansession__session.html#a805140f5455ca9a45685d306eb9f8834">nc</a>; <span class="comment">/*!&lt; incremental  nonce counter */</span></div><div class="line"><a name="l01610"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269"> 1610</a></span>&#160;   <a class="code" href="../../d8/dc5/structast__mutex__info.html">ast_mutex_t</a> <a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>; <span class="comment">/*!&lt; Lock for notifying this session of events */</span></div><div class="line"><a name="l01611"></a><span class="lineno"><a class="line" href="../../d4/d88/structmansession__session_1_1mansession__datastores.html#a2e70e0f0b9c6ddd857e9225ba5d34de3"> 1611</a></span>&#160;   <a class="code" href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a>(<a class="code" href="../../d4/d88/structmansession__session_1_1mansession__datastores.html">mansession_datastores</a>, <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a>) datastores; <span class="comment">/*!&lt; Data stores on the session */</span></div><div class="line"><a name="l01612"></a><span class="lineno"><a class="line" href="../../df/d05/structmansession__session.html#a3e169d95e9105d8f4b92c23d2280db83"> 1612</a></span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a>(<a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a>) list;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;};</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div><div class="line"><a name="l01615"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gae9440b5a8f6a5fb7e1667674b1507344"> 1615</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gae9440b5a8f6a5fb7e1667674b1507344">mansession_message_parsing</a> {</div><div class="line"><a name="l01616"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344a4062487b032b9348705c5ff65d21d777"> 1616</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344a4062487b032b9348705c5ff65d21d777">MESSAGE_OKAY</a>,</div><div class="line"><a name="l01617"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344af59be521b8f1a6985f831b7b850a8fc9"> 1617</a></span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344af59be521b8f1a6985f831b7b850a8fc9">MESSAGE_LINE_TOO_LONG</a></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;};</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">/*! \brief In case you didn&#39;t read that giant block of text above the mansession_session struct, the</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment"> * \ref struct mansession is named this solely to keep the API the same in Asterisk. This structure really</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment"> * represents data that is different from Manager action to Manager action. The mansession_session pointer</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment"> * contained within points to session-specific data.</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01625"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html"> 1625</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/d8a/structmansession.html">mansession</a> {</div><div class="line"><a name="l01626"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d"> 1626</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>;</div><div class="line"><a name="l01627"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5"> 1627</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d03/structast__iostream.html">ast_iostream</a> *<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>;</div><div class="line"><a name="l01628"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6"> 1628</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>;</div><div class="line"><a name="l01629"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html#ab91b0fdf6f7223e7889b0bafe6c81639"> 1629</a></span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gae9440b5a8f6a5fb7e1667674b1507344">mansession_message_parsing</a> <a class="code" href="../../d1/d6d/chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a">parsing</a>;</div><div class="line"><a name="l01630"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html#a4905d9704cb1eb3ff285e4fb8aa9c68d"> 1630</a></span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/d8a/structmansession.html#a4905d9704cb1eb3ff285e4fb8aa9c68d">write_error</a>:1;</div><div class="line"><a name="l01631"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe"> 1631</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d10/structmanager__custom__hook.html">manager_custom_hook</a> *<a class="code" href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe">hook</a>;</div><div class="line"><a name="l01632"></a><span class="lineno"><a class="line" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902"> 1632</a></span>&#160;   <a class="code" href="../../d8/dc5/structast__mutex__info.html">ast_mutex_t</a> <a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;};</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="comment">/*! Active manager connection sessions container. */</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga20256749d9d7e9dd367c6470336eb041">AO2_GLOBAL_OBJ_STATIC</a>(mgr_sessions);</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">/*! \brief user descriptor, as read from the config file.</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment"> * \note It is still missing some fields -- e.g. we can have multiple permit and deny</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment"> * lines which are not supported here, and readperm/writeperm/writetimeout</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment"> * are not stored.</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01644"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html"> 1644</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> {</div><div class="line"><a name="l01645"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c"> 1645</a></span>&#160;   <span class="keywordtype">char</span> username[80];</div><div class="line"><a name="l01646"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82"> 1646</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>;        <span class="comment">/*!&lt; Secret for logging in */</span></div><div class="line"><a name="l01647"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4"> 1647</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a>;        <span class="comment">/*!&lt; Authorization for reading */</span></div><div class="line"><a name="l01648"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f"> 1648</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>;       <span class="comment">/*!&lt; Authorization for writing */</span></div><div class="line"><a name="l01649"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443"> 1649</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a>;    <span class="comment">/*!&lt; Per user Timeout for ast_carefulwrite() */</span></div><div class="line"><a name="l01650"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5"> 1650</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>;    <span class="comment">/*!&lt; XXX unused */</span></div><div class="line"><a name="l01651"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87"> 1651</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a>; <span class="comment">/*!&lt; Per user option*/</span></div><div class="line"><a name="l01652"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42"> 1652</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a>;         <span class="comment">/*!&lt; mark entries created on a reload */</span></div><div class="line"><a name="l01653"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a"> 1653</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>; <span class="comment">/*!&lt; Manager event filters - white list */</span></div><div class="line"><a name="l01654"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133"> 1654</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>; <span class="comment">/*!&lt; Manager event filters - black list */</span></div><div class="line"><a name="l01655"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c"> 1655</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/da4/structast__acl__list.html">ast_acl_list</a> *<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>;       <span class="comment">/*!&lt; ACL setting */</span></div><div class="line"><a name="l01656"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a"> 1656</a></span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a">a1_hash</a>;       <span class="comment">/*!&lt; precalculated A1 for Digest auth */</span></div><div class="line"><a name="l01657"></a><span class="lineno"><a class="line" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c"> 1657</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>;  <span class="comment">/*!&lt; Channel variables to set for originate */</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#ac63e9e237da22b6faf3be4edfc4f5a11">AST_RWLIST_ENTRY</a>(<a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a>) list;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;};</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">/*! \brief list of users found in the config file */</span></div><div class="line"><a name="l01662"></a><span class="lineno"><a class="line" href="../../d8/d63/structusers.html#ace4e0066a5b24f84b90536e9906619f6"> 1662</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d90/linkedlists_8h.html#a39918fd433ac42184b152c86016ef139">AST_RWLIST_HEAD_STATIC</a>(<a class="code" href="../../d8/d63/structusers.html">users</a>, <a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a>);</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">/*! \brief list of actions registered */</span></div><div class="line"><a name="l01665"></a><span class="lineno"><a class="line" href="../../dc/de8/structactions.html#ace4e0066a5b24f84b90536e9906619f6"> 1665</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d90/linkedlists_8h.html#a39918fd433ac42184b152c86016ef139">AST_RWLIST_HEAD_STATIC</a>(<a class="code" href="../../dc/de8/structactions.html">actions</a>, <a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a>);</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment">/*! \brief list of hooks registered */</span></div><div class="line"><a name="l01668"></a><span class="lineno"><a class="line" href="../../d5/d26/structmanager__hooks.html#ace4e0066a5b24f84b90536e9906619f6"> 1668</a></span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d90/linkedlists_8h.html#a39918fd433ac42184b152c86016ef139">AST_RWLIST_HEAD_STATIC</a>(<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>, <a class="code" href="../../d0/d10/structmanager__custom__hook.html">manager_custom_hook</a>);</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment">/*! \brief A container of event documentation nodes */</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="keyword">static</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga20256749d9d7e9dd367c6470336eb041">AO2_GLOBAL_OBJ_STATIC</a>(event_docs);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> __attribute__((<a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>(printf, 9, 0))) <a class="code" href="../../df/d72/group__Group__AMI.html#ga129789bbb3008b50ad8c848f4a70eb52">__manager_event_sessions</a>(</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;   struct <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d3/d0a/structsessions.html">sessions</a>,</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>,</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;   const <span class="keywordtype">char</span> *<a class="code" href="../../df/d7d/structevent.html">event</a>,</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d28/channel_8c.html#a5cb129ce1d580dbb22ec9573dcb62f7f">chancount</a>,</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;   struct <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> **<a class="code" href="../../d6/d75/structchans.html">chans</a>,</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;   const <span class="keywordtype">char</span> *<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>,</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   <span class="keywordtype">int</span> line,</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;   const <span class="keywordtype">char</span> *func,</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;   const <span class="keywordtype">char</span> *fmt,</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;   ...);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;static enum <a class="code" href="../../df/d72/group__Group__AMI.html#ga8d9eefd35c6b7be4f64a4b4dc9d92fd8">add_filter_result</a> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2fce7bc082ac5dfa4ea3545b9f34cb66">manager_add_filter</a>(const <span class="keywordtype">char</span> *filter_pattern, struct <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *whitefilters, struct <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *blackfilters);</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;static <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad40bb264275fb647b2044b47ac533dad">match_filter</a>(struct <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keywordtype">char</span> *eventdata);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="comment"> * @{ \brief Define AMI message types.</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<a class="code" href="../../df/d72/group__Group__AMI.html#ga7a521597aa2f92e42118f262cb911472">STASIS_MESSAGE_TYPE_DEFN</a>(<a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>);<span class="comment"></span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">/*! @} */</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment"> * \brief Find a registered action object.</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment"> * \param name Name of AMI action to find.</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment"> * \return Reffed action found or NULL</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01704"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaee7a640cdb6c8442d7fc7e7914406e5a"> 1704</a></span>&#160;static struct <a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#gaee7a640cdb6c8442d7fc7e7914406e5a">action_find</a>(const <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;{</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *act;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, act, list) {</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(name, act-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>)) {</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(act, +1, <span class="stringliteral">&quot;found action object&quot;</span>);</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      }</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;   <span class="keywordflow">return</span> act;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;}</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div><div class="line"><a name="l01720"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f"> 1720</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d9/d1d/structstasis__topic.html">stasis_topic</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;{</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gadeff73697d2789905f4c3a21671ef6d3">manager_topic</a>;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;}</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gacfa23131c1c93528074761076ca2bc85"> 1725</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#gacfa23131c1c93528074761076ca2bc85">ast_manager_get_message_router</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;{</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6d6d7bdd31cb1b6f84f2e447a7a2c6c2">stasis_router</a>;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;}</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9d8b1e607e3cbb90e48fe541c7b5cf11"> 1730</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga9d8b1e607e3cbb90e48fe541c7b5cf11">manager_json_value_str_append</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *key,</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                 <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **res)</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;{</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d4/d05/json_8h.html#a29ebd5b57ed7446feeaedda2bf813c76">ast_json_typeof</a>(value)) {</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a07e50d02cf780dadbf0341d60fbfe2c7">AST_JSON_STRING</a>:</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;%s: %s\r\n&quot;</span>, key, <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(value));</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110abf0021fff98de0d1e3460c4d4add5625">AST_JSON_INTEGER</a>:</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;%s: %jd\r\n&quot;</span>, key, <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(value));</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110ae6797350c14c8d420e446232c97d4d67">AST_JSON_TRUE</a>:</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;%s: True\r\n&quot;</span>, key);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a6c4fc9aa144bf07d9b3fa9f1a824263f">AST_JSON_FALSE</a>:</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;%s: False\r\n&quot;</span>, key);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;   <span class="keywordflow">default</span>:</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;%s: \r\n&quot;</span>, key);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;   }</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;}</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f">manager_json_to_ast_str</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *obj, <span class="keyword">const</span> <span class="keywordtype">char</span> *key,</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **res, <a class="code" href="../../db/d45/manager_8h.html#a8c8f2d8718ba98dc22b6615489fa2f8e">key_exclusion_cb</a> exclusion_cb);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;</div><div class="line"><a name="l01755"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga7e2a5d3d8ab0739e46d14c8cd369178a"> 1755</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga7e2a5d3d8ab0739e46d14c8cd369178a">manager_json_array_with_key</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *obj, <span class="keyword">const</span> <span class="keywordtype">char</span>* key,</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;               <span class="keywordtype">size_t</span> index, <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **res,</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;               <a class="code" href="../../db/d45/manager_8h.html#a8c8f2d8718ba98dc22b6615489fa2f8e">key_exclusion_cb</a> exclusion_cb)</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;{</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *key_str = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(64);</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;key_str, 0, <span class="stringliteral">&quot;%s(%zu)&quot;</span>, key, index);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f">manager_json_to_ast_str</a>(obj, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(key_str),</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            res, exclusion_cb);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;}</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;</div><div class="line"><a name="l01765"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac2fe93293795ad443c10ac77cbcaee14"> 1765</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gac2fe93293795ad443c10ac77cbcaee14">manager_json_obj_with_key</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *obj, <span class="keyword">const</span> <span class="keywordtype">char</span>* key,</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *parent_key, <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **res,</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                  <a class="code" href="../../db/d45/manager_8h.html#a8c8f2d8718ba98dc22b6615489fa2f8e">key_exclusion_cb</a> exclusion_cb)</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;{</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;   <span class="keywordflow">if</span> (parent_key) {</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *key_str = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(64);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;key_str, 0, <span class="stringliteral">&quot;%s/%s&quot;</span>, parent_key, key);</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f">manager_json_to_ast_str</a>(obj, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(key_str),</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;               res, exclusion_cb);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;   }</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f">manager_json_to_ast_str</a>(obj, key, res, exclusion_cb);</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;}</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div><div class="line"><a name="l01780"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f"> 1780</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f">manager_json_to_ast_str</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *obj, <span class="keyword">const</span> <span class="keywordtype">char</span> *key,</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;              <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **res, <a class="code" href="../../db/d45/manager_8h.html#a8c8f2d8718ba98dc22b6615489fa2f8e">key_exclusion_cb</a> exclusion_cb)</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;{</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d77/structast__json__iter.html">ast_json_iter</a> *i;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <span class="comment">/* If obj or res is not given, just return */</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;   <span class="keywordflow">if</span> (!obj || !res) {</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;   }</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;   <span class="keywordflow">if</span> (!*res &amp;&amp; !(*res = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(1024))) {</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;   }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;   <span class="keywordflow">if</span> (exclusion_cb &amp;&amp; key &amp;&amp; exclusion_cb(key)) {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;   }</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#a29ebd5b57ed7446feeaedda2bf813c76">ast_json_typeof</a>(obj) != <a class="code" href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a46eda9921019c489bb9952624c06e2a8">AST_JSON_OBJECT</a> &amp;&amp;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;       <a class="code" href="../../d4/d05/json_8h.html#a29ebd5b57ed7446feeaedda2bf813c76">ast_json_typeof</a>(obj) != <a class="code" href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a0b94a7db79a79dcc6d9e8263b3690a98">AST_JSON_ARRAY</a>) {</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga9d8b1e607e3cbb90e48fe541c7b5cf11">manager_json_value_str_append</a>(obj, key, res);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;   }</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d05/json_8h.html#a29ebd5b57ed7446feeaedda2bf813c76">ast_json_typeof</a>(obj) == <a class="code" href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a0b94a7db79a79dcc6d9e8263b3690a98">AST_JSON_ARRAY</a>) {</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <span class="keywordtype">size_t</span> j;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="../../d4/d05/json_8h.html#afa6ea445bb95ea8408059af15173b374">ast_json_array_size</a>(obj); ++j) {</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga7e2a5d3d8ab0739e46d14c8cd369178a">manager_json_array_with_key</a>(<a class="code" href="../../d4/d05/json_8h.html#a34a0e726391c4b59c534b107a3ee3310">ast_json_array_get</a>(obj, j),</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                      key, j, res, exclusion_cb);</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      }</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;   }</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;   <span class="keywordflow">for</span> (i = <a class="code" href="../../d4/d05/json_8h.html#aa4ff5e6cc56531fde9d797e439e40e28">ast_json_object_iter</a>(obj); i;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        i = <a class="code" href="../../d4/d05/json_8h.html#a9b4db2feb727c1b4f28347c31b4d79b7">ast_json_object_iter_next</a>(obj, i)) {</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2fe93293795ad443c10ac77cbcaee14">manager_json_obj_with_key</a>(<a class="code" href="../../d4/d05/json_8h.html#ab3f0d4f9fccd51c964a9501c74669880">ast_json_object_iter_value</a>(i),</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;                 <a class="code" href="../../d4/d05/json_8h.html#ada31ff6e981b88be9f99eaa4774c3d32">ast_json_object_iter_key</a>(i),</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;                 key, res, exclusion_cb);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;   }</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;}</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;</div><div class="line"><a name="l01821"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027"> 1821</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027">ast_manager_str_from_json_object</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *blob, <a class="code" href="../../db/d45/manager_8h.html#a8c8f2d8718ba98dc22b6615489fa2f8e">key_exclusion_cb</a> exclusion_cb)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;{</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *res = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(1024);</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d05/json_8h.html#afc96871ba6bc2669c1da4b313dd4a812">ast_json_is_null</a>(blob)) {</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f">manager_json_to_ast_str</a>(blob, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;res, exclusion_cb);</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;   }</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;}</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;</div><div class="line"><a name="l01832"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaf6298ba3cc972f7d6b8c42cff93cb8a8"> 1832</a></span>&#160;<span class="preprocessor">#define manager_event_sessions(sessions, category, event, contents , ...)  \</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="preprocessor">   __manager_event_sessions(sessions, category, event, 0, NULL, __FILE__, __LINE__, __PRETTY_FUNCTION__, contents , ## __VA_ARGS__)</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga8548bdd40d19dc12b6e3709694d5dbd2"> 1835</a></span>&#160;<span class="preprocessor">#define any_manager_listeners(sessions)   \</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="preprocessor">   ((sessions &amp;&amp; ao2_container_count(sessions)) || !AST_RWLIST_EMPTY(&amp;manager_hooks))</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div><div class="line"><a name="l01838"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga3cf68c6aee41a7989e352a9da265890a"> 1838</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga3cf68c6aee41a7989e352a9da265890a">manager_default_msg_cb</a>(<span class="keywordtype">void</span> *data, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *sub,</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *message)</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;{</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *ev;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d79/stasis_8h.html#aff3b891ecf151757d9977e167c9a3b07">stasis_message_can_be_ami</a>(message)) {</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      <span class="comment">/* Not an AMI message; disregard */</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;   }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/d72/group__Group__AMI.html#ga8548bdd40d19dc12b6e3709694d5dbd2">any_manager_listeners</a>(sessions)) {</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="comment">/* Nobody is listening */</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;   }</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;   ev = <a class="code" href="../../dd/d79/stasis_8h.html#adf8e3a27e9995917eb0bc043acd1316a">stasis_message_to_ami</a>(message);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;   <span class="keywordflow">if</span> (!ev) {</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="comment">/* Conversion failure */</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;   }</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gaf6298ba3cc972f7d6b8c42cff93cb8a8">manager_event_sessions</a>(sessions, ev-&gt;<a class="code" href="../../dd/d96/structast__manager__event__blob.html#a57602302e7b352ebd03ca187acfcffd4">event_flags</a>, ev-&gt;<a class="code" href="../../dd/d96/structast__manager__event__blob.html#aab469824ac975744e02d0eefe868f82f">manager_event</a>,</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>, ev-&gt;<a class="code" href="../../dd/d96/structast__manager__event__blob.html#a32dae0134e7c44c45bb610ab1a152521">extra_fields</a>);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(ev, -1);</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;}</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;</div><div class="line"><a name="l01869"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab9ef7d18dc9c448d132687dadcdf8a01"> 1869</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab9ef7d18dc9c448d132687dadcdf8a01">manager_generic_msg_cb</a>(<span class="keywordtype">void</span> *data, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *sub,</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *message)</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;{</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *payload;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;   <span class="keywordtype">int</span> class_type;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *<a class="code" href="../../df/d7d/structevent.html">event</a>;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *event_buffer;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/d72/group__Group__AMI.html#ga8548bdd40d19dc12b6e3709694d5dbd2">any_manager_listeners</a>(sessions)) {</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      <span class="comment">/* Nobody is listening */</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;   }</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;   payload = <a class="code" href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a>(message);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;   class_type = <a class="code" href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(payload-&gt;<a class="code" href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">json</a>, <span class="stringliteral">&quot;class_type&quot;</span>));</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;   type = <a class="code" href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a>(<a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(payload-&gt;<a class="code" href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">json</a>, <span class="stringliteral">&quot;type&quot;</span>));</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;   <span class="keyword">event</span> = <a class="code" href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a>(payload-&gt;<a class="code" href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">json</a>, <span class="stringliteral">&quot;event&quot;</span>);</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;   event_buffer = <a class="code" href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027">ast_manager_str_from_json_object</a>(event, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;   <span class="keywordflow">if</span> (!event_buffer) {</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a>, <span class="stringliteral">&quot;Error while creating payload for event %s\n&quot;</span>, type);</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;   }</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gaf6298ba3cc972f7d6b8c42cff93cb8a8">manager_event_sessions</a>(sessions, class_type, type,</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(event_buffer));</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(event_buffer);</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;}</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga546caee8e3d040d0074bc32e96d53b7d"> 1903</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga546caee8e3d040d0074bc32e96d53b7d">ast_manager_publish_event</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>, <span class="keywordtype">int</span> class_type, <span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *obj)</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;{</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d1/da1/structast__json.html">ast_json</a> *, event_info, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a>);</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/de9/structast__json__payload.html">ast_json_payload</a> *, payload, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *, message, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <span class="keywordflow">if</span> (!obj || !<a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>()) {</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   }</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;   <a class="code" href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a>(obj);</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;   event_info = <a class="code" href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a>(<span class="stringliteral">&quot;{s: s, s: i, s: o}&quot;</span>,</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;         <span class="stringliteral">&quot;type&quot;</span>, type,</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;         <span class="stringliteral">&quot;class_type&quot;</span>, class_type,</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;         <span class="stringliteral">&quot;event&quot;</span>, obj);</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;   <span class="keywordflow">if</span> (!event_info) {</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   }</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;   payload = <a class="code" href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a>(event_info);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;   <span class="keywordflow">if</span> (!payload) {</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;   }</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;   message = <a class="code" href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a>(<a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>(), payload);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;   <span class="keywordflow">if</span> (!message) {</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   }</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a>(), message);</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;}</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">/*! \brief Add a custom hook to be called when an event is fired */</span></div><div class="line"><a name="l01934"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9b312f4df19fa79a2185f41ff533516b"> 1934</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga9b312f4df19fa79a2185f41ff533516b">ast_manager_register_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d10/structmanager__custom__hook.html">manager_custom_hook</a> *hook)</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;{</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>, hook, list);</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;}</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">/*! \brief Delete a custom hook to be called when an event is fired */</span></div><div class="line"><a name="l01942"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9592be65e0f9c99b7952a5841888757f"> 1942</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga9592be65e0f9c99b7952a5841888757f">ast_manager_unregister_hook</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d10/structmanager__custom__hook.html">manager_custom_hook</a> *hook)</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;{</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6091f0518f8b6f443fd9f5150f3ac407">AST_RWLIST_REMOVE</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>, hook, list);</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;}</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div><div class="line"><a name="l01949"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga1a2e7df8657b820c5a6663b397f23bc9"> 1949</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1a2e7df8657b820c5a6663b397f23bc9">ast_manager_check_enabled</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;{</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a>;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;}</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div><div class="line"><a name="l01954"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga22f6d55529c1ca69bc308af9d9ef0bb2"> 1954</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga22f6d55529c1ca69bc308af9d9ef0bb2">ast_webmanager_check_enabled</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;{</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;   <span class="keywordflow">return</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a> &amp;&amp; <a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a>);</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;}</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment"> * Grab a reference to the last event, update usecount as needed.</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment"> * Can handle a NULL pointer.</span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01963"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5"> 1963</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5">grab_last</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;{</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *ret;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;   ret = <a class="code" href="../../df/d90/linkedlists_8h.html#a2aaf5b16690bc48355b4c0cd50bdefff">AST_RWLIST_LAST</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;   <span class="comment">/* the list is never empty now, but may become so when</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">    * we optimize it in the future, so be prepared.</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;   <span class="keywordflow">if</span> (ret) {</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;ret-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a>, 1);</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;   }</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;}</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment"> * Purge unused events. Remove elements from the head</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment"> * as long as their usecount is 0 and there is a next element.</span></div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01983"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga0464e7b1c82d29cbe8b3f70bf7ca29c6"> 1983</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga0464e7b1c82d29cbe8b3f70bf7ca29c6">purge_events</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;{</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *ev;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   <span class="keywordflow">while</span> ( (ev = <a class="code" href="../../df/d90/linkedlists_8h.html#a64835fe6d570951b2a0404799c3d116f">AST_RWLIST_FIRST</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>)) &amp;&amp;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;       ev-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a> == 0 &amp;&amp; <a class="code" href="../../df/d90/linkedlists_8h.html#a5c021d1e034a53d09360da4d95c76220">AST_RWLIST_NEXT</a>(ev, eq_next)) {</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3d3aa4fb3b4ba38ad8d6d255d97e037c">AST_RWLIST_REMOVE_HEAD</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>, eq_next);</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ev);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   }</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>, ev, eq_next) {</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="comment">/* Never release the last event */</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../df/d90/linkedlists_8h.html#a5c021d1e034a53d09360da4d95c76220">AST_RWLIST_NEXT</a>(ev, eq_next)) {</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;      }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="comment">/* 2.5 times whatever the HTTP timeout is (maximum 2.5 hours) is the maximum time that we will definitely cache an event */</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <span class="keywordflow">if</span> (ev-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a> == 0 &amp;&amp; <a class="code" href="../../de/df7/time_8h.html#a39af1febe8b93cb6f7cd59b76fc39e8f">ast_tvdiff_sec</a>(now, ev-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a9cf96982557d56650f0f4cd3762f05a0">tv</a>) &gt; (<a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> &gt; 3600 ? 3600 : <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a>) * 2.5) {</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(eq_next);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(ev);</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      }</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;   }</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;}</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment"> * helper functions to convert back and forth between</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment"> * string and numeric representation of set of flags</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02015"></a><span class="lineno"><a class="line" href="../../de/d4b/structpermalias.html"> 2015</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/d4b/structpermalias.html">permalias</a> {</div><div class="line"><a name="l02016"></a><span class="lineno"><a class="line" href="../../de/d4b/structpermalias.html#a86cf672daa4e0ad11ad10efc894d19c8"> 2016</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d4b/structpermalias.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>;</div><div class="line"><a name="l02017"></a><span class="lineno"><a class="line" href="../../de/d4b/structpermalias.html#ab5fbdb5052858ca8d2538566229fbe64"> 2017</a></span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d4b/structpermalias.html#ab5fbdb5052858ca8d2538566229fbe64">label</a>;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;} <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[] = {</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <span class="stringliteral">&quot;system&quot;</span> },</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <span class="stringliteral">&quot;call&quot;</span> },</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#af805764035071e210ec71c41a3a1ae6c">EVENT_FLAG_LOG</a>, <span class="stringliteral">&quot;log&quot;</span> },</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#a02eaf5c4a70ebad8e543c2efb7707869">EVENT_FLAG_VERBOSE</a>, <span class="stringliteral">&quot;verbose&quot;</span> },</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ab9bbbe9b1fbde6ccff1f0a1ec0521afd">EVENT_FLAG_COMMAND</a>, <span class="stringliteral">&quot;command&quot;</span> },</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a>, <span class="stringliteral">&quot;agent&quot;</span> },</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#acc12c2bc03dce67ddd1590d67ab11f4d">EVENT_FLAG_USER</a>, <span class="stringliteral">&quot;user&quot;</span> },</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <span class="stringliteral">&quot;config&quot;</span> },</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#a6307f76e83767cdcd6b618dfbd214526">EVENT_FLAG_DTMF</a>, <span class="stringliteral">&quot;dtmf&quot;</span> },</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <span class="stringliteral">&quot;reporting&quot;</span> },</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#adabf40844c4a05c6e0ef870002599dbe">EVENT_FLAG_CDR</a>, <span class="stringliteral">&quot;cdr&quot;</span> },</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ad602e069591b527f28e36dd472425e7e">EVENT_FLAG_DIALPLAN</a>, <span class="stringliteral">&quot;dialplan&quot;</span> },</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ad6acb19e6de27692675f1706d390f548">EVENT_FLAG_ORIGINATE</a>, <span class="stringliteral">&quot;originate&quot;</span> },</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ac7370fe764f1305cdb3c543d3964d5ed">EVENT_FLAG_AGI</a>, <span class="stringliteral">&quot;agi&quot;</span> },</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ae9fafdea9f9e226539b8a9a291079e3d">EVENT_FLAG_CC</a>, <span class="stringliteral">&quot;cc&quot;</span> },</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ad145ac7178d92461a0be448d183a037c">EVENT_FLAG_AOC</a>, <span class="stringliteral">&quot;aoc&quot;</span> },</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#a4fcf0d018dc49622b436a2ae857ea3da">EVENT_FLAG_TEST</a>, <span class="stringliteral">&quot;test&quot;</span> },</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#a673603420907be7dada8fc479e313333">EVENT_FLAG_SECURITY</a>, <span class="stringliteral">&quot;security&quot;</span> },</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   { <a class="code" href="../../db/d45/manager_8h.html#ab85694f6b643f767a2d61c37c2b87753">EVENT_FLAG_MESSAGE</a>, <span class="stringliteral">&quot;message&quot;</span> },</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;   { INT_MAX, <span class="stringliteral">&quot;all&quot;</span> },</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;   { 0, <span class="stringliteral">&quot;none&quot;</span> },</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;};</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">/*! Maximum string length of the AMI authority permission string buildable from perms[]. */</span></div><div class="line"><a name="l02043"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b"> 2043</a></span>&#160;<span class="preprocessor">#define MAX_AUTH_PERM_STRING  150</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">/*! \brief Checks to see if a string which can be used to evaluate functions should be rejected */</span></div><div class="line"><a name="l02046"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa497adca1647f8add683cd71799fc015"> 2046</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa497adca1647f8add683cd71799fc015">function_capable_string_allowed_with_auths</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *evaluating, <span class="keywordtype">int</span> writepermlist)</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;{</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;   <span class="keywordflow">if</span> (!(writepermlist &amp; <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>)</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;      &amp;&amp; (</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;         strstr(evaluating, <span class="stringliteral">&quot;SHELL&quot;</span>) ||       <span class="comment">/* NoOp(${SHELL(rm -rf /)})  */</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;         strstr(evaluating, <span class="stringliteral">&quot;EVAL&quot;</span>)           <span class="comment">/* NoOp(${EVAL(${some_var_containing_SHELL})}) */</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      )) {</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;   }</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;   <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;}</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">/*! \brief Convert authority code to a list of options for a user. This will only</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment"> * display those authority codes that have an explicit match on authority */</span></div><div class="line"><a name="l02060"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gadeb39f5a951b5c08eac6d0b872084fef"> 2060</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#gadeb39f5a951b5c08eac6d0b872084fef">user_authority_to_str</a>(<span class="keywordtype">int</span> authority, <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **res)</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;{</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   <span class="keywordtype">char</span> *sep = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a8239b9ad10367bfc936e9b60ff7706a8">ast_str_reset</a>(*res);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>) - 1; i++) {</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keywordflow">if</span> ((authority &amp; <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[i].num) == <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[i].<a class="code" href="../../de/d4b/structpermalias.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>) {</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;%s%s&quot;</span>, sep, <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[i].label);</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;         sep = <span class="stringliteral">&quot;,&quot;</span>;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      }</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;   }</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(*res) == 0) {</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="comment">/* replace empty string with something sensible */</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>);</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;   }</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(*res);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;}</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">/*! \brief Convert authority code to a list of options. Note that the EVENT_FLAG_ALL</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment"> * authority will always be returned. */</span></div><div class="line"><a name="l02084"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga57cc8b67a0e4797ab1a608872d51d397"> 2084</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga57cc8b67a0e4797ab1a608872d51d397">authority_to_str</a>(<span class="keywordtype">int</span> authority, <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **res)</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;{</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;   <span class="keywordtype">char</span> *sep = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a8239b9ad10367bfc936e9b60ff7706a8">ast_str_reset</a>(*res);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;   <span class="keywordflow">if</span> (authority != <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a246405a298682d5f34f8856b68461">EVENT_FLAG_SHUTDOWN</a>) {</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>) - 1; i++) {</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;         <span class="keywordflow">if</span> (authority &amp; <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[i].num) {</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;%s%s&quot;</span>, sep, <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[i].label);</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;            sep = <span class="stringliteral">&quot;,&quot;</span>;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;         }</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      }</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;   }</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(*res) == 0) {</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;      <span class="comment">/* replace empty string with something sensible */</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(res, 0, <span class="stringliteral">&quot;&lt;none&gt;&quot;</span>);</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;   }</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(*res);</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;}</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">/*! Tells you if smallstr exists inside bigstr</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">   which is delim by delim and uses no buf or stringsep</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">   ast_instring(&quot;this|that|more&quot;,&quot;this&quot;,&#39;|&#39;) == 1;</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">   feel free to move this to app.c -anthm */</span></div><div class="line"><a name="l02112"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaaab162dbd3271550e8bb515c1e431bd9"> 2112</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaaab162dbd3271550e8bb515c1e431bd9">ast_instring</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *bigstr, <span class="keyword">const</span> <span class="keywordtype">char</span> *smallstr, <span class="keyword">const</span> <span class="keywordtype">char</span> delim)</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;{</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d85/structval.html">val</a> = bigstr, *next;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <span class="keywordflow">if</span> ((next = strchr(val, delim))) {</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;         <span class="keywordflow">if</span> (!strncmp(val, smallstr, (next - val))) {</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;         }</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;         <span class="keywordflow">return</span> !strcmp(smallstr, val);</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;      }</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;   } <span class="keywordflow">while</span> (*(val = (next + 1)));</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;}</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div><div class="line"><a name="l02131"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd"> 2131</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *instr)</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;{</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;   <span class="keywordtype">int</span> x = 0, ret = 0;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;   <span class="keywordflow">if</span> (!instr) {</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;   }</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>); x++) {</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gaaab162dbd3271550e8bb515c1e431bd9">ast_instring</a>(instr, <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[x].label, <span class="charliteral">&#39;,&#39;</span>)) {</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;         ret |= <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[x].<a class="code" href="../../de/d4b/structpermalias.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      }</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;   }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;}</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment"> * A number returns itself, false returns 0, true returns all flags,</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment"> * other strings return the flags that are set.</span></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02152"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga11ada23da895363223ba26f69d39029a"> 2152</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga11ada23da895363223ba26f69d39029a">strings_to_mask</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>)</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;{</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *p;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">string</span>)) {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;   }</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;   <span class="keywordflow">for</span> (p = <span class="keywordtype">string</span>; *p; p++) {</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      <span class="keywordflow">if</span> (*p &lt; &#39;0&#39; || *p &gt; <span class="charliteral">&#39;9&#39;</span>) {</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      }</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;   }</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;   <span class="keywordflow">if</span> (!*p) { <span class="comment">/* all digits */</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      <span class="keywordflow">return</span> atoi(<span class="keywordtype">string</span>);</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;   }</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a>(<span class="keywordtype">string</span>)) {</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;   }</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(<span class="keywordtype">string</span>)) { <span class="comment">/* all permissions */</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <span class="keywordtype">int</span> x, ret = 0;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>); x++) {</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;         ret |= <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[x].<a class="code" href="../../de/d4b/structpermalias.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      }</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;   }</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(<span class="keywordtype">string</span>);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;}</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">/*! \brief Unreference manager session object.</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">     If no more references, then go ahead and delete it */</span></div><div class="line"><a name="l02183"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45"> 2183</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *s)</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;{</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;   <span class="keywordtype">int</span> refcount = <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(s, -1);</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a>) {</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Mansession: %p refcount now %d\n&quot;</span>, s, refcount - 1);</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;   }</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;}</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;</div><div class="line"><a name="l02192"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga60fd6fa59060c7bc3c3082275434a292"> 2192</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga60fd6fa59060c7bc3c3082275434a292">event_filter_destructor</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;{</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   regex_t *regex_filter = obj;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;   regfree(regex_filter);</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;}</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga6d2190ae1fcb37e66c2a445f2fe59ec3"> 2198</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;{</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = obj;</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *eqe = session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a>;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;   <span class="comment">/* Get rid of each of the data stores on the session */</span></div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;   <span class="keywordflow">while</span> ((datastore = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>, <a class="code" href="../../d3/d96/structentry.html">entry</a>))) {</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <span class="comment">/* Free the data store */</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      <a class="code" href="../../d9/db6/datastore_8h.html#aee27286888b30c6448a9bce928040a14">ast_datastore_free</a>(datastore);</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;   }</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;   <span class="keywordflow">if</span> (eqe) {</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a>, -1);</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;   }</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>) {</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>);</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;   }</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>) {</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, -1, <span class="stringliteral">&quot;decrement ref for white container, should be last one&quot;</span>);</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   }</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>) {</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>, -1, <span class="stringliteral">&quot;decrement ref for black container, should be last one&quot;</span>);</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;   }</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;}</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment">/*! \brief Allocate manager session structure and add it to the list of sessions */</span></div><div class="line"><a name="l02229"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga8547b9864f771b59843128a2054d7c47"> 2229</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga8547b9864f771b59843128a2054d7c47">build_mansession</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> *<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>)</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;{</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *newsession;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;   newsession = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*newsession), <a class="code" href="../../df/d72/group__Group__AMI.html#ga6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a>);</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;   <span class="keywordflow">if</span> (!newsession) {</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;   }</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;   newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;   newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;   <span class="keywordflow">if</span> (!newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a> || !newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>) {</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(newsession, -1);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;   }</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;   newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;   newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = 100;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;   newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> = -1;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>, addr);</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;newsession-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;   <span class="keywordflow">if</span> (sessions) {</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(sessions, newsession);</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;   }</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;   <span class="keywordflow">return</span> newsession;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;</div><div class="line"><a name="l02262"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga3e8f2893c887ee3b8acd8ecd151135b0"> 2262</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga3e8f2893c887ee3b8acd8ecd151135b0">mansession_cmp_fn</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;{</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *s = obj;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = arg;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;   <span class="keywordflow">return</span> !strcasecmp(s-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, str) ? <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> : 0;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;}</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div><div class="line"><a name="l02269"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5"> 2269</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5">session_destroy</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *s)</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;{</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;   <span class="keywordflow">if</span> (sessions) {</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a>(sessions, s);</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;   }</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(s);</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;}</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div><div class="line"><a name="l02282"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga91820dbca9ccfa57da1a8c3c183a56a4"> 2282</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga91820dbca9ccfa57da1a8c3c183a56a4">check_manager_session_inuse</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;{</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a> = 0;</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;   <span class="keywordflow">if</span> (sessions) {</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      session = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(sessions, (<span class="keywordtype">char</span> *) name, 0);</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="keywordflow">if</span> (session) {</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;         inuse = 1;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      }</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;   }</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;}</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment"> * lookup an entry in the list of registered users.</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment"> * must be called with the list lock held.</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02305"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee"> 2305</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>)</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;{</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>, user, list) {</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, name)) {</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      }</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;   }</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d12/res__config__ldap_8c.html#a930c15eddfe0826ff30e658c9d50b9b4">user</a>;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;}</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment">/*! \brief Get displayconnects config option.</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment"> *  \param session manager session to get parameter from.</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment"> *  \return displayconnects config option value.</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02322"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010"> 2322</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010">manager_displayconnects</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>)</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;{</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;   <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;   <span class="keywordflow">if</span> ((user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>))) {</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      ret = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;   }</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;}</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga12892108a64ff8588dbcd69a4bdf654e">print_event_instance</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a>, <span class="keyword">struct</span> <a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> *instance);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;</div><div class="line"><a name="l02340"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga689bc5c3cd185f54178b3719a5e834ac"> 2340</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga689bc5c3cd185f54178b3719a5e834ac">handle_showmancmd</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;{</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *cur;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *authority;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;   <span class="keywordtype">int</span> num;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;   <span class="keywordtype">int</span> l;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *auth_str;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;   <span class="keywordtype">char</span> syntax_title[64], description_title[64], synopsis_title[64], seealso_title[64];</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;   <span class="keywordtype">char</span> arguments_title[64], privilege_title[64], final_response_title[64], list_responses_title[64];</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show command&quot;</span>;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;         <span class="stringliteral">&quot;Usage: manager show command &lt;actionname&gt; [&lt;actionname&gt; [&lt;actionname&gt; [...]]]\n&quot;</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;         <span class="stringliteral">&quot;  Shows the detailed description for a specific Asterisk manager interface command.\n&quot;</span>;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      l = strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, cur, list) {</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;         <span class="keywordflow">if</span> (!strncasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>, l)) {</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a>(<a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>))) {</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            }</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;         }</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      }</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;   }</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &lt; 4) {</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   }</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;   authority = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b">MAX_AUTH_PERM_STRING</a>);</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;   <span class="comment">/* setup the titles */</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(synopsis_title, <span class="stringliteral">&quot;[Synopsis]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(description_title, <span class="stringliteral">&quot;[Description]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(syntax_title, <span class="stringliteral">&quot;[Syntax]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(seealso_title, <span class="stringliteral">&quot;[See Also]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(arguments_title, <span class="stringliteral">&quot;[Arguments]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(privilege_title, <span class="stringliteral">&quot;[Privilege]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(final_response_title, <span class="stringliteral">&quot;[Final Response]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(list_responses_title, <span class="stringliteral">&quot;[List Responses]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, cur, list) {</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="keywordflow">for</span> (num = 3; num &lt; a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a>; num++) {</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[num])) {</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            auth_str = <a class="code" href="../../df/d72/group__Group__AMI.html#ga57cc8b67a0e4797ab1a608872d51d397">authority_to_str</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">authority</a>, &amp;authority);</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa871ca3c361d229d4e37edf3c6016cc1">docsrc</a> == <a class="code" href="../../d1/d99/xmldoc_8h.html#a8717a951656993c40bd851ebf50f58e3a24212840b7b1b0e9c1eebc8cfd89ab3e">AST_XML_DOC</a>) {</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;               <span class="keywordtype">char</span> *syntax = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ac72ddaf7b92092136fc38629a809c87a">syntax</a>, <span class="stringliteral">&quot;Not available&quot;</span>), 1);</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;               <span class="keywordtype">char</span> *<a class="code" href="../../d0/db6/app__mysql_8c.html#afbb30cae381f627fb08e1acdac926270">synopsis</a> = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa403beb670a3277f542647cc9aa22137">synopsis</a>, <span class="stringliteral">&quot;Not available&quot;</span>), 1);</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;               <span class="keywordtype">char</span> *description = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a76f76ee5f847833b202461d55b23c17a">description</a>, <span class="stringliteral">&quot;Not available&quot;</span>), 1);</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;               <span class="keywordtype">char</span> *arguments = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ad3d4ea338fb9552532c6828f6c312c57">arguments</a>, <span class="stringliteral">&quot;Not available&quot;</span>), 1);</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;               <span class="keywordtype">char</span> *seealso = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ac07925c5773daffa1e00486fbb9ef495">seealso</a>, <span class="stringliteral">&quot;Not available&quot;</span>), 1);</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;               <span class="keywordtype">char</span> *privilege = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(auth_str, <span class="stringliteral">&quot;Not available&quot;</span>), 1);</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;               <span class="keywordtype">char</span> *responses = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<span class="stringliteral">&quot;None&quot;</span>, 1);</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;               <span class="keywordflow">if</span> (!syntax || !synopsis || !description || !arguments</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                     || !seealso || !privilege || !responses) {</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(syntax);</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(synopsis);</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(description);</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(arguments);</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(seealso);</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(privilege);</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                  <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(responses);</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                  <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Allocation failure.\n&quot;</span>);</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                  <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                  <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a>;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;               }</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;               <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s%s\n\n%s%s\n\n%s%s\n\n%s%s\n\n%s%s\n\n%s%s\n\n%s&quot;</span>,</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                  syntax_title, syntax,</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                  synopsis_title, synopsis,</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                  description_title, description,</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                  arguments_title, arguments,</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                  seealso_title, seealso,</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                  privilege_title, privilege,</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                  list_responses_title);</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;               <span class="keywordflow">if</span> (!cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ad620e07ef3ac6fbeb23e5d2ec0484e1d">list_responses</a>) {</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                  <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s\n\n&quot;</span>, responses);</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                  <span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> *temp;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                  <span class="keywordflow">for</span> (temp = cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ad620e07ef3ac6fbeb23e5d2ec0484e1d">list_responses</a>; temp; temp = <a class="code" href="../../df/d90/linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6">AST_LIST_NEXT</a>(temp, <a class="code" href="../../d8/d46/structast__xml__doc__item.html#a623575abd8c4c7cdcab02fa4156c3762">next</a>)) {</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                     <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Event: %s\n&quot;</span>, temp-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                     <a class="code" href="../../df/d72/group__Group__AMI.html#ga12892108a64ff8588dbcd69a4bdf654e">print_event_instance</a>(a, temp);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                  }</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;               }</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;               <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s&quot;</span>, final_response_title);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;               <span class="keywordflow">if</span> (!cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8c15417035739fd46675a17c5895afa9">final_response</a>) {</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                  <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s\n\n&quot;</span>, responses);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                  <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Event: %s\n&quot;</span>, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8c15417035739fd46675a17c5895afa9">final_response</a>-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>);</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                  <a class="code" href="../../df/d72/group__Group__AMI.html#ga12892108a64ff8588dbcd69a4bdf654e">print_event_instance</a>(a, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8c15417035739fd46675a17c5895afa9">final_response</a>);</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;               }</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(syntax);</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(synopsis);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(description);</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(arguments);</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(seealso);</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(privilege);</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(responses);</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            } <span class="keywordflow">else</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            {</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;               <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Action: %s\nSynopsis: %s\nPrivilege: %s\n%s\n&quot;</span>,</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                  cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa403beb670a3277f542647cc9aa22137">synopsis</a>,</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                  auth_str,</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                  <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a76f76ee5f847833b202461d55b23c17a">description</a>, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;            }</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;         }</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      }</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;   }</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;}</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac71fa21ee14d825bf98e4a658604c492"> 2472</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#gac71fa21ee14d825bf98e4a658604c492">handle_mandebug</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;{</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager set debug [on|off]&quot;</span>;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> = <span class="stringliteral">&quot;Usage: manager set debug [on|off]\n Show, enable, disable debugging of the manager code.\n&quot;</span>;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;   }</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 3) {</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;manager debug is %s\n&quot;</span>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a>? <span class="stringliteral">&quot;on&quot;</span> : <span class="stringliteral">&quot;off&quot;</span>);</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> == 4) {</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;on&quot;</span>)) {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a> = 1;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <span class="stringliteral">&quot;off&quot;</span>)) {</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a> = 0;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      }</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;   }</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;}</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;</div><div class="line"><a name="l02497"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5226d999bfd60cad437504afd1db054c"> 2497</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga5226d999bfd60cad437504afd1db054c">handle_showmanager</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;{</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;   <span class="keywordtype">int</span> l;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *rauthority = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b">MAX_AUTH_PERM_STRING</a>);</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *wauthority = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b">MAX_AUTH_PERM_STRING</a>);</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show user&quot;</span>;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;         <span class="stringliteral">&quot; Usage: manager show user &lt;user&gt;\n&quot;</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;         <span class="stringliteral">&quot;        Display all information related to the manager user specified.\n&quot;</span>;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      l = strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> != 3) {</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      }</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>, user, list) {</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;         <span class="keywordflow">if</span> (!strncasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, l)) {</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a>(<a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>))) {</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            }</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;         }</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      }</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;   }</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;   }</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;   <span class="keywordflow">if</span> (!(user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]))) {</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;There is no manager called %s\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   }</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>,</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      <span class="stringliteral">&quot;          username: %s\n&quot;</span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;      <span class="stringliteral">&quot;            secret: %s\n&quot;</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <span class="stringliteral">&quot;               ACL: %s\n&quot;</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      <span class="stringliteral">&quot;         read perm: %s\n&quot;</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="stringliteral">&quot;        write perm: %s\n&quot;</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      <span class="stringliteral">&quot;   displayconnects: %s\n&quot;</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      <span class="stringliteral">&quot;allowmultiplelogin: %s\n&quot;</span>,</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <span class="stringliteral">&quot;(N/A)&quot;</span>),</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a> ? <span class="stringliteral">&quot;&lt;Set&gt;&quot;</span> : <span class="stringliteral">&quot;(N/A)&quot;</span>),</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      ((user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a> &amp;&amp; !<a class="code" href="../../d5/d59/acl_8h.html#aaf71cd7b64f531d2ec068b7680869238">ast_acl_list_is_empty</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>)) ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>),</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gadeb39f5a951b5c08eac6d0b872084fef">user_authority_to_str</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a>, &amp;rauthority),</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gadeb39f5a951b5c08eac6d0b872084fef">user_authority_to_str</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>, &amp;wauthority),</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>),</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>));</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;         Variables: \n&quot;</span>);</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="keywordflow">for</span> (v = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a> ; v ; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;                 %s = %s\n&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      }</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d59/acl_8h.html#aaf71cd7b64f531d2ec068b7680869238">ast_acl_list_is_empty</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>)) {</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      <a class="code" href="../../d5/d59/acl_8h.html#a56811c70f305d0ce35d66cea9d9fca69">ast_acl_output</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;   }</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;}</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;</div><div class="line"><a name="l02570"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga0a3fb6c9b8db835d467df360cb34f403"> 2570</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga0a3fb6c9b8db835d467df360cb34f403">handle_showmanagers</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;{</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;   <span class="keywordtype">int</span> count_amu = 0;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show users&quot;</span>;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;         <span class="stringliteral">&quot;Usage: manager show users\n&quot;</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;         <span class="stringliteral">&quot;       Prints a listing of all managers that are currently configured on that\n&quot;</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;         <span class="stringliteral">&quot; system.\n&quot;</span>;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;   }</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;   }</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;   <span class="comment">/* If there are no users, print out something along those lines */</span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d90/linkedlists_8h.html#a0044f6572f50a89049b3b5272e51b0e7">AST_RWLIST_EMPTY</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>)) {</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;There are no manager users.\n&quot;</span>);</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;   }</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\nusername\n--------\n&quot;</span>);</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>, user, list) {</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;      count_amu++;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;   }</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>,<span class="stringliteral">&quot;-------------------\n&quot;</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            <span class="stringliteral">&quot;%d manager users configured.\n&quot;</span>, count_amu);</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;}</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment">/*! \brief  CLI command  manager list commands */</span></div><div class="line"><a name="l02613"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gad3ecc04e5e7484463d64fa6d00c2bdd2"> 2613</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#gad3ecc04e5e7484463d64fa6d00c2bdd2">handle_showmancmds</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;{</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *cur;</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;   <span class="keywordtype">int</span> name_len = 1;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;   <span class="keywordtype">int</span> space_remaining;</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="preprocessor">#define HSMC_FORMAT &quot;  %-*.*s  %-.*s\n&quot;</span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show commands&quot;</span>;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;         <span class="stringliteral">&quot;Usage: manager show commands\n&quot;</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;         <span class="stringliteral">&quot;  Prints a listing of all the available Asterisk manager interface commands.\n&quot;</span>;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;   }</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, cur, list) {</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      <span class="keywordtype">int</span> incoming_len = strlen(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>);</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      <span class="keywordflow">if</span> (incoming_len &gt; name_len) {</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;         name_len = incoming_len;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      }</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;   }</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;   space_remaining = <a class="code" href="../../df/d72/group__Group__AMI.html#ga5d7004574318e8b76738d6a158a447a9">MGR_SHOW_TERMINAL_WIDTH</a> - name_len - 4;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;   <span class="keywordflow">if</span> (space_remaining &lt; 0) {</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      space_remaining = 0;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;   }</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#a9eeaf526330f14e1906f9e6f2557364b">HSMC_FORMAT</a>, name_len, name_len, <span class="stringliteral">&quot;Action&quot;</span>, space_remaining, <span class="stringliteral">&quot;Synopsis&quot;</span>);</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#a9eeaf526330f14e1906f9e6f2557364b">HSMC_FORMAT</a>, name_len, name_len, <span class="stringliteral">&quot;------&quot;</span>, space_remaining, <span class="stringliteral">&quot;--------&quot;</span>);</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, cur, list) {</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#a9eeaf526330f14e1906f9e6f2557364b">HSMC_FORMAT</a>, name_len, name_len, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>, space_remaining, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa403beb670a3277f542647cc9aa22137">synopsis</a>);</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;   }</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;}</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="comment">/*! \brief CLI command manager list connected */</span></div><div class="line"><a name="l02655"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga26ac9d8e0f9483bd06741753ebcfe6d6"> 2655</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga26ac9d8e0f9483bd06741753ebcfe6d6">handle_showmanconn</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;{</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;   time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="preprocessor">#define HSMCONN_FORMAT1 &quot;  %-15.15s  %-55.55s  %-10.10s  %-10.10s  %-8.8s  %-8.8s  %-5.5s  %-5.5s\n&quot;</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="preprocessor">#define HSMCONN_FORMAT2 &quot;  %-15.15s  %-55.55s  %-10d  %-10d  %-8d  %-8d  %-5.5d  %-5.5d\n&quot;</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;   <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show connected&quot;</span>;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;         <span class="stringliteral">&quot;Usage: manager show connected\n&quot;</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;         <span class="stringliteral">&quot;  Prints a listing of the users that are currently connected to the\n&quot;</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;         <span class="stringliteral">&quot;Asterisk manager interface.\n&quot;</span>;</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;   }</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#a4f17d74ca1307a629a1d6b237ca02c35">HSMCONN_FORMAT1</a>, <span class="stringliteral">&quot;Username&quot;</span>, <span class="stringliteral">&quot;IP Address&quot;</span>, <span class="stringliteral">&quot;Start&quot;</span>, <span class="stringliteral">&quot;Elapsed&quot;</span>, <span class="stringliteral">&quot;FileDes&quot;</span>, <span class="stringliteral">&quot;HttpCnt&quot;</span>, <span class="stringliteral">&quot;Read&quot;</span>, <span class="stringliteral">&quot;Write&quot;</span>);</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;   <span class="keywordflow">if</span> (sessions) {</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;      i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sessions, 0);</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      <span class="keywordflow">while</span> ((session = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#afd6ff00e10a26f619b167194999013b5">HSMCONN_FORMAT2</a>, session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>),</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            (<span class="keywordtype">int</span>) (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a6886313a6b114cbcf7cb60676533c405">sessionstart</a>),</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            (<span class="keywordtype">int</span>) (now - session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a6886313a6b114cbcf7cb60676533c405">sessionstart</a>),</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> ? <a class="code" href="../../dd/d27/iostream_8h.html#a6ebb2730257107d3535fe6cb1285f479">ast_iostream_get_fd</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>) : -1,</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>,</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a>,</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>);</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;         count++;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      }</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;   }</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%d users connected.\n&quot;</span>, count);</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;}</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="comment">/*! \brief CLI command manager list eventq */</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="comment">/* Should change to &quot;manager show connected&quot; */</span></div><div class="line"><a name="l02706"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga4aa0274bed0fc74d53f43cad92c2e263"> 2706</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga4aa0274bed0fc74d53f43cad92c2e263">handle_showmaneventq</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;{</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *s;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show eventq&quot;</span>;</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;         <span class="stringliteral">&quot;Usage: manager show eventq\n&quot;</span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;         <span class="stringliteral">&quot;  Prints a listing of all events pending in the Asterisk manger\n&quot;</span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;         <span class="stringliteral">&quot;event queue.\n&quot;</span>;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;   }</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>, s, eq_next) {</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Usecount: %d\n&quot;</span>, s-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a>);</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Category: %d\n&quot;</span>, s-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>);</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Event:\n%s&quot;</span>, s-&gt;eventdata);</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;   }</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;}</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>(<span class="keywordtype">void</span>);</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="comment">/*! \brief CLI command manager reload */</span></div><div class="line"><a name="l02734"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gae44104439ab29d44fcd84f0361493625"> 2734</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#gae44104439ab29d44fcd84f0361493625">handle_manager_reload</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;{</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager reload&quot;</span>;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;         <span class="stringliteral">&quot;Usage: manager reload\n&quot;</span></div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;         <span class="stringliteral">&quot;       Reloads the manager configuration.\n&quot;</span>;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   }</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> &gt; 2) {</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;   }</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>();</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;}</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;</div><div class="line"><a name="l02753"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2d71cf4726fe666194a3473e39782abe"> 2753</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga2d71cf4726fe666194a3473e39782abe">advance_event</a>(<span class="keyword">struct</span> <a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *e)</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;{</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *next;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;   <span class="keywordflow">if</span> ((next = <a class="code" href="../../df/d90/linkedlists_8h.html#a5c021d1e034a53d09360da4d95c76220">AST_RWLIST_NEXT</a>(e, eq_next))) {</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;next-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a>, 1);</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;e-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a>, -1);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;   }</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;   <span class="keywordflow">return</span> next;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;}</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;</div><div class="line"><a name="l02766"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaeac2210b7c1bd030e2766730c0f6f0e6"> 2766</a></span>&#160;<span class="preprocessor">#define  GET_HEADER_FIRST_MATCH  0</span></div><div class="line"><a name="l02767"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga085b42ebdf75f324731bbbfc3edc0d8d"> 2767</a></span>&#160;<span class="preprocessor">#define  GET_HEADER_LAST_MATCH   1</span></div><div class="line"><a name="l02768"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa0b13360e4e6387c7a73239b67a19d57"> 2768</a></span>&#160;<span class="preprocessor">#define  GET_HEADER_SKIP_EMPTY   2</span></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="comment"> * \brief Return a matching header value.</span></div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="comment"> * \details</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="comment"> * Generic function to return either the first or the last</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="comment"> * matching header from a list of variables, possibly skipping</span></div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="comment"> * empty strings.</span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment"> * \note At the moment there is only one use of this function in</span></div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="comment"> * this file, so we make it static.</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="comment"> * \note Never returns NULL.</span></div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02783"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5106d8afed1eac24399cc5d57ab0c7e6"> 2783</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga5106d8afed1eac24399cc5d57ab0c7e6">__astman_get_header</a>(<span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, <span class="keywordtype">int</span> mode)</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;{</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;   <span class="keywordtype">int</span> x, l = strlen(var);</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;   <span class="keywordflow">if</span> (!m) {</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;   }</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>; x++) {</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *h = m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x];</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">if</span> (!strncasecmp(var, h, l) &amp;&amp; h[l] == <span class="charliteral">&#39;:&#39;</span>) {</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> = h + l + 1;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;         value = <a class="code" href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a>(value); <span class="comment">/* ignore leading spaces in the value */</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;         <span class="comment">/* found a potential candidate */</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;         <span class="keywordflow">if</span> ((mode &amp; <a class="code" href="../../df/d72/group__Group__AMI.html#gaa0b13360e4e6387c7a73239b67a19d57">GET_HEADER_SKIP_EMPTY</a>) &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(value)) {</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;            <span class="keywordflow">continue</span>;   <span class="comment">/* not interesting */</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;         }</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;         <span class="keywordflow">if</span> (mode &amp; <a class="code" href="../../df/d72/group__Group__AMI.html#ga085b42ebdf75f324731bbbfc3edc0d8d">GET_HEADER_LAST_MATCH</a>) {</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            result = <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;   <span class="comment">/* record the last match so far */</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;         }</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      }</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;   }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;}</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment"> * \brief Return the first matching variable from an array.</span></div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment"> * \note This is the legacy function and is implemented in</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment"> * therms of __astman_get_header().</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment"> * \note Never returns NULL.</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02820"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556"> 2820</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(<span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>)</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;{</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga5106d8afed1eac24399cc5d57ab0c7e6">__astman_get_header</a>(m, var, <a class="code" href="../../df/d72/group__Group__AMI.html#gaeac2210b7c1bd030e2766730c0f6f0e6">GET_HEADER_FIRST_MATCH</a>);</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;}</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment"> * \brief Append additional headers into the message structure from params.</span></div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="comment"> * \note You likely want to initialize m-&gt;hdrcount to 0 before calling this.</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02830"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga81510d243e1eb9c6f919e72183e811a6"> 2830</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga81510d243e1eb9c6f919e72183e811a6">astman_append_headers</a>(<span class="keyword">struct</span> message *m, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *params)</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;{</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;   <span class="keywordflow">for</span> (v = params; v &amp;&amp; m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a> &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>); v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>((<span class="keywordtype">char</span>**)&amp;m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>], <span class="stringliteral">&quot;%s: %s&quot;</span>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>) &gt; -1) {</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;         ++m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      }</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;   }</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;}</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="comment"> * \brief Free headers inside message structure, but not the message structure itself.</span></div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02844"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga1b557a85c122f479896a9f598ee49116"> 2844</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1b557a85c122f479896a9f598ee49116">astman_free_headers</a>(<span class="keyword">struct</span> message *m)</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;{</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;   <span class="keywordflow">while</span> (m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>) {</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;      --m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>;</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>((<span class="keywordtype">void</span> *) m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>]);</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>] = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;   }</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;}</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;<span class="comment"> * \brief Process one &quot;Variable:&quot; header value string.</span></div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;<span class="comment"> * \param head Current list of AMI variables to get new values added.</span></div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="comment"> * \param hdr_val Header value string to process.</span></div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="comment"> * \return New variable list head.</span></div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02862"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga067ac83735089a590c082f49ab11800c"> 2862</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga067ac83735089a590c082f49ab11800c">man_do_variable_value</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *head, <span class="keyword">const</span> <span class="keywordtype">char</span> *hdr_val)</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;{</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a>;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(vars)[64];</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;   );</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;   hdr_val = <a class="code" href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a>(hdr_val); <span class="comment">/* ignore leading spaces in the value */</span></div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(hdr_val);</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;   <span class="comment">/* Break the header value string into name=val pair items. */</span></div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.argc) {</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      <span class="keywordtype">int</span> y;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      <span class="comment">/* Process each name=val pair item. */</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      <span class="keywordflow">for</span> (y = 0; y &lt; <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.argc; y++) {</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *cur;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;         <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;         <span class="keywordtype">char</span> *<a class="code" href="../../d5/d85/structval.html">val</a>;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.vars[y]) {</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;         }</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;         var = val = <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.vars[y];</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;         <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;val, <span class="stringliteral">&quot;=&quot;</span>);</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;         <span class="comment">/* XXX We may wish to trim whitespace from the strings. */</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;         <span class="keywordflow">if</span> (!val || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var)) {</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;         }</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;         <span class="comment">/* Create new variable list node and prepend it to the list. */</span></div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;         cur = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a>(var, val, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;         <span class="keywordflow">if</span> (cur) {</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;            cur-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a> = head;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;            head = cur;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;         }</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;      }</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;   }</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;   <span class="keywordflow">return</span> head;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;}</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;</div><div class="line"><a name="l02906"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga21a20a25e6d03f6fd32cdc86fe9b53d1"> 2906</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga21a20a25e6d03f6fd32cdc86fe9b53d1">astman_get_variables</a>(<span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;{</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa97739ea571e22b9dcd231658f6ce044">astman_get_variables_order</a>(m, <a class="code" href="../../db/d45/manager_8h.html#a5622d5b2d0baf505daf7b2a1e99c1140aacb866340e59acaa596f8d94a8b61daf">ORDER_REVERSE</a>);</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;}</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;</div><div class="line"><a name="l02911"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa97739ea571e22b9dcd231658f6ce044"> 2911</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#gaa97739ea571e22b9dcd231658f6ce044">astman_get_variables_order</a>(<span class="keyword">const</span> <span class="keyword">struct</span> message *m,</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../db/d45/manager_8h.html#a5622d5b2d0baf505daf7b2a1e99c1140">variable_orders</a> <a class="code" href="../../d2/d79/analys_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a>)</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;{</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;   <span class="keywordtype">int</span> varlen;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *head = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> var_hdr[] = <span class="stringliteral">&quot;Variable:&quot;</span>;</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;   <span class="comment">/* Process all &quot;Variable:&quot; headers. */</span></div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;   varlen = strlen(var_hdr);</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>; x++) {</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <span class="keywordflow">if</span> (strncasecmp(var_hdr, m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x], varlen)) {</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      }</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      head = <a class="code" href="../../df/d72/group__Group__AMI.html#ga067ac83735089a590c082f49ab11800c">man_do_variable_value</a>(head, m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x] + varlen);</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;   }</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   <span class="keywordflow">if</span> (order == <a class="code" href="../../db/d45/manager_8h.html#a5622d5b2d0baf505daf7b2a1e99c1140a68beaf6e96b2e55b9301d1883add4c0a">ORDER_NATURAL</a>) {</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      head = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a21bd6558b946c31ad5f4eae901051bc5">ast_variables_reverse</a>(head);</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;   }</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;   <span class="keywordflow">return</span> head;</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;}</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="comment"></span></div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="comment">/*! \brief access for hooks to send action messages to ami */</span></div><div class="line"><a name="l02937"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gacc128abc0bb66879ef7743eea7a5d53f"> 2937</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gacc128abc0bb66879ef7743eea7a5d53f">ast_hook_send_action</a>(<span class="keyword">struct</span> <a class="code" href="../../d0/d10/structmanager__custom__hook.html">manager_custom_hook</a> *hook, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg)</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;{</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *action;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;   <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *act_found;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d8a/structmansession.html">mansession</a> s = {.<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, };</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;   <span class="keyword">struct </span>message m = { 0 };</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;   <span class="keywordtype">char</span> *dup_str;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;   <span class="keywordtype">char</span> *src;</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;   <span class="keywordtype">int</span> x = 0;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;   <span class="keywordtype">int</span> curlen;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;   <span class="keywordflow">if</span> (hook == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;   }</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;   <span class="comment">/* Create our own copy of the AMI action msg string. */</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;   src = dup_str = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(msg);</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;   <span class="keywordflow">if</span> (!dup_str) {</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;   }</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;   <span class="comment">/* convert msg string to message struct */</span></div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;   curlen = strlen(src);</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; curlen; x++) {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      <span class="keywordtype">int</span> cr;  <span class="comment">/* set if we have \r */</span></div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      <span class="keywordflow">if</span> (src[x] == <span class="charliteral">&#39;\r&#39;</span> &amp;&amp; x+1 &lt; curlen &amp;&amp; src[x+1] == <span class="charliteral">&#39;\n&#39;</span>)</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;         cr = 2;  <span class="comment">/* Found. Update length to include \r\n */</span></div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src[x] == <span class="charliteral">&#39;\n&#39;</span>)</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;         cr = 1;  <span class="comment">/* also accept \n only */</span></div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;      <span class="comment">/* don&#39;t keep empty lines */</span></div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;      <span class="keywordflow">if</span> (x &amp;&amp; m.<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a> &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(m.<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>)) {</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;         <span class="comment">/* ... but trim \r\n and terminate the header string */</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;         src[x] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;         m.<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m.<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>++] = src;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      }</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      x += cr;</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;      curlen -= x;      <span class="comment">/* remaining size */</span></div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      src += x;      <span class="comment">/* update pointer */</span></div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      x = -1;        <span class="comment">/* reset loop */</span></div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;   }</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;   action = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(&amp;m, <span class="stringliteral">&quot;Action&quot;</span>);</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;   <span class="keywordflow">do</span> {</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;login&quot;</span>)) {</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;      }</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      act_found = <a class="code" href="../../df/d72/group__Group__AMI.html#gaee7a640cdb6c8442d7fc7e7914406e5a">action_find</a>(action);</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <span class="keywordflow">if</span> (!act_found) {</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      }</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;<span class="comment">       * we have to simulate a session for this action request</span></div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="comment">       * to be able to pass it down for processing</span></div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="comment">       * This is necessary to meet the previous design of manager.c</span></div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      s.<a class="code" href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe">hook</a> = hook;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      ret = -1;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(act_found);</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;      <span class="keywordflow">if</span> (act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#acee2bf9117848b5ffbbebb64a540e19f">registered</a> &amp;&amp; act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab0bef752de7f442d29017ea812092d91">func</a>) {</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d9/df5/structast__module.html">ast_module</a> *mod_ref = <a class="code" href="../../d5/d16/module_8h.html#ad2dd3dce05926913c40b883cc7cff0a8">ast_module_running_ref</a>(act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>);</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(act_found);</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;         <span class="comment">/* If the action is in a module it must be running. */</span></div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;         <span class="keywordflow">if</span> (!act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a> || mod_ref) {</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            ret = act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab0bef752de7f442d29017ea812092d91">func</a>(&amp;s, &amp;m);</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;            <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(mod_ref);</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;         }</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(act_found);</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      }</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(act_found, -1, <span class="stringliteral">&quot;done with found action object&quot;</span>);</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;   } <span class="keywordflow">while</span> (0);</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(dup_str);</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;}</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;<span class="comment"> * helper function to send a string to the socket.</span></div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;<span class="comment"> * Return -1 on error (e.g. buffer full).</span></div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03025"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa7c66558ac59bdb0c8d05864aaec9c22"> 3025</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa7c66558ac59bdb0c8d05864aaec9c22">send_string</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keywordtype">char</span> *<span class="keywordtype">string</span>)</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;{</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/d03/structast__iostream.html">ast_iostream</a> *stream;</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>, res;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;   <span class="comment">/* It&#39;s a result from one of the hook&#39;s action invocation */</span></div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe">hook</a>) {</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="comment">       * to send responses, we&#39;re using the same function</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="comment">       * as for receiving events. We call the event &quot;HookResponse&quot;</span></div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe">hook</a>-&gt;<a class="code" href="../../d0/d10/structmanager__custom__hook.html#a563331ff9859f8ff63ed061c4c68d8cd">helper</a>(<a class="code" href="../../db/d45/manager_8h.html#aae40009621df41a713be987266a11696">EVENT_FLAG_HOOKRESPONSE</a>, <span class="stringliteral">&quot;HookResponse&quot;</span>, <span class="keywordtype">string</span>);</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;   }</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;   stream = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> ? s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> : s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>;</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;   len = strlen(<span class="keywordtype">string</span>);</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;   <a class="code" href="../../dd/d27/iostream_8h.html#a385d6e715173db6bc4b703afc05f45df">ast_iostream_set_timeout_inactivity</a>(stream, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a>);</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;   res = <a class="code" href="../../dd/d27/iostream_8h.html#a6e0bf2afcbc5b330b96378626f9ac5b3">ast_iostream_write</a>(stream, <span class="keywordtype">string</span>, len);</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;   <a class="code" href="../../dd/d27/iostream_8h.html#ace332a00f395eb7d1c93d0ee00bdf6c2">ast_iostream_set_timeout_disable</a>(stream);</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;   <span class="keywordflow">if</span> (res &lt; len) {</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a4905d9704cb1eb3ff285e4fb8aa9c68d">write_error</a> = 1;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;   }</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;}</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="comment"> * \brief thread local buffer for astman_append</span></div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="comment"> * \note This can not be defined within the astman_append() function</span></div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;<span class="comment"> *       because it declares a couple of functions that get used to</span></div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;<span class="comment"> *       initialize the thread local storage key.</span></div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03061"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d"> 3061</a></span>&#160;<a class="code" href="../../dc/d7d/threadstorage_8h.html#ac268c0a8272ec11e73269392507fb1a6">AST_THREADSTORAGE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d">astman_append_buf</a>);</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;</div><div class="line"><a name="l03063"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa1e469ecb509cb8dd2b26bde7dd1e1be"> 3063</a></span>&#160;<a class="code" href="../../dc/d7d/threadstorage_8h.html#ac268c0a8272ec11e73269392507fb1a6">AST_THREADSTORAGE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa1e469ecb509cb8dd2b26bde7dd1e1be">userevent_buf</a>);</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;<span class="comment">/*! \brief initial allocated size for the astman_append_buf and astman_send_*_va */</span></div><div class="line"><a name="l03066"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef"> 3066</a></span>&#160;<span class="preprocessor">#define ASTMAN_APPEND_BUF_INITSIZE   256</span></div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;</div><div class="line"><a name="l03068"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga960097199ef3da5b50b2b041eae8495d"> 3068</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga960097199ef3da5b50b2b041eae8495d">astman_flush</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>)</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;{</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe">hook</a> || (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a> &amp;&amp; s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>)) {</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gaa7c66558ac59bdb0c8d05864aaec9c22">send_string</a>(s, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf));</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      <a class="code" href="../../d4/dc5/extconf_8c.html#a81d26348827b996085d4cb6be3e2c348">ast_verbose</a>(<span class="stringliteral">&quot;No connection stream in astman_append, should not happen\n&quot;</span>);</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;   }</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;}</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;<span class="comment"> * utility functions for creating AMI replies</span></div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03080"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2"> 3080</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...)</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;{</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;   va_list ap;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;   <span class="keywordflow">if</span> (!(buf = <a class="code" href="../../d6/d90/strings_8h.html#afe8f5f844f2fd5f5bd5d0be5ef671481">ast_str_thread_get</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d">astman_append_buf</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef">ASTMAN_APPEND_BUF_INITSIZE</a>))) {</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;   }</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;   va_start(ap, fmt);</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;   res = <a class="code" href="../../d6/d90/strings_8h.html#a271350c7540474095b75cbea17d4837a">ast_str_set_va</a>(&amp;buf, 0, fmt, ap);</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;   va_end(ap);</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;   <span class="keywordflow">if</span> (res == <a class="code" href="../../d6/d90/strings_8h.html#a640e110a8e92c1283f2aae76e4649f48a46fbdfa757aef01471bab9679ce4281f">AST_DYNSTR_BUILD_FAILED</a>) {</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;   }</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe">hook</a> || (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gaa7c66558ac59bdb0c8d05864aaec9c22">send_string</a>(s, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf));</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      <a class="code" href="../../d4/dc5/extconf_8c.html#a81d26348827b996085d4cb6be3e2c348">ast_verbose</a>(<span class="stringliteral">&quot;No connection stream in astman_append, should not happen\n&quot;</span>);</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;   }</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;}</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;<span class="comment">/*! \note NOTE: XXX this comment is unclear and possibly wrong.</span></div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="comment">   Callers of astman_send_error(), astman_send_response() or astman_send_ack() must EITHER</span></div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">   hold the session lock _or_ be running in an action callback (in which case s-&gt;session-&gt;busy will</span></div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="comment">   be non-zero). In either of these cases, there is no need to lock-protect the session&#39;s</span></div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="comment">   fd, since no other output will be sent (events will be queued), and no input will</span></div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;<span class="comment">   be read until either the current action finishes or get_input() obtains the session</span></div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="comment">   lock.</span></div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<span class="comment">/*! \todo XXX MSG_MOREDATA should go to a header file. */</span></div><div class="line"><a name="l03114"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga97955111f384b58ee815bb59f0afa0c5"> 3114</a></span>&#160;<span class="preprocessor">#define MSG_MOREDATA ((char *)astman_send_response)</span></div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;<span class="comment">/*! \brief send a response with an optional message,</span></div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;<span class="comment"> * and terminate it with an empty line.</span></div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;<span class="comment"> * m is used only to grab the &#39;ActionID&#39; field.</span></div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;<span class="comment"> * Use the explicit constant MSG_MOREDATA to remove the empty line.</span></div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment"> * XXX MSG_MOREDATA should go to a header file.</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03123"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4"> 3123</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *resp, <span class="keywordtype">char</span> *msg, <span class="keywordtype">char</span> *listflag)</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;{</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;   buf = <a class="code" href="../../d6/d90/strings_8h.html#afe8f5f844f2fd5f5bd5d0be5ef671481">ast_str_thread_get</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d">astman_append_buf</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef">ASTMAN_APPEND_BUF_INITSIZE</a>);</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;   <span class="keywordflow">if</span> (!buf) {</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;   }</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;buf, 0, <span class="stringliteral">&quot;Response: %s\r\n&quot;</span>, resp);</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;   }</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;   <span class="keywordflow">if</span> (listflag) {</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      <span class="comment">/* Start, complete, cancelled */</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;EventList: %s\r\n&quot;</span>, listflag);</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;   }</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;   <span class="keywordflow">if</span> (msg != <a class="code" href="../../df/d72/group__Group__AMI.html#ga97955111f384b58ee815bb59f0afa0c5">MSG_MOREDATA</a>) {</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      <span class="keywordflow">if</span> (msg) {</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;Message: %s\r\n&quot;</span>, msg);</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      }</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   }</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga960097199ef3da5b50b2b041eae8495d">astman_flush</a>(s, buf);</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;}</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;</div><div class="line"><a name="l03154"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga26805df02a1c92688ae132f29ac4478a"> 3154</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga26805df02a1c92688ae132f29ac4478a">astman_send_response</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *resp, <span class="keywordtype">char</span> *msg)</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;{</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(s, m, resp, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;}</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;</div><div class="line"><a name="l03159"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c"> 3159</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>)</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;{</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(s, m, <span class="stringliteral">&quot;Error&quot;</span>, error, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;}</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;</div><div class="line"><a name="l03164"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga352d583ea36240124638e5c1db088227"> 3164</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga352d583ea36240124638e5c1db088227">astman_send_error_va</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...)</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;{</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   va_list ap;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;   <span class="keywordtype">char</span> *msg;</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;   <span class="keywordflow">if</span> (!(buf = <a class="code" href="../../d6/d90/strings_8h.html#afe8f5f844f2fd5f5bd5d0be5ef671481">ast_str_thread_get</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d">astman_append_buf</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef">ASTMAN_APPEND_BUF_INITSIZE</a>))) {</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   }</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;   va_start(ap, fmt);</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;   res = <a class="code" href="../../d6/d90/strings_8h.html#a271350c7540474095b75cbea17d4837a">ast_str_set_va</a>(&amp;buf, 0, fmt, ap);</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;   va_end(ap);</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   <span class="keywordflow">if</span> (res == <a class="code" href="../../d6/d90/strings_8h.html#a640e110a8e92c1283f2aae76e4649f48a46fbdfa757aef01471bab9679ce4281f">AST_DYNSTR_BUILD_FAILED</a>) {</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;   }</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   <span class="comment">/* astman_append will use the same underlying buffer, so copy the message out</span></div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">    * before sending the response */</span></div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;   msg = <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf);</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;   <span class="keywordflow">if</span> (msg) {</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;      msg = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(msg);</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;   }</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(s, m, <span class="stringliteral">&quot;Error&quot;</span>, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;}</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div><div class="line"><a name="l03191"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3"> 3191</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *msg)</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;{</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(s, m, <span class="stringliteral">&quot;Success&quot;</span>, msg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;}</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;</div><div class="line"><a name="l03196"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24"> 3196</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;{</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(s, m, <span class="stringliteral">&quot;Success&quot;</span>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga97955111f384b58ee815bb59f0afa0c5">MSG_MOREDATA</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;}</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;</div><div class="line"><a name="l03201"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72"> 3201</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *msg, <span class="keywordtype">char</span> *listflag)</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;{</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(s, m, <span class="stringliteral">&quot;Success&quot;</span>, msg, listflag);</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;}</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;</div><div class="line"><a name="l03206"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga63df9fe1c4852999ab438347124a34b8"> 3206</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../df/d72/group__Group__AMI.html#ga63df9fe1c4852999ab438347124a34b8">astman_send_list_complete_start_common</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keyword">const</span> <span class="keywordtype">char</span> *event_name, <span class="keywordtype">int</span> count)</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;{</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;   buf = <a class="code" href="../../d6/d90/strings_8h.html#afe8f5f844f2fd5f5bd5d0be5ef671481">ast_str_thread_get</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d">astman_append_buf</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef">ASTMAN_APPEND_BUF_INITSIZE</a>);</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;   <span class="keywordflow">if</span> (!buf) {</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;   }</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;buf, 0, <span class="stringliteral">&quot;Event: %s\r\n&quot;</span>, event_name);</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;   }</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0,</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      <span class="stringliteral">&quot;EventList: Complete\r\n&quot;</span></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <span class="stringliteral">&quot;ListItems: %d\r\n&quot;</span>,</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;      count);</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;}</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;</div><div class="line"><a name="l03228"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac9d1d485a1911880e31a3537223b3f9c"> 3228</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gac9d1d485a1911880e31a3537223b3f9c">astman_send_list_complete</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keyword">const</span> <span class="keywordtype">char</span> *event_name, <span class="keywordtype">int</span> count)</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;{</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ga63df9fe1c4852999ab438347124a34b8">astman_send_list_complete_start_common</a>(s, m, event_name, count);</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;   <span class="keywordflow">if</span> (buf) {</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga960097199ef3da5b50b2b041eae8495d">astman_flush</a>(s, buf);</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;   }</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;}</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;</div><div class="line"><a name="l03237"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342"> 3237</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keyword">const</span> <span class="keywordtype">char</span> *event_name, <span class="keywordtype">int</span> count)</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;{</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ga63df9fe1c4852999ab438347124a34b8">astman_send_list_complete_start_common</a>(s, m, event_name, count);</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;   <span class="keywordflow">if</span> (buf) {</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga960097199ef3da5b50b2b041eae8495d">astman_flush</a>(s, buf);</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;   }</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;}</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;</div><div class="line"><a name="l03245"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69"> 3245</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;{</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;}</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;<span class="comment">/*! \brief Lock the &#39;mansession&#39; structure. */</span></div><div class="line"><a name="l03251"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb"> 3251</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;{</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;}</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment">/*! \brief Unlock the &#39;mansession&#39; structure. */</span></div><div class="line"><a name="l03257"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec"> 3257</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;{</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;}</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">/*! \brief</span></div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment">   Rather than braindead on,off this now can also accept a specific int mask value</span></div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment">   or a &#39;,&#39; delim list of mask strings (the same as manager.conf) -anthm</span></div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l03266"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab7a51272a96fcd2792382b4d0bf254f6"> 3266</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab7a51272a96fcd2792382b4d0bf254f6">set_eventmask</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *eventmask)</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;{</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;   <span class="keywordtype">int</span> maskint = <a class="code" href="../../df/d72/group__Group__AMI.html#ga11ada23da895363223ba26f69d39029a">strings_to_mask</a>(eventmask);</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;   <span class="keywordflow">if</span> (maskint &gt;= 0) {</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> = maskint;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;   }</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;   <span class="keywordflow">return</span> maskint;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;}</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;</div><div class="line"><a name="l03279"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919"> 3279</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../db/df1/netsock2_8h.html#aa2785c5990a086943fea750c980abbc3">ast_transport</a> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;{</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;   <span class="keywordflow">return</span> s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#aeb4a21e3ae033a326cc9dfd20a7ab074">tls_cfg</a> ? <a class="code" href="../../db/df1/netsock2_8h.html#aa2785c5990a086943fea750c980abbc3ac5d05bd6daa774e40db98ff06a91bc0a">AST_TRANSPORT_TLS</a> :</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;         <a class="code" href="../../db/df1/netsock2_8h.html#aa2785c5990a086943fea750c980abbc3acd1be5fd1357a3d7f56ec62fc01bdc20">AST_TRANSPORT_TCP</a>;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;}</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;</div><div class="line"><a name="l03285"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga16a1493b33939fc5e485953855078109"> 3285</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga16a1493b33939fc5e485953855078109">report_invalid_user</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *username)</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;{</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dc8/structast__security__event__inval__acct__id.html">ast_security_event_inval_acct_id</a> inval_acct_id = {</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;      .<a class="code" href="../../dd/dc8/structast__security__event__inval__acct__id.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372caee96f0d4fa24a2f49c4b0374c230d5d7">AST_SECURITY_EVENT_INVAL_ACCT_ID</a>,</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#aba272dad0be48d171bd66fde6f64db37">AST_SECURITY_EVENT_INVAL_ACCT_ID_VERSION</a>,</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      .common.account_id = username,</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      },</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      },</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;   };</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s);</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;inval_acct_id));</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;}</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;</div><div class="line"><a name="l03310"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga270644a6d4f3d622e763df47b0cbfce8"> 3310</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga270644a6d4f3d622e763df47b0cbfce8">report_failed_acl</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *username)</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;{</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d53/structast__security__event__failed__acl.html">ast_security_event_failed_acl</a> failed_acl_event = {</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;      .<a class="code" href="../../df/d53/structast__security__event__failed__acl.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca598f4a7e416c29b499f2bbe828a6f036">AST_SECURITY_EVENT_FAILED_ACL</a>,</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#a9eb882bf892c0882de06605a4f6d78b2">AST_SECURITY_EVENT_FAILED_ACL_VERSION</a>,</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      .common.account_id = username,</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      },</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      },</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;   };</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;failed_acl_event));</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;}</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;</div><div class="line"><a name="l03335"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa992b47cf04699542d45129cb603c11f"> 3335</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa992b47cf04699542d45129cb603c11f">report_inval_password</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *username)</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;{</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d90/structast__security__event__inval__password.html">ast_security_event_inval_password</a> inval_password = {</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      .<a class="code" href="../../d4/d90/structast__security__event__inval__password.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca3fa859b71ad40acfebd95e787cbc373c">AST_SECURITY_EVENT_INVAL_PASSWORD</a>,</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ab1e2b732608d60725ece87d2a288463d">AST_SECURITY_EVENT_INVAL_PASSWORD_VERSION</a>,</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      .common.account_id = username,</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      },</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      },</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;   };</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;inval_password));</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;}</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;</div><div class="line"><a name="l03360"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaf35097a12cdbc0424817d9ab324d1a0a"> 3360</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaf35097a12cdbc0424817d9ab324d1a0a">report_auth_success</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;{</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d86/structast__security__event__successful__auth.html">ast_security_event_successful_auth</a> successful_auth = {</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;      .<a class="code" href="../../d6/d86/structast__security__event__successful__auth.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372caeba3af0716af08bf27b004b5b935d24f">AST_SECURITY_EVENT_SUCCESSFUL_AUTH</a>,</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#adc105808e97bd06ee0b39375c6c2a137">AST_SECURITY_EVENT_SUCCESSFUL_AUTH_VERSION</a>,</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;      .common.account_id = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;      },</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;      },</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;   };</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;successful_auth));</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;}</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;</div><div class="line"><a name="l03385"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa6a02209ea6747897dfd5249fe631105"> 3385</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa6a02209ea6747897dfd5249fe631105">report_req_not_allowed</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *action)</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;{</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;   <span class="keywordtype">char</span> request_type[64];</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/dc7/structast__security__event__req__not__allowed.html">ast_security_event_req_not_allowed</a> req_not_allowed = {</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      .<a class="code" href="../../d0/dc7/structast__security__event__req__not__allowed.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca90d668ad235bcb611b3f5a7143675f7e">AST_SECURITY_EVENT_REQ_NOT_ALLOWED</a>,</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#a6d839ed02640b1090706c4492f81a796">AST_SECURITY_EVENT_REQ_NOT_ALLOWED_VERSION</a>,</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;      .common.account_id = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      },</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;      },</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      .request_type      = <a class="code" href="../../d0/dc7/structast__security__event__req__not__allowed.html#afd6258b84dc45cf613b1896565860f70">request_type</a>,</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;   };</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;   snprintf(request_type, <span class="keyword">sizeof</span>(request_type), <span class="stringliteral">&quot;Action: %s&quot;</span>, action);</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;req_not_allowed));</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;}</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;</div><div class="line"><a name="l03414"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gae3ee6e147a9a6e5ee1cd6bd91a194c07"> 3414</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gae3ee6e147a9a6e5ee1cd6bd91a194c07">report_req_bad_format</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *action)</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;{</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../d0/dc7/structast__security__event__req__not__allowed.html#afd6258b84dc45cf613b1896565860f70">request_type</a>[64];</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dc1/structast__security__event__req__bad__format.html">ast_security_event_req_bad_format</a> req_bad_format = {</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      .<a class="code" href="../../d1/dc1/structast__security__event__req__bad__format.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372cab585ccf798297c5ad872cdc8c86da5b5">AST_SECURITY_EVENT_REQ_BAD_FORMAT</a>,</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#a7abc0e2e7315ff4d193e700fa6f1e31e">AST_SECURITY_EVENT_REQ_BAD_FORMAT_VERSION</a>,</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;      .common.account_id = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      },</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;      },</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      .request_type      = <a class="code" href="../../d1/dc1/structast__security__event__req__bad__format.html#afd6258b84dc45cf613b1896565860f70">request_type</a>,</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;   };</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;   snprintf(request_type, <span class="keyword">sizeof</span>(request_type), <span class="stringliteral">&quot;Action: %s&quot;</span>, action);</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;</div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;req_bad_format));</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;}</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;</div><div class="line"><a name="l03443"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga83162fffa402098460159beae8406122"> 3443</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga83162fffa402098460159beae8406122">report_failed_challenge_response</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s,</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *response, <span class="keyword">const</span> <span class="keywordtype">char</span> *expected_response)</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;{</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/d5a/structast__security__event__chal__resp__failed.html">ast_security_event_chal_resp_failed</a> chal_resp_failed = {</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;      .<a class="code" href="../../d3/d5a/structast__security__event__chal__resp__failed.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372cab2e0e2ff82bce347821f967f1729c3fd">AST_SECURITY_EVENT_CHAL_RESP_FAILED</a>,</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#a00073637bd298c4ceff7c0e257840f96">AST_SECURITY_EVENT_CHAL_RESP_FAILED_VERSION</a>,</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;      .common.account_id = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;      },</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;      },</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;      .challenge         = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>,</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;      .response          = <a class="code" href="../../d3/d5a/structast__security__event__chal__resp__failed.html#a3002c92aebac5e2755282e16b2d6e01a">response</a>,</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      .expected_response = <a class="code" href="../../d3/d5a/structast__security__event__chal__resp__failed.html#a6cb84dee103203abb9b4a415f108a559">expected_response</a>,</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;   };</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;chal_resp_failed));</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;}</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;</div><div class="line"><a name="l03473"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab68a64554e2df0f2d926faf603848aed"> 3473</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab68a64554e2df0f2d926faf603848aed">report_session_limit</a>(<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;{</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;   <span class="keywordtype">char</span> session_id[32];</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/d64/structast__security__event__session__limit.html">ast_security_event_session_limit</a> session_limit = {</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;      .<a class="code" href="../../d7/d64/structast__security__event__session__limit.html#a5853d232c74e8c3de4a3387c05c07df0">common</a>.<a class="code" href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">event_type</a> = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca41e5b6416947030699a9267106bc1a46">AST_SECURITY_EVENT_SESSION_LIMIT</a>,</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      .common.version    = <a class="code" href="../../d7/dc2/security__events__defs_8h.html#a27d0c312ea7e7e429f26e8e88155da1e">AST_SECURITY_EVENT_SESSION_LIMIT_VERSION</a>,</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      .common.service    = <span class="stringliteral">&quot;AMI&quot;</span>,</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;      .common.account_id = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;      .common.session_tv = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a>,</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;      .common.local_addr = {</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a>-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">parent</a>-&gt;<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>,</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;      },</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;      .common.remote_addr = {</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;         .addr      = &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>,</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;         .transport = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a>(s),</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;      },</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      .common.session_id = session_id,</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;   };</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;   snprintf(session_id, <span class="keyword">sizeof</span>(session_id), <span class="stringliteral">&quot;%p&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;   <a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a>(<a class="code" href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a>(&amp;session_limit));</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;}</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="comment"> * Here we start with action_ handlers for AMI actions,</span></div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment"> * and the internal functions used by them.</span></div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;<span class="comment"> * Generally, the handlers are called action_foo()</span></div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="comment">/* helper function for action_login() */</span></div><div class="line"><a name="l03505"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac0f21735eb8551ed24735a71ea26e13c"> 3505</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gac0f21735eb8551ed24735a71ea26e13c">authenticate</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;{</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *username = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Username&quot;</span>);</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab4fdb206838f2974bd15fc2ca1e9d366">password</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Secret&quot;</span>);</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a> = -1;</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;   regex_t *regex_filter;</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> filter_iter;</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(username)) { <span class="comment">/* missing username */</span></div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;   }</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;   <span class="comment">/* locate user in locked state */</span></div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;   <span class="keywordflow">if</span> (!(user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(username))) {</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga16a1493b33939fc5e485953855078109">report_invalid_user</a>(s, username);</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s tried to authenticate with nonexistent user &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>), username);</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a> &amp;&amp; (<a class="code" href="../../d5/d59/acl_8h.html#a3f0c6ca57c26cab3141b15c4b231188b">ast_apply_acl</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>, &amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>, <span class="stringliteral">&quot;Manager User ACL: &quot;</span>) == <a class="code" href="../../d5/d59/acl_8h.html#a764d04fe9485be95771e652dc2c87445abb486b5b819cf3b3951ce0a2e584f065">AST_SENSE_DENY</a>)) {</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga270644a6d4f3d622e763df47b0cbfce8">report_failed_acl</a>(s, username);</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s failed to pass IP ACL as &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>), username);</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;AuthType&quot;</span>), <span class="stringliteral">&quot;MD5&quot;</span>)) {</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *key = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Key&quot;</span>);</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(key) &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>) &amp;&amp; user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>) {</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;         <span class="keywordtype">int</span> x;</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a> = 0;</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;         <span class="keywordtype">char</span> md5key[256] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d1/d32/structMD5Context.html">MD5Context</a> md5;</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest[16];</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;         <a class="code" href="../../da/db0/md5_8h.html#a6bdca55813077d1c652a1f63608dac30">MD5Init</a>(&amp;md5);</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;         <a class="code" href="../../da/db0/md5_8h.html#a2a146d25ee54b589dd79d776522ef742">MD5Update</a>(&amp;md5, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>, strlen(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>));</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;         <a class="code" href="../../da/db0/md5_8h.html#a2a146d25ee54b589dd79d776522ef742">MD5Update</a>(&amp;md5, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>, strlen(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>));</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;         <a class="code" href="../../da/db0/md5_8h.html#a7132b90c03637ae151c1a8befd7989f2">MD5Final</a>(digest, &amp;md5);</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;         <span class="keywordflow">for</span> (x = 0; x &lt; 16; x++)</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;            len += sprintf(md5key + len, <span class="stringliteral">&quot;%02hhx&quot;</span>, digest[x]);</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;         <span class="keywordflow">if</span> (!strcmp(md5key, key)) {</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;            error = 0;</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga83162fffa402098460159beae8406122">report_failed_challenge_response</a>(s, key, md5key);</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;         }</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;MD5 authentication is not possible.  challenge: &#39;%s&#39;\n&quot;</span>,</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;      }</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>) {</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;      <span class="keywordflow">if</span> (!strcmp(password, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>)) {</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;         error = 0;</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gaa992b47cf04699542d45129cb603c11f">report_inval_password</a>(s, username);</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;      }</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;   }</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;   <span class="keywordflow">if</span> (error) {</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s failed to authenticate as &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>), username);</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;   }</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;   <span class="comment">/* auth complete */</span></div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;   <span class="comment">/* All of the user parameters are copied to the session so that in the event</span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="comment">   * of a reload and a configuration change, the session parameters are not</span></div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;<span class="comment">   * changed. */</span></div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, username, <span class="keyword">sizeof</span>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>));</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a>;</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>;</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a>;</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;   <span class="keywordflow">if</span> (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>) {</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a> = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a5cb297844656a440d8ba8553f81e6d4b">ast_variables_dup</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>);</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;   }</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;   filter_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, 0);</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;   <span class="keywordflow">while</span> ((regex_filter = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;filter_iter))) {</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6db9934459f5cdc95cb3af77d55d426e">ao2_t_link</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, regex_filter, <span class="stringliteral">&quot;add white user filter to session&quot;</span>);</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(regex_filter, -1, <span class="stringliteral">&quot;remove iterator ref&quot;</span>);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;   }</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;filter_iter);</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;   filter_iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>, 0);</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;   <span class="keywordflow">while</span> ((regex_filter = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;filter_iter))) {</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6db9934459f5cdc95cb3af77d55d426e">ao2_t_link</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>, regex_filter, <span class="stringliteral">&quot;add black user filter to session&quot;</span>);</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(regex_filter, -1, <span class="stringliteral">&quot;remove iterator ref&quot;</span>);</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;   }</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;filter_iter);</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a6886313a6b114cbcf7cb60676533c405">sessionstart</a> = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">sessionstart_tv</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gab7a51272a96fcd2792382b4d0bf254f6">set_eventmask</a>(s, <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Events&quot;</span>));</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gaf35097a12cdbc0424817d9ab324d1a0a">report_auth_success</a>(s);</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;}</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;</div><div class="line"><a name="l03602"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaea3a1b38ba96480a2f09d7109a69b0fd"> 3602</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaea3a1b38ba96480a2f09d7109a69b0fd">action_ping</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;{</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *actionid = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;   <span class="keyword">struct </span>timeval now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n&quot;</span>);</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(actionid)){</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, actionid);</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;   }</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;      s,</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;      <span class="stringliteral">&quot;Ping: Pong\r\n&quot;</span></div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;      <span class="stringliteral">&quot;Timestamp: %ld.%06lu\r\n&quot;</span></div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;      <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;      (<span class="keywordtype">long</span>) now.tv_sec, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) now.tv_usec);</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;}</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;</div><div class="line"><a name="l03620"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga607030674dbfc12f62148d375b4e320f"> 3620</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga607030674dbfc12f62148d375b4e320f">action_getconfig</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;{</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *fn = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Filename&quot;</span>);</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Category&quot;</span>);</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Filter&quot;</span>);</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *category_name;</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;   <span class="keywordtype">int</span> catcount = 0;</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;   <span class="keywordtype">int</span> lineno = 0;</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/db2/structast__category.html">ast_category</a> *cur_category = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fabc16a274124ae96d43f8e52e344292c3">CONFIG_FLAG_WITHCOMMENTS</a> | <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fa3b68640f31a2c5493459c159abee08ee">CONFIG_FLAG_NOCACHE</a> };</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(fn)) {</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Filename not specified&quot;</span>);</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;   }</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;   cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a>(fn, <span class="stringliteral">&quot;manager&quot;</span>, config_flags);</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;   <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a39bacaabcacf47583204c7634e64a2a0">CONFIG_STATUS_FILEMISSING</a>) {</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file not found&quot;</span>);</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file has invalid format&quot;</span>);</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;   }</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;   <span class="keywordflow">while</span> ((cur_category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, category, cur_category, filter))) {</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d8/d4f/provision_8c.html#a45e847f4fe454799dfd46a84eca1daf6">templates</a>;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      category_name = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1ac00507f4e5ae91c46f613e5cadae04">ast_category_get_name</a>(cur_category);</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      lineno = 0;</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Category-%06d: %s\r\n&quot;</span>, catcount, category_name);</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aa5e72d9401477c9775d054babae77e89">ast_category_is_template</a>(cur_category)) {</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;IsTemplate-%06d: %d\r\n&quot;</span>, catcount, 1);</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;      }</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      <span class="keywordflow">if</span> ((templates = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a54b98eac3831b61f0ec723bc1822405a">ast_category_get_templates</a>(cur_category))</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;         &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(templates) &gt; 0) {</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Templates-%06d: %s\r\n&quot;</span>, catcount, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(templates));</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(templates);</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;      }</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      <span class="keywordflow">for</span> (v = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a39040e0fe9c0bac870c10ad32afbfb17">ast_category_first</a>(cur_category); v; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Line-%06d-%06d: %s=%s\r\n&quot;</span>, catcount, lineno++, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;      }</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;      catcount++;</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;   }</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(category) &amp;&amp; catcount == 0) { <span class="comment">/* TODO: actually, a config with no categories doesn&#39;t even get loaded */</span></div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;No categories found\r\n&quot;</span>);</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;   }</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;}</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;</div><div class="line"><a name="l03682"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga28572e9c3a5f7c565f68eae095454d3c"> 3682</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga28572e9c3a5f7c565f68eae095454d3c">action_listcategories</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;{</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *fn = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Filename&quot;</span>);</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/dff/chan__iax2_8c.html#a7dd0190efe1c61151a9dbab078bdb263">match</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Match&quot;</span>);</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/db2/structast__category.html">ast_category</a> *<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fabc16a274124ae96d43f8e52e344292c3">CONFIG_FLAG_WITHCOMMENTS</a> | <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fa3b68640f31a2c5493459c159abee08ee">CONFIG_FLAG_NOCACHE</a> };</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;   <span class="keywordtype">int</span> catcount = 0;</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(fn)) {</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Filename not specified&quot;</span>);</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;   }</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;   <span class="keywordflow">if</span> (!(cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a>(fn, <span class="stringliteral">&quot;manager&quot;</span>, config_flags))) {</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file not found&quot;</span>);</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file has invalid format&quot;</span>);</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;   }</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;</div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;   <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, category, match))) {</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Category-%06d: %s\r\n&quot;</span>, catcount, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1ac00507f4e5ae91c46f613e5cadae04">ast_category_get_name</a>(category));</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      catcount++;</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;   }</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;</div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;   <span class="keywordflow">if</span> (catcount == 0) { <span class="comment">/* TODO: actually, a config with no categories doesn&#39;t even get loaded */</span></div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Error: no categories found\r\n&quot;</span>);</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;   }</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;}</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;<span class="comment">/*! The amount of space in out must be at least ( 2 * strlen(in) + 1 ) */</span></div><div class="line"><a name="l03721"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga6dba42aa414d62585a0a662a5561ec73"> 3721</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6dba42aa414d62585a0a662a5561ec73">json_escape</a>(<span class="keywordtype">char</span> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>)</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;{</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;   <span class="keywordflow">for</span> (; *<a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>; in++) {</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;      <span class="keywordflow">if</span> (*in == <span class="charliteral">&#39;\\&#39;</span> || *in == <span class="charliteral">&#39;\&quot;&#39;</span>) {</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;         *out++ = <span class="charliteral">&#39;\\&#39;</span>;</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;      }</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;      *out++ = *<a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>;</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;   }</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;   *out = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;}</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="comment"> * \brief Append a JSON escaped string to the manager stream.</span></div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;<span class="comment"> * \param s AMI stream to append a string.</span></div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;<span class="comment"> * \param str String to append to the stream after JSON escaping it.</span></div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03741"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5d231019a6733602acb549ee4f82529b"> 3741</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga5d231019a6733602acb549ee4f82529b">astman_append_json</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>)</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;{</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;   buf = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(2 * strlen(str) + 1);</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga6dba42aa414d62585a0a662a5561ec73">json_escape</a>(buf, str);</div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;%s&quot;</span>, buf);</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;}</div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div><div class="line"><a name="l03750"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga22cac49ed9e48c4bed52477e6334278e"> 3750</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga22cac49ed9e48c4bed52477e6334278e">action_getconfigjson</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;{</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *fn = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Filename&quot;</span>);</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Filter&quot;</span>);</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Category&quot;</span>);</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d7/db2/structast__category.html">ast_category</a> *cur_category = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *category_name;</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;   <span class="keywordtype">int</span> comma1 = 0;</div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fabc16a274124ae96d43f8e52e344292c3">CONFIG_FLAG_WITHCOMMENTS</a> | <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fa3b68640f31a2c5493459c159abee08ee">CONFIG_FLAG_NOCACHE</a> };</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;</div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(fn)) {</div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Filename not specified&quot;</span>);</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;   }</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;   <span class="keywordflow">if</span> (!(cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a>(fn, <span class="stringliteral">&quot;manager&quot;</span>, config_flags))) {</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file not found&quot;</span>);</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file has invalid format&quot;</span>);</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;   }</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;JSON: {&quot;</span>);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;   <span class="keywordflow">while</span> ((cur_category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, category, cur_category, filter))) {</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      <span class="keywordtype">int</span> comma2 = 0;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../d8/d4f/provision_8c.html#a45e847f4fe454799dfd46a84eca1daf6">templates</a>;</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;      category_name = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1ac00507f4e5ae91c46f613e5cadae04">ast_category_get_name</a>(cur_category);</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;%s\&quot;&quot;</span>, comma1 ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga5d231019a6733602acb549ee4f82529b">astman_append_json</a>(s, category_name);</div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\&quot;:{&quot;</span>);</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;      comma1 = 1;</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aa5e72d9401477c9775d054babae77e89">ast_category_is_template</a>(cur_category)) {</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\&quot;istemplate\&quot;:1&quot;</span>);</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;         comma2 = 1;</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;      }</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;      <span class="keywordflow">if</span> ((templates = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a54b98eac3831b61f0ec723bc1822405a">ast_category_get_templates</a>(cur_category))</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;         &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a>(templates) &gt; 0) {</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;%s&quot;</span>, comma2 ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\&quot;templates\&quot;:\&quot;%s\&quot;&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(templates));</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(templates);</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;         comma2 = 1;</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;      }</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;      <span class="keywordflow">for</span> (v = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a39040e0fe9c0bac870c10ad32afbfb17">ast_category_first</a>(cur_category); v; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;%s\&quot;&quot;</span>, comma2 ? <span class="stringliteral">&quot;,&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5d231019a6733602acb549ee4f82529b">astman_append_json</a>(s, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\&quot;:\&quot;&quot;</span>);</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5d231019a6733602acb549ee4f82529b">astman_append_json</a>(s, v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\&quot;&quot;</span>);</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;         comma2 = 1;</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;      }</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;}&quot;</span>);</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;   }</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;}\r\n\r\n&quot;</span>);</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;}</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="comment"></span></div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;<span class="comment">/*! \brief helper function for action_updateconfig */</span></div><div class="line"><a name="l03819"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5da77ad82c423fcfee5299611ed6d7ce"> 3819</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92">error_type</a> <a class="code" href="../../df/d72/group__Group__AMI.html#ga5da77ad82c423fcfee5299611ed6d7ce">handle_updates</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keyword">struct</span> <a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg, <span class="keyword">const</span> <span class="keywordtype">char</span> *dfn)</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;{</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;   <span class="keywordtype">char</span> hdr[40];</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *action, *cat, *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>, *<a class="code" href="../../d5/dff/chan__iax2_8c.html#a7dd0190efe1c61151a9dbab078bdb263">match</a>, *line, *<a class="code" href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a>;</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *str1 = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(16), *str2 = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(16);</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92">error_type</a> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = 0;</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; 100000; x++) {   <span class="comment">/* 100000 = the max number of allowed updates + 1 */</span></div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">object</span> = 0;</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      <span class="keywordtype">char</span> *dupoptions;</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      <span class="keywordtype">int</span> allowdups = 0;</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;      <span class="keywordtype">int</span> istemplate = 0;</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;      <span class="keywordtype">int</span> ignoreerror = 0;</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keywordtype">char</span> *, inherit, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keywordtype">char</span> *, catfilter, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;      <span class="keywordtype">char</span> *token;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;      <span class="keywordtype">int</span> foundvar = 0;</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;      <span class="keywordtype">int</span> foundcat = 0;</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d7/db2/structast__category.html">ast_category</a> *<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      snprintf(hdr, <span class="keyword">sizeof</span>(hdr), <span class="stringliteral">&quot;Action-%06d&quot;</span>, x);</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;      action = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, hdr);</div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(action))     <span class="comment">/* breaks the for loop if no action header */</span></div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;         <span class="keywordflow">break</span>;                     <span class="comment">/* this could cause problems if actions come in misnumbered */</span></div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;      snprintf(hdr, <span class="keyword">sizeof</span>(hdr), <span class="stringliteral">&quot;Cat-%06d&quot;</span>, x);</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;      cat = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, hdr);</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cat)) {      <span class="comment">/* every action needs a category */</span></div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;         result =  <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac327a21855ab9428a0a4ec3b2bc9e4da">UNSPECIFIED_CATEGORY</a>;</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;      }</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      snprintf(hdr, <span class="keyword">sizeof</span>(hdr), <span class="stringliteral">&quot;Var-%06d&quot;</span>, x);</div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;      var = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, hdr);</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      snprintf(hdr, <span class="keyword">sizeof</span>(hdr), <span class="stringliteral">&quot;Value-%06d&quot;</span>, x);</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      value = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, hdr);</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(value) &amp;&amp; *value == <span class="charliteral">&#39;&gt;&#39;</span>) {</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;         <span class="keywordtype">object</span> = 1;</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;         value++;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;      }</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      snprintf(hdr, <span class="keyword">sizeof</span>(hdr), <span class="stringliteral">&quot;Match-%06d&quot;</span>, x);</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      match = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, hdr);</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;      snprintf(hdr, <span class="keyword">sizeof</span>(hdr), <span class="stringliteral">&quot;Line-%06d&quot;</span>, x);</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      line = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, hdr);</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;      snprintf(hdr, <span class="keyword">sizeof</span>(hdr), <span class="stringliteral">&quot;Options-%06d&quot;</span>, x);</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;      options = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, hdr);</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(options)) {</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;         <span class="keywordtype">char</span> <a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>[strlen(options) + 1];</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;         strcpy(copy, options); <span class="comment">/* safe */</span></div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;         dupoptions = <a class="code" href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a>;</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;         <span class="keywordflow">while</span> ((token = <a class="code" href="../../d6/d90/strings_8h.html#aec193d64a6309c72d72e5e523ef6076e">ast_strsep</a>(&amp;dupoptions, <span class="charliteral">&#39;,&#39;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2">AST_STRSEP_STRIP</a>))) {</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(<span class="stringliteral">&quot;allowdups&quot;</span>, token)) {</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;               allowdups = 1;</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;            }</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(<span class="stringliteral">&quot;template&quot;</span>, token)) {</div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;               istemplate = 1;</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;            }</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(<span class="stringliteral">&quot;ignoreerror&quot;</span>, token)) {</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;               ignoreerror = 1;</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;            }</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a>(token, <span class="stringliteral">&quot;inherit&quot;</span>)) {</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;               <span class="keywordtype">char</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = <a class="code" href="../../d6/d90/strings_8h.html#aec193d64a6309c72d72e5e523ef6076e">ast_strsep</a>(&amp;token, <span class="charliteral">&#39;=&#39;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2">AST_STRSEP_STRIP</a>);</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;               c = <a class="code" href="../../d6/d90/strings_8h.html#aec193d64a6309c72d72e5e523ef6076e">ast_strsep</a>(&amp;token, <span class="charliteral">&#39;=&#39;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2">AST_STRSEP_STRIP</a>);</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;               <span class="keywordflow">if</span> (c) {</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;                  inherit = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(c);</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;               }</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;            }</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a>(token, <span class="stringliteral">&quot;catfilter&quot;</span>)) {</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;               <span class="keywordtype">char</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = <a class="code" href="../../d6/d90/strings_8h.html#aec193d64a6309c72d72e5e523ef6076e">ast_strsep</a>(&amp;token, <span class="charliteral">&#39;=&#39;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2">AST_STRSEP_STRIP</a>);</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;               c = <a class="code" href="../../d6/d90/strings_8h.html#aec193d64a6309c72d72e5e523ef6076e">ast_strsep</a>(&amp;token, <span class="charliteral">&#39;=&#39;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2">AST_STRSEP_STRIP</a>);</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;               <span class="keywordflow">if</span> (c) {</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;                  catfilter = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(c);</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;               }</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;               <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;            }</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;         }</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;      }</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;</div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;newcat&quot;</span>)) {</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;         <span class="keyword">struct </span><a class="code" href="../../d7/db2/structast__category.html">ast_category</a> *<span class="keyword">template</span>;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;         <span class="keywordtype">char</span> *tmpl_name = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;         <span class="keywordflow">if</span> (!allowdups) {</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a976052ba6bdad7e94e60cd4bc1c3f3b2">ast_category_get</a>(cfg, cat, <span class="stringliteral">&quot;TEMPLATES=include&quot;</span>)) {</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;               <span class="keywordflow">if</span> (ignoreerror) {</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;                  <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;                  result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9">FAILURE_NEWCAT</a>;   <span class="comment">/* already exist */</span></div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;               }</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;            }</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;         }</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;         <span class="keywordflow">if</span> (istemplate) {</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;            category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab4c6b70f2b1c373c5d299b8020b5a5d">ast_category_new_template</a>(cat, dfn, -1);</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;            category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a662135d8d43ad08325882645dc5f8df3">ast_category_new</a>(cat, dfn, -1);</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;         }</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;         <span class="keywordflow">if</span> (!category) {</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a>;</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;         }</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;         <span class="keywordflow">if</span> (inherit) {</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;            <span class="keywordflow">while</span> ((tmpl_name = <a class="code" href="../../d6/d90/strings_8h.html#aec193d64a6309c72d72e5e523ef6076e">ast_strsep</a>(&amp;inherit, <span class="charliteral">&#39;,&#39;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2">AST_STRSEP_STRIP</a>))) {</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;               <span class="keywordflow">if</span> ((<span class="keyword">template</span> = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a976052ba6bdad7e94e60cd4bc1c3f3b2">ast_category_get</a>(cfg, tmpl_name, <span class="stringliteral">&quot;TEMPLATES=restrict&quot;</span>))) {</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a0c11a185ac14ffef84950e9cfdb8e0ee">ast_category_inherit</a>(category, <span class="keyword">template</span>)) {</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                     result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a>;</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                  }</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                  <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a94ba5ab9fffe6dd755ee95db7ff2432f">ast_category_destroy</a>(category);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                  category = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;                  result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac22fdd80fd7df09af8999f6e429e29fb">FAILURE_TEMPLATE</a>; <span class="comment">/* template not found */</span></div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;               }</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;            }</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;         }</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;         <span class="keywordflow">if</span> (category != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(match)) {</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;               <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aa422e1cc73c1ac4db7ed8cd1a0e36e1a">ast_category_append</a>(cfg, category);</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a3e27edf18993cf1250e1a6a08c971d6d">ast_category_insert</a>(cfg, category, match)) {</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                  <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a94ba5ab9fffe6dd755ee95db7ff2432f">ast_category_destroy</a>(category);</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                  result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9">FAILURE_NEWCAT</a>;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;               }</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;            }</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;         }</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;renamecat&quot;</span>)) {</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(value)) {</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>;</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;         }</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;         foundcat = 0;</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, cat, category, catfilter))) {</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;            <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2a5612ff8eb3595c1be1df75be4d870f">ast_category_rename</a>(category, value);</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;            foundcat = 1;</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;         }</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;         <span class="keywordflow">if</span> (!foundcat) {</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>;</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;         }</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;delcat&quot;</span>)) {</div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;         foundcat = 0;</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, cat, category, catfilter))) {</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;            category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aeebe92aa21bea10f5d3f901a357a9806">ast_category_delete</a>(cfg, category);</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;            foundcat = 1;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;         }</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;         <span class="keywordflow">if</span> (!foundcat &amp;&amp; !ignoreerror) {</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>;</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;         }</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;emptycat&quot;</span>)) {</div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;         foundcat = 0;</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, cat, category, catfilter))) {</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;            <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aa37456e447f230b9aa1a529658c4b1b1">ast_category_empty</a>(category);</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;            foundcat = 1;</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;         }</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;         <span class="keywordflow">if</span> (!foundcat) {</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>;</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;         }</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;update&quot;</span>)) {</div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var)) {</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>;</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;         }</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;         foundcat = 0;</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;         foundvar = 0;</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, cat, category, catfilter))) {</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a61b77e9b543a66af82d7ac7d4d6b4ac8">ast_variable_update</a>(category, var, value, match, <span class="keywordtype">object</span>)) {</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;               foundvar = 1;</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;            }</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;            foundcat = 1;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;         }</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;         <span class="keywordflow">if</span> (!foundcat) {</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;         }</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;         <span class="keywordflow">if</span> (!foundvar) {</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9">FAILURE_UPDATE</a>;</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;         }</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;delete&quot;</span>)) {</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;         <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var) &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(line))) {</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;         }</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;         foundcat = 0;</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;         foundvar = 0;</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, cat, category, catfilter))) {</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a387af9887266a55f3dcbbf3c12d4ccba">ast_variable_delete</a>(category, var, match, line)) {</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;               foundvar = 1;</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;            }</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;            foundcat = 1;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;         }</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;         <span class="keywordflow">if</span> (!foundcat) {</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>;</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;         }</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;         <span class="keywordflow">if</span> (!foundvar &amp;&amp; !ignoreerror) {</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9">FAILURE_UPDATE</a>;</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;         }</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;append&quot;</span>)) {</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var)) {</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;         }</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;         foundcat = 0;</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, cat, category, catfilter))) {</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;            <span class="keywordflow">if</span> (!(v = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a>(var, value, dfn))) {</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;               result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a>;</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;            }</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;            <span class="keywordflow">if</span> (<span class="keywordtype">object</span> || (match &amp;&amp; !strcasecmp(match, <span class="stringliteral">&quot;object&quot;</span>))) {</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;               v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a328cd221e75f4bd92e3ccf406f0d0441">object</a> = 1;</div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;            }</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;            <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a57a3200e5b440d7135eaf0450ea559fe">ast_variable_append</a>(category, v);</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;            foundcat = 1;</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;         }</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;         <span class="keywordflow">if</span> (!foundcat) {</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>;</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;         }</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(action, <span class="stringliteral">&quot;insert&quot;</span>)) {</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(var) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(line)) {</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;         }</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;         foundcat = 0;</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;         <span class="keywordflow">while</span> ((category = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a>(cfg, cat, category, catfilter))) {</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;            <span class="keywordflow">if</span> (!(v = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a>(var, value, dfn))) {</div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;               result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a>;</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;            }</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;            <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad12cd7f4f5efe4a460c1aaed0ac488d5">ast_variable_insert</a>(category, v, line);</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;            foundcat = 1;</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;         }</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;         <span class="keywordflow">if</span> (!foundcat) {</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;            result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>;</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;         }</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;      }</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;      <span class="keywordflow">else</span> {</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Action-%06d: %s not handled\n&quot;</span>, x, action);</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;         result = <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ae16d79bf07a3994731f4ac1a6ece5ec8">UNKNOWN_ACTION</a>;</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;      }</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;   }</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(str1);</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(str2);</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;}</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;</div><div class="line"><a name="l04102"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga722b7d69a94cb2ececdb88bf67f80667"> 4102</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga722b7d69a94cb2ececdb88bf67f80667">action_updateconfig</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;{</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *cfg;</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *sfn = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;SrcFilename&quot;</span>);</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *dfn = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;DstFilename&quot;</span>);</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *rld = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Reload&quot;</span>);</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;   <span class="keywordtype">int</span> preserve_effective_context = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8990d27b9ca1ef2a4265bbb34ece23aca6c84eccb1efc098a6bc1946ac3cb9d43">CONFIG_SAVE_FLAG_PRESERVE_EFFECTIVE_CONTEXT</a>;</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *preserve_effective_context_string = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;PreserveEffectiveContext&quot;</span>);</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fabc16a274124ae96d43f8e52e344292c3">CONFIG_FLAG_WITHCOMMENTS</a> | <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fa3b68640f31a2c5493459c159abee08ee">CONFIG_FLAG_NOCACHE</a> };</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92">error_type</a> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(sfn) || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dfn)) {</div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Filename not specified&quot;</span>);</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;   }</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;   <span class="keywordflow">if</span> (!(cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a>(sfn, <span class="stringliteral">&quot;manager&quot;</span>, config_flags))) {</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file not found&quot;</span>);</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Config file has invalid format&quot;</span>);</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;   }</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;   result = <a class="code" href="../../df/d72/group__Group__AMI.html#ga5da77ad82c423fcfee5299611ed6d7ce">handle_updates</a>(s, m, cfg, dfn);</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;   <span class="keywordflow">if</span> (!result) {</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a008dccc13b0342d21fa91bf5c26bbcba">ast_include_rename</a>(cfg, sfn, dfn); <span class="comment">/* change the include references from dfn to sfn, so things match up */</span></div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(preserve_effective_context_string) &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(preserve_effective_context_string)) {</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;         preserve_effective_context = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8990d27b9ca1ef2a4265bbb34ece23aca15ee838ecb8362bba6c429be5930a80d">CONFIG_SAVE_FLAG_NONE</a>;</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      }</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      res = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a22ea082c5889a8a74d1110459c372d24">ast_config_text_file_save2</a>(dfn, cfg, <span class="stringliteral">&quot;Manager&quot;</span>, preserve_effective_context);</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Save of config failed&quot;</span>);</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      }</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(rld)) {</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(rld)) {</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;            rld = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;         }</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;         <a class="code" href="../../d5/d16/module_8h.html#af9e3b4ae730e43312e00fcbc1707588b">ast_module_reload</a>(rld);</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;      }</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;      <span class="keywordflow">switch</span>(result) {</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ae16d79bf07a3994731f4ac1a6ece5ec8">UNKNOWN_ACTION</a>:</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unknown action command&quot;</span>);</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a>:</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Given category does not exist&quot;</span>);</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac327a21855ab9428a0a4ec3b2bc9e4da">UNSPECIFIED_CATEGORY</a>:</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Category not specified&quot;</span>);</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a>:</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Problem with category, value, or line (if required)&quot;</span>);</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a>:</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Memory allocation failure, this should not happen&quot;</span>);</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9">FAILURE_NEWCAT</a>:</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Create category did not complete successfully&quot;</span>);</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92aa8e1a46fc31ba23e18080284f3938d75">FAILURE_DELCAT</a>:</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Delete category did not complete successfully&quot;</span>);</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a468f85e937d9a9d14172b0239d212125">FAILURE_EMPTYCAT</a>:</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Empty category did not complete successfully&quot;</span>);</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9">FAILURE_UPDATE</a>:</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Update did not complete successfully&quot;</span>);</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a873b7dc80f148550a62038a0f860f31d">FAILURE_DELETE</a>:</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Delete did not complete successfully&quot;</span>);</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a97ea9672929721f6b45f60f058465bd9">FAILURE_APPEND</a>:</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Append did not complete successfully&quot;</span>);</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac22fdd80fd7df09af8999f6e429e29fb">FAILURE_TEMPLATE</a>:</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Template category not found&quot;</span>);</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;      }</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;   }</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;}</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;</div><div class="line"><a name="l04188"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga03aa8a5224eadc07dddc34751e1868d0"> 4188</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga03aa8a5224eadc07dddc34751e1868d0">action_createconfig</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;{</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;   <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *fn = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Filename&quot;</span>);</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *filepath = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../db/db2/asterisk_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>);</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;filepath, 0, <span class="stringliteral">&quot;%s/&quot;</span>, <a class="code" href="../../dd/df2/paths_8h.html#a7d3836e5581e433c9f5edd30300cc187">ast_config_AST_CONFIG_DIR</a>);</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;filepath, 0, <span class="stringliteral">&quot;%s&quot;</span>, fn);</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;   <span class="keywordflow">if</span> ((fd = open(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(filepath), O_CREAT | O_EXCL, <a class="code" href="../../db/db2/asterisk_8h.html#aa6293b2dae52a2b470494df672a26c42">AST_FILE_MODE</a>)) != -1) {</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;      close(fd);</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;New configuration file created successfully&quot;</span>);</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;   }</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;}</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;</div><div class="line"><a name="l04206"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gadf9acbde2aab503926610acb110634d6"> 4206</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gadf9acbde2aab503926610acb110634d6">action_waitevent</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;{</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *timeouts = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Timeout&quot;</span>);</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = -1;</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;   <span class="keywordtype">int</span> needexit = 0;</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;   <span class="keywordtype">char</span> idText[256];</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;      idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;   }</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(timeouts)) {</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;      sscanf(timeouts, <span class="stringliteral">&quot;%30i&quot;</span>, &amp;timeout);</div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;      <span class="keywordflow">if</span> (timeout &lt; -1) {</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;         timeout = -1;</div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;      }</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;      <span class="comment">/* XXX maybe put an upper bound, or prevent the use of 0 ? */</span></div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;   }</div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> != <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>) {</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;      pthread_kill(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a>, SIGURG);</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;   }</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a>) { <span class="comment">/* AMI-over-HTTP session */</span></div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;<span class="comment">       * Make sure the timeout is within the expire time of the session,</span></div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;<span class="comment">       * as the client will likely abort the request if it does not see</span></div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;<span class="comment">       * data coming after some amount of time.</span></div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;      time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="../../dc/dc2/f2c_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a> = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">sessiontimeout</a> - now - 10;</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;      <span class="keywordflow">if</span> (max &lt; 0) { <span class="comment">/* We are already late. Strange but possible. */</span></div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;         max = 0;</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;      }</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;      <span class="keywordflow">if</span> (timeout &lt; 0 || timeout &gt; max) {</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;         timeout = <a class="code" href="../../dc/dc2/f2c_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a>;</div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;      }</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;      <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a>) {  <span class="comment">/* make sure we record events */</span></div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;         s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> = -1;</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;      }</div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;   }</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> = pthread_self(); <span class="comment">/* let new events wake up this thread */</span></div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Starting waiting for an event!\n&quot;</span>);</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; timeout || timeout &lt; 0; x++) {</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d90/linkedlists_8h.html#a5c021d1e034a53d09360da4d95c76220">AST_RWLIST_NEXT</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a>, eq_next)) {</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;         needexit = 1;</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;      }</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a>) {</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;         needexit = 1;</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;      }</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;      <span class="comment">/* We can have multiple HTTP session point to the same mansession entry.</span></div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;<span class="comment">       * The way we deal with it is not very nice: newcomers kick out the previous</span></div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;<span class="comment">       * HTTP session. XXX this needs to be improved.</span></div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> != pthread_self()) {</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;         needexit = 1;</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;      }</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;      <span class="keywordflow">if</span> (needexit) {</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;      }</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == 0) {   <span class="comment">/* AMI session */</span></div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a60404ef44696316455e79c3a002cc71e">ast_wait_for_input</a>(<a class="code" href="../../dd/d27/iostream_8h.html#a6ebb2730257107d3535fe6cb1285f479">ast_iostream_get_fd</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>), 1000)) {</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;         }</div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;      } <span class="keywordflow">else</span> { <span class="comment">/* HTTP session */</span></div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;         sleep(1);</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;      }</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;   }</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Finished waiting for an event!\n&quot;</span>);</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> == pthread_self()) {</div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *eqe = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a>;</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga26805df02a1c92688ae132f29ac4478a">astman_send_response</a>(s, m, <span class="stringliteral">&quot;Success&quot;</span>, <span class="stringliteral">&quot;Waiting for Event completed.&quot;</span>);</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;      <span class="keywordflow">while</span> ((eqe = <a class="code" href="../../df/d72/group__Group__AMI.html#ga2d71cf4726fe666194a3473e39782abe">advance_event</a>(eqe))) {</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;         <span class="keywordflow">if</span> (((s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> &amp; eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>) == eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>)</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;            &amp;&amp; ((s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> &amp; eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>) == eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>)</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;            &amp;&amp; <a class="code" href="../../df/d72/group__Group__AMI.html#gad40bb264275fb647b2044b47ac533dad">match_filter</a>(s, eqe-&gt;eventdata)) {</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;%s&quot;</span>, eqe-&gt;eventdata);</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;         }</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;         s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a> = eqe;</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;      }</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s,</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;         <span class="stringliteral">&quot;Event: WaitEventComplete\r\n&quot;</span></div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;         <span class="stringliteral">&quot;\r\n&quot;</span>, idText);</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Abandoning event request!\n&quot;</span>);</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;   }</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;}</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;</div><div class="line"><a name="l04324"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2cf03665d072e22c68953f8dadc65690"> 4324</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cf03665d072e22c68953f8dadc65690">action_listcommands</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;{</div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *cur;</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *temp = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b">MAX_AUTH_PERM_STRING</a>);</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, cur, list) {</div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> &amp; cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">authority</a>) || cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">authority</a> == 0) {</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;%s: %s (Priv: %s)\r\n&quot;</span>,</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;            cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa403beb670a3277f542647cc9aa22137">synopsis</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga57cc8b67a0e4797ab1a608872d51d397">authority_to_str</a>(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">authority</a>, &amp;temp));</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;      }</div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;   }</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;}</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;</div><div class="line"><a name="l04343"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga954eccb4f48bd6797ba65a9cada6446a"> 4343</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga954eccb4f48bd6797ba65a9cada6446a">action_events</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;{</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *mask = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;EventMask&quot;</span>);</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;   <span class="keywordtype">int</span> res, x;</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;   <span class="keywordtype">char</span> id_text[256];</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;      snprintf(id_text, <span class="keyword">sizeof</span>(id_text), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;      id_text[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;   }</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;   res = <a class="code" href="../../df/d72/group__Group__AMI.html#gab7a51272a96fcd2792382b4d0bf254f6">set_eventmask</a>(s, mask);</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gab362ced8cd2bc839a9a1782ae31a9166">broken_events_action</a>) {</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;      <span class="comment">/* if this option is set we should not return a response on</span></div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;<span class="comment">       * error, or when all events are set */</span></div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <span class="keywordflow">if</span> (res &gt; 0) {</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;         <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>); x++) {</div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[x].label, <span class="stringliteral">&quot;all&quot;</span>) &amp;&amp; res == <a class="code" href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a>[x].<a class="code" href="../../de/d4b/structpermalias.html#a86cf672daa4e0ad11ad10efc894d19c8">num</a>) {</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;               <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;            }</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;         }</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n%s&quot;</span></div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                <span class="stringliteral">&quot;Events: On\r\n\r\n&quot;</span>, id_text);</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == 0)</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n%s&quot;</span></div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                <span class="stringliteral">&quot;Events: Off\r\n\r\n&quot;</span>, id_text);</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;   }</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;   <span class="keywordflow">if</span> (res &gt; 0)</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n%s&quot;</span></div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;             <span class="stringliteral">&quot;Events: On\r\n\r\n&quot;</span>, id_text);</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == 0)</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n%s&quot;</span></div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;             <span class="stringliteral">&quot;Events: Off\r\n\r\n&quot;</span>, id_text);</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid event mask&quot;</span>);</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;}</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;</div><div class="line"><a name="l04387"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga70e9f0abcbf6c0aca44ad6e3f941c266"> 4387</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga70e9f0abcbf6c0aca44ad6e3f941c266">action_logoff</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;{</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga26805df02a1c92688ae132f29ac4478a">astman_send_response</a>(s, m, <span class="stringliteral">&quot;Goodbye&quot;</span>, <span class="stringliteral">&quot;Thanks for all the fish.&quot;</span>);</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;   <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;}</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;</div><div class="line"><a name="l04393"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga446d7b8021ecd45234cd3053734c9d53"> 4393</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga446d7b8021ecd45234cd3053734c9d53">action_login</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;{</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;   <span class="comment">/* still authenticated - don&#39;t process again */</span></div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Already authenticated&quot;</span>);</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;   }</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gac0f21735eb8551ed24735a71ea26e13c">authenticate</a>(s, m)) {</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;      sleep(1);</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Authentication failed&quot;</span>);</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;   }</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a> = 1;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a>, -1);</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010">manager_displayconnects</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>)) {</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;%sManager &#39;%s&#39; logged on from %s\n&quot;</span>, (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> ? <span class="stringliteral">&quot;HTTP &quot;</span> : <span class="stringliteral">&quot;&quot;</span>), s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;   }</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Authentication accepted&quot;</span>);</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;   <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> &amp; <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>)</div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;      &amp;&amp; (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> &amp; <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>)</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;      &amp;&amp; <a class="code" href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a>(&amp;<a class="code" href="../../d6/dd6/group__main__options.html#gaa5dba371db31dc4ebecdff7c929ff263">ast_options</a>, <a class="code" href="../../d6/dd6/group__main__options.html#gaf2588453b3a373a770741ad3ce353343ade4cf3231c69af57ad0527bd46244680">AST_OPT_FLAG_FULLY_BOOTED</a>)) {</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *auth = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b">MAX_AUTH_PERM_STRING</a>);</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *cat_str = <a class="code" href="../../df/d72/group__Group__AMI.html#ga57cc8b67a0e4797ab1a608872d51d397">authority_to_str</a>(<a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, &amp;auth);</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;      <span class="keywordtype">long</span> uptime = 0;</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;      <span class="keywordtype">long</span> lastreloaded = 0;</div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;      <span class="keyword">struct </span>timeval <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;      <span class="keyword">struct </span>timeval curtime = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5b/options_8h.html#acd462f81fa607939af36a9fa33cdbf9d">ast_startuptime</a>.tv_sec) {</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;         tmp = <a class="code" href="../../de/df7/time_8h.html#aa13b651c18bc6004cab21ac041d44dd8">ast_tvsub</a>(curtime, <a class="code" href="../../d7/d5b/options_8h.html#acd462f81fa607939af36a9fa33cdbf9d">ast_startuptime</a>);</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;         uptime = tmp.tv_sec;</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;      }</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5b/options_8h.html#a7cdafc5a121e87659887ffc9abe36760">ast_lastreloadtime</a>.tv_sec) {</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;         tmp = <a class="code" href="../../de/df7/time_8h.html#aa13b651c18bc6004cab21ac041d44dd8">ast_tvsub</a>(curtime, <a class="code" href="../../d7/d5b/options_8h.html#a7cdafc5a121e87659887ffc9abe36760">ast_lastreloadtime</a>);</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;         lastreloaded = tmp.tv_sec;</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;      }</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Event: FullyBooted\r\n&quot;</span></div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;         <span class="stringliteral">&quot;Privilege: %s\r\n&quot;</span></div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;         <span class="stringliteral">&quot;Uptime: %ld\r\n&quot;</span></div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;         <span class="stringliteral">&quot;LastReload: %ld\r\n&quot;</span></div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;         <span class="stringliteral">&quot;Status: Fully Booted\r\n\r\n&quot;</span>, cat_str, uptime, lastreloaded);</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;   }</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;}</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;</div><div class="line"><a name="l04442"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gade12539a3e517752ad60fef428394532"> 4442</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gade12539a3e517752ad60fef428394532">action_challenge</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;{</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *authtype = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;AuthType&quot;</span>);</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(authtype, <span class="stringliteral">&quot;MD5&quot;</span>)) {</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>)) {</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;         snprintf(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>, <span class="keyword">sizeof</span>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>), <span class="stringliteral">&quot;%ld&quot;</span>, <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>());</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;      }</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Challenge: %s\r\n\r\n&quot;</span>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">challenge</a>);</div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Must specify AuthType&quot;</span>);</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;   }</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;}</div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;</div><div class="line"><a name="l04460"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2b80579f3d94f43d2e7def7add35dc61"> 4460</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2b80579f3d94f43d2e7def7add35dc61">action_hangup</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;{</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;   <span class="keywordtype">int</span> causecode = 0; <span class="comment">/* all values &lt;= 0 mean &#39;do not set hangupcause in channel&#39; */</span></div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *name_or_regex = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *cause = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Cause&quot;</span>);</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;   <span class="keywordtype">char</span> idText[256];</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;   regex_t regexbuf;</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structast__channel__iterator.html">ast_channel_iterator</a> *iter = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *regex_string;</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;   <span class="keywordtype">int</span> channels_matched = 0;</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name_or_regex)) {</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No channel specified&quot;</span>);</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;   }</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;      idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;   }</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cause)) {</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      <span class="keywordtype">char</span> *endptr;</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      causecode = strtol(cause, &amp;endptr, 10);</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;      <span class="keywordflow">if</span> (causecode &lt; 0 || causecode &gt; 127 || *endptr != <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Invalid &#39;Cause: %s&#39; in manager action Hangup\n&quot;</span>, cause);</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;         <span class="comment">/* keep going, better to hangup without cause than to not hang up at all */</span></div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;         causecode = 0; <span class="comment">/* do not set channel&#39;s hangupcause */</span></div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;      }</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;   }</div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;   <span class="comment">/************************************************/</span></div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;   <span class="comment">/* Regular explicit match channel byname hangup */</span></div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;   <span class="keywordflow">if</span> (name_or_regex[0] != <span class="charliteral">&#39;/&#39;</span>) {</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;      <span class="keywordflow">if</span> (!(c = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name_or_regex))) {</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Request to hangup non-existent channel: %s\n&quot;</span>,</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;            name_or_regex);</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such channel&quot;</span>);</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;      }</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%sManager &#39;%s&#39; from %s, hanging up channel: %s\n&quot;</span>,</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;         (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> ? <span class="stringliteral">&quot;HTTP &quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;         s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;         <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>),</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c));</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a7c3d40097bb8c0da518564d38ab49506">ast_channel_softhangup_withcause_locked</a>(c, causecode);</div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;      c = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(c);</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;</div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Channel Hungup&quot;</span>);</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;</div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;   }</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;   <span class="comment">/***********************************************/</span></div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;   <span class="comment">/* find and hangup any channels matching regex */</span></div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;   regex_string = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(strlen(name_or_regex));</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;   <span class="keywordflow">if</span> (!regex_string) {</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Memory Allocation Failure&quot;</span>);</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;   }</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;   <span class="comment">/* Make &quot;/regex/&quot; into &quot;regex&quot; */</span></div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#af7a2c1bf0a98df4a52ee48a9d9e25510">ast_regex_string_to_regex_pattern</a>(name_or_regex, &amp;regex_string) != 0) {</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Regex format invalid, Channel param should be /regex/&quot;</span>);</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(regex_string);</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;   }</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;   <span class="comment">/* if regex compilation fails, hangup fails */</span></div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;   <span class="keywordflow">if</span> (regcomp(&amp;regexbuf, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(regex_string), REG_EXTENDED | REG_NOSUB)) {</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga352d583ea36240124638e5c1db088227">astman_send_error_va</a>(s, m, <span class="stringliteral">&quot;Regex compile failed on: %s&quot;</span>, name_or_regex);</div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(regex_string);</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;   }</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Channels hung up will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;   iter = <a class="code" href="../../d5/d7b/channel_8h.html#aae1445ed63630123081206e3de5b7b1a">ast_channel_iterator_all_new</a>();</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;   <span class="keywordflow">if</span> (iter) {</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;      <span class="keywordflow">for</span> (; (c = <a class="code" href="../../d5/d7b/channel_8h.html#ab0eadbfdcbdad2c0e8927900ec9b98d5">ast_channel_iterator_next</a>(iter)); <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(c)) {</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;         <span class="keywordflow">if</span> (regexec(&amp;regexbuf, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c), 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;         }</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(3, <span class="stringliteral">&quot;%sManager &#39;%s&#39; from %s, hanging up channel: %s\n&quot;</span>,</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;            (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> ? <span class="stringliteral">&quot;HTTP &quot;</span> : <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;            s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>,</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;            <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>),</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;            <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c));</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a7c3d40097bb8c0da518564d38ab49506">ast_channel_softhangup_withcause_locked</a>(c, causecode);</div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;         channels_matched++;</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s,</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;            <span class="stringliteral">&quot;Event: ChannelHungup\r\n&quot;</span></div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;            <span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;            <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;            <span class="stringliteral">&quot;\r\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(c), idText);</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;      }</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a256993c64e12e420aa141c07363db3ef">ast_channel_iterator_destroy</a>(iter);</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;   }</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;   regfree(&amp;regexbuf);</div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(regex_string);</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac9d1d485a1911880e31a3537223b3f9c">astman_send_list_complete</a>(s, m, <span class="stringliteral">&quot;ChannelsHungupListComplete&quot;</span>, channels_matched);</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;}</div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;</div><div class="line"><a name="l04577"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga0063f7b7d4976f533e64e98503e535aa"> 4577</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga0063f7b7d4976f533e64e98503e535aa">action_setvar</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;{</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *varname = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Variable&quot;</span>);</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *varval = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Value&quot;</span>);</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(varname)) {</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No variable specified&quot;</span>);</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;   }</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;      <span class="keywordflow">if</span> (!(c = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name))) {</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such channel&quot;</span>);</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;      }</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;   }</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;   res = <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(c, varname, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(varval, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;</div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;   <span class="keywordflow">if</span> (c) {</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;      c = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(c);</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;   }</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;   <span class="keywordflow">if</span> (res == 0) {</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Variable Set&quot;</span>);</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Variable not set&quot;</span>);</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;   }</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;}</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;</div><div class="line"><a name="l04610"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga46026a8e1dfda56ac9dc23cd31515def"> 4610</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga46026a8e1dfda56ac9dc23cd31515def">action_getvar</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;{</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *varname = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Variable&quot;</span>);</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;   <span class="keywordtype">char</span> *varval;</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;   <span class="keywordtype">char</span> workspace[1024];</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(varname)) {</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No variable specified&quot;</span>);</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;   }</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;   <span class="comment">/* We don&#39;t want users with insufficient permissions using certain functions. */</span></div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa497adca1647f8add683cd71799fc015">function_capable_string_allowed_with_auths</a>(varname, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>))) {</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;GetVar Access Forbidden: Variable&quot;</span>);</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;   }</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      <span class="keywordflow">if</span> (!(c = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name))) {</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such channel&quot;</span>);</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      }</div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;   }</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;   workspace[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;   <span class="keywordflow">if</span> (varname[strlen(varname) - 1] == <span class="charliteral">&#39;)&#39;</span>) {</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;      <span class="keywordflow">if</span> (!c) {</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;         c = <a class="code" href="../../d5/d7b/channel_8h.html#acc0ae2c008f4157736ef290e9ca62572">ast_dummy_channel_alloc</a>();</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;         <span class="keywordflow">if</span> (c) {</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;            <a class="code" href="../../db/de0/pbx_8h.html#aa4e9618aa036a586af7d7663afd9b507">ast_func_read</a>(c, (<span class="keywordtype">char</span> *) varname, workspace, <span class="keyword">sizeof</span>(workspace));</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;         } <span class="keywordflow">else</span></div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to allocate bogus channel for variable substitution.  Function results may be blank.\n&quot;</span>);</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#aa4e9618aa036a586af7d7663afd9b507">ast_func_read</a>(c, (<span class="keywordtype">char</span> *) varname, workspace, <span class="keyword">sizeof</span>(workspace));</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;      }</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      varval = workspace;</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#aaf906a18ba2dcd53c35f59869757521f">pbx_retrieve_variable</a>(c, varname, &amp;varval, workspace, <span class="keyword">sizeof</span>(workspace), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;   }</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;   <span class="keywordflow">if</span> (c) {</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;      c = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(c);</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;   }</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Variable: %s\r\nValue: %s\r\n\r\n&quot;</span>, varname, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(varval, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;</div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;}</div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;</div><div class="line"><a name="l04662"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga3256471530910751d20fa34e435c7575"> 4662</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga3256471530910751d20fa34e435c7575">generate_status</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keywordtype">char</span> **vars, <span class="keywordtype">int</span> varc, <span class="keywordtype">int</span> all_variables, <span class="keywordtype">char</span> *id_text, <span class="keywordtype">int</span> *count)</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;{</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;   <span class="keyword">struct </span>timeval now;</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;   <span class="keywordtype">long</span> elapsed_seconds;</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d84/structast__bridge.html">ast_bridge</a> *bridge;</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, variable_str, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *write_transpath = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(256);</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *read_transpath = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(256);</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *codec_buf = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a>);</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d1/dcb/structast__party__id.html">ast_party_id</a> effective_id;</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *, snapshot,</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;      <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan)),</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *, snapshot_str, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>);</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;   <span class="keywordflow">if</span> (!snapshot) {</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;   }</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;   snapshot_str = <a class="code" href="../../db/d45/manager_8h.html#a777cde87d12b331902f862ec44641688">ast_manager_build_channel_state_string</a>(snapshot);</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;   <span class="keywordflow">if</span> (!snapshot_str) {</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;   }</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;   <span class="keywordflow">if</span> (all_variables) {</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;      variable_str = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(2048);</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;      variable_str = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(1024);</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;   }</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;   <span class="keywordflow">if</span> (!variable_str) {</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;   }</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;</div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;   now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;   elapsed_seconds = <a class="code" href="../../de/df7/time_8h.html#a39af1febe8b93cb6f7cd59b76fc39e8f">ast_tvdiff_sec</a>(now, <a class="code" href="../../d5/d7b/channel_8h.html#a8873859a4dbc3d0d053d696667e49012">ast_channel_creationtime</a>(chan));</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;   <span class="comment">/* Even if all_variables has been specified, explicitly requested variables</span></div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;<span class="comment">    * may be global variables or dialplan functions */</span></div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; varc; i++) {</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;      <span class="keywordtype">char</span> valbuf[512], *ret = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      <span class="keywordflow">if</span> (vars[i][strlen(vars[i]) - 1] == <span class="charliteral">&#39;)&#39;</span>) {</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../db/de0/pbx_8h.html#aa4e9618aa036a586af7d7663afd9b507">ast_func_read</a>(chan, vars[i], valbuf, <span class="keyword">sizeof</span>(valbuf)) &lt; 0) {</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;            valbuf[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;         }</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;         ret = valbuf;</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#aaf906a18ba2dcd53c35f59869757521f">pbx_retrieve_variable</a>(chan, vars[i], &amp;ret, valbuf, <span class="keyword">sizeof</span>(valbuf), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;      }</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;variable_str, 0, <span class="stringliteral">&quot;Variable: %s=%s\r\n&quot;</span>, vars[i], ret);</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;   }</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;   <span class="comment">/* Walk all channel variables and add them */</span></div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;   <span class="keywordflow">if</span> (all_variables) {</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d7d/structast__var__t.html">ast_var_t</a> *variables;</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(<a class="code" href="../../d5/d7b/channel_8h.html#add6255866ea1651a90cf70d963c4920a">ast_channel_varshead</a>(chan), variables, entries) {</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;variable_str, 0, <span class="stringliteral">&quot;Variable: %s=%s\r\n&quot;</span>,</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;            <a class="code" href="../../d9/de7/chanvars_8h.html#a356a31cd608ec07d3668dcd589be49d8">ast_var_name</a>(variables), <a class="code" href="../../d9/de7/chanvars_8h.html#a8e0081172db71c5021d20706c50d959c">ast_var_value</a>(variables));</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;      }</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;   }</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;   bridge = <a class="code" href="../../d5/d7b/channel_8h.html#a557663006d52a9cdc11f42602bf48326">ast_channel_get_bridge</a>(chan);</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;   effective_id = <a class="code" href="../../d5/d7b/channel_8h.html#abd6165fa9617e1bb5efee3befa3e963d">ast_channel_connected_effective_id</a>(chan);</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s,</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;      <span class="stringliteral">&quot;Event: Status\r\n&quot;</span></div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;      <span class="stringliteral">&quot;Privilege: Call\r\n&quot;</span></div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      <span class="stringliteral">&quot;Type: %s\r\n&quot;</span></div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;      <span class="stringliteral">&quot;DNID: %s\r\n&quot;</span></div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;      <span class="stringliteral">&quot;EffectiveConnectedLineNum: %s\r\n&quot;</span></div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;      <span class="stringliteral">&quot;EffectiveConnectedLineName: %s\r\n&quot;</span></div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;      <span class="stringliteral">&quot;TimeToHangup: %ld\r\n&quot;</span></div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      <span class="stringliteral">&quot;BridgeID: %s\r\n&quot;</span></div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      <span class="stringliteral">&quot;Application: %s\r\n&quot;</span></div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;      <span class="stringliteral">&quot;Data: %s\r\n&quot;</span></div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;      <span class="stringliteral">&quot;Nativeformats: %s\r\n&quot;</span></div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;      <span class="stringliteral">&quot;Readformat: %s\r\n&quot;</span></div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;      <span class="stringliteral">&quot;Readtrans: %s\r\n&quot;</span></div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      <span class="stringliteral">&quot;Writeformat: %s\r\n&quot;</span></div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;      <span class="stringliteral">&quot;Writetrans: %s\r\n&quot;</span></div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;      <span class="stringliteral">&quot;Callgroup: %llu\r\n&quot;</span></div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;      <span class="stringliteral">&quot;Pickupgroup: %llu\r\n&quot;</span></div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      <span class="stringliteral">&quot;Seconds: %ld\r\n&quot;</span></div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;      <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;      <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(snapshot_str),</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af5dee96d4dcc88a95fce391c22d4d21f">ast_channel_tech</a>(chan)-&gt;<a class="code" href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a>,</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a>(chan)-&gt;<a class="code" href="../../d6/d49/structnumber.html">number</a>.str, <span class="stringliteral">&quot;&quot;</span>),</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(effective_id.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, effective_id.<a class="code" href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">number</a>.<a class="code" href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a>(effective_id.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">valid</a>, effective_id.<a class="code" href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">name</a>.<a class="code" href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">str</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;      (<span class="keywordtype">long</span>)<a class="code" href="../../d5/d7b/channel_8h.html#ae616309e9eba6a1b009a0466bada50cc">ast_channel_whentohangup</a>(chan)-&gt;tv_sec,</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;      bridge ? bridge-&gt;<a class="code" href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">uniqueid</a> : <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ac8b850ff95f945ad6cfeb2942799800a">ast_channel_appl</a>(chan),</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a531fd832a2f8b0f4156735043a6158e1">ast_channel_data</a>(chan),</div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;      <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a>(chan), &amp;codec_buf),</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;      <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a>(chan)),</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;      <a class="code" href="../../db/d39/translate_8h.html#a33934307055c00738d6166ad82550711">ast_translate_path_to_str</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a6b4548259e61f691c654aed0025e5502">ast_channel_readtrans</a>(chan), &amp;read_transpath),</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;      <a class="code" href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a>(chan)),</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;      <a class="code" href="../../db/d39/translate_8h.html#a33934307055c00738d6166ad82550711">ast_translate_path_to_str</a>(<a class="code" href="../../d5/d7b/channel_8h.html#ab5c41a2130385cadf78c64cacea7e3f9">ast_channel_writetrans</a>(chan), &amp;write_transpath),</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#abd38558261afd18f7c08f05b89625313">ast_channel_callgroup</a>(chan),</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a5812578dedc2371e255eec8503bd50d6">ast_channel_pickupgroup</a>(chan),</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;      (<span class="keywordtype">long</span>)elapsed_seconds,</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(variable_str),</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;      id_text);</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;   ++*count;</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(bridge);</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;}</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;<span class="comment">/*! \brief Manager &quot;status&quot; command to show channels */</span></div><div class="line"><a name="l04777"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gad16a64f7db4f1fdc0326f086152ed584"> 4777</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad16a64f7db4f1fdc0326f086152ed584">action_status</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;{</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *chan_variables = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Variables&quot;</span>);</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *all_chan_variables = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;AllVariables&quot;</span>);</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;   <span class="keywordtype">int</span> all_variables = 0;</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;   <span class="keywordtype">char</span> *variables = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(chan_variables, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan;</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a> = 0;</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;   <span class="keywordtype">int</span> all = <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name); <span class="comment">/* set if we want all channels */</span></div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;   <span class="keywordtype">char</span> id_text[256];</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structast__channel__iterator.html">ast_channel_iterator</a> *it_chans = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(vars,</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(name)[100];</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;   );</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;</div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(all_chan_variables)) {</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;      all_variables = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(all_chan_variables);</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;   }</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;   <span class="keywordflow">if</span> (!(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa497adca1647f8add683cd71799fc015">function_capable_string_allowed_with_auths</a>(variables, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>))) {</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Status Access Forbidden: Variables&quot;</span>);</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;   }</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;   <span class="keywordflow">if</span> (all) {</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;      <span class="keywordflow">if</span> (!(it_chans = <a class="code" href="../../d5/d7b/channel_8h.html#aae1445ed63630123081206e3de5b7b1a">ast_channel_iterator_all_new</a>())) {</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Memory Allocation Failure&quot;</span>);</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;      }</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab0eadbfdcbdad2c0e8927900ec9b98d5">ast_channel_iterator_next</a>(it_chans);</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name);</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;      <span class="keywordflow">if</span> (!chan) {</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such channel&quot;</span>);</div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      }</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;   }</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Channel status will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;      snprintf(id_text, <span class="keyword">sizeof</span>(id_text), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;      id_text[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;   }</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(chan_variables)) {</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(vars, variables);</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;   }</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;   <span class="comment">/* if we look by name, we break after the first iteration */</span></div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;   <span class="keywordflow">for</span> (; chan; all ? chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab0eadbfdcbdad2c0e8927900ec9b98d5">ast_channel_iterator_next</a>(it_chans) : 0) {</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga3256471530910751d20fa34e435c7575">generate_status</a>(s, chan, vars.name, vars.argc, all_variables, id_text, &amp;channels);</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;   }</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;   <span class="keywordflow">if</span> (it_chans) {</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a256993c64e12e420aa141c07363db3ef">ast_channel_iterator_destroy</a>(it_chans);</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;   }</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a>(s, m, <span class="stringliteral">&quot;StatusComplete&quot;</span>, channels);</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Items: %d\r\n&quot;</span>, channels);</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a>(s);</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;}</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;<span class="comment"> * \brief Queue a given read action containing a payload onto a channel</span></div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;<span class="comment"> * This queues a READ_ACTION control frame that contains a given &quot;payload&quot;, or</span></div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;<span class="comment"> * data to be triggered and handled on the channel&#39;s read side. This ensures</span></div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;<span class="comment"> * the &quot;action&quot; is handled by the channel&#39;s media reading thread.</span></div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;<span class="comment"> * \param chan The channel to queue the action on</span></div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;<span class="comment"> * \param payload The read action&#39;s payload</span></div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;<span class="comment"> * \param payload_size The size of the given payload</span></div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;<span class="comment"> * \param action The type of read action to queue</span></div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="comment"> * \return -1 on error, 0 on success</span></div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04864"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga1fbdb833cde8f5286f6671033665a2aa"> 4864</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1fbdb833cde8f5286f6671033665a2aa">queue_read_action_payload</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *payload,</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;   <span class="keywordtype">size_t</span> payload_size, <span class="keyword">enum</span> <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a2457835b26aa09c41c6ecf633f95f775">ast_frame_read_action</a> action)</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;{</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d4b/structast__control__read__action__payload.html">ast_control_read_action_payload</a> *obj;</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;   <span class="keywordtype">size_t</span> obj_size;</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;   obj_size = payload_size + <span class="keyword">sizeof</span>(*obj);</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;   obj = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(obj_size);</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;   <span class="keywordflow">if</span> (!obj) {</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;   }</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;   obj-&gt;action = action;</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;   obj-&gt;payload_size = payload_size;</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;   memcpy(obj-&gt;payload, payload, payload_size);</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;   res = <a class="code" href="../../d5/d7b/channel_8h.html#a7e5e15c22564fd66351d332ad10658b5">ast_queue_control_data</a>(chan, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a7c6096b70aeb9e6b2b4f9ee5cfccbf7a">AST_CONTROL_READ_ACTION</a>, obj, obj_size);</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(obj);</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;}</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;<span class="comment"> * \brief Queue a read action to send a text message</span></div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;<span class="comment"> * \param chan The channel to queue the action on</span></div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;<span class="comment"> * \param body The body of the message</span></div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;<span class="comment"> * \return -1 on error, 0 on success</span></div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04896"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gadc51d8d2531d72d735b5f270db27de72"> 4896</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gadc51d8d2531d72d735b5f270db27de72">queue_sendtext</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *body)</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;{</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1fbdb833cde8f5286f6671033665a2aa">queue_read_action_payload</a>(chan, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)body,</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;      strlen(body) + 1, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a2457835b26aa09c41c6ecf633f95f775a4b2dcef6c6da53104278190e521d7b1c">AST_FRAME_READ_ACTION_SEND_TEXT</a>);</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;}</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;<span class="comment"> * \brief Queue a read action to send a text data message</span></div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;<span class="comment"> * \param chan The channel to queue the action on</span></div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;<span class="comment"> * \param body The body of the message</span></div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;<span class="comment"> * \param content_type The message&#39;s content type</span></div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;<span class="comment"> * \return -1 on error, 0 on success</span></div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04911"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa010c027e6c7d2c2082482526a2eed06"> 4911</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa010c027e6c7d2c2082482526a2eed06">queue_sendtext_data</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *body,</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *content_type)</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;{</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d44/structast__msg__data.html">ast_msg_data</a> *obj;</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;   obj = <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gac19d5671ce7ad4db2a7df0d4784d4cd3">ast_msg_data_alloc2</a>(<a class="code" href="../../d8/d0e/group__ast__msg__data.html#gga8e03c05d9a579130cae1af412fb6c580a711186ed6f4afa0cccc12908e40c511d">AST_MSG_DATA_SOURCE_TYPE_UNKNOWN</a>,</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;                     <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, content_type, body);</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;   <span class="keywordflow">if</span> (!obj) {</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;   }</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;</div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;   res = <a class="code" href="../../df/d72/group__Group__AMI.html#ga1fbdb833cde8f5286f6671033665a2aa">queue_read_action_payload</a>(chan, (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)obj,</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;      <a class="code" href="../../d8/d0e/group__ast__msg__data.html#gafe0003d5c882180061f9da68d89840c5">ast_msg_data_get_length</a>(obj), <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a2457835b26aa09c41c6ecf633f95f775a9e8b2eb87931f7565311b556a32e6993">AST_FRAME_READ_ACTION_SEND_TEXT_DATA</a>);</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(obj);</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;}</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;</div><div class="line"><a name="l04930"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga1c6842f7ec1925c46db96beaaf8d24b1"> 4930</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1c6842f7ec1925c46db96beaaf8d24b1">action_sendtext</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;{</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *textmsg = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Message&quot;</span>);</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *content_type = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Content-Type&quot;</span>);</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No channel specified&quot;</span>);</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;   }</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(textmsg)) {</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No Message specified&quot;</span>);</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;   }</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;   c = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name);</div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;   <span class="keywordflow">if</span> (!c) {</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such channel&quot;</span>);</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;   }</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;<span class="comment">    * If the &quot;extra&quot; data is not available, then send using &quot;string&quot; only.</span></div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;<span class="comment">    * Doing such maintains backward compatibilities.</span></div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;   res = <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(content_type) ? <a class="code" href="../../df/d72/group__Group__AMI.html#gadc51d8d2531d72d735b5f270db27de72">queue_sendtext</a>(c, textmsg) :</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gaa010c027e6c7d2c2082482526a2eed06">queue_sendtext_data</a>(c, textmsg, content_type);</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(c);</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;   <span class="keywordflow">if</span> (res &gt;= 0) {</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Success&quot;</span>);</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Failure&quot;</span>);</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;   }</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;}</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;<span class="comment"></span></div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;<span class="comment">/*! \brief  action_redirect: The redirect manager command */</span></div><div class="line"><a name="l04973"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga97662516a5cd49e552cf9d2e30987aac"> 4973</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga97662516a5cd49e552cf9d2e30987aac">action_redirect</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;{</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[256];</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *name2 = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ExtraChannel&quot;</span>);</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Exten&quot;</span>);</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *exten2 = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ExtraExten&quot;</span>);</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Context&quot;</span>);</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *context2 = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ExtraContext&quot;</span>);</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Priority&quot;</span>);</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *priority2 = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ExtraPriority&quot;</span>);</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan;</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan2;</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;   <span class="keywordtype">int</span> pi = 0;</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;   <span class="keywordtype">int</span> pi2 = 0;</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;   <span class="keywordtype">int</span> chan1_wait = 0;</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;   <span class="keywordtype">int</span> chan2_wait = 0;</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Channel not specified&quot;</span>);</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;   }</div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(context)) {</div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Context not specified&quot;</span>);</div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;   }</div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(exten)) {</div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Exten not specified&quot;</span>);</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;   }</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(priority)) {</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Priority not specified&quot;</span>);</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;   }</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;   <span class="keywordflow">if</span> (sscanf(priority, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;pi) != 1) {</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;      pi = <a class="code" href="../../db/de0/pbx_8h.html#a0be9518646cf9aca4878b313cc02e901">ast_findlabel_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context, exten, priority, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;   }</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;   <span class="keywordflow">if</span> (pi &lt; 1) {</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Priority is invalid&quot;</span>);</div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;   }</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name2) &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(context2)) {</div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;      <span class="comment">/* We have an ExtraChannel and an ExtraContext */</span></div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(exten2)) {</div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;ExtraExten not specified&quot;</span>);</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;      }</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(priority2)) {</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;ExtraPriority not specified&quot;</span>);</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      }</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      <span class="keywordflow">if</span> (sscanf(priority2, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;pi2) != 1) {</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;         pi2 = <a class="code" href="../../db/de0/pbx_8h.html#a0be9518646cf9aca4878b313cc02e901">ast_findlabel_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context2, exten2, priority2, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      }</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      <span class="keywordflow">if</span> (pi2 &lt; 1) {</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;ExtraPriority is invalid&quot;</span>);</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;      }</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;   }</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;   chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name);</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;   <span class="keywordflow">if</span> (!chan) {</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;      snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;Channel does not exist: %s&quot;</span>, name);</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, buf);</div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;   }</div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a>(chan)) {</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Redirect failed, channel not up.&quot;</span>);</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;   }</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name2)) {</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;      <span class="comment">/* Single channel redirect in progress. */</span></div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;      res = <a class="code" href="../../db/de0/pbx_8h.html#ae0ba2eb966a9e3376de61d30513f7302">ast_async_goto</a>(chan, context, exten, pi);</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Redirect successful&quot;</span>);</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Redirect failed&quot;</span>);</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;      }</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;   }</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;   chan2 = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name2);</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;   <span class="keywordflow">if</span> (!chan2) {</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;      snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;ExtraChannel does not exist: %s&quot;</span>, name2);</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, buf);</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;   }</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a>(chan2)) {</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Redirect failed, extra channel not up.&quot;</span>);</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;      chan2 = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan2);</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;   }</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;   <span class="comment">/* Dual channel redirect in progress. */</span></div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#aa0a52e573af67cb0f29095177128d186">ast_channel_is_bridged</a>(chan)) {</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(chan), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a21a03514eb4882151cf8768f6f9cd7ec">AST_FLAG_BRIDGE_DUAL_REDIRECT_WAIT</a>);</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;      chan1_wait = 1;</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;   }</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan2);</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d7b/channel_8h.html#aa0a52e573af67cb0f29095177128d186">ast_channel_is_bridged</a>(chan2)) {</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a>(<a class="code" href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a>(chan2), <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a21a03514eb4882151cf8768f6f9cd7ec">AST_FLAG_BRIDGE_DUAL_REDIRECT_WAIT</a>);</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;      chan2_wait = 1;</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;   }</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan2);</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;   res = <a class="code" href="../../db/de0/pbx_8h.html#ae0ba2eb966a9e3376de61d30513f7302">ast_async_goto</a>(chan, context, exten, pi);</div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(context2)) {</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;         res = <a class="code" href="../../db/de0/pbx_8h.html#ae0ba2eb966a9e3376de61d30513f7302">ast_async_goto</a>(chan2, context2, exten2, pi2);</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;         res = <a class="code" href="../../db/de0/pbx_8h.html#ae0ba2eb966a9e3376de61d30513f7302">ast_async_goto</a>(chan2, context, exten, pi);</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;      }</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;      <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Dual Redirect successful&quot;</span>);</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Secondary redirect failed&quot;</span>);</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;      }</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Redirect failed&quot;</span>);</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;   }</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;   <span class="comment">/* Release the bridge wait. */</span></div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;   <span class="keywordflow">if</span> (chan1_wait) {</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(chan, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a21a03514eb4882151cf8768f6f9cd7ec">AST_FLAG_BRIDGE_DUAL_REDIRECT_WAIT</a>);</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;   }</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;   <span class="keywordflow">if</span> (chan2_wait) {</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a>(chan2, <a class="code" href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a21a03514eb4882151cf8768f6f9cd7ec">AST_FLAG_BRIDGE_DUAL_REDIRECT_WAIT</a>);</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;   }</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;   chan2 = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan2);</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;   chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;}</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;</div><div class="line"><a name="l05118"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga4b7f596668f285bb55c2ba939a20f9d2"> 5118</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga4b7f596668f285bb55c2ba939a20f9d2">action_blind_transfer</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;{</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Exten&quot;</span>);</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Context&quot;</span>);</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan;</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No channel specified&quot;</span>);</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;   }</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(exten)) {</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No extension specified&quot;</span>);</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;   }</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;   chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name);</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;   <span class="keywordflow">if</span> (!chan) {</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Channel specified does not exist&quot;</span>);</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;   }</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(context)) {</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;      context = <a class="code" href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a>(chan);</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;   }</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="../../d4/d56/bridge_8h.html#a982e0e652b9f03abf1ec584c137791a3">ast_bridge_transfer_blind</a>(1, chan, exten, context, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da">AST_BRIDGE_TRANSFER_NOT_PERMITTED</a>:</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Transfer not permitted&quot;</span>);</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a>:</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Transfer invalid&quot;</span>);</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a>:</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Transfer failed&quot;</span>);</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a>:</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Transfer succeeded&quot;</span>);</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;   }</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;}</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;</div><div class="line"><a name="l05164"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2dfc6e6a7c0200c34dbbc6021f10c649"> 5164</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2dfc6e6a7c0200c34dbbc6021f10c649">action_atxfer</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;{</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Exten&quot;</span>);</div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Context&quot;</span>);</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;   <span class="keywordtype">char</span> feature_code[<a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html#a57cae4c5040ce0791d0b4798193fc47f">AST_FEATURE_MAX_LEN</a>];</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No channel specified&quot;</span>);</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;   }</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(exten)) {</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No extension specified&quot;</span>);</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;   }</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;   <span class="keywordflow">if</span> (!(chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name))) {</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Channel specified does not exist&quot;</span>);</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;   }</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html#a9671de8d09fae2ba3954919c2fdc3030">ast_get_builtin_feature</a>(chan, <span class="stringliteral">&quot;atxfer&quot;</span>, feature_code, <span class="keyword">sizeof</span>(feature_code)) ||</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(feature_code)) {</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No attended transfer feature code found&quot;</span>);</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;   }</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(context)) {</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a>(chan, <span class="stringliteral">&quot;TRANSFER_CONTEXT&quot;</span>, context);</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;   }</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;   <span class="keywordflow">for</span> (digit = feature_code; *<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>; ++<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>) {</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> f = { <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>, .subclass.integer = *digit };</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(chan, &amp;f);</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;   }</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;   <span class="keywordflow">for</span> (digit = exten; *<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>; ++<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>) {</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> f = { <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>, .subclass.integer = *digit };</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(chan, &amp;f);</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;   }</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;   chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Atxfer successfully queued&quot;</span>);</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;}</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;</div><div class="line"><a name="l05218"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa60da5f18e4bd066b5d6c5d334f3ef9a"> 5218</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa60da5f18e4bd066b5d6c5d334f3ef9a">action_cancel_atxfer</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;{</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;   <span class="keywordtype">char</span> *feature_code;</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>;</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No channel specified&quot;</span>);</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;   }</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;   <span class="keywordflow">if</span> (!(chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name))) {</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Channel specified does not exist&quot;</span>);</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;   }</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(chan);</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;   feature_code = <a class="code" href="../../d0/daa/include_2asterisk_2features__config_8h.html#acfe9f988bbf6b3a2d02663e30668277e">ast_get_chan_features_atxferabort</a>(chan);</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;   <span class="keywordflow">if</span> (!feature_code) {</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No disconnect feature code found&quot;</span>);</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;   }</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;   <span class="keywordflow">for</span> (digit = feature_code; *<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>; ++<a class="code" href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a>) {</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d99/structast__frame.html">ast_frame</a> f = { <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a>, .subclass.integer = *digit };</div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a>(chan, &amp;f);</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;   }</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(feature_code);</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;   chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;CancelAtxfer successfully queued&quot;</span>);</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;}</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;</div><div class="line"><a name="l05259"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9227e0d88226ca4021dadf7d03d63976"> 5259</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga9227e0d88226ca4021dadf7d03d63976">check_blacklist</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *cmd)</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;{</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;   <span class="keywordtype">char</span> *cmd_copy, *cur_cmd;</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;   <span class="keywordtype">char</span> *cmd_words[<a class="code" href="../../dc/db0/cli_8h.html#ae88634c402fdd8b46fd5d686dad8bfb9">AST_MAX_CMD_LEN</a>] = { <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, };</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;   cmd_copy = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(cmd);</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../df/d72/group__Group__AMI.html#gaacec20eeac5fcdb47de6e5f98bab33df">MAX_BLACKLIST_CMD_LEN</a> &amp;&amp; (cur_cmd = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;cmd_copy, <span class="stringliteral">&quot; &quot;</span>)); i++) {</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      cur_cmd = <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(cur_cmd);</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cur_cmd)) {</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;         i--;</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      }</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      cmd_words[i] = cur_cmd;</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;   }</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaae263799a76e54f46b173f039ee1053d">command_blacklist</a>); i++) {</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;      <span class="keywordtype">int</span> j, <a class="code" href="../../d5/dff/chan__iax2_8c.html#a7dd0190efe1c61151a9dbab078bdb263">match</a> = 1;</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;      <span class="keywordflow">for</span> (j = 0; <a class="code" href="../../df/d72/group__Group__AMI.html#gaae263799a76e54f46b173f039ee1053d">command_blacklist</a>[i].words[j]; j++) {</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cmd_words[j]) || strcasecmp(cmd_words[j], <a class="code" href="../../df/d72/group__Group__AMI.html#gaae263799a76e54f46b173f039ee1053d">command_blacklist</a>[i].<a class="code" href="../../d4/d10/manager_8c.html#a2c50d07b002a16d9ddfa6eb70ac5f977">words</a>[j])) {</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;            match = 0;</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;         }</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;      }</div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;      <span class="keywordflow">if</span> (match) {</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;         <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;      }</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;   }</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;}</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;<span class="comment">/*! \brief  Manager command &quot;command&quot; - execute CLI command */</span></div><div class="line"><a name="l05295"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa9472597042ec9ccd8f5d51a61b70b74"> 5295</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa9472597042ec9ccd8f5d51a61b70b74">action_command</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;{</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Command&quot;</span>);</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *final_buf = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *delim, *output;</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;   <span class="keywordtype">char</span> <span class="keyword">template</span>[] = <span class="stringliteral">&quot;/tmp/ast-ami-XXXXXX&quot;</span>;  <span class="comment">/* template for temporary file */</span></div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;   <span class="keywordtype">int</span> fd, ret;</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;   off_t <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>;</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(cmd)) {</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No command provided&quot;</span>);</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;   }</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga9227e0d88226ca4021dadf7d03d63976">check_blacklist</a>(cmd)) {</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Command blacklisted&quot;</span>);</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;   }</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;   <span class="keywordflow">if</span> ((fd = mkstemp(<span class="keyword">template</span>)) &lt; 0) {</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga352d583ea36240124638e5c1db088227">astman_send_error_va</a>(s, m, <span class="stringliteral">&quot;Failed to create temporary file: %s&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;   }</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;   ret = <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9">ast_cli_command</a>(fd, cmd);</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a>(s, m, ret == <a class="code" href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a> ? <span class="stringliteral">&quot;Success&quot;</span> : <span class="stringliteral">&quot;Error&quot;</span>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga97955111f384b58ee815bb59f0afa0c5">MSG_MOREDATA</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;   <span class="comment">/* Determine number of characters available */</span></div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;   <span class="keywordflow">if</span> ((len = lseek(fd, 0, SEEK_END)) &lt; 0) {</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Failed to determine number of characters: %s\r\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;      <span class="keywordflow">goto</span> action_command_cleanup;</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;   }</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;   <span class="comment">/* This has a potential to overflow the stack.  Hence, use the heap. */</span></div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;   buf = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(len + 1);</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;   final_buf = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(len + 1);</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;   <span class="keywordflow">if</span> (!buf || !final_buf) {</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Memory allocation failure\r\n&quot;</span>);</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;      <span class="keywordflow">goto</span> action_command_cleanup;</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;   }</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;</div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;   <span class="keywordflow">if</span> (lseek(fd, 0, SEEK_SET) &lt; 0) {</div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Failed to set position on temporary file: %s\r\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;      <span class="keywordflow">goto</span> action_command_cleanup;</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;   }</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;   <span class="keywordflow">if</span> (read(fd, buf, len) &lt; 0) {</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Failed to read from temporary file: %s\r\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;      <span class="keywordflow">goto</span> action_command_cleanup;</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;   }</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;   buf[<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a3a3cbec50cdddbfe0a99732d55fc147d">term_strip</a>(final_buf, buf, len);</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;   final_buf[<a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;   <span class="comment">/* Trim trailing newline */</span></div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;   <span class="keywordflow">if</span> (len &amp;&amp; final_buf[len - 1] == <span class="charliteral">&#39;\n&#39;</span>) {</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;      final_buf[len - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;   }</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;</div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Command output follows\r\n&quot;</span>);</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;   delim = final_buf;</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;   <span class="keywordflow">while</span> ((output = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;delim, <span class="stringliteral">&quot;\n&quot;</span>))) {</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Output: %s\r\n&quot;</span>, output);</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;   }</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;action_command_cleanup:</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;   close(fd);</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;   unlink(<span class="keyword">template</span>);</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buf);</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(final_buf);</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;}</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;<span class="comment">/*! \brief helper function for originate */</span></div><div class="line"><a name="l05375"></a><span class="lineno"><a class="line" href="../../d2/d3c/structfast__originate__helper.html"> 5375</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../d2/d3c/structfast__originate__helper.html">fast_originate_helper</a> {</div><div class="line"><a name="l05376"></a><span class="lineno"><a class="line" href="../../d2/d3c/structfast__originate__helper.html#a493b57f443cc38b3d3df9c1e584d9d82"> 5376</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d2/d3c/structfast__originate__helper.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;</div><div class="line"><a name="l05377"></a><span class="lineno"><a class="line" href="../../d2/d3c/structfast__originate__helper.html#a970f3be80cbd08a1591eb8588f3cd54b"> 5377</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>;            <span class="comment">/*!&lt; Codecs used for a call */</span></div><div class="line"><a name="l05378"></a><span class="lineno"><a class="line" href="../../d2/d3c/structfast__originate__helper.html#ae558fc61c9cbf70fb44ec3fef6136129"> 5378</a></span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d2/d3c/structfast__originate__helper.html#ae558fc61c9cbf70fb44ec3fef6136129">early_media</a>;</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a> (</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(tech);<span class="comment"></span></div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;<span class="comment">      /*! data can contain a channel name, extension number, username, password, etc. */</span></div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(data);</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a>);</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(appdata);</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a>);</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>);</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>);</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>);</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(idtext);</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(account);</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(channelid);</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a>(otherchannelid);</div><div class="line"><a name="l05393"></a><span class="lineno"><a class="line" href="../../d2/d3c/structfast__originate__helper.html#a6379def8cefd9afdea29d5ed673cf8a0"> 5393</a></span>&#160;   );</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>;</div><div class="line"><a name="l05395"></a><span class="lineno"><a class="line" href="../../d2/d3c/structfast__originate__helper.html#a134fe67053d035e763d6cf99916c1bf8"> 5395</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>;</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;};</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;<span class="comment"></span></div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;<span class="comment"> * \param doomed Struct to destroy.</span></div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05405"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2d7639d606b2516454d130399c840b35"> 5405</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2d7639d606b2516454d130399c840b35">destroy_fast_originate_helper</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d3c/structfast__originate__helper.html">fast_originate_helper</a> *doomed)</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;{</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(doomed-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>);</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(doomed-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>);</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(doomed);</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(doomed);</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;}</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;</div><div class="line"><a name="l05413"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab0df757e83667997fd4b802de7c7c45b"> 5413</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#gab0df757e83667997fd4b802de7c7c45b">fast_originate</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;{</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d3c/structfast__originate__helper.html">fast_originate_helper</a> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a> = data;</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;   <span class="keywordtype">int</span> reason = 0;</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *<a class="code" href="../../d6/d75/structchans.html">chans</a>[1];</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;   <span class="keywordtype">char</span> requested_channel[<a class="code" href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a>];</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a> assignedids = {</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;      .<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a> = in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a88ee7e279ede6839297441d1768ec6d1">channelid</a>,</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;      .uniqueid2 = in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a8c6534ea809fe4fb40a264409bf22e14">otherchannelid</a></div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;   };</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>)) {</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;      res = <a class="code" href="../../db/de0/pbx_8h.html#a2afffb175879297ed07ec21df02fa6dc">ast_pbx_outgoing_app</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a7870f447ef3c43ebf148da15363b25dd">data</a>,</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a0ca0a0b3e0d6aafb1b2ff7e291f1acb0">appdata</a>, &amp;reason,</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916a90d4fb6299afc301b2bfc05da78eb662">AST_OUTGOING_WAIT</a>,</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a1db41d2bb5281151490fa74f8f8de95d">cid_num</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#acea391ea9b4b2ee61b5b84bce2187f12">cid_name</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a626176754f57f4dc291e44916a5354f8">account</a>, &amp;chan, &amp;assignedids);</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      res = <a class="code" href="../../db/de0/pbx_8h.html#a6c3a35983760904213206a8f0a7df9c9">ast_pbx_outgoing_exten</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a7870f447ef3c43ebf148da15363b25dd">data</a>,</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a7faec841658b88ad0cfbc684853acad3">context</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#aaee31f4cc48985167efcd38ab252dac8">exten</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a>, &amp;reason,</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916a90d4fb6299afc301b2bfc05da78eb662">AST_OUTGOING_WAIT</a>,</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a1db41d2bb5281151490fa74f8f8de95d">cid_num</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#acea391ea9b4b2ee61b5b84bce2187f12">cid_name</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>),</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a134fe67053d035e763d6cf99916c1bf8">vars</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a626176754f57f4dc291e44916a5354f8">account</a>, &amp;chan, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#ae558fc61c9cbf70fb44ec3fef6136129">early_media</a>, &amp;assignedids);</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;   }</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;   <span class="keywordflow">if</span> (!chan) {</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;      snprintf(requested_channel, <a class="code" href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a>, <span class="stringliteral">&quot;%s/%s&quot;</span>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a6379def8cefd9afdea29d5ed673cf8a0">tech</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a7870f447ef3c43ebf148da15363b25dd">data</a>);</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;   }</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;   <span class="comment">/* Tell the manager what happened with the channel */</span></div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;   chans[0] = chan;</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>)) {</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#aafd542831b3864e77f37396573bc1fd0">ast_manager_event_multichan</a>(<a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <span class="stringliteral">&quot;OriginateResponse&quot;</span>, chan ? 1 : 0, chans,</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;         <span class="stringliteral">&quot;Response: %s\r\n&quot;</span></div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;         <span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;         <span class="stringliteral">&quot;Application: %s\r\n&quot;</span></div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;         <span class="stringliteral">&quot;Data: %s\r\n&quot;</span></div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;         <span class="stringliteral">&quot;Reason: %d\r\n&quot;</span></div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;         <span class="stringliteral">&quot;Uniqueid: %s\r\n&quot;</span></div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;         <span class="stringliteral">&quot;CallerIDNum: %s\r\n&quot;</span></div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;         <span class="stringliteral">&quot;CallerIDName: %s\r\n&quot;</span>,</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#ac0b1407c0017cb917a9687f90d16b106">idtext</a>, res ? <span class="stringliteral">&quot;Failure&quot;</span> : <span class="stringliteral">&quot;Success&quot;</span>,</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;         chan ? <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan) : requested_channel,</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a66066052ae6571f5495a4e7f8df6c0bb">app</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a0ca0a0b3e0d6aafb1b2ff7e291f1acb0">appdata</a>, reason,</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;         chan ? <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan) : <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a88ee7e279ede6839297441d1768ec6d1">channelid</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a1db41d2bb5281151490fa74f8f8de95d">cid_num</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#acea391ea9b4b2ee61b5b84bce2187f12">cid_name</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>)</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;         );</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#aafd542831b3864e77f37396573bc1fd0">ast_manager_event_multichan</a>(<a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <span class="stringliteral">&quot;OriginateResponse&quot;</span>, chan ? 1 : 0, chans,</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;         <span class="stringliteral">&quot;Response: %s\r\n&quot;</span></div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;         <span class="stringliteral">&quot;Channel: %s\r\n&quot;</span></div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;         <span class="stringliteral">&quot;Context: %s\r\n&quot;</span></div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;         <span class="stringliteral">&quot;Exten: %s\r\n&quot;</span></div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;         <span class="stringliteral">&quot;Reason: %d\r\n&quot;</span></div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;         <span class="stringliteral">&quot;Uniqueid: %s\r\n&quot;</span></div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;         <span class="stringliteral">&quot;CallerIDNum: %s\r\n&quot;</span></div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;         <span class="stringliteral">&quot;CallerIDName: %s\r\n&quot;</span>,</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#ac0b1407c0017cb917a9687f90d16b106">idtext</a>, res ? <span class="stringliteral">&quot;Failure&quot;</span> : <span class="stringliteral">&quot;Success&quot;</span>,</div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;         chan ? <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan) : requested_channel,</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;         in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a7faec841658b88ad0cfbc684853acad3">context</a>, in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#aaee31f4cc48985167efcd38ab252dac8">exten</a>, reason,</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;         chan ? <a class="code" href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a>(chan) : <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a88ee7e279ede6839297441d1768ec6d1">channelid</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a1db41d2bb5281151490fa74f8f8de95d">cid_num</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>),</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(in-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#acea391ea9b4b2ee61b5b84bce2187f12">cid_name</a>, <span class="stringliteral">&quot;&lt;unknown&gt;&quot;</span>)</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;         );</div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;   }</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;   <span class="comment">/* Locked and ref&#39;d by ast_pbx_outgoing_exten or ast_pbx_outgoing_app */</span></div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;   <span class="keywordflow">if</span> (chan) {</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(chan);</div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;      <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;   }</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga2d7639d606b2516454d130399c840b35">destroy_fast_originate_helper</a>(in);</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;}</div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;</div><div class="line"><a name="l05493"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaecb636956ea985949db409bb9d6a6d00"> 5493</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaecb636956ea985949db409bb9d6a6d00">aocmessage_get_unit_entry</a>(<span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keyword">struct</span> <a class="code" href="../../df/d18/structast__aoc__unit__entry.html">ast_aoc_unit_entry</a> *<a class="code" href="../../d3/d96/structentry.html">entry</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> entry_num)</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;{</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *unitamount;</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *unittype;</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(32);</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;   memset(entry, 0, <span class="keyword">sizeof</span>(*entry));</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;str, 0, <span class="stringliteral">&quot;UnitAmount(%u)&quot;</span>, entry_num);</div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;   unitamount = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(str));</div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;str, 0, <span class="stringliteral">&quot;UnitType(%u)&quot;</span>, entry_num);</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;   unittype = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(str));</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(unitamount) &amp;&amp; (sscanf(unitamount, <span class="stringliteral">&quot;%30u&quot;</span>, &amp;entry-&gt;<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a3aaa7811b1b3c09c7945b9e090220ea1">amount</a>) == 1)) {</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;      entry-&gt;<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a7dd39f0ed064eccd86e7b98ee0834b67">valid_amount</a> = 1;</div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;   }</div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;</div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(unittype) &amp;&amp; sscanf(unittype, <span class="stringliteral">&quot;%30u&quot;</span>, &amp;entry-&gt;<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a4bfea42429249a1f65204f0c0f34704a">type</a>) == 1) {</div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;      entry-&gt;<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a7a39ee49c9364cb0e662f7637a323830">valid_type</a> = 1;</div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;   }</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;}</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;</div><div class="line"><a name="l05518"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga8fdf554febcd2f092aca41a377e4a60b"> 5518</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga8fdf554febcd2f092aca41a377e4a60b">action_aocmessage</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;{</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d84/structchannel.html">channel</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *pchannel = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ChannelPrefix&quot;</span>);</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *msgtype = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;MsgType&quot;</span>);</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *chargetype = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ChargeType&quot;</span>);</div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *currencyname = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;CurrencyName&quot;</span>);</div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *currencyamount = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;CurrencyAmount&quot;</span>);</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *mult = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;CurrencyMultiplier&quot;</span>);</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *totaltype = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;TotalType&quot;</span>);</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *aocbillingid = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;AOCBillingId&quot;</span>);</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *association_id= <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ChargingAssociationId&quot;</span>);</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *association_num = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ChargingAssociationNumber&quot;</span>);</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *association_plan = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ChargingAssociationPlan&quot;</span>);</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548">ast_aoc_type</a> _msgtype;</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9">ast_aoc_charge_type</a> _chargetype;</div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089">ast_aoc_currency_multiplier</a> _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089ab55dc209b59be84c7162d3128565ab36">AST_AOC_MULT_ONE</a>;</div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/db3/aoc_8h.html#aed3fe8e8d708e8aff42a2ad205813cb7">ast_aoc_total_type</a> _totaltype = <a class="code" href="../../d6/db3/aoc_8h.html#aed3fe8e8d708e8aff42a2ad205813cb7a437decc9f64054294b48742e48089619">AST_AOC_TOTAL</a>;</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1d">ast_aoc_billing_id</a> _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1daf2aa1a3d8a87f17ac604cead1964f52f">AST_AOC_BILLING_NA</a>;</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _currencyamount = 0;</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;   <span class="keywordtype">int</span> _association_id = 0;</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> _association_plan = 0;</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/dca/structast__aoc__decoded.html">ast_aoc_decoded</a> *decoded = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d72/structast__aoc__encoded.html">ast_aoc_encoded</a> *encoded = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;   <span class="keywordtype">size_t</span> encoded_size = 0;</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(channel) &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pchannel)) {</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Channel and PartialChannel are not specified. Specify at least one of these.&quot;</span>);</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;      <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;   }</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;   <span class="keywordflow">if</span> (!(chan = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(channel)) &amp;&amp; !<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(pchannel)) {</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#a71d89dbc5107b1f851dcbf1686a0d9d9">ast_channel_get_by_name_prefix</a>(pchannel, strlen(pchannel));</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;   }</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;   <span class="keywordflow">if</span> (!chan) {</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such channel&quot;</span>);</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;      <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;   }</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(msgtype) || (strcasecmp(msgtype, <span class="stringliteral">&quot;d&quot;</span>) &amp;&amp; strcasecmp(msgtype, <span class="stringliteral">&quot;e&quot;</span>))) {</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid MsgType&quot;</span>);</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;      <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;   }</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(chargetype)) {</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;ChargeType not specified&quot;</span>);</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;      <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;   }</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;   _msgtype = strcasecmp(msgtype, <span class="stringliteral">&quot;d&quot;</span>) ? <a class="code" href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548a98adf1ef32c4d9b775cc595795ac4693">AST_AOC_E</a> : <a class="code" href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548a463d1c225066e20d4cc56abee5a5b239">AST_AOC_D</a>;</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;</div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(chargetype, <span class="stringliteral">&quot;NA&quot;</span>)) {</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;      _chargetype = <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9ad60d324867080b1a1ca3b13db29b27c2">AST_AOC_CHARGE_NA</a>;</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(chargetype, <span class="stringliteral">&quot;Free&quot;</span>)) {</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;      _chargetype = <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a44da551e5cfa1d51b072685591df0800">AST_AOC_CHARGE_FREE</a>;</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(chargetype, <span class="stringliteral">&quot;Currency&quot;</span>)) {</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;      _chargetype = <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a38cfbbe1a40256021b03e1599b1a23ed">AST_AOC_CHARGE_CURRENCY</a>;</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(chargetype, <span class="stringliteral">&quot;Unit&quot;</span>)) {</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;      _chargetype = <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a5816131a38e568febf50d316c850c44b">AST_AOC_CHARGE_UNIT</a>;</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid ChargeType&quot;</span>);</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;      <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;   }</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;   <span class="keywordflow">if</span> (_chargetype == <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a38cfbbe1a40256021b03e1599b1a23ed">AST_AOC_CHARGE_CURRENCY</a>) {</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(currencyamount) || (sscanf(currencyamount, <span class="stringliteral">&quot;%30u&quot;</span>, &amp;_currencyamount) != 1)) {</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid CurrencyAmount, CurrencyAmount is a required when ChargeType is Currency&quot;</span>);</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;      }</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mult)) {</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;ChargeMultiplier unspecified, ChargeMultiplier is required when ChargeType is Currency.&quot;</span>);</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(mult, <span class="stringliteral">&quot;onethousandth&quot;</span>)) {</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;         _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a865002098f4bc4e8e711bd3d2450f6bf">AST_AOC_MULT_ONETHOUSANDTH</a>;</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(mult, <span class="stringliteral">&quot;onehundredth&quot;</span>)) {</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;         _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a218074f0220f2224fa4c4cab5281834a">AST_AOC_MULT_ONEHUNDREDTH</a>;</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(mult, <span class="stringliteral">&quot;onetenth&quot;</span>)) {</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;         _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a6060df3e95e44802a372af9f0eb5ebaf">AST_AOC_MULT_ONETENTH</a>;</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(mult, <span class="stringliteral">&quot;one&quot;</span>)) {</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;         _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089ab55dc209b59be84c7162d3128565ab36">AST_AOC_MULT_ONE</a>;</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(mult, <span class="stringliteral">&quot;ten&quot;</span>)) {</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;         _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a20055187dd0b3834fe5cc313e1f08965">AST_AOC_MULT_TEN</a>;</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(mult, <span class="stringliteral">&quot;hundred&quot;</span>)) {</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;         _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a27a0c84a4d31cb0060200d36100c1c75">AST_AOC_MULT_HUNDRED</a>;</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(mult, <span class="stringliteral">&quot;thousand&quot;</span>)) {</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;         _mult = <a class="code" href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089ab00c5e861fc1c84070bb4af0ae15690b">AST_AOC_MULT_THOUSAND</a>;</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid ChargeMultiplier&quot;</span>);</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;      }</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;   }</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;   <span class="comment">/* create decoded object and start setting values */</span></div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;   <span class="keywordflow">if</span> (!(decoded = <a class="code" href="../../d6/db3/aoc_8h.html#ada9b84ac8130231cee87ba4d33a5dda0">ast_aoc_create</a>(_msgtype, _chargetype, 0))) {</div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Message Creation Failed&quot;</span>);</div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;   }</div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;   <span class="keywordflow">if</span> (_msgtype == <a class="code" href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548a463d1c225066e20d4cc56abee5a5b239">AST_AOC_D</a>) {</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(totaltype) &amp;&amp; !strcasecmp(totaltype, <span class="stringliteral">&quot;subtotal&quot;</span>)) {</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;         _totaltype = <a class="code" href="../../d6/db3/aoc_8h.html#aed3fe8e8d708e8aff42a2ad205813cb7aff4d08a18d17f2ffe60dd21a316ae677">AST_AOC_SUBTOTAL</a>;</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;      }</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(aocbillingid)) {</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;         <span class="comment">/* ignore this is optional */</span></div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;Normal&quot;</span>)) {</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da83b02bda7920334b1d7cb85c53be1d50">AST_AOC_BILLING_NORMAL</a>;</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;ReverseCharge&quot;</span>)) {</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1dad1092f5f7da0428ebd4c6ec4ed78d751">AST_AOC_BILLING_REVERSE_CHARGE</a>;</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;CreditCard&quot;</span>)) {</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da91a7d97d8c344b40e9aaadc39c4d9269">AST_AOC_BILLING_CREDIT_CARD</a>;</div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid AOC-D AOCBillingId&quot;</span>);</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      }</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(aocbillingid)) {</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;         <span class="comment">/* ignore this is optional */</span></div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;Normal&quot;</span>)) {</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da83b02bda7920334b1d7cb85c53be1d50">AST_AOC_BILLING_NORMAL</a>;</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;ReverseCharge&quot;</span>)) {</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1dad1092f5f7da0428ebd4c6ec4ed78d751">AST_AOC_BILLING_REVERSE_CHARGE</a>;</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;CreditCard&quot;</span>)) {</div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da91a7d97d8c344b40e9aaadc39c4d9269">AST_AOC_BILLING_CREDIT_CARD</a>;</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;CallFwdUnconditional&quot;</span>)) {</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1daceee6b8982426596fe14c3948aa29987">AST_AOC_BILLING_CALL_FWD_UNCONDITIONAL</a>;</div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;CallFwdBusy&quot;</span>)) {</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da204aa062b4281ee428f0709259f73116">AST_AOC_BILLING_CALL_FWD_BUSY</a>;</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;CallFwdNoReply&quot;</span>)) {</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da5c049c80395b1353839451a4f6d790e3">AST_AOC_BILLING_CALL_FWD_NO_REPLY</a>;</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;CallDeflection&quot;</span>)) {</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da848e7e562e4048e4b0ea85d176afa76c">AST_AOC_BILLING_CALL_DEFLECTION</a>;</div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(aocbillingid, <span class="stringliteral">&quot;CallTransfer&quot;</span>)) {</div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;         _billingid = <a class="code" href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da9f62d8ce9119202ffb00eb74d5db7412">AST_AOC_BILLING_CALL_TRANSFER</a>;</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid AOC-E AOCBillingId&quot;</span>);</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;      }</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;</div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(association_id) &amp;&amp; (sscanf(association_id, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;_association_id) != 1)) {</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid ChargingAssociationId&quot;</span>);</div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;      }</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(association_plan) &amp;&amp; (sscanf(association_plan, <span class="stringliteral">&quot;%30u&quot;</span>, &amp;_association_plan) != 1)) {</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid ChargingAssociationPlan&quot;</span>);</div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;      }</div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;      <span class="keywordflow">if</span> (_association_id) {</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;         <a class="code" href="../../d6/db3/aoc_8h.html#a8f4901f528a0a8c757a12e94178606e6">ast_aoc_set_association_id</a>(decoded, _association_id);</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(association_num)) {</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;         <a class="code" href="../../d6/db3/aoc_8h.html#a655f2e3693ef15ab3bdfc623807278a7">ast_aoc_set_association_number</a>(decoded, association_num, _association_plan);</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;      }</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;   }</div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;</div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;   <span class="keywordflow">if</span> (_chargetype == <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a38cfbbe1a40256021b03e1599b1a23ed">AST_AOC_CHARGE_CURRENCY</a>) {</div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;      <a class="code" href="../../d6/db3/aoc_8h.html#a84cc9357bb1acbc2b24d7e80780e3b9d">ast_aoc_set_currency_info</a>(decoded, _currencyamount, _mult, <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(currencyname) ? <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> : currencyname);</div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_chargetype == <a class="code" href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a5816131a38e568febf50d316c850c44b">AST_AOC_CHARGE_UNIT</a>) {</div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d18/structast__aoc__unit__entry.html">ast_aoc_unit_entry</a> <a class="code" href="../../d3/d96/structentry.html">entry</a>;</div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;</div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;      <span class="comment">/* multiple unit entries are possible, lets get them all */</span></div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; 32; i++) {</div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gaecb636956ea985949db409bb9d6a6d00">aocmessage_get_unit_entry</a>(m, &amp;entry, i)) {</div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">/* that&#39;s the end then */</span></div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;         }</div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;</div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;         <a class="code" href="../../d6/db3/aoc_8h.html#a6e8ab2944e2d6d1f783b3ebcd7b3c272">ast_aoc_add_unit_entry</a>(decoded, entry.<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a7dd39f0ed064eccd86e7b98ee0834b67">valid_amount</a>, entry.<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a3aaa7811b1b3c09c7945b9e090220ea1">amount</a>, entry.<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a7a39ee49c9364cb0e662f7637a323830">valid_type</a>, entry.<a class="code" href="../../df/d18/structast__aoc__unit__entry.html#a4bfea42429249a1f65204f0c0f34704a">type</a>);</div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;      }</div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;</div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;      <span class="comment">/* at least one unit entry is required */</span></div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;      <span class="keywordflow">if</span> (!i) {</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid UnitAmount(0), At least one valid unit entry is required when ChargeType is set to Unit&quot;</span>);</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;         <span class="keywordflow">goto</span> aocmessage_cleanup;</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;      }</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;   }</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;   <a class="code" href="../../d6/db3/aoc_8h.html#a82fcf407f11289b3675f0880f2245bfe">ast_aoc_set_billing_id</a>(decoded, _billingid);</div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;   <a class="code" href="../../d6/db3/aoc_8h.html#a9dc12343996e18f696da3dcde18fabcb">ast_aoc_set_total_type</a>(decoded, _totaltype);</div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;   <span class="keywordflow">if</span> ((encoded = <a class="code" href="../../d6/db3/aoc_8h.html#abbf1344a7eae88ea2cef85c1b0b6c24d">ast_aoc_encode</a>(decoded, &amp;encoded_size, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) &amp;&amp; !<a class="code" href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a>(chan, <a class="code" href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a>, encoded, encoded_size)) {</div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;AOC Message successfully queued on channel&quot;</span>);</div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Error encoding AOC message, could not queue onto channel&quot;</span>);</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;   }</div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;aocmessage_cleanup:</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;   <a class="code" href="../../d6/db3/aoc_8h.html#a33b761090d3debbfd4cdb0c800a13bb2">ast_aoc_destroy_decoded</a>(decoded);</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;   <a class="code" href="../../d6/db3/aoc_8h.html#a8f66f98f015246c294b10dc2c9350612">ast_aoc_destroy_encoded</a>(encoded);</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;   <span class="keywordflow">if</span> (chan) {</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;      chan = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(chan);</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;   }</div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;}</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;</div><div class="line"><a name="l05723"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa72169a44884720d85770602ffe6cdb5"> 5723</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa72169a44884720d85770602ffe6cdb5">action_originate</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;{</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Exten&quot;</span>);</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Context&quot;</span>);</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Priority&quot;</span>);</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *timeout = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Timeout&quot;</span>);</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *callerid = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;CallerID&quot;</span>);</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *account = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Account&quot;</span>);</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Application&quot;</span>);</div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *appdata = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Data&quot;</span>);</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *async = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Async&quot;</span>);</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/def/codec_8c.html#a26d06e92c695d54e16beb8070dc5461d">codecs</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Codecs&quot;</span>);</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *early_media = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Earlymedia&quot;</span>);</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a> assignedids = {</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;      .<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ChannelId&quot;</span>),</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;      .uniqueid2 = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;OtherChannelId&quot;</span>),</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;   };</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *vars = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;   <span class="keywordtype">char</span> *tech, *data;</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;   <span class="keywordtype">char</span> *l = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *n = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;   <span class="keywordtype">int</span> pi = 0;</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;   <span class="keywordtype">int</span> to = 30000;</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;   <span class="keywordtype">int</span> reason = 0;</div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>[256];</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;   <span class="keywordtype">char</span> tmp2[256];</div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d69/structast__format__cap.html">ast_format_cap</a> *cap = <a class="code" href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a>(<a class="code" href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a>);</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;   pthread_t th;</div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;   <span class="keywordtype">int</span> bridge_early = 0;</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;   <span class="keywordflow">if</span> (!cap) {</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Internal Error. Memory allocation failure.&quot;</span>);</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;   }</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;   <a class="code" href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a>(cap, <a class="code" href="../../db/d1c/format__cache_8h.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a>, 0);</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;   <span class="keywordflow">if</span> ((assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a> &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#a0b4d23dfd94209395f4feceaa5911e0a">AST_MAX_PUBLIC_UNIQUEID</a> &lt; strlen(assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a>))</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;      || (assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#ad386d957fb41c92b9e929fbd2ac7a48c">uniqueid2</a> &amp;&amp; <a class="code" href="../../d5/d7b/channel_8h.html#a0b4d23dfd94209395f4feceaa5911e0a">AST_MAX_PUBLIC_UNIQUEID</a> &lt; strlen(assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#ad386d957fb41c92b9e929fbd2ac7a48c">uniqueid2</a>))) {</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga352d583ea36240124638e5c1db088227">astman_send_error_va</a>(s, m, <span class="stringliteral">&quot;Uniqueid length exceeds maximum of %d\n&quot;</span>,</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a0b4d23dfd94209395f4feceaa5911e0a">AST_MAX_PUBLIC_UNIQUEID</a>);</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;      res = 0;</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;      <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;   }</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Channel not specified&quot;</span>);</div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;      res = 0;</div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;      <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;   }</div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(priority) &amp;&amp; (sscanf(priority, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;pi) != 1)) {</div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;      <span class="keywordflow">if</span> ((pi = <a class="code" href="../../db/de0/pbx_8h.html#a0be9518646cf9aca4878b313cc02e901">ast_findlabel_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context, exten, priority, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) &lt; 1) {</div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid priority&quot;</span>);</div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;         res = 0;</div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;         <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;      }</div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;   }</div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(timeout) &amp;&amp; (sscanf(timeout, <span class="stringliteral">&quot;%30d&quot;</span>, &amp;to) != 1)) {</div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid timeout&quot;</span>);</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;      res = 0;</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;      <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;   }</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp, name, <span class="keyword">sizeof</span>(tmp));</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;   tech = <a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a>;</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;   data = strchr(tmp, <span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;   <span class="keywordflow">if</span> (!data) {</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Invalid channel&quot;</span>);</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;      res = 0;</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;      <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;   }</div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;   *data++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(tmp2, callerid, <span class="keyword">sizeof</span>(tmp2));</div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;   <a class="code" href="../../de/d47/callerid_8h.html#a39e03ca4e8df3a1d2c75e888d76201df">ast_callerid_parse</a>(tmp2, &amp;n, &amp;l);</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;   <span class="keywordflow">if</span> (n) {</div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(n)) {</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;         n = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;      }</div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;   }</div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;   <span class="keywordflow">if</span> (l) {</div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;      <a class="code" href="../../de/d47/callerid_8h.html#a6a61669b28d0f994e44db5e3baab6ef2">ast_shrink_phone_number</a>(l);</div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(l)) {</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;         l = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;      }</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;   }</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(codecs)) {</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;      <a class="code" href="../../d0/d3c/format__cap_8h.html#a4dc6fa9191c19396cfaa57113f5b4af2">ast_format_cap_remove_by_type</a>(cap, <a class="code" href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a>);</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;      <a class="code" href="../../d0/d3c/format__cap_8h.html#a26c6676e9f2dd9535ea0d5bbd45f98b6">ast_format_cap_update_by_allow_disallow</a>(cap, codecs, 1);</div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;   }</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(app) &amp;&amp; s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>) {</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;      <span class="keywordtype">int</span> bad_appdata = 0;</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;      <span class="comment">/* To run the System application (or anything else that goes to</span></div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;<span class="comment">       * shell), you must have the additional System privilege */</span></div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;      <span class="keywordflow">if</span> (!(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> &amp; <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>)</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;         &amp;&amp; (</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;            <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a0d78ab95e54db8c72a64038cfefb5161">strcasestr</a>(app, <span class="stringliteral">&quot;system&quot;</span>) ||      <span class="comment">/* System(rm -rf /)</span></div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;<span class="comment">                                                 TrySystem(rm -rf /)       */</span></div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;            <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a0d78ab95e54db8c72a64038cfefb5161">strcasestr</a>(app, <span class="stringliteral">&quot;exec&quot;</span>) ||        <span class="comment">/* Exec(System(rm -rf /))</span></div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;<span class="comment">                                                 TryExec(System(rm -rf /)) */</span></div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;            <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a0d78ab95e54db8c72a64038cfefb5161">strcasestr</a>(app, <span class="stringliteral">&quot;agi&quot;</span>) ||         <span class="comment">/* AGI(/bin/rm,-rf /)</span></div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;<span class="comment">                                                 EAGI(/bin/rm,-rf /)       */</span></div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;            <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a0d78ab95e54db8c72a64038cfefb5161">strcasestr</a>(app, <span class="stringliteral">&quot;mixmonitor&quot;</span>) ||  <span class="comment">/* MixMonitor(blah,,rm -rf)  */</span></div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;            <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a0d78ab95e54db8c72a64038cfefb5161">strcasestr</a>(app, <span class="stringliteral">&quot;externalivr&quot;</span>) || <span class="comment">/* ExternalIVR(rm -rf)       */</span></div><div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;            <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a0d78ab95e54db8c72a64038cfefb5161">strcasestr</a>(app, <span class="stringliteral">&quot;originate&quot;</span>) ||   <span class="comment">/* Originate(Local/1234,app,System,rm -rf) */</span></div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;            (strstr(appdata, <span class="stringliteral">&quot;SHELL&quot;</span>) &amp;&amp; (bad_appdata = 1)) ||       <span class="comment">/* NoOp(${SHELL(rm -rf /)})  */</span></div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;            (strstr(appdata, <span class="stringliteral">&quot;EVAL&quot;</span>) &amp;&amp; (bad_appdata = 1))           <span class="comment">/* NoOp(${EVAL(${some_var_containing_SHELL})}) */</span></div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;            )) {</div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;         <span class="keywordtype">char</span> error_buf[64];</div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;         snprintf(error_buf, <span class="keyword">sizeof</span>(error_buf), <span class="stringliteral">&quot;Originate Access Forbidden: %s&quot;</span>, bad_appdata ? <span class="stringliteral">&quot;Data&quot;</span> : <span class="stringliteral">&quot;Application&quot;</span>);</div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, error_buf);</div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;         res = 0;</div><div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;         <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;      }</div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;   }</div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;</div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;   <span class="comment">/* Check early if the extension exists. If not, we need to bail out here. */</span></div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;   <span class="keywordflow">if</span> (exten &amp;&amp; context &amp;&amp; pi) {</div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;      <span class="keywordflow">if</span> (! <a class="code" href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context, exten, pi, l)) {</div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;         <span class="comment">/* The extension does not exist. */</span></div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Extension does not exist.&quot;</span>);</div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;         res = 0;</div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;         <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;      }</div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;   }</div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;   <span class="comment">/* Allocate requested channel variables */</span></div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;   vars = <a class="code" href="../../df/d72/group__Group__AMI.html#ga21a20a25e6d03f6fd32cdc86fe9b53d1">astman_get_variables</a>(m);</div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> &amp;&amp; s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>) {</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v, *old;</div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;      old = vars;</div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;      vars = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;</div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;      <span class="comment">/* The variables in the AMI originate action are appended at the end of the list, to override any user variables that apply*/</span></div><div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;</div><div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;      vars = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a5cb297844656a440d8ba8553f81e6d4b">ast_variables_dup</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>);</div><div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;      <span class="keywordflow">if</span> (old) {</div><div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;         <span class="keywordflow">for</span> (v = vars; v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a> );</div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;         <span class="keywordflow">if</span> (v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;            v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a> = old; <span class="comment">/* Append originate variables at end of list */</span></div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;         }</div><div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;      }</div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;   }</div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;</div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;   <span class="comment">/* For originate async - we can bridge in early media stage */</span></div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;   bridge_early = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(early_media);</div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;</div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(async)) {</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/d3c/structfast__originate__helper.html">fast_originate_helper</a> *fast;</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;</div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;      fast = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*fast));</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;      <span class="keywordflow">if</span> (!fast || <a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(fast, 252)) {</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(fast);</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;         <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(vars);</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;         res = -1;</div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;         <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;            <a class="code" href="../../d1/d0f/stringfields_8h.html#a8b9f4347fc72720cc5cead952b54abe9">ast_string_field_build</a>(fast, idtext, <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;         }</div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, tech, tech);</div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, data, data);</div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, app, app);</div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, appdata, appdata);</div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a>, l);</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, <a class="code" href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a>, n);</div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, context, context);</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, exten, exten);</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, account, account);</div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, channelid, assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a>);</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;         <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(fast, otherchannelid, assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#ad386d957fb41c92b9e929fbd2ac7a48c">uniqueid2</a>);</div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;         fast-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a134fe67053d035e763d6cf99916c1bf8">vars</a> = vars;</div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;         fast-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a970f3be80cbd08a1591eb8588f3cd54b">cap</a> = cap;</div><div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;         cap = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; <span class="comment">/* transfered originate helper the capabilities structure.  It is now responsible for freeing it. */</span></div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;         fast-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a> = to;</div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;         fast-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#ae558fc61c9cbf70fb44ec3fef6136129">early_media</a> = bridge_early;</div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;         fast-&gt;<a class="code" href="../../d2/d3c/structfast__originate__helper.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a> = pi;</div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a>(&amp;th, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gab0df757e83667997fd4b802de7c7c45b">fast_originate</a>, fast)) {</div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga2d7639d606b2516454d130399c840b35">destroy_fast_originate_helper</a>(fast);</div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;            res = -1;</div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;            res = 0;</div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;         }</div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;      }</div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(app)) {</div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;      res = <a class="code" href="../../db/de0/pbx_8h.html#a2afffb175879297ed07ec21df02fa6dc">ast_pbx_outgoing_app</a>(tech, cap, data, to, app, appdata, &amp;reason,</div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;            <a class="code" href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916a90d4fb6299afc301b2bfc05da78eb662">AST_OUTGOING_WAIT</a>, l, n, vars, account, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;            assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a> ? &amp;assignedids : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(vars);</div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;      <span class="keywordflow">if</span> (exten &amp;&amp; context &amp;&amp; pi) {</div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;         res = <a class="code" href="../../db/de0/pbx_8h.html#a6c3a35983760904213206a8f0a7df9c9">ast_pbx_outgoing_exten</a>(tech, cap, data, to,</div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;               context, exten, pi, &amp;reason, <a class="code" href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916a90d4fb6299afc301b2bfc05da78eb662">AST_OUTGOING_WAIT</a>,</div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;               l, n, vars, account, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, bridge_early,</div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;               assignedids.<a class="code" href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">uniqueid</a> ? &amp;assignedids : <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;         <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(vars);</div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Originate with &#39;Exten&#39; requires &#39;Context&#39; and &#39;Priority&#39;&quot;</span>);</div><div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;         <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(vars);</div><div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;         res = 0;</div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;         <span class="keywordflow">goto</span> fast_orig_cleanup;</div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;      }</div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;   }</div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Originate successfully queued&quot;</span>);</div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Originate failed&quot;</span>);</div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;   }</div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;</div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;fast_orig_cleanup:</div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(cap);</div><div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;}</div><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;</div><div class="line"><a name="l05936"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga41ec46957049f65f0409d8d92f21b428"> 5936</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga41ec46957049f65f0409d8d92f21b428">action_mailboxstatus</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;{</div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Mailbox&quot;</span>);</div><div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;   <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mailbox)) {</div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Mailbox not specified&quot;</span>);</div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;   }</div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;   ret = <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a76b4d3927cacd1bcd5da9ca8fe375cb6">ast_app_has_voicemail</a>(mailbox, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Mailbox Status\r\n&quot;</span></div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;          <span class="stringliteral">&quot;Mailbox: %s\r\n&quot;</span></div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;          <span class="stringliteral">&quot;Waiting: %d\r\n\r\n&quot;</span>, mailbox, ret);</div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;}</div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;</div><div class="line"><a name="l05953"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga1e0bee965191aad897199382d0f36aba"> 5953</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1e0bee965191aad897199382d0f36aba">action_mailboxcount</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;{</div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Mailbox&quot;</span>);</div><div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;   <span class="keywordtype">int</span> newmsgs = 0, oldmsgs = 0, urgentmsgs = 0;;</div><div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;</div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(mailbox)) {</div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Mailbox not specified&quot;</span>);</div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;   }</div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ace2a3d783f4f79818e14265ae719f06c">ast_app_inboxcount2</a>(mailbox, &amp;urgentmsgs, &amp;newmsgs, &amp;oldmsgs);</div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s,   <span class="stringliteral">&quot;Message: Mailbox Message Count\r\n&quot;</span></div><div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;            <span class="stringliteral">&quot;Mailbox: %s\r\n&quot;</span></div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;            <span class="stringliteral">&quot;UrgMessages: %d\r\n&quot;</span></div><div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;            <span class="stringliteral">&quot;NewMessages: %d\r\n&quot;</span></div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;            <span class="stringliteral">&quot;OldMessages: %d\r\n&quot;</span></div><div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;            <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;            mailbox, urgentmsgs, newmsgs, oldmsgs);</div><div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;}</div><div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;</div><div class="line"><a name="l05974"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga5f3b2b093b498ed27078743ec10c05b7"> 5974</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga5f3b2b093b498ed27078743ec10c05b7">action_extensionstate</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;{</div><div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Exten&quot;</span>);</div><div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Context&quot;</span>);</div><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;   <span class="keywordtype">char</span> hint[256];</div><div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a>;</div><div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;</div><div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(exten)) {</div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Extension not specified&quot;</span>);</div><div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;   }</div><div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(context)) {</div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;      context = <span class="stringliteral">&quot;default&quot;</span>;</div><div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;   }</div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;   status = <a class="code" href="../../db/de0/pbx_8h.html#aed6cfe76441ef995ab80609020a9990c">ast_extension_state</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context, exten);</div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;   hint[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#ac778ac642def88a06e5d59e11a964c43">ast_get_hint</a>(hint, <span class="keyword">sizeof</span>(hint), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context, exten);</div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Extension Status\r\n&quot;</span></div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;      <span class="stringliteral">&quot;Exten: %s\r\n&quot;</span></div><div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;      <span class="stringliteral">&quot;Context: %s\r\n&quot;</span></div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;      <span class="stringliteral">&quot;Hint: %s\r\n&quot;</span></div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;      <span class="stringliteral">&quot;Status: %d\r\n&quot;</span></div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;      <span class="stringliteral">&quot;StatusText: %s\r\n&quot;</span></div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;      <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;      exten, context, hint, status,</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#a3261603753916b98888a5a5fc1d505c3">ast_extension_state2str</a>(status));</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;}</div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;</div><div class="line"><a name="l06004"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga9800654edab91105eb77e4ae88417387"> 6004</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga9800654edab91105eb77e4ae88417387">action_presencestate</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;{</div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d8/d3a/bridges_8c.html#ab1760b9a6a6c8d063d49ab9b5bcdfa49">provider</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Provider&quot;</span>);</div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d6/dd7/presencestate_8h.html#ac3452f41c7982c84ca27ecf7b4cc7ce1">ast_presence_state</a> <a class="code" href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a>;</div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;   <span class="keywordtype">char</span> *subtype;</div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;   <span class="keywordtype">char</span> *message;</div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;</div><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(provider)) {</div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No provider specified&quot;</span>);</div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;   }</div><div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;   state = <a class="code" href="../../d6/dd7/presencestate_8h.html#ac3452f41c7982c84ca27ecf7b4cc7ce1">ast_presence_state</a>(provider, &amp;subtype, &amp;message);</div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;   <span class="keywordflow">if</span> (state == <a class="code" href="../../d6/dd7/presencestate_8h.html#ac3452f41c7982c84ca27ecf7b4cc7ce1a5b541c7f37468daf2ee6cfe488949adb">AST_PRESENCE_INVALID</a>) {</div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga352d583ea36240124638e5c1db088227">astman_send_error_va</a>(s, m, <span class="stringliteral">&quot;Invalid provider %s or provider in invalid state&quot;</span>, provider);</div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;   }</div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;</div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a>(s, m);</div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: Presence State\r\n&quot;</span></div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;                    <span class="stringliteral">&quot;State: %s\r\n&quot;</span>, <a class="code" href="../../d6/dd7/presencestate_8h.html#aec78c2b072d51416200d34bdd06827a7">ast_presence_state2str</a>(state));</div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;</div><div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(subtype)) {</div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Subtype: %s\r\n&quot;</span>, subtype);</div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;   }</div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;</div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(message)) {</div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;      <span class="comment">/* XXX The Message header here is deprecated as it</span></div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;<span class="comment">       * duplicates the action response header &#39;Message&#39;.</span></div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;<span class="comment">       * Remove it in the next major revision of AMI.</span></div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Message: %s\r\n&quot;</span></div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;                       <span class="stringliteral">&quot;PresenceMessage: %s\r\n&quot;</span>,</div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;                       message, message);</div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;   }</div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;</div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;}</div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;</div><div class="line"><a name="l06044"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2ec80a6f9d335e9240ce5cc6ab49221b"> 6044</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2ec80a6f9d335e9240ce5cc6ab49221b">action_timeout</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;{</div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a>;</div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Channel&quot;</span>);</div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;   <span class="keywordtype">double</span> timeout = atof(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Timeout&quot;</span>));</div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;   <span class="keyword">struct </span>timeval when = { <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>, 0 };</div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;</div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(name)) {</div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No channel specified&quot;</span>);</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;   }</div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;</div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;   <span class="keywordflow">if</span> (!timeout || timeout &lt; 0) {</div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No timeout specified&quot;</span>);</div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;   }</div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;</div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;   <span class="keywordflow">if</span> (!(c = <a class="code" href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a>(name))) {</div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such channel&quot;</span>);</div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;   }</div><div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;</div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;   when.tv_usec = (timeout - when.tv_sec) * 1000000.0;</div><div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;</div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a>(c);</div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#ac03c2ec5ac8e7a6ef9c5d92f91880927">ast_channel_setwhentohangup_tv</a>(c, when);</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a>(c);</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;   c = <a class="code" href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a>(c);</div><div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;</div><div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Timeout Set&quot;</span>);</div><div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;</div><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;}</div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;</div><div class="line"><a name="l06078"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga21a9d344c805f9450b254b4fc0f5afcd"> 6078</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga21a9d344c805f9450b254b4fc0f5afcd">whitefilter_cmp_fn</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;{</div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;   regex_t *regex_filter = obj;</div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *eventdata = arg;</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;   <span class="keywordtype">int</span> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = data;</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;</div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;   <span class="keywordflow">if</span> (!regexec(regex_filter, eventdata, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;      *result = 1;</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>);</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;   }</div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;</div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;}</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;</div><div class="line"><a name="l06092"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga033f5d6043ef1b5fcb6da1aa6a70f53d"> 6092</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga033f5d6043ef1b5fcb6da1aa6a70f53d">blackfilter_cmp_fn</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">void</span> *data, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;{</div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;   regex_t *regex_filter = obj;</div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *eventdata = arg;</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;   <span class="keywordtype">int</span> *<a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = data;</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;</div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;   <span class="keywordflow">if</span> (!regexec(regex_filter, eventdata, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0)) {</div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;      *result = 0;</div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a>);</div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;   }</div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;</div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;   *result = 1;</div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;}</div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;<span class="comment"> * \brief Manager command to add an event filter to a manager session</span></div><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;<span class="comment"> * \see For more details look at manager_add_filter</span></div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06111"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga410d4aa5e53af4cdcb4ec95a0ae8563e"> 6111</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga410d4aa5e53af4cdcb4ec95a0ae8563e">action_filter</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;{</div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Filter&quot;</span>);</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *operation = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Operation&quot;</span>);</div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;</div><div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(operation, <span class="stringliteral">&quot;Add&quot;</span>)) {</div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;      res = <a class="code" href="../../df/d72/group__Group__AMI.html#ga2fce7bc082ac5dfa4ea3545b9f34cb66">manager_add_filter</a>(filter, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>);</div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;</div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;           <span class="keywordflow">if</span> (res != <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a11037e5e5ecf59d690cb6db101376995">FILTER_SUCCESS</a>) {</div><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;              <span class="keywordflow">if</span> (res == <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8ae465b39e083c5cc742896c9941dc5a6f">FILTER_ALLOC_FAILED</a>) {</div><div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Internal Error. Failed to allocate regex for filter&quot;</span>);</div><div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;                      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;              } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res == <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a49c6dd43bada70d0caac95894f037660">FILTER_COMPILE_FAIL</a>) {</div><div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Filter did not compile.  Check the syntax of the filter given.&quot;</span>);</div><div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;                      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;              } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Internal Error. Failed adding filter.&quot;</span>);</div><div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;                      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                   }</div><div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;      }</div><div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;</div><div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Success&quot;</span>);</div><div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;   }</div><div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;</div><div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Unknown operation&quot;</span>);</div><div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;}</div><div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;<span class="comment"> * \brief Add an event filter to a manager session</span></div><div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;<span class="comment"> * \param filter_pattern  Filter syntax to add, see below for syntax</span></div><div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;<span class="comment"> * \return FILTER_ALLOC_FAILED   Memory allocation failure</span></div><div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;<span class="comment"> * \return FILTER_COMPILE_FAIL   If the filter did not compile</span></div><div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;<span class="comment"> * \return FILTER_SUCCESS        Success</span></div><div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;<span class="comment"> * Filter will be used to match against each line of a manager event</span></div><div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;<span class="comment"> * Filter can be any valid regular expression</span></div><div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;<span class="comment"> * Filter can be a valid regular expression prefixed with !, which will add the filter as a black filter</span></div><div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;<span class="comment"> * Examples:</span></div><div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;<span class="comment"> * \code</span></div><div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;<span class="comment"> *   filter_pattern = &quot;Event: Newchannel&quot;</span></div><div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;<span class="comment"> *   filter_pattern = &quot;Event: New.*&quot;</span></div><div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;<span class="comment"> *   filter_pattern = &quot;!Channel: DAHDI.*&quot;</span></div><div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;<span class="comment"> * \endcode</span></div><div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06162"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2fce7bc082ac5dfa4ea3545b9f34cb66"> 6162</a></span>&#160;<span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga8d9eefd35c6b7be4f64a4b4dc9d92fd8">add_filter_result</a> <a class="code" href="../../df/d72/group__Group__AMI.html#ga2fce7bc082ac5dfa4ea3545b9f34cb66">manager_add_filter</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filter_pattern, <span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *whitefilters, <span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *blackfilters) {</div><div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;   regex_t *new_filter = <a class="code" href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a>(<span class="keyword">sizeof</span>(*new_filter), <a class="code" href="../../df/d72/group__Group__AMI.html#ga60fd6fa59060c7bc3c3082275434a292">event_filter_destructor</a>, <span class="stringliteral">&quot;event_filter allocation&quot;</span>);</div><div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;   <span class="keywordtype">int</span> is_blackfilter;</div><div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;</div><div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;   <span class="keywordflow">if</span> (!new_filter) {</div><div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8ae465b39e083c5cc742896c9941dc5a6f">FILTER_ALLOC_FAILED</a>;</div><div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;   }</div><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;</div><div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;   <span class="keywordflow">if</span> (filter_pattern[0] == <span class="charliteral">&#39;!&#39;</span>) {</div><div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;      is_blackfilter = 1;</div><div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;      filter_pattern++;</div><div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;      is_blackfilter = 0;</div><div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;   }</div><div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;</div><div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;   <span class="keywordflow">if</span> (regcomp(new_filter, filter_pattern, REG_EXTENDED | REG_NOSUB)) {</div><div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(new_filter, -1, <span class="stringliteral">&quot;failed to make regex&quot;</span>);</div><div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a49c6dd43bada70d0caac95894f037660">FILTER_COMPILE_FAIL</a>;</div><div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;   }</div><div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;</div><div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;   <span class="keywordflow">if</span> (is_blackfilter) {</div><div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6db9934459f5cdc95cb3af77d55d426e">ao2_t_link</a>(blackfilters, new_filter, <span class="stringliteral">&quot;link new filter into black user container&quot;</span>);</div><div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6db9934459f5cdc95cb3af77d55d426e">ao2_t_link</a>(whitefilters, new_filter, <span class="stringliteral">&quot;link new filter into white user container&quot;</span>);</div><div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;   }</div><div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;</div><div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(new_filter, -1);</div><div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;</div><div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a11037e5e5ecf59d690cb6db101376995">FILTER_SUCCESS</a>;</div><div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;}</div><div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;</div><div class="line"><a name="l06193"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gad40bb264275fb647b2044b47ac533dad"> 6193</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad40bb264275fb647b2044b47ac533dad">match_filter</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keywordtype">char</span> *eventdata)</div><div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;{</div><div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = 0;</div><div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;</div><div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a>) {</div><div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;      <a class="code" href="../../d4/dc5/extconf_8c.html#a81d26348827b996085d4cb6be3e2c348">ast_verbose</a>(<span class="stringliteral">&quot;&lt;-- Examining AMI event: --&gt;\n%s\n&quot;</span>, eventdata);</div><div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Examining AMI event:\n%s\n&quot;</span>, eventdata);</div><div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;   }</div><div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>) &amp;&amp; !<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>)) {</div><div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;      <span class="keywordflow">return</span> 1; <span class="comment">/* no filtering means match all */</span></div><div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>) &amp;&amp; !<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>)) {</div><div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;      <span class="comment">/* white filters only: implied black all filter processed first, then white filters */</span></div><div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ab55d227245c39181ce1a4e4f013cc898">ao2_t_callback_data</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga21a9d344c805f9450b254b4fc0f5afcd">whitefilter_cmp_fn</a>, eventdata, &amp;result, <span class="stringliteral">&quot;find filter in session filter container&quot;</span>);</div><div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>) &amp;&amp; <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>)) {</div><div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;      <span class="comment">/* black filters only: implied white all filter processed first, then black filters */</span></div><div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ab55d227245c39181ce1a4e4f013cc898">ao2_t_callback_data</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga033f5d6043ef1b5fcb6da1aa6a70f53d">blackfilter_cmp_fn</a>, eventdata, &amp;result, <span class="stringliteral">&quot;find filter in session filter container&quot;</span>);</div><div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;      <span class="comment">/* white and black filters: implied black all filter processed first, then white filters, and lastly black filters */</span></div><div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ab55d227245c39181ce1a4e4f013cc898">ao2_t_callback_data</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga21a9d344c805f9450b254b4fc0f5afcd">whitefilter_cmp_fn</a>, eventdata, &amp;result, <span class="stringliteral">&quot;find filter in session filter container&quot;</span>);</div><div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;      <span class="keywordflow">if</span> (result) {</div><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;         result = 0;</div><div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#ab55d227245c39181ce1a4e4f013cc898">ao2_t_callback_data</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga033f5d6043ef1b5fcb6da1aa6a70f53d">blackfilter_cmp_fn</a>, eventdata, &amp;result, <span class="stringliteral">&quot;find filter in session filter container&quot;</span>);</div><div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;      }</div><div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;   }</div><div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;</div><div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;}</div><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;<span class="comment"> * Send any applicable events to the client listening on this socket.</span></div><div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;<span class="comment"> * Wait only for a finite time on each event, and drop all events whether</span></div><div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;<span class="comment"> * they are successfully sent or not.</span></div><div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06227"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab2b9c596c9d6eb5dac8fe5f3d7588f50"> 6227</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab2b9c596c9d6eb5dac8fe5f3d7588f50">process_events</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;{</div><div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;   <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;</div><div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *eqe = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a>;</div><div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;</div><div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;      <span class="keywordflow">while</span> ((eqe = <a class="code" href="../../df/d72/group__Group__AMI.html#ga2d71cf4726fe666194a3473e39782abe">advance_event</a>(eqe))) {</div><div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;         <span class="keywordflow">if</span> (eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a> == <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a246405a298682d5f34f8856b68461">EVENT_FLAG_SHUTDOWN</a>) {</div><div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(3, <span class="stringliteral">&quot;Received CloseSession event\n&quot;</span>);</div><div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;            ret = -1;</div><div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;         }</div><div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;         <span class="keywordflow">if</span> (!ret &amp;&amp; s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a> &amp;&amp;</div><div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;             (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> &amp; eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>) == eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a> &amp;&amp;</div><div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;             (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> &amp; eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>) == eqe-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>) {</div><div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gad40bb264275fb647b2044b47ac533dad">match_filter</a>(s, eqe-&gt;eventdata)) {</div><div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gaa7c66558ac59bdb0c8d05864aaec9c22">send_string</a>(s, eqe-&gt;eventdata) &lt; 0)</div><div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;                     ret = -1;   <span class="comment">/* don&#39;t send more */</span></div><div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;               }</div><div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;         }</div><div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;         s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a> = eqe;</div><div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;      }</div><div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;   }</div><div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;   <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;}</div><div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;</div><div class="line"><a name="l06255"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa837605a5558f94ae96ed1b881aa75e7"> 6255</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa837605a5558f94ae96ed1b881aa75e7">action_userevent</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;{</div><div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d7d/structevent.html">event</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;UserEvent&quot;</span>);</div><div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *body = <a class="code" href="../../d6/d90/strings_8h.html#afe8f5f844f2fd5f5bd5d0be5ef671481">ast_str_thread_get</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#gaa1e469ecb509cb8dd2b26bde7dd1e1be">userevent_buf</a>, 16);</div><div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;</div><div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a8239b9ad10367bfc936e9b60ff7706a8">ast_str_reset</a>(body);</div><div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;</div><div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>; x++) {</div><div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;      <span class="keywordflow">if</span> (strncasecmp(<span class="stringliteral">&quot;UserEvent:&quot;</span>, m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x], strlen(<span class="stringliteral">&quot;UserEvent:&quot;</span>)) &amp;&amp;</div><div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;            strncasecmp(<span class="stringliteral">&quot;Action:&quot;</span>, m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x], strlen(<span class="stringliteral">&quot;Action:&quot;</span>))) {</div><div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;body, 0, <span class="stringliteral">&quot;%s\r\n&quot;</span>, m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x]);</div><div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;      }</div><div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;   }</div><div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;</div><div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Event Sent&quot;</span>);</div><div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a>(<a class="code" href="../../db/d45/manager_8h.html#acc12c2bc03dce67ddd1590d67ab11f4d">EVENT_FLAG_USER</a>, <span class="stringliteral">&quot;UserEvent&quot;</span>, <span class="stringliteral">&quot;UserEvent: %s\r\n%s&quot;</span>, event, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(body));</div><div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;}</div><div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;<span class="comment">/*! \brief Show PBX core settings information */</span></div><div class="line"><a name="l06276"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga3d60a22662da992b5707f7b8830efc05"> 6276</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga3d60a22662da992b5707f7b8830efc05">action_coresettings</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;{</div><div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *actionid = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;   <span class="keywordtype">char</span> idText[150];</div><div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;</div><div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(actionid)) {</div><div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, actionid);</div><div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;      idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;   }</div><div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;</div><div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n&quot;</span></div><div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;         <span class="stringliteral">&quot;AMIversion: %s\r\n&quot;</span></div><div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;         <span class="stringliteral">&quot;AsteriskVersion: %s\r\n&quot;</span></div><div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;         <span class="stringliteral">&quot;SystemName: %s\r\n&quot;</span></div><div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;         <span class="stringliteral">&quot;CoreMaxCalls: %d\r\n&quot;</span></div><div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;         <span class="stringliteral">&quot;CoreMaxLoadAvg: %f\r\n&quot;</span></div><div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;         <span class="stringliteral">&quot;CoreRunUser: %s\r\n&quot;</span></div><div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;         <span class="stringliteral">&quot;CoreRunGroup: %s\r\n&quot;</span></div><div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;         <span class="stringliteral">&quot;CoreMaxFilehandles: %d\r\n&quot;</span></div><div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;         <span class="stringliteral">&quot;CoreRealTimeEnabled: %s\r\n&quot;</span></div><div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;         <span class="stringliteral">&quot;CoreCDRenabled: %s\r\n&quot;</span></div><div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;         <span class="stringliteral">&quot;CoreHTTPenabled: %s\r\n&quot;</span></div><div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;         <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;         idText,</div><div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;         <a class="code" href="../../db/d45/manager_8h.html#a9aa10c963efd367eaab256f4a05db100">AMI_VERSION</a>,</div><div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;         <a class="code" href="../../d5/db9/ast__version_8h.html#a7765c608aea948584928643ab3963b2a">ast_get_version</a>(),</div><div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;         <a class="code" href="../../dd/df2/paths_8h.html#ab9f9346c7a41bdf3720f7b1ed02ec703">ast_config_AST_SYSTEM_NAME</a>,</div><div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;         <a class="code" href="../../d6/dd6/group__main__options.html#ga6d3ecf74255f4bfc355ebd1540c316c1">ast_option_maxcalls</a>,</div><div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;         <a class="code" href="../../d6/dd6/group__main__options.html#ga908239c63cc433cbefa4aa6f5efcb830">ast_option_maxload</a>,</div><div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;         <a class="code" href="../../dd/df2/paths_8h.html#a37ae09a4cc0e3b46e7b2a2052bde4965">ast_config_AST_RUN_USER</a>,</div><div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;         <a class="code" href="../../dd/df2/paths_8h.html#a2434757afbc16110ff1c7483f3d7ba51">ast_config_AST_RUN_GROUP</a>,</div><div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;         <a class="code" href="../../d6/dd6/group__main__options.html#ga3fe7b544e835ccfde10b88b76eb0e8ea">ast_option_maxfiles</a>,</div><div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6344200b56202a76de8db05af680f3ac">ast_realtime_enabled</a>()),</div><div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../dc/d07/cdr_8h.html#a1819c3aecd7b59e2734810f52b219059">ast_cdr_is_enabled</a>()),</div><div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga22f6d55529c1ca69bc308af9d9ef0bb2">ast_webmanager_check_enabled</a>())</div><div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;         );</div><div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;}</div><div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;<span class="comment">/*! \brief Show PBX core status information */</span></div><div class="line"><a name="l06318"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gad91b17071378fe3910cb119a257dab30"> 6318</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad91b17071378fe3910cb119a257dab30">action_corestatus</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;{</div><div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *actionid = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;   <span class="keywordtype">char</span> idText[150];</div><div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;   <span class="keywordtype">char</span> startuptime[150], startupdate[150];</div><div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;   <span class="keywordtype">char</span> reloadtime[150], reloaddate[150];</div><div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d5/d84/structast__tm.html">ast_tm</a> tm;</div><div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;</div><div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(actionid)) {</div><div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, actionid);</div><div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;      idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;   }</div><div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;</div><div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;<a class="code" href="../../d7/d5b/options_8h.html#acd462f81fa607939af36a9fa33cdbf9d">ast_startuptime</a>, &amp;tm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a>(startuptime, <span class="keyword">sizeof</span>(startuptime), <span class="stringliteral">&quot;%H:%M:%S&quot;</span>, &amp;tm);</div><div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a>(startupdate, <span class="keyword">sizeof</span>(startupdate), <span class="stringliteral">&quot;%Y-%m-%d&quot;</span>, &amp;tm);</div><div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a>(&amp;<a class="code" href="../../d7/d5b/options_8h.html#a7cdafc5a121e87659887ffc9abe36760">ast_lastreloadtime</a>, &amp;tm, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a>(reloadtime, <span class="keyword">sizeof</span>(reloadtime), <span class="stringliteral">&quot;%H:%M:%S&quot;</span>, &amp;tm);</div><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;   <a class="code" href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a>(reloaddate, <span class="keyword">sizeof</span>(reloaddate), <span class="stringliteral">&quot;%Y-%m-%d&quot;</span>, &amp;tm);</div><div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;</div><div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n&quot;</span></div><div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;         <span class="stringliteral">&quot;CoreStartupDate: %s\r\n&quot;</span></div><div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;         <span class="stringliteral">&quot;CoreStartupTime: %s\r\n&quot;</span></div><div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;         <span class="stringliteral">&quot;CoreReloadDate: %s\r\n&quot;</span></div><div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;         <span class="stringliteral">&quot;CoreReloadTime: %s\r\n&quot;</span></div><div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;         <span class="stringliteral">&quot;CoreCurrentCalls: %d\r\n&quot;</span></div><div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;         <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;         idText,</div><div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;         startupdate,</div><div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;         startuptime,</div><div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;         reloaddate,</div><div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;         reloadtime,</div><div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;         <a class="code" href="../../d5/d7b/channel_8h.html#a9704ae96ab849e9e5a20040c13d29705">ast_active_channels</a>()</div><div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;         );</div><div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;}</div><div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;<span class="comment">/*! \brief Send a reload event */</span></div><div class="line"><a name="l06358"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga8678a44da3d5cf72e6ea38409d2898bb"> 6358</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga8678a44da3d5cf72e6ea38409d2898bb">action_reload</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;{</div><div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *module = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Module&quot;</span>);</div><div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7">ast_module_reload_result</a> res = <a class="code" href="../../d5/d16/module_8h.html#af9e3b4ae730e43312e00fcbc1707588b">ast_module_reload</a>(<a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(module, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>));</div><div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;</div><div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;   <span class="keywordflow">switch</span> (res) {</div><div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7ac0be7032578c68902708da91e5e7d71a">AST_MODULE_RELOAD_NOT_FOUND</a>:</div><div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such module&quot;</span>);</div><div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7aae470b102da613cbd14c611b36e75b11">AST_MODULE_RELOAD_NOT_IMPLEMENTED</a>:</div><div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Module does not support reload&quot;</span>);</div><div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7aa719b0c0d0c58b358deaf9933a8dd3f6">AST_MODULE_RELOAD_ERROR</a>:</div><div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;An unknown error occurred&quot;</span>);</div><div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a2a1ae659f41755f987f33586cb43fade">AST_MODULE_RELOAD_IN_PROGRESS</a>:</div><div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;A reload is in progress&quot;</span>);</div><div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7ad06be99930a02b142bf370e2627849be">AST_MODULE_RELOAD_UNINITIALIZED</a>:</div><div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Module not initialized&quot;</span>);</div><div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a3c7e5ccf0a567b17833b1e60ba387abf">AST_MODULE_RELOAD_QUEUED</a>:</div><div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a9696155a2eb5969139965fbc5b8a66ed">AST_MODULE_RELOAD_SUCCESS</a>:</div><div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;      <span class="comment">/* Treat a queued request as success */</span></div><div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Module Reloaded&quot;</span>);</div><div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;   }</div><div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;}</div><div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;<span class="comment">/*! \brief  Manager command &quot;CoreShowChannels&quot; - List currently defined channels</span></div><div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;<span class="comment"> *          and some information about them. */</span></div><div class="line"><a name="l06390"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gad7dbcf9e4437be66192f797b6b740930"> 6390</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gad7dbcf9e4437be66192f797b6b740930">action_coreshowchannels</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;{</div><div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *actionid = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;   <span class="keywordtype">char</span> idText[256];</div><div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;   <span class="keywordtype">int</span> numchans = 0;</div><div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a>;</div><div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> it_chans;</div><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a> *cs;</div><div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;</div><div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(actionid)) {</div><div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, actionid);</div><div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;      idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;   }</div><div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;</div><div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;   channels = <a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gae462040f6444a2a4fc9d2681f49cc99b">ast_channel_cache_by_name</a>();</div><div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;</div><div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a>(s, m, <span class="stringliteral">&quot;Channels will follow&quot;</span>, <span class="stringliteral">&quot;start&quot;</span>);</div><div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;</div><div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;   it_chans = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(channels, 0);</div><div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;   <span class="keywordflow">for</span> (; (cs = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;it_chans)); <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(cs, -1)) {</div><div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *built = <a class="code" href="../../db/d45/manager_8h.html#ab71472ea55b4114f460a4459e3dcd18b">ast_manager_build_channel_state_string_prefix</a>(cs, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;      <span class="keywordtype">char</span> durbuf[16] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;</div><div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;      <span class="keywordflow">if</span> (!built) {</div><div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;      }</div><div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;</div><div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../de/df7/time_8h.html#a4e7b3508884147c7991a68361ac781a2">ast_tvzero</a>(cs-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a298ce3dfc9b5b8a8351e8ed103aa7e5c">creationtime</a>)) {</div><div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;         <span class="keywordtype">int</span> duration, durh, durm, durs;</div><div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;</div><div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;         duration = (int)(<a class="code" href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a>(<a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), cs-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">base</a>-&gt;<a class="code" href="../../d6/d29/structast__channel__snapshot__base.html#a298ce3dfc9b5b8a8351e8ed103aa7e5c">creationtime</a>) / 1000);</div><div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;         durh = duration / 3600;</div><div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;         durm = (duration % 3600) / 60;</div><div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;         durs = duration % 60;</div><div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;         snprintf(durbuf, <span class="keyword">sizeof</span>(durbuf), <span class="stringliteral">&quot;%02d:%02d:%02d&quot;</span>, durh, durm, durs);</div><div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;      }</div><div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;</div><div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s,</div><div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;         <span class="stringliteral">&quot;Event: CoreShowChannel\r\n&quot;</span></div><div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;         <span class="stringliteral">&quot;%s&quot;</span></div><div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;         <span class="stringliteral">&quot;Application: %s\r\n&quot;</span></div><div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;         <span class="stringliteral">&quot;ApplicationData: %s\r\n&quot;</span></div><div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;         <span class="stringliteral">&quot;Duration: %s\r\n&quot;</span></div><div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;         <span class="stringliteral">&quot;BridgeId: %s\r\n&quot;</span></div><div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;         <span class="stringliteral">&quot;\r\n&quot;</span>,</div><div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;         idText,</div><div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(built),</div><div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;         cs-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#a5be1fb9b43b051b087f6952b6346909a">dialplan</a>-&gt;<a class="code" href="../../dc/d3d/structast__channel__snapshot__dialplan.html#af535fe520577fb6b8795dea539bd0230">appl</a>,</div><div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;         cs-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#a5be1fb9b43b051b087f6952b6346909a">dialplan</a>-&gt;<a class="code" href="../../dc/d3d/structast__channel__snapshot__dialplan.html#a7870f447ef3c43ebf148da15363b25dd">data</a>,</div><div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;         durbuf,</div><div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;         cs-&gt;<a class="code" href="../../dd/dbe/structast__channel__snapshot.html#a9c0a621242a8915244954e5a273c8cf7">bridge</a>-&gt;<a class="code" href="../../da/d20/structast__channel__snapshot__bridge.html#abe9e57df6ac773738500092fe3cf7fca">id</a>);</div><div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;</div><div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;      numchans++;</div><div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;</div><div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(built);</div><div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;   }</div><div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;it_chans);</div><div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;</div><div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac9d1d485a1911880e31a3537223b3f9c">astman_send_list_complete</a>(s, m, <span class="stringliteral">&quot;CoreShowChannelsComplete&quot;</span>, numchans);</div><div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;</div><div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(channels, -1);</div><div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;}</div><div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;<span class="comment">/*! \brief  Manager command &quot;LoggerRotate&quot; - reloads and rotates the logger in</span></div><div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;<span class="comment"> *          the same manner as the CLI command &#39;logger rotate&#39;. */</span></div><div class="line"><a name="l06458"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga06c45e1e9264f4a9081b0563e062b0a7"> 6458</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga06c45e1e9264f4a9081b0563e062b0a7">action_loggerrotate</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;{</div><div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8c/logger_8h.html#a146a5fbbca2bf36ef41ec3170e7ca7af">ast_logger_rotate</a>()) {</div><div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Failed to reload the logger and rotate log files&quot;</span>);</div><div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;   }</div><div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;</div><div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Reloaded the logger and rotated log files&quot;</span>);</div><div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;}</div><div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;<span class="comment">/*! \brief Manager function to check if module is loaded */</span></div><div class="line"><a name="l06470"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gac730b751a77b99e3dd3eb4b1880ba933"> 6470</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gac730b751a77b99e3dd3eb4b1880ba933">manager_modulecheck</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;{</div><div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *module = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Module&quot;</span>);</div><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;ActionID&quot;</span>);</div><div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;   <span class="keywordtype">char</span> idText[256];</div><div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;   <span class="keywordtype">char</span> filename[<a class="code" href="../../db/db2/asterisk_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];</div><div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;   <span class="keywordtype">char</span> *cut;</div><div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;</div><div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(filename, module, <span class="keyword">sizeof</span>(filename));</div><div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;   <span class="keywordflow">if</span> ((cut = strchr(filename, <span class="charliteral">&#39;.&#39;</span>))) {</div><div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;      *cut = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;      cut = filename + strlen(filename);</div><div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;   }</div><div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;   snprintf(cut, (<span class="keyword">sizeof</span>(filename) - strlen(filename)) - 1, <span class="stringliteral">&quot;.so&quot;</span>);</div><div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;**** ModuleCheck .so file %s\n&quot;</span>, filename);</div><div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;   res = <a class="code" href="../../d5/d16/module_8h.html#a15f7e2f25f4d0c60de6cca164232a6d4">ast_module_check</a>(filename);</div><div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;   <span class="keywordflow">if</span> (!res) {</div><div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Module not loaded&quot;</span>);</div><div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;   }</div><div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;</div><div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<span class="keywordtype">id</span>)) {</div><div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;      snprintf(idText, <span class="keyword">sizeof</span>(idText), <span class="stringliteral">&quot;ActionID: %s\r\n&quot;</span>, <span class="keywordtype">id</span>);</div><div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;      idText[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;   }</div><div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Response: Success\r\n%s&quot;</span>, idText);</div><div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;<span class="preprocessor">#if !defined(LOW_MEMORY)</span></div><div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(s, <span class="stringliteral">&quot;Version: %s\r\n\r\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;}</div><div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;</div><div class="line"><a name="l06505"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga7c11fab0bce951155235b8e7a2013e1d"> 6505</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c11fab0bce951155235b8e7a2013e1d">manager_moduleload</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;{</div><div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *module = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Module&quot;</span>);</div><div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *loadtype = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;LoadType&quot;</span>);</div><div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;</div><div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;   <span class="keywordflow">if</span> (!loadtype || strlen(loadtype) == 0) {</div><div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Incomplete ModuleLoad action.&quot;</span>);</div><div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;   }</div><div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;   <span class="keywordflow">if</span> ((!module || strlen(module) == 0) &amp;&amp; strcasecmp(loadtype, <span class="stringliteral">&quot;reload&quot;</span>) != 0) {</div><div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Need module name&quot;</span>);</div><div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;   }</div><div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;</div><div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(loadtype, <span class="stringliteral">&quot;load&quot;</span>)) {</div><div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;      res = <a class="code" href="../../d5/d16/module_8h.html#a841766995d4e10ebb3950b10aab97d9e">ast_load_resource</a>(module);</div><div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Could not load module.&quot;</span>);</div><div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Module loaded.&quot;</span>);</div><div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;      }</div><div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(loadtype, <span class="stringliteral">&quot;unload&quot;</span>)) {</div><div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;      res = <a class="code" href="../../d5/d16/module_8h.html#a52f6615f305951a0d61adc6e61920c34">ast_unload_resource</a>(module, <a class="code" href="../../d5/d16/module_8h.html#ac034ec04e9dd255a0d39bdfcb73113b9a10bb7955de423b36c75f645de78d2f39">AST_FORCE_SOFT</a>);</div><div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;      <span class="keywordflow">if</span> (res) {</div><div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Could not unload module.&quot;</span>);</div><div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Module unloaded.&quot;</span>);</div><div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;      }</div><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(loadtype, <span class="stringliteral">&quot;reload&quot;</span>)) {</div><div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;      <span class="comment">/* TODO: Unify the ack/error messages here with action_reload */</span></div><div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(module)) {</div><div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;         <span class="keyword">enum</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7">ast_module_reload_result</a> reload_res = <a class="code" href="../../d5/d16/module_8h.html#af9e3b4ae730e43312e00fcbc1707588b">ast_module_reload</a>(module);</div><div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;</div><div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;         <span class="keywordflow">switch</span> (reload_res) {</div><div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7ac0be7032578c68902708da91e5e7d71a">AST_MODULE_RELOAD_NOT_FOUND</a>:</div><div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;No such module.&quot;</span>);</div><div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7aae470b102da613cbd14c611b36e75b11">AST_MODULE_RELOAD_NOT_IMPLEMENTED</a>:</div><div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Module does not support reload action.&quot;</span>);</div><div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7aa719b0c0d0c58b358deaf9933a8dd3f6">AST_MODULE_RELOAD_ERROR</a>:</div><div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;An unknown error occurred&quot;</span>);</div><div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a2a1ae659f41755f987f33586cb43fade">AST_MODULE_RELOAD_IN_PROGRESS</a>:</div><div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;A reload is in progress&quot;</span>);</div><div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7ad06be99930a02b142bf370e2627849be">AST_MODULE_RELOAD_UNINITIALIZED</a>:</div><div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Module not initialized&quot;</span>);</div><div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a3c7e5ccf0a567b17833b1e60ba387abf">AST_MODULE_RELOAD_QUEUED</a>:</div><div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a9696155a2eb5969139965fbc5b8a66ed">AST_MODULE_RELOAD_SUCCESS</a>:</div><div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;            <span class="comment">/* Treat a queued request as success */</span></div><div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;Module reloaded.&quot;</span>);</div><div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;         }</div><div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;         <a class="code" href="../../d5/d16/module_8h.html#af9e3b4ae730e43312e00fcbc1707588b">ast_module_reload</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);   <span class="comment">/* Reload all modules */</span></div><div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a>(s, m, <span class="stringliteral">&quot;All modules reloaded&quot;</span>);</div><div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;      }</div><div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;   } <span class="keywordflow">else</span></div><div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Incomplete ModuleLoad action.&quot;</span>);</div><div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;}</div><div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;</div><div class="line"><a name="l06568"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga156e867b0f9693ddc7225adf19b6044b"> 6568</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga156e867b0f9693ddc7225adf19b6044b">log_action</a>(<span class="keyword">const</span> <span class="keyword">struct</span> message *m, <span class="keyword">const</span> <span class="keywordtype">char</span> *action)</div><div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;{</div><div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;   <span class="keywordtype">int</span> x;</div><div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;</div><div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a>) {</div><div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;   }</div><div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;</div><div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;   buf = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(256);</div><div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;   <span class="keywordflow">if</span> (!buf) {</div><div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;   }</div><div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;</div><div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>; ++x) {</div><div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;      <span class="keywordflow">if</span> (!strncasecmp(m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x], <span class="stringliteral">&quot;Secret&quot;</span>, 6)) {</div><div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;Secret: &lt;redacted from logging&gt;\n&quot;</span>);</div><div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;%s\n&quot;</span>, m-&gt;<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[x]);</div><div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;      }</div><div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;   }</div><div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;</div><div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;   <a class="code" href="../../d4/dc5/extconf_8c.html#a81d26348827b996085d4cb6be3e2c348">ast_verbose</a>(<span class="stringliteral">&quot;&lt;--- Examining AMI action: --&gt;\n%s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf));</div><div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buf);</div><div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;}</div><div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;</div><div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;<span class="comment"> * Done with the action handlers here, we start with the code in charge</span></div><div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;<span class="comment"> * of accepting connections and serving them.</span></div><div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;<span class="comment"> * accept_thread() forks a new thread for each connection, session_do(),</span></div><div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;<span class="comment"> * which in turn calls get_input() repeatedly until a full message has</span></div><div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;<span class="comment"> * been accumulated, and then invokes process_message() to pass it to</span></div><div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;<span class="comment"> * the appropriate handler.</span></div><div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;<span class="comment">/*! \brief</span></div><div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;<span class="comment"> * Process an AMI message, performing desired action.</span></div><div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;<span class="comment"> * Return 0 on success, -1 on error that require the session to be destroyed.</span></div><div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06607"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga10113617fccfd71f696509a270385169"> 6607</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m)</div><div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;{</div><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;   <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *act_found;</div><div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *username;</div><div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *action;</div><div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;</div><div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;   action = <a class="code" href="../../df/d72/group__Group__AMI.html#ga5106d8afed1eac24399cc5d57ab0c7e6">__astman_get_header</a>(m, <span class="stringliteral">&quot;Action&quot;</span>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaa0b13360e4e6387c7a73239b67a19d57">GET_HEADER_SKIP_EMPTY</a>);</div><div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(action)) {</div><div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gae3ee6e147a9a6e5ee1cd6bd91a194c07">report_req_bad_format</a>(s, <span class="stringliteral">&quot;NONE&quot;</span>);</div><div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Missing action in request&quot;</span>);</div><div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;   }</div><div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;</div><div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga156e867b0f9693ddc7225adf19b6044b">log_action</a>(m, action);</div><div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;</div><div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/db2/asterisk_8h.html#a6b112b17aed018d85c397e7591948793">ast_shutting_down</a>()) {</div><div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to process manager action &#39;%s&#39;. Asterisk is shutting down.\n&quot;</span>, action);</div><div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Asterisk is shutting down&quot;</span>);</div><div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;   }</div><div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;</div><div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;   <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a></div><div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;      &amp;&amp; strcasecmp(action, <span class="stringliteral">&quot;Login&quot;</span>)</div><div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;      &amp;&amp; strcasecmp(action, <span class="stringliteral">&quot;Logoff&quot;</span>)</div><div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;      &amp;&amp; strcasecmp(action, <span class="stringliteral">&quot;Challenge&quot;</span>)) {</div><div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;      <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {</div><div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gaa6a02209ea6747897dfd5249fe631105">report_req_not_allowed</a>(s, action);</div><div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;      }</div><div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Permission denied&quot;</span>);</div><div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;   }</div><div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;</div><div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;   <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a></div><div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;      &amp;&amp; (!strcasecmp(action, <span class="stringliteral">&quot;Login&quot;</span>)</div><div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;         || !strcasecmp(action, <span class="stringliteral">&quot;Challenge&quot;</span>))) {</div><div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;      username = <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;Username&quot;</span>);</div><div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;</div><div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(username) &amp;&amp; <a class="code" href="../../df/d72/group__Group__AMI.html#ga91820dbca9ccfa57da1a8c3c183a56a4">check_manager_session_inuse</a>(username)) {</div><div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;         user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(username);</div><div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;         <span class="keywordflow">if</span> (user &amp;&amp; !user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a>) {</div><div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;            <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#gab68a64554e2df0f2d926faf603848aed">report_session_limit</a>(s);</div><div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;            sleep(1);</div><div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Login Already In Use&quot;</span>);</div><div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;         }</div><div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;      }</div><div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;   }</div><div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;</div><div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;   act_found = <a class="code" href="../../df/d72/group__Group__AMI.html#gaee7a640cdb6c8442d7fc7e7914406e5a">action_find</a>(action);</div><div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;   <span class="keywordflow">if</span> (act_found) {</div><div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;      <span class="comment">/* Found the requested AMI action. */</span></div><div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;      <span class="keywordtype">int</span> acted = 0;</div><div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;</div><div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;      <span class="keywordflow">if</span> ((s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> &amp; act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">authority</a>)</div><div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;         || act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">authority</a> == 0) {</div><div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;         <span class="comment">/* We have the authority to execute the action. */</span></div><div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;         ret = -1;</div><div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(act_found);</div><div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;         <span class="keywordflow">if</span> (act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#acee2bf9117848b5ffbbebb64a540e19f">registered</a> &amp;&amp; act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab0bef752de7f442d29017ea812092d91">func</a>) {</div><div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../d9/df5/structast__module.html">ast_module</a> *mod_ref = <a class="code" href="../../d5/d16/module_8h.html#ad2dd3dce05926913c40b883cc7cff0a8">ast_module_running_ref</a>(act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>);</div><div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;</div><div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(act_found);</div><div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;            <span class="keywordflow">if</span> (mod_ref || !act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a>) {</div><div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;               <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Running action &#39;%s&#39;\n&quot;</span>, act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>);</div><div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;               ret = act_found-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab0bef752de7f442d29017ea812092d91">func</a>(s, m);</div><div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;               acted = 1;</div><div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;               <a class="code" href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a>(mod_ref);</div><div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;            }</div><div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(act_found);</div><div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;         }</div><div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;      }</div><div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;      <span class="keywordflow">if</span> (!acted) {</div><div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;<span class="comment">          * We did not execute the action because access was denied, it</span></div><div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;<span class="comment">          * was no longer registered, or no action was really registered.</span></div><div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;<span class="comment">          * Complain about it and leave.</span></div><div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gaa6a02209ea6747897dfd5249fe631105">report_req_not_allowed</a>(s, action);</div><div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, <span class="stringliteral">&quot;Permission denied&quot;</span>);</div><div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;      }</div><div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(act_found, -1, <span class="stringliteral">&quot;done with found action object&quot;</span>);</div><div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[512];</div><div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;</div><div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gae3ee6e147a9a6e5ee1cd6bd91a194c07">report_req_bad_format</a>(s, action);</div><div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;      snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;Invalid/unknown command: %s. Use Action: ListCommands to show available commands.&quot;</span>, action);</div><div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, buf);</div><div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;   }</div><div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;   <span class="keywordflow">if</span> (ret) {</div><div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;   }</div><div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;   <span class="comment">/* Once done with our message, deliver any pending events unless the</span></div><div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;<span class="comment">      requester doesn&#39;t want them as part of this response.</span></div><div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a>(m, <span class="stringliteral">&quot;SuppressEvents&quot;</span>))) {</div><div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab2b9c596c9d6eb5dac8fe5f3d7588f50">process_events</a>(s);</div><div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;   }</div><div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;}</div><div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;<span class="comment"> * Read one full line (including crlf) from the manager socket.</span></div><div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;<span class="comment"> * \note \verbatim</span></div><div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;<span class="comment"> * \r\n is the only valid terminator for the line.</span></div><div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;<span class="comment"> * (Note that, later, &#39;\0&#39; will be considered as the end-of-line marker,</span></div><div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;<span class="comment"> * so everything between the &#39;\0&#39; and the &#39;\r\n&#39; will not be used).</span></div><div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;<span class="comment"> * Also note that we assume output to have at least &quot;maxlen&quot; space.</span></div><div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;<span class="comment"> * \endverbatim</span></div><div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06735"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga460510e6866d4785ec6bd0181c443739"> 6735</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga460510e6866d4785ec6bd0181c443739">get_input</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keywordtype">char</span> *output)</div><div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;{</div><div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;   <span class="keywordtype">int</span> res, x;</div><div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;   <span class="keywordtype">int</span> maxlen = <span class="keyword">sizeof</span>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac56f44f8863e74f246f657bdcf7bdcd1">inbuf</a>) - 1;</div><div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;   <span class="keywordtype">char</span> *src = s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac56f44f8863e74f246f657bdcf7bdcd1">inbuf</a>;</div><div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;   <span class="keywordtype">int</span> timeout = -1;</div><div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;   time_t now;</div><div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;</div><div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;<span class="comment">    * Look for \r\n within the buffer. If found, copy to the output</span></div><div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;<span class="comment">    * buffer and return, trimming the \r\n (not used afterwards).</span></div><div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;   <span class="keywordflow">for</span> (x = 0; x &lt; s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a>; x++) {</div><div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;      <span class="keywordtype">int</span> cr;  <span class="comment">/* set if we have \r */</span></div><div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;      <span class="keywordflow">if</span> (src[x] == <span class="charliteral">&#39;\r&#39;</span> &amp;&amp; x+1 &lt; s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a> &amp;&amp; src[x + 1] == <span class="charliteral">&#39;\n&#39;</span>) {</div><div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;         cr = 2;  <span class="comment">/* Found. Update length to include \r\n */</span></div><div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (src[x] == <span class="charliteral">&#39;\n&#39;</span>) {</div><div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;         cr = 1;  <span class="comment">/* also accept \n only */</span></div><div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;      }</div><div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;      memmove(output, src, x);   <span class="comment">/*... but trim \r\n */</span></div><div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;      output[x] = <span class="charliteral">&#39;\0&#39;</span>;    <span class="comment">/* terminate the string */</span></div><div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;      x += cr;       <span class="comment">/* number of bytes used */</span></div><div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a> -= x;       <span class="comment">/* remaining size */</span></div><div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;      memmove(src, src + x, s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a>); <span class="comment">/* remove used bytes */</span></div><div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;   }</div><div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a> &gt;= maxlen) {</div><div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;      <span class="comment">/* no crlf found, and buffer full - sorry, too long for us</span></div><div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;<span class="comment">       * keep the last character in case we are in the middle of a CRLF. */</span></div><div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Discarding message from %s. Line too long: %.25s...\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>), src);</div><div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;      src[0] = src[s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a> - 1];</div><div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a> = 1;</div><div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab91b0fdf6f7223e7889b0bafe6c81639">parsing</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344af59be521b8f1a6985f831b7b850a8fc9">MESSAGE_LINE_TOO_LONG</a>;</div><div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;   }</div><div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;   res = 0;</div><div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;   <span class="keywordflow">while</span> (res == 0) {</div><div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;      <span class="comment">/* calculate a timeout if we are not authenticated */</span></div><div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;      <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {</div><div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;         <span class="keywordflow">if</span>(time(&amp;now) == -1) {</div><div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;error executing time(): %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;         }</div><div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;</div><div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;         timeout = (<a class="code" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a> - (now - s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a6bafd2f5dfdc170245b389db21bd81f8">authstart</a>)) * 1000;</div><div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;         <span class="keywordflow">if</span> (timeout &lt; 0) {</div><div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;            <span class="comment">/* we have timed out */</span></div><div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;         }</div><div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;      }</div><div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;</div><div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;      <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a77d36f7d3efdab912ada2ef54a75cc65">pending_event</a>) {</div><div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;         s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a77d36f7d3efdab912ada2ef54a75cc65">pending_event</a> = 0;</div><div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;      }</div><div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> = pthread_self();</div><div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;</div><div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;      res = <a class="code" href="../../d5/d60/utils_8h.html#a60404ef44696316455e79c3a002cc71e">ast_wait_for_input</a>(<a class="code" href="../../dd/d27/iostream_8h.html#a6ebb2730257107d3535fe6cb1285f479">ast_iostream_get_fd</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>), timeout);</div><div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;</div><div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>;</div><div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;   }</div><div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;   <span class="keywordflow">if</span> (res &lt; 0) {</div><div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;      <span class="comment">/* If we get a signal from some other thread (typically because</span></div><div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;<span class="comment">       * there are new events queued), return 0 to notify the caller.</span></div><div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EINTR || <a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EAGAIN) {</div><div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;      }</div><div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;poll() returned error: %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;   }</div><div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;</div><div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;   res = <a class="code" href="../../dd/d27/iostream_8h.html#aa009ff0c2d31892c5beb19114f47768b">ast_iostream_read</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>, src + s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a>, maxlen - s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a>);</div><div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;   <span class="keywordflow">if</span> (res &lt; 1) {</div><div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;      res = -1;   <span class="comment">/* error return */</span></div><div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a> += res;</div><div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;      src[s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">inlen</a>] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;      res = 0;</div><div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;   }</div><div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>);</div><div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;}</div><div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;<span class="comment"> * \brief Error handling for sending parse errors. This function handles locking, and clearing the</span></div><div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;<span class="comment"> * parse error flag.</span></div><div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;<span class="comment"> * \param s AMI session to process action request.</span></div><div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;<span class="comment"> * \param m Message that&#39;s in error.</span></div><div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;<span class="comment"> * \param error Error message to send.</span></div><div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06835"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga7a69d5366de99cd023fe903f6edee0a8"> 6835</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga7a69d5366de99cd023fe903f6edee0a8">handle_parse_error</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">struct</span> message *m, <span class="keywordtype">char</span> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a>)</div><div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;{</div><div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, m, error);</div><div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;   s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab91b0fdf6f7223e7889b0bafe6c81639">parsing</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344a4062487b032b9348705c5ff65d21d777">MESSAGE_OKAY</a>;</div><div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;}</div><div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;<span class="comment"> * \brief Read and process an AMI action request.</span></div><div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;<span class="comment"> * \param s AMI session to process action request.</span></div><div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;<span class="comment"> * \retval 0 Retain AMI connection for next command.</span></div><div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;<span class="comment"> * \retval -1 Drop AMI connection due to logoff or connection error.</span></div><div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06852"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga32ac2419647ed028f30dc1de0f01056e"> 6852</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga32ac2419647ed028f30dc1de0f01056e">do_message</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;{</div><div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;   <span class="keyword">struct </span>message m = { 0 };</div><div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;   <span class="keywordtype">char</span> header_buf[<span class="keyword">sizeof</span>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac56f44f8863e74f246f657bdcf7bdcd1">inbuf</a>)] = { <span class="charliteral">&#39;\0&#39;</span> };</div><div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;   <span class="keywordtype">int</span> hdr_loss;</div><div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;   time_t now;</div><div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;</div><div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;   hdr_loss = 0;</div><div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;      <span class="comment">/* Check if any events are pending and do them if needed */</span></div><div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gab2b9c596c9d6eb5dac8fe5f3d7588f50">process_events</a>(s)) {</div><div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;         res = -1;</div><div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;      }</div><div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;      res = <a class="code" href="../../df/d72/group__Group__AMI.html#ga460510e6866d4785ec6bd0181c443739">get_input</a>(s, header_buf);</div><div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;      <span class="keywordflow">if</span> (res == 0) {</div><div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;         <span class="comment">/* No input line received. */</span></div><div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;         <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {</div><div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;            <span class="keywordflow">if</span> (time(&amp;now) == -1) {</div><div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;error executing time(): %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;               res = -1;</div><div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;            }</div><div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;</div><div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;            <span class="keywordflow">if</span> (now - s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a6bafd2f5dfdc170245b389db21bd81f8">authstart</a> &gt; <a class="code" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a>) {</div><div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;               <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>) {</div><div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;                  <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Client from %s, failed to authenticate in %d seconds\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>), <a class="code" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a>);</div><div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;               }</div><div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;               res = -1;</div><div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;            }</div><div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;         }</div><div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (res &gt; 0) {</div><div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;         <span class="comment">/* Input line received. */</span></div><div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(header_buf)) {</div><div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;            <span class="keywordflow">if</span> (hdr_loss) {</div><div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;               <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a>(s);</div><div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;               <a class="code" href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a>(s, &amp;m, <span class="stringliteral">&quot;Too many lines in message or allocation failure&quot;</span>);</div><div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;               <a class="code" href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a>(s);</div><div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;               res = 0;</div><div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;               <span class="keywordflow">switch</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab91b0fdf6f7223e7889b0bafe6c81639">parsing</a>) {</div><div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;               <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344a4062487b032b9348705c5ff65d21d777">MESSAGE_OKAY</a>:</div><div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;                  res = <a class="code" href="../../df/d72/group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message</a>(s, &amp;m) ? -1 : 0;</div><div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;               <span class="keywordflow">case</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344af59be521b8f1a6985f831b7b850a8fc9">MESSAGE_LINE_TOO_LONG</a>:</div><div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;                  <a class="code" href="../../df/d72/group__Group__AMI.html#ga7a69d5366de99cd023fe903f6edee0a8">handle_parse_error</a>(s, &amp;m, <span class="stringliteral">&quot;Failed to parse message: line too long&quot;</span>);</div><div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;                  res = 0;</div><div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;               }</div><div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;            }</div><div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m.<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a> &lt; <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(m.<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>)) {</div><div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;            m.<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m.<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>] = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(header_buf);</div><div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;            <span class="keywordflow">if</span> (!m.<a class="code" href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">headers</a>[m.<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>]) {</div><div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;               <span class="comment">/* Allocation failure. */</span></div><div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;               hdr_loss = 1;</div><div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;               ++m.<a class="code" href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">hdrcount</a>;</div><div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;            }</div><div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;            <span class="comment">/* Too many lines in message. */</span></div><div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;            hdr_loss = 1;</div><div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;         }</div><div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;         <span class="comment">/* Input error. */</span></div><div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;      }</div><div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;   }</div><div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;</div><div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga1b557a85c122f479896a9f598ee49116">astman_free_headers</a>(&amp;m);</div><div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;</div><div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;}</div><div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;<span class="comment"></span></div><div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;<span class="comment">/*! \brief The body of the individual manager session.</span></div><div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;<span class="comment"> * Call get_input() to read one line at a time</span></div><div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;<span class="comment"> * (or be woken up on new events), collect the lines in a</span></div><div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;<span class="comment"> * message until found an empty line, and execute the request.</span></div><div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;<span class="comment"> * In any case, deliver events asynchronously through process_events()</span></div><div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;<span class="comment"> * (called from here if no line is available, or at the end of</span></div><div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;<span class="comment"> * process_message(). )</span></div><div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06937"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa457796588f0d13a7dc02e3db64c2e7d"> 6937</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> *<a class="code" href="../../df/d72/group__Group__AMI.html#gaa457796588f0d13a7dc02e3db64c2e7d">session_do</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;{</div><div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser = data;</div><div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d8a/structmansession.html">mansession</a> s = {</div><div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;      .<a class="code" href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">tcptls_session</a> = data,</div><div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;   };</div><div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;   <span class="keywordtype">int</span> arg = 1;</div><div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ser_remote_address_tmp;</div><div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;</div><div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a>, +1) &gt;= <a class="code" href="../../df/d72/group__Group__AMI.html#ga8f05cdf013e1e5fe03ea2615e681bf58">authlimit</a>) {</div><div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a>, -1);</div><div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;   }</div><div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;</div><div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser_remote_address_tmp, &amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>);</div><div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;   session = <a class="code" href="../../df/d72/group__Group__AMI.html#ga8547b9864f771b59843128a2054d7c47">build_mansession</a>(&amp;ser_remote_address_tmp);</div><div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;</div><div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;   <span class="keywordflow">if</span> (session == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a>, -1);</div><div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;   }</div><div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;</div><div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;   <span class="comment">/* here we set TCP_NODELAY on the socket to disable Nagle&#39;s algorithm.</span></div><div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;<span class="comment">    * This is necessary to prevent delays (caused by buffering) as we</span></div><div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;<span class="comment">    * write to the socket in bits and pieces. */</span></div><div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;   <span class="keywordflow">if</span> (setsockopt(<a class="code" href="../../dd/d27/iostream_8h.html#a6ebb2730257107d3535fe6cb1285f479">ast_iostream_get_fd</a>(ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>), IPPROTO_TCP, TCP_NODELAY, (<span class="keywordtype">char</span> *) &amp;arg, <span class="keyword">sizeof</span>(arg)) &lt; 0) {</div><div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Failed to set TCP_NODELAY on manager connection: %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;   }</div><div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;   <a class="code" href="../../dd/d27/iostream_8h.html#ab426c2063464fc2e2719f8edd9e03085">ast_iostream_nonblock</a>(ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>);</div><div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;</div><div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;   <span class="comment">/* Hook to the tail of the event queue */</span></div><div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;   session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5">grab_last</a>();</div><div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;</div><div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;s.<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;</div><div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;   <span class="comment">/* these fields duplicate those in the &#39;ser&#39; structure */</span></div><div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;   session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> = s.<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> = ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>;</div><div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>, &amp;ser_remote_address_tmp);</div><div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;   s.<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;</div><div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>);</div><div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;</div><div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;   <span class="keywordflow">if</span>(time(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a6bafd2f5dfdc170245b389db21bd81f8">authstart</a>) == -1) {</div><div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;error executing time(): %s; disconnecting client\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a>, -1);</div><div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5">session_destroy</a>(session);</div><div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>;</div><div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;   }</div><div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;</div><div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;<span class="comment">    * We cannot let the stream exclusively wait for data to arrive.</span></div><div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;<span class="comment">    * We have to wake up the task to send async events.</span></div><div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;   <a class="code" href="../../dd/d27/iostream_8h.html#a7da9c8f9652decad87fdb8d39c4f06df">ast_iostream_set_exclusive_input</a>(ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>, 0);</div><div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;</div><div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;   <a class="code" href="../../dd/d27/iostream_8h.html#aa8aec9f4431f3420f3ffa925e4dc306a">ast_iostream_set_timeout_sequence</a>(ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>,</div><div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;      <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>(), <a class="code" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a> * 1000);</div><div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;</div><div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a>(&amp;s, <span class="stringliteral">&quot;Asterisk Call Manager/%s\r\n&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a9aa10c963efd367eaab256f4a05db100">AMI_VERSION</a>);   <span class="comment">/* welcome prompt */</span></div><div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;   <span class="keywordflow">for</span> (;;) {</div><div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;      <span class="keywordflow">if</span> ((res = <a class="code" href="../../df/d72/group__Group__AMI.html#ga32ac2419647ed028f30dc1de0f01056e">do_message</a>(&amp;s)) &lt; 0 || s.<a class="code" href="../../d2/d8a/structmansession.html#a4905d9704cb1eb3ff285e4fb8aa9c68d">write_error</a>) {</div><div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;      }</div><div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {</div><div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;         <a class="code" href="../../dd/d27/iostream_8h.html#ace332a00f395eb7d1c93d0ee00bdf6c2">ast_iostream_set_timeout_disable</a>(ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>);</div><div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;      }</div><div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;   }</div><div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;   <span class="comment">/* session is over, explain why and terminate */</span></div><div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {</div><div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010">manager_displayconnects</a>(session)) {</div><div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Manager &#39;%s&#39; logged off from %s\n&quot;</span>, session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;      }</div><div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;      <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a>, -1);</div><div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>) {</div><div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Connect attempt from &#39;%s&#39; unable to authenticate\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;      }</div><div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;   }</div><div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;</div><div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5">session_destroy</a>(session);</div><div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;</div><div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;s.<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;<a class="code" href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a>:</div><div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(ser, -1);</div><div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;   ser = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;}</div><div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;<span class="comment">/*! \brief remove at most n_max stale session from the list. */</span></div><div class="line"><a name="l07031"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaa98613bbc66bdf99b8423afcfc4f9b2c"> 7031</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaa98613bbc66bdf99b8423afcfc4f9b2c">purge_sessions</a>(<span class="keywordtype">int</span> n_max)</div><div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;{</div><div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;   time_t now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;</div><div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;   <span class="keywordflow">if</span> (!sessions) {</div><div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;   }</div><div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sessions, 0);</div><div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;   <span class="keywordflow">while</span> ((session = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i)) &amp;&amp; n_max &gt; 0) {</div><div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">sessiontimeout</a> &amp;&amp; (now &gt; session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">sessiontimeout</a>) &amp;&amp; !session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>) {</div><div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a></div><div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;            &amp;&amp; <a class="code" href="../../d1/d8c/logger_8h.html#a7d52159deec8b3179d27fcb4d39c30d2">VERBOSITY_ATLEAST</a>(2)</div><div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;            &amp;&amp; <a class="code" href="../../df/d72/group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010">manager_displayconnects</a>(session)) {</div><div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;HTTP Manager &#39;%s&#39; timed out from %s\n&quot;</span>,</div><div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;               session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;         }</div><div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5">session_destroy</a>(session);</div><div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;         n_max--;</div><div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;      }</div><div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;   }</div><div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;}</div><div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;<span class="comment">/*! \brief</span></div><div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;<span class="comment"> * events are appended to a queue from where they</span></div><div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;<span class="comment"> * can be dispatched to clients.</span></div><div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07068"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gae456544c8bf8d684b871f41851f8eab1"> 7068</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gae456544c8bf8d684b871f41851f8eab1">append_event</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a>, <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>)</div><div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;{</div><div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d94/structeventqent.html">eventqent</a> *<a class="code" href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a>(<span class="keyword">sizeof</span>(*tmp) + strlen(str));</div><div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a1db4845df10d789835dcc97c392a2fe6">seq</a>;   <span class="comment">/* sequence number */</span></div><div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;</div><div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;   <span class="keywordflow">if</span> (!tmp) {</div><div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;   }</div><div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;</div><div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;   <span class="comment">/* need to init all fields, because ast_malloc() does not */</span></div><div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;   tmp-&gt;<a class="code" href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">usecount</a> = 0;</div><div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;   tmp-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a> = <a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>;</div><div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;   tmp-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a1db4845df10d789835dcc97c392a2fe6">seq</a> = <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;seq, 1);</div><div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;   tmp-&gt;<a class="code" href="../../d9/d94/structeventqent.html#a9cf96982557d56650f0f4cd3762f05a0">tv</a> = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a5c021d1e034a53d09360da4d95c76220">AST_RWLIST_NEXT</a>(tmp, eq_next) = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;   strcpy(tmp-&gt;eventdata, str);</div><div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;</div><div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>, tmp, eq_next);</div><div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d2/d3e/structall__events.html">all_events</a>);</div><div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;</div><div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;}</div><div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;</div><div class="line"><a name="l07092"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga42ac3bf839aaa226509162987fcf695d"> 7092</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga42ac3bf839aaa226509162987fcf695d">append_channel_vars</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **pbuf, <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan)</div><div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;{</div><div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/de6/structvarshead.html">varshead</a> *vars;</div><div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d0/d7d/structast__var__t.html">ast_var_t</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;</div><div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;   vars = <a class="code" href="../../d5/d7b/channel_8h.html#a5f72bc09af81d17c4ecebf77cea38508">ast_channel_get_manager_vars</a>(chan);</div><div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;   <span class="keywordflow">if</span> (!vars) {</div><div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;   }</div><div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;</div><div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(vars, var, entries) {</div><div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(pbuf, 0, <span class="stringliteral">&quot;ChanVariable(%s): %s=%s\r\n&quot;</span>, <a class="code" href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a>(chan), var-&gt;<a class="code" href="../../d0/d7d/structast__var__t.html#a2a7f851274ec18e17d38114c39b8511a">name</a>, var-&gt;<a class="code" href="../../d0/d7d/structast__var__t.html#a325611b97f57f55a57b2a7cf3238ef54">value</a>);</div><div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;   }</div><div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(vars, -1);</div><div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;}</div><div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;</div><div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;<span class="comment">/* XXX see if can be moved inside the function */</span></div><div class="line"><a name="l07109"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga2e585cbfd7440aa94b0eb20ff93f1c3c"> 7109</a></span>&#160;<a class="code" href="../../dc/d7d/threadstorage_8h.html#ac268c0a8272ec11e73269392507fb1a6">AST_THREADSTORAGE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga2e585cbfd7440aa94b0eb20ff93f1c3c">manager_event_buf</a>);</div><div class="line"><a name="l07110"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaf5f8f8fba6bc87e2788f8075148eb3ed"> 7110</a></span>&#160;<span class="preprocessor">#define MANAGER_EVENT_BUF_INITSIZE   256</span></div><div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;</div><div class="line"><a name="l07112"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gafaa1369a2d928db0f753144acdeb2ed1"> 7112</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> __attribute__((<a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>(printf, 9, 0))) <a class="code" href="../../df/d72/group__Group__AMI.html#gafaa1369a2d928db0f753144acdeb2ed1">__manager_event_sessions_va</a>(</div><div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;   struct <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d3/d0a/structsessions.html">sessions</a>,</div><div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>,</div><div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;   const <span class="keywordtype">char</span> *<a class="code" href="../../df/d7d/structevent.html">event</a>,</div><div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d28/channel_8c.html#a5cb129ce1d580dbb22ec9573dcb62f7f">chancount</a>,</div><div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;   struct <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> **<a class="code" href="../../d6/d75/structchans.html">chans</a>,</div><div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;   const <span class="keywordtype">char</span> *<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>,</div><div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;   <span class="keywordtype">int</span> line,</div><div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;   const <span class="keywordtype">char</span> *func,</div><div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;   const <span class="keywordtype">char</span> *fmt,</div><div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;   va_list ap)</div><div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;{</div><div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *auth = <a class="code" href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b">MAX_AUTH_PERM_STRING</a>);</div><div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *cat_str;</div><div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;   <span class="keyword">struct </span>timeval now;</div><div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;</div><div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;   buf = <a class="code" href="../../d6/d90/strings_8h.html#afe8f5f844f2fd5f5bd5d0be5ef671481">ast_str_thread_get</a>(&amp;<a class="code" href="../../df/d72/group__Group__AMI.html#ga2e585cbfd7440aa94b0eb20ff93f1c3c">manager_event_buf</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaf5f8f8fba6bc87e2788f8075148eb3ed">MANAGER_EVENT_BUF_INITSIZE</a>);</div><div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;   <span class="keywordflow">if</span> (!buf) {</div><div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;   }</div><div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;</div><div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;   cat_str = <a class="code" href="../../df/d72/group__Group__AMI.html#ga57cc8b67a0e4797ab1a608872d51d397">authority_to_str</a>(category, &amp;auth);</div><div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;buf, 0,</div><div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;      <span class="stringliteral">&quot;Event: %s\r\n&quot;</span></div><div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;      <span class="stringliteral">&quot;Privilege: %s\r\n&quot;</span>,</div><div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;      event, cat_str);</div><div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;</div><div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab">timestampevents</a>) {</div><div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;      now = <a class="code" href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a>();</div><div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0,</div><div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;         <span class="stringliteral">&quot;Timestamp: %ld.%06lu\r\n&quot;</span>,</div><div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;         (<span class="keywordtype">long</span>)now.tv_sec, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) now.tv_usec);</div><div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;   }</div><div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a>) {</div><div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a1db4845df10d789835dcc97c392a2fe6">seq</a>;</div><div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;</div><div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0,</div><div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;         <span class="stringliteral">&quot;SequenceNumber: %d\r\n&quot;</span>,</div><div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;seq, 1));</div><div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0,</div><div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;         <span class="stringliteral">&quot;File: %s\r\n&quot;</span></div><div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;         <span class="stringliteral">&quot;Line: %d\r\n&quot;</span></div><div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;         <span class="stringliteral">&quot;Func: %s\r\n&quot;</span>,</div><div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;         file, line, func);</div><div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;   }</div><div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../dd/df2/paths_8h.html#ab9f9346c7a41bdf3720f7b1ed02ec703">ast_config_AST_SYSTEM_NAME</a>)) {</div><div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0,</div><div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;         <span class="stringliteral">&quot;SystemName: %s\r\n&quot;</span>,</div><div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;         <a class="code" href="../../dd/df2/paths_8h.html#ab9f9346c7a41bdf3720f7b1ed02ec703">ast_config_AST_SYSTEM_NAME</a>);</div><div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;   }</div><div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;</div><div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#aadcedfc19bc7df38193262ebb8f3c991">ast_str_append_va</a>(&amp;buf, 0, fmt, ap);</div><div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d4/d28/channel_8c.html#a5cb129ce1d580dbb22ec9573dcb62f7f">chancount</a>; i++) {</div><div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga42ac3bf839aaa226509162987fcf695d">append_channel_vars</a>(&amp;buf, chans[i]);</div><div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;   }</div><div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;</div><div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buf, 0, <span class="stringliteral">&quot;\r\n&quot;</span>);</div><div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;</div><div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gae456544c8bf8d684b871f41851f8eab1">append_event</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf), category);</div><div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;</div><div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;   <span class="comment">/* Wake up any sleeping sessions */</span></div><div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;   <span class="keywordflow">if</span> (sessions) {</div><div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> iter;</div><div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;</div><div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;      iter = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sessions, 0);</div><div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;      <span class="keywordflow">while</span> ((session = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;iter))) {</div><div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> != <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>) {</div><div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;            pthread_kill(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a>, SIGURG);</div><div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;            <span class="comment">/* We have an event to process, but the mansession is</span></div><div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;<span class="comment">             * not waiting for it. We still need to indicate that there</span></div><div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;<span class="comment">             * is an event waiting so that get_input processes the pending</span></div><div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;<span class="comment">             * event instead of polling.</span></div><div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;            session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a77d36f7d3efdab912ada2ef54a75cc65">pending_event</a> = 1;</div><div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;         }</div><div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;      }</div><div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;iter);</div><div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;   }</div><div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;</div><div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;   <span class="keywordflow">if</span> (category != <a class="code" href="../../df/d72/group__Group__AMI.html#gac6a246405a298682d5f34f8856b68461">EVENT_FLAG_SHUTDOWN</a> &amp;&amp; !<a class="code" href="../../df/d90/linkedlists_8h.html#a0044f6572f50a89049b3b5272e51b0e7">AST_RWLIST_EMPTY</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>)) {</div><div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d0/d10/structmanager__custom__hook.html">manager_custom_hook</a> *hook;</div><div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;</div><div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>);</div><div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>, hook, list) {</div><div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;         hook-&gt;<a class="code" href="../../d0/d10/structmanager__custom__hook.html#a563331ff9859f8ff63ed061c4c68d8cd">helper</a>(category, event, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buf));</div><div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;      }</div><div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d5/d26/structmanager__hooks.html">manager_hooks</a>);</div><div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;   }</div><div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;</div><div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;}</div><div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;</div><div class="line"><a name="l07211"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga129789bbb3008b50ad8c848f4a70eb52"> 7211</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> __attribute__((<a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>(printf, 9, 0))) <a class="code" href="../../df/d72/group__Group__AMI.html#ga129789bbb3008b50ad8c848f4a70eb52">__manager_event_sessions</a>(</div><div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;   struct <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d3/d0a/structsessions.html">sessions</a>,</div><div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>,</div><div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;   const <span class="keywordtype">char</span> *<a class="code" href="../../df/d7d/structevent.html">event</a>,</div><div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../d4/d28/channel_8c.html#a5cb129ce1d580dbb22ec9573dcb62f7f">chancount</a>,</div><div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;   struct <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> **<a class="code" href="../../d6/d75/structchans.html">chans</a>,</div><div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;   const <span class="keywordtype">char</span> *<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>,</div><div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;   <span class="keywordtype">int</span> line,</div><div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;   const <span class="keywordtype">char</span> *func,</div><div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;   const <span class="keywordtype">char</span> *fmt,</div><div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;   ...)</div><div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;{</div><div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;   va_list ap;</div><div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;</div><div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;   va_start(ap, fmt);</div><div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;   res = <a class="code" href="../../df/d72/group__Group__AMI.html#gafaa1369a2d928db0f753144acdeb2ed1">__manager_event_sessions_va</a>(sessions, category, event, chancount, chans,</div><div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;      file, line, func, fmt, ap);</div><div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;   va_end(ap);</div><div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;}</div><div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;</div><div class="line"><a name="l07233"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga06f17abfc5db7b42743338b9cb73405e"> 7233</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga06f17abfc5db7b42743338b9cb73405e">__ast_manager_event_multichan</a>(<span class="keywordtype">int</span> <a class="code" href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">category</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../df/d7d/structevent.html">event</a>, <span class="keywordtype">int</span> <a class="code" href="../../d4/d28/channel_8c.html#a5cb129ce1d580dbb22ec9573dcb62f7f">chancount</a>,</div><div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> **<a class="code" href="../../d6/d75/structchans.html">chans</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">file</a>, <span class="keywordtype">int</span> line, <span class="keyword">const</span> <span class="keywordtype">char</span> *func,</div><div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...)</div><div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;{</div><div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d3/d0a/structsessions.html">sessions</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;   va_list ap;</div><div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;</div><div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../df/d72/group__Group__AMI.html#ga8548bdd40d19dc12b6e3709694d5dbd2">any_manager_listeners</a>(sessions)) {</div><div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;      <span class="comment">/* Nobody is listening */</span></div><div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;   }</div><div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;</div><div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;   va_start(ap, fmt);</div><div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;   res = <a class="code" href="../../df/d72/group__Group__AMI.html#gafaa1369a2d928db0f753144acdeb2ed1">__manager_event_sessions_va</a>(sessions, category, event, chancount, chans,</div><div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;      file, line, func, fmt, ap);</div><div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;   va_end(ap);</div><div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(sessions);</div><div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;}</div><div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;<span class="comment">/*! \brief</span></div><div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;<span class="comment"> * support functions to register/unregister AMI action handlers,</span></div><div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07258"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101"> 7258</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *action)</div><div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;{</div><div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *cur;</div><div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;</div><div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, cur, list) {</div><div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(action, cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>)) {</div><div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(list);</div><div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;      }</div><div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;   }</div><div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;</div><div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;   <span class="keywordflow">if</span> (cur) {</div><div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;<span class="comment">       * We have removed the action object from the container so we</span></div><div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;<span class="comment">       * are no longer in a hurry.</span></div><div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(cur);</div><div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;      cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#acee2bf9117848b5ffbbebb64a540e19f">registered</a> = 0;</div><div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(cur);</div><div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;</div><div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(cur, -1, <span class="stringliteral">&quot;action object removed from list&quot;</span>);</div><div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Manager unregistered action %s\n&quot;</span>, action);</div><div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;   }</div><div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;</div><div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;}</div><div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;</div><div class="line"><a name="l07288"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga06909116cc55a2b89ea554e74be04ab6"> 7288</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga06909116cc55a2b89ea554e74be04ab6">manager_state_cb</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a>, <span class="keyword">struct</span> <a class="code" href="../../df/d4c/structast__state__cb__info.html">ast_state_cb_info</a> *<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>, <span class="keywordtype">void</span> *data)</div><div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;{</div><div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;   <span class="comment">/* Notify managers of change */</span></div><div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;   <span class="keywordtype">char</span> hint[512];</div><div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;</div><div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;   hint[0] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#ac778ac642def88a06e5d59e11a964c43">ast_get_hint</a>(hint, <span class="keyword">sizeof</span>(hint), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, context, exten);</div><div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;</div><div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;   <span class="keywordflow">switch</span>(info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#a3a7a902ef9b30b78b595eeee1485090f">reason</a>) {</div><div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#ab077da615e93c9e88ce539bef23f82e6a2e89bd60b1752d920f58a70164607189">AST_HINT_UPDATE_DEVICE</a>:</div><div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a>(<a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <span class="stringliteral">&quot;ExtensionStatus&quot;</span>,</div><div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;         <span class="stringliteral">&quot;Exten: %s\r\n&quot;</span></div><div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;         <span class="stringliteral">&quot;Context: %s\r\n&quot;</span></div><div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;         <span class="stringliteral">&quot;Hint: %s\r\n&quot;</span></div><div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;         <span class="stringliteral">&quot;Status: %d\r\n&quot;</span></div><div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;         <span class="stringliteral">&quot;StatusText: %s\r\n&quot;</span>,</div><div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;         exten,</div><div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;         context,</div><div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;         hint,</div><div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;         info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#a6f3d8aa9a90b701e81dad4cc4a56be67">exten_state</a>,</div><div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;         <a class="code" href="../../db/de0/pbx_8h.html#a3261603753916b98888a5a5fc1d505c3">ast_extension_state2str</a>(info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#a6f3d8aa9a90b701e81dad4cc4a56be67">exten_state</a>));</div><div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../db/de0/pbx_8h.html#ab077da615e93c9e88ce539bef23f82e6a72b959e4767d5a4c644c6232122f5ad9">AST_HINT_UPDATE_PRESENCE</a>:</div><div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a>(<a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <span class="stringliteral">&quot;PresenceStatus&quot;</span>,</div><div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;         <span class="stringliteral">&quot;Exten: %s\r\n&quot;</span></div><div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;         <span class="stringliteral">&quot;Context: %s\r\n&quot;</span></div><div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;         <span class="stringliteral">&quot;Hint: %s\r\n&quot;</span></div><div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;         <span class="stringliteral">&quot;Status: %s\r\n&quot;</span></div><div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;         <span class="stringliteral">&quot;Subtype: %s\r\n&quot;</span></div><div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;         <span class="stringliteral">&quot;Message: %s\r\n&quot;</span>,</div><div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;         exten,</div><div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;         context,</div><div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;         hint,</div><div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;         <a class="code" href="../../d6/dd7/presencestate_8h.html#aec78c2b072d51416200d34bdd06827a7">ast_presence_state2str</a>(info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#adbd2034543f941d4cf84f129faee9a0b">presence_state</a>),</div><div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;         info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#a662bbfb7890c12ee79a4ef1ea5f42a0c">presence_subtype</a>,</div><div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;         info-&gt;<a class="code" href="../../df/d4c/structast__state__cb__info.html#afb0bd6506905ab8d17df1d8bb3294fc5">presence_message</a>);</div><div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;   }</div><div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;}</div><div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;</div><div class="line"><a name="l07329"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga1f6d4d99712fba3bb1075b0984bc2731"> 7329</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga1f6d4d99712fba3bb1075b0984bc2731">ast_manager_register_struct</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *act)</div><div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;{</div><div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *cur, *<a class="code" href="../../d7/db2/structast__category.html#aead9e40ff1500d1b7cafee63463122ed">prev</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;</div><div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, cur, list) {</div><div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;      <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;</div><div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;      ret = strcasecmp(cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>, act-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>);</div><div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;      <span class="keywordflow">if</span> (ret == 0) {</div><div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Manager: Action &#39;%s&#39; already registered\n&quot;</span>, act-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>);</div><div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;      }</div><div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;      <span class="keywordflow">if</span> (ret &gt; 0) { <span class="comment">/* Insert these alphabetically */</span></div><div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;      }</div><div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;      prev = cur;</div><div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;   }</div><div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;</div><div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(act, +1, <span class="stringliteral">&quot;action object added to list&quot;</span>);</div><div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;   act-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#acee2bf9117848b5ffbbebb64a540e19f">registered</a> = 1;</div><div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;   <span class="keywordflow">if</span> (prev) {</div><div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a5937d72e8b39660a1b824af2042c0e9c">AST_RWLIST_INSERT_AFTER</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, prev, act, list);</div><div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aacc5f6b7c25e361d11d40137fd55a8e8">AST_RWLIST_INSERT_HEAD</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>, act, list);</div><div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;   }</div><div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;</div><div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;   <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;Manager registered action %s\n&quot;</span>, act-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a>);</div><div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;</div><div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../dc/de8/structactions.html">actions</a>);</div><div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;</div><div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;}</div><div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;<span class="comment"> * \brief Destroy the registered AMI action object.</span></div><div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;<span class="comment"> * \param obj Object to destroy.</span></div><div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07372"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gadd09f46d9eea259a9a23b2a96fb99d7b"> 7372</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gadd09f46d9eea259a9a23b2a96fb99d7b">action_destroy</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;{</div><div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *doomed = obj;</div><div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;</div><div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;   <span class="keywordflow">if</span> (doomed-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa403beb670a3277f542647cc9aa22137">synopsis</a>) {</div><div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;      <span class="comment">/* The string fields were initialized. */</span></div><div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(doomed);</div><div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;   }</div><div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(doomed-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8c15417035739fd46675a17c5895afa9">final_response</a>);</div><div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(doomed-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ad620e07ef3ac6fbeb23e5d2ec0484e1d">list_responses</a>);</div><div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;}</div><div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;<span class="comment">/*! \brief register a new command with manager, including online help. This is</span></div><div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;<span class="comment">   the preferred way to register a manager command */</span></div><div class="line"><a name="l07386"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gab220bef102a1bf6e96a407d3a5a3e161"> 7386</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gab220bef102a1bf6e96a407d3a5a3e161">ast_manager_register2</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *action, <span class="keywordtype">int</span> auth, <span class="keywordtype">int</span> (*func)(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> message *m), <span class="keyword">struct</span> <a class="code" href="../../d9/df5/structast__module.html">ast_module</a> *module, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/db6/app__mysql_8c.html#afbb30cae381f627fb08e1acdac926270">synopsis</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *description)</div><div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;{</div><div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/dcc/structmanager__action.html">manager_action</a> *cur;</div><div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;</div><div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;   cur = <a class="code" href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a>(<span class="keyword">sizeof</span>(*cur), <a class="code" href="../../df/d72/group__Group__AMI.html#gadd09f46d9eea259a9a23b2a96fb99d7b">action_destroy</a>, action);</div><div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;   <span class="keywordflow">if</span> (!cur) {</div><div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;   }</div><div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(cur, 128)) {</div><div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(cur, -1, <span class="stringliteral">&quot;action object creation failed&quot;</span>);</div><div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;   }</div><div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;</div><div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;   cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">action</a> = action;</div><div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;   cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">authority</a> = auth;</div><div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;   cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ab0bef752de7f442d29017ea812092d91">func</a> = func;</div><div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;   cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">module</a> = module;</div><div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(synopsis) &amp;&amp; <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(description)) {</div><div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;      <span class="keywordtype">char</span> *tmpxml;</div><div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;</div><div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;      tmpxml = <a class="code" href="../../d1/d99/xmldoc_8h.html#ada5725df0394b62d812bc36d3471b702">ast_xmldoc_build_synopsis</a>(<span class="stringliteral">&quot;manager&quot;</span>, action, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cur, synopsis, tmpxml);</div><div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tmpxml);</div><div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;</div><div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;      tmpxml = <a class="code" href="../../d1/d99/xmldoc_8h.html#a5c52185fee8531c7e071227b4e5b2ae6">ast_xmldoc_build_syntax</a>(<span class="stringliteral">&quot;manager&quot;</span>, action, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cur, syntax, tmpxml);</div><div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tmpxml);</div><div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;</div><div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;      tmpxml = <a class="code" href="../../d1/d99/xmldoc_8h.html#a8f573b7eed021cfcb8c3e7a839c98c73">ast_xmldoc_build_description</a>(<span class="stringliteral">&quot;manager&quot;</span>, action, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cur, description, tmpxml);</div><div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tmpxml);</div><div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;</div><div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;      tmpxml = <a class="code" href="../../d1/d99/xmldoc_8h.html#a5213452e6be61321a64293e54e4b550b">ast_xmldoc_build_seealso</a>(<span class="stringliteral">&quot;manager&quot;</span>, action, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cur, seealso, tmpxml);</div><div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tmpxml);</div><div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;</div><div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;      tmpxml = <a class="code" href="../../d1/d99/xmldoc_8h.html#a1b4f0eb83fde5ec2ca8357428b10826f">ast_xmldoc_build_arguments</a>(<span class="stringliteral">&quot;manager&quot;</span>, action, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cur, arguments, tmpxml);</div><div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(tmpxml);</div><div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;</div><div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;      cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#a8c15417035739fd46675a17c5895afa9">final_response</a> = <a class="code" href="../../d1/d99/xmldoc_8h.html#a6a08b6e8d15408ee8bbf7313e1cba23d">ast_xmldoc_build_final_response</a>(<span class="stringliteral">&quot;manager&quot;</span>, action, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;      cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#ad620e07ef3ac6fbeb23e5d2ec0484e1d">list_responses</a> = <a class="code" href="../../d1/d99/xmldoc_8h.html#a8569403d78e86654662bba47ff576bd5">ast_xmldoc_build_list_responses</a>(<span class="stringliteral">&quot;manager&quot;</span>, action, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;</div><div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;      cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa871ca3c361d229d4e37edf3c6016cc1">docsrc</a> = <a class="code" href="../../d1/d99/xmldoc_8h.html#a8717a951656993c40bd851ebf50f58e3a24212840b7b1b0e9c1eebc8cfd89ab3e">AST_XML_DOC</a>;</div><div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;   } <span class="keywordflow">else</span></div><div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;   {</div><div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cur, synopsis, synopsis);</div><div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;      <a class="code" href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a>(cur, description, description);</div><div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;      cur-&gt;<a class="code" href="../../d2/dcc/structmanager__action.html#aa871ca3c361d229d4e37edf3c6016cc1">docsrc</a> = <a class="code" href="../../d1/d99/xmldoc_8h.html#a8717a951656993c40bd851ebf50f58e3a7273ed64a1fd4a93692986eac376124a">AST_STATIC_DOC</a>;</div><div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;   }</div><div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga1f6d4d99712fba3bb1075b0984bc2731">ast_manager_register_struct</a>(cur)) {</div><div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(cur, -1, <span class="stringliteral">&quot;action object registration failed&quot;</span>);</div><div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;   }</div><div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;</div><div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(cur, -1, <span class="stringliteral">&quot;action object registration successful&quot;</span>);</div><div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;}<span class="comment"></span></div><div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;<span class="comment">/*! @}</span></div><div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;<span class="comment"> END Doxygen group */</span></div><div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;</div><div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;<span class="comment"> * The following are support functions for AMI-over-http.</span></div><div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;<span class="comment"> * The common entry point is generic_http_callback(),</span></div><div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;<span class="comment"> * which extracts HTTP header and URI fields and reformats</span></div><div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;<span class="comment"> * them into AMI messages, locates a proper session</span></div><div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;<span class="comment"> * (using the mansession_id Cookie or GET variable),</span></div><div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;<span class="comment"> * and calls process_message() as for regular AMI clients.</span></div><div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;<span class="comment"> * When done, the output (which goes to a temporary file)</span></div><div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;<span class="comment"> * is read back into a buffer and reformatted as desired,</span></div><div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;<span class="comment"> * then fed back to the client over the original socket.</span></div><div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07462"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53"> 7462</a></span>&#160;</div><div class="line"><a name="l07463"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9"> 7463</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> {</div><div class="line"><a name="l07464"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824"> 7464</a></span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>,</div><div class="line"><a name="l07465"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d"> 7465</a></span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>,</div><div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>,</div><div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;};</div><div class="line"><a name="l07468"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#aec783e82aaec02c089ae933a8fa3688e"> 7468</a></span>&#160;</div><div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="../../d4/d10/manager_8c.html#aec783e82aaec02c089ae933a8fa3688e">contenttype</a>[] = {</div><div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;   [<a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>] = <span class="stringliteral">&quot;plain&quot;</span>,</div><div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;   [<a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>] = <span class="stringliteral">&quot;html&quot;</span>,</div><div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;   [<a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>] =  <span class="stringliteral">&quot;xml&quot;</span>,</div><div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;};</div><div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;<span class="comment"> * locate an http session in the list. The search key (ident) is</span></div><div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;<span class="comment"> * the value of the mansession_id cookie (0 is not valid and means</span></div><div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;<span class="comment"> * a session on the AMI socket).</span></div><div class="line"><a name="l07479"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a914dce58348e2b56ed139c441198b82f"> 7479</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d4/d10/manager_8c.html#a914dce58348e2b56ed139c441198b82f">find_session</a>(uint32_t ident, <span class="keywordtype">int</span> incinuse)</div><div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;{</div><div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;</div><div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;   <span class="keywordflow">if</span> (ident == 0) {</div><div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;   }</div><div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;</div><div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;   <span class="keywordflow">if</span> (!sessions) {</div><div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;   }</div><div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sessions, 0);</div><div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;   <span class="keywordflow">while</span> ((session = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == ident &amp;&amp; !session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a>) {</div><div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>, incinuse ? 1 : 0);</div><div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;      }</div><div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;   }</div><div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;</div><div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;}</div><div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;<span class="comment"> * locate an http session in the list.</span></div><div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;<span class="comment"> * The search keys (nonce) and (username) is value from received</span></div><div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;<span class="comment"> * &quot;Authorization&quot; http header.</span></div><div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;<span class="comment"> * As well as in find_session() function, the value of the nonce can&#39;t be zero.</span></div><div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;<span class="comment"> * (0 meansi, that the session used for AMI socket connection).</span></div><div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;<span class="comment"> * Flag (stale) is set, if client used valid, but old, nonce value.</span></div><div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07518"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ae6e7920350915168f60be3ba77be01fa"> 7518</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d4/d10/manager_8c.html#ae6e7920350915168f60be3ba77be01fa">find_session_by_nonce</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *username, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nonce, <span class="keywordtype">int</span> *stale)</div><div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;{</div><div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;</div><div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;   <span class="keywordflow">if</span> (nonce == 0 || username == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || stale == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;   }</div><div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;</div><div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;   <span class="keywordflow">if</span> (!sessions) {</div><div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;   }</div><div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sessions, 0);</div><div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;   <span class="keywordflow">while</span> ((session = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, username) &amp;&amp; session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == nonce) {</div><div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;         *stale = 0;</div><div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, username) &amp;&amp; session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a69130d68427d2c01991cac28b2f20ac3">oldnonce</a> == nonce) {</div><div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;         *stale = 1;</div><div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;      }</div><div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;   }</div><div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;</div><div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;}</div><div class="line"><a name="l07551"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#acb49e15f3ae80cc0ee0cfa3a250d00c0"> 7551</a></span>&#160;</div><div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#acb49e15f3ae80cc0ee0cfa3a250d00c0">astman_is_authed</a>(uint32_t ident)</div><div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;{</div><div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;   <span class="keywordtype">int</span> authed;</div><div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;</div><div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;   <span class="keywordflow">if</span> (!(session = <a class="code" href="../../d4/d10/manager_8c.html#a914dce58348e2b56ed139c441198b82f">find_session</a>(ident, 0)))</div><div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;</div><div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;   authed = (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a> != 0);</div><div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;</div><div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;</div><div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;   <span class="keywordflow">return</span> authed;</div><div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;}</div><div class="line"><a name="l07567"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a73a22446241314099a4e371157e360f5"> 7567</a></span>&#160;</div><div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a73a22446241314099a4e371157e360f5">astman_verify_session_readpermissions</a>(uint32_t ident, <span class="keywordtype">int</span> perm)</div><div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;{</div><div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = 0;</div><div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;</div><div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;   <span class="keywordflow">if</span> (ident == 0) {</div><div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;   }</div><div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;</div><div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;   <span class="keywordflow">if</span> (!sessions) {</div><div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;   }</div><div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sessions, 0);</div><div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;   <span class="keywordflow">while</span> ((session = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;      <span class="keywordflow">if</span> ((session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == ident) &amp;&amp; (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> &amp; perm)) {</div><div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160;         result = 1;</div><div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;      }</div><div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;   }</div><div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;</div><div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;}</div><div class="line"><a name="l07600"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a38eb222ca678604d4f203c9e9d5295ab"> 7600</a></span>&#160;</div><div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a38eb222ca678604d4f203c9e9d5295ab">astman_verify_session_writepermissions</a>(uint32_t ident, <span class="keywordtype">int</span> perm)</div><div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;{</div><div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a> = 0;</div><div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> i;</div><div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;</div><div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;   <span class="keywordflow">if</span> (ident == 0) {</div><div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;   }</div><div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;</div><div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;   sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;   <span class="keywordflow">if</span> (!sessions) {</div><div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;   }</div><div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;   i = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(sessions, 0);</div><div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;   <span class="keywordflow">while</span> ((session = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;i))) {</div><div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;      <span class="keywordflow">if</span> ((session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> == ident) &amp;&amp; (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> &amp; perm)) {</div><div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;         result = 1;</div><div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;      }</div><div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;   }</div><div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;i);</div><div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;</div><div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>;</div><div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;}</div><div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;</div><div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160;<span class="comment"> * convert to xml with various conversion:</span></div><div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;<span class="comment"> * mode &amp; 1 -&gt; lowercase;</span></div><div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;<span class="comment"> * mode &amp; 2 -&gt; replace non-alphanumeric chars with underscore</span></div><div class="line"><a name="l07638"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313"> 7638</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">int</span> mode)</div><div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;{</div><div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;   <span class="comment">/* store in a local buffer to avoid calling ast_str_append too often */</span></div><div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>[256];</div><div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;   <span class="keywordtype">char</span> *dst = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;   <span class="keywordtype">int</span> space = <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>);</div><div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;   <span class="comment">/* repeat until done and nothing to flush */</span></div><div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;   <span class="keywordflow">for</span> ( ; *src || dst != <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a> ; src++) {</div><div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;      <span class="keywordflow">if</span> (*src == <span class="charliteral">&#39;\0&#39;</span> || space &lt; 10) {   <span class="comment">/* flush */</span></div><div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;         *dst++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;%s&quot;</span>, buf);</div><div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;         dst = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;         space = <span class="keyword">sizeof</span>(<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>);</div><div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;         <span class="keywordflow">if</span> (*src == <span class="charliteral">&#39;\0&#39;</span>) {</div><div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;         }</div><div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;      }</div><div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;</div><div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;      <span class="keywordflow">if</span> ( (mode &amp; 2) &amp;&amp; !isalnum(*src)) {</div><div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;         *dst++ = <span class="charliteral">&#39;_&#39;</span>;</div><div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;         space--;</div><div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;      }</div><div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;      <span class="keywordflow">switch</span> (*src) {</div><div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;&lt;&#39;</span>:</div><div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;         strcpy(dst, <span class="stringliteral">&quot;&amp;lt;&quot;</span>);</div><div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;         dst += 4;</div><div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;         space -= 4;</div><div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;&gt;&#39;</span>:</div><div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;         strcpy(dst, <span class="stringliteral">&quot;&amp;gt;&quot;</span>);</div><div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;         dst += 4;</div><div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;         space -= 4;</div><div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;\&quot;&#39;</span>:</div><div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;         strcpy(dst, <span class="stringliteral">&quot;&amp;quot;&quot;</span>);</div><div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;         dst += 6;</div><div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;         space -= 6;</div><div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;\&#39;&#39;</span>:</div><div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;         strcpy(dst, <span class="stringliteral">&quot;&amp;apos;&quot;</span>);</div><div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;         dst += 6;</div><div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;         space -= 6;</div><div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;      <span class="keywordflow">case</span> <span class="charliteral">&#39;&amp;&#39;</span>:</div><div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;         strcpy(dst, <span class="stringliteral">&quot;&amp;amp;&quot;</span>);</div><div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;         dst += 5;</div><div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;         space -= 5;</div><div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;</div><div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;         *dst++ = mode ? tolower(*src) : *src;</div><div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;         space--;</div><div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;      }</div><div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;   }</div><div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;}</div><div class="line"><a name="l07695"></a><span class="lineno"><a class="line" href="../../de/dd0/structvariable__count.html"> 7695</a></span>&#160;</div><div class="line"><a name="l07696"></a><span class="lineno"><a class="line" href="../../de/dd0/structvariable__count.html#aa5928c052b47c013b060484e096eb6bb"> 7696</a></span>&#160;<span class="keyword">struct </span><a class="code" href="../../de/dd0/structvariable__count.html">variable_count</a> {</div><div class="line"><a name="l07697"></a><span class="lineno"><a class="line" href="../../de/dd0/structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf"> 7697</a></span>&#160;   <span class="keywordtype">char</span> *varname;</div><div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;   <span class="keywordtype">int</span> count;</div><div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;};</div><div class="line"><a name="l07700"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ac8bebf364f7d11e1affc6c15dc7fd895"> 7700</a></span>&#160;</div><div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ac8bebf364f7d11e1affc6c15dc7fd895">variable_count_hash_fn</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *vvc, <span class="keyword">const</span> <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;{</div><div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../de/dd0/structvariable__count.html">variable_count</a> *vc = vvc;</div><div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;</div><div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a>(vc-&gt;<a class="code" href="../../de/dd0/structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">varname</a>);</div><div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;}</div><div class="line"><a name="l07707"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a58d789617a4c4f4fb0ec8cef1147ea49"> 7707</a></span>&#160;</div><div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a58d789617a4c4f4fb0ec8cef1147ea49">variable_count_cmp_fn</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *vstr, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;{</div><div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;   <span class="comment">/* Due to the simplicity of struct variable_count, it makes no difference</span></div><div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;<span class="comment">    * if you pass in objects or strings, the same operation applies. This is</span></div><div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;<span class="comment">    * due to the fact that the hash occurs on the first element, which means</span></div><div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;<span class="comment">    * the address of both the struct and the string are exactly the same. */</span></div><div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd0/structvariable__count.html">variable_count</a> *vc = obj;</div><div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a> = vstr;</div><div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;   <span class="keywordflow">return</span> !strcmp(vc-&gt;<a class="code" href="../../de/dd0/structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">varname</a>, str) ? <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a> : 0;</div><div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;}</div><div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;<span class="comment"></span></div><div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;<span class="comment">/*! \brief Convert the input into XML or HTML.</span></div><div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;<span class="comment"> * The input is supposed to be a sequence of lines of the form</span></div><div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;<span class="comment"> * Name: value</span></div><div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;<span class="comment"> * optionally followed by a blob of unformatted text.</span></div><div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;<span class="comment"> * A blank line is a section separator. Basically, this is a</span></div><div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;<span class="comment"> * mixture of the format of Manager Interface and CLI commands.</span></div><div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;<span class="comment"> * The unformatted text is considered as a single value of a field</span></div><div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;<span class="comment"> * named &#39;Opaque-data&#39;.</span></div><div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;<span class="comment"> * At the moment the output format is the following (but it may</span></div><div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;<span class="comment"> * change depending on future requirements so don&#39;t count too</span></div><div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;<span class="comment"> * much on it when writing applications):</span></div><div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;<span class="comment"> * General: the unformatted text is used as a value of</span></div><div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;<span class="comment"> * XML output:  to be completed</span></div><div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;<span class="comment"> * \verbatim</span></div><div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;<span class="comment"> *   Each section is within &lt;response type=&quot;object&quot; id=&quot;xxx&quot;&gt;</span></div><div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;<span class="comment"> *   where xxx is taken from ajaxdest variable or defaults to unknown</span></div><div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;<span class="comment"> *   Each row is reported as an attribute Name=&quot;value&quot; of an XML</span></div><div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;<span class="comment"> *   entity named from the variable ajaxobjtype, default to &quot;generic&quot;</span></div><div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;<span class="comment"> * \endverbatim</span></div><div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;<span class="comment"> * HTML output:</span></div><div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;<span class="comment"> *   each Name-value pair is output as a single row of a two-column table.</span></div><div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;<span class="comment"> *   Sections (blank lines in the input) are separated by a &lt;HR&gt;</span></div><div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07746"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ac86d9b2afbd62d5777ba528325cb318b"> 7746</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#ac86d9b2afbd62d5777ba528325cb318b">xml_translate</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>, <span class="keywordtype">char</span> *<a class="code" href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_vars, <span class="keyword">enum</span> <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> <a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</div><div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;{</div><div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v;</div><div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *dest = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>, *<a class="code" href="../../d5/d85/structval.html">val</a>;</div><div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *objtype = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;   <span class="keywordtype">int</span> in_data = 0;  <span class="comment">/* parsing data */</span></div><div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;   <span class="keywordtype">int</span> inobj = 0;</div><div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;   <span class="keywordtype">int</span> xml = (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>);</div><div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../de/dd0/structvariable__count.html">variable_count</a> *vc = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *vco = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;</div><div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;   <span class="keywordflow">if</span> (xml) {</div><div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;      <span class="comment">/* dest and objtype need only for XML format */</span></div><div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;      <span class="keywordflow">for</span> (v = get_vars; v; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;ajaxdest&quot;</span>)) {</div><div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;            dest = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>;</div><div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;ajaxobjtype&quot;</span>)) {</div><div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;            objtype = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>;</div><div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;         }</div><div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;      }</div><div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(dest)) {</div><div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;         dest = <span class="stringliteral">&quot;unknown&quot;</span>;</div><div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;      }</div><div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(objtype)) {</div><div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;         objtype = <span class="stringliteral">&quot;generic&quot;</span>;</div><div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;      }</div><div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;   }</div><div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;</div><div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;   <span class="comment">/* we want to stop when we find an empty line */</span></div><div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;   <span class="keywordflow">while</span> (in &amp;&amp; *in) {</div><div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;      val = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;in, <span class="stringliteral">&quot;\r\n&quot;</span>); <span class="comment">/* mark start and end of line */</span></div><div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;      <span class="keywordflow">if</span> (in &amp;&amp; *in == <span class="charliteral">&#39;\n&#39;</span>) {   <span class="comment">/* remove trailing \n if any */</span></div><div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;         in++;</div><div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;      }</div><div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#abe38193be148775f7559f8fff6e0c17e">ast_trim_blanks</a>(val);</div><div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(5, <span class="stringliteral">&quot;inobj %d in_data %d line &lt;%s&gt;\n&quot;</span>, inobj, in_data, val);</div><div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(val)) {</div><div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;         <span class="comment">/* empty line */</span></div><div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;         <span class="keywordflow">if</span> (in_data) {</div><div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;            <span class="comment">/* close data in Opaque mode */</span></div><div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;&#39;&quot;</span> : <span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);</div><div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;            in_data = 0;</div><div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;         }</div><div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;</div><div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;         <span class="keywordflow">if</span> (inobj) {</div><div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;            <span class="comment">/* close block */</span></div><div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot; /&gt;&lt;/response&gt;\n&quot;</span> :</div><div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;               <span class="stringliteral">&quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot;&gt;&lt;hr&gt;&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</span>);</div><div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;            inobj = 0;</div><div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;            <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(vco, -1);</div><div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;            vco = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;         }</div><div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;      }</div><div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;</div><div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;      <span class="keywordflow">if</span> (!inobj) {</div><div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;         <span class="comment">/* start new block */</span></div><div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;         <span class="keywordflow">if</span> (xml) {</div><div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;&lt;response type=&#39;object&#39; id=&#39;%s&#39;&gt;&lt;%s&quot;</span>, dest, objtype);</div><div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;         }</div><div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;         vco = <a class="code" href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, 37,</div><div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#ac8bebf364f7d11e1affc6c15dc7fd895">variable_count_hash_fn</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d4/d10/manager_8c.html#a58d789617a4c4f4fb0ec8cef1147ea49">variable_count_cmp_fn</a>);</div><div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;         inobj = 1;</div><div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;      }</div><div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;</div><div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;      <span class="keywordflow">if</span> (in_data) {</div><div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;         <span class="comment">/* Process data field in Opaque mode. This is a</span></div><div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;<span class="comment">          * followup, so we re-add line feeds. */</span></div><div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;\n&quot;</span> : <span class="stringliteral">&quot;&lt;br&gt;\n&quot;</span>);</div><div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;         <a class="code" href="../../d4/d10/manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a>(out, val, 0);   <span class="comment">/* data field */</span></div><div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;      }</div><div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;</div><div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;      <span class="comment">/* We expect &quot;Name: value&quot; line here */</span></div><div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;      var = <a class="code" href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a>(&amp;val, <span class="stringliteral">&quot;:&quot;</span>);</div><div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;      <span class="keywordflow">if</span> (val) {</div><div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;         <span class="comment">/* found the field name */</span></div><div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;         val = <a class="code" href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a>(val);</div><div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#abe38193be148775f7559f8fff6e0c17e">ast_trim_blanks</a>(var);</div><div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;         <span class="comment">/* field name not found, switch to opaque mode */</span></div><div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;         val = <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;         var = <span class="stringliteral">&quot;Opaque-data&quot;</span>;</div><div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;         in_data = 1;</div><div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;      }</div><div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;</div><div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;</div><div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot; &quot;</span> : <span class="stringliteral">&quot;&lt;tr&gt;&lt;td&gt;&quot;</span>);</div><div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;      <span class="keywordflow">if</span> ((vc = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(vco, var, 0))) {</div><div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;         vc-&gt;<a class="code" href="../../de/dd0/structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>++;</div><div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;         <span class="comment">/* Create a new entry for this one */</span></div><div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;         vc = <a class="code" href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a>(<span class="keyword">sizeof</span>(*vc), <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;         vc-&gt;<a class="code" href="../../de/dd0/structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">varname</a> = <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;         vc-&gt;<a class="code" href="../../de/dd0/structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> = 1;</div><div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a>(vco, vc);</div><div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;      }</div><div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;</div><div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a>(out, var, xml ? 1 | 2 : 0); <span class="comment">/* data name */</span></div><div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;      <span class="keywordflow">if</span> (vc-&gt;<a class="code" href="../../de/dd0/structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> &gt; 1) {</div><div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;-%d&quot;</span>, vc-&gt;<a class="code" href="../../de/dd0/structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>);</div><div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;      }</div><div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(vc, -1);</div><div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;=&#39;&quot;</span> : <span class="stringliteral">&quot;&lt;/td&gt;&lt;td&gt;&quot;</span>);</div><div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a>(out, val, 0); <span class="comment">/* data field */</span></div><div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;      <span class="keywordflow">if</span> (!in_data || !*in) {</div><div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot;&#39;&quot;</span> : <span class="stringliteral">&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;</span>);</div><div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;      }</div><div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;   }</div><div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;</div><div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;   <span class="keywordflow">if</span> (inobj) {</div><div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, xml ? <span class="stringliteral">&quot; /&gt;&lt;/response&gt;\n&quot;</span> :</div><div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;         <span class="stringliteral">&quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot;&gt;&lt;hr&gt;&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</span>);</div><div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(vco, -1);</div><div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;   }</div><div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;}</div><div class="line"><a name="l07864"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7"> 7864</a></span>&#160;</div><div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s)</div><div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;{</div><div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;   <span class="keywordflow">if</span> (s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>) {</div><div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;      <a class="code" href="../../dd/d27/iostream_8h.html#ac0297067e6921ce6a2c5f3b3d0647d3a">ast_iostream_close</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>);</div><div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;      s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Attempted to close file/file descriptor on mansession without a valid file or file descriptor.\n&quot;</span>);</div><div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;   }</div><div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;}</div><div class="line"><a name="l07874"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#aa3ea4a3174e7e0f76c0a4e2318a8ee42"> 7874</a></span>&#160;</div><div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#aa3ea4a3174e7e0f76c0a4e2318a8ee42">process_output</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *params, <span class="keyword">enum</span> <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> <a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>)</div><div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;{</div><div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>;</div><div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;   off_t l;</div><div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;   <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;</div><div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;   <span class="keywordflow">if</span> (!s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>)</div><div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;</div><div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;   <span class="comment">/* Ensure buffer is NULL-terminated */</span></div><div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;   <a class="code" href="../../dd/d27/iostream_8h.html#a6e0bf2afcbc5b330b96378626f9ac5b3">ast_iostream_write</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>, <span class="stringliteral">&quot;&quot;</span>, 1);</div><div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;</div><div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;   fd = <a class="code" href="../../dd/d27/iostream_8h.html#a6ebb2730257107d3535fe6cb1285f479">ast_iostream_get_fd</a>(s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>);</div><div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;</div><div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;   l = lseek(fd, 0, SEEK_CUR);</div><div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;   <span class="keywordflow">if</span> (l &gt; 0) {</div><div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;      <span class="keywordflow">if</span> (MAP_FAILED == (buf = mmap(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, l, PROT_READ | PROT_WRITE, MAP_PRIVATE, fd, 0))) {</div><div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;mmap failed.  Manager output was not processed\n&quot;</span>);</div><div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;         <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a> || format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {</div><div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#ac86d9b2afbd62d5777ba528325cb318b">xml_translate</a>(out, buf, params, format);</div><div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(out, 0, <span class="stringliteral">&quot;%s&quot;</span>, buf);</div><div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;         }</div><div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;         munmap(buf, l);</div><div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;      }</div><div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a> || format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {</div><div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#ac86d9b2afbd62d5777ba528325cb318b">xml_translate</a>(out, <span class="stringliteral">&quot;&quot;</span>, params, format);</div><div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;   }</div><div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;</div><div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(s);</div><div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;}</div><div class="line"><a name="l07907"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#af8717f47c7bae13acaf49dc97eafd0b6"> 7907</a></span>&#160;</div><div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#af8717f47c7bae13acaf49dc97eafd0b6">generic_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser,</div><div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;                    <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>,</div><div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;                    <span class="keyword">enum</span> <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> <a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>,</div><div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> *remote_address, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri,</div><div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params,</div><div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;{</div><div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d8a/structmansession.html">mansession</a> s = { .<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .tcptls_session = ser };</div><div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;   uint32_t ident;</div><div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;   <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;   <span class="keywordtype">int</span> blastaway = 0;</div><div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *params = get_params;</div><div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;   <span class="keywordtype">char</span> <span class="keyword">template</span>[] = <span class="stringliteral">&quot;/tmp/ast-http-XXXXXX&quot;</span>; <span class="comment">/* template for temporary file */</span></div><div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *http_header = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;   <span class="keyword">struct </span>message m = { 0 };</div><div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;</div><div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;   <span class="keywordflow">if</span> (method != <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa74b1cb5c2ecb5e0bd9af5d46a7b78fd2">AST_HTTP_GET</a> &amp;&amp; method != <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efaf8da4e60a407fb100dd10e20929ea162">AST_HTTP_HEAD</a> &amp;&amp; method != <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80">AST_HTTP_POST</a>) {</div><div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 501, <span class="stringliteral">&quot;Not Implemented&quot;</span>, <span class="stringliteral">&quot;Attempt to use unimplemented / unsupported method&quot;</span>);</div><div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;   }</div><div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;</div><div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;   ident = <a class="code" href="../../dd/d56/http_8h.html#aa62626630003222102b29b97f18ff94c">ast_http_manid_from_vars</a>(headers);</div><div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;</div><div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;   <span class="keywordflow">if</span> (!(session = <a class="code" href="../../d4/d10/manager_8c.html#a914dce58348e2b56ed139c441198b82f">find_session</a>(ident, 1))) {</div><div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;</div><div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;      <span class="comment">/**/</span></div><div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;      <span class="comment">/* Create new session.</span></div><div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;<span class="comment">       * While it is not in the list we don&#39;t need any locking</span></div><div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;      <span class="keywordflow">if</span> (!(session = <a class="code" href="../../df/d72/group__Group__AMI.html#ga8547b9864f771b59843128a2054d7c47">build_mansession</a>(remote_address))) {</div><div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (out of memory)&quot;</span>);</div><div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;      }</div><div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">send_events</a> = 0;</div><div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a> = 1;<span class="comment"></span></div><div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;<span class="comment">      /*!</span></div><div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;<span class="comment">       * \note There is approximately a 1 in 1.8E19 chance that the following</span></div><div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;<span class="comment">       * calculation will produce 0, which is an invalid ID, but due to the</span></div><div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;<span class="comment">       * properties of the rand() function (and the constantcy of s), that</span></div><div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;<span class="comment">       * won&#39;t happen twice in a row.</span></div><div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;      <span class="keywordflow">while</span> ((session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> = <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>() ^ (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) session) == 0) {</div><div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;      }</div><div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;      session-&gt;last_ev = <a class="code" href="../../df/d72/group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5">grab_last</a>();</div><div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;session-&gt;datastores);</div><div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;   }</div><div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;</div><div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;   http_header = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;   out = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(2048);</div><div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;</div><div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;s.<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;</div><div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;   <span class="keywordflow">if</span> (http_header == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || out == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (ast_str_create() out of memory)&quot;</span>);</div><div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;      <span class="keywordflow">goto</span> generic_callback_out;</div><div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;   }</div><div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;</div><div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;   s.<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;   fd = mkstemp(<span class="keyword">template</span>); <span class="comment">/* create a temporary file for command output */</span></div><div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;   unlink(<span class="keyword">template</span>);</div><div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;   <span class="keywordflow">if</span> (fd &lt;= -1) {</div><div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (mkstemp failed)&quot;</span>);</div><div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;      <span class="keywordflow">goto</span> generic_callback_out;</div><div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;   }</div><div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;   s.<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> = <a class="code" href="../../dd/d27/iostream_8h.html#a5dd1ed6f7ebb56180cc9f953db97f0fd">ast_iostream_from_fd</a>(&amp;fd);</div><div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;   <span class="keywordflow">if</span> (!s.<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>) {</div><div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;HTTP Manager, fdopen failed: %s!\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (fdopen failed)&quot;</span>);</div><div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;      close(fd);</div><div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;      <span class="keywordflow">goto</span> generic_callback_out;</div><div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;   }</div><div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;</div><div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;   <span class="keywordflow">if</span> (method == <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80">AST_HTTP_POST</a>) {</div><div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;      params = <a class="code" href="../../dd/d56/http_8h.html#ac000c497701f197370cbef5aa4c1a92e">ast_http_get_post_vars</a>(ser, headers);</div><div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;      <span class="keywordflow">if</span> (!params) {</div><div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;         <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>) {</div><div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;         <span class="keywordflow">case</span> EFBIG:</div><div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 413, <span class="stringliteral">&quot;Request Entity Too Large&quot;</span>, <span class="stringliteral">&quot;Body too large&quot;</span>);</div><div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(&amp;s);</div><div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;            <span class="keywordflow">goto</span> generic_callback_out;</div><div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;         <span class="keywordflow">case</span> ENOMEM:</div><div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Out of memory&quot;</span>);</div><div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(&amp;s);</div><div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;            <span class="keywordflow">goto</span> generic_callback_out;</div><div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;         <span class="keywordflow">case</span> EIO:</div><div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 400, <span class="stringliteral">&quot;Bad Request&quot;</span>, <span class="stringliteral">&quot;Error parsing request body&quot;</span>);</div><div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(&amp;s);</div><div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;            <span class="keywordflow">goto</span> generic_callback_out;</div><div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;         }</div><div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;      }</div><div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;   }</div><div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;</div><div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga81510d243e1eb9c6f919e72183e811a6">astman_append_headers</a>(&amp;m, params);</div><div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;</div><div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message</a>(&amp;s, &amp;m)) {</div><div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a>) {</div><div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010">manager_displayconnects</a>(session)) {</div><div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;HTTP Manager &#39;%s&#39; logged off from %s\n&quot;</span>, session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;         }</div><div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>) {</div><div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;HTTP Connect attempt from &#39;%s&#39; unable to authenticate\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;         }</div><div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;      }</div><div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a> = 1;</div><div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;   }</div><div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;</div><div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga1b557a85c122f479896a9f598ee49116">astman_free_headers</a>(&amp;m);</div><div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;</div><div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;http_header, 0,</div><div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;      <span class="stringliteral">&quot;Content-type: text/%s\r\n&quot;</span></div><div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;      <span class="stringliteral">&quot;Set-Cookie: mansession_id=\&quot;%08x\&quot;; Version=1; Max-Age=%d\r\n&quot;</span></div><div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;      <span class="stringliteral">&quot;Pragma: SuppressEvents\r\n&quot;</span>,</div><div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;      contenttype[format],</div><div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a>);</div><div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;</div><div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;   <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>) {</div><div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;ajax-response&gt;\n&quot;</span>);</div><div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {</div><div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;<span class="comment">       * When handling AMI-over-HTTP in HTML format, we provide a simple form for</span></div><div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;<span class="comment">       * debugging purposes. This HTML code should not be here, we</span></div><div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;<span class="comment">       * should read from some config file...</span></div><div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;</div><div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;<span class="preprocessor">#define ROW_FMT   &quot;&lt;tr&gt;&lt;td colspan=\&quot;2\&quot; bgcolor=\&quot;#f1f1ff\&quot;&gt;%s&lt;/td&gt;&lt;/tr&gt;\r\n&quot;</span></div><div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;<span class="preprocessor">#define TEST_STRING \</span></div><div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;<span class="preprocessor">   &quot;&lt;form action=\&quot;manager\&quot; method=\&quot;post\&quot;&gt;\n\</span></div><div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;<span class="preprocessor">   Action: &lt;select name=\&quot;action\&quot;&gt;\n\</span></div><div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;<span class="preprocessor">      &lt;option value=\&quot;\&quot;&gt;-----&amp;gt;&lt;/option&gt;\n\</span></div><div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;<span class="preprocessor">      &lt;option value=\&quot;login\&quot;&gt;login&lt;/option&gt;\n\</span></div><div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;<span class="preprocessor">      &lt;option value=\&quot;command\&quot;&gt;Command&lt;/option&gt;\n\</span></div><div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;<span class="preprocessor">      &lt;option value=\&quot;waitevent\&quot;&gt;waitevent&lt;/option&gt;\n\</span></div><div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;<span class="preprocessor">      &lt;option value=\&quot;listcommands\&quot;&gt;listcommands&lt;/option&gt;\n\</span></div><div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;<span class="preprocessor">   &lt;/select&gt;\n\</span></div><div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;<span class="preprocessor">   or &lt;input name=\&quot;action\&quot;&gt;&lt;br/&gt;\n\</span></div><div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;<span class="preprocessor">   CLI Command &lt;input name=\&quot;command\&quot;&gt;&lt;br&gt;\n\</span></div><div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;<span class="preprocessor">   user &lt;input name=\&quot;username\&quot;&gt; pass &lt;input type=\&quot;password\&quot; name=\&quot;secret\&quot;&gt;&lt;br&gt;\n\</span></div><div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;<span class="preprocessor">   &lt;input type=\&quot;submit\&quot;&gt;\n&lt;/form&gt;\n&quot;</span></div><div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;</div><div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;title&gt;Asterisk&amp;trade; Manager Interface&lt;/title&gt;&quot;</span>);</div><div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;body bgcolor=\&quot;#ffffff\&quot;&gt;&lt;table align=center bgcolor=\&quot;#f1f1f1\&quot; width=\&quot;500\&quot;&gt;\r\n&quot;</span>);</div><div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <a class="code" href="../../d4/d10/manager_8c.html#a0f30c6e376cc35312886a20eae8cce2a">ROW_FMT</a>, <span class="stringliteral">&quot;&lt;h1&gt;Manager Tester&lt;/h1&gt;&quot;</span>);</div><div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <a class="code" href="../../d4/d10/manager_8c.html#a0f30c6e376cc35312886a20eae8cce2a">ROW_FMT</a>, <a class="code" href="../../d4/d10/manager_8c.html#ae266fd2d3b1b5374127ad824217bb025">TEST_STRING</a>);</div><div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;   }</div><div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;</div><div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#aa3ea4a3174e7e0f76c0a4e2318a8ee42">process_output</a>(&amp;s, &amp;out, params, format);</div><div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;</div><div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;   <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>) {</div><div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;/ajax-response&gt;\n&quot;</span>);</div><div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {</div><div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;/table&gt;&lt;/body&gt;\r\n&quot;</span>);</div><div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;   }</div><div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;</div><div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;   <span class="comment">/* Reset HTTP timeout.  If we&#39;re not authenticated, keep it extremely short */</span></div><div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;   session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">sessiontimeout</a> = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) + ((session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a> || <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> &lt; 5) ? <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> : 5);</div><div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;</div><div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a>) {</div><div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a> == 1) {</div><div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Need destroy, doing it now!\n&quot;</span>);</div><div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;         blastaway = 1;</div><div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Need destroy, but can&#39;t do it yet!\n&quot;</span>);</div><div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a> != <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>) {</div><div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;            pthread_kill(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">waiting_thread</a>, SIGURG);</div><div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;         }</div><div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;         <a class="code" href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">notify_lock</a>);</div><div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;         session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>--;</div><div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;      }</div><div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">inuse</a>--;</div><div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;   }</div><div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;</div><div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, method, 200, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, http_header, out, 0, 0);</div><div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;   http_header = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;   out = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;</div><div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;generic_callback_out:</div><div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;s.<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;</div><div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;   <span class="comment">/* Clear resource */</span></div><div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;</div><div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;   <span class="keywordflow">if</span> (method == <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80">AST_HTTP_POST</a> &amp;&amp; params) {</div><div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(params);</div><div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;   }</div><div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(http_header);</div><div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(out);</div><div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160;</div><div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;   <span class="keywordflow">if</span> (session) {</div><div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160;      <span class="keywordflow">if</span> (blastaway) {</div><div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5">session_destroy</a>(session);</div><div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;         <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>) {</div><div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;            <a class="code" href="../../dd/d27/iostream_8h.html#ac0297067e6921ce6a2c5f3b3d0647d3a">ast_iostream_close</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>);</div><div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;            session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;         }</div><div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a>(session);</div><div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;      }</div><div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160;   }</div><div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;</div><div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;}</div><div class="line"><a name="l08119"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#adc05403d9e5f69a12e0d473f88cc3618"> 8119</a></span>&#160;</div><div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#adc05403d9e5f69a12e0d473f88cc3618">auth_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser,</div><div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;                    <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>,</div><div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;                    <span class="keyword">enum</span> <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a> <a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>,</div><div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> *remote_address, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri,</div><div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params,</div><div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;                    <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;{</div><div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/d8a/structmansession.html">mansession</a> s = { .<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, .tcptls_session = ser };</div><div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *v, *params = get_params;</div><div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;   <span class="keywordtype">char</span> <span class="keyword">template</span>[] = <span class="stringliteral">&quot;/tmp/ast-http-XXXXXX&quot;</span>; <span class="comment">/* template for temporary file */</span></div><div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *http_header = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *<a class="code" href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;   <span class="keywordtype">size_t</span> result_size;</div><div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;   <span class="keyword">struct </span>message m = { 0 };</div><div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;   <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;</div><div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;   time_t time_now = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nonce = 0, nc;</div><div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../da/db3/structast__http__digest.html">ast_http_digest</a> <a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a> = { <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, };</div><div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;   <span class="keywordtype">int</span> stale = 0;</div><div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;   <span class="keywordtype">char</span> resp_hash[256]=<span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;   <span class="comment">/* Cache for user data */</span></div><div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;   <span class="keywordtype">char</span> u_username[80];</div><div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;   <span class="keywordtype">int</span> u_readperm;</div><div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;   <span class="keywordtype">int</span> u_writeperm;</div><div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;   <span class="keywordtype">int</span> u_writetimeout;</div><div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;   <span class="keywordtype">int</span> u_displayconnects;</div><div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;</div><div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;   <span class="keywordflow">if</span> (method != <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa74b1cb5c2ecb5e0bd9af5d46a7b78fd2">AST_HTTP_GET</a> &amp;&amp; method != <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efaf8da4e60a407fb100dd10e20929ea162">AST_HTTP_HEAD</a> &amp;&amp; method != <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80">AST_HTTP_POST</a>) {</div><div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 501, <span class="stringliteral">&quot;Not Implemented&quot;</span>, <span class="stringliteral">&quot;Attempt to use unimplemented / unsupported method&quot;</span>);</div><div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;   }</div><div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;</div><div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;   <span class="comment">/* Find &quot;Authorization: &quot; header */</span></div><div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;   <span class="keywordflow">for</span> (v = headers; v; v = v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;Authorization&quot;</span>)) {</div><div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;      }</div><div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160;   }</div><div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;</div><div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160;   <span class="keywordflow">if</span> (!v || <a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>)) {</div><div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;      <span class="keywordflow">goto</span> out_401; <span class="comment">/* Authorization Header not present - send auth request */</span></div><div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;   }</div><div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;</div><div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;   <span class="comment">/* Digest found - parse */</span></div><div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(&amp;d, 128)) {</div><div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (out of memory)&quot;</span>);</div><div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;   }</div><div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;</div><div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d5/d60/utils_8h.html#a624b98abd96c41fb9ce72c005217128b">ast_parse_digest</a>(v-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;d, 0, 1)) {</div><div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;      <span class="comment">/* Error in Digest - send new one */</span></div><div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;      nonce = 0;</div><div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;      <span class="keywordflow">goto</span> out_401;</div><div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;   }</div><div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;   <span class="keywordflow">if</span> (sscanf(d.<a class="code" href="../../da/db3/structast__http__digest.html#a56213b5a6f60531d0721956bd74a7832">nonce</a>, <span class="stringliteral">&quot;%30lx&quot;</span>, &amp;nonce) != 1) {</div><div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Received incorrect nonce in Digest &lt;%s&gt;\n&quot;</span>, d.<a class="code" href="../../da/db3/structast__http__digest.html#a56213b5a6f60531d0721956bd74a7832">nonce</a>);</div><div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;      nonce = 0;</div><div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;      <span class="keywordflow">goto</span> out_401;</div><div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;   }</div><div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;</div><div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;   user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(d.<a class="code" href="../../da/db3/structast__http__digest.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;   <span class="keywordflow">if</span>(!user) {</div><div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s tried to authenticate with nonexistent user &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>), d.<a class="code" href="../../da/db3/structast__http__digest.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;      nonce = 0;</div><div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;      <span class="keywordflow">goto</span> out_401;</div><div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;   }</div><div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;</div><div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;   <span class="comment">/* --- We have User for this auth, now check ACL */</span></div><div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;   <span class="keywordflow">if</span> (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a> &amp;&amp; !<a class="code" href="../../d5/d59/acl_8h.html#a3f0c6ca57c26cab3141b15c4b231188b">ast_apply_acl</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>, remote_address, <span class="stringliteral">&quot;Manager User ACL:&quot;</span>)) {</div><div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;%s failed to pass IP ACL as &#39;%s&#39;\n&quot;</span>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>), d.<a class="code" href="../../da/db3/structast__http__digest.html#a5804ef809b93820d3437a86e08126bd8">username</a>);</div><div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 403, <span class="stringliteral">&quot;Permission denied&quot;</span>, <span class="stringliteral">&quot;Permission denied&quot;</span>);</div><div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;   }</div><div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;</div><div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;   <span class="comment">/* --- We have auth, so check it */</span></div><div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;</div><div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;   <span class="comment">/* compute the expected response to compare with what we received */</span></div><div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;   {</div><div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;      <span class="keywordtype">char</span> *a2;</div><div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160;      <span class="comment">/* ast_md5_hash outputs 32 characters plus NULL terminator. */</span></div><div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;      <span class="keywordtype">char</span> a2_hash[33];</div><div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;      <span class="keywordtype">char</span> resp[256];</div><div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;</div><div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;      <span class="comment">/* XXX Now request method are hardcoded in A2 */</span></div><div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a>(&amp;a2, <span class="stringliteral">&quot;%s:%s&quot;</span>, <a class="code" href="../../dd/d56/http_8h.html#a656cd4a1dab52abb5e6cd641e064c18f">ast_get_http_method</a>(method), d.<a class="code" href="../../da/db3/structast__http__digest.html#a19ac71226fac09e87afe31acb4c99214">uri</a>) &lt; 0) {</div><div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (out of memory)&quot;</span>);</div><div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;      }</div><div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;</div><div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#aee8200caadc6a4b5afe01ea37fd26cb3">ast_md5_hash</a>(a2_hash, a2);</div><div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(a2);</div><div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;</div><div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;      <span class="keywordflow">if</span> (d.<a class="code" href="../../da/db3/structast__http__digest.html#af88f810d87ba0804816dea48a1fa23af">qop</a>) {</div><div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;         <span class="comment">/* RFC 2617 */</span></div><div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;         snprintf(resp, <span class="keyword">sizeof</span>(resp), <span class="stringliteral">&quot;%s:%08lx:%s:%s:auth:%s&quot;</span>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a">a1_hash</a>, nonce, d.<a class="code" href="../../da/db3/structast__http__digest.html#afeb5a09193787cf522efc8c90c5485f6">nc</a>, d.<a class="code" href="../../da/db3/structast__http__digest.html#a47e10f754dbee638f7684eab40c9e34c">cnonce</a>, a2_hash);</div><div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;      }  <span class="keywordflow">else</span> {</div><div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;         <span class="comment">/* RFC 2069 */</span></div><div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;         snprintf(resp, <span class="keyword">sizeof</span>(resp), <span class="stringliteral">&quot;%s:%08lx:%s&quot;</span>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a">a1_hash</a>, nonce, a2_hash);</div><div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;      }</div><div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#aee8200caadc6a4b5afe01ea37fd26cb3">ast_md5_hash</a>(resp_hash, resp);</div><div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;   }</div><div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;</div><div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;   <span class="keywordflow">if</span> (strncasecmp(d.<a class="code" href="../../da/db3/structast__http__digest.html#a12166a4bf31948289c00d571af88ed90">response</a>, resp_hash, strlen(resp_hash))) {</div><div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;      <span class="comment">/* Something was wrong, so give the client to try with a new challenge */</span></div><div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;      nonce = 0;</div><div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;      <span class="keywordflow">goto</span> out_401;</div><div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;   }</div><div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;</div><div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;<span class="comment">    * User are pass Digest authentication.</span></div><div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;<span class="comment">    * Now, cache the user data and unlock user list.</span></div><div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(u_username, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <span class="keyword">sizeof</span>(u_username));</div><div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;   u_readperm = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a>;</div><div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;   u_writeperm = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a>;</div><div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;   u_displayconnects = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>;</div><div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;   u_writetimeout = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a>;</div><div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;</div><div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;   <span class="keywordflow">if</span> (!(session = <a class="code" href="../../d4/d10/manager_8c.html#ae6e7920350915168f60be3ba77be01fa">find_session_by_nonce</a>(d.<a class="code" href="../../da/db3/structast__http__digest.html#a5804ef809b93820d3437a86e08126bd8">username</a>, nonce, &amp;stale))) {</div><div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160;<span class="comment">       * Create new session.</span></div><div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;<span class="comment">       * While it is not in the list we don&#39;t need any locking</span></div><div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;      <span class="keywordflow">if</span> (!(session = <a class="code" href="../../df/d72/group__Group__AMI.html#ga8547b9864f771b59843128a2054d7c47">build_mansession</a>(remote_address))) {</div><div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (out of memory)&quot;</span>);</div><div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;      }</div><div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;</div><div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, u_username, <span class="keyword">sizeof</span>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>));</div><div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> = nonce;</div><div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">last_ev</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5">grab_last</a>();</div><div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>);</div><div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;</div><div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = u_readperm;</div><div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = u_writeperm;</div><div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = u_writetimeout;</div><div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;</div><div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;      <span class="keywordflow">if</span> (u_displayconnects) {</div><div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;HTTP Manager &#39;%s&#39; logged in from %s\n&quot;</span>, session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;      }</div><div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7782a214e6947ec252279744b2b13484">noncetime</a> = session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a6886313a6b114cbcf7cb60676533c405">sessionstart</a> = time_now;</div><div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">authenticated</a> = 1;</div><div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stale) {</div><div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;<span class="comment">       * Session found, but nonce is stale.</span></div><div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;<span class="comment">       * This could be because an old request (w/old nonce) arrived.</span></div><div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;<span class="comment">       * This may be as the result of http proxy usage (separate delay or</span></div><div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;<span class="comment">       * multipath) or in a situation where a page was refreshed too quickly</span></div><div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;<span class="comment">       * (seen in Firefox).</span></div><div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;<span class="comment">       *</span></div><div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;<span class="comment">       * In this situation, we repeat the 401 auth with the current nonce</span></div><div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;<span class="comment">       * value.</span></div><div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;      nonce = session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a>;</div><div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;      stale = 1;</div><div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;      <span class="keywordflow">goto</span> out_401;</div><div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;      sscanf(d.<a class="code" href="../../da/db3/structast__http__digest.html#afeb5a09193787cf522efc8c90c5485f6">nc</a>, <span class="stringliteral">&quot;%30lx&quot;</span>, &amp;nc);</div><div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160;      <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a805140f5455ca9a45685d306eb9f8834">nc</a> &gt;= nc || ((time_now - session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7782a214e6947ec252279744b2b13484">noncetime</a>) &gt; 62) ) {</div><div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;         <span class="comment">/*</span></div><div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;<span class="comment">          * Nonce time expired (&gt; 2 minutes) or something wrong with nonce</span></div><div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;<span class="comment">          * counter.</span></div><div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;<span class="comment">          *</span></div><div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;<span class="comment">          * Create new nonce key and resend Digest auth request. Old nonce</span></div><div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;<span class="comment">          * is saved for stale checking...</span></div><div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;<span class="comment">          */</span></div><div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;         session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a805140f5455ca9a45685d306eb9f8834">nc</a> = 0; <span class="comment">/* Reset nonce counter */</span></div><div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;         session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a69130d68427d2c01991cac28b2f20ac3">oldnonce</a> = session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a>;</div><div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;         nonce = session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">managerid</a> = <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>();</div><div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;         session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a7782a214e6947ec252279744b2b13484">noncetime</a> = time_now;</div><div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160;         stale = 1;</div><div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;         <span class="keywordflow">goto</span> out_401;</div><div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;         session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a805140f5455ca9a45685d306eb9f8834">nc</a> = nc; <span class="comment">/* All OK, save nonce counter */</span></div><div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;      }</div><div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;   }</div><div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160;</div><div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;</div><div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;   <span class="comment">/* Reset session timeout. */</span></div><div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;   session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">sessiontimeout</a> = time(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) + (<a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> &gt; 5 ? <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> : 5);</div><div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;</div><div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a>(&amp;s.<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;   s.<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a> = <a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a>;</div><div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;   fd = mkstemp(<span class="keyword">template</span>); <span class="comment">/* create a temporary file for command output */</span></div><div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;   unlink(<span class="keyword">template</span>);</div><div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;   <span class="keywordflow">if</span> (fd &lt;= -1) {</div><div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (mkstemp failed)&quot;</span>);</div><div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;      <span class="keywordflow">goto</span> auth_callback_out;</div><div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;   }</div><div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;   s.<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> = <a class="code" href="../../dd/d27/iostream_8h.html#a5dd1ed6f7ebb56180cc9f953db97f0fd">ast_iostream_from_fd</a>(&amp;fd);</div><div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;   <span class="keywordflow">if</span> (!s.<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>) {</div><div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;HTTP Manager, fdopen failed: %s!\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (fdopen failed)&quot;</span>);</div><div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;      close(fd);</div><div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;      <span class="keywordflow">goto</span> auth_callback_out;</div><div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;   }</div><div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;</div><div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;   <span class="keywordflow">if</span> (method == <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80">AST_HTTP_POST</a>) {</div><div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;      params = <a class="code" href="../../dd/d56/http_8h.html#ac000c497701f197370cbef5aa4c1a92e">ast_http_get_post_vars</a>(ser, headers);</div><div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;      <span class="keywordflow">if</span> (!params) {</div><div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;         <span class="keywordflow">switch</span> (<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>) {</div><div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;         <span class="keywordflow">case</span> EFBIG:</div><div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 413, <span class="stringliteral">&quot;Request Entity Too Large&quot;</span>, <span class="stringliteral">&quot;Body too large&quot;</span>);</div><div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(&amp;s);</div><div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;            <span class="keywordflow">goto</span> auth_callback_out;</div><div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;         <span class="keywordflow">case</span> ENOMEM:</div><div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Out of memory&quot;</span>);</div><div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(&amp;s);</div><div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;            <span class="keywordflow">goto</span> auth_callback_out;</div><div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;         <span class="keywordflow">case</span> EIO:</div><div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;            <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 400, <span class="stringliteral">&quot;Bad Request&quot;</span>, <span class="stringliteral">&quot;Error parsing request body&quot;</span>);</div><div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(&amp;s);</div><div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;            <span class="keywordflow">goto</span> auth_callback_out;</div><div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;         }</div><div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;      }</div><div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;   }</div><div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;</div><div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga81510d243e1eb9c6f919e72183e811a6">astman_append_headers</a>(&amp;m, params);</div><div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;</div><div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message</a>(&amp;s, &amp;m)) {</div><div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;      <span class="keywordflow">if</span> (u_displayconnects) {</div><div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;         <a class="code" href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a>(2, <span class="stringliteral">&quot;HTTP Manager &#39;%s&#39; logged off from %s\n&quot;</span>, session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">addr</a>));</div><div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;      }</div><div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;</div><div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a> = 1;</div><div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;   }</div><div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;</div><div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga1b557a85c122f479896a9f598ee49116">astman_free_headers</a>(&amp;m);</div><div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;</div><div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;   result_size = lseek(<a class="code" href="../../dd/d27/iostream_8h.html#a6ebb2730257107d3535fe6cb1285f479">ast_iostream_get_fd</a>(s.<a class="code" href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>), 0, SEEK_CUR); <span class="comment">/* Calculate approx. size of result */</span></div><div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;</div><div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160;   http_header = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(80);</div><div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;   out = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(result_size * 2 + 512);</div><div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;   <span class="keywordflow">if</span> (http_header == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || out == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a>(ser);</div><div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;      <a class="code" href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a>(ser, 500, <span class="stringliteral">&quot;Server Error&quot;</span>, <span class="stringliteral">&quot;Internal Server Error (ast_str_create() out of memory)&quot;</span>);</div><div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a>(&amp;s);</div><div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;      <span class="keywordflow">goto</span> auth_callback_out;</div><div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;   }</div><div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;</div><div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;http_header, 0, <span class="stringliteral">&quot;Content-type: text/%s\r\n&quot;</span>, contenttype[format]);</div><div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;</div><div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;   <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>) {</div><div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;ajax-response&gt;\n&quot;</span>);</div><div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {</div><div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0,</div><div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;      <span class="stringliteral">&quot;&lt;!DOCTYPE HTML PUBLIC \&quot;-//IETF//DTD HTML 2.0//EN\&quot;&gt;\r\n&quot;</span></div><div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;      <span class="stringliteral">&quot;&lt;html&gt;&lt;head&gt;\r\n&quot;</span></div><div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;      <span class="stringliteral">&quot;&lt;title&gt;Asterisk&amp;trade; Manager Interface&lt;/title&gt;\r\n&quot;</span></div><div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;      <span class="stringliteral">&quot;&lt;/head&gt;&lt;body style=\&quot;background-color: #ffffff;\&quot;&gt;\r\n&quot;</span></div><div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;      <span class="stringliteral">&quot;&lt;form method=\&quot;POST\&quot;&gt;\r\n&quot;</span></div><div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;      <span class="stringliteral">&quot;&lt;table align=\&quot;center\&quot; style=\&quot;background-color: #f1f1f1;\&quot; width=\&quot;500\&quot;&gt;\r\n&quot;</span></div><div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;      <span class="stringliteral">&quot;&lt;tr&gt;&lt;th colspan=\&quot;2\&quot; style=\&quot;background-color: #f1f1ff;\&quot;&gt;&lt;h1&gt;Manager Tester&lt;/h1&gt;&lt;/th&gt;&lt;/tr&gt;\r\n&quot;</span></div><div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;      <span class="stringliteral">&quot;&lt;tr&gt;&lt;th colspan=\&quot;2\&quot; style=\&quot;background-color: #f1f1ff;\&quot;&gt;Action: &lt;input name=\&quot;action\&quot; /&gt; Cmd: &lt;input name=\&quot;command\&quot; /&gt;&lt;br&gt;&quot;</span></div><div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;      <span class="stringliteral">&quot;&lt;input type=\&quot;submit\&quot; value=\&quot;Send request\&quot; /&gt;&lt;/th&gt;&lt;/tr&gt;\r\n&quot;</span>);</div><div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;   }</div><div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;</div><div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#aa3ea4a3174e7e0f76c0a4e2318a8ee42">process_output</a>(&amp;s, &amp;out, params, format);</div><div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;</div><div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;   <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>) {</div><div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;/ajax-response&gt;\n&quot;</span>);</div><div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (format == <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>) {</div><div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;out, 0, <span class="stringliteral">&quot;&lt;/table&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;\r\n&quot;</span>);</div><div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;   }</div><div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;</div><div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a>(ser, method, 200, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, http_header, out, 0, 0);</div><div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;   http_header = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;   out = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;</div><div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;auth_callback_out:</div><div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;   <a class="code" href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a>(&amp;s.<a class="code" href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">lock</a>);</div><div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;</div><div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;   <span class="comment">/* Clear resources and unlock manager session */</span></div><div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;   <span class="keywordflow">if</span> (method == <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80">AST_HTTP_POST</a> &amp;&amp; params) {</div><div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(params);</div><div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;   }</div><div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;</div><div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(http_header);</div><div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(out);</div><div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;</div><div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(session);</div><div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>) {</div><div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;      <a class="code" href="../../dd/d27/iostream_8h.html#ac0297067e6921ce6a2c5f3b3d0647d3a">ast_iostream_close</a>(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a>);</div><div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;      session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">stream</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160;   }</div><div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(session);</div><div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;</div><div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;   <span class="keywordflow">if</span> (session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">needdestroy</a>) {</div><div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;Need destroy, doing it now!\n&quot;</span>);</div><div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5">session_destroy</a>(session);</div><div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;   }</div><div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(&amp;d);</div><div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;</div><div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;out_401:</div><div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;   <span class="keywordflow">if</span> (!nonce) {</div><div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;      nonce = <a class="code" href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a>();</div><div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;   }</div><div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;</div><div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;   <a class="code" href="../../dd/d56/http_8h.html#aacbeca1d5a14388e6c2f708ac7a9fffa">ast_http_auth</a>(ser, <a class="code" href="../../df/d72/group__Group__AMI.html#gaa6da807cb7fb332127a4896dd423ed6d">global_realm</a>, nonce, nonce, stale, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(&amp;d);</div><div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;}</div><div class="line"><a name="l08442"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a3365df27c910e70c4263cfe6936edb2b"> 8442</a></span>&#160;</div><div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a3365df27c910e70c4263cfe6936edb2b">manager_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri, <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params,  <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;{</div><div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ser_remote_address_tmp;</div><div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;</div><div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser_remote_address_tmp, &amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>);</div><div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;   retval = <a class="code" href="../../d4/d10/manager_8c.html#af8717f47c7bae13acaf49dc97eafd0b6">generic_http_callback</a>(ser, method, <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>, &amp;ser_remote_address_tmp, uri, get_params, headers);</div><div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>, &amp;ser_remote_address_tmp);</div><div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;}</div><div class="line"><a name="l08453"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a4d89095b3accb6a550e4daf53b089fef"> 8453</a></span>&#160;</div><div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a4d89095b3accb6a550e4daf53b089fef">mxml_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri, <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;{</div><div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ser_remote_address_tmp;</div><div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;</div><div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser_remote_address_tmp, &amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>);</div><div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;   retval = <a class="code" href="../../d4/d10/manager_8c.html#af8717f47c7bae13acaf49dc97eafd0b6">generic_http_callback</a>(ser, method, <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>, &amp;ser_remote_address_tmp, uri, get_params, headers);</div><div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>, &amp;ser_remote_address_tmp);</div><div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160;}</div><div class="line"><a name="l08464"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#aa40b9899223e9b2edf58a6fa17d53de4"> 8464</a></span>&#160;</div><div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#aa40b9899223e9b2edf58a6fa17d53de4">rawman_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri, <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;{</div><div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ser_remote_address_tmp;</div><div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;</div><div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser_remote_address_tmp, &amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>);</div><div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;   retval = <a class="code" href="../../d4/d10/manager_8c.html#af8717f47c7bae13acaf49dc97eafd0b6">generic_http_callback</a>(ser, method, <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>, &amp;ser_remote_address_tmp, uri, get_params, headers);</div><div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>, &amp;ser_remote_address_tmp);</div><div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;}</div><div class="line"><a name="l08475"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#acbf2cba285ffaf8ad7040ee38da09c54"> 8475</a></span>&#160;</div><div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> <a class="code" href="../../d4/d10/manager_8c.html#acbf2cba285ffaf8ad7040ee38da09c54">rawmanuri</a> = {</div><div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;   .<a class="code" href="../../d0/d6c/structast__http__uri.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = <span class="stringliteral">&quot;Raw HTTP Manager Event Interface&quot;</span>,</div><div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;   .uri = <span class="stringliteral">&quot;rawman&quot;</span>,</div><div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;   .callback = <a class="code" href="../../d4/d10/manager_8c.html#aa40b9899223e9b2edf58a6fa17d53de4">rawman_http_callback</a>,</div><div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;   .data = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;   .key = __FILE__,</div><div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;};</div><div class="line"><a name="l08483"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a7df8bb3a46439212b942a1802e5fa167"> 8483</a></span>&#160;</div><div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> <a class="code" href="../../d4/d10/manager_8c.html#a7df8bb3a46439212b942a1802e5fa167">manageruri</a> = {</div><div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;   .<a class="code" href="../../d0/d6c/structast__http__uri.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = <span class="stringliteral">&quot;HTML Manager Event Interface&quot;</span>,</div><div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;   .uri = <span class="stringliteral">&quot;manager&quot;</span>,</div><div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;   .callback = <a class="code" href="../../d4/d10/manager_8c.html#a3365df27c910e70c4263cfe6936edb2b">manager_http_callback</a>,</div><div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;   .data = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;   .key = __FILE__,</div><div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;};</div><div class="line"><a name="l08491"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a2baf609069e59000350384fc6d5e2e48"> 8491</a></span>&#160;</div><div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> <a class="code" href="../../d4/d10/manager_8c.html#a2baf609069e59000350384fc6d5e2e48">managerxmluri</a> = {</div><div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;   .<a class="code" href="../../d0/d6c/structast__http__uri.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = <span class="stringliteral">&quot;XML Manager Event Interface&quot;</span>,</div><div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;   .uri = <span class="stringliteral">&quot;mxml&quot;</span>,</div><div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;   .callback = <a class="code" href="../../d4/d10/manager_8c.html#a4d89095b3accb6a550e4daf53b089fef">mxml_http_callback</a>,</div><div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;   .data = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;   .key = __FILE__,</div><div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;};</div><div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;</div><div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;</div><div class="line"><a name="l08501"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ad998711c3c3427063219f5412858fabb"> 8501</a></span>&#160;<span class="comment">/* Callback with Digest authentication */</span></div><div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ad998711c3c3427063219f5412858fabb">auth_manager_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d0/d6c/structast__http__uri.html#a69ec24fb2d0a5f5e532deb9adaab81d6">uri</a>, <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params,  <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;{</div><div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ser_remote_address_tmp;</div><div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;</div><div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser_remote_address_tmp, &amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>);</div><div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;   retval = <a class="code" href="../../d4/d10/manager_8c.html#adc05403d9e5f69a12e0d473f88cc3618">auth_http_callback</a>(ser, method, <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a>, &amp;ser_remote_address_tmp, uri, get_params, headers);</div><div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>, &amp;ser_remote_address_tmp);</div><div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;}</div><div class="line"><a name="l08512"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a05b67ad13ff084e7b4ffba5a69e99d77"> 8512</a></span>&#160;</div><div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a05b67ad13ff084e7b4ffba5a69e99d77">auth_mxml_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri, <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;{</div><div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ser_remote_address_tmp;</div><div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;</div><div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser_remote_address_tmp, &amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>);</div><div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;   retval = <a class="code" href="../../d4/d10/manager_8c.html#adc05403d9e5f69a12e0d473f88cc3618">auth_http_callback</a>(ser, method, <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a>, &amp;ser_remote_address_tmp, uri, get_params, headers);</div><div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>, &amp;ser_remote_address_tmp);</div><div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;}</div><div class="line"><a name="l08523"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#abd0b094f270d26d8aa3127f3ef116e0f"> 8523</a></span>&#160;</div><div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#abd0b094f270d26d8aa3127f3ef116e0f">auth_rawman_http_callback</a>(<span class="keyword">struct</span> <a class="code" href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a> *ser, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> *urih, <span class="keyword">const</span> <span class="keywordtype">char</span> *uri, <span class="keyword">enum</span> <a class="code" href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a> <a class="code" href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a>, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *get_params, <span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *headers)</div><div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;{</div><div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ser_remote_address_tmp;</div><div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;</div><div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser_remote_address_tmp, &amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>);</div><div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;   retval = <a class="code" href="../../d4/d10/manager_8c.html#adc05403d9e5f69a12e0d473f88cc3618">auth_http_callback</a>(ser, method, <a class="code" href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a>, &amp;ser_remote_address_tmp, uri, get_params, headers);</div><div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ser-&gt;<a class="code" href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">remote_address</a>, &amp;ser_remote_address_tmp);</div><div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a>;</div><div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;}</div><div class="line"><a name="l08534"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ac737e999fb3203231cb6f6325d9161f8"> 8534</a></span>&#160;</div><div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> <a class="code" href="../../d4/d10/manager_8c.html#ac737e999fb3203231cb6f6325d9161f8">arawmanuri</a> = {</div><div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;   .<a class="code" href="../../d0/d6c/structast__http__uri.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = <span class="stringliteral">&quot;Raw HTTP Manager Event Interface w/Digest authentication&quot;</span>,</div><div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;   .uri = <span class="stringliteral">&quot;arawman&quot;</span>,</div><div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;   .has_subtree = 0,</div><div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;   .callback = <a class="code" href="../../d4/d10/manager_8c.html#abd0b094f270d26d8aa3127f3ef116e0f">auth_rawman_http_callback</a>,</div><div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;   .data = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;   .key = __FILE__,</div><div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;};</div><div class="line"><a name="l08543"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#adf65c27da57ed800b4068f86892f0672"> 8543</a></span>&#160;</div><div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> <a class="code" href="../../d4/d10/manager_8c.html#adf65c27da57ed800b4068f86892f0672">amanageruri</a> = {</div><div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;   .<a class="code" href="../../d0/d6c/structast__http__uri.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = <span class="stringliteral">&quot;HTML Manager Event Interface w/Digest authentication&quot;</span>,</div><div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;   .uri = <span class="stringliteral">&quot;amanager&quot;</span>,</div><div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;   .has_subtree = 0,</div><div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;   .callback = <a class="code" href="../../d4/d10/manager_8c.html#ad998711c3c3427063219f5412858fabb">auth_manager_http_callback</a>,</div><div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;   .data = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;   .key = __FILE__,</div><div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;};</div><div class="line"><a name="l08552"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#aef58613f88eb27230b85f38df4a08600"> 8552</a></span>&#160;</div><div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a> <a class="code" href="../../d4/d10/manager_8c.html#aef58613f88eb27230b85f38df4a08600">amanagerxmluri</a> = {</div><div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;   .<a class="code" href="../../d0/d6c/structast__http__uri.html#a68344fa88cf4e86b5079fd69a5c22d57">description</a> = <span class="stringliteral">&quot;XML Manager Event Interface w/Digest authentication&quot;</span>,</div><div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;   .uri = <span class="stringliteral">&quot;amxml&quot;</span>,</div><div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;   .has_subtree = 0,</div><div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;   .callback = <a class="code" href="../../d4/d10/manager_8c.html#a05b67ad13ff084e7b4ffba5a69e99d77">auth_mxml_http_callback</a>,</div><div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;   .data = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;   .key = __FILE__,</div><div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;};</div><div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08562"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ae4ed80bf0a4a975845d386538b74834c"> 8562</a></span>&#160;<span class="comment">/*! \brief Get number of logged in sessions for a login name */</span></div><div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ae4ed80bf0a4a975845d386538b74834c">get_manager_sessions_cb</a>(<span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg, <span class="keywordtype">void</span> *<a class="code" href="../../d0/d6c/structast__http__uri.html#a735984d41155bc1032e09bece8f8d66d">data</a>, <span class="keywordtype">int</span> flags)</div><div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;{</div><div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/d05/structmansession__session.html">mansession_session</a> *<a class="code" href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a> = obj;</div><div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *login = (<span class="keywordtype">char</span> *)arg;</div><div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;   <span class="keywordtype">int</span> *no_sessions = data;</div><div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;</div><div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;   <span class="keywordflow">if</span> (strcasecmp(session-&gt;<a class="code" href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, login) == 0) {</div><div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;      (*no_sessions)++;</div><div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;   }</div><div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;</div><div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;}</div><div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;</div><div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08577"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ab7565a1d462b908f20576b02c493ed27"> 8577</a></span>&#160;<span class="comment">/*! \brief  ${AMI_CLIENT()} Dialplan function - reads manager client data */</span></div><div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ab7565a1d462b908f20576b02c493ed27">function_amiclient</a>(<span class="keyword">struct</span> <a class="code" href="../../df/d3c/structast__channel.html">ast_channel</a> *chan, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd, <span class="keywordtype">char</span> *data, <span class="keywordtype">char</span> *<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a>, <span class="keywordtype">size_t</span> <a class="code" href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a>)</div><div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;{</div><div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;</div><div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;      <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(param);</div><div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;   );</div><div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;</div><div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;</div><div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(data) ) {</div><div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;AMI_CLIENT() requires two arguments: AMI_CLIENT(&lt;name&gt;[,&lt;arg&gt;])\n&quot;</span>);</div><div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;   }</div><div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, data);</div><div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;   <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.name = <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.name);</div><div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;   <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.param = <a class="code" href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.param);</div><div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;</div><div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;   <span class="keywordflow">if</span> (!(user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.name))) {</div><div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;There&#39;s no manager user called : \&quot;%s\&quot;\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.name);</div><div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;   }</div><div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;</div><div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;   <span class="keywordflow">if</span> (!strcasecmp(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.param, <span class="stringliteral">&quot;sessions&quot;</span>)) {</div><div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;      <span class="keywordtype">int</span> no_sessions = 0;</div><div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160;</div><div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;      sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(mgr_sessions);</div><div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;      <span class="keywordflow">if</span> (sessions) {</div><div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a>(sessions, 0, <a class="code" href="../../d4/d10/manager_8c.html#ae4ed80bf0a4a975845d386538b74834c">get_manager_sessions_cb</a>, <span class="comment">/*login name*/</span> data, &amp;no_sessions);</div><div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;      }</div><div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;      snprintf(buf, len, <span class="stringliteral">&quot;%d&quot;</span>, no_sessions);</div><div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid arguments provided to function AMI_CLIENT: %s\n&quot;</span>, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.param);</div><div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;</div><div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;   }</div><div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;</div><div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;}</div><div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;</div><div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08624"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a3eb3c2c7854c4ed46debc3f404e0d569"> 8624</a></span>&#160;<span class="comment">/*! \brief description of AMI_CLIENT dialplan function */</span></div><div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../db/dc0/structast__custom__function.html">ast_custom_function</a> <a class="code" href="../../d4/d10/manager_8c.html#a3eb3c2c7854c4ed46debc3f404e0d569">managerclient_function</a> = {</div><div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;   .<a class="code" href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">name</a> = <span class="stringliteral">&quot;AMI_CLIENT&quot;</span>,</div><div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;   .read = <a class="code" href="../../d4/d10/manager_8c.html#ab7565a1d462b908f20576b02c493ed27">function_amiclient</a>,</div><div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;   .read_max = 12,</div><div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;};</div><div class="line"><a name="l08630"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23"> 8630</a></span>&#160;</div><div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a> = 0;</div><div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;<span class="comment">/*! \brief cleanup code called at each iteration of server_root,</span></div><div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;<span class="comment"> * guaranteed to happen every 5 seconds at most</span></div><div class="line"><a name="l08635"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a47595f828e8f0e6b1faf176311417168"> 8635</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#a47595f828e8f0e6b1faf176311417168">purge_old_stuff</a>(<span class="keywordtype">void</span> *data)</div><div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;{</div><div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gaa98613bbc66bdf99b8423afcfc4f9b2c">purge_sessions</a>(1);</div><div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga0464e7b1c82d29cbe8b3f70bf7ca29c6">purge_events</a>();</div><div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;}</div><div class="line"><a name="l08641"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b"> 8641</a></span>&#160;</div><div class="line"><a name="l08642"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8"> 8642</a></span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d5/d90/structast__tls__config.html">ast_tls_config</a> <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>;</div><div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/d2b/structast__tcptls__session__args.html">ast_tcptls_session_args</a> <a class="code" href="../../d4/d10/manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a> = {</div><div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;   .<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#ad6d7a8463d59a02084cf9d4360f46b79">accept_fd</a> = -1,</div><div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;   .master = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>,</div><div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;   .tls_cfg = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;   .poll_timeout = 5000,   <span class="comment">/* wake up every 5 seconds */</span></div><div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;   .periodic_fn = <a class="code" href="../../d4/d10/manager_8c.html#a47595f828e8f0e6b1faf176311417168">purge_old_stuff</a>,</div><div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;   .name = <span class="stringliteral">&quot;AMI server&quot;</span>,</div><div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;   .accept_fn = <a class="code" href="../../d4/ddf/tcptls_8h.html#ac1fd2d3038c57a8f8f28f4b558eb5583">ast_tcptls_server_root</a>,   <span class="comment">/* thread doing the accept() */</span></div><div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;   .worker_fn = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa457796588f0d13a7dc02e3db64c2e7d">session_do</a>,   <span class="comment">/* thread handling the session */</span></div><div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;};</div><div class="line"><a name="l08653"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58"> 8653</a></span>&#160;</div><div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../da/d2b/structast__tcptls__session__args.html">ast_tcptls_session_args</a> <a class="code" href="../../d4/d10/manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a> = {</div><div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;   .<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#ad6d7a8463d59a02084cf9d4360f46b79">accept_fd</a> = -1,</div><div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;   .master = <a class="code" href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a>,</div><div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;   .tls_cfg = &amp;<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>,</div><div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;   .poll_timeout = -1,  <span class="comment">/* the other does the periodic cleanup */</span></div><div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;   .name = <span class="stringliteral">&quot;AMI TLS server&quot;</span>,</div><div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;   .accept_fn = <a class="code" href="../../d4/ddf/tcptls_8h.html#ac1fd2d3038c57a8f8f28f4b558eb5583">ast_tcptls_server_root</a>,   <span class="comment">/* thread doing the accept() */</span></div><div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;   .worker_fn = <a class="code" href="../../df/d72/group__Group__AMI.html#gaa457796588f0d13a7dc02e3db64c2e7d">session_do</a>,   <span class="comment">/* thread handling the session */</span></div><div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;};</div><div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08664"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a8a69ab89502cc10c5d0890aba4876797"> 8664</a></span>&#160;<span class="comment">/*! \brief CLI command manager show settings */</span></div><div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d10/manager_8c.html#a8a69ab89502cc10c5d0890aba4876797">handle_manager_show_settings</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;{</div><div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show settings&quot;</span>;</div><div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;         <span class="stringliteral">&quot;Usage: manager show settings\n&quot;</span></div><div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;         <span class="stringliteral">&quot;       Provides detailed list of the configuration of the Manager.\n&quot;</span>;</div><div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;   }</div><div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;<span class="preprocessor">#define FORMAT &quot;  %-25.25s  %-15.55s\n&quot;</span></div><div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;<span class="preprocessor">#define FORMAT2 &quot;  %-25.25s  %-15d\n&quot;</span></div><div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;   }</div><div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;\nGlobal Settings:\n&quot;</span>);</div><div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;----------------\n&quot;</span>);</div><div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Manager (AMI):&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a>));</div><div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Web Manager (AMI/HTTP):&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a>));</div><div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;TCP Bindaddress:&quot;</span>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> != 0 ? <a class="code" href="../../db/df1/netsock2_8h.html#aae9156c7fe6dff51463f29ed1c3b96c9">ast_sockaddr_stringify</a>(&amp;ami_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>) : <span class="stringliteral">&quot;Disabled&quot;</span>);</div><div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#acfd58ce0ec836919236d7a1908494970">FORMAT2</a>, <span class="stringliteral">&quot;HTTP Timeout (seconds):&quot;</span>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a>);</div><div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;TLS Enable:&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a>));</div><div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;TLS Bindaddress:&quot;</span>, <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a> != 0 ? <a class="code" href="../../db/df1/netsock2_8h.html#aae9156c7fe6dff51463f29ed1c3b96c9">ast_sockaddr_stringify</a>(&amp;amis_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>) : <span class="stringliteral">&quot;Disabled&quot;</span>);</div><div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;TLS Certfile:&quot;</span>, <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a>);</div><div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;TLS Privatekey:&quot;</span>, <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a6005f11af6a60f4169876fcd075595ca">pvtfile</a>);</div><div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;TLS Cipher:&quot;</span>, <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a>);</div><div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Allow multiple login:&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a>));</div><div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Display connects:&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>));</div><div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Timestamp events:&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab">timestampevents</a>));</div><div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Channel vars:&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e">manager_channelvars</a>, <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <a class="code" href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a>, <span class="stringliteral">&quot;Debug:&quot;</span>, <a class="code" href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a>));</div><div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;<span class="preprocessor">#undef FORMAT</span></div><div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;<span class="preprocessor">#undef FORMAT2</span></div><div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;</div><div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160;}</div><div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;</div><div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l08705"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a22192aef4770a1f95ea4f87b4125604d"> 8705</a></span>&#160;</div><div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a22192aef4770a1f95ea4f87b4125604d">ast_xml_doc_item_cmp_fn</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *a, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a>)</div><div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160;{</div><div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> **item_a = (<span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> **)a;</div><div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> **item_b = (<span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> **)b;</div><div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;   <span class="keywordflow">return</span> strcmp((*item_a)-&gt;name, (*item_b)-&gt;name);</div><div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;}</div><div class="line"><a name="l08712"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#af8d11f9c8eeaab4ed0463aa30e3fd3e1"> 8712</a></span>&#160;</div><div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d10/manager_8c.html#af8d11f9c8eeaab4ed0463aa30e3fd3e1">handle_manager_show_events</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160;{</div><div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a>;</div><div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> *it_events;</div><div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> *<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>;</div><div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> **items;</div><div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/da2/structast__str.html">ast_str</a> *buffer;</div><div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;   <span class="keywordtype">int</span> i = 0, totalitems = 0;</div><div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;</div><div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;   <span class="keywordflow">switch</span> (cmd) {</div><div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>:</div><div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show events&quot;</span>;</div><div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;         <span class="stringliteral">&quot;Usage: manager show events\n&quot;</span></div><div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;            <span class="stringliteral">&quot;  Prints a listing of the available Asterisk manager interface events.\n&quot;</span>;</div><div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;   <span class="keywordflow">case</span> <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>:</div><div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;   }</div><div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 3) {</div><div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160;   }</div><div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;</div><div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;   buffer = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;   <span class="keywordflow">if</span> (!buffer) {</div><div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;   }</div><div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;</div><div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;   events = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(event_docs);</div><div class="line"><a name="l08742"></a><span class="lineno"> 8742</span>&#160;   <span class="keywordflow">if</span> (!events) {</div><div class="line"><a name="l08743"></a><span class="lineno"> 8743</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;No manager event documentation loaded\n&quot;</span>);</div><div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buffer);</div><div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160;   }</div><div class="line"><a name="l08747"></a><span class="lineno"> 8747</span>&#160;</div><div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a>(events);</div><div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;   <span class="keywordflow">if</span> (!(it_events = <a class="code" href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a>(events, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>))) {</div><div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(events);</div><div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to create iterator for events container\n&quot;</span>);</div><div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buffer);</div><div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(events, -1);</div><div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;   }</div><div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;   <span class="keywordflow">if</span> (!(items = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> *), <a class="code" href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a>(events)))) {</div><div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(events);</div><div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Unable to create temporary sorting array for events\n&quot;</span>);</div><div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(it_events);</div><div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buffer);</div><div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(events, -1);</div><div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;   }</div><div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a>(events);</div><div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;</div><div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160;   <span class="keywordflow">while</span> ((item = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(it_events))) {</div><div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;      items[totalitems++] = <a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>;</div><div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(item, -1);</div><div class="line"><a name="l08769"></a><span class="lineno"> 8769</span>&#160;   }</div><div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160;</div><div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;   qsort(items, totalitems, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> *), <a class="code" href="../../d4/d10/manager_8c.html#a22192aef4770a1f95ea4f87b4125604d">ast_xml_doc_item_cmp_fn</a>);</div><div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;</div><div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Events:\n&quot;</span>);</div><div class="line"><a name="l08774"></a><span class="lineno"> 8774</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;  --------------------  --------------------  --------------------  \n&quot;</span>);</div><div class="line"><a name="l08775"></a><span class="lineno"> 8775</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; totalitems; i++) {</div><div class="line"><a name="l08776"></a><span class="lineno"> 8776</span>&#160;      <a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(&amp;buffer, 0, <span class="stringliteral">&quot;  %-20.20s&quot;</span>, items[i]-&gt;<a class="code" href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a>);</div><div class="line"><a name="l08777"></a><span class="lineno"> 8777</span>&#160;      <span class="keywordflow">if</span> ((i + 1) % 3 == 0) {</div><div class="line"><a name="l08778"></a><span class="lineno"> 8778</span>&#160;         <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer));</div><div class="line"><a name="l08779"></a><span class="lineno"> 8779</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a>(&amp;buffer, 0, <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l08780"></a><span class="lineno"> 8780</span>&#160;      }</div><div class="line"><a name="l08781"></a><span class="lineno"> 8781</span>&#160;   }</div><div class="line"><a name="l08782"></a><span class="lineno"> 8782</span>&#160;   <span class="keywordflow">if</span> ((i + 1) % 3 != 0) {</div><div class="line"><a name="l08783"></a><span class="lineno"> 8783</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s\n&quot;</span>, <a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(buffer));</div><div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;   }</div><div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160;</div><div class="line"><a name="l08786"></a><span class="lineno"> 8786</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(it_events);</div><div class="line"><a name="l08787"></a><span class="lineno"> 8787</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(items);</div><div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(events, -1);</div><div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(buffer);</div><div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;</div><div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160;}</div><div class="line"><a name="l08793"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga12892108a64ff8588dbcd69a4bdf654e"> 8793</a></span>&#160;</div><div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga12892108a64ff8588dbcd69a4bdf654e">print_event_instance</a>(<span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a, <span class="keyword">struct</span> <a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> *instance)</div><div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160;{</div><div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;   <span class="keywordtype">char</span> syntax_title[64], description_title[64], synopsis_title[64], seealso_title[64], arguments_title[64];</div><div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160;</div><div class="line"><a name="l08798"></a><span class="lineno"> 8798</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(synopsis_title, <span class="stringliteral">&quot;[Synopsis]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l08799"></a><span class="lineno"> 8799</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(description_title, <span class="stringliteral">&quot;[Description]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l08800"></a><span class="lineno"> 8800</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(syntax_title, <span class="stringliteral">&quot;[Syntax]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l08801"></a><span class="lineno"> 8801</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(seealso_title, <span class="stringliteral">&quot;[See Also]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l08802"></a><span class="lineno"> 8802</span>&#160;   <a class="code" href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a>(arguments_title, <span class="stringliteral">&quot;[Arguments]\n&quot;</span>, <a class="code" href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a>, 0, 40);</div><div class="line"><a name="l08803"></a><span class="lineno"> 8803</span>&#160;</div><div class="line"><a name="l08804"></a><span class="lineno"> 8804</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#afd4fa183745fe419aadcb64ff25df76f">synopsis</a>))) {</div><div class="line"><a name="l08805"></a><span class="lineno"> 8805</span>&#160;      <span class="keywordtype">char</span> *<a class="code" href="../../d0/db6/app__mysql_8c.html#afbb30cae381f627fb08e1acdac926270">synopsis</a> = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#afd4fa183745fe419aadcb64ff25df76f">synopsis</a>), 1);</div><div class="line"><a name="l08806"></a><span class="lineno"> 8806</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s%s\n\n&quot;</span>, synopsis_title, synopsis);</div><div class="line"><a name="l08807"></a><span class="lineno"> 8807</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(synopsis);</div><div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160;   }</div><div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#a01b39be4dd41eeda5dff6bd9835cdebe">syntax</a>))) {</div><div class="line"><a name="l08810"></a><span class="lineno"> 8810</span>&#160;      <span class="keywordtype">char</span> *syntax = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#a01b39be4dd41eeda5dff6bd9835cdebe">syntax</a>), 1);</div><div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s%s\n\n&quot;</span>, syntax_title, syntax);</div><div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(syntax);</div><div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;   }</div><div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#abf4247f8de03d593ac8e288d354d6aa9">description</a>))) {</div><div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;      <span class="keywordtype">char</span> *description = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#abf4247f8de03d593ac8e288d354d6aa9">description</a>), 1);</div><div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s%s\n\n&quot;</span>, description_title, description);</div><div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(description);</div><div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;   }</div><div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#a6b8fc14a9dd623efaf1a93949341bd4e">arguments</a>))) {</div><div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160;      <span class="keywordtype">char</span> *arguments = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#a6b8fc14a9dd623efaf1a93949341bd4e">arguments</a>), 1);</div><div class="line"><a name="l08821"></a><span class="lineno"> 8821</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s%s\n\n&quot;</span>, arguments_title, arguments);</div><div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(arguments);</div><div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;   }</div><div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#ad9060ce736c45736fb6255a07d555831">seealso</a>))) {</div><div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160;      <span class="keywordtype">char</span> *seealso = <a class="code" href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a>(<a class="code" href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a>(instance-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#ad9060ce736c45736fb6255a07d555831">seealso</a>), 1);</div><div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;%s%s\n\n&quot;</span>, seealso_title, seealso);</div><div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;      <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(seealso);</div><div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;   }</div><div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;}</div><div class="line"><a name="l08830"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a55e80c6eb9c6407bf5af1f4869bb1f8d"> 8830</a></span>&#160;</div><div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d10/manager_8c.html#a55e80c6eb9c6407bf5af1f4869bb1f8d">handle_manager_show_event</a>(<span class="keyword">struct</span> <a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> *e, <span class="keywordtype">int</span> cmd, <span class="keyword">struct</span> <a class="code" href="../../d3/dad/structast__cli__args.html">ast_cli_args</a> *a)</div><div class="line"><a name="l08832"></a><span class="lineno"> 8832</span>&#160;{</div><div class="line"><a name="l08833"></a><span class="lineno"> 8833</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *, <a class="code" href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>);</div><div class="line"><a name="l08834"></a><span class="lineno"> 8834</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d9/d97/structao2__iterator.html">ao2_iterator</a> it_events;</div><div class="line"><a name="l08835"></a><span class="lineno"> 8835</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a> *<a class="code" href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a>, *temp;</div><div class="line"><a name="l08836"></a><span class="lineno"> 8836</span>&#160;   <span class="keywordtype">int</span> length;</div><div class="line"><a name="l08837"></a><span class="lineno"> 8837</span>&#160;</div><div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;   <span class="keywordflow">if</span> (cmd == <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a>) {</div><div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">command</a> = <span class="stringliteral">&quot;manager show event&quot;</span>;</div><div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;      e-&gt;<a class="code" href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">usage</a> =</div><div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;         <span class="stringliteral">&quot;Usage: manager show event &lt;eventname&gt;\n&quot;</span></div><div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;         <span class="stringliteral">&quot;       Provides a detailed description a Manager interface event.\n&quot;</span>;</div><div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;   }</div><div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;</div><div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;   <a class="code" href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a>(event_docs);</div><div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a>) {</div><div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;No manager event documentation loaded\n&quot;</span>);</div><div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;   }</div><div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;</div><div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;   <span class="keywordflow">if</span> (cmd == <a class="code" href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a>) {</div><div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;      <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">pos</a> != 3) {</div><div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;      }</div><div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;</div><div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160;      length = strlen(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>);</div><div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;      it_events = <a class="code" href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a>(<a class="code" href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a>, 0);</div><div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;      <span class="keywordflow">while</span> ((item = <a class="code" href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a>(&amp;it_events))) {</div><div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;         <span class="keywordflow">if</span> (!strncasecmp(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, item-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>, length)) {</div><div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a>(<a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(item-&gt;<a class="code" href="../../d8/d46/structast__xml__doc__item.html#ace9168767fc3707cf5f0a7d049682ba3">name</a>))) {</div><div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;               <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(item, -1);</div><div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160;               <span class="keywordflow">break</span>;</div><div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;            }</div><div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;         }</div><div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(item, -1);</div><div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;      }</div><div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a>(&amp;it_events);</div><div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;</div><div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;   }</div><div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160;</div><div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">argc</a> != 4) {</div><div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a>;</div><div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;   }</div><div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;</div><div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;   <span class="keywordflow">if</span> (!(item = <a class="code" href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a>(<a class="code" href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3], <a class="code" href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a>))) {</div><div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Could not find event &#39;%s&#39;\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;   }</div><div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;</div><div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a>(a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">fd</a>, <span class="stringliteral">&quot;Event: %s\n&quot;</span>, a-&gt;<a class="code" href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">argv</a>[3]);</div><div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;   <span class="keywordflow">for</span> (temp = item; temp; temp = <a class="code" href="../../df/d90/linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6">AST_LIST_NEXT</a>(temp, <a class="code" href="../../d8/d46/structast__xml__doc__item.html#a623575abd8c4c7cdcab02fa4156c3762">next</a>)) {</div><div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga12892108a64ff8588dbcd69a4bdf654e">print_event_instance</a>(a, temp);</div><div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160;   }</div><div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;</div><div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(item, -1);</div><div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a>;</div><div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;}</div><div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;</div><div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l08892"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#acde8c68737c4518caab9fe2769738002"> 8892</a></span>&#160;</div><div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;<span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a> <a class="code" href="../../d4/d10/manager_8c.html#acde8c68737c4518caab9fe2769738002">cli_manager</a>[] = {</div><div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga689bc5c3cd185f54178b3719a5e834ac">handle_showmancmd</a>, <span class="stringliteral">&quot;Show a manager interface command&quot;</span>),</div><div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gad3ecc04e5e7484463d64fa6d00c2bdd2">handle_showmancmds</a>, <span class="stringliteral">&quot;List manager interface commands&quot;</span>),</div><div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga26ac9d8e0f9483bd06741753ebcfe6d6">handle_showmanconn</a>, <span class="stringliteral">&quot;List connected manager interface users&quot;</span>),</div><div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga4aa0274bed0fc74d53f43cad92c2e263">handle_showmaneventq</a>, <span class="stringliteral">&quot;List manager interface queued events&quot;</span>),</div><div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga0a3fb6c9b8db835d467df360cb34f403">handle_showmanagers</a>, <span class="stringliteral">&quot;List configured manager users&quot;</span>),</div><div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga5226d999bfd60cad437504afd1db054c">handle_showmanager</a>, <span class="stringliteral">&quot;Display information on a specific manager user&quot;</span>),</div><div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gac71fa21ee14d825bf98e4a658604c492">handle_mandebug</a>, <span class="stringliteral">&quot;Show, enable, disable debugging of the manager code&quot;</span>),</div><div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gae44104439ab29d44fcd84f0361493625">handle_manager_reload</a>, <span class="stringliteral">&quot;Reload manager configurations&quot;</span>),</div><div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d4/d10/manager_8c.html#a8a69ab89502cc10c5d0890aba4876797">handle_manager_show_settings</a>, <span class="stringliteral">&quot;Show manager global settings&quot;</span>),</div><div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d4/d10/manager_8c.html#af8d11f9c8eeaab4ed0463aa30e3fd3e1">handle_manager_show_events</a>, <span class="stringliteral">&quot;List manager interface events&quot;</span>),</div><div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a>(<a class="code" href="../../d4/d10/manager_8c.html#a55e80c6eb9c6407bf5af1f4869bb1f8d">handle_manager_show_event</a>, <span class="stringliteral">&quot;Show a manager interface event&quot;</span>),</div><div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;};</div><div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;<span class="comment"> * \brief Load the config channelvars variable.</span></div><div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;<span class="comment"> * \param var Config variable to load.</span></div><div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;<span class="comment"> * \return Nothing</span></div><div class="line"><a name="l08916"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a62beba58710ea6a53c85928d36f59477"> 8916</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#a62beba58710ea6a53c85928d36f59477">load_channelvars</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>)</div><div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;{</div><div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;        <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>,</div><div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;                <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a>(vars)[<a class="code" href="../../df/d72/group__Group__AMI.html#ga5c707deff4e68c7283f2ed73665e0c77">MAX_VARS</a>];</div><div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;        );</div><div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;</div><div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e">manager_channelvars</a>);</div><div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e">manager_channelvars</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l08926"></a><span class="lineno"> 8926</span>&#160;</div><div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;   <span class="comment">/* parse the setting */</span></div><div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;   parse = <a class="code" href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e">manager_channelvars</a>);</div><div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;   <a class="code" href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>, parse);</div><div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160;</div><div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;   <a class="code" href="../../d5/d7b/channel_8h.html#a43d96fc80c7e8289f1fac8d7b8fef3ec">ast_channel_set_manager_vars</a>(<a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.argc, <a class="code" href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a>.vars);</div><div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;}</div><div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160;<span class="comment"> * \brief Free a user record.  Should already be removed from the list</span></div><div class="line"><a name="l08937"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ad43b79b766118eebf1426a908d0e27ae"> 8937</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#ad43b79b766118eebf1426a908d0e27ae">manager_free_user</a>(<span class="keyword">struct</span> <a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a>)</div><div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;{</div><div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a">a1_hash</a>);</div><div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>);</div><div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;   <span class="keywordflow">if</span> (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>) {</div><div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, -1, <span class="stringliteral">&quot;decrement ref for white container, should be last one&quot;</span>);</div><div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160;   }</div><div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;   <span class="keywordflow">if</span> (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>) {</div><div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>, -1, <span class="stringliteral">&quot;decrement ref for black container, should be last one&quot;</span>);</div><div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;   }</div><div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;   user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a> = <a class="code" href="../../d5/d59/acl_8h.html#a7fc796b79184fa0f4340037e5c1445c6">ast_free_acl_list</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>);</div><div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>);</div><div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user);</div><div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;}</div><div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;<span class="comment"></span></div><div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;<span class="comment">/*!</span></div><div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;<span class="comment"> * \internal</span></div><div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;<span class="comment"> * \brief Clean up resources on Asterisk shutdown</span></div><div class="line"><a name="l08956"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a999f980f0d4926c5688bc346f14301e8"> 8956</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#a999f980f0d4926c5688bc346f14301e8">manager_shutdown</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;{</div><div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../dc/d12/res__config__ldap_8c.html#a930c15eddfe0826ff30e658c9d50b9b4">user</a>;</div><div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;</div><div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;   <span class="comment">/* This event is not actually transmitted, but causes all TCP sessions to be closed */</span></div><div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;   <a class="code" href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gac6a246405a298682d5f34f8856b68461">EVENT_FLAG_SHUTDOWN</a>, <span class="stringliteral">&quot;CloseSession&quot;</span>, <span class="stringliteral">&quot;CloseSession: true\r\n&quot;</span>);</div><div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160;</div><div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Ping&quot;</span>);</div><div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Events&quot;</span>);</div><div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Logoff&quot;</span>);</div><div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Login&quot;</span>);</div><div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Challenge&quot;</span>);</div><div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Hangup&quot;</span>);</div><div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Status&quot;</span>);</div><div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Setvar&quot;</span>);</div><div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Getvar&quot;</span>);</div><div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;GetConfig&quot;</span>);</div><div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;GetConfigJSON&quot;</span>);</div><div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;UpdateConfig&quot;</span>);</div><div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;CreateConfig&quot;</span>);</div><div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;ListCategories&quot;</span>);</div><div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Redirect&quot;</span>);</div><div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Atxfer&quot;</span>);</div><div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;CancelAtxfer&quot;</span>);</div><div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Originate&quot;</span>);</div><div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Command&quot;</span>);</div><div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;ExtensionState&quot;</span>);</div><div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;PresenceState&quot;</span>);</div><div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;AbsoluteTimeout&quot;</span>);</div><div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;MailboxStatus&quot;</span>);</div><div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;MailboxCount&quot;</span>);</div><div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;ListCommands&quot;</span>);</div><div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;SendText&quot;</span>);</div><div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;UserEvent&quot;</span>);</div><div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;WaitEvent&quot;</span>);</div><div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;CoreSettings&quot;</span>);</div><div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;CoreStatus&quot;</span>);</div><div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Reload&quot;</span>);</div><div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;LoggerRotate&quot;</span>);</div><div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;CoreShowChannels&quot;</span>);</div><div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;ModuleLoad&quot;</span>);</div><div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;ModuleCheck&quot;</span>);</div><div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;AOCMessage&quot;</span>);</div><div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;Filter&quot;</span>);</div><div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a>(<span class="stringliteral">&quot;BlindTransfer&quot;</span>);</div><div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;   <a class="code" href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a>(&amp;managerclient_function);</div><div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160;   <a class="code" href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a>(cli_manager, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_manager));</div><div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160;</div><div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ae70b4c4ad5b431314ecf40d29d224eee">ao2_t_global_obj_release</a>(event_docs, <span class="stringliteral">&quot;Dispose of event_docs&quot;</span>);</div><div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;</div><div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a>(test_suite_forwarder);</div><div class="line"><a name="l09011"></a><span class="lineno"> 9011</span>&#160;   test_suite_forwarder = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;</div><div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;   <span class="keywordflow">if</span> (stasis_router) {</div><div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;      <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a641f77c471ff127e8586247ff6c0d64c">stasis_message_router_unsubscribe_and_join</a>(stasis_router);</div><div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160;      stasis_router = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160;   }</div><div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a>(rtp_topic_forwarder);</div><div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;   rtp_topic_forwarder = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a>(security_topic_forwarder);</div><div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;   security_topic_forwarder = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a>(manager_topic);</div><div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160;   manager_topic = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;   <a class="code" href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a>(<a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>);</div><div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;</div><div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160;   <a class="code" href="../../d4/ddf/tcptls_8h.html#a1fd4aa5038c9a488acc0f8017fe94fda">ast_tcptls_server_stop</a>(&amp;ami_desc);</div><div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;   <a class="code" href="../../d4/ddf/tcptls_8h.html#a1fd4aa5038c9a488acc0f8017fe94fda">ast_tcptls_server_stop</a>(&amp;amis_desc);</div><div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160;</div><div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a>);</div><div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a6005f11af6a60f4169876fcd075595ca">pvtfile</a>);</div><div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a6005f11af6a60f4169876fcd075595ca">pvtfile</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a>);</div><div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a9ff8d56644bac1d41f8039f2fde5acf2">cafile</a>);</div><div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a9ff8d56644bac1d41f8039f2fde5acf2">cafile</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a8331a8443119478cd6b1daeb707a94dc">capath</a>);</div><div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a8331a8443119478cd6b1daeb707a94dc">capath</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;</div><div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;   <a class="code" href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a>(mgr_sessions);</div><div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;</div><div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160;   <span class="keywordflow">while</span> ((user = <a class="code" href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>, list))) {</div><div class="line"><a name="l09043"></a><span class="lineno"> 9043</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#ad43b79b766118eebf1426a908d0e27ae">manager_free_user</a>(user);</div><div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;   }</div><div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c363bd89e1d8a7c36513fa83f3d08af">acl_change_stasis_unsubscribe</a>();</div><div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;</div><div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e">manager_channelvars</a>);</div><div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;}</div><div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;</div><div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;<span class="comment"></span></div><div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;<span class="comment">/*! \brief Initialize all \ref stasis topics and routers used by the various</span></div><div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;<span class="comment"> * sub-components of AMI</span></div><div class="line"><a name="l09053"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a09a999bc75726a4215330a1fc409468c"> 9053</a></span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a09a999bc75726a4215330a1fc409468c">manager_subscriptions_init</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;{</div><div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;   <span class="keywordtype">int</span> res = 0;</div><div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160;</div><div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160;   rtp_topic_forwarder = <a class="code" href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a>(<a class="code" href="../../df/deb/group__StasisTopicsAndMessages.html#gae7636be9781a3bd85e52ba016e8c432f">ast_rtp_topic</a>(), manager_topic);</div><div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;   <span class="keywordflow">if</span> (!rtp_topic_forwarder) {</div><div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160;   }</div><div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;</div><div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160;   security_topic_forwarder = <a class="code" href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a>(<a class="code" href="../../d0/d29/include_2asterisk_2security__events_8h.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a>(), manager_topic);</div><div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;   <span class="keywordflow">if</span> (!security_topic_forwarder) {</div><div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;   }</div><div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;</div><div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160;   stasis_router = <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a1a1761c57f73009d305f95d8ad99e2a7">stasis_message_router_create</a>(manager_topic);</div><div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160;   <span class="keywordflow">if</span> (!stasis_router) {</div><div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;   }</div><div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a1570c21a07d1309809ae61c723f28a1d">stasis_message_router_set_congestion_limits</a>(stasis_router, -1,</div><div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;      6 * <a class="code" href="../../d0/d1e/taskprocessor_8h.html#ad4a3db2b08877779bd481a649318be7d">AST_TASKPROCESSOR_HIGH_WATER_LEVEL</a>);</div><div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;</div><div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160;   <a class="code" href="../../d4/d25/stasis__message__router_8h.html#ac911cfd927625dfd7d78908aae0fec80">stasis_message_router_set_formatters_default</a>(stasis_router,</div><div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga3cf68c6aee41a7989e352a9da265890a">manager_default_msg_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d">STASIS_SUBSCRIPTION_FORMATTER_AMI</a>);</div><div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;</div><div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;   res |= <a class="code" href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a>(stasis_router,</div><div class="line"><a name="l09079"></a><span class="lineno"> 9079</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>(), <a class="code" href="../../df/d72/group__Group__AMI.html#gab9ef7d18dc9c448d132687dadcdf8a01">manager_generic_msg_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;</div><div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;   <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;   }</div><div class="line"><a name="l09084"></a><span class="lineno"> 9084</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09085"></a><span class="lineno"> 9085</span>&#160;}</div><div class="line"><a name="l09086"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ae5d6fd1b45806b39a651be34a9c51bea"> 9086</a></span>&#160;</div><div class="line"><a name="l09087"></a><span class="lineno"> 9087</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ae5d6fd1b45806b39a651be34a9c51bea">subscribe_all</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09088"></a><span class="lineno"> 9088</span>&#160;{</div><div class="line"><a name="l09089"></a><span class="lineno"> 9089</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d4/d10/manager_8c.html#a09a999bc75726a4215330a1fc409468c">manager_subscriptions_init</a>()) {</div><div class="line"><a name="l09090"></a><span class="lineno"> 9090</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to initialize manager subscriptions\n&quot;</span>);</div><div class="line"><a name="l09091"></a><span class="lineno"> 9091</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09092"></a><span class="lineno"> 9092</span>&#160;   }</div><div class="line"><a name="l09093"></a><span class="lineno"> 9093</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/d45/manager_8h.html#aa170f815ce3d25efbf1b0f3dede94ea4">manager_system_init</a>()) {</div><div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to initialize manager system handling\n&quot;</span>);</div><div class="line"><a name="l09095"></a><span class="lineno"> 9095</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160;   }</div><div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/d45/manager_8h.html#abc1db69d70499e0e8b178fccbc76b505">manager_channels_init</a>()) {</div><div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to initialize manager channel handling\n&quot;</span>);</div><div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09100"></a><span class="lineno"> 9100</span>&#160;   }</div><div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/d45/manager_8h.html#a2571c636aafd979f5719051090e5bbff">manager_mwi_init</a>()) {</div><div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to initialize manager MWI handling\n&quot;</span>);</div><div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160;   }</div><div class="line"><a name="l09105"></a><span class="lineno"> 9105</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/d45/manager_8h.html#a3f283471be8718fc0239c7441d640a5a">manager_bridging_init</a>()) {</div><div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;   }</div><div class="line"><a name="l09108"></a><span class="lineno"> 9108</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/d45/manager_8h.html#a7a060a00ce627de395914abeb0007bb3">manager_endpoints_init</a>()) {</div><div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to initialize manager endpoints handling\n&quot;</span>);</div><div class="line"><a name="l09110"></a><span class="lineno"> 9110</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;   }</div><div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160;</div><div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gab96bdf674e2ebee782bfde795f93062e">subscribed</a> = 1;</div><div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09115"></a><span class="lineno"> 9115</span>&#160;}</div><div class="line"><a name="l09116"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a8324da768fd6a93e133b2033d752a830"> 9116</a></span>&#160;</div><div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#a8324da768fd6a93e133b2033d752a830">manager_set_defaults</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;{</div><div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> = 0;</div><div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = 1;</div><div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gab362ced8cd2bc839a9a1782ae31a9166">broken_events_action</a> = 0;</div><div class="line"><a name="l09122"></a><span class="lineno"> 9122</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a> = 30;</div><div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga8f05cdf013e1e5fe03ea2615e681bf58">authlimit</a> = 50;</div><div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;   <a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a> = 0;      <span class="comment">/* Debug disabled by default */</span></div><div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;</div><div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160;   <span class="comment">/* default values */</span></div><div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;   <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa6da807cb7fb332127a4896dd423ed6d">global_realm</a>, <a class="code" href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a>(<a class="code" href="../../dd/df2/paths_8h.html#ab9f9346c7a41bdf3720f7b1ed02ec703">ast_config_AST_SYSTEM_NAME</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga9c6c0e75254e2641e579bba0068626de">DEFAULT_REALM</a>),</div><div class="line"><a name="l09128"></a><span class="lineno"> 9128</span>&#160;      <span class="keyword">sizeof</span>(<a class="code" href="../../df/d72/group__Group__AMI.html#gaa6da807cb7fb332127a4896dd423ed6d">global_realm</a>));</div><div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#ad91b5dfe4c188d15f4b2e9e2ec5d8864">ast_sockaddr_setnull</a>(&amp;ami_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>);</div><div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#ad91b5dfe4c188d15f4b2e9e2ec5d8864">ast_sockaddr_setnull</a>(&amp;amis_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>);</div><div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160;</div><div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a> = 0;</div><div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a>);</div><div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a333dffcec025fcdbee0676476f401685">certfile</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<a class="code" href="../../d4/ddf/tcptls_8h.html#a1850a109f5255895d75980912723ae7c">AST_CERTFILE</a>);</div><div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a6005f11af6a60f4169876fcd075595ca">pvtfile</a>);</div><div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a6005f11af6a60f4169876fcd075595ca">pvtfile</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a>);</div><div class="line"><a name="l09138"></a><span class="lineno"> 9138</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">cipher</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a9ff8d56644bac1d41f8039f2fde5acf2">cafile</a>);</div><div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a9ff8d56644bac1d41f8039f2fde5acf2">cafile</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;   <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a8331a8443119478cd6b1daeb707a94dc">capath</a>);</div><div class="line"><a name="l09142"></a><span class="lineno"> 9142</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a8331a8443119478cd6b1daeb707a94dc">capath</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l09143"></a><span class="lineno"> 9143</span>&#160;}</div><div class="line"><a name="l09144"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a3986a4fb4a5da67741b41cedefd34049"> 9144</a></span>&#160;</div><div class="line"><a name="l09145"></a><span class="lineno"> 9145</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a3986a4fb4a5da67741b41cedefd34049">__init_manager</a>(<span class="keywordtype">int</span> <a class="code" href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a>, <span class="keywordtype">int</span> by_external_config)</div><div class="line"><a name="l09146"></a><span class="lineno"> 9146</span>&#160;{</div><div class="line"><a name="l09147"></a><span class="lineno"> 9147</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d18/structast__config.html">ast_config</a> *ucfg = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, *cfg = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09148"></a><span class="lineno"> 9148</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d85/structval.html">val</a>;</div><div class="line"><a name="l09149"></a><span class="lineno"> 9149</span>&#160;   <span class="keywordtype">char</span> *cat = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09150"></a><span class="lineno"> 9150</span>&#160;   <span class="keywordtype">int</span> newhttptimeout = 60;</div><div class="line"><a name="l09151"></a><span class="lineno"> 9151</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../db/d8a/structast__manager__user.html">ast_manager_user</a> *<a class="code" href="../../d8/dbc/structuser.html">user</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09152"></a><span class="lineno"> 9152</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *<a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>;</div><div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dc/dac/structast__flags.html">ast_flags</a> config_flags = { (reload &amp;&amp; !by_external_config) ? <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a> : 0 };</div><div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160;   <span class="keywordtype">char</span> a1[256];</div><div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;   <span class="keywordtype">char</span> a1_hash[256];</div><div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> ami_desc_local_address_tmp;</div><div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a> amis_desc_local_address_tmp;</div><div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;   <span class="keywordtype">int</span> tls_was_enabled = 0;</div><div class="line"><a name="l09159"></a><span class="lineno"> 9159</span>&#160;   <span class="keywordtype">int</span> acl_subscription_flag = 0;</div><div class="line"><a name="l09160"></a><span class="lineno"> 9160</span>&#160;</div><div class="line"><a name="l09161"></a><span class="lineno"> 9161</span>&#160;   <span class="keywordflow">if</span> (!reload) {</div><div class="line"><a name="l09162"></a><span class="lineno"> 9162</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *<a class="code" href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a>;</div><div class="line"><a name="l09163"></a><span class="lineno"> 9163</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d2/da9/structao2__container.html">ao2_container</a> *temp_event_docs;</div><div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;      <span class="keywordtype">int</span> res;</div><div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;</div><div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;      res = <a class="code" href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a>(<a class="code" href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a>);</div><div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;      <span class="keywordflow">if</span> (res != 0) {</div><div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160;      }</div><div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;      manager_topic = <a class="code" href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a>(<span class="stringliteral">&quot;manager:core&quot;</span>);</div><div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;      <span class="keywordflow">if</span> (!manager_topic) {</div><div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;      }</div><div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160;</div><div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;      <span class="comment">/* Register default actions */</span></div><div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Ping&quot;</span>, 0, <a class="code" href="../../df/d72/group__Group__AMI.html#gaea3a1b38ba96480a2f09d7109a69b0fd">action_ping</a>);</div><div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Events&quot;</span>, 0, <a class="code" href="../../df/d72/group__Group__AMI.html#ga954eccb4f48bd6797ba65a9cada6446a">action_events</a>);</div><div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Logoff&quot;</span>, 0, <a class="code" href="../../df/d72/group__Group__AMI.html#ga70e9f0abcbf6c0aca44ad6e3f941c266">action_logoff</a>);</div><div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Login&quot;</span>, 0, <a class="code" href="../../df/d72/group__Group__AMI.html#ga446d7b8021ecd45234cd3053734c9d53">action_login</a>);</div><div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Challenge&quot;</span>, 0, <a class="code" href="../../df/d72/group__Group__AMI.html#gade12539a3e517752ad60fef428394532">action_challenge</a>);</div><div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Hangup&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga2b80579f3d94f43d2e7def7add35dc61">action_hangup</a>);</div><div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Status&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gad16a64f7db4f1fdc0326f086152ed584">action_status</a>);</div><div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Setvar&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga0063f7b7d4976f533e64e98503e535aa">action_setvar</a>);</div><div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Getvar&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga46026a8e1dfda56ac9dc23cd31515def">action_getvar</a>);</div><div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;GetConfig&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga607030674dbfc12f62148d375b4e320f">action_getconfig</a>);</div><div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;GetConfigJSON&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga22cac49ed9e48c4bed52477e6334278e">action_getconfigjson</a>);</div><div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;UpdateConfig&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga722b7d69a94cb2ececdb88bf67f80667">action_updateconfig</a>);</div><div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;CreateConfig&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga03aa8a5224eadc07dddc34751e1868d0">action_createconfig</a>);</div><div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;ListCategories&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga28572e9c3a5f7c565f68eae095454d3c">action_listcategories</a>);</div><div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Redirect&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga97662516a5cd49e552cf9d2e30987aac">action_redirect</a>);</div><div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Atxfer&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga2dfc6e6a7c0200c34dbbc6021f10c649">action_atxfer</a>);</div><div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;CancelAtxfer&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaa60da5f18e4bd066b5d6c5d334f3ef9a">action_cancel_atxfer</a>);</div><div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Originate&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ad6acb19e6de27692675f1706d390f548">EVENT_FLAG_ORIGINATE</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaa72169a44884720d85770602ffe6cdb5">action_originate</a>);</div><div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Command&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab9bbbe9b1fbde6ccff1f0a1ec0521afd">EVENT_FLAG_COMMAND</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaa9472597042ec9ccd8f5d51a61b70b74">action_command</a>);</div><div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;ExtensionState&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga5f3b2b093b498ed27078743ec10c05b7">action_extensionstate</a>);</div><div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;PresenceState&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga9800654edab91105eb77e4ae88417387">action_presencestate</a>);</div><div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;AbsoluteTimeout&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga2ec80a6f9d335e9240ce5cc6ab49221b">action_timeout</a>);</div><div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;MailboxStatus&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga41ec46957049f65f0409d8d92f21b428">action_mailboxstatus</a>);</div><div class="line"><a name="l09201"></a><span class="lineno"> 9201</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;MailboxCount&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga1e0bee965191aad897199382d0f36aba">action_mailboxcount</a>);</div><div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;ListCommands&quot;</span>, 0, <a class="code" href="../../df/d72/group__Group__AMI.html#ga2cf03665d072e22c68953f8dadc65690">action_listcommands</a>);</div><div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;SendText&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga1c6842f7ec1925c46db96beaaf8d24b1">action_sendtext</a>);</div><div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;UserEvent&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#acc12c2bc03dce67ddd1590d67ab11f4d">EVENT_FLAG_USER</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaa837605a5558f94ae96ed1b881aa75e7">action_userevent</a>);</div><div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;WaitEvent&quot;</span>, 0, <a class="code" href="../../df/d72/group__Group__AMI.html#gadf9acbde2aab503926610acb110634d6">action_waitevent</a>);</div><div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;CoreSettings&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga3d60a22662da992b5707f7b8830efc05">action_coresettings</a>);</div><div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;CoreStatus&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gad91b17071378fe3910cb119a257dab30">action_corestatus</a>);</div><div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Reload&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a> | <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga8678a44da3d5cf72e6ea38409d2898bb">action_reload</a>);</div><div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;LoggerRotate&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga06c45e1e9264f4a9081b0563e062b0a7">action_loggerrotate</a>);</div><div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;CoreShowChannels&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a> | <a class="code" href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gad7dbcf9e4437be66192f797b6b740930">action_coreshowchannels</a>);</div><div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;ModuleLoad&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c11fab0bce951155235b8e7a2013e1d">manager_moduleload</a>);</div><div class="line"><a name="l09212"></a><span class="lineno"> 9212</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;ModuleCheck&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gac730b751a77b99e3dd3eb4b1880ba933">manager_modulecheck</a>);</div><div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;AOCMessage&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ad145ac7178d92461a0be448d183a037c">EVENT_FLAG_AOC</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga8fdf554febcd2f092aca41a377e4a60b">action_aocmessage</a>);</div><div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;Filter&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga410d4aa5e53af4cdcb4ec95a0ae8563e">action_filter</a>);</div><div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;      <a class="code" href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a>(<span class="stringliteral">&quot;BlindTransfer&quot;</span>, <a class="code" href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga4b7f596668f285bb55c2ba939a20f9d2">action_blind_transfer</a>);</div><div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;</div><div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160;<span class="preprocessor">#ifdef TEST_FRAMEWORK</span></div><div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;      test_suite_forwarder = <a class="code" href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a>(<a class="code" href="../../d8/db9/test_8c.html#a16aebec5cd59d344358e6780d3b62871">ast_test_suite_topic</a>(), manager_topic);</div><div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;</div><div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160;      <a class="code" href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a>(cli_manager, <a class="code" href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a>(cli_manager));</div><div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#aad8771c7e3b2170a749946f1a8b758aa">__ast_custom_function_register</a>(&amp;managerclient_function, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;      <a class="code" href="../../db/de0/pbx_8h.html#ab1d88f370509aae87302134e6f70628a">ast_extension_state_add</a>(<a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga06909116cc55a2b89ea554e74be04ab6">manager_state_cb</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;</div><div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;      <span class="comment">/* Append placeholder event so master_eventq never runs dry */</span></div><div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gae456544c8bf8d684b871f41851f8eab1">append_event</a>(<span class="stringliteral">&quot;Event: Placeholder\r\n\r\n&quot;</span>, 0)) {</div><div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160;      }</div><div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;</div><div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;<span class="preprocessor">#ifdef AST_XML_DOCS</span></div><div class="line"><a name="l09231"></a><span class="lineno"> 9231</span>&#160;      temp_event_docs = <a class="code" href="../../d1/d99/xmldoc_8h.html#a35376d6bf7129eb2240263c8aeccdda5">ast_xmldoc_build_documentation</a>(<span class="stringliteral">&quot;managerEvent&quot;</span>);</div><div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;      <span class="keywordflow">if</span> (temp_event_docs) {</div><div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a45fc2eb2ef13e15588fc04088c3d8694">ao2_t_global_obj_replace_unref</a>(event_docs, temp_event_docs, <span class="stringliteral">&quot;Toss old event docs&quot;</span>);</div><div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a>(temp_event_docs, -1, <span class="stringliteral">&quot;Remove creation ref - container holds only ref now&quot;</span>);</div><div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160;      }</div><div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;</div><div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;      <span class="comment">/* If you have a NULL hash fn, you only need a single bucket */</span></div><div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160;      sessions = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#ga3e8f2893c887ee3b8acd8ecd151135b0">mansession_cmp_fn</a>);</div><div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;      <span class="keywordflow">if</span> (!sessions) {</div><div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160;      }</div><div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a>(mgr_sessions, sessions);</div><div class="line"><a name="l09244"></a><span class="lineno"> 9244</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(sessions, -1);</div><div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;</div><div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;      <span class="comment">/* Initialize all settings before first configuration load. */</span></div><div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#a8324da768fd6a93e133b2033d752a830">manager_set_defaults</a>();</div><div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;   }</div><div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;</div><div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160;   cfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a>(<span class="stringliteral">&quot;manager.conf&quot;</span>, <span class="stringliteral">&quot;manager&quot;</span>, config_flags);</div><div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;   <span class="keywordflow">if</span> (cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) {</div><div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!cfg || cfg == <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Unable to open AMI configuration manager.conf, or configuration is invalid.\n&quot;</span>);</div><div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;   }</div><div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160;</div><div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;   <span class="comment">/* If this wasn&#39;t performed due to a forced reload (because those can be created by ACL change events, we need to unsubscribe to ACL change events. */</span></div><div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160;   <span class="keywordflow">if</span> (!by_external_config) {</div><div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c363bd89e1d8a7c36513fa83f3d08af">acl_change_stasis_unsubscribe</a>();</div><div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160;   }</div><div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;</div><div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;   <span class="keywordflow">if</span> (reload) {</div><div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160;      <span class="comment">/* Reset all settings before reloading configuration */</span></div><div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;      tls_was_enabled = <a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a>;</div><div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#a8324da768fd6a93e133b2033d752a830">manager_set_defaults</a>();</div><div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;   }</div><div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160;</div><div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#aad98818272870e12d48fe4347aaa46d0">ast_sockaddr_parse</a>(&amp;ami_desc_local_address_tmp, <span class="stringliteral">&quot;[::]&quot;</span>, 0);</div><div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#ac83e6bdec376b74d02da8d2f8e1af888">ast_sockaddr_set_port</a>(&amp;ami_desc_local_address_tmp, <a class="code" href="../../db/d45/manager_8h.html#a9aeced7f8d9056c4ec2663f1ad10a4a4">DEFAULT_MANAGER_PORT</a>);</div><div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;</div><div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160;   <span class="keywordflow">for</span> (var = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, <span class="stringliteral">&quot;general&quot;</span>); <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>; var = var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;      val = var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>;</div><div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;</div><div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;      <span class="comment">/* read tls config options while preventing unsupported options from being set */</span></div><div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;      <span class="keywordflow">if</span> (strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tlscafile&quot;</span>)</div><div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;         &amp;&amp; strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tlscapath&quot;</span>)</div><div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;         &amp;&amp; strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tlscadir&quot;</span>)</div><div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160;         &amp;&amp; strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tlsverifyclient&quot;</span>)</div><div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;         &amp;&amp; strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tlsdontverifyserver&quot;</span>)</div><div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;         &amp;&amp; strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;tlsclientmethod&quot;</span>)</div><div class="line"><a name="l09282"></a><span class="lineno"> 9282</span>&#160;         &amp;&amp; strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;sslclientmethod&quot;</span>)</div><div class="line"><a name="l09283"></a><span class="lineno"> 9283</span>&#160;         &amp;&amp; !<a class="code" href="../../d4/ddf/tcptls_8h.html#a79d9a3beb22f1fb8551cef625e9fd8a1">ast_tls_read_conf</a>(&amp;<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>, &amp;amis_desc, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, val)) {</div><div class="line"><a name="l09284"></a><span class="lineno"> 9284</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09285"></a><span class="lineno"> 9285</span>&#160;      }</div><div class="line"><a name="l09286"></a><span class="lineno"> 9286</span>&#160;</div><div class="line"><a name="l09287"></a><span class="lineno"> 9287</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;enabled&quot;</span>)) {</div><div class="line"><a name="l09288"></a><span class="lineno"> 9288</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l09289"></a><span class="lineno"> 9289</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;webenabled&quot;</span>)) {</div><div class="line"><a name="l09290"></a><span class="lineno"> 9290</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l09291"></a><span class="lineno"> 9291</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;port&quot;</span>)) {</div><div class="line"><a name="l09292"></a><span class="lineno"> 9292</span>&#160;         <span class="keywordtype">int</span> bindport;</div><div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a7e9aea581abeaae5d3799367d95284ac">ast_parse_arg</a>(val, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fadba5c0b0122c30502fe469a55fea3c4b">PARSE_UINT32</a>|<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585">PARSE_IN_RANGE</a>, &amp;bindport, 1024, 65535)) {</div><div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid port number &#39;%s&#39;\n&quot;</span>, val);</div><div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;         }</div><div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160;         <a class="code" href="../../db/df1/netsock2_8h.html#ac83e6bdec376b74d02da8d2f8e1af888">ast_sockaddr_set_port</a>(&amp;ami_desc_local_address_tmp, bindport);</div><div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;bindaddr&quot;</span>)) {</div><div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;         <span class="comment">/* remember port if it has already been set */</span></div><div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;         <span class="keywordtype">int</span> setport = <a class="code" href="../../db/df1/netsock2_8h.html#a51e2841175bf3ad58a4e11ad9fb2453f">ast_sockaddr_port</a>(&amp;ami_desc_local_address_tmp);</div><div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160;</div><div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a7e9aea581abeaae5d3799367d95284ac">ast_parse_arg</a>(val, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa4b42c80c591c4da820aecc2bb80bde18">PARSE_ADDR</a>|<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa16f16657d9166eef98393fb8bfa5da8d">PARSE_PORT_IGNORE</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) {</div><div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid address &#39;%s&#39; specified, default &#39;%s&#39; will be used\n&quot;</span>, val,</div><div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;                  <a class="code" href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a>(&amp;ami_desc_local_address_tmp));</div><div class="line"><a name="l09304"></a><span class="lineno"> 9304</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160;            <a class="code" href="../../db/df1/netsock2_8h.html#aad98818272870e12d48fe4347aaa46d0">ast_sockaddr_parse</a>(&amp;ami_desc_local_address_tmp, val, <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa16f16657d9166eef98393fb8bfa5da8d">PARSE_PORT_IGNORE</a>);</div><div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;         }</div><div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160;</div><div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160;         <span class="keywordflow">if</span> (setport) {</div><div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;            <a class="code" href="../../db/df1/netsock2_8h.html#ac83e6bdec376b74d02da8d2f8e1af888">ast_sockaddr_set_port</a>(&amp;ami_desc_local_address_tmp, setport);</div><div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;         }</div><div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160;</div><div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;brokeneventsaction&quot;</span>)) {</div><div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gab362ced8cd2bc839a9a1782ae31a9166">broken_events_action</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;allowmultiplelogin&quot;</span>)) {</div><div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;displayconnects&quot;</span>)) {</div><div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;timestampevents&quot;</span>)) {</div><div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab">timestampevents</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;debug&quot;</span>)) {</div><div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;         <a class="code" href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(val);</div><div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;httptimeout&quot;</span>)) {</div><div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;         newhttptimeout = atoi(val);</div><div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;authtimeout&quot;</span>)) {</div><div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;         <span class="keywordtype">int</span> timeout = atoi(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160;</div><div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;         <span class="keywordflow">if</span> (timeout &lt; 1) {</div><div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid authtimeout value &#39;%s&#39;, using default value\n&quot;</span>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a> = <a class="code" href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a>;</div><div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;         }</div><div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;authlimit&quot;</span>)) {</div><div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;         <span class="keywordtype">int</span> limit = atoi(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;</div><div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;         <span class="keywordflow">if</span> (limit &lt; 1) {</div><div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160;            <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid authlimit value &#39;%s&#39;, using default value\n&quot;</span>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga8f05cdf013e1e5fe03ea2615e681bf58">authlimit</a> = limit;</div><div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160;         }</div><div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;channelvars&quot;</span>)) {</div><div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160;         <a class="code" href="../../d4/d10/manager_8c.html#a62beba58710ea6a53c85928d36f59477">load_channelvars</a>(var);</div><div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Invalid keyword &lt;%s&gt; = &lt;%s&gt; in manager.conf [general]\n&quot;</span>,</div><div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;            var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, val);</div><div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;      }</div><div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160;   }</div><div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;</div><div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a> &amp;&amp; !<a class="code" href="../../df/d72/group__Group__AMI.html#gab96bdf674e2ebee782bfde795f93062e">subscribed</a>) {</div><div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d4/d10/manager_8c.html#ae5d6fd1b45806b39a651be34a9c51bea">subscribe_all</a>() != 0) {</div><div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160;         <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Manager subscription error\n&quot;</span>);</div><div class="line"><a name="l09351"></a><span class="lineno"> 9351</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160;      }</div><div class="line"><a name="l09353"></a><span class="lineno"> 9353</span>&#160;   }</div><div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;</div><div class="line"><a name="l09355"></a><span class="lineno"> 9355</span>&#160;   <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;amis_desc_local_address_tmp, &amp;amis_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>);</div><div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;</div><div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;   <span class="comment">/* if the amis address has not been set, default is the same as non secure ami */</span></div><div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/df1/netsock2_8h.html#aae671446fa65b8f846efaf165872c683">ast_sockaddr_isnull</a>(&amp;amis_desc_local_address_tmp)) {</div><div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;amis_desc_local_address_tmp, &amp;ami_desc_local_address_tmp);</div><div class="line"><a name="l09360"></a><span class="lineno"> 9360</span>&#160;   }</div><div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160;</div><div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160;   <span class="comment">/* if the amis address was not set, it will have non-secure ami port set; if</span></div><div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;<span class="comment">      amis address was set, we need to check that a port was set or not, if not</span></div><div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160;<span class="comment">      use the default tls port */</span></div><div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../db/df1/netsock2_8h.html#a51e2841175bf3ad58a4e11ad9fb2453f">ast_sockaddr_port</a>(&amp;amis_desc_local_address_tmp) == 0 ||</div><div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;         (<a class="code" href="../../db/df1/netsock2_8h.html#a51e2841175bf3ad58a4e11ad9fb2453f">ast_sockaddr_port</a>(&amp;ami_desc_local_address_tmp) == <a class="code" href="../../db/df1/netsock2_8h.html#a51e2841175bf3ad58a4e11ad9fb2453f">ast_sockaddr_port</a>(&amp;amis_desc_local_address_tmp))) {</div><div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;</div><div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#ac83e6bdec376b74d02da8d2f8e1af888">ast_sockaddr_set_port</a>(&amp;amis_desc_local_address_tmp, <a class="code" href="../../db/d45/manager_8h.html#ab444a62cb9f15528aa8b4e864dfc99b2">DEFAULT_MANAGER_TLS_PORT</a>);</div><div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160;   }</div><div class="line"><a name="l09370"></a><span class="lineno"> 9370</span>&#160;</div><div class="line"><a name="l09371"></a><span class="lineno"> 9371</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a>) {</div><div class="line"><a name="l09372"></a><span class="lineno"> 9372</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;ami_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>, &amp;ami_desc_local_address_tmp);</div><div class="line"><a name="l09373"></a><span class="lineno"> 9373</span>&#160;      <a class="code" href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a>(&amp;amis_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">local_address</a>, &amp;amis_desc_local_address_tmp);</div><div class="line"><a name="l09374"></a><span class="lineno"> 9374</span>&#160;   }</div><div class="line"><a name="l09375"></a><span class="lineno"> 9375</span>&#160;</div><div class="line"><a name="l09376"></a><span class="lineno"> 9376</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160;</div><div class="line"><a name="l09378"></a><span class="lineno"> 9378</span>&#160;   <span class="comment">/* First, get users from users.conf */</span></div><div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;   ucfg = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a>(<span class="stringliteral">&quot;users.conf&quot;</span>, <span class="stringliteral">&quot;manager&quot;</span>, config_flags);</div><div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;   <span class="keywordflow">if</span> (ucfg &amp;&amp; (ucfg != <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a>) &amp;&amp; ucfg != <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a>) {</div><div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *hasmanager;</div><div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;      <span class="keywordtype">int</span> genhasmanager = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(<a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;hasmanager&quot;</span>));</div><div class="line"><a name="l09383"></a><span class="lineno"> 9383</span>&#160;</div><div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160;      <span class="keywordflow">while</span> ((cat = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(ucfg, cat))) {</div><div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">&quot;general&quot;</span>)) {</div><div class="line"><a name="l09386"></a><span class="lineno"> 9386</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09387"></a><span class="lineno"> 9387</span>&#160;         }</div><div class="line"><a name="l09388"></a><span class="lineno"> 9388</span>&#160;</div><div class="line"><a name="l09389"></a><span class="lineno"> 9389</span>&#160;         hasmanager = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;hasmanager&quot;</span>);</div><div class="line"><a name="l09390"></a><span class="lineno"> 9390</span>&#160;         <span class="keywordflow">if</span> ((!hasmanager &amp;&amp; genhasmanager) || <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(hasmanager)) {</div><div class="line"><a name="l09391"></a><span class="lineno"> 9391</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *user_secret = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;secret&quot;</span>);</div><div class="line"><a name="l09392"></a><span class="lineno"> 9392</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *user_read = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;read&quot;</span>);</div><div class="line"><a name="l09393"></a><span class="lineno"> 9393</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *user_write = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;write&quot;</span>);</div><div class="line"><a name="l09394"></a><span class="lineno"> 9394</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *user_displayconnects = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;displayconnects&quot;</span>);</div><div class="line"><a name="l09395"></a><span class="lineno"> 9395</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *user_allowmultiplelogin = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;allowmultiplelogin&quot;</span>);</div><div class="line"><a name="l09396"></a><span class="lineno"> 9396</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *user_writetimeout = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, cat, <span class="stringliteral">&quot;writetimeout&quot;</span>);</div><div class="line"><a name="l09397"></a><span class="lineno"> 9397</span>&#160;</div><div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;            <span class="comment">/* Look for an existing entry,</span></div><div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;<span class="comment">             * if none found - create one and add it to the list</span></div><div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160;            <span class="keywordflow">if</span> (!(user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(cat))) {</div><div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;               <span class="keywordflow">if</span> (!(user = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*user)))) {</div><div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160;               }</div><div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;</div><div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160;               <span class="comment">/* Copy name over */</span></div><div class="line"><a name="l09407"></a><span class="lineno"> 9407</span>&#160;               <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, cat, <span class="keyword">sizeof</span>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>));</div><div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;               <span class="comment">/* Insert into list */</span></div><div class="line"><a name="l09409"></a><span class="lineno"> 9409</span>&#160;               <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>, user, list);</div><div class="line"><a name="l09410"></a><span class="lineno"> 9410</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09411"></a><span class="lineno"> 9411</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a> = 1;</div><div class="line"><a name="l09412"></a><span class="lineno"> 9412</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = -1;</div><div class="line"><a name="l09413"></a><span class="lineno"> 9413</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = -1;</div><div class="line"><a name="l09414"></a><span class="lineno"> 9414</span>&#160;               <span class="comment">/* Default displayconnect from [general] */</span></div><div class="line"><a name="l09415"></a><span class="lineno"> 9415</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>;</div><div class="line"><a name="l09416"></a><span class="lineno"> 9416</span>&#160;               <span class="comment">/* Default allowmultiplelogin from [general] */</span></div><div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a>;</div><div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = 100;</div><div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;            }</div><div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;</div><div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160;            <span class="keywordflow">if</span> (!user_secret) {</div><div class="line"><a name="l09422"></a><span class="lineno"> 9422</span>&#160;               user_secret = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;secret&quot;</span>);</div><div class="line"><a name="l09423"></a><span class="lineno"> 9423</span>&#160;            }</div><div class="line"><a name="l09424"></a><span class="lineno"> 9424</span>&#160;            <span class="keywordflow">if</span> (!user_read) {</div><div class="line"><a name="l09425"></a><span class="lineno"> 9425</span>&#160;               user_read = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;read&quot;</span>);</div><div class="line"><a name="l09426"></a><span class="lineno"> 9426</span>&#160;            }</div><div class="line"><a name="l09427"></a><span class="lineno"> 9427</span>&#160;            <span class="keywordflow">if</span> (!user_write) {</div><div class="line"><a name="l09428"></a><span class="lineno"> 9428</span>&#160;               user_write = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;write&quot;</span>);</div><div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;            }</div><div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160;            <span class="keywordflow">if</span> (!user_displayconnects) {</div><div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;               user_displayconnects = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;displayconnects&quot;</span>);</div><div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;            }</div><div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160;            <span class="keywordflow">if</span> (!user_allowmultiplelogin) {</div><div class="line"><a name="l09434"></a><span class="lineno"> 9434</span>&#160;               user_allowmultiplelogin = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;allowmultiplelogin&quot;</span>);</div><div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160;            }</div><div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;            <span class="keywordflow">if</span> (!user_writetimeout) {</div><div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;               user_writetimeout = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a>(ucfg, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;writetimeout&quot;</span>);</div><div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160;            }</div><div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160;</div><div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a>(user_secret)) {</div><div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;               <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>);</div><div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(user_secret);</div><div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;            }</div><div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160;</div><div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;            <span class="keywordflow">if</span> (user_read) {</div><div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(user_read);</div><div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;            }</div><div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160;            <span class="keywordflow">if</span> (user_write) {</div><div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(user_write);</div><div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;            }</div><div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;            <span class="keywordflow">if</span> (user_displayconnects) {</div><div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(user_displayconnects);</div><div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160;            }</div><div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;            <span class="keywordflow">if</span> (user_allowmultiplelogin) {</div><div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(user_allowmultiplelogin);</div><div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160;            }</div><div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;            <span class="keywordflow">if</span> (user_writetimeout) {</div><div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;               <span class="keywordtype">int</span> <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> = atoi(user_writetimeout);</div><div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160;               <span class="keywordflow">if</span> (value &lt; 100) {</div><div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;                  <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid writetimeout value &#39;%d&#39; in users.conf\n&quot;</span>, value);</div><div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160;               } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;                  user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;               }</div><div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160;            }</div><div class="line"><a name="l09465"></a><span class="lineno"> 9465</span>&#160;         }</div><div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;      }</div><div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(ucfg);</div><div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160;   }</div><div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;</div><div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160;   <span class="comment">/* cat is NULL here in any case */</span></div><div class="line"><a name="l09471"></a><span class="lineno"> 9471</span>&#160;</div><div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160;   <span class="keywordflow">while</span> ((cat = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a>(cfg, cat))) {</div><div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;      <span class="keyword">struct </span><a class="code" href="../../d3/da4/structast__acl__list.html">ast_acl_list</a> *oldacl;</div><div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;</div><div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;      <span class="keywordflow">if</span> (!strcasecmp(cat, <span class="stringliteral">&quot;general&quot;</span>)) {</div><div class="line"><a name="l09476"></a><span class="lineno"> 9476</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160;      }</div><div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;</div><div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160;      <span class="comment">/* Look for an existing entry, if none found - create one and add it to the list */</span></div><div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;      <span class="keywordflow">if</span> (!(user = <a class="code" href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a>(cat))) {</div><div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160;         <span class="keywordflow">if</span> (!(user = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, <span class="keyword">sizeof</span>(*user)))) {</div><div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160;         }</div><div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;         <span class="comment">/* Copy name over */</span></div><div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;         <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, cat, <span class="keyword">sizeof</span>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>));</div><div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;</div><div class="line"><a name="l09487"></a><span class="lineno"> 9487</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09488"></a><span class="lineno"> 9488</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = 0;</div><div class="line"><a name="l09489"></a><span class="lineno"> 9489</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = 0;</div><div class="line"><a name="l09490"></a><span class="lineno"> 9490</span>&#160;         <span class="comment">/* Default displayconnect from [general] */</span></div><div class="line"><a name="l09491"></a><span class="lineno"> 9491</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a>;</div><div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160;         <span class="comment">/* Default allowmultiplelogin from [general] */</span></div><div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a>;</div><div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = 100;</div><div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a> = <a class="code" href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a>(<a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a>, 0, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;         <span class="keywordflow">if</span> (!user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a> || !user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>) {</div><div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;            <a class="code" href="../../d4/d10/manager_8c.html#ad43b79b766118eebf1426a908d0e27ae">manager_free_user</a>(user);</div><div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160;         }</div><div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;</div><div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160;         <span class="comment">/* Insert into list */</span></div><div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;         <a class="code" href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>, user, list);</div><div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aeca960ec22a1d0384f6e285b25df8501">ao2_t_callback</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;unlink all white filters&quot;</span>);</div><div class="line"><a name="l09506"></a><span class="lineno"> 9506</span>&#160;         <a class="code" href="../../d5/da5/astobj2_8h.html#aeca960ec22a1d0384f6e285b25df8501">ao2_t_callback</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a> | <a class="code" href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;unlink all black filters&quot;</span>);</div><div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;      }</div><div class="line"><a name="l09508"></a><span class="lineno"> 9508</span>&#160;</div><div class="line"><a name="l09509"></a><span class="lineno"> 9509</span>&#160;      <span class="comment">/* Make sure we keep this user and don&#39;t destroy it during cleanup */</span></div><div class="line"><a name="l09510"></a><span class="lineno"> 9510</span>&#160;      user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a> = 1;</div><div class="line"><a name="l09511"></a><span class="lineno"> 9511</span>&#160;      oldacl = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>;</div><div class="line"><a name="l09512"></a><span class="lineno"> 9512</span>&#160;      user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a> = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09513"></a><span class="lineno"> 9513</span>&#160;      <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>);</div><div class="line"><a name="l09514"></a><span class="lineno"> 9514</span>&#160;</div><div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160;      var = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a>(cfg, cat);</div><div class="line"><a name="l09516"></a><span class="lineno"> 9516</span>&#160;      <span class="keywordflow">for</span> (; <a class="code" href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a>; var = var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a>) {</div><div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;         <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;secret&quot;</span>)) {</div><div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;            <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>);</div><div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160;            user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;deny&quot;</span>) ||</div><div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;                   !strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;permit&quot;</span>) ||</div><div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160;                   !strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;acl&quot;</span>)) {</div><div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;            <span class="keywordtype">int</span> acl_error = 0;</div><div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;</div><div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;            <a class="code" href="../../d5/d59/acl_8h.html#a6b6715d0c234599571cf5e1adddfec33">ast_append_acl</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, &amp;user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">acl</a>, &amp;acl_error, &amp;acl_subscription_flag);</div><div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160;            <span class="keywordflow">if</span> (acl_error) {</div><div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Invalid ACL &#39;%s&#39; for manager user &#39;%s&#39; on line %d. Deleting user\n&quot;</span>,</div><div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160;                  var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a> = 0;</div><div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;            }</div><div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160;         }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;read&quot;</span>) ) {</div><div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;            user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">readperm</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160;         }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;write&quot;</span>) ) {</div><div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;            user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">writeperm</a> = <a class="code" href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;         }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;displayconnects&quot;</span>) ) {</div><div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160;            user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">displayconnects</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;         }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;allowmultiplelogin&quot;</span>) ) {</div><div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160;            user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a> = <a class="code" href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a>(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;writetimeout&quot;</span>)) {</div><div class="line"><a name="l09540"></a><span class="lineno"> 9540</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> = atoi(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>);</div><div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;            <span class="keywordflow">if</span> (value &lt; 100) {</div><div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160;               <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a>, <span class="stringliteral">&quot;Invalid writetimeout value &#39;%s&#39; at line %d\n&quot;</span>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">lineno</a>);</div><div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;               user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">writetimeout</a> = <a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>;</div><div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160;            }</div><div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;setvar&quot;</span>)) {</div><div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160;            <span class="keyword">struct </span><a class="code" href="../../dd/d02/structast__variable.html">ast_variable</a> *tmpvar;</div><div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;            <span class="keywordtype">char</span> varbuf[256];</div><div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;            <span class="keywordtype">char</span> *varval;</div><div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160;            <span class="keywordtype">char</span> *varname;</div><div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160;</div><div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;            <a class="code" href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a>(varbuf, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>, <span class="keyword">sizeof</span>(varbuf));</div><div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;            varname = varbuf;</div><div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;</div><div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;            <span class="keywordflow">if</span> ((varval = strchr(varname,<span class="charliteral">&#39;=&#39;</span>))) {</div><div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;               *varval++ = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160;               <span class="keywordflow">if</span> ((tmpvar = <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a>(varname, varval, <span class="stringliteral">&quot;&quot;</span>))) {</div><div class="line"><a name="l09558"></a><span class="lineno"> 9558</span>&#160;                  tmpvar-&gt;<a class="code" href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">next</a> = user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a>;</div><div class="line"><a name="l09559"></a><span class="lineno"> 9559</span>&#160;                  user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">chanvars</a> = tmpvar;</div><div class="line"><a name="l09560"></a><span class="lineno"> 9560</span>&#160;               }</div><div class="line"><a name="l09561"></a><span class="lineno"> 9561</span>&#160;            }</div><div class="line"><a name="l09562"></a><span class="lineno"> 9562</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>, <span class="stringliteral">&quot;eventfilter&quot;</span>)) {</div><div class="line"><a name="l09563"></a><span class="lineno"> 9563</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a> = var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">value</a>;</div><div class="line"><a name="l09564"></a><span class="lineno"> 9564</span>&#160;            <a class="code" href="../../df/d72/group__Group__AMI.html#ga2fce7bc082ac5dfa4ea3545b9f34cb66">manager_add_filter</a>(value, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">whitefilters</a>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">blackfilters</a>);</div><div class="line"><a name="l09565"></a><span class="lineno"> 9565</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160;            <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(1, <span class="stringliteral">&quot;%s is an unknown option.\n&quot;</span>, var-&gt;<a class="code" href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;         }</div><div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;      }</div><div class="line"><a name="l09569"></a><span class="lineno"> 9569</span>&#160;</div><div class="line"><a name="l09570"></a><span class="lineno"> 9570</span>&#160;      oldacl = <a class="code" href="../../d5/d59/acl_8h.html#a7fc796b79184fa0f4340037e5c1445c6">ast_free_acl_list</a>(oldacl);</div><div class="line"><a name="l09571"></a><span class="lineno"> 9571</span>&#160;   }</div><div class="line"><a name="l09572"></a><span class="lineno"> 9572</span>&#160;   <a class="code" href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a>(cfg);</div><div class="line"><a name="l09573"></a><span class="lineno"> 9573</span>&#160;</div><div class="line"><a name="l09574"></a><span class="lineno"> 9574</span>&#160;   <span class="comment">/* Check the flag for named ACL event subscription and if we need to, register a subscription. */</span></div><div class="line"><a name="l09575"></a><span class="lineno"> 9575</span>&#160;   <span class="keywordflow">if</span> (acl_subscription_flag &amp;&amp; !by_external_config) {</div><div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#ga12e82c44fa806bdf33e7e4d92c04f707">acl_change_stasis_subscribe</a>();</div><div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;   }</div><div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160;</div><div class="line"><a name="l09579"></a><span class="lineno"> 9579</span>&#160;   <span class="comment">/* Perform cleanup - essentially prune out old users that no longer exist */</span></div><div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>, user, list) {</div><div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160;      <span class="keywordflow">if</span> (user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a>) { <span class="comment">/* valid record. clear flag for the next round */</span></div><div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">keep</a> = 0;</div><div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;</div><div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160;         <span class="comment">/* Calculate A1 for Digest auth */</span></div><div class="line"><a name="l09585"></a><span class="lineno"> 9585</span>&#160;         snprintf(a1, <span class="keyword">sizeof</span>(a1), <span class="stringliteral">&quot;%s:%s:%s&quot;</span>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>, <a class="code" href="../../df/d72/group__Group__AMI.html#gaa6da807cb7fb332127a4896dd423ed6d">global_realm</a>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">secret</a>);</div><div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;         <a class="code" href="../../d5/d60/utils_8h.html#aee8200caadc6a4b5afe01ea37fd26cb3">ast_md5_hash</a>(a1_hash,a1);</div><div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160;         <a class="code" href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a>(user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a">a1_hash</a>);</div><div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;         user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a">a1_hash</a> = <a class="code" href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a>(a1_hash);</div><div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160;      }</div><div class="line"><a name="l09591"></a><span class="lineno"> 9591</span>&#160;      <span class="comment">/* We do not need to keep this user so take them out of the list */</span></div><div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a>(list);</div><div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160;      <a class="code" href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a>(4, <span class="stringliteral">&quot;Pruning user &#39;%s&#39;\n&quot;</span>, user-&gt;<a class="code" href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">username</a>);</div><div class="line"><a name="l09594"></a><span class="lineno"> 9594</span>&#160;      <a class="code" href="../../d4/d10/manager_8c.html#ad43b79b766118eebf1426a908d0e27ae">manager_free_user</a>(user);</div><div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160;   }</div><div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l09597"></a><span class="lineno"> 9597</span>&#160;</div><div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a>(&amp;<a class="code" href="../../d8/d63/structusers.html">users</a>);</div><div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;</div><div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/d72/group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a> &amp;&amp; <a class="code" href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a>) {</div><div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;      <span class="keywordflow">if</span> (!webregged) {</div><div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;rawmanuri);</div><div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;manageruri);</div><div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;managerxmluri);</div><div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160;</div><div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;arawmanuri);</div><div class="line"><a name="l09607"></a><span class="lineno"> 9607</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;amanageruri);</div><div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a>(&amp;amanagerxmluri);</div><div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;         webregged = 1;</div><div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;      }</div><div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l09612"></a><span class="lineno"> 9612</span>&#160;      <span class="keywordflow">if</span> (webregged) {</div><div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;rawmanuri);</div><div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;manageruri);</div><div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;managerxmluri);</div><div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;</div><div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;arawmanuri);</div><div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;amanageruri);</div><div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160;         <a class="code" href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a>(&amp;amanagerxmluri);</div><div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160;         webregged = 0;</div><div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;      }</div><div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;   }</div><div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;</div><div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160;   <span class="keywordflow">if</span> (newhttptimeout &gt; 0) {</div><div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;      <a class="code" href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a> = newhttptimeout;</div><div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160;   }</div><div class="line"><a name="l09627"></a><span class="lineno"> 9627</span>&#160;</div><div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;   <a class="code" href="../../d4/ddf/tcptls_8h.html#a29375a4482c8de1e9879b97be2e88bf0">ast_tcptls_server_start</a>(&amp;ami_desc);</div><div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;   <span class="keywordflow">if</span> (tls_was_enabled &amp;&amp; !<a class="code" href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a>.<a class="code" href="../../d5/d90/structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">enabled</a>) {</div><div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160;      <a class="code" href="../../d4/ddf/tcptls_8h.html#a1fd4aa5038c9a488acc0f8017fe94fda">ast_tcptls_server_stop</a>(&amp;amis_desc);</div><div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/ddf/tcptls_8h.html#a24ff4bad1d2894ae3cae4e555d508fd0">ast_ssl_setup</a>(amis_desc.<a class="code" href="../../da/d2b/structast__tcptls__session__args.html#aeb4a21e3ae033a326cc9dfd20a7ab074">tls_cfg</a>)) {</div><div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;      <a class="code" href="../../d4/ddf/tcptls_8h.html#a29375a4482c8de1e9879b97be2e88bf0">ast_tcptls_server_start</a>(&amp;amis_desc);</div><div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160;   }</div><div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;</div><div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;}</div><div class="line"><a name="l09637"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#gaf4adfeec3f6af24e2ede7e730bee32eb"> 9637</a></span>&#160;</div><div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../df/d72/group__Group__AMI.html#gaf4adfeec3f6af24e2ede7e730bee32eb">acl_change_stasis_cb</a>(<span class="keywordtype">void</span> *data, <span class="keyword">struct</span> <a class="code" href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a> *sub,</div><div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160;   <span class="keyword">struct</span> <a class="code" href="../../d7/d55/structstasis__message.html">stasis_message</a> *message)</div><div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;{</div><div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a>(message) != <a class="code" href="../../d5/d59/acl_8h.html#a1d3de55deab4206400a7df534511fcf7">ast_named_acl_change_type</a>()) {</div><div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;   }</div><div class="line"><a name="l09644"></a><span class="lineno"> 9644</span>&#160;</div><div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160;   <span class="comment">/* For now, this is going to be performed simply and just execute a forced reload. */</span></div><div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;   <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a>, <span class="stringliteral">&quot;Reloading manager in response to ACL change event.\n&quot;</span>);</div><div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;   <a class="code" href="../../d4/d10/manager_8c.html#a3986a4fb4a5da67741b41cedefd34049">__init_manager</a>(1, 1);</div><div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;}</div><div class="line"><a name="l09649"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ad09fa931f468002152a3cc2d5ce25eae"> 9649</a></span>&#160;</div><div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;{</div><div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;}</div><div class="line"><a name="l09654"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9"> 9654</a></span>&#160;</div><div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160;{</div><div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;   <a class="code" href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a>(<a class="code" href="../../d4/d10/manager_8c.html#a999f980f0d4926c5688bc346f14301e8">manager_shutdown</a>);</div><div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;</div><div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d10/manager_8c.html#a3986a4fb4a5da67741b41cedefd34049">__init_manager</a>(0, 0) ? <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a> : <a class="code" href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a>;</div><div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;}</div><div class="line"><a name="l09661"></a><span class="lineno"><a class="line" href="../../df/d72/group__Group__AMI.html#ga7c6ac25ea7536c0bc9ed18cbcf917527"> 9661</a></span>&#160;</div><div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="../../df/d72/group__Group__AMI.html#ga7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;{</div><div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../d4/d10/manager_8c.html#a3986a4fb4a5da67741b41cedefd34049">__init_manager</a>(1, 0);</div><div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160;}</div><div class="line"><a name="l09666"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a56275a7a3b863c8b4a49d2e74ebe739c"> 9666</a></span>&#160;</div><div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a56275a7a3b863c8b4a49d2e74ebe739c">astman_datastore_add</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore)</div><div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160;{</div><div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>, datastore, <a class="code" href="../../d3/d96/structentry.html">entry</a>);</div><div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;</div><div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;}</div><div class="line"><a name="l09673"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#af9f2dfb1df89986ee6613d2bfa541688"> 9673</a></span>&#160;</div><div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#af9f2dfb1df89986ee6613d2bfa541688">astman_datastore_remove</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">struct</span> <a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore)</div><div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160;{</div><div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="../../df/d90/linkedlists_8h.html#aa36e72b77f1b80881cd0a9fcca66ce19">AST_LIST_REMOVE</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>, datastore, <a class="code" href="../../d3/d96/structentry.html">entry</a>) ? 0 : -1;</div><div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160;}</div><div class="line"><a name="l09678"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a1a24728a1340746b7d1e914f0bc6bc78"> 9678</a></span>&#160;</div><div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;<span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *<a class="code" href="../../d4/d10/manager_8c.html#a1a24728a1340746b7d1e914f0bc6bc78">astman_datastore_find</a>(<span class="keyword">struct</span> <a class="code" href="../../d2/d8a/structmansession.html">mansession</a> *s, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a> *<a class="code" href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">info</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>)</div><div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;{</div><div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d4/d5d/structast__datastore.html">ast_datastore</a> *datastore = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;</div><div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;   <span class="keywordflow">if</span> (info == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;</div><div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;s-&gt;<a class="code" href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">session</a>-&gt;<a class="code" href="../../df/d05/structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">datastores</a>, datastore, <a class="code" href="../../d3/d96/structentry.html">entry</a>) {</div><div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;      <span class="keywordflow">if</span> (datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">info</a> != info) {</div><div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160;         <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;      }</div><div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;</div><div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160;      <span class="keywordflow">if</span> (uid == <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div><div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;         <span class="comment">/* matched by type only */</span></div><div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;      }</div><div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;</div><div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160;      <span class="keywordflow">if</span> ((datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a> != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; !strcasecmp(uid, datastore-&gt;<a class="code" href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">uid</a>)) {</div><div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;         <span class="comment">/* Matched by type AND uid */</span></div><div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;      }</div><div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;   }</div><div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160;</div><div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;   <span class="keywordflow">return</span> datastore;</div><div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;}</div><div class="line"><a name="l09705"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a4e23b878e759dadd1e466a63193abba0"> 9705</a></span>&#160;</div><div class="line"><a name="l09706"></a><span class="lineno"> 9706</span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d4/d10/manager_8c.html#a4e23b878e759dadd1e466a63193abba0">ast_str_append_event_header</a>(<span class="keyword">struct</span> <a class="code" href="../../dd/da2/structast__str.html">ast_str</a> **fields_string,</div><div class="line"><a name="l09707"></a><span class="lineno"> 9707</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d5/d65/structheader.html">header</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a>)</div><div class="line"><a name="l09708"></a><span class="lineno"> 9708</span>&#160;{</div><div class="line"><a name="l09709"></a><span class="lineno"> 9709</span>&#160;   <span class="keywordflow">if</span> (!*fields_string) {</div><div class="line"><a name="l09710"></a><span class="lineno"> 9710</span>&#160;      *fields_string = <a class="code" href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a>(128);</div><div class="line"><a name="l09711"></a><span class="lineno"> 9711</span>&#160;      <span class="keywordflow">if</span> (!*fields_string) {</div><div class="line"><a name="l09712"></a><span class="lineno"> 9712</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09713"></a><span class="lineno"> 9713</span>&#160;      }</div><div class="line"><a name="l09714"></a><span class="lineno"> 9714</span>&#160;   }</div><div class="line"><a name="l09715"></a><span class="lineno"> 9715</span>&#160;</div><div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160;   <span class="keywordflow">return</span> (<a class="code" href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a>(fields_string, 0, <span class="stringliteral">&quot;%s: %s\r\n&quot;</span>, header, value) &lt; 0) ? -1 : 0;</div><div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;}</div><div class="line"><a name="l09718"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a621c10d8f8ac1fb6695eb47e3a5c9504"> 9718</a></span>&#160;</div><div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../d4/d10/manager_8c.html#a621c10d8f8ac1fb6695eb47e3a5c9504">manager_event_blob_dtor</a>(<span class="keywordtype">void</span> *obj)</div><div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;{</div><div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *ev = obj;</div><div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160;</div><div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a>(ev);</div><div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;}</div><div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160;</div><div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;<span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *</div><div class="line"><a name="l09727"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd"> 9727</a></span>&#160;__attribute__((<a class="code" href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a>(printf, 3, 4)))</div><div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;<a class="code" href="../../d4/d10/manager_8c.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a>(</div><div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="../../dd/d96/structast__manager__event__blob.html#a57602302e7b352ebd03ca187acfcffd4">event_flags</a>,</div><div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;   const <span class="keywordtype">char</span> *<a class="code" href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a>,</div><div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;   const <span class="keywordtype">char</span> *extra_fields_fmt,</div><div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;   ...)</div><div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160;{</div><div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a> *ev;</div><div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;   va_list argp;</div><div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;</div><div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(extra_fields_fmt != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(manager_event != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;</div><div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;   ev = <a class="code" href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a>(<span class="keyword">sizeof</span>(*ev), <a class="code" href="../../d4/d10/manager_8c.html#a621c10d8f8ac1fb6695eb47e3a5c9504">manager_event_blob_dtor</a>, <a class="code" href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a>);</div><div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160;   <span class="keywordflow">if</span> (!ev) {</div><div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160;   }</div><div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;</div><div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a>(ev, 20)) {</div><div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160;      <a class="code" href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a>(ev, -1);</div><div class="line"><a name="l09747"></a><span class="lineno"> 9747</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160;   }</div><div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;</div><div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;   ev-&gt;<a class="code" href="../../dd/d96/structast__manager__event__blob.html#aab469824ac975744e02d0eefe868f82f">manager_event</a> = <a class="code" href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a>;</div><div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160;   ev-&gt;<a class="code" href="../../dd/d96/structast__manager__event__blob.html#a57602302e7b352ebd03ca187acfcffd4">event_flags</a> = <a class="code" href="../../dd/d96/structast__manager__event__blob.html#a57602302e7b352ebd03ca187acfcffd4">event_flags</a>;</div><div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;</div><div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160;   va_start(argp, extra_fields_fmt);</div><div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;   <a class="code" href="../../d1/d0f/stringfields_8h.html#a45a8f974ba52ca692e4e0547266d3a9f">ast_string_field_ptr_build_va</a>(ev, &amp;ev-&gt;<a class="code" href="../../dd/d96/structast__manager__event__blob.html#a32dae0134e7c44c45bb610ab1a152521">extra_fields</a>, extra_fields_fmt, argp);</div><div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;   va_end(argp);</div><div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160;</div><div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;   <span class="keywordflow">return</span> ev;</div><div class="line"><a name="l09758"></a><span class="lineno"> 9758</span>&#160;}</div><div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160;</div><div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160;<a class="code" href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a>(<a class="code" href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a>, <a class="code" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a> | <a class="code" href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a>, <span class="stringliteral">&quot;Asterisk Manager Interface&quot;</span>,</div><div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;   .support_level = <a class="code" href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a>,</div><div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;   .load = <a class="code" href="../../d4/d10/manager_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a>,</div><div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160;   .unload = <a class="code" href="../../d4/d10/manager_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a>,</div><div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;   .<a class="code" href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a> = reload_module,</div><div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160;   .load_pri = <a class="code" href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a37c0718af4fc7bf8c860beb730161044">AST_MODPRI_CORE</a>,</div><div class="line"><a name="l09766"></a><span class="lineno"><a class="line" href="../../d4/d10/manager_8c.html#a4fb0aca9bbcdb9709fa52a70aded6cae"> 9766</a></span>&#160;   .requires = <span class="stringliteral">&quot;extconfig,acl,http&quot;</span>,</div><div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;);</div><div class="ttc" id="iostream_8h_html_a7da9c8f9652decad87fdb8d39c4f06df"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#a7da9c8f9652decad87fdb8d39c4f06df">ast_iostream_set_exclusive_input</a></div><div class="ttdeci">void ast_iostream_set_exclusive_input(struct ast_iostream *stream, int exclusive_input)</div><div class="ttdoc">Set the iostream if it can exclusively depend upon the set timeouts. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00148">iostream.c:148</a></div></div>
<div class="ttc" id="netsock2_8h_html_a6bf0e68e74c0a9ca9d25251b22e4d64a"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#a6bf0e68e74c0a9ca9d25251b22e4d64a">ast_sockaddr_stringify_addr</a></div><div class="ttdeci">static char * ast_sockaddr_stringify_addr(const struct ast_sockaddr *addr)</div><div class="ttdoc">Wrapper around ast_sockaddr_stringify_fmt() to return an address only. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00290">netsock2.h:290</a></div></div>
<div class="ttc" id="res__config__ldap_8c_html_a930c15eddfe0826ff30e658c9d50b9b4"><div class="ttname"><a href="../../dc/d12/res__config__ldap_8c.html#a930c15eddfe0826ff30e658c9d50b9b4">user</a></div><div class="ttdeci">static char user[512]</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d12/res__config__ldap_8c_source.html#l00075">res_config_ldap.c:75</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aa5e72d9401477c9775d054babae77e89"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aa5e72d9401477c9775d054babae77e89">ast_category_is_template</a></div><div class="ttdeci">int ast_category_is_template(const struct ast_category *category)</div><div class="ttdoc">Check if category is a template. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01033">main/config.c:1033</a></div></div>
<div class="ttc" id="astobj2_8h_html_a14c61bcab109a520a96d30c56ba5fcde"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a14c61bcab109a520a96d30c56ba5fcde">ao2_t_ref</a></div><div class="ttdeci">#define ao2_t_ref(o, delta, tag)</div><div class="ttdoc">Reference/unreference an object and return the old refcount. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00463">astobj2.h:463</a></div></div>
<div class="ttc" id="manager_8c_html_ac3382bf6da54c56b37069bd76bbdf4f9"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ac3382bf6da54c56b37069bd76bbdf4f9">load_module</a></div><div class="ttdeci">static int load_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09654">manager.c:9654</a></div></div>
<div class="ttc" id="structast__custom__function_html_afcd1706c9144e6d6eee6127661ae3be2"><div class="ttname"><a href="../../db/dc0/structast__custom__function.html#afcd1706c9144e6d6eee6127661ae3be2">ast_custom_function::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00119">pbx.h:119</a></div></div>
<div class="ttc" id="structfast__originate__helper_html"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html">fast_originate_helper</a></div><div class="ttdoc">helper function for originate </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05375">manager.c:5375</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gafe0003d5c882180061f9da68d89840c5"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gafe0003d5c882180061f9da68d89840c5">ast_msg_data_get_length</a></div><div class="ttdeci">size_t ast_msg_data_get_length(struct ast_msg_data *msg)</div><div class="ttdoc">Get length of the structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01513">message.c:1513</a></div></div>
<div class="ttc" id="aoc_8h_html_a2c726e954f606dc71b37ba93be286ff9a44da551e5cfa1d51b072685591df0800"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a44da551e5cfa1d51b072685591df0800">AST_AOC_CHARGE_FREE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00071">aoc.h:71</a></div></div>
<div class="ttc" id="structast__http__digest_html_a47e10f754dbee638f7684eab40c9e34c"><div class="ttname"><a href="../../da/db3/structast__http__digest.html#a47e10f754dbee638f7684eab40c9e34c">ast_http_digest::cnonce</a></div><div class="ttdeci">const ast_string_field cnonce</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00672">utils.h:672</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gade12539a3e517752ad60fef428394532"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gade12539a3e517752ad60fef428394532">action_challenge</a></div><div class="ttdeci">static int action_challenge(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04442">manager.c:4442</a></div></div>
<div class="ttc" id="structmansession_html_a36ac2dd734607a43ed90acb7e9d81ac5"><div class="ttname"><a href="../../d2/d8a/structmansession.html#a36ac2dd734607a43ed90acb7e9d81ac5">mansession::stream</a></div><div class="ttdeci">struct ast_iostream * stream</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01627">manager.c:1627</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a662135d8d43ad08325882645dc5f8df3"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a662135d8d43ad08325882645dc5f8df3">ast_category_new</a></div><div class="ttdeci">struct ast_category * ast_category_new(const char *name, const char *in_file, int lineno)</div><div class="ttdoc">Create a category. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02790">extconf.c:2790</a></div></div>
<div class="ttc" id="app__mysql_8c_html_afbb30cae381f627fb08e1acdac926270"><div class="ttname"><a href="../../d0/db6/app__mysql_8c.html#afbb30cae381f627fb08e1acdac926270">synopsis</a></div><div class="ttdeci">static const char synopsis[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db6/app__mysql_8c_source.html#l00064">app_mysql.c:64</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga460510e6866d4785ec6bd0181c443739"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga460510e6866d4785ec6bd0181c443739">get_input</a></div><div class="ttdeci">static int get_input(struct mansession *s, char *output)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06735">manager.c:6735</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga06c45e1e9264f4a9081b0563e062b0a7"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga06c45e1e9264f4a9081b0563e062b0a7">action_loggerrotate</a></div><div class="ttdeci">static int action_loggerrotate(struct mansession *s, const struct message *m)</div><div class="ttdoc">Manager command &quot;LoggerRotate&quot; - reloads and rotates the logger in the same manner as the CLI command...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06458">manager.c:6458</a></div></div>
<div class="ttc" id="structast__variable_html_afaaf66cc5029a563bd0bb9df076ea14b"><div class="ttname"><a href="../../dd/d02/structast__variable.html#afaaf66cc5029a563bd0bb9df076ea14b">ast_variable::next</a></div><div class="ttdeci">struct ast_variable * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00090">include/asterisk/config.h:90</a></div></div>
<div class="ttc" id="structeventqent_html_a9cf96982557d56650f0f4cd3762f05a0"><div class="ttname"><a href="../../d9/d94/structeventqent.html#a9cf96982557d56650f0f4cd3762f05a0">eventqent::tv</a></div><div class="ttdeci">struct timeval tv</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01463">manager.c:1463</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gae462040f6444a2a4fc9d2681f49cc99b"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gae462040f6444a2a4fc9d2681f49cc99b">ast_channel_cache_by_name</a></div><div class="ttdeci">struct ao2_container * ast_channel_cache_by_name(void)</div><div class="ttdoc">Secondary channel cache, indexed by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00133">stasis_channels.c:133</a></div></div>
<div class="ttc" id="threadstorage_8h_html_ac268c0a8272ec11e73269392507fb1a6"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html#ac268c0a8272ec11e73269392507fb1a6">AST_THREADSTORAGE</a></div><div class="ttdeci">#define AST_THREADSTORAGE(name)</div><div class="ttdoc">Define a thread storage variable. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7d/threadstorage_8h_source.html#l00084">threadstorage.h:84</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a21bd6558b946c31ad5f4eae901051bc5"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a21bd6558b946c31ad5f4eae901051bc5">ast_variables_reverse</a></div><div class="ttdeci">struct ast_variable * ast_variables_reverse(struct ast_variable *var)</div><div class="ttdoc">Reverse a variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00567">main/config.c:567</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga689bc5c3cd185f54178b3719a5e834ac"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga689bc5c3cd185f54178b3719a5e834ac">handle_showmancmd</a></div><div class="ttdeci">static char * handle_showmancmd(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02340">manager.c:2340</a></div></div>
<div class="ttc" id="structast__manager__user_html_ab5e2ca60735be55e922d5b24f3f83133"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#ab5e2ca60735be55e922d5b24f3f83133">ast_manager_user::blackfilters</a></div><div class="ttdeci">struct ao2_container * blackfilters</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01654">manager.c:1654</a></div></div>
<div class="ttc" id="json_8h_html_aa75b709b69e8f05cc4796ccfa8d9d110a46eda9921019c489bb9952624c06e2a8"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a46eda9921019c489bb9952624c06e2a8">AST_JSON_OBJECT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00164">json.h:164</a></div></div>
<div class="ttc" id="chan__ooh323_8c_html_a4d63fdfe5451ec2248c16a2739190c56"><div class="ttname"><a href="../../d7/d49/chan__ooh323_8c.html#a4d63fdfe5451ec2248c16a2739190c56">type</a></div><div class="ttdeci">static const char type[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d49/chan__ooh323_8c_source.html#l00109">chan_ooh323.c:109</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad60d9d8c34b4f61493c1d85ae02d569fa16f16657d9166eef98393fb8bfa5da8d"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa16f16657d9166eef98393fb8bfa5da8d">PARSE_PORT_IGNORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01133">include/asterisk/config.h:1133</a></div></div>
<div class="ttc" id="structast__channel__snapshot__dialplan_html_a7870f447ef3c43ebf148da15363b25dd"><div class="ttname"><a href="../../dc/d3d/structast__channel__snapshot__dialplan.html#a7870f447ef3c43ebf148da15363b25dd">ast_channel_snapshot_dialplan::data</a></div><div class="ttdeci">const ast_string_field data</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00070">stasis_channels.h:70</a></div></div>
<div class="ttc" id="structast__manager__event__blob_html"><div class="ttname"><a href="../../dd/d96/structast__manager__event__blob.html">ast_manager_event_blob</a></div><div class="ttdoc">Struct containing info for an AMI event to send out. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00491">manager.h:491</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa9472597042ec9ccd8f5d51a61b70b74"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa9472597042ec9ccd8f5d51a61b70b74">action_command</a></div><div class="ttdeci">static int action_command(struct mansession *s, const struct message *m)</div><div class="ttdoc">Manager command &quot;command&quot; - execute CLI command. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05295">manager.c:5295</a></div></div>
<div class="ttc" id="structast__party__id_html"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html">ast_party_id</a></div><div class="ttdoc">Information needed to identify an endpoint in a call. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00339">channel.h:339</a></div></div>
<div class="ttc" id="chan__sip_8c_html_a14a9662e09deed264497073732fb014a"><div class="ttname"><a href="../../d5/dfe/chan__sip_8c.html#a14a9662e09deed264497073732fb014a">state</a></div><div class="ttdeci">enum sip_cc_notify_state state</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dfe/chan__sip_8c_source.html#l00959">chan_sip.c:959</a></div></div>
<div class="ttc" id="structast__manager__user_html_a60b121e87a5e71fe64bae70e1721ac3c"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a60b121e87a5e71fe64bae70e1721ac3c">ast_manager_user::username</a></div><div class="ttdeci">char username[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01645">manager.c:1645</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a5c021d1e034a53d09360da4d95c76220"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a5c021d1e034a53d09360da4d95c76220">AST_RWLIST_NEXT</a></div><div class="ttdeci">#define AST_RWLIST_NEXT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00440">linkedlists.h:440</a></div></div>
<div class="ttc" id="pbx_8h_html_ac778ac642def88a06e5d59e11a964c43"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ac778ac642def88a06e5d59e11a964c43">ast_get_hint</a></div><div class="ttdeci">int ast_get_hint(char *hint, int hintsize, char *name, int namesize, struct ast_channel *c, const char *context, const char *exten)</div><div class="ttdoc">If an extension hint exists, return non-zero. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04141">pbx.c:4141</a></div></div>
<div class="ttc" id="app__alarmreceiver_8c_html_ac2c887b7f7b359bfdda8a128980f5081"><div class="ttname"><a href="../../dc/d5c/app__alarmreceiver_8c.html#ac2c887b7f7b359bfdda8a128980f5081">digit</a></div><div class="ttdeci">char digit</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d5c/app__alarmreceiver_8c_source.html#l00131">app_alarmreceiver.c:131</a></div></div>
<div class="ttc" id="structast__manager__user_html_a646b71d97b81fea37dbbc9fd33dc5f4a"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a646b71d97b81fea37dbbc9fd33dc5f4a">ast_manager_user::whitefilters</a></div><div class="ttdeci">struct ao2_container * whitefilters</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01653">manager.c:1653</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7ad06be99930a02b142bf370e2627849be"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7ad06be99930a02b142bf370e2627849be">AST_MODULE_RELOAD_UNINITIALIZED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00115">module.h:115</a></div></div>
<div class="ttc" id="pbx_8h_html_a24a619e5cc5e3f683322295991c57916a90d4fb6299afc301b2bfc05da78eb662"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a24a619e5cc5e3f683322295991c57916a90d4fb6299afc301b2bfc05da78eb662">AST_OUTGOING_WAIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l01153">pbx.h:1153</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5c707deff4e68c7283f2ed73665e0c77"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5c707deff4e68c7283f2ed73665e0c77">MAX_VARS</a></div><div class="ttdeci">#define MAX_VARS</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01508">manager.c:1508</a></div></div>
<div class="ttc" id="channel_8h_html_a493bdebe876caafb8ee535853310364a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a493bdebe876caafb8ee535853310364a">ast_channel_lock</a></div><div class="ttdeci">#define ast_channel_lock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02945">channel.h:2945</a></div></div>
<div class="ttc" id="manager_8h_html_adabf40844c4a05c6e0ef870002599dbe"><div class="ttname"><a href="../../db/d45/manager_8h.html#adabf40844c4a05c6e0ef870002599dbe">EVENT_FLAG_CDR</a></div><div class="ttdeci">#define EVENT_FLAG_CDR</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00081">manager.h:81</a></div></div>
<div class="ttc" id="structast__tls__config_html_a6005f11af6a60f4169876fcd075595ca"><div class="ttname"><a href="../../d5/d90/structast__tls__config.html#a6005f11af6a60f4169876fcd075595ca">ast_tls_config::pvtfile</a></div><div class="ttdeci">char * pvtfile</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00090">tcptls.h:90</a></div></div>
<div class="ttc" id="pbx_8h_html_aa4e9618aa036a586af7d7663afd9b507"><div class="ttname"><a href="../../db/de0/pbx_8h.html#aa4e9618aa036a586af7d7663afd9b507">ast_func_read</a></div><div class="ttdeci">int ast_func_read(struct ast_channel *chan, const char *function, char *workspace, size_t len)</div><div class="ttdoc">executes a read operation on a function </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d70/pbx__functions_8c_source.html#l00599">pbx_functions.c:599</a></div></div>
<div class="ttc" id="manager_8c_html_a1cc9a127eab51721f76aa42436046ab7"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a1cc9a127eab51721f76aa42436046ab7">close_mansession_file</a></div><div class="ttdeci">static void close_mansession_file(struct mansession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07864">manager.c:7864</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a78d4847658b695383d849efd12399b38"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a78d4847658b695383d849efd12399b38">exten</a></div><div class="ttdeci">static char exten[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00118">chan_alsa.c:118</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5106d8afed1eac24399cc5d57ab0c7e6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5106d8afed1eac24399cc5d57ab0c7e6">__astman_get_header</a></div><div class="ttdeci">static const char * __astman_get_header(const struct message *m, char *var, int mode)</div><div class="ttdoc">Return a matching header value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02783">manager.c:2783</a></div></div>
<div class="ttc" id="structast__aoc__unit__entry_html_a7dd39f0ed064eccd86e7b98ee0834b67"><div class="ttname"><a href="../../df/d18/structast__aoc__unit__entry.html#a7dd39f0ed064eccd86e7b98ee0834b67">ast_aoc_unit_entry::valid_amount</a></div><div class="ttdeci">char valid_amount</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00179">aoc.h:179</a></div></div>
<div class="ttc" id="structast__channel_html"><div class="ttname"><a href="../../df/d3c/structast__channel.html">ast_channel</a></div><div class="ttdoc">Main Channel structure associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00073">channel_internal_api.c:73</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa72169a44884720d85770602ffe6cdb5"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa72169a44884720d85770602ffe6cdb5">action_originate</a></div><div class="ttdeci">static int action_originate(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05723">manager.c:5723</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca3fa859b71ad40acfebd95e787cbc373c"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca3fa859b71ad40acfebd95e787cbc373c">AST_SECURITY_EVENT_INVAL_PASSWORD</a></div><div class="ttdoc">An attempt at basic password authentication failed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00109">security_events_defs.h:109</a></div></div>
<div class="ttc" id="tcptls_8h_html_a1850a109f5255895d75980912723ae7c"><div class="ttname"><a href="../../d4/ddf/tcptls_8h.html#a1850a109f5255895d75980912723ae7c">AST_CERTFILE</a></div><div class="ttdeci">#define AST_CERTFILE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00062">tcptls.h:62</a></div></div>
<div class="ttc" id="cli_8h_html_a5c4130cf8f1e93acfdd84416cebf1aef"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a5c4130cf8f1e93acfdd84416cebf1aef">AST_CLI_DEFINE</a></div><div class="ttdeci">#define AST_CLI_DEFINE(fn, txt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00197">cli.h:197</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9227e0d88226ca4021dadf7d03d63976"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9227e0d88226ca4021dadf7d03d63976">check_blacklist</a></div><div class="ttdeci">static int check_blacklist(const char *cmd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05259">manager.c:5259</a></div></div>
<div class="ttc" id="structast__party__number_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_number::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber phone number (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00292">channel.h:292</a></div></div>
<div class="ttc" id="json_8h_html_a0ca956b7df20127f7e38993c3c06cb2c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a0ca956b7df20127f7e38993c3c06cb2c">ast_json_ref</a></div><div class="ttdeci">struct ast_json * ast_json_ref(struct ast_json *value)</div><div class="ttdoc">Increase refcount on value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00067">json.c:67</a></div></div>
<div class="ttc" id="structast__security__event__common_html_ab6aa0eb589925a75d104087ce946a0ad"><div class="ttname"><a href="../../dd/d40/structast__security__event__common.html#ab6aa0eb589925a75d104087ce946a0ad">ast_security_event_common::event_type</a></div><div class="ttdeci">enum ast_security_event_type event_type</div><div class="ttdoc">The security event sub-type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00158">security_events_defs.h:158</a></div></div>
<div class="ttc" id="structmessage_html"><div class="ttname"><a href="../../d8/d9e/structmessage.html">message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00144">manager.h:144</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5d231019a6733602acb549ee4f82529b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5d231019a6733602acb549ee4f82529b">astman_append_json</a></div><div class="ttdeci">static void astman_append_json(struct mansession *s, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03741">manager.c:3741</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga41ec46957049f65f0409d8d92f21b428"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga41ec46957049f65f0409d8d92f21b428">action_mailboxstatus</a></div><div class="ttdeci">static int action_mailboxstatus(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05936">manager.c:5936</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089ab00c5e861fc1c84070bb4af0ae15690b"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089ab00c5e861fc1c84070bb4af0ae15690b">AST_AOC_MULT_THOUSAND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00041">aoc.h:41</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_acec9ce2df15222151ad66fcb1d74eb9f"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#acec9ce2df15222151ad66fcb1d74eb9f">fast_originate_helper::priority</a></div><div class="ttdeci">int priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="group__main__options_html_ga3fe7b544e835ccfde10b88b76eb0e8ea"><div class="ttname"><a href="../../d6/dd6/group__main__options.html#ga3fe7b544e835ccfde10b88b76eb0e8ea">ast_option_maxfiles</a></div><div class="ttdeci">int ast_option_maxfiles</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00081">options.c:81</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html_ab6103ad1bbc12922f93c0526204573cf"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html#ab6103ad1bbc12922f93c0526204573cf">ast_channel_snapshot::base</a></div><div class="ttdeci">struct ast_channel_snapshot_base * base</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00146">stasis_channels.h:146</a></div></div>
<div class="ttc" id="lock_8h_html"><div class="ttname"><a href="../../dd/d42/lock_8h.html">lock.h</a></div><div class="ttdoc">Asterisk locking-related definitions: </div></div>
<div class="ttc" id="group__Group__AMI_html_gac2d42f7be13c532b6a70d50f1b8983d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2d42f7be13c532b6a70d50f1b8983d2">astman_append</a></div><div class="ttdeci">void astman_append(struct mansession *s, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03080">manager.c:3080</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a493b57f443cc38b3d3df9c1e584d9d82">fast_originate_helper::timeout</a></div><div class="ttdeci">int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05376">manager.c:5376</a></div></div>
<div class="ttc" id="stasis__channels_8h_html"><div class="ttname"><a href="../../d9/d4a/stasis__channels_8h.html">stasis_channels.h</a></div></div>
<div class="ttc" id="channel_8h_html_ab0eadbfdcbdad2c0e8927900ec9b98d5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab0eadbfdcbdad2c0e8927900ec9b98d5">ast_channel_iterator_next</a></div><div class="ttdeci">struct ast_channel * ast_channel_iterator_next(struct ast_channel_iterator *i)</div><div class="ttdoc">Get the next channel for a channel iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01422">channel.c:1422</a></div></div>
<div class="ttc" id="asterisk_8h_html"><div class="ttname"><a href="../../db/db2/asterisk_8h.html">asterisk.h</a></div><div class="ttdoc">Asterisk main include file. File version handling, generic pbx functions. </div></div>
<div class="ttc" id="asterisk_8h_html_a6b112b17aed018d85c397e7591948793"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a6b112b17aed018d85c397e7591948793">ast_shutting_down</a></div><div class="ttdeci">int ast_shutting_down(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l01834">asterisk.c:1834</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a8c6534ea809fe4fb40a264409bf22e14"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a8c6534ea809fe4fb40a264409bf22e14">fast_originate_helper::otherchannelid</a></div><div class="ttdeci">const ast_string_field otherchannelid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="aoc_8h_html_a2c726e954f606dc71b37ba93be286ff9a5816131a38e568febf50d316c850c44b"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a5816131a38e568febf50d316c850c44b">AST_AOC_CHARGE_UNIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00073">aoc.h:73</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a93e2a5d4517067d0b9a0e39b0cdc5df8">AST_BRIDGE_TRANSFER_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01121">bridge.h:1121</a></div></div>
<div class="ttc" id="stasis__bridges_8h_html"><div class="ttname"><a href="../../dc/d4e/stasis__bridges_8h.html">stasis_bridges.h</a></div></div>
<div class="ttc" id="structast__bridge_html_a753c7b39e3284d771f13f513b003d033"><div class="ttname"><a href="../../d4/d84/structast__bridge.html#a753c7b39e3284d771f13f513b003d033">ast_bridge::uniqueid</a></div><div class="ttdeci">const ast_string_field uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00409">bridge.h:409</a></div></div>
<div class="ttc" id="astobj2_8h_html_a512cc40ce96c63b3d5c78040baa4c9cd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a512cc40ce96c63b3d5c78040baa4c9cd">ao2_container_count</a></div><div class="ttdeci">int ao2_container_count(struct ao2_container *c)</div><div class="ttdoc">Returns the number of elements in a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00034">astobj2_container.c:34</a></div></div>
<div class="ttc" id="structast__state__cb__info_html_afb0bd6506905ab8d17df1d8bb3294fc5"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html#afb0bd6506905ab8d17df1d8bb3294fc5">ast_state_cb_info::presence_message</a></div><div class="ttdeci">const char * presence_message</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00108">pbx.h:108</a></div></div>
<div class="ttc" id="isdn__lib_8c_html_ab9129b977a587b50ea801daac75e178f"><div class="ttname"><a href="../../de/dfe/isdn__lib_8c.html#ab9129b977a587b50ea801daac75e178f">ARRAY_LEN</a></div><div class="ttdeci">#define ARRAY_LEN(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dfe/isdn__lib_8c_source.html#l00042">isdn_lib.c:42</a></div></div>
<div class="ttc" id="structall__events_html"><div class="ttname"><a href="../../d2/d3e/structall__events.html">all_events</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01468">manager.c:1468</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a23b60f2636bcfbc4dfeea6cc21bf847b">AO2_ALLOC_OPT_LOCK_NOLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00369">astobj2.h:369</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga06b330b2a545662f8130f086604660ec"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga06b330b2a545662f8130f086604660ec">mansession_unlock</a></div><div class="ttdeci">static void mansession_unlock(struct mansession *s)</div><div class="ttdoc">Unlock the &amp;#39;mansession&amp;#39; structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03257">manager.c:3257</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372caeba3af0716af08bf27b004b5b935d24f"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372caeba3af0716af08bf27b004b5b935d24f">AST_SECURITY_EVENT_SUCCESSFUL_AUTH</a></div><div class="ttdoc">FYI FWIW, Successful authentication has occurred. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00097">security_events_defs.h:97</a></div></div>
<div class="ttc" id="structast__module_html"><div class="ttname"><a href="../../d9/df5/structast__module.html">ast_module</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d96/loader_8c_source.html#l00293">loader.c:293</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa89bb877ade9ce418ad6663f3d936f314">AST_MODULE_LOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00070">module.h:70</a></div></div>
<div class="ttc" id="json_8h_html_a99715667e822b2ad409b34ca041e535d"><div class="ttname"><a href="../../d4/d05/json_8h.html#a99715667e822b2ad409b34ca041e535d">ast_json_pack</a></div><div class="ttdeci">struct ast_json * ast_json_pack(char const *format,...)</div><div class="ttdoc">Helper for creating complex JSON values. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00591">json.c:591</a></div></div>
<div class="ttc" id="manager_8c_html_a9eeaf526330f14e1906f9e6f2557364b"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a9eeaf526330f14e1906f9e6f2557364b">HSMC_FORMAT</a></div><div class="ttdeci">#define HSMC_FORMAT</div></div>
<div class="ttc" id="include_2asterisk_2security__events_8h_html"><div class="ttname"><a href="../../d0/d29/include_2asterisk_2security__events_8h.html">security_events.h</a></div><div class="ttdoc">Security Event Reporting API. </div></div>
<div class="ttc" id="structfast__originate__helper_html_a6379def8cefd9afdea29d5ed673cf8a0"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a6379def8cefd9afdea29d5ed673cf8a0">fast_originate_helper::tech</a></div><div class="ttdeci">const ast_string_field tech</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad12cd7f4f5efe4a460c1aaed0ac488d5"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad12cd7f4f5efe4a460c1aaed0ac488d5">ast_variable_insert</a></div><div class="ttdeci">void ast_variable_insert(struct ast_category *category, struct ast_variable *variable, const char *line)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00501">main/config.c:501</a></div></div>
<div class="ttc" id="manager_8c_html_ae5d6fd1b45806b39a651be34a9c51bea"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ae5d6fd1b45806b39a651be34a9c51bea">subscribe_all</a></div><div class="ttdeci">static int subscribe_all(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09086">manager.c:9086</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a8717a951656993c40bd851ebf50f58e3a7273ed64a1fd4a93692986eac376124a"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a8717a951656993c40bd851ebf50f58e3a7273ed64a1fd4a93692986eac376124a">AST_STATIC_DOC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00032">xmldoc.h:32</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a626176754f57f4dc291e44916a5354f8"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a626176754f57f4dc291e44916a5354f8">fast_originate_helper::account</a></div><div class="ttdeci">const ast_string_field account</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="module_8h_html_a841766995d4e10ebb3950b10aab97d9e"><div class="ttname"><a href="../../d5/d16/module_8h.html#a841766995d4e10ebb3950b10aab97d9e">ast_load_resource</a></div><div class="ttdeci">enum ast_module_load_result ast_load_resource(const char *resource_name)</div><div class="ttdoc">Load a module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d96/loader_8c_source.html#l01819">loader.c:1819</a></div></div>
<div class="ttc" id="manager_8c_html_a38eb222ca678604d4f203c9e9d5295ab"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a38eb222ca678604d4f203c9e9d5295ab">astman_verify_session_writepermissions</a></div><div class="ttdeci">int astman_verify_session_writepermissions(uint32_t ident, int perm)</div><div class="ttdoc">Verify a session&amp;#39;s write permissions against a permission mask. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07600">manager.c:7600</a></div></div>
<div class="ttc" id="structmansession__session_html_a60b121e87a5e71fe64bae70e1721ac3c"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a60b121e87a5e71fe64bae70e1721ac3c">mansession_session::username</a></div><div class="ttdeci">char username[80]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01592">manager.c:1592</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a39918fd433ac42184b152c86016ef139"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a39918fd433ac42184b152c86016ef139">AST_RWLIST_HEAD_STATIC</a></div><div class="ttdeci">#define AST_RWLIST_HEAD_STATIC(name, type)</div><div class="ttdoc">Defines a structure to be used to hold a read/write list of specified type, statically initialized...</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00332">linkedlists.h:332</a></div></div>
<div class="ttc" id="http_8h_html_ab0f7966324a592e02d53f01e7bb9cc17"><div class="ttname"><a href="../../dd/d56/http_8h.html#ab0f7966324a592e02d53f01e7bb9cc17">ast_http_error</a></div><div class="ttdeci">void ast_http_error(struct ast_tcptls_session_instance *ser, int status, const char *title, const char *text)</div><div class="ttdoc">Send HTTP error message and close socket. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00648">http.c:648</a></div></div>
<div class="ttc" id="structast__security__event__chal__resp__failed_html_a6cb84dee103203abb9b4a415f108a559"><div class="ttname"><a href="../../d3/d5a/structast__security__event__chal__resp__failed.html#a6cb84dee103203abb9b4a415f108a559">ast_security_event_chal_resp_failed::expected_response</a></div><div class="ttdeci">const char * expected_response</div><div class="ttdoc">Response expected to be received. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00449">security_events_defs.h:449</a></div></div>
<div class="ttc" id="module_8h_html_ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15"><div class="ttname"><a href="../../d5/d16/module_8h.html#ab35bc4efd9f79706300965c9d36a0ce5a634484c0074e7b6b630756fab09e2c15">AST_MODULE_SUPPORT_CORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00121">module.h:121</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9592be65e0f9c99b7952a5841888757f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9592be65e0f9c99b7952a5841888757f">ast_manager_unregister_hook</a></div><div class="ttdeci">void ast_manager_unregister_hook(struct manager_custom_hook *hook)</div><div class="ttdoc">Delete a custom hook to be called when an event is fired. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01942">manager.c:1942</a></div></div>
<div class="ttc" id="tcptls_8h_html_a29375a4482c8de1e9879b97be2e88bf0"><div class="ttname"><a href="../../d4/ddf/tcptls_8h.html#a29375a4482c8de1e9879b97be2e88bf0">ast_tcptls_server_start</a></div><div class="ttdeci">void ast_tcptls_server_start(struct ast_tcptls_session_args *desc)</div><div class="ttdoc">This is a generic (re)start routine for a TCP server, which does the socket/bind/listen and starts a ...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d9b/tcptls_8c_source.html#l00685">tcptls.c:685</a></div></div>
<div class="ttc" id="strings_8h_html"><div class="ttname"><a href="../../d6/d90/strings_8h.html">strings.h</a></div><div class="ttdoc">String manipulation functions. </div></div>
<div class="ttc" id="module_8h_html_ac034ec04e9dd255a0d39bdfcb73113b9a10bb7955de423b36c75f645de78d2f39"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac034ec04e9dd255a0d39bdfcb73113b9a10bb7955de423b36c75f645de78d2f39">AST_FORCE_SOFT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00062">module.h:62</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7ac0be7032578c68902708da91e5e7d71a"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7ac0be7032578c68902708da91e5e7d71a">AST_MODULE_RELOAD_NOT_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00112">module.h:112</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga740af4550410dae06b748c23ebd0ae24"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga740af4550410dae06b748c23ebd0ae24">astman_start_ack</a></div><div class="ttdeci">static void astman_start_ack(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03196">manager.c:3196</a></div></div>
<div class="ttc" id="callerid_8h_html"><div class="ttname"><a href="../../de/d47/callerid_8h.html">callerid.h</a></div><div class="ttdoc">CallerID (and other GR30) management and generation Includes code and algorithms from the Zapata libr...</div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html_acfe9f988bbf6b3a2d02663e30668277e"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html#acfe9f988bbf6b3a2d02663e30668277e">ast_get_chan_features_atxferabort</a></div><div class="ttdeci">char * ast_get_chan_features_atxferabort(struct ast_channel *chan)</div><div class="ttdoc">Get the transfer configuration option atxferabort. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d71/features__config_8c_source.html#l01178">features_config.c:1178</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_adea5390496e5477192d86f340d512d04"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#adea5390496e5477192d86f340d512d04">ast_variables_destroy</a></div><div class="ttdeci">void ast_variables_destroy(struct ast_variable *var)</div><div class="ttdoc">Free variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01263">extconf.c:1263</a></div></div>
<div class="ttc" id="structmansession__session_html_a77d36f7d3efdab912ada2ef54a75cc65"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a77d36f7d3efdab912ada2ef54a75cc65">mansession_session::pending_event</a></div><div class="ttdeci">int pending_event</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01606">manager.c:1606</a></div></div>
<div class="ttc" id="structval_html"><div class="ttname"><a href="../../d5/d85/structval.html">val</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dd1/ast__expr2_8c_source.html#l00325">ast_expr2.c:325</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad57326008c326db88dc36779741622b8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad57326008c326db88dc36779741622b8">ao2_t_alloc</a></div><div class="ttdeci">#define ao2_t_alloc(data_size, destructor_fn, debug_msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00409">astobj2.h:409</a></div></div>
<div class="ttc" id="tcptls_8h_html_a24ff4bad1d2894ae3cae4e555d508fd0"><div class="ttname"><a href="../../d4/ddf/tcptls_8h.html#a24ff4bad1d2894ae3cae4e555d508fd0">ast_ssl_setup</a></div><div class="ttdeci">int ast_ssl_setup(struct ast_tls_config *cfg)</div><div class="ttdoc">Set up an SSL server. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d9b/tcptls_8c_source.html#l00570">tcptls.c:570</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a387af9887266a55f3dcbbf3c12d4ccba"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a387af9887266a55f3dcbbf3c12d4ccba">ast_variable_delete</a></div><div class="ttdeci">int ast_variable_delete(struct ast_category *category, const char *variable, const char *match, const char *line)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01399">main/config.c:1399</a></div></div>
<div class="ttc" id="utils_8h_html_a832647380b1f97e7ac1b4492f8816d46"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a832647380b1f97e7ac1b4492f8816d46">ast_pthread_create_detached</a></div><div class="ttdeci">#define ast_pthread_create_detached(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00563">utils.h:563</a></div></div>
<div class="ttc" id="netsock2_8h_html_aad98818272870e12d48fe4347aaa46d0"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aad98818272870e12d48fe4347aaa46d0">ast_sockaddr_parse</a></div><div class="ttdeci">int ast_sockaddr_parse(struct ast_sockaddr *addr, const char *str, int flags)</div><div class="ttdoc">Parse an IPv4 or IPv6 address string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d27/netsock2_8c_source.html#l00230">netsock2.c:230</a></div></div>
<div class="ttc" id="aoc_8h_html_a6e8ab2944e2d6d1f783b3ebcd7b3c272"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a6e8ab2944e2d6d1f783b3ebcd7b3c272">ast_aoc_add_unit_entry</a></div><div class="ttdeci">int ast_aoc_add_unit_entry(struct ast_aoc_decoded *decoded, const unsigned int amount_is_present, const unsigned int amount, const unsigned int type_is_present, const unsigned int type)</div><div class="ttdoc">Adds a unit entry into the list of units. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00977">aoc.c:977</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa1e469ecb509cb8dd2b26bde7dd1e1be"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa1e469ecb509cb8dd2b26bde7dd1e1be">userevent_buf</a></div><div class="ttdeci">static struct ast_threadstorage userevent_buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03063">manager.c:3063</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a5937d72e8b39660a1b824af2042c0e9c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a5937d72e8b39660a1b824af2042c0e9c">AST_RWLIST_INSERT_AFTER</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_AFTER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00701">linkedlists.h:701</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga8678a44da3d5cf72e6ea38409d2898bb"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga8678a44da3d5cf72e6ea38409d2898bb">action_reload</a></div><div class="ttdeci">static int action_reload(struct mansession *s, const struct message *m)</div><div class="ttdoc">Send a reload event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06358">manager.c:6358</a></div></div>
<div class="ttc" id="ast__version_8h_html"><div class="ttname"><a href="../../d5/db9/ast__version_8h.html">ast_version.h</a></div><div class="ttdoc">Asterisk version information. </div></div>
<div class="ttc" id="group__Group__AMI_html_gaa418c48f68fe0253bf35346878d7b919"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa418c48f68fe0253bf35346878d7b919">mansession_get_transport</a></div><div class="ttdeci">static enum ast_transport mansession_get_transport(const struct mansession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03279">manager.c:3279</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga3eb98988184ea3f302e9a914eb9641e5"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga3eb98988184ea3f302e9a914eb9641e5">displayconnects</a></div><div class="ttdeci">static int displayconnects</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01470">manager.c:1470</a></div></div>
<div class="ttc" id="cli_8h_html_a56b6b59ee2eaa994597a5b0f4e9f9d09"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a56b6b59ee2eaa994597a5b0f4e9f9d09">ast_cli_unregister_multiple</a></div><div class="ttdeci">int ast_cli_unregister_multiple(struct ast_cli_entry *e, int len)</div><div class="ttdoc">Unregister multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00030">clicompat.c:30</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga067ac83735089a590c082f49ab11800c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga067ac83735089a590c082f49ab11800c">man_do_variable_value</a></div><div class="ttdeci">static struct ast_variable * man_do_variable_value(struct ast_variable *head, const char *hdr_val)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02862">manager.c:2862</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga8548bdd40d19dc12b6e3709694d5dbd2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga8548bdd40d19dc12b6e3709694d5dbd2">any_manager_listeners</a></div><div class="ttdeci">#define any_manager_listeners(sessions)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01835">manager.c:1835</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa837605a5558f94ae96ed1b881aa75e7"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa837605a5558f94ae96ed1b881aa75e7">action_userevent</a></div><div class="ttdeci">static int action_userevent(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06255">manager.c:6255</a></div></div>
<div class="ttc" id="manager_8c_html_ae2bb15afe29e63b72c564aa73ce69f23"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ae2bb15afe29e63b72c564aa73ce69f23">webregged</a></div><div class="ttdeci">static int webregged</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08630">manager.c:8630</a></div></div>
<div class="ttc" id="channel_8h_html_ab733a7825810b895a89b629e0ea89380"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab733a7825810b895a89b629e0ea89380">ast_channel_unref</a></div><div class="ttdeci">#define ast_channel_unref(c)</div><div class="ttdoc">Decrease channel reference count. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02981">channel.h:2981</a></div></div>
<div class="ttc" id="structast__manager__event__blob_html_a32dae0134e7c44c45bb610ab1a152521"><div class="ttname"><a href="../../dd/d96/structast__manager__event__blob.html#a32dae0134e7c44c45bb610ab1a152521">ast_manager_event_blob::extra_fields</a></div><div class="ttdeci">const ast_string_field extra_fields</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00496">manager.h:496</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html_a623575abd8c4c7cdcab02fa4156c3762"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html#a623575abd8c4c7cdcab02fa4156c3762">ast_xml_doc_item::next</a></div><div class="ttdeci">struct ast_xml_doc_item * next</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00080">xmldoc.h:80</a></div></div>
<div class="ttc" id="module_8h_html_aa4f734041ffd9d75b07cefb0291e1e58a37c0718af4fc7bf8c860beb730161044"><div class="ttname"><a href="../../d5/d16/module_8h.html#aa4f734041ffd9d75b07cefb0291e1e58a37c0718af4fc7bf8c860beb730161044">AST_MODPRI_CORE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00324">module.h:324</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gacc128abc0bb66879ef7743eea7a5d53f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gacc128abc0bb66879ef7743eea7a5d53f">ast_hook_send_action</a></div><div class="ttdeci">int ast_hook_send_action(struct manager_custom_hook *hook, const char *msg)</div><div class="ttdoc">access for hooks to send action messages to ami </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02937">manager.c:2937</a></div></div>
<div class="ttc" id="json_8h_html_a8ac267a28e7eddf5b10bbb65139406f2"><div class="ttname"><a href="../../d4/d05/json_8h.html#a8ac267a28e7eddf5b10bbb65139406f2">ast_json_payload_create</a></div><div class="ttdeci">struct ast_json_payload * ast_json_payload_create(struct ast_json *json)</div><div class="ttdoc">Create an ao2 object to pass json blobs as data payloads for stasis. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00735">json.c:735</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga16a1493b33939fc5e485953855078109"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga16a1493b33939fc5e485953855078109">report_invalid_user</a></div><div class="ttdeci">static void report_invalid_user(const struct mansession *s, const char *username)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03285">manager.c:3285</a></div></div>
<div class="ttc" id="utils_8h_html_a00d4c9254c9827d6fa44f17a326744a5"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a00d4c9254c9827d6fa44f17a326744a5">ast_test_flag</a></div><div class="ttdeci">#define ast_test_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00063">utils.h:63</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aef636ed2f3d33f4c7a1ba67eb7c4d052"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aef636ed2f3d33f4c7a1ba67eb7c4d052">ast_variable_browse</a></div><div class="ttdeci">struct ast_variable * ast_variable_browse(const struct ast_config *config, const char *category_name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01216">extconf.c:1216</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9b312f4df19fa79a2185f41ff533516b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9b312f4df19fa79a2185f41ff533516b">ast_manager_register_hook</a></div><div class="ttdeci">void ast_manager_register_hook(struct manager_custom_hook *hook)</div><div class="ttdoc">Add a custom hook to be called when an event is fired. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01934">manager.c:1934</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga3cf68c6aee41a7989e352a9da265890a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga3cf68c6aee41a7989e352a9da265890a">manager_default_msg_cb</a></div><div class="ttdeci">static void manager_default_msg_cb(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01838">manager.c:1838</a></div></div>
<div class="ttc" id="structmansession__session_html_ac973a08be5923acefc1e920ce302f47b"><div class="ttname"><a href="../../df/d05/structmansession__session.html#ac973a08be5923acefc1e920ce302f47b">mansession_session::datastores</a></div><div class="ttdeci">struct mansession_session::mansession_datastores datastores</div></div>
<div class="ttc" id="channel_8h_html_ac03c2ec5ac8e7a6ef9c5d92f91880927"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac03c2ec5ac8e7a6ef9c5d92f91880927">ast_channel_setwhentohangup_tv</a></div><div class="ttdeci">void ast_channel_setwhentohangup_tv(struct ast_channel *chan, struct timeval offset)</div><div class="ttdoc">Set when to hang a channel up. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00510">channel.c:510</a></div></div>
<div class="ttc" id="include_2asterisk_2security__events_8h_html_a0db46f92449a8f63b954d776ebead63a"><div class="ttname"><a href="../../d0/d29/include_2asterisk_2security__events_8h.html#a0db46f92449a8f63b954d776ebead63a">ast_security_topic</a></div><div class="ttdeci">struct stasis_topic * ast_security_topic(void)</div><div class="ttdoc">A stasis_topic which publishes messages for security related issues. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l00380">main/security_events.c:380</a></div></div>
<div class="ttc" id="translate_8h_html"><div class="ttname"><a href="../../db/d39/translate_8h.html">translate.h</a></div><div class="ttdoc">Support for translation of data formats. translate.c. </div></div>
<div class="ttc" id="group__Group__AMI_html_ga1a2e7df8657b820c5a6663b397f23bc9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga1a2e7df8657b820c5a6663b397f23bc9">ast_manager_check_enabled</a></div><div class="ttdeci">int ast_manager_check_enabled(void)</div><div class="ttdoc">Check if AMI is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01949">manager.c:1949</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga085b42ebdf75f324731bbbfc3edc0d8d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga085b42ebdf75f324731bbbfc3edc0d8d">GET_HEADER_LAST_MATCH</a></div><div class="ttdeci">#define GET_HEADER_LAST_MATCH</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02767">manager.c:2767</a></div></div>
<div class="ttc" id="netsock2_8h_html_a56a46003c93bfd65111ea8ffc97af8f9"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#a56a46003c93bfd65111ea8ffc97af8f9">ast_sockaddr_copy</a></div><div class="ttdeci">static void ast_sockaddr_copy(struct ast_sockaddr *dst, const struct ast_sockaddr *src)</div><div class="ttdoc">Copies the data from one ast_sockaddr to another. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00171">netsock2.h:171</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga1f451671d833c6be7e65d2fe89042e1f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga1f451671d833c6be7e65d2fe89042e1f">manager_json_to_ast_str</a></div><div class="ttdeci">static void manager_json_to_ast_str(struct ast_json *obj, const char *key, struct ast_str **res, key_exclusion_cb exclusion_cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01780">manager.c:1780</a></div></div>
<div class="ttc" id="iostream_8h_html_a6e0bf2afcbc5b330b96378626f9ac5b3"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#a6e0bf2afcbc5b330b96378626f9ac5b3">ast_iostream_write</a></div><div class="ttdeci">ssize_t ast_iostream_write(struct ast_iostream *stream, const void *buffer, size_t count)</div><div class="ttdoc">Write data to an iostream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00374">iostream.c:374</a></div></div>
<div class="ttc" id="chanvars_8h_html_a8e0081172db71c5021d20706c50d959c"><div class="ttname"><a href="../../d9/de7/chanvars_8h.html#a8e0081172db71c5021d20706c50d959c">ast_var_value</a></div><div class="ttdeci">const char * ast_var_value(const struct ast_var_t *var)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df9/chanvars_8c_source.html#l00080">chanvars.c:80</a></div></div>
<div class="ttc" id="json_8h_html_a33bcd9181e613a659eefe411ec42c87c"><div class="ttname"><a href="../../d4/d05/json_8h.html#a33bcd9181e613a659eefe411ec42c87c">ast_json_unref</a></div><div class="ttdeci">void ast_json_unref(struct ast_json *value)</div><div class="ttdoc">Decrease refcount on value. If refcount reaches zero, value is freed. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00073">json.c:73</a></div></div>
<div class="ttc" id="http_8h_html_aacbeca1d5a14388e6c2f708ac7a9fffa"><div class="ttname"><a href="../../dd/d56/http_8h.html#aacbeca1d5a14388e6c2f708ac7a9fffa">ast_http_auth</a></div><div class="ttdeci">void ast_http_auth(struct ast_tcptls_session_instance *ser, const char *realm, const unsigned long nonce, const unsigned long opaque, int stale, const char *text)</div><div class="ttdoc">Send http &quot;401 Unauthorized&quot; response and close socket. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00622">http.c:622</a></div></div>
<div class="ttc" id="structast__party__id_html_aab4036618469f3fa9ab26a22726ba2db"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aab4036618469f3fa9ab26a22726ba2db">ast_party_id::name</a></div><div class="ttdeci">struct ast_party_name name</div><div class="ttdoc">Subscriber name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00341">channel.h:341</a></div></div>
<div class="ttc" id="astobj2_8h_html_a22f40c733a085f259af94e864ebaa09a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a22f40c733a085f259af94e864ebaa09a">OBJ_KEY</a></div><div class="ttdeci">#define OBJ_KEY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01155">astobj2.h:1155</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga81510d243e1eb9c6f919e72183e811a6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga81510d243e1eb9c6f919e72183e811a6">astman_append_headers</a></div><div class="ttdeci">static void astman_append_headers(struct message *m, const struct ast_variable *params)</div><div class="ttdoc">Append additional headers into the message structure from params. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02830">manager.c:2830</a></div></div>
<div class="ttc" id="structast__security__event__chal__resp__failed_html"><div class="ttname"><a href="../../d3/d5a/structast__security__event__chal__resp__failed.html">ast_security_event_chal_resp_failed</a></div><div class="ttdoc">An attempt at challenge/response auth failed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00424">security_events_defs.h:424</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga6dba42aa414d62585a0a662a5561ec73"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga6dba42aa414d62585a0a662a5561ec73">json_escape</a></div><div class="ttdeci">static void json_escape(char *out, const char *in)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03721">manager.c:3721</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_ac95651d79c608a3148973b5b1fc9e525"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#ac95651d79c608a3148973b5b1fc9e525">buf</a></div><div class="ttdeci">char buf[BUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00066">eagi_proxy.c:66</a></div></div>
<div class="ttc" id="structast__manager__user_html_a006a09ed1c51271c4b6f582a2a42ba5f"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a006a09ed1c51271c4b6f582a2a42ba5f">ast_manager_user::writeperm</a></div><div class="ttdeci">int writeperm</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01648">manager.c:1648</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaea3a1b38ba96480a2f09d7109a69b0fd"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaea3a1b38ba96480a2f09d7109a69b0fd">action_ping</a></div><div class="ttdeci">static int action_ping(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03602">manager.c:3602</a></div></div>
<div class="ttc" id="ast__version_8h_html_a7765c608aea948584928643ab3963b2a"><div class="ttname"><a href="../../d5/db9/ast__version_8h.html#a7765c608aea948584928643ab3963b2a">ast_get_version</a></div><div class="ttdeci">const char * ast_get_version(void)</div><div class="ttdoc">Retrieve the Asterisk version string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0b/version_8c_source.html#l00016">version.c:16</a></div></div>
<div class="ttc" id="manager_8c_html_a4f17d74ca1307a629a1d6b237ca02c35"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a4f17d74ca1307a629a1d6b237ca02c35">HSMCONN_FORMAT1</a></div><div class="ttdeci">#define HSMCONN_FORMAT1</div></div>
<div class="ttc" id="group__Group__AMI_html_gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a11037e5e5ecf59d690cb6db101376995"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a11037e5e5ecf59d690cb6db101376995">FILTER_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01435">manager.c:1435</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca5fc59b193d86a0a8ddfe866304be829d">OBJ_NODATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01048">astobj2.h:1048</a></div></div>
<div class="ttc" id="namespacemake__ari__stubs_html_a40a5d58ffa6e88aa578d6683ac413105"><div class="ttname"><a href="../../d2/dc8/namespacemake__ari__stubs.html#a40a5d58ffa6e88aa578d6683ac413105">make_ari_stubs.file</a></div><div class="ttdeci">file</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d28/make__ari__stubs_8py_source.html#l00025">make_ari_stubs.py:25</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a5adc304e693097ec75b474e6a5309958"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a5adc304e693097ec75b474e6a5309958">stasis_message_router_add</a></div><div class="ttdeci">int stasis_message_router_add(struct stasis_message_router *router, struct stasis_message_type *message_type, stasis_subscription_cb callback, void *data)</div><div class="ttdoc">Add a route to a message router. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00310">stasis_message_router.c:310</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa7ca48cb0ef2a611f2aa94aeeca70b3b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa7ca48cb0ef2a611f2aa94aeeca70b3b">MAX_AUTH_PERM_STRING</a></div><div class="ttdeci">#define MAX_AUTH_PERM_STRING</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02043">manager.c:2043</a></div></div>
<div class="ttc" id="chan__skinny_8c_html_a61aa7b9ad75e714f776c1f82bcc3359f"><div class="ttname"><a href="../../d0/d80/chan__skinny_8c.html#a61aa7b9ad75e714f776c1f82bcc3359f">sessions</a></div><div class="ttdeci">static struct sessions sessions</div></div>
<div class="ttc" id="structmansession__session_html_a25ce442b0903796547e81a75339b8a1e"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a25ce442b0903796547e81a75339b8a1e">mansession_session::waiting_thread</a></div><div class="ttdeci">pthread_t waiting_thread</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01587">manager.c:1587</a></div></div>
<div class="ttc" id="stasis_8h_html_a70cd046d8e3fd50de5c51aecb2830d2a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a70cd046d8e3fd50de5c51aecb2830d2a">STASIS_MESSAGE_TYPE_INIT</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_INIT(name)</div><div class="ttdoc">Boiler-plate messaging macro for initializing message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01501">stasis.h:1501</a></div></div>
<div class="ttc" id="netsock2_8h_html_aa2785c5990a086943fea750c980abbc3"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aa2785c5990a086943fea750c980abbc3">ast_transport</a></div><div class="ttdeci">ast_transport</div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00059">netsock2.h:59</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aeebe92aa21bea10f5d3f901a357a9806"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aeebe92aa21bea10f5d3f901a357a9806">ast_category_delete</a></div><div class="ttdeci">struct ast_category * ast_category_delete(struct ast_config *cfg, struct ast_category *category)</div><div class="ttdoc">Delete a category. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01478">main/config.c:1478</a></div></div>
<div class="ttc" id="astobj2_8h_html_a45fc2eb2ef13e15588fc04088c3d8694"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a45fc2eb2ef13e15588fc04088c3d8694">ao2_t_global_obj_replace_unref</a></div><div class="ttdeci">#define ao2_t_global_obj_replace_unref(holder, obj, tag)</div><div class="ttdoc">Replace an ao2 object in the global holder, throwing away any old object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00906">astobj2.h:906</a></div></div>
<div class="ttc" id="manager_8c_html_afd6ff00e10a26f619b167194999013b5"><div class="ttname"><a href="../../d4/d10/manager_8c.html#afd6ff00e10a26f619b167194999013b5">HSMCONN_FORMAT2</a></div><div class="ttdeci">#define HSMCONN_FORMAT2</div></div>
<div class="ttc" id="linkedlists_8h_html_a2d0cf4182bade9f773fb16ff12abe595"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2d0cf4182bade9f773fb16ff12abe595">AST_RWLIST_WRLOCK</a></div><div class="ttdeci">#define AST_RWLIST_WRLOCK(head)</div><div class="ttdoc">Write locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00051">linkedlists.h:51</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1da848e7e562e4048e4b0ea85d176afa76c"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da848e7e562e4048e4b0ea85d176afa76c">AST_AOC_BILLING_CALL_DEFLECTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00057">aoc.h:57</a></div></div>
<div class="ttc" id="manager_8c_html_a4e23b878e759dadd1e466a63193abba0"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a4e23b878e759dadd1e466a63193abba0">ast_str_append_event_header</a></div><div class="ttdeci">int ast_str_append_event_header(struct ast_str **fields_string, const char *header, const char *value)</div><div class="ttdoc">append an event header to an ast string </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09705">manager.c:9705</a></div></div>
<div class="ttc" id="chanvars_8h_html_a356a31cd608ec07d3668dcd589be49d8"><div class="ttname"><a href="../../d9/de7/chanvars_8h.html#a356a31cd608ec07d3668dcd589be49d8">ast_var_name</a></div><div class="ttdeci">const char * ast_var_name(const struct ast_var_t *var)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df9/chanvars_8c_source.html#l00060">chanvars.c:60</a></div></div>
<div class="ttc" id="structast__json__iter_html"><div class="ttname"><a href="../../d3/d77/structast__json__iter.html">ast_json_iter</a></div><div class="ttdoc">Iterator for JSON object key/values. </div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92ac22fdd80fd7df09af8999f6e429e29fb"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac22fdd80fd7df09af8999f6e429e29fb">FAILURE_TEMPLATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01431">manager.c:1431</a></div></div>
<div class="ttc" id="utils_8h_html_ab5033a1f3d781d45e7ccc27598114510"><div class="ttname"><a href="../../d5/d60/utils_8h.html#ab5033a1f3d781d45e7ccc27598114510">ast_set_flag</a></div><div class="ttdeci">#define ast_set_flag(p, flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00070">utils.h:70</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ac08f7eb1eb9476b30987c73e1052ada8"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ac08f7eb1eb9476b30987c73e1052ada8">AST_STANDARD_APP_ARGS</a></div><div class="ttdeci">#define AST_STANDARD_APP_ARGS(args, parse)</div><div class="ttdoc">Performs the &amp;#39;standard&amp;#39; argument separation process for an application. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01285">include/asterisk/app.h:1285</a></div></div>
<div class="ttc" id="channel_8h_html_a723ac44c92b9edb6c1a731e01edacb4a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a723ac44c92b9edb6c1a731e01edacb4a">ast_check_hangup_locked</a></div><div class="ttdeci">int ast_check_hangup_locked(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00459">channel.c:459</a></div></div>
<div class="ttc" id="module_8h_html_af9e3b4ae730e43312e00fcbc1707588b"><div class="ttname"><a href="../../d5/d16/module_8h.html#af9e3b4ae730e43312e00fcbc1707588b">ast_module_reload</a></div><div class="ttdeci">enum ast_module_reload_result ast_module_reload(const char *name)</div><div class="ttdoc">Reload asterisk modules. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d96/loader_8c_source.html#l01562">loader.c:1562</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga58c3e3da5d31739cafaee1df6ddf9342"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga58c3e3da5d31739cafaee1df6ddf9342">astman_send_list_complete_start</a></div><div class="ttdeci">void astman_send_list_complete_start(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdoc">Start the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03237">manager.c:3237</a></div></div>
<div class="ttc" id="channel_8h_html_a5f72bc09af81d17c4ecebf77cea38508"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5f72bc09af81d17c4ecebf77cea38508">ast_channel_get_manager_vars</a></div><div class="ttdeci">struct varshead * ast_channel_get_manager_vars(struct ast_channel *chan)</div><div class="ttdoc">Gets the variables for a given channel, as specified by ast_channel_set_manager_vars(). </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l08085">channel.c:8085</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7">ast_module_reload_result</a></div><div class="ttdeci">ast_module_reload_result</div><div class="ttdoc">Possible return types for ast_module_reload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00109">module.h:109</a></div></div>
<div class="ttc" id="structast__cli__entry_html"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html">ast_cli_entry</a></div><div class="ttdoc">descriptor for a cli entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00171">cli.h:171</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga14bd65f2096d29973dfd999d71e88eee"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga14bd65f2096d29973dfd999d71e88eee">get_manager_by_name_locked</a></div><div class="ttdeci">static struct ast_manager_user * get_manager_by_name_locked(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02305">manager.c:2305</a></div></div>
<div class="ttc" id="structast__cli__args_html_a98e1d8441ca58834f11f7367be4b3345"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a98e1d8441ca58834f11f7367be4b3345">ast_cli_args::argc</a></div><div class="ttdeci">const int argc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00160">cli.h:160</a></div></div>
<div class="ttc" id="logger_8h_html_adf4476a6a4ea6c74231c826e899d7189"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#adf4476a6a4ea6c74231c826e899d7189">LOG_WARNING</a></div><div class="ttdeci">#define LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00274">logger.h:274</a></div></div>
<div class="ttc" id="aoc_8h_html_a2c726e954f606dc71b37ba93be286ff9ad60d324867080b1a1ca3b13db29b27c2"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9ad60d324867080b1a1ca3b13db29b27c2">AST_AOC_CHARGE_NA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00070">aoc.h:70</a></div></div>
<div class="ttc" id="time_8h_html_a39af1febe8b93cb6f7cd59b76fc39e8f"><div class="ttname"><a href="../../de/df7/time_8h.html#a39af1febe8b93cb6f7cd59b76fc39e8f">ast_tvdiff_sec</a></div><div class="ttdeci">int64_t ast_tvdiff_sec(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in seconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00064">time.h:64</a></div></div>
<div class="ttc" id="http_8h_html_ac99d56925cf94f8cf3ed0acac52e2d75"><div class="ttname"><a href="../../dd/d56/http_8h.html#ac99d56925cf94f8cf3ed0acac52e2d75">ast_http_uri_link</a></div><div class="ttdeci">int ast_http_uri_link(struct ast_http_uri *urihandler)</div><div class="ttdoc">Register a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00673">http.c:673</a></div></div>
<div class="ttc" id="format__cap_8h_html_a035f4aa78f172a18311bfa15dd232c6f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a035f4aa78f172a18311bfa15dd232c6f">AST_FORMAT_CAP_NAMES_LEN</a></div><div class="ttdeci">#define AST_FORMAT_CAP_NAMES_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00326">format_cap.h:326</a></div></div>
<div class="ttc" id="strings_8h_html_a1ef7e2644ca7258070db316fdc0a465b"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1ef7e2644ca7258070db316fdc0a465b">ast_str_buffer</a></div><div class="ttdeci">char * ast_str_buffer(const struct ast_str *buf)</div><div class="ttdoc">Returns the string buffer within the ast_str buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00714">strings.h:714</a></div></div>
<div class="ttc" id="structpermalias_html_a86cf672daa4e0ad11ad10efc894d19c8"><div class="ttname"><a href="../../de/d4b/structpermalias.html#a86cf672daa4e0ad11ad10efc894d19c8">permalias::num</a></div><div class="ttdeci">int num</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02016">manager.c:2016</a></div></div>
<div class="ttc" id="taskprocessor_8h_html_ad4a3db2b08877779bd481a649318be7d"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html#ad4a3db2b08877779bd481a649318be7d">AST_TASKPROCESSOR_HIGH_WATER_LEVEL</a></div><div class="ttdeci">#define AST_TASKPROCESSOR_HIGH_WATER_LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1e/taskprocessor_8h_source.html#l00063">taskprocessor.h:63</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a156f09c32102fa036620ad75c3ee4fbf"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a156f09c32102fa036620ad75c3ee4fbf">d</a></div><div class="ttdeci">static struct test_val d</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00049">test_linkedlists.c:49</a></div></div>
<div class="ttc" id="structast__json__payload_html"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html">ast_json_payload</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01024">json.h:1024</a></div></div>
<div class="ttc" id="astobj2_8h_html_a47857055118a703ae87ea5ebaf4842ed"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a47857055118a703ae87ea5ebaf4842ed">ao2_callback</a></div><div class="ttdeci">#define ao2_callback(c, flags, cb_fn, arg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01716">astobj2.h:1716</a></div></div>
<div class="ttc" id="structmansession__session_html_a6bafd2f5dfdc170245b389db21bd81f8"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a6bafd2f5dfdc170245b389db21bd81f8">mansession_session::authstart</a></div><div class="ttdeci">time_t authstart</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01605">manager.c:1605</a></div></div>
<div class="ttc" id="structmanager__action_html_ab0bef752de7f442d29017ea812092d91"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#ab0bef752de7f442d29017ea812092d91">manager_action::func</a></div><div class="ttdeci">int(* func)(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00166">manager.h:166</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8d1a63cdf2c7aff22a77b6e75d93b377"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8d1a63cdf2c7aff22a77b6e75d93b377">CONFIG_STATUS_FILEINVALID</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEINVALID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00060">include/asterisk/config.h:60</a></div></div>
<div class="ttc" id="manager_8h_html_ab9bbbe9b1fbde6ccff1f0a1ec0521afd"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab9bbbe9b1fbde6ccff1f0a1ec0521afd">EVENT_FLAG_COMMAND</a></div><div class="ttdeci">#define EVENT_FLAG_COMMAND</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00075">manager.h:75</a></div></div>
<div class="ttc" id="structast__variable_html_a501b314f49b3a9ff6e7be599d94686ee"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a501b314f49b3a9ff6e7be599d94686ee">ast_variable::lineno</a></div><div class="ttdeci">int lineno</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00095">include/asterisk/config.h:95</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92a468f85e937d9a9d14172b0239d212125"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a468f85e937d9a9d14172b0239d212125">FAILURE_EMPTYCAT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01427">manager.c:1427</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga446d7b8021ecd45234cd3053734c9d53"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga446d7b8021ecd45234cd3053734c9d53">action_login</a></div><div class="ttdeci">static int action_login(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04393">manager.c:4393</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac0f21735eb8551ed24735a71ea26e13c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac0f21735eb8551ed24735a71ea26e13c">authenticate</a></div><div class="ttdeci">static int authenticate(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03505">manager.c:3505</a></div></div>
<div class="ttc" id="json_8h_html_aa4ff5e6cc56531fde9d797e439e40e28"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa4ff5e6cc56531fde9d797e439e40e28">ast_json_object_iter</a></div><div class="ttdeci">struct ast_json_iter * ast_json_object_iter(struct ast_json *object)</div><div class="ttdoc">Get an iterator pointing to the first field in a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00429">json.c:429</a></div></div>
<div class="ttc" id="logger_8h_html_a7d52159deec8b3179d27fcb4d39c30d2"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a7d52159deec8b3179d27fcb4d39c30d2">VERBOSITY_ATLEAST</a></div><div class="ttdeci">#define VERBOSITY_ATLEAST(level)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00461">logger.h:461</a></div></div>
<div class="ttc" id="structast__tcptls__session__instance_html_ac7fc8bed1104b4557f6a183ae1155b75"><div class="ttname"><a href="../../d6/d49/structast__tcptls__session__instance.html#ac7fc8bed1104b4557f6a183ae1155b75">ast_tcptls_session_instance::parent</a></div><div class="ttdeci">struct ast_tcptls_session_args * parent</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00152">tcptls.h:152</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0a3fb6c9b8db835d467df360cb34f403"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0a3fb6c9b8db835d467df360cb34f403">handle_showmanagers</a></div><div class="ttdeci">static char * handle_showmanagers(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02570">manager.c:2570</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a493b57f443cc38b3d3df9c1e584d9d82"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a493b57f443cc38b3d3df9c1e584d9d82">timeout</a></div><div class="ttdeci">static int timeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00086">cdr_mysql.c:86</a></div></div>
<div class="ttc" id="bt__open_8c_html_a1cdd2bb1a9a71d3e1120100229315d67"><div class="ttname"><a href="../../de/d1e/bt__open_8c.html#a1cdd2bb1a9a71d3e1120100229315d67">tmp</a></div><div class="ttdeci">static int tmp()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1e/bt__open_8c_source.html#l00389">bt_open.c:389</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a2e9a2518b5029b96671aff6701bd5138"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2e9a2518b5029b96671aff6701bd5138">AST_RWLIST_UNLOCK</a></div><div class="ttdeci">#define AST_RWLIST_UNLOCK(head)</div><div class="ttdoc">Attempts to unlock a read/write based list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00150">linkedlists.h:150</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a8f573b7eed021cfcb8c3e7a839c98c73"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a8f573b7eed021cfcb8c3e7a839c98c73">ast_xmldoc_build_description</a></div><div class="ttdeci">char * ast_xmldoc_build_description(const char *type, const char *name, const char *module)</div><div class="ttdoc">Generate description documentation from XML. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l02250">xmldoc.c:2250</a></div></div>
<div class="ttc" id="localtime_8h_html_ae9fbda728350a9a5b9c09b29214d718e"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#ae9fbda728350a9a5b9c09b29214d718e">ast_localtime</a></div><div class="ttdeci">struct ast_tm * ast_localtime(const struct timeval *timep, struct ast_tm *p_tm, const char *zone)</div><div class="ttdoc">Timezone-independent version of localtime_r(3). </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l01739">localtime.c:1739</a></div></div>
<div class="ttc" id="astobj2_8h_html_add41bd9979cb8642f81dd38aa2dfcd6d"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#add41bd9979cb8642f81dd38aa2dfcd6d">ao2_container_alloc_list</a></div><div class="ttdeci">#define ao2_container_alloc_list(ao2_options, container_options, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01335">astobj2.h:1335</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a22ea082c5889a8a74d1110459c372d24"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a22ea082c5889a8a74d1110459c372d24">ast_config_text_file_save2</a></div><div class="ttdeci">int ast_config_text_file_save2(const char *filename, const struct ast_config *cfg, const char *generator, uint32_t flags)</div><div class="ttdoc">Save a config text file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l02555">main/config.c:2555</a></div></div>
<div class="ttc" id="structmansession__session_html_ab825707392ccdf6562c396bf1037b7a3"><div class="ttname"><a href="../../df/d05/structmansession__session.html#ab825707392ccdf6562c396bf1037b7a3">mansession_session::last_ev</a></div><div class="ttdeci">struct eventqent * last_ev</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01603">manager.c:1603</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92ae16d79bf07a3994731f4ac1a6ece5ec8"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ae16d79bf07a3994731f4ac1a6ece5ec8">UNKNOWN_ACTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01420">manager.c:1420</a></div></div>
<div class="ttc" id="structmanager__action_html_ab1db9bdb9ca2c111e4aef51de082553e"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#ab1db9bdb9ca2c111e4aef51de082553e">manager_action::action</a></div><div class="ttdeci">const char * action</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00151">manager.h:151</a></div></div>
<div class="ttc" id="structast__state__cb__info_html_a3a7a902ef9b30b78b595eeee1485090f"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html#a3a7a902ef9b30b78b595eeee1485090f">ast_state_cb_info::reason</a></div><div class="ttdeci">enum ast_state_cb_update_reason reason</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00103">pbx.h:103</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga6756b9f30781ed8ca8ce938e49ad9d92"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga6756b9f30781ed8ca8ce938e49ad9d92">error_type</a></div><div class="ttdeci">error_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01419">manager.c:1419</a></div></div>
<div class="ttc" id="structast__aoc__unit__entry_html_a4bfea42429249a1f65204f0c0f34704a"><div class="ttname"><a href="../../df/d18/structast__aoc__unit__entry.html#a4bfea42429249a1f65204f0c0f34704a">ast_aoc_unit_entry::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00182">aoc.h:182</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a641f77c471ff127e8586247ff6c0d64c"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a641f77c471ff127e8586247ff6c0d64c">stasis_message_router_unsubscribe_and_join</a></div><div class="ttdeci">void stasis_message_router_unsubscribe_and_join(struct stasis_message_router *router)</div><div class="ttdoc">Unsubscribe the router from the upstream topic, blocking until the final message has been processed...</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00269">stasis_message_router.c:269</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gad61fbf474f2bcfc8efb7710a6d5d8bcd"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gad61fbf474f2bcfc8efb7710a6d5d8bcd">get_perm</a></div><div class="ttdeci">static int get_perm(const char *instr)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02131">manager.c:2131</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aab3eac8fa82a86a93c074deb7b77dbc9"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aab3eac8fa82a86a93c074deb7b77dbc9">ast_config_load2</a></div><div class="ttdeci">struct ast_config * ast_config_load2(const char *filename, const char *who_asked, struct ast_flags flags)</div><div class="ttdoc">Load a config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03154">main/config.c:3154</a></div></div>
<div class="ttc" id="structast__variable_html"><div class="ttname"><a href="../../dd/d02/structast__variable.html">ast_variable</a></div><div class="ttdoc">Structure for variables, used for configurations and for channel variables. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00083">include/asterisk/config.h:83</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga1f6d4d99712fba3bb1075b0984bc2731"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga1f6d4d99712fba3bb1075b0984bc2731">ast_manager_register_struct</a></div><div class="ttdeci">static int ast_manager_register_struct(struct manager_action *act)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07329">manager.c:7329</a></div></div>
<div class="ttc" id="structast__variable_html_a328cd221e75f4bd92e3ccf406f0d0441"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a328cd221e75f4bd92e3ccf406f0d0441">ast_variable::object</a></div><div class="ttdeci">int object</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00096">include/asterisk/config.h:96</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a9ead0cc806881cc3bd30af1bf0fd7935">UNKNOWN_CATEGORY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01421">manager.c:1421</a></div></div>
<div class="ttc" id="logger_8h_html_a2878d83e36d91850732bad997524e45e"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2878d83e36d91850732bad997524e45e">AST_LOG_WARNING</a></div><div class="ttdeci">#define AST_LOG_WARNING</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00279">logger.h:279</a></div></div>
<div class="ttc" id="ast__expr2f_8c_html_a1b0936415a643c88ce543099c10e0d7f"><div class="ttname"><a href="../../dc/df2/ast__expr2f_8c.html#a1b0936415a643c88ce543099c10e0d7f">var</a></div><div class="ttdeci">#define var</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/ast__expr2f_8c_source.html#l00614">ast_expr2f.c:614</a></div></div>
<div class="ttc" id="structast__json__payload_html_a9cf488298469ae63ef947653d7ff9bab"><div class="ttname"><a href="../../d9/de9/structast__json__payload.html#a9cf488298469ae63ef947653d7ff9bab">ast_json_payload::json</a></div><div class="ttdeci">struct ast_json * json</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l01025">json.h:1025</a></div></div>
<div class="ttc" id="md5_8h_html_a7132b90c03637ae151c1a8befd7989f2"><div class="ttname"><a href="../../da/db0/md5_8h.html#a7132b90c03637ae151c1a8befd7989f2">MD5Final</a></div><div class="ttdeci">void MD5Final(unsigned char digest[16], struct MD5Context *context)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6c/md5_8c_source.html#l00120">md5.c:120</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html">ast_channel_snapshot</a></div><div class="ttdoc">Structure representing a snapshot of channel state. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00145">stasis_channels.h:145</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab9ef7d18dc9c448d132687dadcdf8a01"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab9ef7d18dc9c448d132687dadcdf8a01">manager_generic_msg_cb</a></div><div class="ttdeci">static void manager_generic_msg_cb(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01869">manager.c:1869</a></div></div>
<div class="ttc" id="strings_8h_html_a271350c7540474095b75cbea17d4837a"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a271350c7540474095b75cbea17d4837a">ast_str_set_va</a></div><div class="ttdeci">int ast_str_set_va(struct ast_str **buf, ssize_t max_len, const char *fmt, va_list ap)</div><div class="ttdoc">Set a dynamic string from a va_list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00982">strings.h:982</a></div></div>
<div class="ttc" id="structstasis__subscription_html"><div class="ttname"><a href="../../d9/de4/structstasis__subscription.html">stasis_subscription</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00681">stasis.c:681</a></div></div>
<div class="ttc" id="time_8h_html_a4e7b3508884147c7991a68361ac781a2"><div class="ttname"><a href="../../de/df7/time_8h.html#a4e7b3508884147c7991a68361ac781a2">ast_tvzero</a></div><div class="ttdeci">int ast_tvzero(const struct timeval t)</div><div class="ttdoc">Returns true if the argument is 0,0. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00108">time.h:108</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga63df9fe1c4852999ab438347124a34b8"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga63df9fe1c4852999ab438347124a34b8">astman_send_list_complete_start_common</a></div><div class="ttdeci">static struct ast_str * astman_send_list_complete_start_common(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03206">manager.c:3206</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a103e76ed4bd42f776f7f260080b98b3fabc16a274124ae96d43f8e52e344292c3"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fabc16a274124ae96d43f8e52e344292c3">CONFIG_FLAG_WITHCOMMENTS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00041">include/asterisk/config.h:41</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a35376d6bf7129eb2240263c8aeccdda5"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a35376d6bf7129eb2240263c8aeccdda5">ast_xmldoc_build_documentation</a></div><div class="ttdeci">struct ao2_container * ast_xmldoc_build_documentation(const char *type)</div><div class="ttdoc">Build the documentation for a particular source type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l02653">xmldoc.c:2653</a></div></div>
<div class="ttc" id="channel_8h_html_a1d9fcff85d7adbe0bd54f88eb927998c"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1d9fcff85d7adbe0bd54f88eb927998c">ast_channel_clear_flag</a></div><div class="ttdeci">void ast_channel_clear_flag(struct ast_channel *chan, unsigned int flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l11235">channel.c:11235</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ae234825bcb65b88c0554b995ff1b8ba6"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ae234825bcb65b88c0554b995ff1b8ba6">AST_LIST_NEXT</a></div><div class="ttdeci">#define AST_LIST_NEXT(elm, field)</div><div class="ttdoc">Returns the next entry in the list after the given entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00438">linkedlists.h:438</a></div></div>
<div class="ttc" id="structstasis__topic_html"><div class="ttname"><a href="../../d9/d1d/structstasis__topic.html">stasis_topic</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00372">stasis.c:372</a></div></div>
<div class="ttc" id="acl_8h_html_a56811c70f305d0ce35d66cea9d9fca69"><div class="ttname"><a href="../../d5/d59/acl_8h.html#a56811c70f305d0ce35d66cea9d9fca69">ast_acl_output</a></div><div class="ttdeci">void ast_acl_output(int fd, struct ast_acl_list *acl, const char *prefix)</div><div class="ttdoc">output an ACL to the provided fd </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l01099">acl.c:1099</a></div></div>
<div class="ttc" id="test_8h_html"><div class="ttname"><a href="../../d2/ddc/test_8h.html">test.h</a></div><div class="ttdoc">Test Framework API. </div></div>
<div class="ttc" id="iostream_8h_html_a385d6e715173db6bc4b703afc05f45df"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#a385d6e715173db6bc4b703afc05f45df">ast_iostream_set_timeout_inactivity</a></div><div class="ttdeci">void ast_iostream_set_timeout_inactivity(struct ast_iostream *stream, int timeout)</div><div class="ttdoc">Set the iostream inactivity timeout timer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00121">iostream.c:121</a></div></div>
<div class="ttc" id="manager_8h_html_ab71472ea55b4114f460a4459e3dcd18b"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab71472ea55b4114f460a4459e3dcd18b">ast_manager_build_channel_state_string_prefix</a></div><div class="ttdeci">struct ast_str * ast_manager_build_channel_state_string_prefix(const struct ast_channel_snapshot *snapshot, const char *prefix)</div><div class="ttdoc">Generate the AMI message body from a channel snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1c/manager__channels_8c_source.html#l00487">manager_channels.c:487</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gga8e03c05d9a579130cae1af412fb6c580a711186ed6f4afa0cccc12908e40c511d"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gga8e03c05d9a579130cae1af412fb6c580a711186ed6f4afa0cccc12908e40c511d">AST_MSG_DATA_SOURCE_TYPE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d0d/message_8h_source.html#l00447">message.h:447</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a8717a951656993c40bd851ebf50f58e3a24212840b7b1b0e9c1eebc8cfd89ab3e"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a8717a951656993c40bd851ebf50f58e3a24212840b7b1b0e9c1eebc8cfd89ab3e">AST_XML_DOC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00031">xmldoc.h:31</a></div></div>
<div class="ttc" id="stasis_8h_html_a31197e193b1dfd6c122ff6d7c7f6b3fa"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a31197e193b1dfd6c122ff6d7c7f6b3fa">STASIS_MESSAGE_TYPE_CLEANUP</a></div><div class="ttdeci">#define STASIS_MESSAGE_TYPE_CLEANUP(name)</div><div class="ttdoc">Boiler-plate messaging macro for cleaning up message types. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l01523">stasis.h:1523</a></div></div>
<div class="ttc" id="structast__security__event__failed__acl_html"><div class="ttname"><a href="../../df/d53/structast__security__event__failed__acl.html">ast_security_event_failed_acl</a></div><div class="ttdoc">Checking against an IP access control list failed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00203">security_events_defs.h:203</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga03aa8a5224eadc07dddc34751e1868d0"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga03aa8a5224eadc07dddc34751e1868d0">action_createconfig</a></div><div class="ttdeci">static int action_createconfig(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04188">manager.c:4188</a></div></div>
<div class="ttc" id="http_8h_html_a33e436ed8aeb33287f1e6cb1c5288a14"><div class="ttname"><a href="../../dd/d56/http_8h.html#a33e436ed8aeb33287f1e6cb1c5288a14">ast_http_uri_unlink</a></div><div class="ttdeci">void ast_http_uri_unlink(struct ast_http_uri *urihandler)</div><div class="ttdoc">Unregister a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00705">http.c:705</a></div></div>
<div class="ttc" id="manager_8h_html_ab5db3cc603d7e798d61cb4cd94fbb4e2"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab5db3cc603d7e798d61cb4cd94fbb4e2">EVENT_FLAG_CALL</a></div><div class="ttdeci">#define EVENT_FLAG_CALL</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00072">manager.h:72</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a71745eb63dd093f560a1add3e430d2a9">CLI_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00152">cli.h:152</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac3f1c96b9a666398c7768e67346b0b87"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac3f1c96b9a666398c7768e67346b0b87">authtimeout</a></div><div class="ttdeci">static int authtimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01479">manager.c:1479</a></div></div>
<div class="ttc" id="aoc_8h_html_a33b761090d3debbfd4cdb0c800a13bb2"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a33b761090d3debbfd4cdb0c800a13bb2">ast_aoc_destroy_decoded</a></div><div class="ttdeci">void * ast_aoc_destroy_decoded(struct ast_aoc_decoded *decoded)</div><div class="ttdoc">free an ast_aoc_decoded object </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00307">aoc.c:307</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca52efdf13b66ae502e2e20a5f49f068de">OBJ_NOLOCK</a></div><div class="ttdoc">Assume that the ao2_container is already locked. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01067">astobj2.h:1067</a></div></div>
<div class="ttc" id="stasis_8h_html_a9356e8a29344ca4eac93088198ccff89"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a9356e8a29344ca4eac93088198ccff89">stasis_message_type</a></div><div class="ttdeci">struct stasis_message_type * stasis_message_type(const struct stasis_message *msg)</div><div class="ttdoc">Get the message type for a stasis_message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00187">stasis_message.c:187</a></div></div>
<div class="ttc" id="structast__assigned__ids_html"><div class="ttname"><a href="../../da/de5/structast__assigned__ids.html">ast_assigned_ids</a></div><div class="ttdoc">Structure to pass both assignedid values to channel drivers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00605">channel.h:605</a></div></div>
<div class="ttc" id="stasis_8h_html_a52b5393bef89d7781c0d039d6489de23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a52b5393bef89d7781c0d039d6489de23">stasis_subscription_set_filter</a></div><div class="ttdeci">int stasis_subscription_set_filter(struct stasis_subscription *subscription, enum stasis_subscription_message_filter filter)</div><div class="ttdoc">Set the message type filtering level on a subscription. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01079">stasis.c:1079</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae70b4c4ad5b431314ecf40d29d224eee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae70b4c4ad5b431314ecf40d29d224eee">ao2_t_global_obj_release</a></div><div class="ttdeci">#define ao2_t_global_obj_release(holder, tag)</div><div class="ttdoc">Release the ao2 object held in the global holder. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00863">astobj2.h:863</a></div></div>
<div class="ttc" id="acl_8h_html_a1d3de55deab4206400a7df534511fcf7"><div class="ttname"><a href="../../d5/d59/acl_8h.html#a1d3de55deab4206400a7df534511fcf7">ast_named_acl_change_type</a></div><div class="ttdeci">struct stasis_message_type * ast_named_acl_change_type(void)</div><div class="ttdoc">a stasis_message_type for changes against a named ACL or the set of all named ACLs ...</div></div>
<div class="ttc" id="manager_8c_html_ad998711c3c3427063219f5412858fabb"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ad998711c3c3427063219f5412858fabb">auth_manager_http_callback</a></div><div class="ttdeci">static int auth_manager_http_callback(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08501">manager.c:8501</a></div></div>
<div class="ttc" id="structast__datastore__info_html"><div class="ttname"><a href="../../d9/dfb/structast__datastore__info.html">ast_datastore_info</a></div><div class="ttdoc">Structure for a data store type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00031">datastore.h:31</a></div></div>
<div class="ttc" id="structast__msg__data_html"><div class="ttname"><a href="../../d9/d44/structast__msg__data.html">ast_msg_data</a></div><div class="ttdoc">Structure used to transport a message through the frame core. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01406">message.c:1406</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaae263799a76e54f46b173f039ee1053d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaae263799a76e54f46b173f039ee1053d">command_blacklist</a></div><div class="ttdeci">static const struct @407 command_blacklist[]</div></div>
<div class="ttc" id="term_8h_html_a3a3cbec50cdddbfe0a99732d55fc147d"><div class="ttname"><a href="../../db/d45/term_8h.html#a3a3cbec50cdddbfe0a99732d55fc147d">term_strip</a></div><div class="ttdeci">char * term_strip(char *outbuf, const char *inbuf, int maxout)</div><div class="ttdoc">Remove colorings from a specified string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de5/term_8c_source.html#l00311">term.c:311</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad60d9d8c34b4f61493c1d85ae02d569fadba5c0b0122c30502fe469a55fea3c4b"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fadba5c0b0122c30502fe469a55fea3c4b">PARSE_UINT32</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01087">include/asterisk/config.h:1087</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6db9934459f5cdc95cb3af77d55d426e"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6db9934459f5cdc95cb3af77d55d426e">ao2_t_link</a></div><div class="ttdeci">#define ao2_t_link(container, obj, tag)</div><div class="ttdoc">Add an object to a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01547">astobj2.h:1547</a></div></div>
<div class="ttc" id="manager_8h_html_a6307f76e83767cdcd6b618dfbd214526"><div class="ttname"><a href="../../db/d45/manager_8h.html#a6307f76e83767cdcd6b618dfbd214526">EVENT_FLAG_DTMF</a></div><div class="ttdeci">#define EVENT_FLAG_DTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00079">manager.h:79</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa6a02209ea6747897dfd5249fe631105"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa6a02209ea6747897dfd5249fe631105">report_req_not_allowed</a></div><div class="ttdeci">static void report_req_not_allowed(const struct mansession *s, const char *action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03385">manager.c:3385</a></div></div>
<div class="ttc" id="structast__party__name_html_ab50d783982593ef993ea0b68f7ad8b80"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#ab50d783982593ef993ea0b68f7ad8b80">ast_party_name::str</a></div><div class="ttdeci">char * str</div><div class="ttdoc">Subscriber name (Malloced) </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00265">channel.h:265</a></div></div>
<div class="ttc" id="channel_8h_html_aa8c3522af1bc639cbd5b38f5fdf171fa"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa8c3522af1bc639cbd5b38f5fdf171fa">ast_indicate_data</a></div><div class="ttdeci">int ast_indicate_data(struct ast_channel *chan, int condition, const void *data, size_t datalen)</div><div class="ttdoc">Indicates condition of channel, with payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l04698">channel.c:4698</a></div></div>
<div class="ttc" id="logger_8h_html_a146a5fbbca2bf36ef41ec3170e7ca7af"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a146a5fbbca2bf36ef41ec3170e7ca7af">ast_logger_rotate</a></div><div class="ttdeci">int ast_logger_rotate(void)</div><div class="ttdoc">Reload logger while rotating log files. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d22/logger_8c_source.html#l01254">logger.c:1254</a></div></div>
<div class="ttc" id="iostream_8h_html_a5dd1ed6f7ebb56180cc9f953db97f0fd"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#a5dd1ed6f7ebb56180cc9f953db97f0fd">ast_iostream_from_fd</a></div><div class="ttdeci">struct ast_iostream * ast_iostream_from_fd(int *fd)</div><div class="ttdoc">Create an iostream from a file descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00604">iostream.c:604</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga7c11fab0bce951155235b8e7a2013e1d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga7c11fab0bce951155235b8e7a2013e1d">manager_moduleload</a></div><div class="ttdeci">static int manager_moduleload(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06505">manager.c:6505</a></div></div>
<div class="ttc" id="structevent_html"><div class="ttname"><a href="../../df/d7d/structevent.html">event</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00222">astman.c:222</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab68a64554e2df0f2d926faf603848aed"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab68a64554e2df0f2d926faf603848aed">report_session_limit</a></div><div class="ttdeci">static void report_session_limit(const struct mansession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03473">manager.c:3473</a></div></div>
<div class="ttc" id="app__adsiprog_8c_html_a1fcc0891a0631f9a9222fdf961bd79dc"><div class="ttname"><a href="../../db/d62/app__adsiprog_8c.html#a1fcc0891a0631f9a9222fdf961bd79dc">events</a></div><div class="ttdeci">static const struct adsi_event events[]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d62/app__adsiprog_8c_source.html#l00085">app_adsiprog.c:85</a></div></div>
<div class="ttc" id="structast__category_html_aead9e40ff1500d1b7cafee63463122ed"><div class="ttname"><a href="../../d7/db2/structast__category.html#aead9e40ff1500d1b7cafee63463122ed">ast_category::prev</a></div><div class="ttdeci">struct ast_category * prev</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00244">main/config.c:244</a></div></div>
<div class="ttc" id="structast__security__event__inval__acct__id_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../dd/dc8/structast__security__event__inval__acct__id.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_inval_acct_id::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00234">security_events_defs.h:234</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5ceffcba60b4100c02c4700be76161e4"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5ceffcba60b4100c02c4700be76161e4">astman_send_response_full</a></div><div class="ttdeci">static void astman_send_response_full(struct mansession *s, const struct message *m, char *resp, char *msg, char *listflag)</div><div class="ttdoc">send a response with an optional message, and terminate it with an empty line. m is used only to grab...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03123">manager.c:3123</a></div></div>
<div class="ttc" id="structast__state__cb__info_html"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html">ast_state_cb_info</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00102">pbx.h:102</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a6b0053a1a47d100ef5f155f068c08934">AST_BRIDGE_TRANSFER_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01117">bridge.h:1117</a></div></div>
<div class="ttc" id="structstasis__message_html"><div class="ttname"><a href="../../d7/d55/structstasis__message.html">stasis_message</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00121">stasis_message.c:121</a></div></div>
<div class="ttc" id="strings_8h_html_a1088afdd862a49b0fce34ebe02df8ca1"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a1088afdd862a49b0fce34ebe02df8ca1">ast_str_append</a></div><div class="ttdeci">int ast_str_append(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Append to a thread local dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01091">strings.h:1091</a></div></div>
<div class="ttc" id="cli_8h_html_aea8910ed9e301e7f741f87942c244eac"><div class="ttname"><a href="../../dc/db0/cli_8h.html#aea8910ed9e301e7f741f87942c244eac">ast_cli_register_multiple</a></div><div class="ttdeci">#define ast_cli_register_multiple(e, len)</div><div class="ttdoc">Register multiple commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00265">cli.h:265</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga8fdf554febcd2f092aca41a377e4a60b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga8fdf554febcd2f092aca41a377e4a60b">action_aocmessage</a></div><div class="ttdeci">static int action_aocmessage(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05518">manager.c:5518</a></div></div>
<div class="ttc" id="structmansession__session_html_a006a09ed1c51271c4b6f582a2a42ba5f"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a006a09ed1c51271c4b6f582a2a42ba5f">mansession_session::writeperm</a></div><div class="ttdeci">int writeperm</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01596">manager.c:1596</a></div></div>
<div class="ttc" id="test__config_8c_html_aecdc7cbd5dfa76493c0212caa55d706c"><div class="ttname"><a href="../../d8/d4f/test__config_8c.html#aecdc7cbd5dfa76493c0212caa55d706c">item</a></div><div class="ttdeci">static struct aco_type item</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d4f/test__config_8c_source.html#l01463">test_config.c:1463</a></div></div>
<div class="ttc" id="astobj2_8h_html_a86d8d6c3c8866ed0a60121da055cd225"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a86d8d6c3c8866ed0a60121da055cd225">ao2_global_obj_ref</a></div><div class="ttdeci">#define ao2_global_obj_ref(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00925">astobj2.h:925</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad36841ab6daa3997f7ca7047ad2d033a"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad36841ab6daa3997f7ca7047ad2d033a">ao2_iterator_destroy</a></div><div class="ttdeci">void ao2_iterator_destroy(struct ao2_iterator *iter)</div><div class="ttdoc">Destroy a container iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00534">astobj2_container.c:534</a></div></div>
<div class="ttc" id="structast__security__event__chal__resp__failed_html_a3002c92aebac5e2755282e16b2d6e01a"><div class="ttname"><a href="../../d3/d5a/structast__security__event__chal__resp__failed.html#a3002c92aebac5e2755282e16b2d6e01a">ast_security_event_chal_resp_failed::response</a></div><div class="ttdeci">const char * response</div><div class="ttdoc">Response received. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00444">security_events_defs.h:444</a></div></div>
<div class="ttc" id="manager_8h_html_af805764035071e210ec71c41a3a1ae6c"><div class="ttname"><a href="../../db/d45/manager_8h.html#af805764035071e210ec71c41a3a1ae6c">EVENT_FLAG_LOG</a></div><div class="ttdeci">#define EVENT_FLAG_LOG</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00073">manager.h:73</a></div></div>
<div class="ttc" id="manager_8h_html_a4fcf0d018dc49622b436a2ae857ea3da"><div class="ttname"><a href="../../db/d45/manager_8h.html#a4fcf0d018dc49622b436a2ae857ea3da">EVENT_FLAG_TEST</a></div><div class="ttdeci">#define EVENT_FLAG_TEST</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00088">manager.h:88</a></div></div>
<div class="ttc" id="iostream_8h_html_a6ebb2730257107d3535fe6cb1285f479"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#a6ebb2730257107d3535fe6cb1285f479">ast_iostream_get_fd</a></div><div class="ttdeci">int ast_iostream_get_fd(struct ast_iostream *stream)</div><div class="ttdoc">Get an iostream&amp;#39;s file descriptor. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00084">iostream.c:84</a></div></div>
<div class="ttc" id="app__voicemail_8c_html_abe15777a07ac747625b018ac01f92531"><div class="ttname"><a href="../../dc/df4/app__voicemail_8c.html#abe15777a07ac747625b018ac01f92531">copy</a></div><div class="ttdeci">static int copy(char *infile, char *outfile)</div><div class="ttdoc">Utility function to copy a file. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df4/app__voicemail_8c_source.html#l04629">app_voicemail.c:4629</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab2b9c596c9d6eb5dac8fe5f3d7588f50"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab2b9c596c9d6eb5dac8fe5f3d7588f50">process_events</a></div><div class="ttdeci">static int process_events(struct mansession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06227">manager.c:6227</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga22cac49ed9e48c4bed52477e6334278e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga22cac49ed9e48c4bed52477e6334278e">action_getconfigjson</a></div><div class="ttdeci">static int action_getconfigjson(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03750">manager.c:3750</a></div></div>
<div class="ttc" id="manager_8h_html_ad145ac7178d92461a0be448d183a037c"><div class="ttname"><a href="../../db/d45/manager_8h.html#ad145ac7178d92461a0be448d183a037c">EVENT_FLAG_AOC</a></div><div class="ttdeci">#define EVENT_FLAG_AOC</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00087">manager.h:87</a></div></div>
<div class="ttc" id="time_8h_html_ad3899efb6f0e348556ef69f5b16aa7f7"><div class="ttname"><a href="../../de/df7/time_8h.html#ad3899efb6f0e348556ef69f5b16aa7f7">ast_tvnow</a></div><div class="ttdeci">struct timeval ast_tvnow(void)</div><div class="ttdoc">Returns current timeval. Meant to replace calls to gettimeofday(). </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00150">time.h:150</a></div></div>
<div class="ttc" id="stringfields_8h_html_a061580e89c55282a7140fa3fdfd52b6d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a061580e89c55282a7140fa3fdfd52b6d">AST_DECLARE_STRING_FIELDS</a></div><div class="ttdeci">#define AST_DECLARE_STRING_FIELDS(field_list)</div><div class="ttdoc">Declare the fields needed in a structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00337">stringfields.h:337</a></div></div>
<div class="ttc" id="structmansession__session_html_a29e86d0f6d62ef1edac10a46e4c92095"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a29e86d0f6d62ef1edac10a46e4c92095">mansession_session::authenticated</a></div><div class="ttdeci">int authenticated</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01594">manager.c:1594</a></div></div>
<div class="ttc" id="stasis_8h_html_a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5ae672fb0f772d0e3066fa4c29c41814a595ad92c7a80903c8a6f63a69d50c98d">STASIS_SUBSCRIPTION_FORMATTER_AMI</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00314">stasis.h:314</a></div></div>
<div class="ttc" id="structast__tcptls__session__args_html"><div class="ttname"><a href="../../da/d2b/structast__tcptls__session__args.html">ast_tcptls_session_args</a></div><div class="ttdoc">arguments for the accepting thread </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00129">tcptls.h:129</a></div></div>
<div class="ttc" id="manager_8c_html_a8a69ab89502cc10c5d0890aba4876797"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a8a69ab89502cc10c5d0890aba4876797">handle_manager_show_settings</a></div><div class="ttdeci">static char * handle_manager_show_settings(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdoc">CLI command manager show settings. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08664">manager.c:8664</a></div></div>
<div class="ttc" id="structast__assigned__ids_html_af8e97b5c2410839d9826f15f83ac4aa2"><div class="ttname"><a href="../../da/de5/structast__assigned__ids.html#af8e97b5c2410839d9826f15f83ac4aa2">ast_assigned_ids::uniqueid</a></div><div class="ttdeci">const char * uniqueid</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00606">channel.h:606</a></div></div>
<div class="ttc" id="structast__acl__list_html"><div class="ttname"><a href="../../d3/da4/structast__acl__list.html">ast_acl_list</a></div><div class="ttdoc">Wrapper for an ast_acl linked list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d59/acl_8h_source.html#l00076">acl.h:76</a></div></div>
<div class="ttc" id="structmansession__session_html_a7da79056532998c4e37002ac8d9728a6"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a7da79056532998c4e37002ac8d9728a6">mansession_session::inlen</a></div><div class="ttdeci">int inlen</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01598">manager.c:1598</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab3c44e28d661616129b7819069effe61"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab3c44e28d661616129b7819069effe61">ao2_alloc_options</a></div><div class="ttdeci">#define ao2_alloc_options(data_size, destructor_fn, options)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00406">astobj2.h:406</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="lock_8h_html_ac5e13c7fe64d3b271a52028b0a78b92b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ac5e13c7fe64d3b271a52028b0a78b92b">ast_mutex_lock</a></div><div class="ttdeci">#define ast_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00187">lock.h:187</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga77315fa8e29950f0c88120501acda0a3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga77315fa8e29950f0c88120501acda0a3">astman_send_ack</a></div><div class="ttdeci">void astman_send_ack(struct mansession *s, const struct message *m, char *msg)</div><div class="ttdoc">Send ack in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03191">manager.c:3191</a></div></div>
<div class="ttc" id="group__main__options_html_ga908239c63cc433cbefa4aa6f5efcb830"><div class="ttname"><a href="../../d6/dd6/group__main__options.html#ga908239c63cc433cbefa4aa6f5efcb830">ast_option_maxload</a></div><div class="ttdeci">double ast_option_maxload</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00077">options.c:77</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089a27a0c84a4d31cb0060200d36100c1c75"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a27a0c84a4d31cb0060200d36100c1c75">AST_AOC_MULT_HUNDRED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00040">aoc.h:40</a></div></div>
<div class="ttc" id="astobj2_8h_html_a9998bd156b936636a8780385e9a910b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a9998bd156b936636a8780385e9a910b2">ao2_unlock</a></div><div class="ttdeci">#define ao2_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00730">astobj2.h:730</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_acd9db00336027462cfb25b97b5356883"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#acd9db00336027462cfb25b97b5356883">c</a></div><div class="ttdeci">static struct test_val c</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00048">test_linkedlists.c:48</a></div></div>
<div class="ttc" id="structmansession_html_adf04f66344e3fb0a6f6a69bf39d19902"><div class="ttname"><a href="../../d2/d8a/structmansession.html#adf04f66344e3fb0a6f6a69bf39d19902">mansession::lock</a></div><div class="ttdeci">ast_mutex_t lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01632">manager.c:1632</a></div></div>
<div class="ttc" id="paths_8h_html_a37ae09a4cc0e3b46e7b2a2052bde4965"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a37ae09a4cc0e3b46e7b2a2052bde4965">ast_config_AST_RUN_USER</a></div><div class="ttdeci">const char * ast_config_AST_RUN_USER</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00168">options.c:168</a></div></div>
<div class="ttc" id="structchannel_html"><div class="ttname"><a href="../../d4/d84/structchannel.html">channel</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d8a/muted_8c_source.html#l00095">muted.c:95</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga57cc8b67a0e4797ab1a608872d51d397"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga57cc8b67a0e4797ab1a608872d51d397">authority_to_str</a></div><div class="ttdeci">static const char * authority_to_str(int authority, struct ast_str **res)</div><div class="ttdoc">Convert authority code to a list of options. Note that the EVENT_FLAG_ALL authority will always be re...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02084">manager.c:2084</a></div></div>
<div class="ttc" id="chan__iax2_8c_html_a7dd0190efe1c61151a9dbab078bdb263"><div class="ttname"><a href="../../d5/dff/chan__iax2_8c.html#a7dd0190efe1c61151a9dbab078bdb263">match</a></div><div class="ttdeci">static int match(struct ast_sockaddr *addr, unsigned short callno, unsigned short dcallno, const struct chan_iax2_pvt *cur, int check_dcallno)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dff/chan__iax2_8c_source.html#l02315">chan_iax2.c:2315</a></div></div>
<div class="ttc" id="strings_8h_html_a7fc844c12b769ccded05e7514036e241"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a7fc844c12b769ccded05e7514036e241">ast_str_alloca</a></div><div class="ttdeci">#define ast_str_alloca(init_len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00800">strings.h:800</a></div></div>
<div class="ttc" id="structast__http__digest_html_a5804ef809b93820d3437a86e08126bd8"><div class="ttname"><a href="../../da/db3/structast__http__digest.html#a5804ef809b93820d3437a86e08126bd8">ast_http_digest::username</a></div><div class="ttdeci">const ast_string_field username</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00672">utils.h:672</a></div></div>
<div class="ttc" id="format_8h_html_a082f0fca94b18ba466f6e28d3ccb2fc8"><div class="ttname"><a href="../../d0/d0a/format_8h.html#a082f0fca94b18ba466f6e28d3ccb2fc8">ast_format_get_name</a></div><div class="ttdeci">const char * ast_format_get_name(const struct ast_format *format)</div><div class="ttdoc">Get the name associated with a format. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/da6/format_8c_source.html#l00334">format.c:334</a></div></div>
<div class="ttc" id="time_8h_html_aca4ecdab7d8d3519062aad9a90fcb29d"><div class="ttname"><a href="../../de/df7/time_8h.html#aca4ecdab7d8d3519062aad9a90fcb29d">ast_tvdiff_ms</a></div><div class="ttdeci">int64_t ast_tvdiff_ms(struct timeval end, struct timeval start)</div><div class="ttdoc">Computes the difference (in milliseconds) between two struct timeval instances. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/df7/time_8h_source.html#l00098">time.h:98</a></div></div>
<div class="ttc" id="http_8h_html_aa62626630003222102b29b97f18ff94c"><div class="ttname"><a href="../../dd/d56/http_8h.html#aa62626630003222102b29b97f18ff94c">ast_http_manid_from_vars</a></div><div class="ttdeci">uint32_t ast_http_manid_from_vars(struct ast_variable *headers) attribute_pure</div><div class="ttdoc">Return manager id, if exist, from request headers. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00217">http.c:217</a></div></div>
<div class="ttc" id="extconf_8c_html_a81d26348827b996085d4cb6be3e2c348"><div class="ttname"><a href="../../d4/dc5/extconf_8c.html#a81d26348827b996085d4cb6be3e2c348">ast_verbose</a></div><div class="ttdeci">void ast_verbose(const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02207">extconf.c:2207</a></div></div>
<div class="ttc" id="structast__security__event__chal__resp__failed_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../d3/d5a/structast__security__event__chal__resp__failed.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_chal_resp_failed::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00434">security_events_defs.h:434</a></div></div>
<div class="ttc" id="network_8h_html_afd80ecbe3170ca4fc85b65cda8659f82"><div class="ttname"><a href="../../d9/d94/network_8h.html#afd80ecbe3170ca4fc85b65cda8659f82">MAXHOSTNAMELEN</a></div><div class="ttdeci">#define MAXHOSTNAMELEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d94/network_8h_source.html#l00069">network.h:69</a></div></div>
<div class="ttc" id="astmm_8h_html_ab263849d03fb892847be4986db759737"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab263849d03fb892847be4986db759737">ast_strdup</a></div><div class="ttdeci">#define ast_strdup(str)</div><div class="ttdoc">A wrapper for strdup() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00243">astmm.h:243</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a75382dc9117cc118719edf6c3d2b71df">CMP_STOP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01032">astobj2.h:1032</a></div></div>
<div class="ttc" id="structast__datastore_html"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html">ast_datastore</a></div><div class="ttdoc">Structure for a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00068">datastore.h:68</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca90d668ad235bcb611b3f5a7143675f7e"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca90d668ad235bcb611b3f5a7143675f7e">AST_SECURITY_EVENT_REQ_NOT_ALLOWED</a></div><div class="ttdoc">A request was made that is not allowed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00085">security_events_defs.h:85</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gadc51d8d2531d72d735b5f270db27de72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gadc51d8d2531d72d735b5f270db27de72">queue_sendtext</a></div><div class="ttdeci">static int queue_sendtext(struct ast_channel *chan, const char *body)</div><div class="ttdoc">Queue a read action to send a text message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04896">manager.c:4896</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089">ast_aoc_currency_multiplier</a></div><div class="ttdeci">ast_aoc_currency_multiplier</div><div class="ttdoc">Defines the currency multiplier for an aoc message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00034">aoc.h:34</a></div></div>
<div class="ttc" id="app__jack_8c_html_af25d6dc49269fa2003ac7c7fa6f13915"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#af25d6dc49269fa2003ac7c7fa6f13915">str</a></div><div class="ttdeci">const char * str</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00147">app_jack.c:147</a></div></div>
<div class="ttc" id="channel_8h_html_add6255866ea1651a90cf70d963c4920a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#add6255866ea1651a90cf70d963c4920a">ast_channel_varshead</a></div><div class="ttdeci">struct varshead * ast_channel_varshead(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00932">channel_internal_api.c:932</a></div></div>
<div class="ttc" id="structmansession__session_html_a10838452c09fae7f0e3de86581d85379"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a10838452c09fae7f0e3de86581d85379">mansession_session::addr</a></div><div class="ttdeci">struct ast_sockaddr addr</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01583">manager.c:1583</a></div></div>
<div class="ttc" id="file_8h_html"><div class="ttname"><a href="../../d2/d4d/file_8h.html">file.h</a></div><div class="ttdoc">Generic File Format Support. Should be included by clients of the file handling routines. File service providers should instead include mod_format.h. </div></div>
<div class="ttc" id="group__Group__AMI_html_ga6d2190ae1fcb37e66c2a445f2fe59ec3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga6d2190ae1fcb37e66c2a445f2fe59ec3">session_destructor</a></div><div class="ttdeci">static void session_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02198">manager.c:2198</a></div></div>
<div class="ttc" id="structast__security__event__req__bad__format_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../d1/dc1/structast__security__event__req__bad__format.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_req_bad_format::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00366">security_events_defs.h:366</a></div></div>
<div class="ttc" id="manager_8c_html_aec783e82aaec02c089ae933a8fa3688e"><div class="ttname"><a href="../../d4/d10/manager_8c.html#aec783e82aaec02c089ae933a8fa3688e">contenttype</a></div><div class="ttdeci">static const char *const contenttype[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07468">manager.c:7468</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a1e5e3d08eff5e2357e75c01e127e7922"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a1e5e3d08eff5e2357e75c01e127e7922">ast_category_browse</a></div><div class="ttdeci">char * ast_category_browse(struct ast_config *config, const char *prev_name)</div><div class="ttdoc">Browse categories. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l03328">extconf.c:3328</a></div></div>
<div class="ttc" id="test__func__file_8c_html_a7df83d295429a2562396f1ec127a46c0"><div class="ttname"><a href="../../d5/dde/test__func__file_8c.html#a7df83d295429a2562396f1ec127a46c0">args</a></div><div class="ttdeci">const char * args</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dde/test__func__file_8c_source.html#l00046">test_func_file.c:46</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaacec20eeac5fcdb47de6e5f98bab33df"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaacec20eeac5fcdb47de6e5f98bab33df">MAX_BLACKLIST_CMD_LEN</a></div><div class="ttdeci">#define MAX_BLACKLIST_CMD_LEN</div><div class="ttdoc">Descriptor for a manager session, either on the AMI socket or over HTTP. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01523">manager.c:1523</a></div></div>
<div class="ttc" id="manager_8c_html_a2ac502bd95ead52fb558fe72c16fc2e8"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a2ac502bd95ead52fb558fe72c16fc2e8">ami_desc</a></div><div class="ttdeci">static struct ast_tcptls_session_args ami_desc</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08642">manager.c:8642</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga83162fffa402098460159beae8406122"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga83162fffa402098460159beae8406122">report_failed_challenge_response</a></div><div class="ttdeci">static void report_failed_challenge_response(const struct mansession *s, const char *response, const char *expected_response)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03443">manager.c:3443</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaf5f8f8fba6bc87e2788f8075148eb3ed"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaf5f8f8fba6bc87e2788f8075148eb3ed">MANAGER_EVENT_BUF_INITSIZE</a></div><div class="ttdeci">#define MANAGER_EVENT_BUF_INITSIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07110">manager.c:7110</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gadeff73697d2789905f4c3a21671ef6d3"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gadeff73697d2789905f4c3a21671ef6d3">manager_topic</a></div><div class="ttdeci">static struct stasis_topic * manager_topic</div><div class="ttdoc">A stasis_topic that all topics AMI cares about will be forwarded to. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01490">manager.c:1490</a></div></div>
<div class="ttc" id="structast__manager__user_html"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html">ast_manager_user</a></div><div class="ttdoc">user descriptor, as read from the config file. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01644">manager.c:1644</a></div></div>
<div class="ttc" id="app__voicemail_8c_html_ac70fbae4ed48b5b48ff4b49f01e29f86"><div class="ttname"><a href="../../dc/df4/app__voicemail_8c.html#ac70fbae4ed48b5b48ff4b49f01e29f86">inbuf</a></div><div class="ttdeci">static int inbuf(struct baseio *bio, FILE *fi)</div><div class="ttdoc">utility used by inchar(), for base_encode() </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df4/app__voicemail_8c_source.html#l04770">app_voicemail.c:4770</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_ae558fc61c9cbf70fb44ec3fef6136129"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#ae558fc61c9cbf70fb44ec3fef6136129">fast_originate_helper::early_media</a></div><div class="ttdeci">int early_media</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05378">manager.c:5378</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab771766124f3d865c0f312bd0957bc5f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab771766124f3d865c0f312bd0957bc5f">unauth_sessions</a></div><div class="ttdeci">static int unauth_sessions</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01486">manager.c:1486</a></div></div>
<div class="ttc" id="json_8h_html_afc96871ba6bc2669c1da4b313dd4a812"><div class="ttname"><a href="../../d4/d05/json_8h.html#afc96871ba6bc2669c1da4b313dd4a812">ast_json_is_null</a></div><div class="ttdeci">int ast_json_is_null(const struct ast_json *value)</div><div class="ttdoc">Check if value is JSON null. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00263">json.c:263</a></div></div>
<div class="ttc" id="threadstorage_8h_html"><div class="ttname"><a href="../../dc/d7d/threadstorage_8h.html">threadstorage.h</a></div><div class="ttdoc">Definitions to aid in the use of thread local storage. </div></div>
<div class="ttc" id="group__Group__AMI_html_ga1c6842f7ec1925c46db96beaaf8d24b1"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga1c6842f7ec1925c46db96beaaf8d24b1">action_sendtext</a></div><div class="ttdeci">static int action_sendtext(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04930">manager.c:4930</a></div></div>
<div class="ttc" id="manager_8h_html_a1d34461b8a3210b19e66f06bcdebfeb3"><div class="ttname"><a href="../../db/d45/manager_8h.html#a1d34461b8a3210b19e66f06bcdebfeb3">ast_manager_register_xml_core</a></div><div class="ttdeci">#define ast_manager_register_xml_core(action, authority, func)</div><div class="ttdoc">Register a manager callback using XML documentation to describe the manager. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00197">manager.h:197</a></div></div>
<div class="ttc" id="structmanager__action_html_ad620e07ef3ac6fbeb23e5d2ec0484e1d"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#ad620e07ef3ac6fbeb23e5d2ec0484e1d">manager_action::list_responses</a></div><div class="ttdeci">struct ast_xml_doc_item * list_responses</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00160">manager.h:160</a></div></div>
<div class="ttc" id="message_8h_html"><div class="ttname"><a href="../../d2/d0d/message_8h.html">message.h</a></div><div class="ttdoc">Out-of-call text message support. </div></div>
<div class="ttc" id="manager_8h_html_ae9fafdea9f9e226539b8a9a291079e3d"><div class="ttname"><a href="../../db/d45/manager_8h.html#ae9fafdea9f9e226539b8a9a291079e3d">EVENT_FLAG_CC</a></div><div class="ttdeci">#define EVENT_FLAG_CC</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00086">manager.h:86</a></div></div>
<div class="ttc" id="xmldoc_8h_html_ada5725df0394b62d812bc36d3471b702"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#ada5725df0394b62d812bc36d3471b702">ast_xmldoc_build_synopsis</a></div><div class="ttdeci">char * ast_xmldoc_build_synopsis(const char *type, const char *name, const char *module)</div><div class="ttdoc">Generate synopsis documentation from XML. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l02227">xmldoc.c:2227</a></div></div>
<div class="ttc" id="syslog_8c_html_ac4f474c82e82cbb89ca7c36dd52be0ed"><div class="ttname"><a href="../../d4/d2f/syslog_8c.html#ac4f474c82e82cbb89ca7c36dd52be0ed">value</a></div><div class="ttdeci">int value</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d2f/syslog_8c_source.html#l00037">syslog.c:37</a></div></div>
<div class="ttc" id="tcptls_8h_html"><div class="ttname"><a href="../../d4/ddf/tcptls_8h.html">tcptls.h</a></div><div class="ttdoc">Generic support for tcp/tls servers in Asterisk. </div></div>
<div class="ttc" id="cli_8h_html_a791bf9f5637185bee5e8f0907c762130"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a791bf9f5637185bee5e8f0907c762130">ast_cli</a></div><div class="ttdeci">void ast_cli(int fd, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00006">clicompat.c:6</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga06f17abfc5db7b42743338b9cb73405e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga06f17abfc5db7b42743338b9cb73405e">__ast_manager_event_multichan</a></div><div class="ttdeci">int __ast_manager_event_multichan(int category, const char *event, int chancount, struct ast_channel **chans, const char *file, int line, const char *func, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07233">manager.c:7233</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a970f3be80cbd08a1591eb8588f3cd54b"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a970f3be80cbd08a1591eb8588f3cd54b">fast_originate_helper::cap</a></div><div class="ttdeci">struct ast_format_cap * cap</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05377">manager.c:5377</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa36e72b77f1b80881cd0a9fcca66ce19"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa36e72b77f1b80881cd0a9fcca66ce19">AST_LIST_REMOVE</a></div><div class="ttdeci">#define AST_LIST_REMOVE(head, elm, field)</div><div class="ttdoc">Removes a specific entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00855">linkedlists.h:855</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a248afd6c02044259a386f6b7aee922a2"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a248afd6c02044259a386f6b7aee922a2">AST_FRAME_DTMF</a></div><div class="ttdeci">#define AST_FRAME_DTMF</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00139">include/asterisk/frame.h:139</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_adc105808e97bd06ee0b39375c6c2a137"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#adc105808e97bd06ee0b39375c6c2a137">AST_SECURITY_EVENT_SUCCESSFUL_AUTH_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_SUCCESSFUL_AUTH_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00387">security_events_defs.h:387</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a94ba5ab9fffe6dd755ee95db7ff2432f"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a94ba5ab9fffe6dd755ee95db7ff2432f">ast_category_destroy</a></div><div class="ttdeci">void ast_category_destroy(struct ast_category *cat)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02847">extconf.c:2847</a></div></div>
<div class="ttc" id="pbx_8h_html_a6c3a35983760904213206a8f0a7df9c9"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6c3a35983760904213206a8f0a7df9c9">ast_pbx_outgoing_exten</a></div><div class="ttdeci">int ast_pbx_outgoing_exten(const char *type, struct ast_format_cap *cap, const char *addr, int timeout, const char *context, const char *exten, int priority, int *reason, int synchronous, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **locked_channel, int early_media, const struct ast_assigned_ids *assignedids)</div><div class="ttdoc">Synchronously or asynchronously make an outbound call and send it to a particular extension...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l07951">pbx.c:7951</a></div></div>
<div class="ttc" id="structmansession__session_html_ab5e2ca60735be55e922d5b24f3f83133"><div class="ttname"><a href="../../df/d05/structmansession__session.html#ab5e2ca60735be55e922d5b24f3f83133">mansession_session::blackfilters</a></div><div class="ttdeci">struct ao2_container * blackfilters</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01600">manager.c:1600</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab220bef102a1bf6e96a407d3a5a3e161"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab220bef102a1bf6e96a407d3a5a3e161">ast_manager_register2</a></div><div class="ttdeci">int ast_manager_register2(const char *action, int auth, int(*func)(struct mansession *s, const struct message *m), struct ast_module *module, const char *synopsis, const char *description)</div><div class="ttdoc">register a new command with manager, including online help. This is the preferred way to register a m...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07386">manager.c:7386</a></div></div>
<div class="ttc" id="structusers_html"><div class="ttname"><a href="../../d8/d63/structusers.html">users</a></div><div class="ttdoc">list of users found in the config file </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df4/app__voicemail_8c_source.html#l00915">app_voicemail.c:915</a></div></div>
<div class="ttc" id="aoc_8h_html_aed3fe8e8d708e8aff42a2ad205813cb7"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#aed3fe8e8d708e8aff42a2ad205813cb7">ast_aoc_total_type</a></div><div class="ttdeci">ast_aoc_total_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00082">aoc.h:82</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gae456544c8bf8d684b871f41851f8eab1"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gae456544c8bf8d684b871f41851f8eab1">append_event</a></div><div class="ttdeci">static int append_event(const char *str, int category)</div><div class="ttdoc">events are appended to a queue from where they can be dispatched to clients. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07068">manager.c:7068</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089a865002098f4bc4e8e711bd3d2450f6bf"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a865002098f4bc4e8e711bd3d2450f6bf">AST_AOC_MULT_ONETHOUSANDTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00035">aoc.h:35</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2dfc6e6a7c0200c34dbbc6021f10c649"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2dfc6e6a7c0200c34dbbc6021f10c649">action_atxfer</a></div><div class="ttdeci">static int action_atxfer(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05164">manager.c:5164</a></div></div>
<div class="ttc" id="cdr__beanstalkd_8c_html_acec9ce2df15222151ad66fcb1d74eb9f"><div class="ttname"><a href="../../d9/d47/cdr__beanstalkd_8c.html#acec9ce2df15222151ad66fcb1d74eb9f">priority</a></div><div class="ttdeci">static int priority</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d47/cdr__beanstalkd_8c_source.html#l00076">cdr_beanstalkd.c:76</a></div></div>
<div class="ttc" id="manager_8h_html_a3f283471be8718fc0239c7441d640a5a"><div class="ttname"><a href="../../db/d45/manager_8h.html#a3f283471be8718fc0239c7441d640a5a">manager_bridging_init</a></div><div class="ttdeci">int manager_bridging_init(void)</div><div class="ttdoc">Initialize support for AMI channel events. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d10/manager__bridges_8c_source.html#l00681">manager_bridges.c:681</a></div></div>
<div class="ttc" id="manager_8h_html_ad602e069591b527f28e36dd472425e7e"><div class="ttname"><a href="../../db/d45/manager_8h.html#ad602e069591b527f28e36dd472425e7e">EVENT_FLAG_DIALPLAN</a></div><div class="ttdeci">#define EVENT_FLAG_DIALPLAN</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00082">manager.h:82</a></div></div>
<div class="ttc" id="structmansession__session_html_afaabb85e65efc5fed1a5f4d08bf272a4"><div class="ttname"><a href="../../df/d05/structmansession__session.html#afaabb85e65efc5fed1a5f4d08bf272a4">mansession_session::readperm</a></div><div class="ttdeci">int readperm</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01595">manager.c:1595</a></div></div>
<div class="ttc" id="manager_8c_html_aa40b9899223e9b2edf58a6fa17d53de4"><div class="ttname"><a href="../../d4/d10/manager_8c.html#aa40b9899223e9b2edf58a6fa17d53de4">rawman_http_callback</a></div><div class="ttdeci">static int rawman_http_callback(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08464">manager.c:8464</a></div></div>
<div class="ttc" id="asterisk_8h_html_aa6293b2dae52a2b470494df672a26c42"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#aa6293b2dae52a2b470494df672a26c42">AST_FILE_MODE</a></div><div class="ttdeci">#define AST_FILE_MODE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00032">asterisk.h:32</a></div></div>
<div class="ttc" id="manager_8c_html_aa3ea4a3174e7e0f76c0a4e2318a8ee42"><div class="ttname"><a href="../../d4/d10/manager_8c.html#aa3ea4a3174e7e0f76c0a4e2318a8ee42">process_output</a></div><div class="ttdeci">static void process_output(struct mansession *s, struct ast_str **out, struct ast_variable *params, enum output_format format)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07874">manager.c:7874</a></div></div>
<div class="ttc" id="http_8h_html_a0448c9f4a66b6ee7994870b187e185b4"><div class="ttname"><a href="../../dd/d56/http_8h.html#a0448c9f4a66b6ee7994870b187e185b4">ast_http_send</a></div><div class="ttdeci">void ast_http_send(struct ast_tcptls_session_instance *ser, enum ast_http_method method, int status_code, const char *status_title, struct ast_str *http_header, struct ast_str *out, int fd, unsigned int static_content)</div><div class="ttdoc">Generic function for sending HTTP/1.1 response. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00456">http.c:456</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17aeebe667b42c8e7993a9f5f4c45e6da25">AST_BRIDGE_TRANSFER_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01123">bridge.h:1123</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="structvariable__count_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="../../de/dd0/structvariable__count.html#ad43c3812e6d13e0518d9f8b8f463ffcf">variable_count::count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07697">manager.c:7697</a></div></div>
<div class="ttc" id="structast__sockaddr_html"><div class="ttname"><a href="../../d3/db3/structast__sockaddr.html">ast_sockaddr</a></div><div class="ttdoc">Socket address structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00097">netsock2.h:97</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a1b4f0eb83fde5ec2ca8357428b10826f"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a1b4f0eb83fde5ec2ca8357428b10826f">ast_xmldoc_build_arguments</a></div><div class="ttdeci">char * ast_xmldoc_build_arguments(const char *type, const char *name, const char *module)</div><div class="ttdoc">Generate the [arguments] tag based on type of node (&amp;#39;application&amp;#39;, &amp;#39;function&amp;#39; or &amp;#39;agi&amp;#39;) and name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l02075">xmldoc.c:2075</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a29e973bd94bfbaf59d939bd1bc988c32"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a29e973bd94bfbaf59d939bd1bc988c32">cid_num</a></div><div class="ttdeci">static char cid_num[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00164">chan_mgcp.c:164</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaecb636956ea985949db409bb9d6a6d00"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaecb636956ea985949db409bb9d6a6d00">aocmessage_get_unit_entry</a></div><div class="ttdeci">static int aocmessage_get_unit_entry(const struct message *m, struct ast_aoc_unit_entry *entry, unsigned int entry_num)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05493">manager.c:5493</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_ab4fdb206838f2974bd15fc2ca1e9d366"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ab4fdb206838f2974bd15fc2ca1e9d366">password</a></div><div class="ttdeci">static struct ast_str * password</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00077">cdr_mysql.c:77</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca71f42ec6460e60eb6e10956c53329e45">OBJ_UNLINK</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01043">astobj2.h:1043</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html_a5be1fb9b43b051b087f6952b6346909a"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html#a5be1fb9b43b051b087f6952b6346909a">ast_channel_snapshot::dialplan</a></div><div class="ttdeci">struct ast_channel_snapshot_dialplan * dialplan</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00151">stasis_channels.h:151</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga352d583ea36240124638e5c1db088227"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga352d583ea36240124638e5c1db088227">astman_send_error_va</a></div><div class="ttdeci">void astman_send_error_va(struct mansession *s, const struct message *m, const char *fmt,...)</div><div class="ttdoc">Send error in manager transaction (with va_args support) </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03164">manager.c:3164</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaee7a640cdb6c8442d7fc7e7914406e5a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaee7a640cdb6c8442d7fc7e7914406e5a">action_find</a></div><div class="ttdeci">static struct manager_action * action_find(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01704">manager.c:1704</a></div></div>
<div class="ttc" id="logger_8h_html_ad770f83c71e237e1f64163358ce4e13d"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad770f83c71e237e1f64163358ce4e13d">ast_verb</a></div><div class="ttdeci">#define ast_verb(level,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00463">logger.h:463</a></div></div>
<div class="ttc" id="manager_8h_html_ad6acb19e6de27692675f1706d390f548"><div class="ttname"><a href="../../db/d45/manager_8h.html#ad6acb19e6de27692675f1706d390f548">EVENT_FLAG_ORIGINATE</a></div><div class="ttdeci">#define EVENT_FLAG_ORIGINATE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00083">manager.h:83</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5e4938c2cafe6e01553cb952ca1f5e45"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5e4938c2cafe6e01553cb952ca1f5e45">unref_mansession</a></div><div class="ttdeci">static struct mansession_session * unref_mansession(struct mansession_session *s)</div><div class="ttdoc">Unreference manager session object. If no more references, then go ahead and delete it...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02183">manager.c:2183</a></div></div>
<div class="ttc" id="structast__category_html"><div class="ttname"><a href="../../d7/db2/structast__category.html">ast_category</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00225">main/config.c:225</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_af08538976e14908080145cb050f39510"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#af08538976e14908080145cb050f39510">AST_SEC_EVT</a></div><div class="ttdeci">#define AST_SEC_EVT(e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00139">security_events_defs.h:139</a></div></div>
<div class="ttc" id="channel_8h_html_a6b4548259e61f691c654aed0025e5502"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6b4548259e61f691c654aed0025e5502">ast_channel_readtrans</a></div><div class="ttdeci">struct ast_trans_pvt * ast_channel_readtrans(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00753">channel_internal_api.c:753</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga06909116cc55a2b89ea554e74be04ab6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga06909116cc55a2b89ea554e74be04ab6">manager_state_cb</a></div><div class="ttdeci">static int manager_state_cb(const char *context, const char *exten, struct ast_state_cb_info *info, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07288">manager.c:7288</a></div></div>
<div class="ttc" id="md5_8h_html_a6bdca55813077d1c652a1f63608dac30"><div class="ttname"><a href="../../da/db0/md5_8h.html#a6bdca55813077d1c652a1f63608dac30">MD5Init</a></div><div class="ttdeci">void MD5Init(struct MD5Context *context)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6c/md5_8c_source.html#l00057">md5.c:57</a></div></div>
<div class="ttc" id="lock_8h_html_a8a3bd496edfec04a95683ace66676200"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a8a3bd496edfec04a95683ace66676200">ast_atomic_fetchadd_int</a></div><div class="ttdeci">int ast_atomic_fetchadd_int(volatile int *p, int v)</div><div class="ttdoc">Atomically add v to *p and return the previous value of *p. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00755">lock.h:755</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga7a521597aa2f92e42118f262cb911472"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga7a521597aa2f92e42118f262cb911472">STASIS_MESSAGE_TYPE_DEFN</a></div><div class="ttdeci">STASIS_MESSAGE_TYPE_DEFN(ast_manager_get_generic_type)</div><div class="ttdoc">Define AMI message types. </div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a2488abe6cce4868efd018010c663a5fe"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a2488abe6cce4868efd018010c663a5fe">ast_category_browse_filtered</a></div><div class="ttdeci">struct ast_category * ast_category_browse_filtered(struct ast_config *config, const char *category_name, struct ast_category *prev, const char *filter)</div><div class="ttdoc">Browse categories with filters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01335">main/config.c:1335</a></div></div>
<div class="ttc" id="manager_8c_html_ad43b79b766118eebf1426a908d0e27ae"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ad43b79b766118eebf1426a908d0e27ae">manager_free_user</a></div><div class="ttdeci">static void manager_free_user(struct ast_manager_user *user)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08937">manager.c:8937</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a6a08b6e8d15408ee8bbf7313e1cba23d"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a6a08b6e8d15408ee8bbf7313e1cba23d">ast_xmldoc_build_final_response</a></div><div class="ttdeci">struct ast_xml_doc_item * ast_xmldoc_build_final_response(const char *type, const char *name, const char *module)</div><div class="ttdoc">Generate the [final response] tag based on type of node (&amp;#39;application&amp;#39;, &amp;#39;function&amp;#39; or &amp;#39;agi&amp;#39;) and name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l02528">xmldoc.c:2528</a></div></div>
<div class="ttc" id="stringfields_8h_html_a45a8f974ba52ca692e4e0547266d3a9f"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a45a8f974ba52ca692e4e0547266d3a9f">ast_string_field_ptr_build_va</a></div><div class="ttdeci">#define ast_string_field_ptr_build_va(x, ptr, fmt, args)</div><div class="ttdoc">Set a field to a complex (built) value with prebuilt va_lists. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00569">stringfields.h:569</a></div></div>
<div class="ttc" id="pbx_8h_html_a965977ea9a3144bc203e0ce7a64680a1"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a965977ea9a3144bc203e0ce7a64680a1">ast_custom_function_unregister</a></div><div class="ttdeci">int ast_custom_function_unregister(struct ast_custom_function *acf)</div><div class="ttdoc">Unregister a custom function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d70/pbx__functions_8c_source.html#l00273">pbx_functions.c:273</a></div></div>
<div class="ttc" id="datastore_8h_html_aee27286888b30c6448a9bce928040a14"><div class="ttname"><a href="../../d9/db6/datastore_8h.html#aee27286888b30c6448a9bce928040a14">ast_datastore_free</a></div><div class="ttdeci">int ast_datastore_free(struct ast_datastore *datastore)</div><div class="ttdoc">Free a data store object. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d7a/datastore_8c_source.html#l00068">datastore.c:68</a></div></div>
<div class="ttc" id="manager_8c_html_a05b67ad13ff084e7b4ffba5a69e99d77"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a05b67ad13ff084e7b4ffba5a69e99d77">auth_mxml_http_callback</a></div><div class="ttdeci">static int auth_mxml_http_callback(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08512">manager.c:8512</a></div></div>
<div class="ttc" id="group__main__options_html_ga6d3ecf74255f4bfc355ebd1540c316c1"><div class="ttname"><a href="../../d6/dd6/group__main__options.html#ga6d3ecf74255f4bfc355ebd1540c316c1">ast_option_maxcalls</a></div><div class="ttdeci">int ast_option_maxcalls</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00079">options.c:79</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga4aa0274bed0fc74d53f43cad92c2e263"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga4aa0274bed0fc74d53f43cad92c2e263">handle_showmaneventq</a></div><div class="ttdeci">static char * handle_showmaneventq(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdoc">CLI command manager list eventq. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02706">manager.c:2706</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a8569403d78e86654662bba47ff576bd5"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a8569403d78e86654662bba47ff576bd5">ast_xmldoc_build_list_responses</a></div><div class="ttdeci">struct ast_xml_doc_item * ast_xmldoc_build_list_responses(const char *type, const char *name, const char *module)</div><div class="ttdoc">Generate the [list responses] tag based on type of node (&amp;#39;application&amp;#39;, &amp;#39;function&amp;#39; or &amp;#39;agi&amp;#39;) and name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l02463">xmldoc.c:2463</a></div></div>
<div class="ttc" id="structast__datastore_html_a2daadcdbac635c83b7bfc6375b4c9be4"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a2daadcdbac635c83b7bfc6375b4c9be4">ast_datastore::uid</a></div><div class="ttdeci">const char * uid</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00069">datastore.h:69</a></div></div>
<div class="ttc" id="structmanager__action_html_a8637433cfbb88aeb10ce2ed5dcba0eb1"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#a8637433cfbb88aeb10ce2ed5dcba0eb1">manager_action::module</a></div><div class="ttdeci">struct ast_module * module</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00167">manager.h:167</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a54b98eac3831b61f0ec723bc1822405a"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a54b98eac3831b61f0ec723bc1822405a">ast_category_get_templates</a></div><div class="ttdeci">struct ast_str * ast_category_get_templates(const struct ast_category *category)</div><div class="ttdoc">Return the template names this category inherits from. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01038">main/config.c:1038</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga410d4aa5e53af4cdcb4ec95a0ae8563e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga410d4aa5e53af4cdcb4ec95a0ae8563e">action_filter</a></div><div class="ttdeci">static int action_filter(struct mansession *s, const struct message *m)</div><div class="ttdoc">Manager command to add an event filter to a manager session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06111">manager.c:6111</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga10113617fccfd71f696509a270385169"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga10113617fccfd71f696509a270385169">process_message</a></div><div class="ttdeci">static int process_message(struct mansession *s, const struct message *m)</div><div class="ttdoc">Process an AMI message, performing desired action. Return 0 on success, -1 on error that require the ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06607">manager.c:6607</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga322eb26fcd507fe69297e038d584db02"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga322eb26fcd507fe69297e038d584db02">acl_change_sub</a></div><div class="ttdeci">static struct stasis_subscription * acl_change_sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01487">manager.c:1487</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a0c11a185ac14ffef84950e9cfdb8e0ee"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a0c11a185ac14ffef84950e9cfdb8e0ee">ast_category_inherit</a></div><div class="ttdeci">int ast_category_inherit(struct ast_category *existing, const struct ast_category *base)</div><div class="ttdoc">Applies base (template) to category. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01367">main/config.c:1367</a></div></div>
<div class="ttc" id="module_8h_html_a15f7e2f25f4d0c60de6cca164232a6d4"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15f7e2f25f4d0c60de6cca164232a6d4">ast_module_check</a></div><div class="ttdeci">int ast_module_check(const char *name)</div><div class="ttdoc">Check if module with the name given is loaded. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d96/loader_8c_source.html#l02653">loader.c:2653</a></div></div>
<div class="ttc" id="manager_8c_html_ac737e999fb3203231cb6f6325d9161f8"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ac737e999fb3203231cb6f6325d9161f8">arawmanuri</a></div><div class="ttdeci">static struct ast_http_uri arawmanuri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08534">manager.c:8534</a></div></div>
<div class="ttc" id="stringfields_8h_html"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html">stringfields.h</a></div></div>
<div class="ttc" id="utils_8h_html"><div class="ttname"><a href="../../d5/d60/utils_8h.html">utils.h</a></div><div class="ttdoc">Utility functions. </div></div>
<div class="ttc" id="netsock2_8h_html_ad91b5dfe4c188d15f4b2e9e2ec5d8864"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#ad91b5dfe4c188d15f4b2e9e2ec5d8864">ast_sockaddr_setnull</a></div><div class="ttdeci">static void ast_sockaddr_setnull(struct ast_sockaddr *addr)</div><div class="ttdoc">Sets address addr to null. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00140">netsock2.h:140</a></div></div>
<div class="ttc" id="astmm_8h_html_ada667b6f84a08e6848cb37c5ffb94a5f"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ada667b6f84a08e6848cb37c5ffb94a5f">ast_asprintf</a></div><div class="ttdeci">#define ast_asprintf(ret, fmt,...)</div><div class="ttdoc">A wrapper for asprintf() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00269">astmm.h:269</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089ab55dc209b59be84c7162d3128565ab36"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089ab55dc209b59be84c7162d3128565ab36">AST_AOC_MULT_ONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00038">aoc.h:38</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaf28d7a75b43cde09123c9ba1527b34ba"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaf28d7a75b43cde09123c9ba1527b34ba">httptimeout</a></div><div class="ttdeci">static int httptimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01473">manager.c:1473</a></div></div>
<div class="ttc" id="channel_8h_html_a71d89dbc5107b1f851dcbf1686a0d9d9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a71d89dbc5107b1f851dcbf1686a0d9d9">ast_channel_get_by_name_prefix</a></div><div class="ttdeci">struct ast_channel * ast_channel_get_by_name_prefix(const char *name, size_t name_len)</div><div class="ttdoc">Find a channel by a name prefix. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01434">channel.c:1434</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a9f3498f9afffecfd78c485af41556"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a9f3498f9afffecfd78c485af41556">astman_get_header</a></div><div class="ttdeci">const char * astman_get_header(const struct message *m, char *var)</div><div class="ttdoc">Return the first matching variable from an array. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02820">manager.c:2820</a></div></div>
<div class="ttc" id="manager_8c_html_a914dce58348e2b56ed139c441198b82f"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a914dce58348e2b56ed139c441198b82f">find_session</a></div><div class="ttdeci">static struct mansession_session * find_session(uint32_t ident, int incinuse)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07479">manager.c:7479</a></div></div>
<div class="ttc" id="manager_8c_html_a3eb3c2c7854c4ed46debc3f404e0d569"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a3eb3c2c7854c4ed46debc3f404e0d569">managerclient_function</a></div><div class="ttdeci">static struct ast_custom_function managerclient_function</div><div class="ttdoc">description of AMI_CLIENT dialplan function </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08624">manager.c:8624</a></div></div>
<div class="ttc" id="module_8h_html_a15896c26e51e8162df5eb9a0124c841f"><div class="ttname"><a href="../../d5/d16/module_8h.html#a15896c26e51e8162df5eb9a0124c841f">ast_module_unref</a></div><div class="ttdeci">#define ast_module_unref(mod)</div><div class="ttdoc">Release a reference to the module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00469">module.h:469</a></div></div>
<div class="ttc" id="strings_8h_html_a372554b7a2d69a8bd3adac5157672036"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a372554b7a2d69a8bd3adac5157672036">ast_strlen_zero</a></div><div class="ttdeci">#define ast_strlen_zero(foo)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00052">strings.h:52</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a2457835b26aa09c41c6ecf633f95f775a4b2dcef6c6da53104278190e521d7b1c"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a2457835b26aa09c41c6ecf633f95f775a4b2dcef6c6da53104278190e521d7b1c">AST_FRAME_READ_ACTION_SEND_TEXT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00353">include/asterisk/frame.h:353</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga844c8a72ece748571e61afa468edabb0"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga844c8a72ece748571e61afa468edabb0">perms</a></div><div class="ttdeci">static const struct permalias perms[]</div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6344200b56202a76de8db05af680f3ac"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6344200b56202a76de8db05af680f3ac">ast_realtime_enabled</a></div><div class="ttdeci">int ast_realtime_enabled(void)</div><div class="ttdoc">Check if there&amp;#39;s any realtime engines loaded. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03377">main/config.c:3377</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga22f6d55529c1ca69bc308af9d9ef0bb2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga22f6d55529c1ca69bc308af9d9ef0bb2">ast_webmanager_check_enabled</a></div><div class="ttdeci">int ast_webmanager_check_enabled(void)</div><div class="ttdoc">Check if AMI/HTTP is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01954">manager.c:1954</a></div></div>
<div class="ttc" id="channel_8h_html_ae616309e9eba6a1b009a0466bada50cc"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ae616309e9eba6a1b009a0466bada50cc">ast_channel_whentohangup</a></div><div class="ttdeci">struct timeval * ast_channel_whentohangup(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00928">channel_internal_api.c:928</a></div></div>
<div class="ttc" id="channel_8h_html_aaced431562223538a94e0e69cf94151a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aaced431562223538a94e0e69cf94151a">ast_channel_readformat</a></div><div class="ttdeci">struct ast_format * ast_channel_readformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00856">channel_internal_api.c:856</a></div></div>
<div class="ttc" id="structmanager__action_html_aa871ca3c361d229d4e37edf3c6016cc1"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#aa871ca3c361d229d4e37edf3c6016cc1">manager_action::docsrc</a></div><div class="ttdeci">enum ast_doc_src docsrc</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00169">manager.h:169</a></div></div>
<div class="ttc" id="structast__manager__event__blob_html_aab469824ac975744e02d0eefe868f82f"><div class="ttname"><a href="../../dd/d96/structast__manager__event__blob.html#aab469824ac975744e02d0eefe868f82f">ast_manager_event_blob::manager_event</a></div><div class="ttdeci">const char * manager_event</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00493">manager.h:493</a></div></div>
<div class="ttc" id="structmansession__session_html_a06c0918fa1a1aac3d386fca59b12327c"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a06c0918fa1a1aac3d386fca59b12327c">mansession_session::chanvars</a></div><div class="ttdeci">struct ast_variable * chanvars</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01601">manager.c:1601</a></div></div>
<div class="ttc" id="structmansession__session_html_a67c9d5e7f3b13cfc7fe3b4e395c81443"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">mansession_session::writetimeout</a></div><div class="ttdeci">int writetimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01604">manager.c:1604</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_ac911cfd927625dfd7d78908aae0fec80"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#ac911cfd927625dfd7d78908aae0fec80">stasis_message_router_set_formatters_default</a></div><div class="ttdeci">void stasis_message_router_set_formatters_default(struct stasis_message_router *router, stasis_subscription_cb callback, void *data, enum stasis_subscription_message_formatters formatters)</div><div class="ttdoc">Sets the default route of a router with formatters. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00397">stasis_message_router.c:397</a></div></div>
<div class="ttc" id="manager_8c_html_ae266fd2d3b1b5374127ad824217bb025"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ae266fd2d3b1b5374127ad824217bb025">TEST_STRING</a></div><div class="ttdeci">#define TEST_STRING</div></div>
<div class="ttc" id="group__Group__AMI_html_ga2a7a78b91c9ba54f89c9b5a9e7435027"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2a7a78b91c9ba54f89c9b5a9e7435027">ast_manager_str_from_json_object</a></div><div class="ttdeci">struct ast_str * ast_manager_str_from_json_object(struct ast_json *blob, key_exclusion_cb exclusion_cb)</div><div class="ttdoc">Convert a JSON object into an AMI compatible string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01821">manager.c:1821</a></div></div>
<div class="ttc" id="format__cap_8h_html_a26c6676e9f2dd9535ea0d5bbd45f98b6"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a26c6676e9f2dd9535ea0d5bbd45f98b6">ast_format_cap_update_by_allow_disallow</a></div><div class="ttdeci">int ast_format_cap_update_by_allow_disallow(struct ast_format_cap *cap, const char *list, int allowing)</div><div class="ttdoc">Parse an &quot;allow&quot; or &quot;deny&quot; list and modify a format capabilities structure accordingly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00320">format_cap.c:320</a></div></div>
<div class="ttc" id="paths_8h_html_ab9f9346c7a41bdf3720f7b1ed02ec703"><div class="ttname"><a href="../../dd/df2/paths_8h.html#ab9f9346c7a41bdf3720f7b1ed02ec703">ast_config_AST_SYSTEM_NAME</a></div><div class="ttdeci">const char * ast_config_AST_SYSTEM_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00170">options.c:170</a></div></div>
<div class="ttc" id="manager_8c_html_a4d89095b3accb6a550e4daf53b089fef"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a4d89095b3accb6a550e4daf53b089fef">mxml_http_callback</a></div><div class="ttdeci">static int mxml_http_callback(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08453">manager.c:8453</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad60d9d8c34b4f61493c1d85ae02d569fa4b42c80c591c4da820aecc2bb80bde18"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa4b42c80c591c4da820aecc2bb80bde18">PARSE_ADDR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01104">include/asterisk/config.h:1104</a></div></div>
<div class="ttc" id="test__amihooks_8c_html_a5992b274cfdcacdbc1fa8347fd01ebde"><div class="ttname"><a href="../../dc/dbf/test__amihooks_8c.html#a5992b274cfdcacdbc1fa8347fd01ebde">done</a></div><div class="ttdeci">int done</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dbf/test__amihooks_8c_source.html#l00048">test_amihooks.c:48</a></div></div>
<div class="ttc" id="stasis_8h_html_adf8e3a27e9995917eb0bc043acd1316a"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#adf8e3a27e9995917eb0bc043acd1316a">stasis_message_to_ami</a></div><div class="ttdeci">struct ast_manager_event_blob * stasis_message_to_ami(struct stasis_message *msg)</div><div class="ttdoc">Build the AMI representation of the message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00224">stasis_message.c:224</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a662747e8d918f2d0ee7012d1d19731c9">FAILURE_NEWCAT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01425">manager.c:1425</a></div></div>
<div class="ttc" id="iostream_8h_html_aa009ff0c2d31892c5beb19114f47768b"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#aa009ff0c2d31892c5beb19114f47768b">ast_iostream_read</a></div><div class="ttdeci">ssize_t ast_iostream_read(struct ast_iostream *stream, void *buffer, size_t count)</div><div class="ttdoc">Read data from an iostream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00273">iostream.c:273</a></div></div>
<div class="ttc" id="aoc_8h_html_a655f2e3693ef15ab3bdfc623807278a7"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a655f2e3693ef15ab3bdfc623807278a7">ast_aoc_set_association_number</a></div><div class="ttdeci">int ast_aoc_set_association_number(struct ast_aoc_decoded *decoded, const char *num, uint8_t plan)</div><div class="ttdoc">set the charging accociation number for an AOC-E message </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l01056">aoc.c:1056</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga954eccb4f48bd6797ba65a9cada6446a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga954eccb4f48bd6797ba65a9cada6446a">action_events</a></div><div class="ttdeci">static int action_events(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04343">manager.c:4343</a></div></div>
<div class="ttc" id="structnumber_html"><div class="ttname"><a href="../../d6/d49/structnumber.html">number</a></div><div class="ttdoc">Number structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d55/app__followme_8c_source.html#l00154">app_followme.c:154</a></div></div>
<div class="ttc" id="netsock2_8h_html_aae671446fa65b8f846efaf165872c683"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aae671446fa65b8f846efaf165872c683">ast_sockaddr_isnull</a></div><div class="ttdeci">static int ast_sockaddr_isnull(const struct ast_sockaddr *addr)</div><div class="ttdoc">Checks if the ast_sockaddr is null. &quot;null&quot; in this sense essentially means uninitialized, or having a 0 length. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00127">netsock2.h:127</a></div></div>
<div class="ttc" id="structmansession__session_html_abd03a701558da25801e0ce450d9e39ee"><div class="ttname"><a href="../../df/d05/structmansession__session.html#abd03a701558da25801e0ce450d9e39ee">mansession_session::sessiontimeout</a></div><div class="ttdeci">time_t sessiontimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01591">manager.c:1591</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga42ac3bf839aaa226509162987fcf695d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga42ac3bf839aaa226509162987fcf695d">append_channel_vars</a></div><div class="ttdeci">static void append_channel_vars(struct ast_str **pbuf, struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07092">manager.c:7092</a></div></div>
<div class="ttc" id="netsock2_8h_html_a51e2841175bf3ad58a4e11ad9fb2453f"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#a51e2841175bf3ad58a4e11ad9fb2453f">ast_sockaddr_port</a></div><div class="ttdeci">#define ast_sockaddr_port(addr)</div><div class="ttdoc">Get the port number of a socket address. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00521">netsock2.h:521</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2e585cbfd7440aa94b0eb20ff93f1c3c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2e585cbfd7440aa94b0eb20ff93f1c3c">manager_event_buf</a></div><div class="ttdeci">static struct ast_threadstorage manager_event_buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07109">manager.c:7109</a></div></div>
<div class="ttc" id="cdr_8h_html_a1819c3aecd7b59e2734810f52b219059"><div class="ttname"><a href="../../dc/d07/cdr_8h.html#a1819c3aecd7b59e2734810f52b219059">ast_cdr_is_enabled</a></div><div class="ttdeci">int ast_cdr_is_enabled(void)</div><div class="ttdoc">Return TRUE if CDR subsystem is enabled. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df2/cdr_8c_source.html#l02861">cdr.c:2861</a></div></div>
<div class="ttc" id="paths_8h_html_a2434757afbc16110ff1c7483f3d7ba51"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a2434757afbc16110ff1c7483f3d7ba51">ast_config_AST_RUN_GROUP</a></div><div class="ttdeci">const char * ast_config_AST_RUN_GROUP</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00169">options.c:169</a></div></div>
<div class="ttc" id="strings_8h_html_aa3341f35cedca29e60bb7f3927204283"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aa3341f35cedca29e60bb7f3927204283">ast_str_set</a></div><div class="ttdeci">int ast_str_set(struct ast_str **buf, ssize_t max_len, const char *fmt,...)</div><div class="ttdoc">Set a dynamic string using variable arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01065">strings.h:1065</a></div></div>
<div class="ttc" id="structast__security__event__inval__password_html"><div class="ttname"><a href="../../d4/d90/structast__security__event__inval__password.html">ast_security_event_inval_password</a></div><div class="ttdoc">An attempt at basic password auth failed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00455">security_events_defs.h:455</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga3256471530910751d20fa34e435c7575"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga3256471530910751d20fa34e435c7575">generate_status</a></div><div class="ttdeci">static void generate_status(struct mansession *s, struct ast_channel *chan, char **vars, int varc, int all_variables, char *id_text, int *count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04662">manager.c:4662</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga607030674dbfc12f62148d375b4e320f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga607030674dbfc12f62148d375b4e320f">action_getconfig</a></div><div class="ttdeci">static int action_getconfig(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03620">manager.c:3620</a></div></div>
<div class="ttc" id="structast__control__read__action__payload_html"><div class="ttname"><a href="../../d6/d4b/structast__control__read__action__payload.html">ast_control_read_action_payload</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00357">include/asterisk/frame.h:357</a></div></div>
<div class="ttc" id="manager_8c_html_af8717f47c7bae13acaf49dc97eafd0b6"><div class="ttname"><a href="../../d4/d10/manager_8c.html#af8717f47c7bae13acaf49dc97eafd0b6">generic_http_callback</a></div><div class="ttdeci">static int generic_http_callback(struct ast_tcptls_session_instance *ser, enum ast_http_method method, enum output_format format, const struct ast_sockaddr *remote_address, const char *uri, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07907">manager.c:7907</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html">config.h</a></div><div class="ttdoc">Configuration File Parser. </div></div>
<div class="ttc" id="http_8h_html"><div class="ttname"><a href="../../dd/d56/http_8h.html">http.h</a></div><div class="ttdoc">Support for Private Asterisk HTTP Servers. </div></div>
<div class="ttc" id="structast__state__cb__info_html_a6f3d8aa9a90b701e81dad4cc4a56be67"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html#a6f3d8aa9a90b701e81dad4cc4a56be67">ast_state_cb_info::exten_state</a></div><div class="ttdeci">enum ast_extension_states exten_state</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00104">pbx.h:104</a></div></div>
<div class="ttc" id="structmansession__session_html_a24597b49933903efcf09c635513d8269"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a24597b49933903efcf09c635513d8269">mansession_session::notify_lock</a></div><div class="ttdeci">ast_mutex_t notify_lock</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01610">manager.c:1610</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0a0fe104cc2cc36a43784f886f3ae7dc"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0a0fe104cc2cc36a43784f886f3ae7dc">AST_RWLIST_RDLOCK</a></div><div class="ttdeci">#define AST_RWLIST_RDLOCK(head)</div><div class="ttdoc">Read locks a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00077">linkedlists.h:77</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2d7639d606b2516454d130399c840b35"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2d7639d606b2516454d130399c840b35">destroy_fast_originate_helper</a></div><div class="ttdeci">static void destroy_fast_originate_helper(struct fast_originate_helper *doomed)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05405">manager.c:5405</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a2a5612ff8eb3595c1be1df75be4d870f"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a2a5612ff8eb3595c1be1df75be4d870f">ast_category_rename</a></div><div class="ttdeci">void ast_category_rename(struct ast_category *cat, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01362">main/config.c:1362</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a6b49cafa2a3d359a2e865992f551874a"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a6b49cafa2a3d359a2e865992f551874a">mailbox</a></div><div class="ttdeci">static char mailbox[AST_MAX_MAILBOX_UNIQUEID]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00204">chan_mgcp.c:204</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga91820dbca9ccfa57da1a8c3c183a56a4"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga91820dbca9ccfa57da1a8c3c183a56a4">check_manager_session_inuse</a></div><div class="ttdeci">static int check_manager_session_inuse(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02282">manager.c:2282</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aacc5f6b7c25e361d11d40137fd55a8e8"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aacc5f6b7c25e361d11d40137fd55a8e8">AST_RWLIST_INSERT_HEAD</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_HEAD</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00717">linkedlists.h:717</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_ace2a3d783f4f79818e14265ae719f06c"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#ace2a3d783f4f79818e14265ae719f06c">ast_app_inboxcount2</a></div><div class="ttdeci">int ast_app_inboxcount2(const char *mailboxes, int *urgentmsgs, int *newmsgs, int *oldmsgs)</div><div class="ttdoc">Determine number of urgent/new/old messages in a mailbox. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l00692">main/app.c:692</a></div></div>
<div class="ttc" id="manager_8h_html_a420f0f755e1c3378b45ca7f6f0669ffa"><div class="ttname"><a href="../../db/d45/manager_8h.html#a420f0f755e1c3378b45ca7f6f0669ffa">EVENT_FLAG_SYSTEM</a></div><div class="ttdeci">#define EVENT_FLAG_SYSTEM</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00071">manager.h:71</a></div></div>
<div class="ttc" id="structast__http__digest_html_a19ac71226fac09e87afe31acb4c99214"><div class="ttname"><a href="../../da/db3/structast__http__digest.html#a19ac71226fac09e87afe31acb4c99214">ast_http_digest::uri</a></div><div class="ttdeci">const ast_string_field uri</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00672">utils.h:672</a></div></div>
<div class="ttc" id="logger_8h_html_a3f248112c8d6ce7e3959aa723dade648"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a3f248112c8d6ce7e3959aa723dade648">ast_debug</a></div><div class="ttdeci">#define ast_debug(level,...)</div><div class="ttdoc">Log a DEBUG message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00452">logger.h:452</a></div></div>
<div class="ttc" id="manager_8h_html_a8ae409b5ff584e42c30edcfe5837d85c"><div class="ttname"><a href="../../db/d45/manager_8h.html#a8ae409b5ff584e42c30edcfe5837d85c">ast_manager_get_generic_type</a></div><div class="ttdeci">struct stasis_message_type * ast_manager_get_generic_type(void)</div><div class="ttdoc">Get the stasis_message_type for generic messages. </div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="structmansession__session_html_a646b71d97b81fea37dbbc9fd33dc5f4a"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a646b71d97b81fea37dbbc9fd33dc5f4a">mansession_session::whitefilters</a></div><div class="ttdeci">struct ao2_container * whitefilters</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01599">manager.c:1599</a></div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html">features_config.h</a></div></div>
<div class="ttc" id="structast__security__event__req__bad__format_html_afd6258b84dc45cf613b1896565860f70"><div class="ttname"><a href="../../d1/dc1/structast__security__event__req__bad__format.html#afd6258b84dc45cf613b1896565860f70">ast_security_event_req_bad_format::request_type</a></div><div class="ttdeci">const char * request_type</div><div class="ttdoc">Request type that was made. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00371">security_events_defs.h:371</a></div></div>
<div class="ttc" id="structmansession__session_1_1mansession__datastores_html"><div class="ttname"><a href="../../d4/d88/structmansession__session_1_1mansession__datastores.html">mansession_session::mansession_datastores</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01611">manager.c:1611</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a60d08c34084a43b06ae50ccd693e0ba9">FAILURE_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01428">manager.c:1428</a></div></div>
<div class="ttc" id="channel_8h_html_a557663006d52a9cdc11f42602bf48326"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a557663006d52a9cdc11f42602bf48326">ast_channel_get_bridge</a></div><div class="ttdeci">struct ast_bridge * ast_channel_get_bridge(const struct ast_channel *chan)</div><div class="ttdoc">Get the bridge associated with a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10735">channel.c:10735</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac730b751a77b99e3dd3eb4b1880ba933"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac730b751a77b99e3dd3eb4b1880ba933">manager_modulecheck</a></div><div class="ttdeci">static int manager_modulecheck(struct mansession *s, const struct message *m)</div><div class="ttdoc">Manager function to check if module is loaded. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06470">manager.c:6470</a></div></div>
<div class="ttc" id="aoc_8h_html"><div class="ttname"><a href="../../d6/db3/aoc_8h.html">aoc.h</a></div><div class="ttdoc">Generic Advice of Charge encode and decode routines. </div></div>
<div class="ttc" id="group__Group__AMI_html_ga033f5d6043ef1b5fcb6da1aa6a70f53d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga033f5d6043ef1b5fcb6da1aa6a70f53d">blackfilter_cmp_fn</a></div><div class="ttdeci">static int blackfilter_cmp_fn(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06092">manager.c:6092</a></div></div>
<div class="ttc" id="structast__variable_html_a8556878012feffc9e0beb86cd78f424d"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8556878012feffc9e0beb86cd78f424d">ast_variable::value</a></div><div class="ttdeci">const char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00087">include/asterisk/config.h:87</a></div></div>
<div class="ttc" id="logger_8h_html_a2fdd5bff193a29ec6c7278da2851ea56"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#a2fdd5bff193a29ec6c7278da2851ea56">AST_LOG_ERROR</a></div><div class="ttdeci">#define AST_LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00290">logger.h:290</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa992b47cf04699542d45129cb603c11f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa992b47cf04699542d45129cb603c11f">report_inval_password</a></div><div class="ttdeci">static void report_inval_password(const struct mansession *s, const char *username)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03335">manager.c:3335</a></div></div>
<div class="ttc" id="tcptls_8h_html_ac1fd2d3038c57a8f8f28f4b558eb5583"><div class="ttname"><a href="../../d4/ddf/tcptls_8h.html#ac1fd2d3038c57a8f8f28f4b558eb5583">ast_tcptls_server_root</a></div><div class="ttdeci">void * ast_tcptls_server_root(void *)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d9b/tcptls_8c_source.html#l00280">tcptls.c:280</a></div></div>
<div class="ttc" id="bridge_8h_html_a982e0e652b9f03abf1ec584c137791a3"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#a982e0e652b9f03abf1ec584c137791a3">ast_bridge_transfer_blind</a></div><div class="ttdeci">enum ast_transfer_result ast_bridge_transfer_blind(int is_external, struct ast_channel *transferer, const char *exten, const char *context, transfer_channel_cb new_channel_cb, void *user_data)</div><div class="ttdoc">Blind transfer target to the extension and context provided. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d95/bridge_8c_source.html#l04477">bridge.c:4477</a></div></div>
<div class="ttc" id="iostream_8h_html_ac0297067e6921ce6a2c5f3b3d0647d3a"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#ac0297067e6921ce6a2c5f3b3d0647d3a">ast_iostream_close</a></div><div class="ttdeci">int ast_iostream_close(struct ast_iostream *stream)</div><div class="ttdoc">Close an iostream. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00528">iostream.c:528</a></div></div>
<div class="ttc" id="channel_8h_html"><div class="ttname"><a href="../../d5/d7b/channel_8h.html">channel.h</a></div><div class="ttdoc">General Asterisk PBX channel definitions. </div></div>
<div class="ttc" id="json_8h_html"><div class="ttname"><a href="../../d4/d05/json_8h.html">json.h</a></div><div class="ttdoc">Asterisk JSON abstraction layer. </div></div>
<div class="ttc" id="module_8h_html_a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223"><div class="ttname"><a href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a12c3f60dd7655dfa8d4430cbf04b1223">AST_MODFLAG_LOAD_ORDER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00317">module.h:317</a></div></div>
<div class="ttc" id="asterisk_8h_html_a412442e1beffe5bec07ed2e9ea72afc3"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#a412442e1beffe5bec07ed2e9ea72afc3">ast_register_cleanup</a></div><div class="ttdeci">int ast_register_cleanup(void(*func)(void))</div><div class="ttdoc">Register a function to be executed before Asterisk gracefully exits. </div><div class="ttdef"><b>Definition:</b> <a href="../../da/d4d/clicompat_8c_source.html#l00019">clicompat.c:19</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_aca392a8d3941cd0740aef3ad92545d67"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#aca392a8d3941cd0740aef3ad92545d67">in</a></div><div class="ttdeci">FILE * in</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00033">utils/frame.c:33</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga4b7f596668f285bb55c2ba939a20f9d2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga4b7f596668f285bb55c2ba939a20f9d2">action_blind_transfer</a></div><div class="ttdeci">static int action_blind_transfer(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05118">manager.c:5118</a></div></div>
<div class="ttc" id="paths_8h_html"><div class="ttname"><a href="../../dd/df2/paths_8h.html">paths.h</a></div><div class="ttdoc">Asterisk file paths, configured in asterisk.conf. </div></div>
<div class="ttc" id="group__Group__AMI_html_gabf7c909efbfc26d0d9c66786c83b8f69"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gabf7c909efbfc26d0d9c66786c83b8f69">astman_send_list_complete_end</a></div><div class="ttdeci">void astman_send_list_complete_end(struct mansession *s)</div><div class="ttdoc">End the list complete event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03245">manager.c:3245</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa457796588f0d13a7dc02e3db64c2e7d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa457796588f0d13a7dc02e3db64c2e7d">session_do</a></div><div class="ttdeci">static void * session_do(void *data)</div><div class="ttdoc">The body of the individual manager session. Call get_input() to read one line at a time (or be woken ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06937">manager.c:6937</a></div></div>
<div class="ttc" id="json_8h_html_ab3f0d4f9fccd51c964a9501c74669880"><div class="ttname"><a href="../../d4/d05/json_8h.html#ab3f0d4f9fccd51c964a9501c74669880">ast_json_object_iter_value</a></div><div class="ttdeci">struct ast_json * ast_json_object_iter_value(struct ast_json_iter *iter)</div><div class="ttdoc">Get the value from an iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00445">json.c:445</a></div></div>
<div class="ttc" id="structast__http__digest_html_a12166a4bf31948289c00d571af88ed90"><div class="ttname"><a href="../../da/db3/structast__http__digest.html#a12166a4bf31948289c00d571af88ed90">ast_http_digest::response</a></div><div class="ttdeci">const ast_string_field response</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00672">utils.h:672</a></div></div>
<div class="ttc" id="structast__channel__snapshot__dialplan_html_af535fe520577fb6b8795dea539bd0230"><div class="ttname"><a href="../../dc/d3d/structast__channel__snapshot__dialplan.html#af535fe520577fb6b8795dea539bd0230">ast_channel_snapshot_dialplan::appl</a></div><div class="ttdeci">const ast_string_field appl</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00070">stasis_channels.h:70</a></div></div>
<div class="ttc" id="utils_8h_html_a1604b4d72144dd3d9f7da668e90337e9"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a1604b4d72144dd3d9f7da668e90337e9">RAII_VAR</a></div><div class="ttdeci">#define RAII_VAR(vartype, varname, initval, dtor)</div><div class="ttdoc">Declare a variable that will call a destructor function when it goes out of scope. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00911">utils.h:911</a></div></div>
<div class="ttc" id="structast__state__cb__info_html_adbd2034543f941d4cf84f129faee9a0b"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html#adbd2034543f941d4cf84f129faee9a0b">ast_state_cb_info::presence_state</a></div><div class="ttdeci">enum ast_presence_state presence_state</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00106">pbx.h:106</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1da83b02bda7920334b1d7cb85c53be1d50"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da83b02bda7920334b1d7cb85c53be1d50">AST_AOC_BILLING_NORMAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00051">aoc.h:51</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga20256749d9d7e9dd367c6470336eb041"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga20256749d9d7e9dd367c6470336eb041">AO2_GLOBAL_OBJ_STATIC</a></div><div class="ttdeci">static AO2_GLOBAL_OBJ_STATIC(mgr_sessions)</div></div>
<div class="ttc" id="structast__cli__args_html_acf64f219885421479997667d2ed3f08a"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#acf64f219885421479997667d2ed3f08a">ast_cli_args::fd</a></div><div class="ttdeci">const int fd</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00159">cli.h:159</a></div></div>
<div class="ttc" id="stringfields_8h_html_a871274fa4fd2687c7a44849a84df3665"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a871274fa4fd2687c7a44849a84df3665">ast_string_field_init</a></div><div class="ttdeci">#define ast_string_field_init(x, size)</div><div class="ttdoc">Initialize a field pool and fields. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00353">stringfields.h:353</a></div></div>
<div class="ttc" id="channel_8h_html_ab5c41a2130385cadf78c64cacea7e3f9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab5c41a2130385cadf78c64cacea7e3f9">ast_channel_writetrans</a></div><div class="ttdeci">struct ast_trans_pvt * ast_channel_writetrans(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00761">channel_internal_api.c:761</a></div></div>
<div class="ttc" id="structmanager__action_html_a76f76ee5f847833b202461d55b23c17a"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#a76f76ee5f847833b202461d55b23c17a">manager_action::description</a></div><div class="ttdeci">const ast_string_field description</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00158">manager.h:158</a></div></div>
<div class="ttc" id="analys_8c_html_aed7ca058008dc3e5ee131e575abed285"><div class="ttname"><a href="../../d2/d79/analys_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a></div><div class="ttdeci">integer order</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d79/analys_8c_source.html#l00066">analys.c:66</a></div></div>
<div class="ttc" id="structstasis__message__router_html"><div class="ttname"><a href="../../d4/d1b/structstasis__message__router.html">stasis_message_router</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00131">stasis_message_router.c:131</a></div></div>
<div class="ttc" id="lock_8h_html_a6009440c7a72f8e2e3b1ec97641ad160"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a6009440c7a72f8e2e3b1ec97641ad160">AST_PTHREADT_NULL</a></div><div class="ttdeci">#define AST_PTHREADT_NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00066">lock.h:66</a></div></div>
<div class="ttc" id="presencestate_8h_html_ac3452f41c7982c84ca27ecf7b4cc7ce1"><div class="ttname"><a href="../../d6/dd7/presencestate_8h.html#ac3452f41c7982c84ca27ecf7b4cc7ce1">ast_presence_state</a></div><div class="ttdeci">ast_presence_state</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd7/presencestate_8h_source.html#l00026">presencestate.h:26</a></div></div>
<div class="ttc" id="astman_8c_html_ac4a6ae0400e4457f0b35beddec80c93d"><div class="ttname"><a href="../../d2/d4d/astman_8c.html#ac4a6ae0400e4457f0b35beddec80c93d">session</a></div><div class="ttdeci">static struct ast_mansession session</div></div>
<div class="ttc" id="codec_8h_html_a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8"><div class="ttname"><a href="../../d1/d16/codec_8h.html#a0f1467803be2cc40b53765e3df54c212a1b651e46c0b2d93ed26b96c214b997a8">AST_MEDIA_TYPE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d16/codec_8h_source.html#l00031">codec.h:31</a></div></div>
<div class="ttc" id="aoc_8h_html_abbf1344a7eae88ea2cef85c1b0b6c24d"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#abbf1344a7eae88ea2cef85c1b0b6c24d">ast_aoc_encode</a></div><div class="ttdeci">struct ast_aoc_encoded * ast_aoc_encode(struct ast_aoc_decoded *decoded, size_t *out_size, struct ast_channel *chan)</div><div class="ttdoc">encodes a decoded aoc structure so it can be passed on the wire </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00650">aoc.c:650</a></div></div>
<div class="ttc" id="channel_8h_html_acc0ae2c008f4157736ef290e9ca62572"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#acc0ae2c008f4157736ef290e9ca62572">ast_dummy_channel_alloc</a></div><div class="ttdeci">#define ast_dummy_channel_alloc()</div><div class="ttdoc">Create a fake channel structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01283">channel.h:1283</a></div></div>
<div class="ttc" id="structast__custom__function_html"><div class="ttname"><a href="../../db/dc0/structast__custom__function.html">ast_custom_function</a></div><div class="ttdoc">Data structure associated with a custom dialplan function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00118">pbx.h:118</a></div></div>
<div class="ttc" id="acl_8h_html"><div class="ttname"><a href="../../d5/d59/acl_8h.html">acl.h</a></div><div class="ttdoc">Access Control of various sorts. </div></div>
<div class="ttc" id="structmansession__session_html_a93274787fdb55a4b0cc204c9d47c2449"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a93274787fdb55a4b0cc204c9d47c2449">mansession_session::send_events</a></div><div class="ttdeci">int send_events</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01602">manager.c:1602</a></div></div>
<div class="ttc" id="structast__iostream_html"><div class="ttname"><a href="../../de/d03/structast__iostream.html">ast_iostream</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00039">iostream.c:39</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372cab585ccf798297c5ad872cdc8c86da5b5"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372cab585ccf798297c5ad872cdc8c86da5b5">AST_SECURITY_EVENT_REQ_BAD_FORMAT</a></div><div class="ttdoc">Request received with bad formatting. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00093">security_events_defs.h:93</a></div></div>
<div class="ttc" id="codec_8c_html_a26d06e92c695d54e16beb8070dc5461d"><div class="ttname"><a href="../../d5/def/codec_8c.html#a26d06e92c695d54e16beb8070dc5461d">codecs</a></div><div class="ttdeci">static struct ao2_container * codecs</div><div class="ttdoc">Registered codecs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/codec_8c_source.html#l00048">codec.c:48</a></div></div>
<div class="ttc" id="astobj2_8h_html"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html">astobj2.h</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga53925ec1ccff9474e934c4182ec833ef"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga53925ec1ccff9474e934c4182ec833ef">ASTMAN_APPEND_BUF_INITSIZE</a></div><div class="ttdeci">#define ASTMAN_APPEND_BUF_INITSIZE</div><div class="ttdoc">initial allocated size for the astman_append_buf and astman_send_*_va </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03066">manager.c:3066</a></div></div>
<div class="ttc" id="structast__security__event__session__limit_html"><div class="ttname"><a href="../../d7/d64/structast__security__event__session__limit.html">ast_security_event_session_limit</a></div><div class="ttdoc">Request denied because of a session limit. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00240">security_events_defs.h:240</a></div></div>
<div class="ttc" id="channel_8h_html_a82f2c6e4d47f62f6b65c5887eb096fd5a21a03514eb4882151cf8768f6f9cd7ec"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a82f2c6e4d47f62f6b65c5887eb096fd5a21a03514eb4882151cf8768f6f9cd7ec">AST_FLAG_BRIDGE_DUAL_REDIRECT_WAIT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l01036">channel.h:1036</a></div></div>
<div class="ttc" id="structmanager__action_html_acee2bf9117848b5ffbbebb64a540e19f"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#acee2bf9117848b5ffbbebb64a540e19f">manager_action::registered</a></div><div class="ttdeci">unsigned int registered</div><div class="ttdoc">TRUE if the AMI action is registered and the callback can be called. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00178">manager.h:178</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a944b82566722f2247aa35f1328402c98"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a944b82566722f2247aa35f1328402c98">AST_RWLIST_TRAVERSE</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00493">linkedlists.h:493</a></div></div>
<div class="ttc" id="strings_8h_html_ac92713b8d07a45720b2664be70810e55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac92713b8d07a45720b2664be70810e55">ast_strip</a></div><div class="ttdeci">char * ast_strip(char *s)</div><div class="ttdoc">Strip leading/trailing whitespace from a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00219">strings.h:219</a></div></div>
<div class="ttc" id="structast__security__event__successful__auth_html"><div class="ttname"><a href="../../d6/d86/structast__security__event__successful__auth.html">ast_security_event_successful_auth</a></div><div class="ttdoc">Successful authentication. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00382">security_events_defs.h:382</a></div></div>
<div class="ttc" id="stringfields_8h_html_a51b5729220efb7cda4393ed35ecdfea2"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a51b5729220efb7cda4393ed35ecdfea2">AST_STRING_FIELD</a></div><div class="ttdeci">#define AST_STRING_FIELD(name)</div><div class="ttdoc">Declare a string field. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00299">stringfields.h:299</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5da77ad82c423fcfee5299611ed6d7ce"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5da77ad82c423fcfee5299611ed6d7ce">handle_updates</a></div><div class="ttdeci">static enum error_type handle_updates(struct mansession *s, const struct message *m, struct ast_config *cfg, const char *dfn)</div><div class="ttdoc">helper function for action_updateconfig </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03819">manager.c:3819</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gad7dbcf9e4437be66192f797b6b740930"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gad7dbcf9e4437be66192f797b6b740930">action_coreshowchannels</a></div><div class="ttdeci">static int action_coreshowchannels(struct mansession *s, const struct message *m)</div><div class="ttdoc">Manager command &quot;CoreShowChannels&quot; - List currently defined channels and some information about them...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06390">manager.c:6390</a></div></div>
<div class="ttc" id="astobj2_8h_html_aaca5e8eac39a22f9da1c36fc6c922270"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aaca5e8eac39a22f9da1c36fc6c922270">ao2_ref</a></div><div class="ttdeci">#define ao2_ref(o, delta)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00464">astobj2.h:464</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1f8b41308be4c47de8ff89a3b9c7e7d1a1959468a3c5d6aecd2fa1272d8e30fbf">CMP_MATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01031">astobj2.h:1031</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1dad1092f5f7da0428ebd4c6ec4ed78d751"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1dad1092f5f7da0428ebd4c6ec4ed78d751">AST_AOC_BILLING_REVERSE_CHARGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00052">aoc.h:52</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa60da5f18e4bd066b5d6c5d334f3ef9a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa60da5f18e4bd066b5d6c5d334f3ef9a">action_cancel_atxfer</a></div><div class="ttdeci">static int action_cancel_atxfer(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05218">manager.c:5218</a></div></div>
<div class="ttc" id="pbx_8h_html_a3261603753916b98888a5a5fc1d505c3"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a3261603753916b98888a5a5fc1d505c3">ast_extension_state2str</a></div><div class="ttdeci">const char * ast_extension_state2str(int extension_state)</div><div class="ttdoc">Return string representation of the state of an extension. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l03126">pbx.c:3126</a></div></div>
<div class="ttc" id="strings_8h_html_a38a896048b2ca84076864505f0aa8f01"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a38a896048b2ca84076864505f0aa8f01">S_COR</a></div><div class="ttdeci">#define S_COR(a, b, c)</div><div class="ttdoc">returns the equivalent of logic or for strings, with an additional boolean check: second one if not e...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00085">strings.h:85</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a39040e0fe9c0bac870c10ad32afbfb17"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a39040e0fe9c0bac870c10ad32afbfb17">ast_category_first</a></div><div class="ttdeci">struct ast_variable * ast_category_first(struct ast_category *cat)</div><div class="ttdoc">given a pointer to a category, return the root variable. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01157">main/config.c:1157</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a6b4d4d929013de7812fbba4e58353078"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a6b4d4d929013de7812fbba4e58353078">ast_config_destroy</a></div><div class="ttdeci">void ast_config_destroy(struct ast_config *config)</div><div class="ttdoc">Destroys a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01290">extconf.c:1290</a></div></div>
<div class="ttc" id="structmansession_html"><div class="ttname"><a href="../../d2/d8a/structmansession.html">mansession</a></div><div class="ttdoc">In case you didn&amp;#39;t read that giant block of text above the mansession_session struct, the struct mansession is named this solely to keep the API the same in Asterisk. This structure really represents data that is different from Manager action to Manager action. The mansession_session pointer contained within points to session-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01625">manager.c:1625</a></div></div>
<div class="ttc" id="structast__state__cb__info_html_a662bbfb7890c12ee79a4ef1ea5f42a0c"><div class="ttname"><a href="../../df/d4c/structast__state__cb__info.html#a662bbfb7890c12ee79a4ef1ea5f42a0c">ast_state_cb_info::presence_subtype</a></div><div class="ttdeci">const char * presence_subtype</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00107">pbx.h:107</a></div></div>
<div class="ttc" id="utils_8h_html_a7b4f10b070e95ba413e258a3e4b03c20"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a7b4f10b070e95ba413e258a3e4b03c20">ast_random</a></div><div class="ttdeci">long int ast_random(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02064">main/utils.c:2064</a></div></div>
<div class="ttc" id="structast__datastore_html_a03ea21247b5d39b165343431b44131f1"><div class="ttname"><a href="../../d4/d5d/structast__datastore.html#a03ea21247b5d39b165343431b44131f1">ast_datastore::info</a></div><div class="ttdeci">const struct ast_datastore_info * info</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db6/datastore_8h_source.html#l00071">datastore.h:71</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa0b13360e4e6387c7a73239b67a19d57"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa0b13360e4e6387c7a73239b67a19d57">GET_HEADER_SKIP_EMPTY</a></div><div class="ttdeci">#define GET_HEADER_SKIP_EMPTY</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02768">manager.c:2768</a></div></div>
<div class="ttc" id="astobj2_8h_html_aa9fdb5d0a6157a56060d9f7279fe6c49"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aa9fdb5d0a6157a56060d9f7279fe6c49">ao2_lock</a></div><div class="ttdeci">#define ao2_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00718">astobj2.h:718</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gae9440b5a8f6a5fb7e1667674b1507344"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gae9440b5a8f6a5fb7e1667674b1507344">mansession_message_parsing</a></div><div class="ttdeci">mansession_message_parsing</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01615">manager.c:1615</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_a9eb882bf892c0882de06605a4f6d78b2"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#a9eb882bf892c0882de06605a4f6d78b2">AST_SECURITY_EVENT_FAILED_ACL_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_FAILED_ACL_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00208">security_events_defs.h:208</a></div></div>
<div class="ttc" id="structmansession_html_ab91b0fdf6f7223e7889b0bafe6c81639"><div class="ttname"><a href="../../d2/d8a/structmansession.html#ab91b0fdf6f7223e7889b0bafe6c81639">mansession::parsing</a></div><div class="ttdeci">enum mansession_message_parsing parsing</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01629">manager.c:1629</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5226d999bfd60cad437504afd1db054c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5226d999bfd60cad437504afd1db054c">handle_showmanager</a></div><div class="ttdeci">static char * handle_showmanager(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02497">manager.c:2497</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a02212548652c9eb0f3db38dc4e4bd285"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a02212548652c9eb0f3db38dc4e4bd285">AST_RWLIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00569">linkedlists.h:569</a></div></div>
<div class="ttc" id="structast__channel__snapshot__base_html_a298ce3dfc9b5b8a8351e8ed103aa7e5c"><div class="ttname"><a href="../../d6/d29/structast__channel__snapshot__base.html#a298ce3dfc9b5b8a8351e8ed103aa7e5c">ast_channel_snapshot_base::creationtime</a></div><div class="ttdeci">struct timeval creationtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00113">stasis_channels.h:113</a></div></div>
<div class="ttc" id="astmm_8h_html_ab5f0750cc80ba337fdcbddea2d3a1ee6"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ab5f0750cc80ba337fdcbddea2d3a1ee6">ast_strdupa</a></div><div class="ttdeci">#define ast_strdupa(s)</div><div class="ttdoc">duplicate a string in memory from the stack </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00300">astmm.h:300</a></div></div>
<div class="ttc" id="options_8h_html_a7cdafc5a121e87659887ffc9abe36760"><div class="ttname"><a href="../../d7/d5b/options_8h.html#a7cdafc5a121e87659887ffc9abe36760">ast_lastreloadtime</a></div><div class="ttdeci">struct timeval ast_lastreloadtime</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l00337">asterisk.c:337</a></div></div>
<div class="ttc" id="structast__manager__user_html_a06c0918fa1a1aac3d386fca59b12327c"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a06c0918fa1a1aac3d386fca59b12327c">ast_manager_user::chanvars</a></div><div class="ttdeci">struct ast_variable * chanvars</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01657">manager.c:1657</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga70e9f0abcbf6c0aca44ad6e3f941c266"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga70e9f0abcbf6c0aca44ad6e3f941c266">action_logoff</a></div><div class="ttdeci">static int action_logoff(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04387">manager.c:4387</a></div></div>
<div class="ttc" id="manager_8c_html_abd0b094f270d26d8aa3127f3ef116e0f"><div class="ttname"><a href="../../d4/d10/manager_8c.html#abd0b094f270d26d8aa3127f3ef116e0f">auth_rawman_http_callback</a></div><div class="ttdeci">static int auth_rawman_http_callback(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08523">manager.c:8523</a></div></div>
<div class="ttc" id="manager_8c_html_a73a22446241314099a4e371157e360f5"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a73a22446241314099a4e371157e360f5">astman_verify_session_readpermissions</a></div><div class="ttdeci">int astman_verify_session_readpermissions(uint32_t ident, int perm)</div><div class="ttdoc">Verify a session&amp;#39;s read permissions against a permission mask. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07567">manager.c:7567</a></div></div>
<div class="ttc" id="structast__manager__user_html_ad86bb5525a3152b047e308c60c5e365a"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#ad86bb5525a3152b047e308c60c5e365a">ast_manager_user::a1_hash</a></div><div class="ttdeci">char * a1_hash</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01656">manager.c:1656</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a1db41d2bb5281151490fa74f8f8de95d"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a1db41d2bb5281151490fa74f8f8de95d">fast_originate_helper::cid_num</a></div><div class="ttdeci">const ast_string_field cid_num</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="json_8h_html_aa75b709b69e8f05cc4796ccfa8d9d110ae6797350c14c8d420e446232c97d4d67"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110ae6797350c14c8d420e446232c97d4d67">AST_JSON_TRUE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00169">json.h:169</a></div></div>
<div class="ttc" id="manager_8c_html_ae6e7920350915168f60be3ba77be01fa"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ae6e7920350915168f60be3ba77be01fa">find_session_by_nonce</a></div><div class="ttdeci">static struct mansession_session * find_session_by_nonce(const char *username, unsigned long nonce, int *stale)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07518">manager.c:7518</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga156e867b0f9693ddc7225adf19b6044b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga156e867b0f9693ddc7225adf19b6044b">log_action</a></div><div class="ttdeci">static void log_action(const struct message *m, const char *action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06568">manager.c:6568</a></div></div>
<div class="ttc" id="format__cap_8h_html_ab4d69f2179ed5ca138c9b3d85334217f"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#ab4d69f2179ed5ca138c9b3d85334217f">ast_format_cap_append</a></div><div class="ttdeci">#define ast_format_cap_append(cap, format, framing)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00103">format_cap.h:103</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga6833175e09cefe8b9dfaa5ead96fb7b6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga6833175e09cefe8b9dfaa5ead96fb7b6">test_suite_forwarder</a></div><div class="ttdeci">static struct stasis_forward * test_suite_forwarder</div><div class="ttdoc">The stasis_subscription for forwarding the Test topic to the AMI topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01503">manager.c:1503</a></div></div>
<div class="ttc" id="json_8h_html_a6772fcee88746a9d4f6ec6f240b76dd0"><div class="ttname"><a href="../../d4/d05/json_8h.html#a6772fcee88746a9d4f6ec6f240b76dd0">ast_json_string_get</a></div><div class="ttdeci">const char * ast_json_string_get(const struct ast_json *string)</div><div class="ttdoc">Get the value of a JSON string. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00273">json.c:273</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9d8b1e607e3cbb90e48fe541c7b5cf11"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9d8b1e607e3cbb90e48fe541c7b5cf11">manager_json_value_str_append</a></div><div class="ttdeci">static void manager_json_value_str_append(struct ast_json *value, const char *key, struct ast_str **res)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01730">manager.c:1730</a></div></div>
<div class="ttc" id="res__pjsip_8c_html_a8b44a03925325ceaf2de7b079b1541a1"><div class="ttname"><a href="../../de/d96/res__pjsip_8c.html#a8b44a03925325ceaf2de7b079b1541a1">method</a></div><div class="ttdeci">const char * method</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d96/res__pjsip_8c_source.html#l04335">res_pjsip.c:4335</a></div></div>
<div class="ttc" id="strings_8h_html_aec193d64a6309c72d72e5e523ef6076e"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aec193d64a6309c72d72e5e523ef6076e">ast_strsep</a></div><div class="ttdeci">char * ast_strsep(char **s, const char sep, uint32_t flags)</div><div class="ttdoc">Act like strsep but ignore separators inside quotes. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01656">main/utils.c:1656</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_aaee31f4cc48985167efcd38ab252dac8"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#aaee31f4cc48985167efcd38ab252dac8">fast_originate_helper::exten</a></div><div class="ttdeci">const ast_string_field exten</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="manager_8c_html_a2baf609069e59000350384fc6d5e2e48"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a2baf609069e59000350384fc6d5e2e48">managerxmluri</a></div><div class="ttdeci">static struct ast_http_uri managerxmluri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08491">manager.c:8491</a></div></div>
<div class="ttc" id="manager_8c_html_a7df8bb3a46439212b942a1802e5fa167"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a7df8bb3a46439212b942a1802e5fa167">manageruri</a></div><div class="ttdeci">static struct ast_http_uri manageruri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08483">manager.c:8483</a></div></div>
<div class="ttc" id="res__pjsip__authenticator__digest_8c_html_ad920f57db5e8c4e82e415be692af48a8"><div class="ttname"><a href="../../dd/db2/res__pjsip__authenticator__digest_8c.html#ad920f57db5e8c4e82e415be692af48a8">challenge</a></div><div class="ttdeci">static void challenge(const char *realm, pjsip_tx_data *tdata, const pjsip_rx_data *rdata, int is_stale)</div><div class="ttdoc">astobj2 callback for adding digest challenges to responses </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db2/res__pjsip__authenticator__digest_8c_source.html#l00377">res_pjsip_authenticator_digest.c:377</a></div></div>
<div class="ttc" id="linkedlists_8h_html"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html">linkedlists.h</a></div><div class="ttdoc">A set of macros to manage forward-linked lists. </div></div>
<div class="ttc" id="structast__variable_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="../../dd/d02/structast__variable.html#a8f8f80d37794cde9472343e4487ba3eb">ast_variable::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00085">include/asterisk/config.h:85</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9">ast_cli_command</a></div><div class="ttdeci">ast_cli_command</div><div class="ttdoc">calling arguments for new-style handlers. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00151">cli.h:151</a></div></div>
<div class="ttc" id="structast__security__event__inval__password_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../d4/d90/structast__security__event__inval__password.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_inval_password::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00465">security_events_defs.h:465</a></div></div>
<div class="ttc" id="astmm_8h_html_ae63d4f486bcf6eac7c1593f867717d91"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae63d4f486bcf6eac7c1593f867717d91">ast_malloc</a></div><div class="ttdeci">#define ast_malloc(len)</div><div class="ttdoc">A wrapper for malloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00193">astmm.h:193</a></div></div>
<div class="ttc" id="manager_8c_html_af8d11f9c8eeaab4ed0463aa30e3fd3e1"><div class="ttname"><a href="../../d4/d10/manager_8c.html#af8d11f9c8eeaab4ed0463aa30e3fd3e1">handle_manager_show_events</a></div><div class="ttdeci">static char * handle_manager_show_events(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08712">manager.c:8712</a></div></div>
<div class="ttc" id="json_8h_html_ada31ff6e981b88be9f99eaa4774c3d32"><div class="ttname"><a href="../../d4/d05/json_8h.html#ada31ff6e981b88be9f99eaa4774c3d32">ast_json_object_iter_key</a></div><div class="ttdeci">const char * ast_json_object_iter_key(struct ast_json_iter *iter)</div><div class="ttdoc">Get the key from an iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00441">json.c:441</a></div></div>
<div class="ttc" id="structmansession__session_html_a54d7a5d4a31deafdc03b710cf95de534"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a54d7a5d4a31deafdc03b710cf95de534">mansession_session::sessionstart_tv</a></div><div class="ttdeci">struct timeval sessionstart_tv</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01590">manager.c:1590</a></div></div>
<div class="ttc" id="manager_8c_html_a3365df27c910e70c4263cfe6936edb2b"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a3365df27c910e70c4263cfe6936edb2b">manager_http_callback</a></div><div class="ttdeci">static int manager_http_callback(struct ast_tcptls_session_instance *ser, const struct ast_http_uri *urih, const char *uri, enum ast_http_method method, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08442">manager.c:8442</a></div></div>
<div class="ttc" id="manager_8h_html_ac7370fe764f1305cdb3c543d3964d5ed"><div class="ttname"><a href="../../db/d45/manager_8h.html#ac7370fe764f1305cdb3c543d3964d5ed">EVENT_FLAG_AGI</a></div><div class="ttdeci">#define EVENT_FLAG_AGI</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00084">manager.h:84</a></div></div>
<div class="ttc" id="structast__security__event__failed__acl_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../df/d53/structast__security__event__failed__acl.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_failed_acl::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00213">security_events_defs.h:213</a></div></div>
<div class="ttc" id="codec__dahdi_8c_html_aea0622703055b62259903cdab213319b"><div class="ttname"><a href="../../de/d52/codec__dahdi_8c.html#aea0622703055b62259903cdab213319b">channels</a></div><div class="ttdeci">static struct channel_usage channels</div></div>
<div class="ttc" id="http_8h_html_a16fb43ed7e6093a9dc96477ba37b80efa74b1cb5c2ecb5e0bd9af5d46a7b78fd2"><div class="ttname"><a href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa74b1cb5c2ecb5e0bd9af5d46a7b78fd2">AST_HTTP_GET</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00058">http.h:58</a></div></div>
<div class="ttc" id="stasis_8h_html_acac26206b971b094c90839b4049cb6cc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#acac26206b971b094c90839b4049cb6cc">stasis_topic_create</a></div><div class="ttdeci">struct stasis_topic * stasis_topic_create(const char *name)</div><div class="ttdoc">Create a new topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l00618">stasis.c:618</a></div></div>
<div class="ttc" id="manager_8c_html_ab7565a1d462b908f20576b02c493ed27"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ab7565a1d462b908f20576b02c493ed27">function_amiclient</a></div><div class="ttdeci">static int function_amiclient(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t len)</div><div class="ttdoc">${AMI_CLIENT()} Dialplan function - reads manager client data </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08577">manager.c:8577</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a66581086d34dfe7ea86b0644bacef239"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a66581086d34dfe7ea86b0644bacef239">ast_variable_new</a></div><div class="ttdeci">#define ast_variable_new(name, value, filename)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00914">include/asterisk/config.h:914</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1da5c049c80395b1353839451a4f6d790e3"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da5c049c80395b1353839451a4f6d790e3">AST_AOC_BILLING_CALL_FWD_NO_REPLY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00056">aoc.h:56</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga129789bbb3008b50ad8c848f4a70eb52"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga129789bbb3008b50ad8c848f4a70eb52">__manager_event_sessions</a></div><div class="ttdeci">static int __manager_event_sessions(struct ao2_container *sessions, int category, const char *event, int chancount, struct ast_channel **chans, const char *file, int line, const char *func, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07211">manager.c:7211</a></div></div>
<div class="ttc" id="manager_8c_html_a0f80ee007271e5c19ce14fdf196d377b"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a0f80ee007271e5c19ce14fdf196d377b">ami_tls_cfg</a></div><div class="ttdeci">static struct ast_tls_config ami_tls_cfg</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08641">manager.c:8641</a></div></div>
<div class="ttc" id="manager_8c_html_ad09fa931f468002152a3cc2d5ce25eae"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ad09fa931f468002152a3cc2d5ce25eae">unload_module</a></div><div class="ttdeci">static int unload_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09649">manager.c:9649</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadfe2a69fbba4f27c201266a2ca5f989"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadfe2a69fbba4f27c201266a2ca5f989">AST_LIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_LIST_REMOVE_HEAD(head, field)</div><div class="ttdoc">Removes and returns the head entry from a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00832">linkedlists.h:832</a></div></div>
<div class="ttc" id="astobj2_8h_html_a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a2cf7e3433f08351aafe3b0cd31edf7f8a8ccf751bd6749d062999469f0694e7ad">AO2_ALLOC_OPT_LOCK_MUTEX</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00365">astobj2.h:365</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8990d27b9ca1ef2a4265bbb34ece23aca6c84eccb1efc098a6bc1946ac3cb9d43"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8990d27b9ca1ef2a4265bbb34ece23aca6c84eccb1efc098a6bc1946ac3cb9d43">CONFIG_SAVE_FLAG_PRESERVE_EFFECTIVE_CONTEXT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00055">include/asterisk/config.h:55</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a134fe67053d035e763d6cf99916c1bf8"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a134fe67053d035e763d6cf99916c1bf8">fast_originate_helper::vars</a></div><div class="ttdeci">struct ast_variable * vars</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05395">manager.c:5395</a></div></div>
<div class="ttc" id="reqresp__parser_8h_html_a7e4aa55331b8292eff94249de72b807d"><div class="ttname"><a href="../../d1/d8f/reqresp__parser_8h.html#a7e4aa55331b8292eff94249de72b807d">AST_LIST_HEAD_NOLOCK</a></div><div class="ttdeci">AST_LIST_HEAD_NOLOCK(contactliststruct, contact)</div></div>
<div class="ttc" id="aoc_8h_html_a2c726e954f606dc71b37ba93be286ff9"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9">ast_aoc_charge_type</a></div><div class="ttdeci">ast_aoc_charge_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00069">aoc.h:69</a></div></div>
<div class="ttc" id="pbx_8h_html_a64a5b8fdc919806135ad427aca9e71b7"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a64a5b8fdc919806135ad427aca9e71b7">ast_exists_extension</a></div><div class="ttdeci">int ast_exists_extension(struct ast_channel *c, const char *context, const char *exten, int priority, const char *callerid)</div><div class="ttdoc">Determine whether an extension exists. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04179">pbx.c:4179</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2d71cf4726fe666194a3473e39782abe"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2d71cf4726fe666194a3473e39782abe">advance_event</a></div><div class="ttdeci">static struct eventqent * advance_event(struct eventqent *e)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02753">manager.c:2753</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga97955111f384b58ee815bb59f0afa0c5"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga97955111f384b58ee815bb59f0afa0c5">MSG_MOREDATA</a></div><div class="ttdeci">#define MSG_MOREDATA</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03114">manager.c:3114</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga8f05cdf013e1e5fe03ea2615e681bf58"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga8f05cdf013e1e5fe03ea2615e681bf58">authlimit</a></div><div class="ttdeci">static int authlimit</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01480">manager.c:1480</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab8d1a4eb372f1c462aa6cc73468069ab"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab8d1a4eb372f1c462aa6cc73468069ab">timestampevents</a></div><div class="ttdeci">static int timestampevents</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01472">manager.c:1472</a></div></div>
<div class="ttc" id="structpermalias_html"><div class="ttname"><a href="../../de/d4b/structpermalias.html">permalias</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02015">manager.c:2015</a></div></div>
<div class="ttc" id="format__cap_8h_html_aeb38ee3bdc8594745a707c0927146fdb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#aeb38ee3bdc8594745a707c0927146fdb">ast_format_cap_alloc</a></div><div class="ttdeci">#define ast_format_cap_alloc(flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00052">format_cap.h:52</a></div></div>
<div class="ttc" id="manager_8h_html_a777cde87d12b331902f862ec44641688"><div class="ttname"><a href="../../db/d45/manager_8h.html#a777cde87d12b331902f862ec44641688">ast_manager_build_channel_state_string</a></div><div class="ttdeci">struct ast_str * ast_manager_build_channel_state_string(const struct ast_channel_snapshot *snapshot)</div><div class="ttdoc">Generate the AMI message body from a channel snapshot. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1c/manager__channels_8c_source.html#l00561">manager_channels.c:561</a></div></div>
<div class="ttc" id="manager_8c_html_a3b8da7be23f759b74fa78fca2356ea58"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a3b8da7be23f759b74fa78fca2356ea58">amis_desc</a></div><div class="ttdeci">static struct ast_tcptls_session_args amis_desc</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08653">manager.c:8653</a></div></div>
<div class="ttc" id="manager_8c_html_af9f2dfb1df89986ee6613d2bfa541688"><div class="ttname"><a href="../../d4/d10/manager_8c.html#af9f2dfb1df89986ee6613d2bfa541688">astman_datastore_remove</a></div><div class="ttdeci">int astman_datastore_remove(struct mansession *s, struct ast_datastore *datastore)</div><div class="ttdoc">Remove a datastore from a session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09673">manager.c:9673</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga12892108a64ff8588dbcd69a4bdf654e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga12892108a64ff8588dbcd69a4bdf654e">print_event_instance</a></div><div class="ttdeci">static void print_event_instance(struct ast_cli_args *a, struct ast_xml_doc_item *instance)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08793">manager.c:8793</a></div></div>
<div class="ttc" id="acl_8h_html_a3f0c6ca57c26cab3141b15c4b231188b"><div class="ttname"><a href="../../d5/d59/acl_8h.html#a3f0c6ca57c26cab3141b15c4b231188b">ast_apply_acl</a></div><div class="ttdeci">enum ast_acl_sense ast_apply_acl(struct ast_acl_list *acl_list, const struct ast_sockaddr *addr, const char *purpose)</div><div class="ttdoc">Apply a set of rules to a given IP address. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l00800">acl.c:800</a></div></div>
<div class="ttc" id="manager_8c_html_a999f980f0d4926c5688bc346f14301e8"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a999f980f0d4926c5688bc346f14301e8">manager_shutdown</a></div><div class="ttdeci">static void manager_shutdown(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08956">manager.c:8956</a></div></div>
<div class="ttc" id="pbx_8h_html"><div class="ttname"><a href="../../db/de0/pbx_8h.html">pbx.h</a></div><div class="ttdoc">Core PBX routines and definitions. </div></div>
<div class="ttc" id="manager_8c_html_a22192aef4770a1f95ea4f87b4125604d"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a22192aef4770a1f95ea4f87b4125604d">ast_xml_doc_item_cmp_fn</a></div><div class="ttdeci">static int ast_xml_doc_item_cmp_fn(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08705">manager.c:8705</a></div></div>
<div class="ttc" id="structast__tcptls__session__instance_html"><div class="ttname"><a href="../../d6/d49/structast__tcptls__session__instance.html">ast_tcptls_session_instance</a></div><div class="ttdoc">describes a server instance </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00149">tcptls.h:149</a></div></div>
<div class="ttc" id="channel_8h_html_a6cbcba5661d55216968cde8fdf913c89"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a6cbcba5661d55216968cde8fdf913c89">ast_queue_frame</a></div><div class="ttdeci">int ast_queue_frame(struct ast_channel *chan, struct ast_frame *f)</div><div class="ttdoc">Queue one or more frames to a channel&amp;#39;s frame queue. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01139">channel.c:1139</a></div></div>
<div class="ttc" id="structast__aoc__encoded_html"><div class="ttname"><a href="../../d8/d72/structast__aoc__encoded.html">ast_aoc_encoded</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00197">aoc.c:197</a></div></div>
<div class="ttc" id="structactions_html"><div class="ttname"><a href="../../dc/de8/structactions.html">actions</a></div><div class="ttdoc">list of actions registered </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01665">manager.c:1665</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a1a1761c57f73009d305f95d8ad99e2a7"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a1a1761c57f73009d305f95d8ad99e2a7">stasis_message_router_create</a></div><div class="ttdeci">#define stasis_message_router_create(topic)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d25/stasis__message__router_8h_source.html#l00060">stasis_message_router.h:60</a></div></div>
<div class="ttc" id="format__cap_8h_html_a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a51f3293ae7b01a8353bf4aa1204abba5ad111d20686641a6f0fc5efd33c82e97a">AST_FORMAT_CAP_FLAG_DEFAULT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d3c/format__cap_8h_source.html#l00038">format_cap.h:38</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga26805df02a1c92688ae132f29ac4478a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga26805df02a1c92688ae132f29ac4478a">astman_send_response</a></div><div class="ttdeci">void astman_send_response(struct mansession *s, const struct message *m, char *resp, char *msg)</div><div class="ttdoc">Send response in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03154">manager.c:3154</a></div></div>
<div class="ttc" id="manager_8h_html_a9aa10c963efd367eaab256f4a05db100"><div class="ttname"><a href="../../db/d45/manager_8h.html#a9aa10c963efd367eaab256f4a05db100">AMI_VERSION</a></div><div class="ttdeci">#define AMI_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00057">manager.h:57</a></div></div>
<div class="ttc" id="format__cap_8h_html_a4dc6fa9191c19396cfaa57113f5b4af2"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a4dc6fa9191c19396cfaa57113f5b4af2">ast_format_cap_remove_by_type</a></div><div class="ttdeci">void ast_format_cap_remove_by_type(struct ast_format_cap *cap, enum ast_media_type type)</div><div class="ttdoc">Remove all formats matching a specific format type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00525">format_cap.c:525</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a21be6da4b2146b04b4868c2be5cae750"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a21be6da4b2146b04b4868c2be5cae750">AST_RWLIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00544">linkedlists.h:544</a></div></div>
<div class="ttc" id="structeventqent_html"><div class="ttname"><a href="../../d9/d94/structeventqent.html">eventqent</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01459">manager.c:1459</a></div></div>
<div class="ttc" id="manager_8h_html_a5622d5b2d0baf505daf7b2a1e99c1140a68beaf6e96b2e55b9301d1883add4c0a"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5622d5b2d0baf505daf7b2a1e99c1140a68beaf6e96b2e55b9301d1883add4c0a">ORDER_NATURAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00283">manager.h:283</a></div></div>
<div class="ttc" id="acl_8h_html_aaf71cd7b64f531d2ec068b7680869238"><div class="ttname"><a href="../../d5/d59/acl_8h.html#aaf71cd7b64f531d2ec068b7680869238">ast_acl_list_is_empty</a></div><div class="ttdeci">int ast_acl_list_is_empty(struct ast_acl_list *acl_list)</div><div class="ttdoc">Determines if an ACL is empty or if it contains entries. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l00541">acl.c:541</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a846844eb2c4eb44554445936b3770711"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a846844eb2c4eb44554445936b3770711">CONFIG_STATUS_FILEUNCHANGED</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEUNCHANGED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00059">include/asterisk/config.h:59</a></div></div>
<div class="ttc" id="manager_8c_html_a3ace32eaf9a3fc2f7d15121c64bf8ecd"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a3ace32eaf9a3fc2f7d15121c64bf8ecd">ast_manager_event_blob_create</a></div><div class="ttdeci">struct ast_manager_event_blob * ast_manager_event_blob_create(int event_flags, const char *manager_event, const char *extra_fields_fmt,...)</div><div class="ttdoc">Construct a ast_manager_event_blob. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09727">manager.c:9727</a></div></div>
<div class="ttc" id="stasis_8h_html_ae3fe7fe099389094244002113814ec23"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ae3fe7fe099389094244002113814ec23">stasis_subscribe</a></div><div class="ttdeci">#define stasis_subscribe(topic, callback, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00652">stasis.h:652</a></div></div>
<div class="ttc" id="manager_8c_html_a09a999bc75726a4215330a1fc409468c"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a09a999bc75726a4215330a1fc409468c">manager_subscriptions_init</a></div><div class="ttdeci">static int manager_subscriptions_init(void)</div><div class="ttdoc">Initialize all Stasis Message Bus API topics and routers used by the various sub-components of AMI...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09053">manager.c:9053</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html_abf4247f8de03d593ac8e288d354d6aa9"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html#abf4247f8de03d593ac8e288d354d6aa9">ast_xml_doc_item::description</a></div><div class="ttdeci">struct ast_str * description</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00066">xmldoc.h:66</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga7c363bd89e1d8a7c36513fa83f3d08af"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga7c363bd89e1d8a7c36513fa83f3d08af">acl_change_stasis_unsubscribe</a></div><div class="ttdeci">static void acl_change_stasis_unsubscribe(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01544">manager.c:1544</a></div></div>
<div class="ttc" id="structast__http__digest_html"><div class="ttname"><a href="../../da/db3/structast__http__digest.html">ast_http_digest</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00661">utils.h:661</a></div></div>
<div class="ttc" id="structeventqent_html_ab0f2e84f976dc042139d37fd1c28d73b"><div class="ttname"><a href="../../d9/d94/structeventqent.html#ab0f2e84f976dc042139d37fd1c28d73b">eventqent::usecount</a></div><div class="ttdeci">int usecount</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01460">manager.c:1460</a></div></div>
<div class="ttc" id="term_8h_html_a7b6c72116c334f40bf7c1e50e793c93b"><div class="ttname"><a href="../../db/d45/term_8h.html#a7b6c72116c334f40bf7c1e50e793c93b">term_color</a></div><div class="ttdeci">char * term_color(char *outbuf, const char *inbuf, int fgcolor, int bgcolor, int maxout)</div><div class="ttdoc">Colorize a specified string by adding terminal color codes. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de5/term_8c_source.html#l00184">term.c:184</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7a3c7e5ccf0a567b17833b1e60ba387abf"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a3c7e5ccf0a567b17833b1e60ba387abf">AST_MODULE_RELOAD_QUEUED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00111">module.h:111</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="channel_8h_html_a3b6254f6d3832ef928f0a727113b1c63"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a3b6254f6d3832ef928f0a727113b1c63">ast_channel_uniqueid</a></div><div class="ttdeci">const char * ast_channel_uniqueid(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00305">channel_internal_api.c:305</a></div></div>
<div class="ttc" id="structmanager__action_html_ad3d4ea338fb9552532c6828f6c312c57"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#ad3d4ea338fb9552532c6828f6c312c57">manager_action::arguments</a></div><div class="ttdeci">const ast_string_field arguments</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00158">manager.h:158</a></div></div>
<div class="ttc" id="structast__cli__args_html_ad0a19c4d63698f9e9cfd5653e8851452"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#ad0a19c4d63698f9e9cfd5653e8851452">ast_cli_args::argv</a></div><div class="ttdeci">const char *const  * argv</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00161">cli.h:161</a></div></div>
<div class="ttc" id="structast__manager__user_html_ac53d23749250e5f0d95992b5d9ebc60c"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#ac53d23749250e5f0d95992b5d9ebc60c">ast_manager_user::acl</a></div><div class="ttdeci">struct ast_acl_list * acl</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01655">manager.c:1655</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92a873b7dc80f148550a62038a0f860f31d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a873b7dc80f148550a62038a0f860f31d">FAILURE_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01429">manager.c:1429</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gafaa1369a2d928db0f753144acdeb2ed1"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafaa1369a2d928db0f753144acdeb2ed1">__manager_event_sessions_va</a></div><div class="ttdeci">static int __manager_event_sessions_va(struct ao2_container *sessions, int category, const char *event, int chancount, struct ast_channel **chans, const char *file, int line, const char *func, const char *fmt, va_list ap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07112">manager.c:7112</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2cf03665d072e22c68953f8dadc65690"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2cf03665d072e22c68953f8dadc65690">action_listcommands</a></div><div class="ttdeci">static int action_listcommands(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04324">manager.c:4324</a></div></div>
<div class="ttc" id="iostream_8h_html_ace332a00f395eb7d1c93d0ee00bdf6c2"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#ace332a00f395eb7d1c93d0ee00bdf6c2">ast_iostream_set_timeout_disable</a></div><div class="ttdeci">void ast_iostream_set_timeout_disable(struct ast_iostream *stream)</div><div class="ttdoc">Disable the iostream timeout timer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00113">iostream.c:113</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gafadf012f66a9fd7ecf985ec5b9dee101"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gafadf012f66a9fd7ecf985ec5b9dee101">ast_manager_unregister</a></div><div class="ttdeci">int ast_manager_unregister(const char *action)</div><div class="ttdoc">support functions to register/unregister AMI action handlers, </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07258">manager.c:7258</a></div></div>
<div class="ttc" id="md5_8h_html_a2a146d25ee54b589dd79d776522ef742"><div class="ttname"><a href="../../da/db0/md5_8h.html#a2a146d25ee54b589dd79d776522ef742">MD5Update</a></div><div class="ttdeci">void MD5Update(struct MD5Context *context, unsigned char const *buf, unsigned len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6c/md5_8c_source.html#l00072">md5.c:72</a></div></div>
<div class="ttc" id="manager_8h_html"><div class="ttname"><a href="../../db/d45/manager_8h.html">manager.h</a></div><div class="ttdoc">The AMI - Asterisk Manager Interface - is a TCP protocol created to manage Asterisk with third-party ...</div></div>
<div class="ttc" id="security__events__defs_8h_html_aba272dad0be48d171bd66fde6f64db37"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#aba272dad0be48d171bd66fde6f64db37">AST_SECURITY_EVENT_INVAL_ACCT_ID_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_INVAL_ACCT_ID_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00229">security_events_defs.h:229</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0044f6572f50a89049b3b5272e51b0e7"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0044f6572f50a89049b3b5272e51b0e7">AST_RWLIST_EMPTY</a></div><div class="ttdeci">#define AST_RWLIST_EMPTY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00451">linkedlists.h:451</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaeac2210b7c1bd030e2766730c0f6f0e6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaeac2210b7c1bd030e2766730c0f6f0e6">GET_HEADER_FIRST_MATCH</a></div><div class="ttdeci">#define GET_HEADER_FIRST_MATCH</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02766">manager.c:2766</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab96bdf674e2ebee782bfde795f93062e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab96bdf674e2ebee782bfde795f93062e">subscribed</a></div><div class="ttdeci">static int subscribed</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01476">manager.c:1476</a></div></div>
<div class="ttc" id="manager_8c_html_a3986a4fb4a5da67741b41cedefd34049"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a3986a4fb4a5da67741b41cedefd34049">__init_manager</a></div><div class="ttdeci">static int __init_manager(int reload, int by_external_config)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09144">manager.c:9144</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7a9696155a2eb5969139965fbc5b8a66ed"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a9696155a2eb5969139965fbc5b8a66ed">AST_MODULE_RELOAD_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00110">module.h:110</a></div></div>
<div class="ttc" id="presencestate_8h_html"><div class="ttname"><a href="../../d6/dd7/presencestate_8h.html">presencestate.h</a></div><div class="ttdoc">Presence state management. </div></div>
<div class="ttc" id="structast__bridge_html"><div class="ttname"><a href="../../d4/d84/structast__bridge.html">ast_bridge</a></div><div class="ttdoc">Structure that contains information about a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l00357">bridge.h:357</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1da91a7d97d8c344b40e9aaadc39c4d9269"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da91a7d97d8c344b40e9aaadc39c4d9269">AST_AOC_BILLING_CREDIT_CARD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00053">aoc.h:53</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1daf2aa1a3d8a87f17ac604cead1964f52f"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1daf2aa1a3d8a87f17ac604cead1964f52f">AST_AOC_BILLING_NA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00050">aoc.h:50</a></div></div>
<div class="ttc" id="structmansession_html_affd6ea965816bd0ac40c18d7b5de8de6"><div class="ttname"><a href="../../d2/d8a/structmansession.html#affd6ea965816bd0ac40c18d7b5de8de6">mansession::tcptls_session</a></div><div class="ttdeci">struct ast_tcptls_session_instance * tcptls_session</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01628">manager.c:1628</a></div></div>
<div class="ttc" id="structast__var__t_html_a2a7f851274ec18e17d38114c39b8511a"><div class="ttname"><a href="../../d0/d7d/structast__var__t.html#a2a7f851274ec18e17d38114c39b8511a">ast_var_t::name</a></div><div class="ttdeci">char name[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/chanvars_8h_source.html#l00031">chanvars.h:31</a></div></div>
<div class="ttc" id="aoc_8h_html_a82fcf407f11289b3675f0880f2245bfe"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a82fcf407f11289b3675f0880f2245bfe">ast_aoc_set_billing_id</a></div><div class="ttdeci">int ast_aoc_set_billing_id(struct ast_aoc_decoded *decoded, const enum ast_aoc_billing_id id)</div><div class="ttdoc">set the billing id for a AOC-D or AST_AOC_E message </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l01024">aoc.c:1024</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089a6060df3e95e44802a372af9f0eb5ebaf"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a6060df3e95e44802a372af9f0eb5ebaf">AST_AOC_MULT_ONETENTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00037">aoc.h:37</a></div></div>
<div class="ttc" id="aoc_8h_html_aa7dc1e0987972e9eb92627a1190eb548"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548">ast_aoc_type</a></div><div class="ttdeci">ast_aoc_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00062">aoc.h:62</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a103e76ed4bd42f776f7f260080b98b3fa3b68640f31a2c5493459c159abee08ee"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fa3b68640f31a2c5493459c159abee08ee">CONFIG_FLAG_NOCACHE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00045">include/asterisk/config.h:45</a></div></div>
<div class="ttc" id="channel_8h_html_a43d96fc80c7e8289f1fac8d7b8fef3ec"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a43d96fc80c7e8289f1fac8d7b8fef3ec">ast_channel_set_manager_vars</a></div><div class="ttdeci">void ast_channel_set_manager_vars(size_t varc, char **vars)</div><div class="ttdoc">Sets the variables to be stored in the manager_vars field of all snapshots. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l07989">channel.c:7989</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga66c34a7f788ab4d323b1bee27256906d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga66c34a7f788ab4d323b1bee27256906d">astman_append_buf</a></div><div class="ttdeci">static struct ast_threadstorage astman_append_buf</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03061">manager.c:3061</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gadeb39f5a951b5c08eac6d0b872084fef"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gadeb39f5a951b5c08eac6d0b872084fef">user_authority_to_str</a></div><div class="ttdeci">static const char * user_authority_to_str(int authority, struct ast_str **res)</div><div class="ttdoc">Convert authority code to a list of options for a user. This will only display those authority codes ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02060">manager.c:2060</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga960097199ef3da5b50b2b041eae8495d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga960097199ef3da5b50b2b041eae8495d">astman_flush</a></div><div class="ttdeci">static void astman_flush(struct mansession *s, struct ast_str *buf)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03068">manager.c:3068</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga12e82c44fa806bdf33e7e4d92c04f707"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga12e82c44fa806bdf33e7e4d92c04f707">acl_change_stasis_subscribe</a></div><div class="ttdeci">static void acl_change_stasis_subscribe(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01534">manager.c:1534</a></div></div>
<div class="ttc" id="manager_8h_html_a5622d5b2d0baf505daf7b2a1e99c1140aacb866340e59acaa596f8d94a8b61daf"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5622d5b2d0baf505daf7b2a1e99c1140aacb866340e59acaa596f8d94a8b61daf">ORDER_REVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00284">manager.h:284</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga1fbdb833cde8f5286f6671033665a2aa"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga1fbdb833cde8f5286f6671033665a2aa">queue_read_action_payload</a></div><div class="ttdeci">static int queue_read_action_payload(struct ast_channel *chan, const unsigned char *payload, size_t payload_size, enum ast_frame_read_action action)</div><div class="ttdoc">Queue a given read action containing a payload onto a channel. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04864">manager.c:4864</a></div></div>
<div class="ttc" id="manager_8h_html_a36fb89c2a73755209133b6c73fe92e54"><div class="ttname"><a href="../../db/d45/manager_8h.html#a36fb89c2a73755209133b6c73fe92e54">EVENT_FLAG_CONFIG</a></div><div class="ttdeci">#define EVENT_FLAG_CONFIG</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00078">manager.h:78</a></div></div>
<div class="ttc" id="astobj2_8h_html_aefc16f8aa9087cbc5c55c70cf1dd41b2"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aefc16f8aa9087cbc5c55c70cf1dd41b2">ao2_container_alloc_hash</a></div><div class="ttdeci">#define ao2_container_alloc_hash(ao2_options, container_options, n_buckets, hash_fn, sort_fn, cmp_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01310">astobj2.h:1310</a></div></div>
<div class="ttc" id="structast__manager__event__blob_html_a57602302e7b352ebd03ca187acfcffd4"><div class="ttname"><a href="../../dd/d96/structast__manager__event__blob.html#a57602302e7b352ebd03ca187acfcffd4">ast_manager_event_blob::event_flags</a></div><div class="ttdeci">int event_flags</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00492">manager.h:492</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga11ada23da895363223ba26f69d39029a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga11ada23da895363223ba26f69d39029a">strings_to_mask</a></div><div class="ttdeci">static int strings_to_mask(const char *string)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02152">manager.c:2152</a></div></div>
<div class="ttc" id="structast__http__digest_html_af88f810d87ba0804816dea48a1fa23af"><div class="ttname"><a href="../../da/db3/structast__http__digest.html#af88f810d87ba0804816dea48a1fa23af">ast_http_digest::qop</a></div><div class="ttdeci">int qop</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00673">utils.h:673</a></div></div>
<div class="ttc" id="strings_8h_html_a387a69b3871ca31061566a73f45d20f4"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a387a69b3871ca31061566a73f45d20f4">ast_true</a></div><div class="ttdeci">int attribute_pure ast_true(const char *val)</div><div class="ttdoc">Make sure something is true. Determine if a string containing a boolean value is &quot;true&quot;. This function checks to see whether a string passed to it is an indication of an &quot;true&quot; value. It checks to see if the string is &quot;yes&quot;, &quot;true&quot;, &quot;y&quot;, &quot;t&quot;, &quot;on&quot; or &quot;1&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01951">main/utils.c:1951</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gad3ecc04e5e7484463d64fa6d00c2bdd2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gad3ecc04e5e7484463d64fa6d00c2bdd2">handle_showmancmds</a></div><div class="ttdeci">static char * handle_showmancmds(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdoc">CLI command manager list commands. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02613">manager.c:2613</a></div></div>
<div class="ttc" id="structast__str_html"><div class="ttname"><a href="../../dd/da2/structast__str.html">ast_str</a></div><div class="ttdoc">The descriptor of a dynamic string XXX storage will be optimized later if needed We use the ts field ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00584">strings.h:584</a></div></div>
<div class="ttc" id="iostream_8h_html_aa8aec9f4431f3420f3ffa925e4dc306a"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#aa8aec9f4431f3420f3ffa925e4dc306a">ast_iostream_set_timeout_sequence</a></div><div class="ttdeci">void ast_iostream_set_timeout_sequence(struct ast_iostream *stream, struct timeval start, int timeout)</div><div class="ttdoc">Set the iostream I/O sequence timeout timer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00139">iostream.c:139</a></div></div>
<div class="ttc" id="structast__format__cap_html"><div class="ttname"><a href="../../d8/d69/structast__format__cap.html">ast_format_cap</a></div><div class="ttdoc">Format capabilities structure, holds formats + preference order + etc. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00054">format_cap.c:54</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga1e0bee965191aad897199382d0f36aba"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga1e0bee965191aad897199382d0f36aba">action_mailboxcount</a></div><div class="ttdeci">static int action_mailboxcount(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05953">manager.c:5953</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab7a51272a96fcd2792382b4d0bf254f6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab7a51272a96fcd2792382b4d0bf254f6">set_eventmask</a></div><div class="ttdeci">static int set_eventmask(struct mansession *s, const char *eventmask)</div><div class="ttdoc">Rather than braindead on,off this now can also accept a specific int mask value or a &amp;#39;...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03266">manager.c:3266</a></div></div>
<div class="ttc" id="channel_8h_html_abd6165fa9617e1bb5efee3befa3e963d"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abd6165fa9617e1bb5efee3befa3e963d">ast_channel_connected_effective_id</a></div><div class="ttdeci">struct ast_party_id ast_channel_connected_effective_id(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00900">channel_internal_api.c:900</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089a20055187dd0b3834fe5cc313e1f08965"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a20055187dd0b3834fe5cc313e1f08965">AST_AOC_MULT_TEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00039">aoc.h:39</a></div></div>
<div class="ttc" id="astobj2_8h_html_a64f51be4bee35c38dbe59b0a788b5ce8"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a64f51be4bee35c38dbe59b0a788b5ce8">ao2_unlink</a></div><div class="ttdeci">#define ao2_unlink(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01598">astobj2.h:1598</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga4162d86f823ac8c40424a3ae4f41d5b9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga4162d86f823ac8c40424a3ae4f41d5b9">manager_debug</a></div><div class="ttdeci">static int manager_debug</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01478">manager.c:1478</a></div></div>
<div class="ttc" id="structast__var__t_html"><div class="ttname"><a href="../../d0/d7d/structast__var__t.html">ast_var_t</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/chanvars_8h_source.html#l00028">chanvars.h:28</a></div></div>
<div class="ttc" id="cli_8h_html_a0873456096960dab21fff0ce68c95acb"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a0873456096960dab21fff0ce68c95acb">CLI_SHOWUSAGE</a></div><div class="ttdeci">#define CLI_SHOWUSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00045">cli.h:45</a></div></div>
<div class="ttc" id="paths_8h_html_a7d3836e5581e433c9f5edd30300cc187"><div class="ttname"><a href="../../dd/df2/paths_8h.html#a7d3836e5581e433c9f5edd30300cc187">ast_config_AST_CONFIG_DIR</a></div><div class="ttdeci">const char * ast_config_AST_CONFIG_DIR</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00151">options.c:151</a></div></div>
<div class="ttc" id="pbx_8h_html_aaf906a18ba2dcd53c35f59869757521f"><div class="ttname"><a href="../../db/de0/pbx_8h.html#aaf906a18ba2dcd53c35f59869757521f">pbx_retrieve_variable</a></div><div class="ttdeci">void pbx_retrieve_variable(struct ast_channel *c, const char *var, char **ret, char *workspace, int workspacelen, struct varshead *headp)</div><div class="ttdoc">Retrieve the value of a builtin variable or variable from the channel variable stack. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l00235">pbx_variables.c:235</a></div></div>
<div class="ttc" id="netsock2_8h_html_ac83e6bdec376b74d02da8d2f8e1af888"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#ac83e6bdec376b74d02da8d2f8e1af888">ast_sockaddr_set_port</a></div><div class="ttdeci">#define ast_sockaddr_set_port(addr, port)</div><div class="ttdoc">Sets the port number of a socket address. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00537">netsock2.h:537</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html">stasis_message_router.h</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga6d6d7bdd31cb1b6f84f2e447a7a2c6c2"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga6d6d7bdd31cb1b6f84f2e447a7a2c6c2">stasis_router</a></div><div class="ttdeci">static struct stasis_message_router * stasis_router</div><div class="ttdoc">The stasis_message_router for all Stasis Message Bus API messages. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01493">manager.c:1493</a></div></div>
<div class="ttc" id="stasis_8h_html_af6081f17431b81bc1a010b680517491d"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#af6081f17431b81bc1a010b680517491d">stasis_message_data</a></div><div class="ttdeci">void * stasis_message_data(const struct stasis_message *msg)</div><div class="ttdoc">Get the data contained in a message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00195">stasis_message.c:195</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92aa8e1a46fc31ba23e18080284f3938d75"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92aa8e1a46fc31ba23e18080284f3938d75">FAILURE_DELCAT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01426">manager.c:1426</a></div></div>
<div class="ttc" id="stasis_8h_html_a72a06fdaec039fdfb5f36892e725f9ec"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a72a06fdaec039fdfb5f36892e725f9ec">stasis_message_create</a></div><div class="ttdeci">struct stasis_message * stasis_message_create(struct stasis_message_type *type, void *data)</div><div class="ttdoc">Create a new message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00174">stasis_message.c:174</a></div></div>
<div class="ttc" id="astobj2_8h_html_ac0e1cbc7cf050c8b7b8e3a8fee92c50e"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ac0e1cbc7cf050c8b7b8e3a8fee92c50e">ao2_global_obj_release</a></div><div class="ttdeci">#define ao2_global_obj_release(holder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00865">astobj2.h:865</a></div></div>
<div class="ttc" id="provision_8c_html_a45e847f4fe454799dfd46a84eca1daf6"><div class="ttname"><a href="../../d8/d4f/provision_8c.html#a45e847f4fe454799dfd46a84eca1daf6">templates</a></div><div class="ttdeci">static struct templates templates</div></div>
<div class="ttc" id="acl_8h_html_a7fc796b79184fa0f4340037e5c1445c6"><div class="ttname"><a href="../../d5/d59/acl_8h.html#a7fc796b79184fa0f4340037e5c1445c6">ast_free_acl_list</a></div><div class="ttdeci">struct ast_acl_list * ast_free_acl_list(struct ast_acl_list *acl)</div><div class="ttdoc">Free a list of ACLs. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l00233">acl.c:233</a></div></div>
<div class="ttc" id="pbx_8h_html_a0be9518646cf9aca4878b313cc02e901"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a0be9518646cf9aca4878b313cc02e901">ast_findlabel_extension</a></div><div class="ttdeci">int ast_findlabel_extension(struct ast_channel *c, const char *context, const char *exten, const char *label, const char *callerid)</div><div class="ttdoc">Find the priority of an extension that has the specified label. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l04184">pbx.c:4184</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#ad60d9d8c34b4f61493c1d85ae02d569fa37848843c0c65e9ce998148c2f16d585">PARSE_IN_RANGE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l01125">include/asterisk/config.h:1125</a></div></div>
<div class="ttc" id="manager_8c_html_adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824"><div class="ttname"><a href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a9bf619d1a083a4082d78f40641281824">FORMAT_HTML</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07464">manager.c:7464</a></div></div>
<div class="ttc" id="manager_8h_html_acc12c2bc03dce67ddd1590d67ab11f4d"><div class="ttname"><a href="../../db/d45/manager_8h.html#acc12c2bc03dce67ddd1590d67ab11f4d">EVENT_FLAG_USER</a></div><div class="ttdeci">#define EVENT_FLAG_USER</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00077">manager.h:77</a></div></div>
<div class="ttc" id="namespacesip__to__pjsip_html_ab82f408a83ecba10ea39afd8abfd371e"><div class="ttname"><a href="../../dd/d17/namespacesip__to__pjsip.html#ab82f408a83ecba10ea39afd8abfd371e">sip_to_pjsip.info</a></div><div class="ttdeci">def info(msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/sip__to__pjsip_8py_source.html#l01313">sip_to_pjsip.py:1313</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga7e2a5d3d8ab0739e46d14c8cd369178a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga7e2a5d3d8ab0739e46d14c8cd369178a">manager_json_array_with_key</a></div><div class="ttdeci">static void manager_json_array_with_key(struct ast_json *obj, const char *key, size_t index, struct ast_str **res, key_exclusion_cb exclusion_cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01755">manager.c:1755</a></div></div>
<div class="ttc" id="func__strings_8c_html_af24e73aaf92f3000fda15d285e66df24"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af24e73aaf92f3000fda15d285e66df24">len</a></div><div class="ttdeci">static int len(struct ast_channel *chan, const char *cmd, char *data, char *buf, size_t buflen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l01344">func_strings.c:1344</a></div></div>
<div class="ttc" id="structast__var__t_html_a325611b97f57f55a57b2a7cf3238ef54"><div class="ttname"><a href="../../d0/d7d/structast__var__t.html#a325611b97f57f55a57b2a7cf3238ef54">ast_var_t::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/chanvars_8h_source.html#l00030">chanvars.h:30</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="astobj2_8h_html_a63fd831fe48aed32d3ef992ad8e45293"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a63fd831fe48aed32d3ef992ad8e45293">ao2_callback_data</a></div><div class="ttdeci">#define ao2_callback_data(container, flags, cb_fn, arg, data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01743">astobj2.h:1743</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a0ca0a0b3e0d6aafb1b2ff7e291f1acb0"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a0ca0a0b3e0d6aafb1b2ff7e291f1acb0">fast_originate_helper::appdata</a></div><div class="ttdeci">const ast_string_field appdata</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a3e27edf18993cf1250e1a6a08c971d6d"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a3e27edf18993cf1250e1a6a08c971d6d">ast_category_insert</a></div><div class="ttdeci">int ast_category_insert(struct ast_config *config, struct ast_category *cat, const char *match)</div><div class="ttdoc">Inserts new category. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01083">main/config.c:1083</a></div></div>
<div class="ttc" id="manager_8c_html_ac8dc47e3b39c930caed4bfd05b4ba805"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ac8dc47e3b39c930caed4bfd05b4ba805">FORMAT</a></div><div class="ttdeci">#define FORMAT</div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html_a9671de8d09fae2ba3954919c2fdc3030"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html#a9671de8d09fae2ba3954919c2fdc3030">ast_get_builtin_feature</a></div><div class="ttdeci">int ast_get_builtin_feature(struct ast_channel *chan, const char *feature, char *buf, size_t len)</div><div class="ttdoc">Get the DTMF code for a builtin feature. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d71/features__config_8c_source.html#l01233">features_config.c:1233</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga21a20a25e6d03f6fd32cdc86fe9b53d1"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga21a20a25e6d03f6fd32cdc86fe9b53d1">astman_get_variables</a></div><div class="ttdeci">struct ast_variable * astman_get_variables(const struct message *m)</div><div class="ttdoc">Get a linked list of the Variable: headers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02906">manager.c:2906</a></div></div>
<div class="ttc" id="module_8h_html_a52f6615f305951a0d61adc6e61920c34"><div class="ttname"><a href="../../d5/d16/module_8h.html#a52f6615f305951a0d61adc6e61920c34">ast_unload_resource</a></div><div class="ttdeci">int ast_unload_resource(const char *resource_name, enum ast_module_unload_mode)</div><div class="ttdoc">Unload a module. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d96/loader_8c_source.html#l01229">loader.c:1229</a></div></div>
<div class="ttc" id="manager_8h_html_a5622d5b2d0baf505daf7b2a1e99c1140"><div class="ttname"><a href="../../db/d45/manager_8h.html#a5622d5b2d0baf505daf7b2a1e99c1140">variable_orders</a></div><div class="ttdeci">variable_orders</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00282">manager.h:282</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga270644a6d4f3d622e763df47b0cbfce8"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga270644a6d4f3d622e763df47b0cbfce8">report_failed_acl</a></div><div class="ttdeci">static void report_failed_acl(const struct mansession *s, const char *username)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03310">manager.c:3310</a></div></div>
<div class="ttc" id="test_8c_html_a16aebec5cd59d344358e6780d3b62871"><div class="ttname"><a href="../../d8/db9/test_8c.html#a16aebec5cd59d344358e6780d3b62871">ast_test_suite_topic</a></div><div class="ttdeci">struct stasis_topic * ast_test_suite_topic(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/db9/test_8c_source.html#l01069">test.c:1069</a></div></div>
<div class="ttc" id="astobj2_8h_html_aeca960ec22a1d0384f6e285b25df8501"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#aeca960ec22a1d0384f6e285b25df8501">ao2_t_callback</a></div><div class="ttdeci">#define ao2_t_callback(c, flags, cb_fn, arg, tag)</div><div class="ttdoc">ao2_callback() is a generic function that applies cb_fn() to all objects in a container, as described below. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01714">astobj2.h:1714</a></div></div>
<div class="ttc" id="structast__http__uri_html_a68344fa88cf4e86b5079fd69a5c22d57"><div class="ttname"><a href="../../d0/d6c/structast__http__uri.html#a68344fa88cf4e86b5079fd69a5c22d57">ast_http_uri::description</a></div><div class="ttdeci">const char * description</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00102">http.h:102</a></div></div>
<div class="ttc" id="manager_8c_html_ac86d9b2afbd62d5777ba528325cb318b"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ac86d9b2afbd62d5777ba528325cb318b">xml_translate</a></div><div class="ttdeci">static void xml_translate(struct ast_str **out, char *in, struct ast_variable *get_vars, enum output_format format)</div><div class="ttdoc">Convert the input into XML or HTML. The input is supposed to be a sequence of lines of the form Name:...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07746">manager.c:7746</a></div></div>
<div class="ttc" id="netsock2_8h_html_aae9156c7fe6dff51463f29ed1c3b96c9"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aae9156c7fe6dff51463f29ed1c3b96c9">ast_sockaddr_stringify</a></div><div class="ttdeci">static char * ast_sockaddr_stringify(const struct ast_sockaddr *addr)</div><div class="ttdoc">Wrapper around ast_sockaddr_stringify_fmt() with default format. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00260">netsock2.h:260</a></div></div>
<div class="ttc" id="structvarshead_html"><div class="ttname"><a href="../../dd/de6/structvarshead.html">varshead</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de7/chanvars_8h_source.html#l00034">chanvars.h:34</a></div></div>
<div class="ttc" id="structast__manager__user_html_a9d6ad22f239563cb0ec69d475299fa87"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a9d6ad22f239563cb0ec69d475299fa87">ast_manager_user::allowmultiplelogin</a></div><div class="ttdeci">int allowmultiplelogin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01651">manager.c:1651</a></div></div>
<div class="ttc" id="channel_8h_html_a63732831df3e7a0999b0900ec85c626a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a63732831df3e7a0999b0900ec85c626a">ast_channel_dialed</a></div><div class="ttdeci">struct ast_party_dialed * ast_channel_dialed(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00904">channel_internal_api.c:904</a></div></div>
<div class="ttc" id="manager_8c_html_a2c50d07b002a16d9ddfa6eb70ac5f977"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a2c50d07b002a16d9ddfa6eb70ac5f977">words</a></div><div class="ttdeci">const char * words[AST_MAX_CMD_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01525">manager.c:1525</a></div></div>
<div class="ttc" id="structmansession__session_html_a7782a214e6947ec252279744b2b13484"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a7782a214e6947ec252279744b2b13484">mansession_session::noncetime</a></div><div class="ttdeci">time_t noncetime</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01607">manager.c:1607</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372cab2e0e2ff82bce347821f967f1729c3fd"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372cab2e0e2ff82bce347821f967f1729c3fd">AST_SECURITY_EVENT_CHAL_RESP_FAILED</a></div><div class="ttdoc">An attempt at challenge/response authentication failed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00105">security_events_defs.h:105</a></div></div>
<div class="ttc" id="strings_8h_html_af5693da955fa3bc73bc49c47b601fc7a"><div class="ttname"><a href="../../d6/d90/strings_8h.html#af5693da955fa3bc73bc49c47b601fc7a">ast_skip_blanks</a></div><div class="ttdeci">char * ast_skip_blanks(const char *str)</div><div class="ttdoc">Gets a pointer to the first non-whitespace character in a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00157">strings.h:157</a></div></div>
<div class="ttc" id="strings_8h_html_a640e110a8e92c1283f2aae76e4649f48a46fbdfa757aef01471bab9679ce4281f"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a640e110a8e92c1283f2aae76e4649f48a46fbdfa757aef01471bab9679ce4281f">AST_DYNSTR_BUILD_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00895">strings.h:895</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a008dccc13b0342d21fa91bf5c26bbcba"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a008dccc13b0342d21fa91bf5c26bbcba">ast_include_rename</a></div><div class="ttdeci">void ast_include_rename(struct ast_config *conf, const char *from_file, const char *to_file)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00385">main/config.c:385</a></div></div>
<div class="ttc" id="manager_8h_html_acd32bc0b58b87cc22c60ffff79496c7f"><div class="ttname"><a href="../../db/d45/manager_8h.html#acd32bc0b58b87cc22c60ffff79496c7f">EVENT_FLAG_AGENT</a></div><div class="ttdeci">#define EVENT_FLAG_AGENT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00076">manager.h:76</a></div></div>
<div class="ttc" id="astobj2_8h_html_a17990ea630db7dbd1252ef0132133a2b"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a17990ea630db7dbd1252ef0132133a2b">ao2_iterator_next</a></div><div class="ttdeci">#define ao2_iterator_next(iter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01933">astobj2.h:1933</a></div></div>
<div class="ttc" id="structast__manager__user_html_a67c9d5e7f3b13cfc7fe3b4e395c81443"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a67c9d5e7f3b13cfc7fe3b4e395c81443">ast_manager_user::writetimeout</a></div><div class="ttdeci">int writetimeout</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01649">manager.c:1649</a></div></div>
<div class="ttc" id="astobj2_8h_html_ae0422b60d8e25b6962b2d61ae4ddf724"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ae0422b60d8e25b6962b2d61ae4ddf724">ao2_alloc</a></div><div class="ttdeci">#define ao2_alloc(data_size, destructor_fn)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00411">astobj2.h:411</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gacfa23131c1c93528074761076ca2bc85"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gacfa23131c1c93528074761076ca2bc85">ast_manager_get_message_router</a></div><div class="ttdeci">struct stasis_message_router * ast_manager_get_message_router(void)</div><div class="ttdoc">Get the stasis_message_router for AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01725">manager.c:1725</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gadf9acbde2aab503926610acb110634d6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gadf9acbde2aab503926610acb110634d6">action_waitevent</a></div><div class="ttdeci">static int action_waitevent(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04206">manager.c:4206</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7a2a1ae659f41755f987f33586cb43fade"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7a2a1ae659f41755f987f33586cb43fade">AST_MODULE_RELOAD_IN_PROGRESS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00114">module.h:114</a></div></div>
<div class="ttc" id="channel_8h_html_a8873859a4dbc3d0d053d696667e49012"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a8873859a4dbc3d0d053d696667e49012">ast_channel_creationtime</a></div><div class="ttdeci">struct timeval ast_channel_creationtime(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00976">channel_internal_api.c:976</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca598f4a7e416c29b499f2bbe828a6f036"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca598f4a7e416c29b499f2bbe828a6f036">AST_SECURITY_EVENT_FAILED_ACL</a></div><div class="ttdoc">Failed ACL. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00048">security_events_defs.h:48</a></div></div>
<div class="ttc" id="structast__http__digest_html_afeb5a09193787cf522efc8c90c5485f6"><div class="ttname"><a href="../../da/db3/structast__http__digest.html#afeb5a09193787cf522efc8c90c5485f6">ast_http_digest::nc</a></div><div class="ttdeci">const ast_string_field nc</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00672">utils.h:672</a></div></div>
<div class="ttc" id="logger_8h_html_ad89ee324d180cdcd7defcc709ff9ca42"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#ad89ee324d180cdcd7defcc709ff9ca42">LOG_NOTICE</a></div><div class="ttdeci">#define LOG_NOTICE</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00263">logger.h:263</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2fce7bc082ac5dfa4ea3545b9f34cb66"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2fce7bc082ac5dfa4ea3545b9f34cb66">manager_add_filter</a></div><div class="ttdeci">static enum add_filter_result manager_add_filter(const char *filter_pattern, struct ao2_container *whitefilters, struct ao2_container *blackfilters)</div><div class="ttdoc">Add an event filter to a manager session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06162">manager.c:6162</a></div></div>
<div class="ttc" id="format__cap_8h_html_a4dff925fc9e3bb805b926d18447eb3eb"><div class="ttname"><a href="../../d0/d3c/format__cap_8h.html#a4dff925fc9e3bb805b926d18447eb3eb">ast_format_cap_get_names</a></div><div class="ttdeci">const char * ast_format_cap_get_names(const struct ast_format_cap *cap, struct ast_str **buf)</div><div class="ttdoc">Get the names of codecs of a set of formats. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/dc9/format__cap_8c_source.html#l00736">format_cap.c:736</a></div></div>
<div class="ttc" id="strings_8h_html_abe38193be148775f7559f8fff6e0c17e"><div class="ttname"><a href="../../d6/d90/strings_8h.html#abe38193be148775f7559f8fff6e0c17e">ast_trim_blanks</a></div><div class="ttdeci">char * ast_trim_blanks(char *str)</div><div class="ttdoc">Trims trailing whitespace characters from a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00182">strings.h:182</a></div></div>
<div class="ttc" id="structast__tls__config_html_a9ff8d56644bac1d41f8039f2fde5acf2"><div class="ttname"><a href="../../d5/d90/structast__tls__config.html#a9ff8d56644bac1d41f8039f2fde5acf2">ast_tls_config::cafile</a></div><div class="ttdeci">char * cafile</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00092">tcptls.h:92</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2ec80a6f9d335e9240ce5cc6ab49221b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2ec80a6f9d335e9240ce5cc6ab49221b">action_timeout</a></div><div class="ttdeci">static int action_timeout(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06044">manager.c:6044</a></div></div>
<div class="ttc" id="pbx_8h_html_a2afffb175879297ed07ec21df02fa6dc"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a2afffb175879297ed07ec21df02fa6dc">ast_pbx_outgoing_app</a></div><div class="ttdeci">int ast_pbx_outgoing_app(const char *type, struct ast_format_cap *cap, const char *addr, int timeout, const char *app, const char *appdata, int *reason, int synchronous, const char *cid_num, const char *cid_name, struct ast_variable *vars, const char *account, struct ast_channel **locked_channel, const struct ast_assigned_ids *assignedids)</div><div class="ttdoc">Synchronously or asynchronously make an outbound call and execute an application on the channel...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l08015">pbx.c:8015</a></div></div>
<div class="ttc" id="structmanager__action_html_a321c2ead2a4079cde828f7491c2ef733"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#a321c2ead2a4079cde828f7491c2ef733">manager_action::authority</a></div><div class="ttdeci">int authority</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00164">manager.h:164</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a0d78ab95e54db8c72a64038cfefb5161"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a0d78ab95e54db8c72a64038cfefb5161">strcasestr</a></div><div class="ttdeci">char * strcasestr(const char *, const char *)</div></div>
<div class="ttc" id="structast__config_html"><div class="ttname"><a href="../../dd/d18/structast__config.html">ast_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00249">main/config.c:249</a></div></div>
<div class="ttc" id="channel_8h_html_ac8b850ff95f945ad6cfeb2942799800a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac8b850ff95f945ad6cfeb2942799800a">ast_channel_appl</a></div><div class="ttdeci">const char * ast_channel_appl(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00317">channel_internal_api.c:317</a></div></div>
<div class="ttc" id="manager_8c_html_adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9"><div class="ttname"><a href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53a12f0ff7b388bd5cd13868245f3de70d9">FORMAT_RAW</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07463">manager.c:7463</a></div></div>
<div class="ttc" id="channel_8h_html_aa0a52e573af67cb0f29095177128d186"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aa0a52e573af67cb0f29095177128d186">ast_channel_is_bridged</a></div><div class="ttdeci">int ast_channel_is_bridged(const struct ast_channel *chan)</div><div class="ttdoc">Determine if a channel is in a bridge. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l10746">channel.c:10746</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="manager_8c_html_acb49e15f3ae80cc0ee0cfa3a250d00c0"><div class="ttname"><a href="../../d4/d10/manager_8c.html#acb49e15f3ae80cc0ee0cfa3a250d00c0">astman_is_authed</a></div><div class="ttdeci">int astman_is_authed(uint32_t ident)</div><div class="ttdoc">Determinie if a manager session ident is authenticated. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07551">manager.c:7551</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a67508a613c8f337732e35d9367b43ae7"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a67508a613c8f337732e35d9367b43ae7">AST_LIST_ENTRY</a></div><div class="ttdeci">#define AST_LIST_ENTRY(type)</div><div class="ttdoc">Declare a forward link structure inside a list entry. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00409">linkedlists.h:409</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html_ace9168767fc3707cf5f0a7d049682ba3"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html#ace9168767fc3707cf5f0a7d049682ba3">ast_xml_doc_item::name</a></div><div class="ttdeci">const ast_string_field name</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00074">xmldoc.h:74</a></div></div>
<div class="ttc" id="strings_8h_html_af7a2c1bf0a98df4a52ee48a9d9e25510"><div class="ttname"><a href="../../d6/d90/strings_8h.html#af7a2c1bf0a98df4a52ee48a9d9e25510">ast_regex_string_to_regex_pattern</a></div><div class="ttdeci">int ast_regex_string_to_regex_pattern(const char *regex_string, struct ast_str **regex_pattern)</div><div class="ttdoc">Given a string regex_string in the form of &quot;/regex/&quot;, convert it into the form of &quot;regex&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01931">main/utils.c:1931</a></div></div>
<div class="ttc" id="structast__manager__user_html_a0ce56a692ce68929b56356d17208ba42"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a0ce56a692ce68929b56356d17208ba42">ast_manager_user::keep</a></div><div class="ttdeci">int keep</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01652">manager.c:1652</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa2ded2af046bb513f77056c27c083307"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa2ded2af046bb513f77056c27c083307">AST_LIST_INSERT_HEAD</a></div><div class="ttdeci">#define AST_LIST_INSERT_HEAD(head, elm, field)</div><div class="ttdoc">Inserts a list entry at the head of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00710">linkedlists.h:710</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga46026a8e1dfda56ac9dc23cd31515def"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga46026a8e1dfda56ac9dc23cd31515def">action_getvar</a></div><div class="ttdeci">static int action_getvar(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04610">manager.c:4610</a></div></div>
<div class="ttc" id="json_8h_html_aa75b709b69e8f05cc4796ccfa8d9d110a07e50d02cf780dadbf0341d60fbfe2c7"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a07e50d02cf780dadbf0341d60fbfe2c7">AST_JSON_STRING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00166">json.h:166</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a49c6dd43bada70d0caac95894f037660"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8a49c6dd43bada70d0caac95894f037660">FILTER_COMPILE_FAIL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01437">manager.c:1437</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gad40bb264275fb647b2044b47ac533dad"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gad40bb264275fb647b2044b47ac533dad">match_filter</a></div><div class="ttdeci">static int match_filter(struct mansession *s, char *eventdata)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06193">manager.c:6193</a></div></div>
<div class="ttc" id="channel_8h_html_af476c537b29be3f29240489032f9db39"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af476c537b29be3f29240489032f9db39">ast_channel_unlock</a></div><div class="ttdeci">#define ast_channel_unlock(chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l02946">channel.h:2946</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga60fd6fa59060c7bc3c3082275434a292"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga60fd6fa59060c7bc3c3082275434a292">event_filter_destructor</a></div><div class="ttdeci">static void event_filter_destructor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02192">manager.c:2192</a></div></div>
<div class="ttc" id="cli_8h_html_ae47751901c430ebb833e59291a5e0b3f"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ae47751901c430ebb833e59291a5e0b3f">CLI_FAILURE</a></div><div class="ttdeci">#define CLI_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00046">cli.h:46</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_a2e006acff60d9b3d65d7d60f975d6747"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#a2e006acff60d9b3d65d7d60f975d6747">parse</a></div><div class="ttdeci">static void parse(struct mgcp_request *req)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l01872">chan_mgcp.c:1872</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ggae9440b5a8f6a5fb7e1667674b1507344af59be521b8f1a6985f831b7b850a8fc9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344af59be521b8f1a6985f831b7b850a8fc9">MESSAGE_LINE_TOO_LONG</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01617">manager.c:1617</a></div></div>
<div class="ttc" id="stasis_8h_html_ac43d0a33d111e9f34b441b285c166cfc"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#ac43d0a33d111e9f34b441b285c166cfc">stasis_publish</a></div><div class="ttdeci">void stasis_publish(struct stasis_topic *topic, struct stasis_message *message)</div><div class="ttdoc">Publish a message to a topic&amp;#39;s subscribers. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01511">stasis.c:1511</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_a0980a105ccb863d8008eb6201a51da52"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#a0980a105ccb863d8008eb6201a51da52">name</a></div><div class="ttdeci">static const char name[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00074">cdr_mysql.c:74</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92acd7357cb5e0f2597cb189f9be397837e">UNSPECIFIED_ARGUMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01423">manager.c:1423</a></div></div>
<div class="ttc" id="astmm_8h_html_a402072d6789f6ed9e3a81da27504127e"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a402072d6789f6ed9e3a81da27504127e">ast_free</a></div><div class="ttdeci">#define ast_free(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00182">astmm.h:182</a></div></div>
<div class="ttc" id="structvariable__count_html"><div class="ttname"><a href="../../de/dd0/structvariable__count.html">variable_count</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07695">manager.c:7695</a></div></div>
<div class="ttc" id="structast__cli__entry_html_ade9cba72805fe52685a1deea307a8e82"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#ade9cba72805fe52685a1deea307a8e82">ast_cli_entry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00186">cli.h:186</a></div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1da204aa062b4281ee428f0709259f73116"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da204aa062b4281ee428f0709259f73116">AST_AOC_BILLING_CALL_FWD_BUSY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00055">aoc.h:55</a></div></div>
<div class="ttc" id="manager_8h_html_a7a060a00ce627de395914abeb0007bb3"><div class="ttname"><a href="../../db/d45/manager_8h.html#a7a060a00ce627de395914abeb0007bb3">manager_endpoints_init</a></div><div class="ttdeci">int manager_endpoints_init(void)</div><div class="ttdoc">Initialize support for AMI endpoint events. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d10/manager__endpoints_8c_source.html#l00052">manager_endpoints.c:52</a></div></div>
<div class="ttc" id="channel_8h_html_ab57c278099ea5f8d7cedbb41eba58b56"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ab57c278099ea5f8d7cedbb41eba58b56">AST_CHANNEL_NAME</a></div><div class="ttdeci">#define AST_CHANNEL_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00172">channel.h:172</a></div></div>
<div class="ttc" id="cdr__mysql_8c_html_ad1982509765f4870f1f63412a53ea668"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ad1982509765f4870f1f63412a53ea668">reload</a></div><div class="ttdeci">static int reload(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00741">cdr_mysql.c:741</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7aa719b0c0d0c58b358deaf9933a8dd3f6"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7aa719b0c0d0c58b358deaf9933a8dd3f6">AST_MODULE_RELOAD_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00113">module.h:113</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_acea391ea9b4b2ee61b5b84bce2187f12"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#acea391ea9b4b2ee61b5b84bce2187f12">fast_originate_helper::cid_name</a></div><div class="ttdeci">const ast_string_field cid_name</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaf35097a12cdbc0424817d9ab324d1a0a"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaf35097a12cdbc0424817d9ab324d1a0a">report_auth_success</a></div><div class="ttdeci">static void report_auth_success(const struct mansession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03360">manager.c:3360</a></div></div>
<div class="ttc" id="aoc_8h_html_a9dc12343996e18f696da3dcde18fabcb"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a9dc12343996e18f696da3dcde18fabcb">ast_aoc_set_total_type</a></div><div class="ttdeci">int ast_aoc_set_total_type(struct ast_aoc_decoded *decoded, const enum ast_aoc_total_type type)</div><div class="ttdoc">Sets the type of total for a AOC-D message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00907">aoc.c:907</a></div></div>
<div class="ttc" id="manager_8h_html_a673603420907be7dada8fc479e313333"><div class="ttname"><a href="../../db/d45/manager_8h.html#a673603420907be7dada8fc479e313333">EVENT_FLAG_SECURITY</a></div><div class="ttdeci">#define EVENT_FLAG_SECURITY</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00089">manager.h:89</a></div></div>
<div class="ttc" id="module_8h_html_adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388"><div class="ttname"><a href="../../d5/d16/module_8h.html#adc09474f0ff557e9925b722ee5b952dfa8724da3ad620df86524280e760add388">AST_MODULE_LOAD_FAILURE</a></div><div class="ttdoc">Module could not be loaded properly. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00102">module.h:102</a></div></div>
<div class="ttc" id="manager_8h_html_aae40009621df41a713be987266a11696"><div class="ttname"><a href="../../db/d45/manager_8h.html#aae40009621df41a713be987266a11696">EVENT_FLAG_HOOKRESPONSE</a></div><div class="ttdeci">#define EVENT_FLAG_HOOKRESPONSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00085">manager.h:85</a></div></div>
<div class="ttc" id="json_8h_html_aa75b709b69e8f05cc4796ccfa8d9d110a0b94a7db79a79dcc6d9e8263b3690a98"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a0b94a7db79a79dcc6d9e8263b3690a98">AST_JSON_ARRAY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00165">json.h:165</a></div></div>
<div class="ttc" id="structast__tls__config_html"><div class="ttname"><a href="../../d5/d90/structast__tls__config.html">ast_tls_config</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00087">tcptls.h:87</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a7e9aea581abeaae5d3799367d95284ac"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a7e9aea581abeaae5d3799367d95284ac">ast_parse_arg</a></div><div class="ttdeci">int ast_parse_arg(const char *arg, enum ast_parse_flags flags, void *result,...)</div><div class="ttdoc">The argument parsing routine. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l03657">main/config.c:3657</a></div></div>
<div class="ttc" id="stasis_8h_html_a5713715b0f26f4943d0af05363b07027"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a5713715b0f26f4943d0af05363b07027">stasis_forward_cancel</a></div><div class="ttdeci">struct stasis_forward * stasis_forward_cancel(struct stasis_forward *forward)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01548">stasis.c:1548</a></div></div>
<div class="ttc" id="structmansession__session_html_a36ac2dd734607a43ed90acb7e9d81ac5"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a36ac2dd734607a43ed90acb7e9d81ac5">mansession_session::stream</a></div><div class="ttdeci">struct ast_iostream * stream</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01584">manager.c:1584</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga1b557a85c122f479896a9f598ee49116"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga1b557a85c122f479896a9f598ee49116">astman_free_headers</a></div><div class="ttdeci">static void astman_free_headers(struct message *m)</div><div class="ttdoc">Free headers inside message structure, but not the message structure itself. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02844">manager.c:2844</a></div></div>
<div class="ttc" id="structast__cli__args_html_adc1f34651f7bbfa3ba5af27db5f53817"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#adc1f34651f7bbfa3ba5af27db5f53817">ast_cli_args::word</a></div><div class="ttdeci">const char * word</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00163">cli.h:163</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab362ced8cd2bc839a9a1782ae31a9166"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab362ced8cd2bc839a9a1782ae31a9166">broken_events_action</a></div><div class="ttdeci">static int broken_events_action</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01474">manager.c:1474</a></div></div>
<div class="ttc" id="aoc_8h_html_a8f66f98f015246c294b10dc2c9350612"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a8f66f98f015246c294b10dc2c9350612">ast_aoc_destroy_encoded</a></div><div class="ttdeci">void * ast_aoc_destroy_encoded(struct ast_aoc_encoded *encoded)</div><div class="ttdoc">free an ast_aoc_encoded object </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00313">aoc.c:313</a></div></div>
<div class="ttc" id="json_8h_html_aa75b709b69e8f05cc4796ccfa8d9d110a6c4fc9aa144bf07d9b3fa9f1a824263f"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110a6c4fc9aa144bf07d9b3fa9f1a824263f">AST_JSON_FALSE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00170">json.h:170</a></div></div>
<div class="ttc" id="json_8h_html_a29ebd5b57ed7446feeaedda2bf813c76"><div class="ttname"><a href="../../d4/d05/json_8h.html#a29ebd5b57ed7446feeaedda2bf813c76">ast_json_typeof</a></div><div class="ttdeci">enum ast_json_type ast_json_typeof(const struct ast_json *value)</div><div class="ttdoc">Get the type of value. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00078">json.c:78</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3d3aa4fb3b4ba38ad8d6d255d97e037c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3d3aa4fb3b4ba38ad8d6d255d97e037c">AST_RWLIST_REMOVE_HEAD</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE_HEAD</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00843">linkedlists.h:843</a></div></div>
<div class="ttc" id="structmansession__session_html_a805140f5455ca9a45685d306eb9f8834"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a805140f5455ca9a45685d306eb9f8834">mansession_session::nc</a></div><div class="ttdeci">unsigned long nc</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01609">manager.c:1609</a></div></div>
<div class="ttc" id="stasis_8h_html_a221d05010106dcde0cc2e2b43c1a8b67"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a221d05010106dcde0cc2e2b43c1a8b67">stasis_unsubscribe_and_join</a></div><div class="ttdeci">struct stasis_subscription * stasis_unsubscribe_and_join(struct stasis_subscription *subscription)</div><div class="ttdoc">Cancel a subscription, blocking until the last message is processed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01136">stasis.c:1136</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a61b77e9b543a66af82d7ac7d4d6b4ac8"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a61b77e9b543a66af82d7ac7d4d6b4ac8">ast_variable_update</a></div><div class="ttdeci">int ast_variable_update(struct ast_category *category, const char *variable, const char *value, const char *match, unsigned int object)</div><div class="ttdoc">Update variable value within a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01444">main/config.c:1444</a></div></div>
<div class="ttc" id="structast__security__event__successful__auth_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../d6/d86/structast__security__event__successful__auth.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_successful_auth::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00392">security_events_defs.h:392</a></div></div>
<div class="ttc" id="structast__channel__iterator_html"><div class="ttname"><a href="../../d9/d97/structast__channel__iterator.html">ast_channel_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01351">channel.c:1351</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga97a54a9ee7d7446e6be8a9371fcd2a19"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga97a54a9ee7d7446e6be8a9371fcd2a19">security_topic_forwarder</a></div><div class="ttdeci">static struct stasis_forward * security_topic_forwarder</div><div class="ttdoc">The stasis_subscription for forwarding the Security topic to the AMI topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01499">manager.c:1499</a></div></div>
<div class="ttc" id="structast__manager__user_html_afaabb85e65efc5fed1a5f4d08bf272a4"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#afaabb85e65efc5fed1a5f4d08bf272a4">ast_manager_user::readperm</a></div><div class="ttdeci">int readperm</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01647">manager.c:1647</a></div></div>
<div class="ttc" id="structmansession__session_html_a24367fd57bd683dd7fdba2db57ce314e"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a24367fd57bd683dd7fdba2db57ce314e">mansession_session::managerid</a></div><div class="ttdeci">uint32_t managerid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01588">manager.c:1588</a></div></div>
<div class="ttc" id="http_8h_html_a656cd4a1dab52abb5e6cd641e064c18f"><div class="ttname"><a href="../../dd/d56/http_8h.html#a656cd4a1dab52abb5e6cd641e064c18f">ast_get_http_method</a></div><div class="ttdeci">const char * ast_get_http_method(enum ast_http_method method) attribute_pure</div><div class="ttdoc">Return http method name string. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00190">http.c:190</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390af10845d12981bce4e141a5b0ed431494">AST_CONTROL_AOC</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00305">include/asterisk/frame.h:305</a></div></div>
<div class="ttc" id="structast__manager__user_html_a3eb98988184ea3f302e9a914eb9641e5"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#a3eb98988184ea3f302e9a914eb9641e5">ast_manager_user::displayconnects</a></div><div class="ttdeci">int displayconnects</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01650">manager.c:1650</a></div></div>
<div class="ttc" id="structmansession__session_html"><div class="ttname"><a href="../../df/d05/structmansession__session.html">mansession_session</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01581">manager.c:1581</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gadd09f46d9eea259a9a23b2a96fb99d7b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gadd09f46d9eea259a9a23b2a96fb99d7b">action_destroy</a></div><div class="ttdeci">static void action_destroy(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07372">manager.c:7372</a></div></div>
<div class="ttc" id="localtime_8h_html_aa8e63928b14a347bd3973d680b885f93"><div class="ttname"><a href="../../d5/deb/localtime_8h.html#aa8e63928b14a347bd3973d680b885f93">ast_strftime</a></div><div class="ttdeci">int ast_strftime(char *buf, size_t len, const char *format, const struct ast_tm *tm)</div><div class="ttdoc">Special version of strftime(3) that handles fractions of a second. Takes the same arguments as strfti...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/df8/localtime_8c_source.html#l02524">localtime.c:2524</a></div></div>
<div class="ttc" id="astobj2_8h_html_a911e0703891a9a7aaf73978152092586"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a911e0703891a9a7aaf73978152092586">ao2_find</a></div><div class="ttdeci">#define ao2_find(container, arg, flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01756">astobj2.h:1756</a></div></div>
<div class="ttc" id="strings_8h_html_aadcedfc19bc7df38193262ebb8f3c991"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aadcedfc19bc7df38193262ebb8f3c991">ast_str_append_va</a></div><div class="ttdeci">int ast_str_append_va(struct ast_str **buf, ssize_t max_len, const char *fmt, va_list ap)</div><div class="ttdoc">Append to a dynamic string using a va_list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01000">strings.h:1000</a></div></div>
<div class="ttc" id="taskprocessor_8h_html"><div class="ttname"><a href="../../d0/d1e/taskprocessor_8h.html">taskprocessor.h</a></div><div class="ttdoc">An API for managing task processing threads that can be shared across modules. </div></div>
<div class="ttc" id="group__Group__AMI_html_gaf6298ba3cc972f7d6b8c42cff93cb8a8"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaf6298ba3cc972f7d6b8c42cff93cb8a8">manager_event_sessions</a></div><div class="ttdeci">#define manager_event_sessions(sessions, category, event, contents,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01832">manager.c:1832</a></div></div>
<div class="ttc" id="aoc_8h_html_a49977b1a5a71ee19edfc3f77f448e089a218074f0220f2224fa4c4cab5281834a"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a49977b1a5a71ee19edfc3f77f448e089a218074f0220f2224fa4c4cab5281834a">AST_AOC_MULT_ONEHUNDREDTH</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00036">aoc.h:36</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a637de870dfc83d0694f588c5a814ce38"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a637de870dfc83d0694f588c5a814ce38">ast_xmldoc_printable</a></div><div class="ttdeci">char * ast_xmldoc_printable(const char *bwinput, int withcolors)</div><div class="ttdoc">Colorize and put delimiters (instead of tags) to the xmldoc output. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l00242">xmldoc.c:242</a></div></div>
<div class="ttc" id="structast__aoc__unit__entry_html_a7a39ee49c9364cb0e662f7637a323830"><div class="ttname"><a href="../../df/d18/structast__aoc__unit__entry.html#a7a39ee49c9364cb0e662f7637a323830">ast_aoc_unit_entry::valid_type</a></div><div class="ttdeci">char valid_type</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00181">aoc.h:181</a></div></div>
<div class="ttc" id="structmansession__session_html_ac56f44f8863e74f246f657bdcf7bdcd1"><div class="ttname"><a href="../../df/d05/structmansession__session.html#ac56f44f8863e74f246f657bdcf7bdcd1">mansession_session::inbuf</a></div><div class="ttdeci">char inbuf[1025]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01597">manager.c:1597</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gad16a64f7db4f1fdc0326f086152ed584"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gad16a64f7db4f1fdc0326f086152ed584">action_status</a></div><div class="ttdeci">static int action_status(struct mansession *s, const struct message *m)</div><div class="ttdoc">Manager &quot;status&quot; command to show channels. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04777">manager.c:4777</a></div></div>
<div class="ttc" id="manager_8c_html_a47595f828e8f0e6b1faf176311417168"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a47595f828e8f0e6b1faf176311417168">purge_old_stuff</a></div><div class="ttdeci">static void purge_old_stuff(void *data)</div><div class="ttdoc">cleanup code called at each iteration of server_root, guaranteed to happen every 5 seconds at most ...</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08635">manager.c:8635</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_aedda41918e992000fe921f8f7363b390a7c6096b70aeb9e6b2b4f9ee5cfccbf7a"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#aedda41918e992000fe921f8f7363b390a7c6096b70aeb9e6b2b4f9ee5cfccbf7a">AST_CONTROL_READ_ACTION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00304">include/asterisk/frame.h:304</a></div></div>
<div class="ttc" id="manager_8h_html_ab444a62cb9f15528aa8b4e864dfc99b2"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab444a62cb9f15528aa8b4e864dfc99b2">DEFAULT_MANAGER_TLS_PORT</a></div><div class="ttdeci">#define DEFAULT_MANAGER_TLS_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00059">manager.h:59</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa7c66558ac59bdb0c8d05864aaec9c22"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa7c66558ac59bdb0c8d05864aaec9c22">send_string</a></div><div class="ttdeci">static int send_string(struct mansession *s, char *string)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03025">manager.c:3025</a></div></div>
<div class="ttc" id="stasis_8h_html_aff3b891ecf151757d9977e167c9a3b07"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#aff3b891ecf151757d9977e167c9a3b07">stasis_message_can_be_ami</a></div><div class="ttdeci">int stasis_message_can_be_ami(struct stasis_message *msg)</div><div class="ttdoc">Determine if the given message can be converted to AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/db9/stasis__message_8c_source.html#l00251">stasis_message.c:251</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ab2a430239583b6fb63f3c055dbf651ec">FAILURE_ALLOCATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01424">manager.c:1424</a></div></div>
<div class="ttc" id="structuser_html"><div class="ttname"><a href="../../d8/dbc/structuser.html">user</a></div><div class="ttdoc">structure to hold users read from users.conf </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de9/res__phoneprov_8c_source.html#l00312">res_phoneprov.c:312</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga3d60a22662da992b5707f7b8830efc05"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga3d60a22662da992b5707f7b8830efc05">action_coresettings</a></div><div class="ttdeci">static int action_coresettings(struct mansession *s, const struct message *m)</div><div class="ttdoc">Show PBX core settings information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06276">manager.c:6276</a></div></div>
<div class="ttc" id="stringfields_8h_html_a8b9f4347fc72720cc5cead952b54abe9"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a8b9f4347fc72720cc5cead952b54abe9">ast_string_field_build</a></div><div class="ttdeci">#define ast_string_field_build(x, field, fmt, args...)</div><div class="ttdoc">Set a field to a complex (built) value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00550">stringfields.h:550</a></div></div>
<div class="ttc" id="structheader_html"><div class="ttname"><a href="../../d5/d65/structheader.html">header</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d73/pjsip__global__headers_8c_source.html#l00047">pjsip_global_headers.c:47</a></div></div>
<div class="ttc" id="structast__flags_html"><div class="ttname"><a href="../../dc/dac/structast__flags.html">ast_flags</a></div><div class="ttdoc">Structure used to handle boolean flags. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00199">utils.h:199</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga568aa1aff837fc0001279490a6d9b22f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga568aa1aff837fc0001279490a6d9b22f">ast_manager_get_topic</a></div><div class="ttdeci">struct stasis_topic * ast_manager_get_topic(void)</div><div class="ttdoc">Get the Stasis Message Bus API topic for AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01720">manager.c:1720</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a5c52185fee8531c7e071227b4e5b2ae6"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a5c52185fee8531c7e071227b4e5b2ae6">ast_xmldoc_build_syntax</a></div><div class="ttdeci">char * ast_xmldoc_build_syntax(const char *type, const char *name, const char *module)</div><div class="ttdoc">Get the syntax for a specified application or function. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l01253">xmldoc.c:1253</a></div></div>
<div class="ttc" id="http_8h_html_a16fb43ed7e6093a9dc96477ba37b80efaf8da4e60a407fb100dd10e20929ea162"><div class="ttname"><a href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efaf8da4e60a407fb100dd10e20929ea162">AST_HTTP_HEAD</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00060">http.h:60</a></div></div>
<div class="ttc" id="xmldoc_8h_html_a5213452e6be61321a64293e54e4b550b"><div class="ttname"><a href="../../d1/d99/xmldoc_8h.html#a5213452e6be61321a64293e54e4b550b">ast_xmldoc_build_seealso</a></div><div class="ttdeci">char * ast_xmldoc_build_seealso(const char *type, const char *name, const char *module)</div><div class="ttdoc">Parse the &lt;see-also&gt; node content. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2f/xmldoc_8c_source.html#l01698">xmldoc.c:1698</a></div></div>
<div class="ttc" id="structeventqent_html_a60863e080514b398bce285b4d087dcf1"><div class="ttname"><a href="../../d9/d94/structeventqent.html#a60863e080514b398bce285b4d087dcf1">eventqent::category</a></div><div class="ttdeci">int category</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01461">manager.c:1461</a></div></div>
<div class="ttc" id="netsock2_8h_html_aa2785c5990a086943fea750c980abbc3acd1be5fd1357a3d7f56ec62fc01bdc20"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aa2785c5990a086943fea750c980abbc3acd1be5fd1357a3d7f56ec62fc01bdc20">AST_TRANSPORT_TCP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00061">netsock2.h:61</a></div></div>
<div class="ttc" id="structast__tls__config_html_a333dffcec025fcdbee0676476f401685"><div class="ttname"><a href="../../d5/d90/structast__tls__config.html#a333dffcec025fcdbee0676476f401685">ast_tls_config::certfile</a></div><div class="ttdeci">char * certfile</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00089">tcptls.h:89</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a76b4d3927cacd1bcd5da9ca8fe375cb6"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a76b4d3927cacd1bcd5da9ca8fe375cb6">ast_app_has_voicemail</a></div><div class="ttdeci">int ast_app_has_voicemail(const char *mailboxes, const char *folder)</div><div class="ttdoc">Determine if a given mailbox has any voicemail If folder is NULL, defaults to &quot;INBOX&quot;. If folder is &quot;INBOX&quot;, includes the number of messages in the &quot;Urgent&quot; folder. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d83/main_2app_8c_source.html#l00655">main/app.c:655</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a7870f447ef3c43ebf148da15363b25dd"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a7870f447ef3c43ebf148da15363b25dd">fast_originate_helper::data</a></div><div class="ttdeci">const ast_string_field data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="structMD5Context_html"><div class="ttname"><a href="../../d1/d32/structMD5Context.html">MD5Context</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/db0/md5_8h_source.html#l00026">md5.h:26</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a7faec841658b88ad0cfbc684853acad3"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a7faec841658b88ad0cfbc684853acad3">fast_originate_helper::context</a></div><div class="ttdeci">const ast_string_field context</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="structast__tcptls__session__instance_html_a36ac2dd734607a43ed90acb7e9d81ac5"><div class="ttname"><a href="../../d6/d49/structast__tcptls__session__instance.html#a36ac2dd734607a43ed90acb7e9d81ac5">ast_tcptls_session_instance::stream</a></div><div class="ttdeci">struct ast_iostream * stream</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00160">tcptls.h:160</a></div></div>
<div class="ttc" id="chan__mgcp_8c_html_ade5a89f9bee15a492c760ec1765a292d"><div class="ttname"><a href="../../d0/dd6/chan__mgcp_8c.html#ade5a89f9bee15a492c760ec1765a292d">cid_name</a></div><div class="ttdeci">static char cid_name[AST_MAX_EXTENSION]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd6/chan__mgcp_8c_source.html#l00165">chan_mgcp.c:165</a></div></div>
<div class="ttc" id="linkedlists_8h_html_ac63e9e237da22b6faf3be4edfc4f5a11"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#ac63e9e237da22b6faf3be4edfc4f5a11">AST_RWLIST_ENTRY</a></div><div class="ttdeci">#define AST_RWLIST_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00414">linkedlists.h:414</a></div></div>
<div class="ttc" id="res__phoneprov_8c_html_addaa208b0ed785225e24490fb9f28a80"><div class="ttname"><a href="../../d9/de9/res__phoneprov_8c.html#addaa208b0ed785225e24490fb9f28a80">AST_MODULE_INFO</a></div><div class="ttdeci">AST_MODULE_INFO(ASTERISK_GPL_KEY, AST_MODFLAG_GLOBAL_SYMBOLS|AST_MODFLAG_LOAD_ORDER, &quot;HTTP Phone Provisioning&quot;,.support_level=AST_MODULE_SUPPORT_EXTENDED,.load=load_module,.unload=unload_module,.reload=reload,.load_pri=AST_MODPRI_CHANNEL_DEPEND,.requires=&quot;http&quot;,)</div></div>
<div class="ttc" id="pbx_8h_html_ab077da615e93c9e88ce539bef23f82e6a72b959e4767d5a4c644c6232122f5ad9"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ab077da615e93c9e88ce539bef23f82e6a72b959e4767d5a4c644c6232122f5ad9">AST_HINT_UPDATE_PRESENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00093">pbx.h:93</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9c6c0e75254e2641e579bba0068626de"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9c6c0e75254e2641e579bba0068626de">DEFAULT_REALM</a></div><div class="ttdeci">#define DEFAULT_REALM</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01483">manager.c:1483</a></div></div>
<div class="ttc" id="structast__cli__entry_html_aef1bd6ad890a110b466cb0e8088507a2"><div class="ttname"><a href="../../d8/d07/structast__cli__entry.html#aef1bd6ad890a110b466cb0e8088507a2">ast_cli_entry::usage</a></div><div class="ttdeci">const char * usage</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00177">cli.h:177</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92a97ea9672929721f6b45f60f058465bd9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92a97ea9672929721f6b45f60f058465bd9">FAILURE_APPEND</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01430">manager.c:1430</a></div></div>
<div class="ttc" id="channel_8h_html_a4a5bc2ea394aace55ea3809e53365ea9"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a4a5bc2ea394aace55ea3809e53365ea9">ast_channel_nativeformats</a></div><div class="ttdeci">struct ast_format_cap * ast_channel_nativeformats(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00637">channel_internal_api.c:637</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a57a3200e5b440d7135eaf0450ea559fe"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a57a3200e5b440d7135eaf0450ea559fe">ast_variable_append</a></div><div class="ttdeci">void ast_variable_append(struct ast_category *category, struct ast_variable *variable)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l01178">extconf.c:1178</a></div></div>
<div class="ttc" id="pbx_8h_html_a6e5b90edb84d216267148dddcffe9b9a"><div class="ttname"><a href="../../db/de0/pbx_8h.html#a6e5b90edb84d216267148dddcffe9b9a">pbx_builtin_setvar_helper</a></div><div class="ttdeci">int pbx_builtin_setvar_helper(struct ast_channel *chan, const char *name, const char *value)</div><div class="ttdoc">Add a variable to the channel variable stack, removing the most recently set value for the same name...</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d8c/pbx__variables_8c_source.html#l01071">pbx_variables.c:1071</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a39bacaabcacf47583204c7634e64a2a0"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a39bacaabcacf47583204c7634e64a2a0">CONFIG_STATUS_FILEMISSING</a></div><div class="ttdeci">#define CONFIG_STATUS_FILEMISSING</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00058">include/asterisk/config.h:58</a></div></div>
<div class="ttc" id="structast__security__event__inval__acct__id_html"><div class="ttname"><a href="../../dd/dc8/structast__security__event__inval__acct__id.html">ast_security_event_inval_acct_id</a></div><div class="ttdoc">Invalid account ID specified (invalid username, for example) </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00224">security_events_defs.h:224</a></div></div>
<div class="ttc" id="structmansession_html_a4905d9704cb1eb3ff285e4fb8aa9c68d"><div class="ttname"><a href="../../d2/d8a/structmansession.html#a4905d9704cb1eb3ff285e4fb8aa9c68d">mansession::write_error</a></div><div class="ttdeci">unsigned int write_error</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01630">manager.c:1630</a></div></div>
<div class="ttc" id="aoc_8h_html_ada9b84ac8130231cee87ba4d33a5dda0"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#ada9b84ac8130231cee87ba4d33a5dda0">ast_aoc_create</a></div><div class="ttdeci">struct ast_aoc_decoded * ast_aoc_create(const enum ast_aoc_type msg_type, const enum ast_aoc_charge_type charge_type, const enum ast_aoc_request requests)</div><div class="ttdoc">creates a ast_aoc_decode object of a specific message type </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00276">aoc.c:276</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aa422e1cc73c1ac4db7ed8cd1a0e36e1a"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aa422e1cc73c1ac4db7ed8cd1a0e36e1a">ast_category_append</a></div><div class="ttdeci">void ast_category_append(struct ast_config *config, struct ast_category *cat)</div><div class="ttdoc">Appends a category to a config. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02835">extconf.c:2835</a></div></div>
<div class="ttc" id="channel_8h_html_a531fd832a2f8b0f4156735043a6158e1"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a531fd832a2f8b0f4156735043a6158e1">ast_channel_data</a></div><div class="ttdeci">const char * ast_channel_data(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00334">channel_internal_api.c:334</a></div></div>
<div class="ttc" id="structchans_html"><div class="ttname"><a href="../../d6/d75/structchans.html">chans</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d4d/astman_8c_source.html#l00088">astman.c:88</a></div></div>
<div class="ttc" id="aoc_8h_html_aed3fe8e8d708e8aff42a2ad205813cb7a437decc9f64054294b48742e48089619"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#aed3fe8e8d708e8aff42a2ad205813cb7a437decc9f64054294b48742e48089619">AST_AOC_TOTAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00083">aoc.h:83</a></div></div>
<div class="ttc" id="module_8h_html_ad2dd3dce05926913c40b883cc7cff0a8"><div class="ttname"><a href="../../d5/d16/module_8h.html#ad2dd3dce05926913c40b883cc7cff0a8">ast_module_running_ref</a></div><div class="ttdeci">#define ast_module_running_ref(mod)</div><div class="ttdoc">Hold a reference to the module if it is running. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00455">module.h:455</a></div></div>
<div class="ttc" id="json_8h_html_aa75b709b69e8f05cc4796ccfa8d9d110abf0021fff98de0d1e3460c4d4add5625"><div class="ttname"><a href="../../d4/d05/json_8h.html#aa75b709b69e8f05cc4796ccfa8d9d110abf0021fff98de0d1e3460c4d4add5625">AST_JSON_INTEGER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d05/json_8h_source.html#l00167">json.h:167</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aab4c6b70f2b1c373c5d299b8020b5a5d"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aab4c6b70f2b1c373c5d299b8020b5a5d">ast_category_new_template</a></div><div class="ttdeci">struct ast_category * ast_category_new_template(const char *name, const char *in_file, int lineno)</div><div class="ttdoc">Create a category making it a template. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00995">main/config.c:995</a></div></div>
<div class="ttc" id="structmanager__custom__hook_html"><div class="ttname"><a href="../../d0/d10/structmanager__custom__hook.html">manager_custom_hook</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00108">manager.h:108</a></div></div>
<div class="ttc" id="options_8h_html_acd462f81fa607939af36a9fa33cdbf9d"><div class="ttname"><a href="../../d7/d5b/options_8h.html#acd462f81fa607939af36a9fa33cdbf9d">ast_startuptime</a></div><div class="ttdeci">struct timeval ast_startuptime</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d03/asterisk_8c_source.html#l00336">asterisk.c:336</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a2457835b26aa09c41c6ecf633f95f775a9e8b2eb87931f7565311b556a32e6993"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a2457835b26aa09c41c6ecf633f95f775a9e8b2eb87931f7565311b556a32e6993">AST_FRAME_READ_ACTION_SEND_TEXT_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00354">include/asterisk/frame.h:354</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372ca41e5b6416947030699a9267106bc1a46"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372ca41e5b6416947030699a9267106bc1a46">AST_SECURITY_EVENT_SESSION_LIMIT</a></div><div class="ttdoc">Session limit reached. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00063">security_events_defs.h:63</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga6756b9f30781ed8ca8ce938e49ad9d92ac327a21855ab9428a0a4ec3b2bc9e4da"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga6756b9f30781ed8ca8ce938e49ad9d92ac327a21855ab9428a0a4ec3b2bc9e4da">UNSPECIFIED_CATEGORY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01422">manager.c:1422</a></div></div>
<div class="ttc" id="strings_8h_html_a8239b9ad10367bfc936e9b60ff7706a8"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a8239b9ad10367bfc936e9b60ff7706a8">ast_str_reset</a></div><div class="ttdeci">void ast_str_reset(struct ast_str *buf)</div><div class="ttdoc">Reset the content of a dynamic string. Useful before a series of ast_str_append. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00653">strings.h:653</a></div></div>
<div class="ttc" id="manager_8h_html_a0b1b4140c2836696a6950e92ab48a580"><div class="ttname"><a href="../../db/d45/manager_8h.html#a0b1b4140c2836696a6950e92ab48a580">EVENT_FLAG_REPORTING</a></div><div class="ttdeci">#define EVENT_FLAG_REPORTING</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00080">manager.h:80</a></div></div>
<div class="ttc" id="cli_8h_html_a50989f00b32eeb2516a3803cb2ffb766"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a50989f00b32eeb2516a3803cb2ffb766">CLI_SUCCESS</a></div><div class="ttdeci">#define CLI_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00044">cli.h:44</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1daceee6b8982426596fe14c3948aa29987"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1daceee6b8982426596fe14c3948aa29987">AST_AOC_BILLING_CALL_FWD_UNCONDITIONAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00054">aoc.h:54</a></div></div>
<div class="ttc" id="manager_8c_html_ae4ed80bf0a4a975845d386538b74834c"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ae4ed80bf0a4a975845d386538b74834c">get_manager_sessions_cb</a></div><div class="ttdeci">static int get_manager_sessions_cb(void *obj, void *arg, void *data, int flags)</div><div class="ttdoc">Get number of logged in sessions for a login name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08562">manager.c:8562</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a9ff7aa27ae5f1a980bcf81f91cd6e470"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a9ff7aa27ae5f1a980bcf81f91cd6e470">ast_variable_retrieve</a></div><div class="ttdeci">const char * ast_variable_retrieve(struct ast_config *config, const char *category, const char *variable)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00694">main/config.c:694</a></div></div>
<div class="ttc" id="aoc_8h_html_a2c726e954f606dc71b37ba93be286ff9a38cfbbe1a40256021b03e1599b1a23ed"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a2c726e954f606dc71b37ba93be286ff9a38cfbbe1a40256021b03e1599b1a23ed">AST_AOC_CHARGE_CURRENCY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00072">aoc.h:72</a></div></div>
<div class="ttc" id="chan__unistim_8c_html_acc4156cb923a2043e4c0a7c45c579c4a"><div class="ttname"><a href="../../d1/d6d/chan__unistim_8c.html#acc4156cb923a2043e4c0a7c45c579c4a">parsing</a></div><div class="ttdeci">static void parsing(int size, unsigned char *buf, struct unistimsession *pte, struct sockaddr_in *addr_from)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d6d/chan__unistim_8c_source.html#l04633">chan_unistim.c:4633</a></div></div>
<div class="ttc" id="structast__http__digest_html_a56213b5a6f60531d0721956bd74a7832"><div class="ttname"><a href="../../da/db3/structast__http__digest.html#a56213b5a6f60531d0721956bd74a7832">ast_http_digest::nonce</a></div><div class="ttdeci">const ast_string_field nonce</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00672">utils.h:672</a></div></div>
<div class="ttc" id="astobj2_8h_html_a3a11e1a1d3e99bed3ea0a7c57a3880d7"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a3a11e1a1d3e99bed3ea0a7c57a3880d7">ao2_global_obj_replace_unref</a></div><div class="ttdeci">#define ao2_global_obj_replace_unref(holder, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l00908">astobj2.h:908</a></div></div>
<div class="ttc" id="structast__channel__snapshot__bridge_html_abe9e57df6ac773738500092fe3cf7fca"><div class="ttname"><a href="../../da/d20/structast__channel__snapshot__bridge.html#abe9e57df6ac773738500092fe3cf7fca">ast_channel_snapshot_bridge::id</a></div><div class="ttdeci">char id[0]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00057">stasis_channels.h:57</a></div></div>
<div class="ttc" id="strings_8h_html_aabc005bd1c7e249e8f8659d57d4500b6"><div class="ttname"><a href="../../d6/d90/strings_8h.html#aabc005bd1c7e249e8f8659d57d4500b6">ast_str_strlen</a></div><div class="ttdeci">size_t ast_str_strlen(const struct ast_str *buf)</div><div class="ttdoc">Returns the current length of the string stored within buf. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00688">strings.h:688</a></div></div>
<div class="ttc" id="structast__security__event__session__limit_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../d7/d64/structast__security__event__session__limit.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_session_limit::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00250">security_events_defs.h:250</a></div></div>
<div class="ttc" id="manager_8c_html_adf65c27da57ed800b4068f86892f0672"><div class="ttname"><a href="../../d4/d10/manager_8c.html#adf65c27da57ed800b4068f86892f0672">amanageruri</a></div><div class="ttdeci">static struct ast_http_uri amanageruri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08543">manager.c:8543</a></div></div>
<div class="ttc" id="structast__security__event__req__not__allowed_html_a5853d232c74e8c3de4a3387c05c07df0"><div class="ttname"><a href="../../d0/dc7/structast__security__event__req__not__allowed.html#a5853d232c74e8c3de4a3387c05c07df0">ast_security_event_req_not_allowed::common</a></div><div class="ttdeci">struct ast_security_event_common common</div><div class="ttdoc">Common security event descriptor elements. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00319">security_events_defs.h:319</a></div></div>
<div class="ttc" id="cli_8h_html_ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ab33e5350a923c3a8cedbeb496cd88ec9a76bf33139279b03ec1691f2be2d1be40">CLI_GENERATE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00153">cli.h:153</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ab1e2b732608d60725ece87d2a288463d"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ab1e2b732608d60725ece87d2a288463d">AST_SECURITY_EVENT_INVAL_PASSWORD_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_INVAL_PASSWORD_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00460">security_events_defs.h:460</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aadda916488b2d151af4426e2f06ad332"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aadda916488b2d151af4426e2f06ad332">AST_RWLIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_RWLIST_INSERT_TAIL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00740">linkedlists.h:740</a></div></div>
<div class="ttc" id="manager_8c_html_a62beba58710ea6a53c85928d36f59477"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a62beba58710ea6a53c85928d36f59477">load_channelvars</a></div><div class="ttdeci">static void load_channelvars(struct ast_variable *var)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08916">manager.c:8916</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a0d1f922e093ac18824a7863fe3f5fa27"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a0d1f922e093ac18824a7863fe3f5fa27">AST_LIST_HEAD_INIT_NOLOCK</a></div><div class="ttdeci">#define AST_LIST_HEAD_INIT_NOLOCK(head)</div><div class="ttdoc">Initializes a list head structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00680">linkedlists.h:680</a></div></div>
<div class="ttc" id="manager_8c_html_acde8c68737c4518caab9fe2769738002"><div class="ttname"><a href="../../d4/d10/manager_8c.html#acde8c68737c4518caab9fe2769738002">cli_manager</a></div><div class="ttdeci">static struct ast_cli_entry cli_manager[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08892">manager.c:8892</a></div></div>
<div class="ttc" id="channel_8h_html_a0b4d23dfd94209395f4feceaa5911e0a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a0b4d23dfd94209395f4feceaa5911e0a">AST_MAX_PUBLIC_UNIQUEID</a></div><div class="ttdeci">#define AST_MAX_PUBLIC_UNIQUEID</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00148">channel.h:148</a></div></div>
<div class="ttc" id="group__main__options_html_gaa5dba371db31dc4ebecdff7c929ff263"><div class="ttname"><a href="../../d6/dd6/group__main__options.html#gaa5dba371db31dc4ebecdff7c929ff263">ast_options</a></div><div class="ttdeci">struct ast_flags ast_options</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc5/options_8c_source.html#l00061">options.c:61</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_aa37456e447f230b9aa1a529658c4b1b1"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#aa37456e447f230b9aa1a529658c4b1b1">ast_category_empty</a></div><div class="ttdeci">int ast_category_empty(struct ast_category *category)</div><div class="ttdoc">Removes and destroys all variables in a category. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01510">main/config.c:1510</a></div></div>
<div class="ttc" id="include_2asterisk_2compat_8h_html_a40eca58273c74a20a17f137d18ba826c"><div class="ttname"><a href="../../de/da3/include_2asterisk_2compat_8h.html#a40eca58273c74a20a17f137d18ba826c">strsep</a></div><div class="ttdeci">char * strsep(char **str, const char *delims)</div></div>
<div class="ttc" id="translate_8h_html_a33934307055c00738d6166ad82550711"><div class="ttname"><a href="../../db/d39/translate_8h.html#a33934307055c00738d6166ad82550711">ast_translate_path_to_str</a></div><div class="ttdeci">const char * ast_translate_path_to_str(struct ast_trans_pvt *t, struct ast_str **str)</div><div class="ttdoc">Puts a string representation of the translation path into outbuf. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d43/translate_8c_source.html#l00928">translate.c:928</a></div></div>
<div class="ttc" id="utils_2frame_8c_html_a48bc11919b2752df9d14ce89557cfb25"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a48bc11919b2752df9d14ce89557cfb25">out</a></div><div class="ttdeci">FILE * out</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00033">utils/frame.c:33</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa97739ea571e22b9dcd231658f6ce044"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa97739ea571e22b9dcd231658f6ce044">astman_get_variables_order</a></div><div class="ttdeci">struct ast_variable * astman_get_variables_order(const struct message *m, enum variable_orders order)</div><div class="ttdoc">Get a linked list of the Variable: headers with order specified. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02911">manager.c:2911</a></div></div>
<div class="ttc" id="manager_8h_html_a9aeced7f8d9056c4ec2663f1ad10a4a4"><div class="ttname"><a href="../../db/d45/manager_8h.html#a9aeced7f8d9056c4ec2663f1ad10a4a4">DEFAULT_MANAGER_PORT</a></div><div class="ttdeci">#define DEFAULT_MANAGER_PORT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00058">manager.h:58</a></div></div>
<div class="ttc" id="astobj2_8h_html_ab55d227245c39181ce1a4e4f013cc898"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ab55d227245c39181ce1a4e4f013cc898">ao2_t_callback_data</a></div><div class="ttdeci">#define ao2_t_callback_data(container, flags, cb_fn, arg, data, tag)</div><div class="ttdoc">ao2_callback_data() is a generic function that applies cb_fn() to all objects in a container...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01741">astobj2.h:1741</a></div></div>
<div class="ttc" id="structast__aoc__decoded_html"><div class="ttname"><a href="../../d9/dca/structast__aoc__decoded.html">ast_aoc_decoded</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00205">aoc.c:205</a></div></div>
<div class="ttc" id="manager_8c_html_a58d789617a4c4f4fb0ec8cef1147ea49"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a58d789617a4c4f4fb0ec8cef1147ea49">variable_count_cmp_fn</a></div><div class="ttdeci">static int variable_count_cmp_fn(void *obj, void *vstr, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07707">manager.c:7707</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga32ac2419647ed028f30dc1de0f01056e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga32ac2419647ed028f30dc1de0f01056e">do_message</a></div><div class="ttdeci">static int do_message(struct mansession *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06852">manager.c:6852</a></div></div>
<div class="ttc" id="channel_8c_html_a5cb129ce1d580dbb22ec9573dcb62f7f"><div class="ttname"><a href="../../d4/d28/channel_8c.html#a5cb129ce1d580dbb22ec9573dcb62f7f">chancount</a></div><div class="ttdeci">static int chancount</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00093">channel.c:93</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_ga68c55b443ba97dc157b493aafd05c876"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#ga68c55b443ba97dc157b493aafd05c876">ast_channel_snapshot_get_latest</a></div><div class="ttdeci">struct ast_channel_snapshot * ast_channel_snapshot_get_latest(const char *uniqueid)</div><div class="ttdoc">Obtain the latest ast_channel_snapshot from the Stasis Message Bus API cache. This is an ao2 object...</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/stasis__channels_8c_source.html#l00903">stasis_channels.c:903</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga8547b9864f771b59843128a2054d7c47"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga8547b9864f771b59843128a2054d7c47">build_mansession</a></div><div class="ttdeci">static struct mansession_session * build_mansession(const struct ast_sockaddr *addr)</div><div class="ttdoc">Allocate manager session structure and add it to the list of sessions. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02229">manager.c:2229</a></div></div>
<div class="ttc" id="structao2__iterator_html"><div class="ttname"><a href="../../d9/d97/structao2__iterator.html">ao2_iterator</a></div><div class="ttdoc">When we need to walk through a container, we use an ao2_iterator to keep track of the current positio...</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01841">astobj2.h:1841</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_ac2b6df8229537d9dbb35aaf6bd82372caee96f0d4fa24a2f49c4b0374c230d5d7"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#ac2b6df8229537d9dbb35aaf6bd82372caee96f0d4fa24a2f49c4b0374c230d5d7">AST_SECURITY_EVENT_INVAL_ACCT_ID</a></div><div class="ttdoc">Invalid Account ID. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00056">security_events_defs.h:56</a></div></div>
<div class="ttc" id="structeventqent_html_a1db4845df10d789835dcc97c392a2fe6"><div class="ttname"><a href="../../d9/d94/structeventqent.html#a1db4845df10d789835dcc97c392a2fe6">eventqent::seq</a></div><div class="ttdeci">unsigned int seq</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01462">manager.c:1462</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaf3c7fe7452f69b197b7c4e9a217119c5"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaf3c7fe7452f69b197b7c4e9a217119c5">grab_last</a></div><div class="ttdeci">static struct eventqent * grab_last(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01963">manager.c:1963</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac6a246405a298682d5f34f8856b68461"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac6a246405a298682d5f34f8856b68461">EVENT_FLAG_SHUTDOWN</a></div><div class="ttdeci">#define EVENT_FLAG_SHUTDOWN</div><div class="ttdoc">Fake event class used to end sessions at shutdown. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01511">manager.c:1511</a></div></div>
<div class="ttc" id="astobj2_8h_html_a6321ee982370c55ab3c24c72c562cbdd"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a6321ee982370c55ab3c24c72c562cbdd">ao2_cleanup</a></div><div class="ttdeci">#define ao2_cleanup(obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01958">astobj2.h:1958</a></div></div>
<div class="ttc" id="cli_8h_html"><div class="ttname"><a href="../../dc/db0/cli_8h.html">cli.h</a></div><div class="ttdoc">Standard Command Line Interface. </div></div>
<div class="ttc" id="manager_8c_html_aef58613f88eb27230b85f38df4a08600"><div class="ttname"><a href="../../d4/d10/manager_8c.html#aef58613f88eb27230b85f38df4a08600">amanagerxmluri</a></div><div class="ttdeci">static struct ast_http_uri amanagerxmluri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08552">manager.c:8552</a></div></div>
<div class="ttc" id="json_8h_html_a53707225c3bf831e263245c6e3800676"><div class="ttname"><a href="../../d4/d05/json_8h.html#a53707225c3bf831e263245c6e3800676">ast_json_object_get</a></div><div class="ttdeci">struct ast_json * ast_json_object_get(struct ast_json *object, const char *key)</div><div class="ttdoc">Get a field from a JSON object. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00397">json.c:397</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga19fa3d97c06873c9d67de7232cca5247"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga19fa3d97c06873c9d67de7232cca5247">manager_enabled</a></div><div class="ttdeci">static int manager_enabled</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01475">manager.c:1475</a></div></div>
<div class="ttc" id="structsessions_html"><div class="ttname"><a href="../../d3/d0a/structsessions.html">sessions</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d80/chan__skinny_8c_source.html#l01630">chan_skinny.c:1630</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5d7004574318e8b76738d6a158a447a9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5d7004574318e8b76738d6a158a447a9">MGR_SHOW_TERMINAL_WIDTH</a></div><div class="ttdeci">#define MGR_SHOW_TERMINAL_WIDTH</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01506">manager.c:1506</a></div></div>
<div class="ttc" id="manager_8c_html_a0f30c6e376cc35312886a20eae8cce2a"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a0f30c6e376cc35312886a20eae8cce2a">ROW_FMT</a></div><div class="ttdeci">#define ROW_FMT</div></div>
<div class="ttc" id="structmanager__hooks_html"><div class="ttname"><a href="../../d5/d26/structmanager__hooks.html">manager_hooks</a></div><div class="ttdoc">list of hooks registered </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01668">manager.c:1668</a></div></div>
<div class="ttc" id="structmanager__custom__hook_html_a563331ff9859f8ff63ed061c4c68d8cd"><div class="ttname"><a href="../../d0/d10/structmanager__custom__hook.html#a563331ff9859f8ff63ed061c4c68d8cd">manager_custom_hook::helper</a></div><div class="ttdeci">manager_hook_t helper</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00112">manager.h:112</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga722b7d69a94cb2ececdb88bf67f80667"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga722b7d69a94cb2ececdb88bf67f80667">action_updateconfig</a></div><div class="ttdeci">static int action_updateconfig(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04102">manager.c:4102</a></div></div>
<div class="ttc" id="strings_8h_html_ac4040268f7b6ed77dfc49c7767626369"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac4040268f7b6ed77dfc49c7767626369">ast_copy_string</a></div><div class="ttdeci">void ast_copy_string(char *dst, const char *src, size_t size)</div><div class="ttdoc">Size-limited null-terminating string copy. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00401">strings.h:401</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa497adca1647f8add683cd71799fc015"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa497adca1647f8add683cd71799fc015">function_capable_string_allowed_with_auths</a></div><div class="ttdeci">static int function_capable_string_allowed_with_auths(const char *evaluating, int writepermlist)</div><div class="ttdoc">Checks to see if a string which can be used to evaluate functions should be rejected. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02046">manager.c:2046</a></div></div>
<div class="ttc" id="acl_8h_html_a6b6715d0c234599571cf5e1adddfec33"><div class="ttname"><a href="../../d5/d59/acl_8h.html#a6b6715d0c234599571cf5e1adddfec33">ast_append_acl</a></div><div class="ttdeci">void ast_append_acl(const char *sense, const char *stuff, struct ast_acl_list **path, int *error, int *named_acl_flag)</div><div class="ttdoc">Add a rule to an ACL struct. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/db8/acl_8c_source.html#l00430">acl.c:430</a></div></div>
<div class="ttc" id="pbx_8h_html_aed6cfe76441ef995ab80609020a9990c"><div class="ttname"><a href="../../db/de0/pbx_8h.html#aed6cfe76441ef995ab80609020a9990c">ast_extension_state</a></div><div class="ttdeci">int ast_extension_state(struct ast_channel *c, const char *context, const char *exten)</div><div class="ttdoc">Uses hint and devicestate callback to get the state of an extension. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l03170">pbx.c:3170</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaaab162dbd3271550e8bb515c1e431bd9"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaaab162dbd3271550e8bb515c1e431bd9">ast_instring</a></div><div class="ttdeci">static int ast_instring(const char *bigstr, const char *smallstr, const char delim)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02112">manager.c:2112</a></div></div>
<div class="ttc" id="strings_8h_html_a2faaa16929951bfd2802b7829a100ba2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a2faaa16929951bfd2802b7829a100ba2">S_OR</a></div><div class="ttdeci">#define S_OR(a, b)</div><div class="ttdoc">returns the equivalent of logic or for strings: first one if not empty, otherwise second one...</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00079">strings.h:79</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gae44104439ab29d44fcd84f0361493625"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gae44104439ab29d44fcd84f0361493625">handle_manager_reload</a></div><div class="ttdeci">static char * handle_manager_reload(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdoc">CLI command manager reload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02734">manager.c:2734</a></div></div>
<div class="ttc" id="group__ast__msg__data_html_gac19d5671ce7ad4db2a7df0d4784d4cd3"><div class="ttname"><a href="../../d8/d0e/group__ast__msg__data.html#gac19d5671ce7ad4db2a7df0d4784d4cd3">ast_msg_data_alloc2</a></div><div class="ttdeci">struct ast_msg_data * ast_msg_data_alloc2(enum ast_msg_data_source_type source_type, const char *to, const char *from, const char *content_type, const char *body)</div><div class="ttdoc">Allocates an ast_msg_data structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d6d/message_8c_source.html#l01469">message.c:1469</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a8990d27b9ca1ef2a4265bbb34ece23aca15ee838ecb8362bba6c429be5930a80d"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a8990d27b9ca1ef2a4265bbb34ece23aca15ee838ecb8362bba6c429be5930a80d">CONFIG_SAVE_FLAG_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00053">include/asterisk/config.h:53</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga8f085d5905794e05f39eb6056fcba447"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga8f085d5905794e05f39eb6056fcba447">rtp_topic_forwarder</a></div><div class="ttdeci">static struct stasis_forward * rtp_topic_forwarder</div><div class="ttdoc">The stasis_subscription for forwarding the RTP topic to the AMI topic. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01496">manager.c:1496</a></div></div>
<div class="ttc" id="channel_8h_html_a7ca2fda13b129a55c251b56729de285b"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7ca2fda13b129a55c251b56729de285b">ast_channel_name</a></div><div class="ttdeci">const char * ast_channel_name(const struct ast_channel *chan)</div></div>
<div class="ttc" id="group__Group__AMI_html_ga2cbbc87c25cdd3f6346961d3ed40b2fb"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2cbbc87c25cdd3f6346961d3ed40b2fb">mansession_lock</a></div><div class="ttdeci">static void mansession_lock(struct mansession *s)</div><div class="ttdoc">Lock the &amp;#39;mansession&amp;#39; structure. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03251">manager.c:3251</a></div></div>
<div class="ttc" id="structvariable__count_html_aa5928c052b47c013b060484e096eb6bb"><div class="ttname"><a href="../../de/dd0/structvariable__count.html#aa5928c052b47c013b060484e096eb6bb">variable_count::varname</a></div><div class="ttdeci">char * varname</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07696">manager.c:7696</a></div></div>
<div class="ttc" id="manager_8c_html_a1a24728a1340746b7d1e914f0bc6bc78"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a1a24728a1340746b7d1e914f0bc6bc78">astman_datastore_find</a></div><div class="ttdeci">struct ast_datastore * astman_datastore_find(struct mansession *s, const struct ast_datastore_info *info, const char *uid)</div><div class="ttdoc">Find a datastore on a session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09678">manager.c:9678</a></div></div>
<div class="ttc" id="strings_8h_html_a6c3dc0bad204e9dd9890325c1c861e38"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a6c3dc0bad204e9dd9890325c1c861e38">ast_false</a></div><div class="ttdeci">int attribute_pure ast_false(const char *val)</div><div class="ttdoc">Make sure something is false. Determine if a string containing a boolean value is &quot;false&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01968">main/utils.c:1968</a></div></div>
<div class="ttc" id="structast__cli__args_html_a4b911d12699acbbb5a8b62355b35bae8"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html#a4b911d12699acbbb5a8b62355b35bae8">ast_cli_args::pos</a></div><div class="ttdeci">const int pos</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00164">cli.h:164</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gga8d9eefd35c6b7be4f64a4b4dc9d92fd8ae465b39e083c5cc742896c9941dc5a6f"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gga8d9eefd35c6b7be4f64a4b4dc9d92fd8ae465b39e083c5cc742896c9941dc5a6f">FILTER_ALLOC_FAILED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01436">manager.c:1436</a></div></div>
<div class="ttc" id="structast__channel__snapshot_html_a9c0a621242a8915244954e5a273c8cf7"><div class="ttname"><a href="../../dd/dbe/structast__channel__snapshot.html#a9c0a621242a8915244954e5a273c8cf7">ast_channel_snapshot::bridge</a></div><div class="ttdeci">struct ast_channel_snapshot_bridge * bridge</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d4a/stasis__channels_8h_source.html#l00150">stasis_channels.h:150</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1da9f62d8ce9119202ffb00eb74d5db7412"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1da9f62d8ce9119202ffb00eb74d5db7412">AST_AOC_BILLING_CALL_TRANSFER</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00058">aoc.h:58</a></div></div>
<div class="ttc" id="manager_8h_html_aa170f815ce3d25efbf1b0f3dede94ea4"><div class="ttname"><a href="../../db/d45/manager_8h.html#aa170f815ce3d25efbf1b0f3dede94ea4">manager_system_init</a></div><div class="ttdeci">int manager_system_init(void)</div><div class="ttdoc">Initialize support for AMI system events. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d65/manager__system_8c_source.html#l00043">manager_system.c:43</a></div></div>
<div class="ttc" id="group__StasisTopicsAndMessages_html_gae7636be9781a3bd85e52ba016e8c432f"><div class="ttname"><a href="../../df/deb/group__StasisTopicsAndMessages.html#gae7636be9781a3bd85e52ba016e8c432f">ast_rtp_topic</a></div><div class="ttdeci">struct stasis_topic * ast_rtp_topic(void)</div><div class="ttdoc">Stasis Message Bus API topic for RTP and RTCP related messages </div><div class="ttdef"><b>Definition:</b> <a href="../../da/dbe/rtp__engine_8c_source.html#l03531">rtp_engine.c:3531</a></div></div>
<div class="ttc" id="manager_8h_html_a02eaf5c4a70ebad8e543c2efb7707869"><div class="ttname"><a href="../../db/d45/manager_8h.html#a02eaf5c4a70ebad8e543c2efb7707869">EVENT_FLAG_VERBOSE</a></div><div class="ttdeci">#define EVENT_FLAG_VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00074">manager.h:74</a></div></div>
<div class="ttc" id="channel_8h_html_a256993c64e12e420aa141c07363db3ef"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a256993c64e12e420aa141c07363db3ef">ast_channel_iterator_destroy</a></div><div class="ttdeci">struct ast_channel_iterator * ast_channel_iterator_destroy(struct ast_channel_iterator *i)</div><div class="ttdoc">Destroy a channel iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01360">channel.c:1360</a></div></div>
<div class="ttc" id="structast__manager__user_html_acf3e6b25218c40455fd7dbce5fd3ee82"><div class="ttname"><a href="../../db/d8a/structast__manager__user.html#acf3e6b25218c40455fd7dbce5fd3ee82">ast_manager_user::secret</a></div><div class="ttdeci">char * secret</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01646">manager.c:1646</a></div></div>
<div class="ttc" id="mwi_8h_html"><div class="ttname"><a href="../../dc/d33/mwi_8h.html">mwi.h</a></div><div class="ttdoc">Asterisk MWI API. </div></div>
<div class="ttc" id="structast__http__uri_html"><div class="ttname"><a href="../../d0/d6c/structast__http__uri.html">ast_http_uri</a></div><div class="ttdoc">Definition of a URI handler. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00100">http.h:100</a></div></div>
<div class="ttc" id="hsearch_8c_html_ad0f0f85b3cab490a81baa02c4b9edf45"><div class="ttname"><a href="../../db/d37/hsearch_8c.html#ad0f0f85b3cab490a81baa02c4b9edf45">retval</a></div><div class="ttdeci">static ENTRY retval</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d37/hsearch_8c_source.html#l00050">hsearch.c:50</a></div></div>
<div class="ttc" id="pbx_8h_html_ae0ba2eb966a9e3376de61d30513f7302"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ae0ba2eb966a9e3376de61d30513f7302">ast_async_goto</a></div><div class="ttdeci">int ast_async_goto(struct ast_channel *chan, const char *context, const char *exten, int priority)</div><div class="ttdoc">Set the channel to next execute the specified dialplan location. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l07011">pbx.c:7011</a></div></div>
<div class="ttc" id="aoc_8h_html_a7558fd4fc6c76430875d931bd16b7b1d"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a7558fd4fc6c76430875d931bd16b7b1d">ast_aoc_billing_id</a></div><div class="ttdeci">ast_aoc_billing_id</div><div class="ttdoc">Defines the billing id options for an aoc message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00049">aoc.h:49</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gab0df757e83667997fd4b802de7c7c45b"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gab0df757e83667997fd4b802de7c7c45b">fast_originate</a></div><div class="ttdeci">static void * fast_originate(void *data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05413">manager.c:5413</a></div></div>
<div class="ttc" id="cel__pgsql_8c_html_ad6c487210772a9b4b0ca04b04b847d4c"><div class="ttname"><a href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a></div><div class="ttdeci">static PGresult * result</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1b/cel__pgsql_8c_source.html#l00088">cel_pgsql.c:88</a></div></div>
<div class="ttc" id="structmansession__session_html_a26209ae0bf3ca1689131b748bc838a51"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a26209ae0bf3ca1689131b748bc838a51">mansession_session::challenge</a></div><div class="ttdeci">char challenge[10]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01593">manager.c:1593</a></div></div>
<div class="ttc" id="manager_8c_html_a56275a7a3b863c8b4a49d2e74ebe739c"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a56275a7a3b863c8b4a49d2e74ebe739c">astman_datastore_add</a></div><div class="ttdeci">int astman_datastore_add(struct mansession *s, struct ast_datastore *datastore)</div><div class="ttdoc">Add a datastore to a session. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09666">manager.c:9666</a></div></div>
<div class="ttc" id="include_2asterisk_2features__config_8h_html_a57cae4c5040ce0791d0b4798193fc47f"><div class="ttname"><a href="../../d0/daa/include_2asterisk_2features__config_8h.html#a57cae4c5040ce0791d0b4798193fc47f">AST_FEATURE_MAX_LEN</a></div><div class="ttdeci">#define AST_FEATURE_MAX_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/daa/include_2asterisk_2features__config_8h_source.html#l00231">include/asterisk/features_config.h:231</a></div></div>
<div class="ttc" id="channel_8h_html_a7e5e15c22564fd66351d332ad10658b5"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7e5e15c22564fd66351d332ad10658b5">ast_queue_control_data</a></div><div class="ttdeci">int ast_queue_control_data(struct ast_channel *chan, enum ast_control_frame_type control, const void *data, size_t datalen)</div><div class="ttdoc">Queue a control frame with payload. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01238">channel.c:1238</a></div></div>
<div class="ttc" id="json_8h_html_afa6ea445bb95ea8408059af15173b374"><div class="ttname"><a href="../../d4/d05/json_8h.html#afa6ea445bb95ea8408059af15173b374">ast_json_array_size</a></div><div class="ttdeci">size_t ast_json_array_size(const struct ast_json *array)</div><div class="ttdoc">Get the size of a JSON array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00356">json.c:356</a></div></div>
<div class="ttc" id="strings_8h_html_a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a6b26879ddbe135cabc07822b019b0b17ad5a39d9c273e14503b5edc1c8541ebe2">AST_STRSEP_STRIP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00251">strings.h:251</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga2b80579f3d94f43d2e7def7add35dc61"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga2b80579f3d94f43d2e7def7add35dc61">action_hangup</a></div><div class="ttdeci">static int action_hangup(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04460">manager.c:4460</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a66066052ae6571f5495a4e7f8df6c0bb"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a66066052ae6571f5495a4e7f8df6c0bb">fast_originate_helper::app</a></div><div class="ttdeci">const ast_string_field app</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0464e7b1c82d29cbe8b3f70bf7ca29c6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0464e7b1c82d29cbe8b3f70bf7ca29c6">purge_events</a></div><div class="ttdeci">static void purge_events(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01983">manager.c:1983</a></div></div>
<div class="ttc" id="http_8h_html_ac000c497701f197370cbef5aa4c1a92e"><div class="ttname"><a href="../../dd/d56/http_8h.html#ac000c497701f197370cbef5aa4c1a92e">ast_http_get_post_vars</a></div><div class="ttdeci">struct ast_variable * ast_http_get_post_vars(struct ast_tcptls_session_instance *ser, struct ast_variable *headers)</div><div class="ttdoc">Get post variables from client Request Entity-Body, if content type is application/x-www-form-urlenco...</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l01353">http.c:1353</a></div></div>
<div class="ttc" id="iostream_8h_html_ab426c2063464fc2e2719f8edd9e03085"><div class="ttname"><a href="../../dd/d27/iostream_8h.html#ab426c2063464fc2e2719f8edd9e03085">ast_iostream_nonblock</a></div><div class="ttdeci">void ast_iostream_nonblock(struct ast_iostream *stream)</div><div class="ttdoc">Make an iostream non-blocking. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc8/iostream_8c_source.html#l00103">iostream.c:103</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga21a9d344c805f9450b254b4fc0f5afcd"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga21a9d344c805f9450b254b4fc0f5afcd">whitefilter_cmp_fn</a></div><div class="ttdeci">static int whitefilter_cmp_fn(void *obj, void *arg, void *data, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06078">manager.c:6078</a></div></div>
<div class="ttc" id="stasis_8h_html_a4f248ee5f4791f05d0af8768aaab282b"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a4f248ee5f4791f05d0af8768aaab282b">stasis_subscription_accept_message_type</a></div><div class="ttdeci">int stasis_subscription_accept_message_type(struct stasis_subscription *subscription, const struct stasis_message_type *type)</div><div class="ttdoc">Indicate to a subscription that we are interested in a message type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01025">stasis.c:1025</a></div></div>
<div class="ttc" id="tcptls_8h_html_a79d9a3beb22f1fb8551cef625e9fd8a1"><div class="ttname"><a href="../../d4/ddf/tcptls_8h.html#a79d9a3beb22f1fb8551cef625e9fd8a1">ast_tls_read_conf</a></div><div class="ttdeci">int ast_tls_read_conf(struct ast_tls_config *tls_cfg, struct ast_tcptls_session_args *tls_desc, const char *varname, const char *value)</div><div class="ttdoc">Used to parse conf files containing tls/ssl options. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d9b/tcptls_8c_source.html#l00875">tcptls.c:875</a></div></div>
<div class="ttc" id="acl_8h_html_a764d04fe9485be95771e652dc2c87445abb486b5b819cf3b3951ce0a2e584f065"><div class="ttname"><a href="../../d5/d59/acl_8h.html#a764d04fe9485be95771e652dc2c87445abb486b5b819cf3b3951ce0a2e584f065">AST_SENSE_DENY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d59/acl_8h_source.html#l00037">acl.h:37</a></div></div>
<div class="ttc" id="res__corosync_8c_html_a8e51289dd0fc7415cee40e7a57b49fdf"><div class="ttname"><a href="../../d1/da4/res__corosync_8c.html#a8e51289dd0fc7415cee40e7a57b49fdf">sub</a></div><div class="ttdeci">struct stasis_forward * sub</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/da4/res__corosync_8c_source.html#l00240">res_corosync.c:240</a></div></div>
<div class="ttc" id="structast__frame_html"><div class="ttname"><a href="../../d0/d99/structast__frame.html">ast_frame</a></div><div class="ttdoc">Data structure associated with a single frame of data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00165">include/asterisk/frame.h:165</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac2fe93293795ad443c10ac77cbcaee14"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac2fe93293795ad443c10ac77cbcaee14">manager_json_obj_with_key</a></div><div class="ttdeci">static void manager_json_obj_with_key(struct ast_json *obj, const char *key, const char *parent_key, struct ast_str **res, key_exclusion_cb exclusion_cb)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01765">manager.c:1765</a></div></div>
<div class="ttc" id="pbx_8h_html_aad8771c7e3b2170a749946f1a8b758aa"><div class="ttname"><a href="../../db/de0/pbx_8h.html#aad8771c7e3b2170a749946f1a8b758aa">__ast_custom_function_register</a></div><div class="ttdeci">int __ast_custom_function_register(struct ast_custom_function *acf, struct ast_module *mod)</div><div class="ttdoc">Register a custom function. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d70/pbx__functions_8c_source.html#l00373">pbx_functions.c:373</a></div></div>
<div class="ttc" id="manager_8h_html_aafd542831b3864e77f37396573bc1fd0"><div class="ttname"><a href="../../db/d45/manager_8h.html#aafd542831b3864e77f37396573bc1fd0">ast_manager_event_multichan</a></div><div class="ttdeci">#define ast_manager_event_multichan(category, event, nchans, chans, contents,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00255">manager.h:255</a></div></div>
<div class="ttc" id="structast__tcptls__session__args_html_ad6d7a8463d59a02084cf9d4360f46b79"><div class="ttname"><a href="../../da/d2b/structast__tcptls__session__args.html#ad6d7a8463d59a02084cf9d4360f46b79">ast_tcptls_session_args::accept_fd</a></div><div class="ttdeci">int accept_fd</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00135">tcptls.h:135</a></div></div>
<div class="ttc" id="strings_8h_html_ac51fa66c90ce950b248c9ff3e8c4e453"><div class="ttname"><a href="../../d6/d90/strings_8h.html#ac51fa66c90ce950b248c9ff3e8c4e453">ast_begins_with</a></div><div class="ttdeci">static int force_inline attribute_pure ast_begins_with(const char *str, const char *prefix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00094">strings.h:94</a></div></div>
<div class="ttc" id="aoc_8h_html_aed3fe8e8d708e8aff42a2ad205813cb7aff4d08a18d17f2ffe60dd21a316ae677"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#aed3fe8e8d708e8aff42a2ad205813cb7aff4d08a18d17f2ffe60dd21a316ae677">AST_AOC_SUBTOTAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00084">aoc.h:84</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_a88ee7e279ede6839297441d1768ec6d1"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#a88ee7e279ede6839297441d1768ec6d1">fast_originate_helper::channelid</a></div><div class="ttdeci">const ast_string_field channelid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="manager_8h_html_a8c8f2d8718ba98dc22b6615489fa2f8e"><div class="ttname"><a href="../../db/d45/manager_8h.html#a8c8f2d8718ba98dc22b6615489fa2f8e">key_exclusion_cb</a></div><div class="ttdeci">int(* key_exclusion_cb)(const char *key)</div><div class="ttdoc">Callback used to determine whether a key should be skipped when converting a JSON object to a manager...</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00444">manager.h:444</a></div></div>
<div class="ttc" id="structmessage_html_a81929bcaa1dcfa1abf47977385058cbe"><div class="ttname"><a href="../../d8/d9e/structmessage.html#a81929bcaa1dcfa1abf47977385058cbe">message::headers</a></div><div class="ttdeci">const char * headers[AST_MAX_MANHEADERS]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00146">manager.h:146</a></div></div>
<div class="ttc" id="stasis_8h_html_a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a3804fa8ec76d77090d5cda80fc4ac891a0e40588366edb9a53e453d47ef26d567">STASIS_SUBSCRIPTION_FILTER_SELECTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d79/stasis_8h_source.html#l00300">stasis.h:300</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga556bc46323d87c59cf471a5f48c7d2d5"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga556bc46323d87c59cf471a5f48c7d2d5">session_destroy</a></div><div class="ttdeci">static void session_destroy(struct mansession_session *s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02269">manager.c:2269</a></div></div>
<div class="ttc" id="structast__json_html"><div class="ttname"><a href="../../d1/da1/structast__json.html">ast_json</a></div><div class="ttdoc">Abstract JSON element (object, array, string, int, ...). </div></div>
<div class="ttc" id="utils_8h_html_a624b98abd96c41fb9ce72c005217128b"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a624b98abd96c41fb9ce72c005217128b">ast_parse_digest</a></div><div class="ttdeci">int ast_parse_digest(const char *digest, struct ast_http_digest *d, int request, int pedantic)</div><div class="ttdoc">Parse digest authorization header. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l02390">main/utils.c:2390</a></div></div>
<div class="ttc" id="structast__cli__args_html"><div class="ttname"><a href="../../d3/dad/structast__cli__args.html">ast_cli_args</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00158">cli.h:158</a></div></div>
<div class="ttc" id="structfast__originate__helper_html_ac0b1407c0017cb917a9687f90d16b106"><div class="ttname"><a href="../../d2/d3c/structfast__originate__helper.html#ac0b1407c0017cb917a9687f90d16b106">fast_originate_helper::idtext</a></div><div class="ttdeci">const ast_string_field idtext</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05393">manager.c:5393</a></div></div>
<div class="ttc" id="aoc_8h_html_aa7dc1e0987972e9eb92627a1190eb548a98adf1ef32c4d9b775cc595795ac4693"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548a98adf1ef32c4d9b775cc595795ac4693">AST_AOC_E</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00066">aoc.h:66</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa6da807cb7fb332127a4896dd423ed6d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa6da807cb7fb332127a4896dd423ed6d">global_realm</a></div><div class="ttdeci">static char global_realm[MAXHOSTNAMELEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01484">manager.c:1484</a></div></div>
<div class="ttc" id="pbx_8h_html_ab077da615e93c9e88ce539bef23f82e6a2e89bd60b1752d920f58a70164607189"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ab077da615e93c9e88ce539bef23f82e6a2e89bd60b1752d920f58a70164607189">AST_HINT_UPDATE_DEVICE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/de0/pbx_8h_source.html#l00091">pbx.h:91</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_a7abc0e2e7315ff4d193e700fa6f1e31e"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#a7abc0e2e7315ff4d193e700fa6f1e31e">AST_SECURITY_EVENT_REQ_BAD_FORMAT_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_REQ_BAD_FORMAT_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00361">security_events_defs.h:361</a></div></div>
<div class="ttc" id="channel_8h_html_a5812578dedc2371e255eec8503bd50d6"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a5812578dedc2371e255eec8503bd50d6">ast_channel_pickupgroup</a></div><div class="ttdeci">ast_group_t ast_channel_pickupgroup(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01082">channel_internal_api.c:1082</a></div></div>
<div class="ttc" id="http_8h_html_a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80"><div class="ttname"><a href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80efa544b9492daf28b47937772ca54e31c80">AST_HTTP_POST</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00059">http.h:59</a></div></div>
<div class="ttc" id="structmansession_html_ab51bd75c585f6401e1e7b7fb4000760d"><div class="ttname"><a href="../../d2/d8a/structmansession.html#ab51bd75c585f6401e1e7b7fb4000760d">mansession::session</a></div><div class="ttdeci">struct mansession_session * session</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01626">manager.c:1626</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6091f0518f8b6f443fd9f5150f3ac407"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6091f0518f8b6f443fd9f5150f3ac407">AST_RWLIST_REMOVE</a></div><div class="ttdeci">#define AST_RWLIST_REMOVE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00884">linkedlists.h:884</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a025ede890af287961d3a98d0e634a62b"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a025ede890af287961d3a98d0e634a62b">b</a></div><div class="ttdeci">static struct test_val b</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00047">test_linkedlists.c:47</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga7a69d5366de99cd023fe903f6edee0a8"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga7a69d5366de99cd023fe903f6edee0a8">handle_parse_error</a></div><div class="ttdeci">static void handle_parse_error(struct mansession *s, struct message *m, char *error)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06835">manager.c:6835</a></div></div>
<div class="ttc" id="structentry_html"><div class="ttname"><a href="../../d3/d96/structentry.html">entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d85/search_8h_source.html#l00040">search.h:40</a></div></div>
<div class="ttc" id="channel_8h_html_a582dee4d5ea9b2ff6f309f0c5239f6bd"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a582dee4d5ea9b2ff6f309f0c5239f6bd">ast_channel_context</a></div><div class="ttdeci">const char * ast_channel_context(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00344">channel_internal_api.c:344</a></div></div>
<div class="ttc" id="term_8h_html"><div class="ttname"><a href="../../db/d45/term_8h.html">term.h</a></div><div class="ttdoc">Handy terminal functions for vt* terms. </div></div>
<div class="ttc" id="utils_2frame_8c_html_a4a9391ee88e57361b613c4c2fd2bf4aa"><div class="ttname"><a href="../../d6/d47/utils_2frame_8c.html#a4a9391ee88e57361b613c4c2fd2bf4aa">error</a></div><div class="ttdeci">int error(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d47/utils_2frame_8c_source.html#l00999">utils/frame.c:999</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga5f3b2b093b498ed27078743ec10c05b7"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga5f3b2b093b498ed27078743ec10c05b7">action_extensionstate</a></div><div class="ttdeci">static int action_extensionstate(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l05974">manager.c:5974</a></div></div>
<div class="ttc" id="structstasis__forward_html"><div class="ttname"><a href="../../d8/d54/structstasis__forward.html">stasis_forward</a></div><div class="ttdoc">Forwarding information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01531">stasis.c:1531</a></div></div>
<div class="ttc" id="aoc_8h_html_a8f4901f528a0a8c757a12e94178606e6"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a8f4901f528a0a8c757a12e94178606e6">ast_aoc_set_association_id</a></div><div class="ttdeci">int ast_aoc_set_association_id(struct ast_aoc_decoded *decoded, const int id)</div><div class="ttdoc">set the charging association id for an AST_AOC_E message </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l01040">aoc.c:1040</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html">ast_xml_doc_item</a></div><div class="ttdoc">Struct that contains the XML documentation for a particular item. Note that this is an ao2 ref counte...</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00056">xmldoc.h:56</a></div></div>
<div class="ttc" id="time_8h_html_aa13b651c18bc6004cab21ac041d44dd8"><div class="ttname"><a href="../../de/df7/time_8h.html#aa13b651c18bc6004cab21ac041d44dd8">ast_tvsub</a></div><div class="ttdeci">struct timeval ast_tvsub(struct timeval a, struct timeval b)</div><div class="ttdoc">Returns the difference of two timevals a - b. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc5/extconf_8c_source.html#l02298">extconf.c:2298</a></div></div>
<div class="ttc" id="structast__tls__config_html_a8331a8443119478cd6b1daeb707a94dc"><div class="ttname"><a href="../../d5/d90/structast__tls__config.html#a8331a8443119478cd6b1daeb707a94dc">ast_tls_config::capath</a></div><div class="ttdeci">char * capath</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00093">tcptls.h:93</a></div></div>
<div class="ttc" id="utils_8h_html_a60404ef44696316455e79c3a002cc71e"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a60404ef44696316455e79c3a002cc71e">ast_wait_for_input</a></div><div class="ttdeci">int ast_wait_for_input(int fd, int ms)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l01519">main/utils.c:1519</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_a00073637bd298c4ceff7c0e257840f96"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#a00073637bd298c4ceff7c0e257840f96">AST_SECURITY_EVENT_CHAL_RESP_FAILED_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_CHAL_RESP_FAILED_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00429">security_events_defs.h:429</a></div></div>
<div class="ttc" id="asterisk_8h_html_ae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="../../db/db2/asterisk_8h.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db2/asterisk_8h_source.html#l00040">asterisk.h:40</a></div></div>
<div class="ttc" id="tcptls_8h_html_a1fd4aa5038c9a488acc0f8017fe94fda"><div class="ttname"><a href="../../d4/ddf/tcptls_8h.html#a1fd4aa5038c9a488acc0f8017fe94fda">ast_tcptls_server_stop</a></div><div class="ttdeci">void ast_tcptls_server_stop(struct ast_tcptls_session_args *desc)</div><div class="ttdoc">Shutdown a running server if there is one. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d9b/tcptls_8c_source.html#l00849">tcptls.c:849</a></div></div>
<div class="ttc" id="netsock2_8h_html_aa2785c5990a086943fea750c980abbc3ac5d05bd6daa774e40db98ff06a91bc0a"><div class="ttname"><a href="../../db/df1/netsock2_8h.html#aa2785c5990a086943fea750c980abbc3ac5d05bd6daa774e40db98ff06a91bc0a">AST_TRANSPORT_TLS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/df1/netsock2_8h_source.html#l00062">netsock2.h:62</a></div></div>
<div class="ttc" id="structast__tcptls__session__args_html_aeb4a21e3ae033a326cc9dfd20a7ab074"><div class="ttname"><a href="../../da/d2b/structast__tcptls__session__args.html#aeb4a21e3ae033a326cc9dfd20a7ab074">ast_tcptls_session_args::tls_cfg</a></div><div class="ttdeci">struct ast_tls_config * tls_cfg</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00134">tcptls.h:134</a></div></div>
<div class="ttc" id="structast__security__event__req__bad__format_html"><div class="ttname"><a href="../../d1/dc1/structast__security__event__req__bad__format.html">ast_security_event_req_bad_format</a></div><div class="ttdoc">Invalid formatting of request. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00356">security_events_defs.h:356</a></div></div>
<div class="ttc" id="manager_8c_html_a55e80c6eb9c6407bf5af1f4869bb1f8d"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a55e80c6eb9c6407bf5af1f4869bb1f8d">handle_manager_show_event</a></div><div class="ttdeci">static char * handle_manager_show_event(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08830">manager.c:8830</a></div></div>
<div class="ttc" id="lock_8h_html_a76e8ed6bb354be6c6dd9e51acc1d7a1b"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a76e8ed6bb354be6c6dd9e51acc1d7a1b">ast_mutex_init</a></div><div class="ttdeci">#define ast_mutex_init(pmutex)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00184">lock.h:184</a></div></div>
<div class="ttc" id="structao2__container_html"><div class="ttname"><a href="../../d2/da9/structao2__container.html">ao2_container</a></div><div class="ttdoc">Generic container type. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d20/astobj2__container__private_8h_source.html#l00282">astobj2_container_private.h:282</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9d6ad22f239563cb0ec69d475299fa87"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9d6ad22f239563cb0ec69d475299fa87">allowmultiplelogin</a></div><div class="ttdeci">static int allowmultiplelogin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01471">manager.c:1471</a></div></div>
<div class="ttc" id="cli_8h_html_a29e703082f8137e165097c41f249e6d1"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a29e703082f8137e165097c41f249e6d1">AST_CLI_YESNO</a></div><div class="ttdeci">#define AST_CLI_YESNO(x)</div><div class="ttdoc">Return Yes or No depending on the argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00071">cli.h:71</a></div></div>
<div class="ttc" id="strings_8h_html_afe8f5f844f2fd5f5bd5d0be5ef671481"><div class="ttname"><a href="../../d6/d90/strings_8h.html#afe8f5f844f2fd5f5bd5d0be5ef671481">ast_str_thread_get</a></div><div class="ttdeci">struct ast_str * ast_str_thread_get(struct ast_threadstorage *ts, size_t init_len)</div><div class="ttdoc">Retrieve a thread locally stored dynamic string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00861">strings.h:861</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html_a6b8fc14a9dd623efaf1a93949341bd4e"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html#a6b8fc14a9dd623efaf1a93949341bd4e">ast_xml_doc_item::arguments</a></div><div class="ttdeci">struct ast_str * arguments</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00062">xmldoc.h:62</a></div></div>
<div class="ttc" id="structast__http__uri_html_a69ec24fb2d0a5f5e532deb9adaab81d6"><div class="ttname"><a href="../../d0/d6c/structast__http__uri.html#a69ec24fb2d0a5f5e532deb9adaab81d6">ast_http_uri::uri</a></div><div class="ttdeci">const char * uri</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00103">http.h:103</a></div></div>
<div class="ttc" id="structast__party__name_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d8/d6f/structast__party__name.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_name::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the name information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00280">channel.h:280</a></div></div>
<div class="ttc" id="test__http__media__cache_8c_html_a80c8e3ae5087d90d422675d034eeebc7"><div class="ttname"><a href="../../d4/d45/test__http__media__cache_8c.html#a80c8e3ae5087d90d422675d034eeebc7">options</a></div><div class="ttdeci">static struct test_options options</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d45/test__http__media__cache_8c_source.html#l00062">test_http_media_cache.c:62</a></div></div>
<div class="ttc" id="structast__tcptls__session__args_html_a6652499b3aff8f317d4c6d1a36c6c740"><div class="ttname"><a href="../../da/d2b/structast__tcptls__session__args.html#a6652499b3aff8f317d4c6d1a36c6c740">ast_tcptls_session_args::local_address</a></div><div class="ttdeci">struct ast_sockaddr local_address</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00130">tcptls.h:130</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ggae9440b5a8f6a5fb7e1667674b1507344a4062487b032b9348705c5ff65d21d777"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ggae9440b5a8f6a5fb7e1667674b1507344a4062487b032b9348705c5ff65d21d777">MESSAGE_OKAY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01616">manager.c:1616</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_ac25ea00ee3f082df06e0cf468cbde240"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#ac25ea00ee3f082df06e0cf468cbde240">context</a></div><div class="ttdeci">static char context[AST_MAX_CONTEXT]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00116">chan_alsa.c:116</a></div></div>
<div class="ttc" id="channel_8h_html_abd38558261afd18f7c08f05b89625313"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#abd38558261afd18f7c08f05b89625313">ast_channel_callgroup</a></div><div class="ttdeci">ast_group_t ast_channel_callgroup(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01074">channel_internal_api.c:1074</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaf4adfeec3f6af24e2ede7e730bee32eb"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaf4adfeec3f6af24e2ede7e730bee32eb">acl_change_stasis_cb</a></div><div class="ttdeci">static void acl_change_stasis_cb(void *data, struct stasis_subscription *sub, struct stasis_message *message)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09637">manager.c:9637</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gad91b17071378fe3910cb119a257dab30"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gad91b17071378fe3910cb119a257dab30">action_corestatus</a></div><div class="ttdeci">static int action_corestatus(struct mansession *s, const struct message *m)</div><div class="ttdoc">Show PBX core status information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06318">manager.c:6318</a></div></div>
<div class="ttc" id="features_8h_html"><div class="ttname"><a href="../../de/d47/features_8h.html">features.h</a></div><div class="ttdoc">Call Parking and Pickup API Includes code and algorithms from the Zapata library. ...</div></div>
<div class="ttc" id="channel_8h_html_a91de92158876186d28ba1773877f2732"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a91de92158876186d28ba1773877f2732">ast_channel_flags</a></div><div class="ttdeci">struct ast_flags * ast_channel_flags(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l01260">channel_internal_api.c:1260</a></div></div>
<div class="ttc" id="http_8h_html_a16fb43ed7e6093a9dc96477ba37b80ef"><div class="ttname"><a href="../../dd/d56/http_8h.html#a16fb43ed7e6093a9dc96477ba37b80ef">ast_http_method</a></div><div class="ttdeci">ast_http_method</div><div class="ttdoc">HTTP Request methods known by Asterisk. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00056">http.h:56</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a64835fe6d570951b2a0404799c3d116f"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a64835fe6d570951b2a0404799c3d116f">AST_RWLIST_FIRST</a></div><div class="ttdeci">#define AST_RWLIST_FIRST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00422">linkedlists.h:422</a></div></div>
<div class="ttc" id="structast__aoc__unit__entry_html"><div class="ttname"><a href="../../df/d18/structast__aoc__unit__entry.html">ast_aoc_unit_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00178">aoc.h:178</a></div></div>
<div class="ttc" id="lock_8h_html_ab8977a71822daa556f19f30ba6eec765"><div class="ttname"><a href="../../dd/d42/lock_8h.html#ab8977a71822daa556f19f30ba6eec765">ast_mutex_destroy</a></div><div class="ttdeci">#define ast_mutex_destroy(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00186">lock.h:186</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gad0b42352088047f7b3f29b4b331b43cd"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gad0b42352088047f7b3f29b4b331b43cd">webmanager_enabled</a></div><div class="ttdeci">static int webmanager_enabled</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01477">manager.c:1477</a></div></div>
<div class="ttc" id="func__strings_8c_html_af2deb3c7b0d3bdd442bb9ada5fda3d17"><div class="ttname"><a href="../../d9/d1e/func__strings_8c.html#af2deb3c7b0d3bdd442bb9ada5fda3d17">filter</a></div><div class="ttdeci">static int filter(struct ast_channel *chan, const char *cmd, char *parse, char *buf, size_t len)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d1e/func__strings_8c_source.html#l00709">func_strings.c:709</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a976052ba6bdad7e94e60cd4bc1c3f3b2"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a976052ba6bdad7e94e60cd4bc1c3f3b2">ast_category_get</a></div><div class="ttdeci">struct ast_category * ast_category_get(const struct ast_config *config, const char *category_name, const char *filter)</div><div class="ttdoc">Retrieve a category if it exists. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01022">main/config.c:1022</a></div></div>
<div class="ttc" id="manager_8h_html_abc1db69d70499e0e8b178fccbc76b505"><div class="ttname"><a href="../../db/d45/manager_8h.html#abc1db69d70499e0e8b178fccbc76b505">manager_channels_init</a></div><div class="ttdeci">int manager_channels_init(void)</div><div class="ttdoc">Initialize support for AMI channel events. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d1c/manager__channels_8c_source.html#l01308">manager_channels.c:1308</a></div></div>
<div class="ttc" id="structmanager__action_html_aa403beb670a3277f542647cc9aa22137"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#aa403beb670a3277f542647cc9aa22137">manager_action::synopsis</a></div><div class="ttdeci">const ast_string_field synopsis</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00158">manager.h:158</a></div></div>
<div class="ttc" id="channel_8h_html_aae1445ed63630123081206e3de5b7b1a"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#aae1445ed63630123081206e3de5b7b1a">ast_channel_iterator_all_new</a></div><div class="ttdeci">struct ast_channel_iterator * ast_channel_iterator_all_new(void)</div><div class="ttdoc">Create a new channel iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01408">channel.c:1408</a></div></div>
<div class="ttc" id="pbx_8h_html_ab1d88f370509aae87302134e6f70628a"><div class="ttname"><a href="../../db/de0/pbx_8h.html#ab1d88f370509aae87302134e6f70628a">ast_extension_state_add</a></div><div class="ttdeci">int ast_extension_state_add(const char *context, const char *exten, ast_state_cb_type change_cb, void *data)</div><div class="ttdoc">Add watcher for extension states. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d94/pbx_8c_source.html#l03825">pbx.c:3825</a></div></div>
<div class="ttc" id="stasis_8h_html_a2513a93567ddc93510f7896b777da119"><div class="ttname"><a href="../../dd/d79/stasis_8h.html#a2513a93567ddc93510f7896b777da119">stasis_forward_all</a></div><div class="ttdeci">struct stasis_forward * stasis_forward_all(struct stasis_topic *from_topic, struct stasis_topic *to_topic)</div><div class="ttdoc">Create a subscription which forwards all messages from one topic to another. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df4/stasis_8c_source.html#l01578">stasis.c:1578</a></div></div>
<div class="ttc" id="group__main__options_html_gaf2588453b3a373a770741ad3ce353343ade4cf3231c69af57ad0527bd46244680"><div class="ttname"><a href="../../d6/dd6/group__main__options.html#gaf2588453b3a373a770741ad3ce353343ade4cf3231c69af57ad0527bd46244680">AST_OPT_FLAG_FULLY_BOOTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5b/options_8h_source.html#l00058">options.h:58</a></div></div>
<div class="ttc" id="module_8h_html_a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c"><div class="ttname"><a href="../../d5/d16/module_8h.html#a155a0df9c59e04e305d4a2fa3e35f843a835b27a90d895a488e4e14cc3d2dee8c">AST_MODFLAG_GLOBAL_SYMBOLS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00316">module.h:316</a></div></div>
<div class="ttc" id="module_8h_html_ac9013ad6d9add8a9255568c7db032cb7aae470b102da613cbd14c611b36e75b11"><div class="ttname"><a href="../../d5/d16/module_8h.html#ac9013ad6d9add8a9255568c7db032cb7aae470b102da613cbd14c611b36e75b11">AST_MODULE_RELOAD_NOT_IMPLEMENTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00116">module.h:116</a></div></div>
<div class="ttc" id="stasis__message__router_8h_html_a1570c21a07d1309809ae61c723f28a1d"><div class="ttname"><a href="../../d4/d25/stasis__message__router_8h.html#a1570c21a07d1309809ae61c723f28a1d">stasis_message_router_set_congestion_limits</a></div><div class="ttdeci">int stasis_message_router_set_congestion_limits(struct stasis_message_router *router, long low_water, long high_water)</div><div class="ttdoc">Set the high and low alert water marks of the stasis message router. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d78/stasis__message__router_8c_source.html#l00298">stasis_message_router.c:298</a></div></div>
<div class="ttc" id="cli_8h_html_a6f5f6c330757d980065d3f887c62237f"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a6f5f6c330757d980065d3f887c62237f">ast_cli_completion_add</a></div><div class="ttdeci">int ast_cli_completion_add(char *value)</div><div class="ttdoc">Add a result to a request for completion options. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/dd3/main_2cli_8c_source.html#l02726">main/cli.c:2726</a></div></div>
<div class="ttc" id="include_2asterisk_2frame_8h_html_a2457835b26aa09c41c6ecf633f95f775"><div class="ttname"><a href="../../d6/d66/include_2asterisk_2frame_8h.html#a2457835b26aa09c41c6ecf633f95f775">ast_frame_read_action</a></div><div class="ttdeci">ast_frame_read_action</div><div class="ttdoc">Actions to indicate to, and be handled on channel read. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d66/include_2asterisk_2frame_8h_source.html#l00351">include/asterisk/frame.h:351</a></div></div>
<div class="ttc" id="structmansession__session_html_a6886313a6b114cbcf7cb60676533c405"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a6886313a6b114cbcf7cb60676533c405">mansession_session::sessionstart</a></div><div class="ttdeci">time_t sessionstart</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01589">manager.c:1589</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html_a01b39be4dd41eeda5dff6bd9835cdebe"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html#a01b39be4dd41eeda5dff6bd9835cdebe">ast_xml_doc_item::syntax</a></div><div class="ttdeci">struct ast_str * syntax</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00058">xmldoc.h:58</a></div></div>
<div class="ttc" id="callerid_8h_html_a6a61669b28d0f994e44db5e3baab6ef2"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a6a61669b28d0f994e44db5e3baab6ef2">ast_shrink_phone_number</a></div><div class="ttdeci">void ast_shrink_phone_number(char *n)</div><div class="ttdoc">Shrink a phone number in place to just digits (more accurately it just removes ()&amp;#39;s, .&amp;#39;s, and -&amp;#39;s... </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd5/callerid_8c_source.html#l00947">callerid.c:947</a></div></div>
<div class="ttc" id="structmanager__action_html_a8c15417035739fd46675a17c5895afa9"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#a8c15417035739fd46675a17c5895afa9">manager_action::final_response</a></div><div class="ttdeci">struct ast_xml_doc_item * final_response</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00162">manager.h:162</a></div></div>
<div class="ttc" id="structmansession_html_a9469556f47f367a9b16433ba1c2247fe"><div class="ttname"><a href="../../d2/d8a/structmansession.html#a9469556f47f367a9b16433ba1c2247fe">mansession::hook</a></div><div class="ttdeci">struct manager_custom_hook * hook</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01631">manager.c:1631</a></div></div>
<div class="ttc" id="include_2asterisk_2security__events_8h_html_ae13dc3d123710d7519588d54c51f8170"><div class="ttname"><a href="../../d0/d29/include_2asterisk_2security__events_8h.html#ae13dc3d123710d7519588d54c51f8170">ast_security_event_report</a></div><div class="ttdeci">int ast_security_event_report(const struct ast_security_event_common *sec)</div><div class="ttdoc">Report a security event. </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d30/main_2security__events_8c_source.html#l01171">main/security_events.c:1171</a></div></div>
<div class="ttc" id="utils_8h_html_aee8200caadc6a4b5afe01ea37fd26cb3"><div class="ttname"><a href="../../d5/d60/utils_8h.html#aee8200caadc6a4b5afe01ea37fd26cb3">ast_md5_hash</a></div><div class="ttdeci">void ast_md5_hash(char *output, const char *input)</div><div class="ttdoc">Produces MD5 hash based on input string. </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d1f/main_2utils_8c_source.html#l00248">main/utils.c:248</a></div></div>
<div class="ttc" id="module_8h_html_aba2c8d4be709a254658b21a834f8294a"><div class="ttname"><a href="../../d5/d16/module_8h.html#aba2c8d4be709a254658b21a834f8294a">ASTERISK_GPL_KEY</a></div><div class="ttdeci">#define ASTERISK_GPL_KEY</div><div class="ttdoc">The text the key() function should return. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l00046">module.h:46</a></div></div>
<div class="ttc" id="manager_8h_html_a1ef0ee0044dbbeb4c3a5abc6c046b208"><div class="ttname"><a href="../../db/d45/manager_8h.html#a1ef0ee0044dbbeb4c3a5abc6c046b208">manager_event</a></div><div class="ttdeci">#define manager_event(category, event, contents,...)</div><div class="ttdoc">External routines may send asterisk manager events this way. </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00248">manager.h:248</a></div></div>
<div class="ttc" id="channel_8h_html_ac7e42045272530c8678418993e75fd56"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#ac7e42045272530c8678418993e75fd56">ast_channel_get_by_name</a></div><div class="ttdeci">struct ast_channel * ast_channel_get_by_name(const char *name)</div><div class="ttdoc">Find a channel by name. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l01454">channel.c:1454</a></div></div>
<div class="ttc" id="rtp__engine_8h_html"><div class="ttname"><a href="../../d5/dde/rtp__engine_8h.html">rtp_engine.h</a></div><div class="ttdoc">Pluggable RTP Architecture. </div></div>
<div class="ttc" id="bridge_8h_html"><div class="ttname"><a href="../../d4/d56/bridge_8h.html">bridge.h</a></div><div class="ttdoc">Bridging API. </div></div>
<div class="ttc" id="app__mysql_8c_html_a1d9b1eccfc259a14525ce817482a3f88"><div class="ttname"><a href="../../d0/db6/app__mysql_8c.html#a1d9b1eccfc259a14525ce817482a3f88">app</a></div><div class="ttdeci">static const char app[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db6/app__mysql_8c_source.html#l00062">app_mysql.c:62</a></div></div>
<div class="ttc" id="cli_8h_html_a7cc1753a05a0821f6c70dd2bccfbab5c"><div class="ttname"><a href="../../dc/db0/cli_8h.html#a7cc1753a05a0821f6c70dd2bccfbab5c">RESULT_SUCCESS</a></div><div class="ttdeci">#define RESULT_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00040">cli.h:40</a></div></div>
<div class="ttc" id="format__cache_8h_html_a771d7c34570e8e492c25a0c2eb41889d"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html#a771d7c34570e8e492c25a0c2eb41889d">ast_format_slin</a></div><div class="ttdeci">struct ast_format * ast_format_slin</div><div class="ttdoc">Built-in cached signed linear 8kHz format. </div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d29/format__cache_8c_source.html#l00041">format_cache.c:41</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga31a02a7d3cc36aa66ebebdedfc574d1c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga31a02a7d3cc36aa66ebebdedfc574d1c">astman_send_error</a></div><div class="ttdeci">void astman_send_error(struct mansession *s, const struct message *m, char *error)</div><div class="ttdoc">Send error in manager transaction. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03159">manager.c:3159</a></div></div>
<div class="ttc" id="module_8h_html"><div class="ttname"><a href="../../d5/d16/module_8h.html">module.h</a></div><div class="ttdoc">Asterisk module definitions. </div></div>
<div class="ttc" id="channel_8h_html_a1dc625bd14a7875b04bfe0c388858929"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a1dc625bd14a7875b04bfe0c388858929">ast_channel_writeformat</a></div><div class="ttdeci">struct ast_format * ast_channel_writeformat(struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00860">channel_internal_api.c:860</a></div></div>
<div class="ttc" id="manager_8c_html_adab978eb5c8aa199396471558598dc53"><div class="ttname"><a href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53">output_format</a></div><div class="ttdeci">output_format</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07462">manager.c:7462</a></div></div>
<div class="ttc" id="structpermalias_html_ab5fbdb5052858ca8d2538566229fbe64"><div class="ttname"><a href="../../de/d4b/structpermalias.html#ab5fbdb5052858ca8d2538566229fbe64">permalias::label</a></div><div class="ttdeci">const char * label</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02017">manager.c:2017</a></div></div>
<div class="ttc" id="structmansession__session_html_a679cabe3b846f2e363f43d8e57433834"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a679cabe3b846f2e363f43d8e57433834">mansession_session::inuse</a></div><div class="ttdeci">int inuse</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01585">manager.c:1585</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga6ede61db764903806db0e5334d07c010"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga6ede61db764903806db0e5334d07c010">manager_displayconnects</a></div><div class="ttdeci">static int manager_displayconnects(struct mansession_session *session)</div><div class="ttdoc">Get displayconnects config option. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02322">manager.c:2322</a></div></div>
<div class="ttc" id="structmessage_html_a2337374fe8025cb750f52a316166aa6d"><div class="ttname"><a href="../../d8/d9e/structmessage.html#a2337374fe8025cb750f52a316166aa6d">message::hdrcount</a></div><div class="ttdeci">unsigned int hdrcount</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00145">manager.h:145</a></div></div>
<div class="ttc" id="md5_8h_html"><div class="ttname"><a href="../../da/db0/md5_8h.html">md5.h</a></div><div class="ttdoc">MD5 digest functions. </div></div>
<div class="ttc" id="json_8h_html_ad20fdcbab1ed5c078284a687cced2877"><div class="ttname"><a href="../../d4/d05/json_8h.html#ad20fdcbab1ed5c078284a687cced2877">ast_json_integer_get</a></div><div class="ttdeci">intmax_t ast_json_integer_get(const struct ast_json *integer)</div><div class="ttdoc">Get the value from a JSON integer. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00322">json.c:322</a></div></div>
<div class="ttc" id="manager_8c_html_a3e1c1c66b6011486996f6ef543bd5313"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a3e1c1c66b6011486996f6ef543bd5313">xml_copy_escape</a></div><div class="ttdeci">static void xml_copy_escape(struct ast_str **out, const char *src, int mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07638">manager.c:7638</a></div></div>
<div class="ttc" id="manager_8c_html_acfd58ce0ec836919236d7a1908494970"><div class="ttname"><a href="../../d4/d10/manager_8c.html#acfd58ce0ec836919236d7a1908494970">FORMAT2</a></div><div class="ttdeci">#define FORMAT2</div></div>
<div class="ttc" id="linkedlists_8h_html_a2aaf5b16690bc48355b4c0cd50bdefff"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a2aaf5b16690bc48355b4c0cd50bdefff">AST_RWLIST_LAST</a></div><div class="ttdeci">#define AST_RWLIST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00430">linkedlists.h:430</a></div></div>
<div class="ttc" id="manager_8c_html_a8324da768fd6a93e133b2033d752a830"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a8324da768fd6a93e133b2033d752a830">manager_set_defaults</a></div><div class="ttdeci">static void manager_set_defaults(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09116">manager.c:9116</a></div></div>
<div class="ttc" id="chan__alsa_8c_html_a98f5e70e98f6dc48e3c5ba316066d540"><div class="ttname"><a href="../../da/d45/chan__alsa_8c.html#a98f5e70e98f6dc48e3c5ba316066d540">format</a></div><div class="ttdeci">static snd_pcm_format_t format</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d45/chan__alsa_8c_source.html#l00102">chan_alsa.c:102</a></div></div>
<div class="ttc" id="channel_8h_html_a9704ae96ab849e9e5a20040c13d29705"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a9704ae96ab849e9e5a20040c13d29705">ast_active_channels</a></div><div class="ttdeci">int ast_active_channels(void)</div><div class="ttdoc">returns number of active/allocated channels </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00499">channel.c:499</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac71fa21ee14d825bf98e4a658604c492"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac71fa21ee14d825bf98e4a658604c492">handle_mandebug</a></div><div class="ttdeci">static char * handle_mandebug(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02472">manager.c:2472</a></div></div>
<div class="ttc" id="structast__aoc__unit__entry_html_a3aaa7811b1b3c09c7945b9e090220ea1"><div class="ttname"><a href="../../df/d18/structast__aoc__unit__entry.html#a3aaa7811b1b3c09c7945b9e090220ea1">ast_aoc_unit_entry::amount</a></div><div class="ttdeci">unsigned int amount</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00180">aoc.h:180</a></div></div>
<div class="ttc" id="structast__assigned__ids_html_ad386d957fb41c92b9e929fbd2ac7a48c"><div class="ttname"><a href="../../da/de5/structast__assigned__ids.html#ad386d957fb41c92b9e929fbd2ac7a48c">ast_assigned_ids::uniqueid2</a></div><div class="ttdeci">const char * uniqueid2</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00607">channel.h:607</a></div></div>
<div class="ttc" id="http_8h_html_ab0286838ed2b93e0d77fe9d7af8a37b5"><div class="ttname"><a href="../../dd/d56/http_8h.html#ab0286838ed2b93e0d77fe9d7af8a37b5">ast_http_request_close_on_completion</a></div><div class="ttdeci">void ast_http_request_close_on_completion(struct ast_tcptls_session_instance *ser)</div><div class="ttdoc">Request the HTTP connection be closed after this HTTP request. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/http_8c_source.html#l00836">http.c:836</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga3e8f2893c887ee3b8acd8ecd151135b0"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga3e8f2893c887ee3b8acd8ecd151135b0">mansession_cmp_fn</a></div><div class="ttdeci">static int mansession_cmp_fn(void *obj, void *arg, int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02262">manager.c:2262</a></div></div>
<div class="ttc" id="json_8h_html_a34a0e726391c4b59c534b107a3ee3310"><div class="ttname"><a href="../../d4/d05/json_8h.html#a34a0e726391c4b59c534b107a3ee3310">ast_json_array_get</a></div><div class="ttdeci">struct ast_json * ast_json_array_get(const struct ast_json *array, size_t index)</div><div class="ttdoc">Get an element from an array. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00360">json.c:360</a></div></div>
<div class="ttc" id="bridges_8c_html_ab1760b9a6a6c8d063d49ab9b5bcdfa49"><div class="ttname"><a href="../../d8/d3a/bridges_8c.html#ab1760b9a6a6c8d063d49ab9b5bcdfa49">provider</a></div><div class="ttdeci">static struct prometheus_metrics_provider provider</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d3a/bridges_8c_source.html#l00178">bridges.c:178</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a80cd3f6f786b59b742bcecfc0b3be7c2"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a80cd3f6f786b59b742bcecfc0b3be7c2">AST_DECLARE_APP_ARGS</a></div><div class="ttdeci">#define AST_DECLARE_APP_ARGS(name, arglist)</div><div class="ttdoc">Declare a structure to hold an application&amp;#39;s arguments. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01249">include/asterisk/app.h:1249</a></div></div>
<div class="ttc" id="stringfields_8h_html_abf60f862ae6a141d2f86a0f5e82792de"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#abf60f862ae6a141d2f86a0f5e82792de">ast_string_field_free_memory</a></div><div class="ttdeci">#define ast_string_field_free_memory(x)</div><div class="ttdoc">free all memory - to be called before destroying the object </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00368">stringfields.h:368</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html">app.h</a></div><div class="ttdoc">Application convenience functions, designed to give consistent look and feel to Asterisk apps...</div></div>
<div class="ttc" id="manager_8c_html_a621c10d8f8ac1fb6695eb47e3a5c9504"><div class="ttname"><a href="../../d4/d10/manager_8c.html#a621c10d8f8ac1fb6695eb47e3a5c9504">manager_event_blob_dtor</a></div><div class="ttdeci">static void manager_event_blob_dtor(void *obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09718">manager.c:9718</a></div></div>
<div class="ttc" id="manager_8h_html_a2571c636aafd979f5719051090e5bbff"><div class="ttname"><a href="../../db/d45/manager_8h.html#a2571c636aafd979f5719051090e5bbff">manager_mwi_init</a></div><div class="ttdeci">int manager_mwi_init(void)</div><div class="ttdoc">Initialize support for AMI MWI events. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d00/manager__mwi_8c_source.html#l00153">manager_mwi.c:153</a></div></div>
<div class="ttc" id="manager_8c_html_adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d"><div class="ttname"><a href="../../d4/d10/manager_8c.html#adab978eb5c8aa199396471558598dc53af00001b2cc69d0721dd70ab3b7d7020d">FORMAT_XML</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07465">manager.c:7465</a></div></div>
<div class="ttc" id="channel_8h_html_a7c3d40097bb8c0da518564d38ab49506"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#a7c3d40097bb8c0da518564d38ab49506">ast_channel_softhangup_withcause_locked</a></div><div class="ttdeci">void ast_channel_softhangup_withcause_locked(struct ast_channel *chan, int causecode)</div><div class="ttdoc">Lock the given channel, then request softhangup on the channel with the given causecode. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d28/channel_8c_source.html#l00468">channel.c:468</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a5cb297844656a440d8ba8553f81e6d4b"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a5cb297844656a440d8ba8553f81e6d4b">ast_variables_dup</a></div><div class="ttdeci">struct ast_variable * ast_variables_dup(struct ast_variable *var)</div><div class="ttdoc">Duplicate variable list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l00545">main/config.c:545</a></div></div>
<div class="ttc" id="structast__party__number_html_aaa04218f9e3a9065afa8be2491da8904"><div class="ttname"><a href="../../d6/dbb/structast__party__number.html#aaa04218f9e3a9065afa8be2491da8904">ast_party_number::valid</a></div><div class="ttdeci">unsigned char valid</div><div class="ttdoc">TRUE if the number information is valid/present. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00298">channel.h:298</a></div></div>
<div class="ttc" id="astobj2_8h_html_ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#ad9d009e87e737af900825b36db55a35ca614744a4d36b3189d4ab5b02c8645d47">OBJ_MULTIPLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01053">astobj2.h:1053</a></div></div>
<div class="ttc" id="structmansession__session_html_a68a26c888924e997c3ce5fdb6273bf7f"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a68a26c888924e997c3ce5fdb6273bf7f">mansession_session::needdestroy</a></div><div class="ttdeci">int needdestroy</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01586">manager.c:1586</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga97662516a5cd49e552cf9d2e30987aac"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga97662516a5cd49e552cf9d2e30987aac">action_redirect</a></div><div class="ttdeci">static int action_redirect(struct mansession *s, const struct message *m)</div><div class="ttdoc">action_redirect: The redirect manager command </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04973">manager.c:4973</a></div></div>
<div class="ttc" id="channel_8h_html_af5dee96d4dcc88a95fce391c22d4d21f"><div class="ttname"><a href="../../d5/d7b/channel_8h.html#af5dee96d4dcc88a95fce391c22d4d21f">ast_channel_tech</a></div><div class="ttdeci">const struct ast_channel_tech * ast_channel_tech(const struct ast_channel *chan)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/de2/channel__internal__api_8c_source.html#l00769">channel_internal_api.c:769</a></div></div>
<div class="ttc" id="astobj2_8h_html_a91d5d37d00874ae7a92d1a15c0a3b3a6"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a91d5d37d00874ae7a92d1a15c0a3b3a6">ao2_iterator_init</a></div><div class="ttdeci">struct ao2_iterator ao2_iterator_init(struct ao2_container *c, int flags) attribute_warn_unused_result</div><div class="ttdoc">Create an iterator for a container. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/astobj2__container_8c_source.html#l00485">astobj2_container.c:485</a></div></div>
<div class="ttc" id="structmansession__session_html_a69130d68427d2c01991cac28b2f20ac3"><div class="ttname"><a href="../../df/d05/structmansession__session.html#a69130d68427d2c01991cac28b2f20ac3">mansession_session::oldnonce</a></div><div class="ttdeci">unsigned long oldnonce</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01608">manager.c:1608</a></div></div>
<div class="ttc" id="cli_8h_html_ae88634c402fdd8b46fd5d686dad8bfb9"><div class="ttname"><a href="../../dc/db0/cli_8h.html#ae88634c402fdd8b46fd5d686dad8bfb9">AST_MAX_CMD_LEN</a></div><div class="ttdeci">#define AST_MAX_CMD_LEN</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/db0/cli_8h_source.html#l00048">cli.h:48</a></div></div>
<div class="ttc" id="structast__tls__config_html_a3d12e13733aa5172b5cb091fbf8ea478"><div class="ttname"><a href="../../d5/d90/structast__tls__config.html#a3d12e13733aa5172b5cb091fbf8ea478">ast_tls_config::cipher</a></div><div class="ttdeci">char * cipher</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00091">tcptls.h:91</a></div></div>
<div class="ttc" id="structast__http__uri_html_a735984d41155bc1032e09bece8f8d66d"><div class="ttname"><a href="../../d0/d6c/structast__http__uri.html#a735984d41155bc1032e09bece8f8d66d">ast_http_uri::data</a></div><div class="ttdeci">void * data</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d56/http_8h_source.html#l00114">http.h:114</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga28572e9c3a5f7c565f68eae095454d3c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga28572e9c3a5f7c565f68eae095454d3c">action_listcategories</a></div><div class="ttdeci">static int action_listcategories(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03682">manager.c:3682</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a6bf0e81cb6ef01532ddebaba68f6de28"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a6bf0e81cb6ef01532ddebaba68f6de28">AST_RWLIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_RWLIST_TRAVERSE_SAFE_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00616">linkedlists.h:616</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_a27d0c312ea7e7e429f26e8e88155da1e"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#a27d0c312ea7e7e429f26e8e88155da1e">AST_SECURITY_EVENT_SESSION_LIMIT_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_SESSION_LIMIT_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00245">security_events_defs.h:245</a></div></div>
<div class="ttc" id="structmanager__action_html_ac07925c5773daffa1e00486fbb9ef495"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#ac07925c5773daffa1e00486fbb9ef495">manager_action::seealso</a></div><div class="ttdeci">const ast_string_field seealso</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00158">manager.h:158</a></div></div>
<div class="ttc" id="manager_8c_html_acbf2cba285ffaf8ad7040ee38da09c54"><div class="ttname"><a href="../../d4/d10/manager_8c.html#acbf2cba285ffaf8ad7040ee38da09c54">rawmanuri</a></div><div class="ttdeci">static struct ast_http_uri rawmanuri</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08475">manager.c:8475</a></div></div>
<div class="ttc" id="structast__security__event__req__not__allowed_html"><div class="ttname"><a href="../../d0/dc7/structast__security__event__req__not__allowed.html">ast_security_event_req_not_allowed</a></div><div class="ttdoc">Request denied because it&amp;#39;s not allowed. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00309">security_events_defs.h:309</a></div></div>
<div class="ttc" id="structmanager__action_html_ac72ddaf7b92092136fc38629a809c87a"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html#ac72ddaf7b92092136fc38629a809c87a">manager_action::syntax</a></div><div class="ttdeci">const ast_string_field syntax</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00158">manager.h:158</a></div></div>
<div class="ttc" id="structast__security__event__req__not__allowed_html_afd6258b84dc45cf613b1896565860f70"><div class="ttname"><a href="../../d0/dc7/structast__security__event__req__not__allowed.html#afd6258b84dc45cf613b1896565860f70">ast_security_event_req_not_allowed::request_type</a></div><div class="ttdeci">const char * request_type</div><div class="ttdoc">Request type that was made. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00324">security_events_defs.h:324</a></div></div>
<div class="ttc" id="presencestate_8h_html_ac3452f41c7982c84ca27ecf7b4cc7ce1a5b541c7f37468daf2ee6cfe488949adb"><div class="ttname"><a href="../../d6/dd7/presencestate_8h.html#ac3452f41c7982c84ca27ecf7b4cc7ce1a5b541c7f37468daf2ee6cfe488949adb">AST_PRESENCE_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd7/presencestate_8h_source.html#l00039">presencestate.h:39</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html_ad9060ce736c45736fb6255a07d555831"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html#ad9060ce736c45736fb6255a07d555831">ast_xml_doc_item::seealso</a></div><div class="ttdeci">struct ast_str * seealso</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00060">xmldoc.h:60</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga8d9eefd35c6b7be4f64a4b4dc9d92fd8"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga8d9eefd35c6b7be4f64a4b4dc9d92fd8">add_filter_result</a></div><div class="ttdeci">add_filter_result</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01434">manager.c:1434</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a1ac00507f4e5ae91c46f613e5cadae04"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a1ac00507f4e5ae91c46f613e5cadae04">ast_category_get_name</a></div><div class="ttdeci">const char * ast_category_get_name(const struct ast_category *category)</div><div class="ttdoc">Return the name of the category. </div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9d/main_2config_8c_source.html#l01028">main/config.c:1028</a></div></div>
<div class="ttc" id="structast__mutex__info_html"><div class="ttname"><a href="../../d8/dc5/structast__mutex__info.html">ast_mutex_info</a></div><div class="ttdoc">Structure for mutex and tracking information. </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00135">lock.h:135</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga26ac9d8e0f9483bd06741753ebcfe6d6"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga26ac9d8e0f9483bd06741753ebcfe6d6">handle_showmanconn</a></div><div class="ttdeci">static char * handle_showmanconn(struct ast_cli_entry *e, int cmd, struct ast_cli_args *a)</div><div class="ttdoc">CLI command manager list connected. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l02655">manager.c:2655</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa010c027e6c7d2c2082482526a2eed06"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa010c027e6c7d2c2082482526a2eed06">queue_sendtext_data</a></div><div class="ttdeci">static int queue_sendtext_data(struct ast_channel *chan, const char *body, const char *content_type)</div><div class="ttdoc">Queue a read action to send a text data message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04911">manager.c:4911</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gae3ee6e147a9a6e5ee1cd6bd91a194c07"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gae3ee6e147a9a6e5ee1cd6bd91a194c07">report_req_bad_format</a></div><div class="ttdeci">static void report_req_bad_format(const struct mansession *s, const char *action)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03414">manager.c:3414</a></div></div>
<div class="ttc" id="manager_8c_html_adc05403d9e5f69a12e0d473f88cc3618"><div class="ttname"><a href="../../d4/d10/manager_8c.html#adc05403d9e5f69a12e0d473f88cc3618">auth_http_callback</a></div><div class="ttdeci">static int auth_http_callback(struct ast_tcptls_session_instance *ser, enum ast_http_method method, enum output_format format, const struct ast_sockaddr *remote_address, const char *uri, struct ast_variable *get_params, struct ast_variable *headers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l08119">manager.c:8119</a></div></div>
<div class="ttc" id="manager_8c_html_ac8bebf364f7d11e1affc6c15dc7fd895"><div class="ttname"><a href="../../d4/d10/manager_8c.html#ac8bebf364f7d11e1affc6c15dc7fd895">variable_count_hash_fn</a></div><div class="ttdeci">static int variable_count_hash_fn(const void *vvc, const int flags)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07700">manager.c:7700</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gaa98613bbc66bdf99b8423afcfc4f9b2c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gaa98613bbc66bdf99b8423afcfc4f9b2c">purge_sessions</a></div><div class="ttdeci">static void purge_sessions(int n_max)</div><div class="ttdoc">remove at most n_max stale session from the list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l07031">manager.c:7031</a></div></div>
<div class="ttc" id="presencestate_8h_html_aec78c2b072d51416200d34bdd06827a7"><div class="ttname"><a href="../../d6/dd7/presencestate_8h.html#aec78c2b072d51416200d34bdd06827a7">ast_presence_state2str</a></div><div class="ttdeci">const char * ast_presence_state2str(enum ast_presence_state state)</div><div class="ttdoc">Convert presence state to text string for output. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d07/presencestate_8c_source.html#l00103">presencestate.c:103</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9800654edab91105eb77e4ae88417387"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9800654edab91105eb77e4ae88417387">action_presencestate</a></div><div class="ttdeci">static int action_presencestate(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l06004">manager.c:6004</a></div></div>
<div class="ttc" id="app__jack_8c_html_ac191e5810fa65e63095409471eb5648f"><div class="ttname"><a href="../../de/dcd/app__jack_8c.html#ac191e5810fa65e63095409471eb5648f">status</a></div><div class="ttdeci">jack_status_t status</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dcd/app__jack_8c_source.html#l00146">app_jack.c:146</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga546caee8e3d040d0074bc32e96d53b7d"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga546caee8e3d040d0074bc32e96d53b7d">ast_manager_publish_event</a></div><div class="ttdeci">void ast_manager_publish_event(const char *type, int class_type, struct ast_json *obj)</div><div class="ttdoc">Publish an event to AMI. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01903">manager.c:1903</a></div></div>
<div class="ttc" id="term_8h_html_a8deb0beccea721b35bdb1b4f7264fe75"><div class="ttname"><a href="../../db/d45/term_8h.html#a8deb0beccea721b35bdb1b4f7264fe75">COLOR_MAGENTA</a></div><div class="ttdeci">#define COLOR_MAGENTA</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/term_8h_source.html#l00057">term.h:57</a></div></div>
<div class="ttc" id="aoc_8h_html_aa7dc1e0987972e9eb92627a1190eb548a463d1c225066e20d4cc56abee5a5b239"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#aa7dc1e0987972e9eb92627a1190eb548a463d1c225066e20d4cc56abee5a5b239">AST_AOC_D</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/db3/aoc_8h_source.html#l00065">aoc.h:65</a></div></div>
<div class="ttc" id="security__events__defs_8h_html_a6d839ed02640b1090706c4492f81a796"><div class="ttname"><a href="../../d7/dc2/security__events__defs_8h.html#a6d839ed02640b1090706c4492f81a796">AST_SECURITY_EVENT_REQ_NOT_ALLOWED_VERSION</a></div><div class="ttdeci">#define AST_SECURITY_EVENT_REQ_NOT_ALLOWED_VERSION</div><div class="ttdoc">Event descriptor version. </div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc2/security__events__defs_8h_source.html#l00314">security_events_defs.h:314</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga7c6ac25ea7536c0bc9ed18cbcf917527"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga7c6ac25ea7536c0bc9ed18cbcf917527">reload_module</a></div><div class="ttdeci">static int reload_module(void)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l09661">manager.c:9661</a></div></div>
<div class="ttc" id="format__cache_8h_html"><div class="ttname"><a href="../../db/d1c/format__cache_8h.html">format_cache.h</a></div><div class="ttdoc">Media Format Cache API. </div></div>
<div class="ttc" id="strings_8h_html_a9c34c6c6b8daaba24c0406270f3cf697"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a9c34c6c6b8daaba24c0406270f3cf697">ast_str_create</a></div><div class="ttdeci">#define ast_str_create(init_len)</div><div class="ttdoc">Create a malloc&amp;#39;ed dynamic length string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l00620">strings.h:620</a></div></div>
<div class="ttc" id="structast__xml__doc__item_html_afd4fa183745fe419aadcb64ff25df76f"><div class="ttname"><a href="../../d8/d46/structast__xml__doc__item.html#afd4fa183745fe419aadcb64ff25df76f">ast_xml_doc_item::synopsis</a></div><div class="ttdeci">struct ast_str * synopsis</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d99/xmldoc_8h_source.html#l00064">xmldoc.h:64</a></div></div>
<div class="ttc" id="lock_8h_html_a873f9ce8c6287a32d48c83133e124418"><div class="ttname"><a href="../../dd/d42/lock_8h.html#a873f9ce8c6287a32d48c83133e124418">ast_mutex_unlock</a></div><div class="ttdeci">#define ast_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d42/lock_8h_source.html#l00188">lock.h:188</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga9ade0e7490b00414a5d773bc5ceff73e"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga9ade0e7490b00414a5d773bc5ceff73e">manager_channelvars</a></div><div class="ttdeci">static char * manager_channelvars</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l01481">manager.c:1481</a></div></div>
<div class="ttc" id="json_8h_html_a9b4db2feb727c1b4f28347c31b4d79b7"><div class="ttname"><a href="../../d4/d05/json_8h.html#a9b4db2feb727c1b4f28347c31b4d79b7">ast_json_object_iter_next</a></div><div class="ttdeci">struct ast_json_iter * ast_json_object_iter_next(struct ast_json *object, struct ast_json_iter *iter)</div><div class="ttdoc">Get the next iterator. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d98/json_8c_source.html#l00437">json.c:437</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0063f7b7d4976f533e64e98503e535aa"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0063f7b7d4976f533e64e98503e535aa">action_setvar</a></div><div class="ttdeci">static int action_setvar(struct mansession *s, const struct message *m)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l04577">manager.c:4577</a></div></div>
<div class="ttc" id="bridge_8h_html_aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da"><div class="ttname"><a href="../../d4/d56/bridge_8h.html#aadbf879fadde4b1bb7832b1390cc8c17a10037a900428dbddb31e85e4481bb4da">AST_BRIDGE_TRANSFER_NOT_PERMITTED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d56/bridge_8h_source.html#l01119">bridge.h:1119</a></div></div>
<div class="ttc" id="include_2asterisk_2app_8h_html_a037e9a5b28477b17e7c9acbe7ecb21d5"><div class="ttname"><a href="../../d3/d93/include_2asterisk_2app_8h.html#a037e9a5b28477b17e7c9acbe7ecb21d5">AST_APP_ARG</a></div><div class="ttdeci">#define AST_APP_ARG(name)</div><div class="ttdoc">Define an application argument. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/include_2asterisk_2app_8h_source.html#l01232">include/asterisk/app.h:1232</a></div></div>
<div class="ttc" id="strings_8h_html_a33ab7fa091d5513d8507d3bd33ef5b55"><div class="ttname"><a href="../../d6/d90/strings_8h.html#a33ab7fa091d5513d8507d3bd33ef5b55">ast_str_hash</a></div><div class="ttdeci">static force_inline int attribute_pure ast_str_hash(const char *str)</div><div class="ttdoc">Compute a hash value on a string. </div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d90/strings_8h_source.html#l01206">strings.h:1206</a></div></div>
<div class="ttc" id="structast__tcptls__session__instance_html_a9dfcf41ffc851689eea95be7bb1f849a"><div class="ttname"><a href="../../d6/d49/structast__tcptls__session__instance.html#a9dfcf41ffc851689eea95be7bb1f849a">ast_tcptls_session_instance::remote_address</a></div><div class="ttdeci">struct ast_sockaddr remote_address</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00151">tcptls.h:151</a></div></div>
<div class="ttc" id="group__Group__AMI_html_gac9d1d485a1911880e31a3537223b3f9c"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#gac9d1d485a1911880e31a3537223b3f9c">astman_send_list_complete</a></div><div class="ttdeci">static void astman_send_list_complete(struct mansession *s, const struct message *m, const char *event_name, int count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03228">manager.c:3228</a></div></div>
<div class="ttc" id="manager_8h_html_ab85694f6b643f767a2d61c37c2b87753"><div class="ttname"><a href="../../db/d45/manager_8h.html#ab85694f6b643f767a2d61c37c2b87753">EVENT_FLAG_MESSAGE</a></div><div class="ttdeci">#define EVENT_FLAG_MESSAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00091">manager.h:91</a></div></div>
<div class="ttc" id="callerid_8h_html_a39e03ca4e8df3a1d2c75e888d76201df"><div class="ttname"><a href="../../de/d47/callerid_8h.html#a39e03ca4e8df3a1d2c75e888d76201df">ast_callerid_parse</a></div><div class="ttdeci">int ast_callerid_parse(char *instr, char **name, char **location)</div><div class="ttdoc">Destructively parse inbuf into name and location (or number) </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd5/callerid_8c_source.html#l01008">callerid.c:1008</a></div></div>
<div class="ttc" id="stringfields_8h_html_a653461abd6e0d16e4e3326ab90e0501d"><div class="ttname"><a href="../../d1/d0f/stringfields_8h.html#a653461abd6e0d16e4e3326ab90e0501d">ast_string_field_set</a></div><div class="ttdeci">#define ast_string_field_set(x, field, data)</div><div class="ttdoc">Set a field to a simple string value. </div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d0f/stringfields_8h_source.html#l00514">stringfields.h:514</a></div></div>
<div class="ttc" id="aoc_8h_html_a84cc9357bb1acbc2b24d7e80780e3b9d"><div class="ttname"><a href="../../d6/db3/aoc_8h.html#a84cc9357bb1acbc2b24d7e80780e3b9d">ast_aoc_set_currency_info</a></div><div class="ttdeci">int ast_aoc_set_currency_info(struct ast_aoc_decoded *decoded, const unsigned int amount, const enum ast_aoc_currency_multiplier multiplier, const char *name)</div><div class="ttdoc">Sets the currency values for a AOC-D or AOC-E message. </div><div class="ttdef"><b>Definition:</b> <a href="../../d0/da6/aoc_8c_source.html#l00919">aoc.c:919</a></div></div>
<div class="ttc" id="structast__tm_html"><div class="ttname"><a href="../../d5/d84/structast__tm.html">ast_tm</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/deb/localtime_8h_source.html#l00035">localtime.h:35</a></div></div>
<div class="ttc" id="include_2asterisk_2config_8h_html_a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037"><div class="ttname"><a href="../../d3/de6/include_2asterisk_2config_8h.html#a103e76ed4bd42f776f7f260080b98b3fafa887389dc380bbdcffb65fec379f037">CONFIG_FLAG_FILEUNCHANGED</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de6/include_2asterisk_2config_8h_source.html#l00043">include/asterisk/config.h:43</a></div></div>
<div class="ttc" id="group__Group__AMI_html_ga0ee6ee1f4d200f711e2983bffe770a72"><div class="ttname"><a href="../../df/d72/group__Group__AMI.html#ga0ee6ee1f4d200f711e2983bffe770a72">astman_send_listack</a></div><div class="ttdeci">void astman_send_listack(struct mansession *s, const struct message *m, char *msg, char *listflag)</div><div class="ttdoc">Send ack in manager transaction to begin a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d10/manager_8c_source.html#l03201">manager.c:3201</a></div></div>
<div class="ttc" id="test__linkedlists_8c_html_a13dd15487fee89a002d17ef3aff62d02"><div class="ttname"><a href="../../d7/d6f/test__linkedlists_8c.html#a13dd15487fee89a002d17ef3aff62d02">a</a></div><div class="ttdeci">static struct test_val a</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d6f/test__linkedlists_8c_source.html#l00046">test_linkedlists.c:46</a></div></div>
<div class="ttc" id="structast__party__id_html_aca2d7de6c89f201dc8bd0a2642d2a352"><div class="ttname"><a href="../../d1/dcb/structast__party__id.html#aca2d7de6c89f201dc8bd0a2642d2a352">ast_party_id::number</a></div><div class="ttdeci">struct ast_party_number number</div><div class="ttdoc">Subscriber phone number. </div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7b/channel_8h_source.html#l00343">channel.h:343</a></div></div>
<div class="ttc" id="structmanager__action_html"><div class="ttname"><a href="../../d2/dcc/structmanager__action.html">manager_action</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d45/manager_8h_source.html#l00149">manager.h:149</a></div></div>
<div class="ttc" id="astobj2_8h_html_a1ad9f122bcae95a470639402faa3d2ee"><div class="ttname"><a href="../../d5/da5/astobj2_8h.html#a1ad9f122bcae95a470639402faa3d2ee">ao2_link</a></div><div class="ttdeci">#define ao2_link(container, obj)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da5/astobj2_8h_source.html#l01549">astobj2.h:1549</a></div></div>
<div class="ttc" id="structast__tls__config_html_a03e6cca0c879c0443efb431c30c14f76"><div class="ttname"><a href="../../d5/d90/structast__tls__config.html#a03e6cca0c879c0443efb431c30c14f76">ast_tls_config::enabled</a></div><div class="ttdeci">int enabled</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/ddf/tcptls_8h_source.html#l00088">tcptls.h:88</a></div></div>
<div class="ttc" id="f2c_8h_html_affe776513b24d84b39af8ab0930fef7f"><div class="ttname"><a href="../../dc/dc2/f2c_8h.html#affe776513b24d84b39af8ab0930fef7f">max</a></div><div class="ttdeci">#define max(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc2/f2c_8h_source.html#l00198">f2c.h:198</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:43:52 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
