<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Asterisk - The Open Source Telephony Project: dns_naptr.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Asterisk - The Open Source Telephony Project
   &#160;<span id="projectnumber">18.5.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c982d53a68cdbcd421152b4020263a9.html">main</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">dns_naptr.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>DNS NAPTR Record Support.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../db/db2/asterisk_8h_source.html">asterisk.h</a>&quot;</code><br />
<code>#include &lt;arpa/nameser.h&gt;</code><br />
<code>#include &lt;netinet/in.h&gt;</code><br />
<code>#include &lt;resolv.h&gt;</code><br />
<code>#include &lt;regex.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d51/dns__core_8h_source.html">asterisk/dns_core.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/db6/dns__naptr_8h_source.html">asterisk/dns_naptr.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d90/linkedlists_8h_source.html">asterisk/linkedlists.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d07/dns__internal_8h_source.html">asterisk/dns_internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d60/utils_8h_source.html">asterisk/utils.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for dns_naptr.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/ddf/dns__naptr_8c__incl.png" border="0" usemap="#dns__naptr_8c" alt=""/></div>
<map name="dns__naptr_8c" id="dns__naptr_8c">
<area shape="rect" id="node2" href="../../db/db2/asterisk_8h.html" title="Asterisk main include file. File version handling, generic pbx functions. " alt="" coords="646,244,730,271"/>
<area shape="rect" id="node26" href="../../d6/d51/dns__core_8h.html" title="Core DNS API. " alt="" coords="1240,80,1386,107"/>
<area shape="rect" id="node30" href="../../db/db6/dns__naptr_8h.html" title="DNS NAPTR Record Parsing API. " alt="" coords="2467,80,2618,107"/>
<area shape="rect" id="node31" href="../../df/d90/linkedlists_8h.html" title="A set of macros to manage forward&#45;linked lists. " alt="" coords="2311,162,2462,189"/>
<area shape="rect" id="node39" href="../../d4/d07/dns__internal_8h.html" title="Internal DNS structure definitions. " alt="" coords="1888,80,2055,107"/>
<area shape="rect" id="node42" href="../../d5/d60/utils_8h.html" title="Utility functions. " alt="" coords="1665,80,1780,107"/>
<area shape="rect" id="node3" href="../../d8/d20/autoconfig_8h.html" title="asterisk/autoconfig.h" alt="" coords="730,468,885,495"/>
<area shape="rect" id="node5" href="../../de/da3/include_2asterisk_2compat_8h.html" title="General Definitions for Asterisk top level program Included by asterisk.h to handle platform&#45;specific..." alt="" coords="538,319,675,345"/>
<area shape="rect" id="node21" href="../../d8/d8a/astmm_8h.html" title="Asterisk memory management routines. " alt="" coords="699,319,834,345"/>
<area shape="rect" id="node4" href="../../dc/dba/buildopts_8h.html" title="asterisk/buildopts.h" alt="" coords="734,543,881,569"/>
<area shape="rect" id="node6" href="../../d4/dd1/compiler_8h.html" title="Compiler&#45;specific macros and other items. " alt="" coords="1406,393,1548,420"/>
<area shape="rect" id="node27" href="../../db/df1/netsock2_8h.html" title="Network socket handling. " alt="" coords="969,162,1116,189"/>
<area shape="rect" id="node29" href="../../d1/d8c/logger_8h.html" title="Support for logging to various files, console and syslog Configuration in file logger.conf. " alt="" coords="1600,393,1727,420"/>
<area shape="rect" id="node32" href="../../dd/d42/lock_8h.html" title="Asterisk locking&#45;related definitions: " alt="" coords="2004,319,2118,345"/>
<area shape="rect" id="node34" href="../../de/df7/time_8h.html" title="Time&#45;related functions and macros. " alt="" coords="1803,393,1866,420"/>
<area shape="rect" id="node35" href="../../d5/d9d/inline__api_8h.html" title="Inlinable API function macro. " alt="" coords="1830,468,1977,495"/>
<area shape="rect" id="node38" href="../../d3/dda/backtrace_8h.html" title="Asterisk backtrace generation. " alt="" coords="1942,393,2092,420"/>
<area shape="rect" id="node40" href="../../d6/d68/vector_8h.html" title="Vector container support. " alt="" coords="1942,244,2068,271"/>
<area shape="rect" id="node41" href="../../d7/d38/dns__query__set_8h.html" title="DNS Query Set API. " alt="" coords="2144,155,2287,196"/>
<area shape="rect" id="node43" href="../../d9/d94/network_8h.html" title="Wrapper for network related headers, masking differences between various operating systems..." alt="" coords="1350,162,1489,189"/>
<area shape="rect" id="node48" href="../../d5/deb/localtime_8h.html" title="Custom localtime functions for multiple timezones. " alt="" coords="1538,162,1685,189"/>
<area shape="rect" id="node49" href="../../d1/d0f/stringfields_8h.html" title="asterisk/stringfields.h" alt="" coords="1861,162,2018,189"/>
<area shape="rect" id="node50" href="../../d6/d90/strings_8h.html" title="String manipulation functions. " alt="" coords="1196,162,1326,189"/>
</map>
</div>
</div>
<p><a href="../../d3/de7/dns__naptr_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3f25bf14345796cc59bc63bbdfe09642"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a3f25bf14345796cc59bc63bbdfe09642">PAST_END_OF_RECORD</a>&#160;&#160;&#160;ptr &gt;= end_of_record</td></tr>
<tr class="separator:a3f25bf14345796cc59bc63bbdfe09642"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aed9b1a7b999cab0deaddd6ca8704685e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685e">flags_result</a> { <a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74">FLAGS_TERMINAL</a>, 
<a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450">FLAGS_EMPTY</a>, 
<a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c">FLAGS_UNKNOWN</a>, 
<a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>
 }<tr class="memdesc:aed9b1a7b999cab0deaddd6ca8704685e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result of analyzing NAPTR flags on a record.  <a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685e">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:aed9b1a7b999cab0deaddd6ca8704685e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a076ac63aa8bbba26973e834f68ed1628"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a076ac63aa8bbba26973e834f68ed1628">ast_dns_naptr_get_flags</a> (const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record)</td></tr>
<tr class="memdesc:a076ac63aa8bbba26973e834f68ed1628"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the flags from a NAPTR record.  <a href="#a076ac63aa8bbba26973e834f68ed1628">More...</a><br /></td></tr>
<tr class="separator:a076ac63aa8bbba26973e834f68ed1628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7abb9a5961a4c9774fe5c9151d9e0f7"><td class="memItemLeft" align="right" valign="top">unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#ac7abb9a5961a4c9774fe5c9151d9e0f7">ast_dns_naptr_get_order</a> (const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record)</td></tr>
<tr class="memdesc:ac7abb9a5961a4c9774fe5c9151d9e0f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the order from a NAPTR record.  <a href="#ac7abb9a5961a4c9774fe5c9151d9e0f7">More...</a><br /></td></tr>
<tr class="separator:ac7abb9a5961a4c9774fe5c9151d9e0f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5867b78c6f0764fe3bb834d9c0f08f39"><td class="memItemLeft" align="right" valign="top">unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a5867b78c6f0764fe3bb834d9c0f08f39">ast_dns_naptr_get_preference</a> (const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record)</td></tr>
<tr class="memdesc:a5867b78c6f0764fe3bb834d9c0f08f39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the preference from a NAPTR record.  <a href="#a5867b78c6f0764fe3bb834d9c0f08f39">More...</a><br /></td></tr>
<tr class="separator:a5867b78c6f0764fe3bb834d9c0f08f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a807ef199474c8570059720002911ba73"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a807ef199474c8570059720002911ba73">ast_dns_naptr_get_regexp</a> (const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record)</td></tr>
<tr class="memdesc:a807ef199474c8570059720002911ba73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the regular expression from a NAPTR record.  <a href="#a807ef199474c8570059720002911ba73">More...</a><br /></td></tr>
<tr class="separator:a807ef199474c8570059720002911ba73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91007ae5c71db24bad93aa8c9f257f5"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#ad91007ae5c71db24bad93aa8c9f257f5">ast_dns_naptr_get_replacement</a> (const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record)</td></tr>
<tr class="memdesc:ad91007ae5c71db24bad93aa8c9f257f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the replacement value from a NAPTR record.  <a href="#ad91007ae5c71db24bad93aa8c9f257f5">More...</a><br /></td></tr>
<tr class="separator:ad91007ae5c71db24bad93aa8c9f257f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e1f7162110695c8a2b01a6bd58b9dd1"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a5e1f7162110695c8a2b01a6bd58b9dd1">ast_dns_naptr_get_service</a> (const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *record)</td></tr>
<tr class="memdesc:a5e1f7162110695c8a2b01a6bd58b9dd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the service from a NAPTR record.  <a href="#a5e1f7162110695c8a2b01a6bd58b9dd1">More...</a><br /></td></tr>
<tr class="separator:a5e1f7162110695c8a2b01a6bd58b9dd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed31ff93373c046a4731ca6c7cd585e7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#aed31ff93373c046a4731ca6c7cd585e7">compare_order</a> (const void *record1, const void *record2)</td></tr>
<tr class="separator:aed31ff93373c046a4731ca6c7cd585e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee7bfa19514c205321ad9c0c7908086"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#aeee7bfa19514c205321ad9c0c7908086">compare_preference</a> (const void *record1, const void *record2)</td></tr>
<tr class="separator:aeee7bfa19514c205321ad9c0c7908086"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1507445dcefc7ca59022e2ef4c2433aa"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a1507445dcefc7ca59022e2ef4c2433aa">dns_naptr_alloc</a> (struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *query, const char *data, const size_t size)</td></tr>
<tr class="memdesc:a1507445dcefc7ca59022e2ef4c2433aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and parse a DNS NAPTR record.  <a href="#a1507445dcefc7ca59022e2ef4c2433aa">More...</a><br /></td></tr>
<tr class="separator:a1507445dcefc7ca59022e2ef4c2433aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a089c9ec9c3011b12cefaddd04afd2ec5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a089c9ec9c3011b12cefaddd04afd2ec5">dns_naptr_sort</a> (struct <a class="el" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *<a class="el" href="../../de/d1b/cel__pgsql_8c.html#ad6c487210772a9b4b0ca04b04b847d4c">result</a>)</td></tr>
<tr class="memdesc:a089c9ec9c3011b12cefaddd04afd2ec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sort the NAPTR records on a result.  <a href="#a089c9ec9c3011b12cefaddd04afd2ec5">More...</a><br /></td></tr>
<tr class="separator:a089c9ec9c3011b12cefaddd04afd2ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda3837e17ffc03a649b907e29a029f4"><td class="memItemLeft" align="right" valign="top">static enum <a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685e">flags_result</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#acda3837e17ffc03a649b907e29a029f4">interpret_flags</a> (const char *flags, uint8_t flags_size)</td></tr>
<tr class="memdesc:acda3837e17ffc03a649b907e29a029f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyze and interpret NAPTR flags as per RFC 3404.  <a href="#acda3837e17ffc03a649b907e29a029f4">More...</a><br /></td></tr>
<tr class="separator:acda3837e17ffc03a649b907e29a029f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4259abb6948ada3deaf88deab082d28e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a4259abb6948ada3deaf88deab082d28e">regexp_flags_invalid</a> (const char *flags, const char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>)</td></tr>
<tr class="memdesc:a4259abb6948ada3deaf88deab082d28e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if flags in the regexp are invalid.  <a href="#a4259abb6948ada3deaf88deab082d28e">More...</a><br /></td></tr>
<tr class="separator:a4259abb6948ada3deaf88deab082d28e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6a35fd0de8c566f1fce2c32f08fc97a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#ab6a35fd0de8c566f1fce2c32f08fc97a">regexp_invalid</a> (const char *regexp, uint8_t regexp_size)</td></tr>
<tr class="memdesc:ab6a35fd0de8c566f1fce2c32f08fc97a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the regexp in a NAPTR record is invalid.  <a href="#ab6a35fd0de8c566f1fce2c32f08fc97a">More...</a><br /></td></tr>
<tr class="separator:ab6a35fd0de8c566f1fce2c32f08fc97a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa104b7e0526f37f3074bc7edb069fe02"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#aa104b7e0526f37f3074bc7edb069fe02">regexp_pattern_invalid</a> (const char *pattern, const char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>)</td></tr>
<tr class="memdesc:aa104b7e0526f37f3074bc7edb069fe02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the pattern in a regexp is invalid.  <a href="#aa104b7e0526f37f3074bc7edb069fe02">More...</a><br /></td></tr>
<tr class="separator:aa104b7e0526f37f3074bc7edb069fe02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7449341085ab5a81b1dbdfcab0fce5d2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#a7449341085ab5a81b1dbdfcab0fce5d2">regexp_repl_invalid</a> (const char *repl, const char *<a class="el" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>, char delim)</td></tr>
<tr class="memdesc:a7449341085ab5a81b1dbdfcab0fce5d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the replacement in the regexp is invalid.  <a href="#a7449341085ab5a81b1dbdfcab0fce5d2">More...</a><br /></td></tr>
<tr class="separator:a7449341085ab5a81b1dbdfcab0fce5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa760a6fd5c0c1cb2e77cdf5aa92f7fa"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/de7/dns__naptr_8c.html#aaa760a6fd5c0c1cb2e77cdf5aa92f7fa">services_invalid</a> (const char *services, uint8_t services_size)</td></tr>
<tr class="memdesc:aaa760a6fd5c0c1cb2e77cdf5aa92f7fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyze NAPTR services for validity as defined by RFC 3404.  <a href="#aaa760a6fd5c0c1cb2e77cdf5aa92f7fa">More...</a><br /></td></tr>
<tr class="separator:aaa760a6fd5c0c1cb2e77cdf5aa92f7fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>DNS NAPTR Record Support. </p>
<dl class="section author"><dt>Author</dt><dd>Joshua Colp <a href="#" onclick="location.href='mai'+'lto:'+'jco'+'lp'+'@di'+'gi'+'um.'+'co'+'m'; return false;">jcolp<span style="display: none;">.nosp@m.</span>@dig<span style="display: none;">.nosp@m.</span>ium.c<span style="display: none;">.nosp@m.</span>om</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3f25bf14345796cc59bc63bbdfe09642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f25bf14345796cc59bc63bbdfe09642">&#9670;&nbsp;</a></span>PAST_END_OF_RECORD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PAST_END_OF_RECORD&#160;&#160;&#160;ptr &gt;= end_of_record</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00378">378</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00380">dns_naptr_alloc()</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aed9b1a7b999cab0deaddd6ca8704685e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed9b1a7b999cab0deaddd6ca8704685e">&#9670;&nbsp;</a></span>flags_result</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685e">flags_result</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Result of analyzing NAPTR flags on a record. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74"></a>FLAGS_TERMINAL&#160;</td><td class="fielddoc"><p>Terminal record, meaning the DDDS algorithm can be stopped </p>
</td></tr>
<tr><td class="fieldname"><a id="aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450"></a>FLAGS_EMPTY&#160;</td><td class="fielddoc"><p>No flags provided, likely meaning another NAPTR lookup </p>
</td></tr>
<tr><td class="fieldname"><a id="aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c"></a>FLAGS_UNKNOWN&#160;</td><td class="fielddoc"><p>Unrecognized but valid flags. We cannot conclude what they mean </p>
</td></tr>
<tr><td class="fieldname"><a id="aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e"></a>FLAGS_INVALID&#160;</td><td class="fielddoc"><p>Non-alphanumeric or invalid combination of flags </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00046">46</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                  {<span class="comment"></span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">   /*! Terminal record, meaning the DDDS algorithm can be stopped */</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74">FLAGS_TERMINAL</a>,<span class="comment"></span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">   /*! No flags provided, likely meaning another NAPTR lookup */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450">FLAGS_EMPTY</a>,<span class="comment"></span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">   /*! Unrecognized but valid flags. We cannot conclude what they mean */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c">FLAGS_UNKNOWN</a>,<span class="comment"></span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">   /*! Non-alphanumeric or invalid combination of flags */</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>,</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;};</div><div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00054">dns_naptr.c:54</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74">FLAGS_TERMINAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00048">dns_naptr.c:48</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450">FLAGS_EMPTY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00050">dns_naptr.c:50</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c">FLAGS_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00052">dns_naptr.c:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a076ac63aa8bbba26973e834f68ed1628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a076ac63aa8bbba26973e834f68ed1628">&#9670;&nbsp;</a></span>ast_dns_naptr_get_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_dns_naptr_get_flags </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td>
          <td class="paramname"><em>record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the flags from a NAPTR record. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>The DNS record</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the flags </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00600">600</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, and <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00096">ast_dns_naptr_record::flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l01199">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d4/d43/pjsip__resolver_8c_source.html#l00227">sip_resolve_handle_naptr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;{</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *<a class="code" href="../../dd/d3d/structnaptr.html">naptr</a> = (<span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *) record;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == T_NAPTR);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   <span class="keywordflow">return</span> naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;}</div><div class="ttc" id="structast__dns__naptr__record_html_acce5fc0dd978f67c45fcf195f37e7422"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">ast_dns_naptr_record::flags</a></div><div class="ttdeci">const char * flags</div><div class="ttdoc">The flags from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00096">dns_internal.h:96</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structnaptr_html"><div class="ttname"><a href="../../dd/d3d/structnaptr.html">naptr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00028">enum.h:28</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7abb9a5961a4c9774fe5c9151d9e0f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7abb9a5961a4c9774fe5c9151d9e0f7">&#9670;&nbsp;</a></span>ast_dns_naptr_get_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short ast_dns_naptr_get_order </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td>
          <td class="paramname"><em>record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the order from a NAPTR record. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>The DNS record</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the order </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00632">632</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, and <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00104">ast_dns_naptr_record::order</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l01199">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d4/d43/pjsip__resolver_8c_source.html#l00268">sip_resolve_callback()</a>.</p>
<div class="fragment"><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;{</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *<a class="code" href="../../dd/d3d/structnaptr.html">naptr</a> = (<span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *) record;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == T_NAPTR);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   <span class="keywordflow">return</span> naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a1236fced09ddfa5eb51667d641632420">order</a>;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structnaptr_html"><div class="ttname"><a href="../../dd/d3d/structnaptr.html">naptr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00028">enum.h:28</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a1236fced09ddfa5eb51667d641632420"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a1236fced09ddfa5eb51667d641632420">ast_dns_naptr_record::order</a></div><div class="ttdeci">unsigned short order</div><div class="ttdoc">The order for the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00104">dns_internal.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5867b78c6f0764fe3bb834d9c0f08f39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5867b78c6f0764fe3bb834d9c0f08f39">&#9670;&nbsp;</a></span>ast_dns_naptr_get_preference()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short ast_dns_naptr_get_preference </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td>
          <td class="paramname"><em>record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the preference from a NAPTR record. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>The DNS record</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the preference </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00640">640</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, and <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00106">ast_dns_naptr_record::preference</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l01199">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *<a class="code" href="../../dd/d3d/structnaptr.html">naptr</a> = (<span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *) record;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == T_NAPTR);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <span class="keywordflow">return</span> naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a4855753a7f624d6708dade9e9c4f0080">preference</a>;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a4855753a7f624d6708dade9e9c4f0080"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a4855753a7f624d6708dade9e9c4f0080">ast_dns_naptr_record::preference</a></div><div class="ttdeci">unsigned short preference</div><div class="ttdoc">The preference of the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00106">dns_internal.h:106</a></div></div>
<div class="ttc" id="structnaptr_html"><div class="ttname"><a href="../../dd/d3d/structnaptr.html">naptr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00028">enum.h:28</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a807ef199474c8570059720002911ba73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a807ef199474c8570059720002911ba73">&#9670;&nbsp;</a></span>ast_dns_naptr_get_regexp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_dns_naptr_get_regexp </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td>
          <td class="paramname"><em>record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the regular expression from a NAPTR record. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>The DNS record</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the regular expression </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00616">616</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, and <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00100">ast_dns_naptr_record::regexp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l01199">AST_TEST_DEFINE()</a>.</p>
<div class="fragment"><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *<a class="code" href="../../dd/d3d/structnaptr.html">naptr</a> = (<span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *) record;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == T_NAPTR);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <span class="keywordflow">return</span> naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">regexp</a>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a5c796239be94e0b9cfe95e168e34d1da"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">ast_dns_naptr_record::regexp</a></div><div class="ttdeci">const char * regexp</div><div class="ttdoc">The regular expression from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00100">dns_internal.h:100</a></div></div>
<div class="ttc" id="structnaptr_html"><div class="ttname"><a href="../../dd/d3d/structnaptr.html">naptr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00028">enum.h:28</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad91007ae5c71db24bad93aa8c9f257f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad91007ae5c71db24bad93aa8c9f257f5">&#9670;&nbsp;</a></span>ast_dns_naptr_get_replacement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_dns_naptr_get_replacement </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td>
          <td class="paramname"><em>record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the replacement value from a NAPTR record. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>The DNS record</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the replacement value </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00624">624</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, and <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00102">ast_dns_naptr_record::replacement</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l01199">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d4/d43/pjsip__resolver_8c_source.html#l00227">sip_resolve_handle_naptr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;{</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *<a class="code" href="../../dd/d3d/structnaptr.html">naptr</a> = (<span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *) record;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == T_NAPTR);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="keywordflow">return</span> naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#af13ea6e7567ddf33e5f2dc7fcafde92f">replacement</a>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;}</div><div class="ttc" id="structast__dns__naptr__record_html_af13ea6e7567ddf33e5f2dc7fcafde92f"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#af13ea6e7567ddf33e5f2dc7fcafde92f">ast_dns_naptr_record::replacement</a></div><div class="ttdeci">const char * replacement</div><div class="ttdoc">The replacement from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00102">dns_internal.h:102</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structnaptr_html"><div class="ttname"><a href="../../dd/d3d/structnaptr.html">naptr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00028">enum.h:28</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e1f7162110695c8a2b01a6bd58b9dd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e1f7162110695c8a2b01a6bd58b9dd1">&#9670;&nbsp;</a></span>ast_dns_naptr_get_service()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* ast_dns_naptr_get_service </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *&#160;</td>
          <td class="paramname"><em>record</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the service from a NAPTR record. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">record</td><td>The DNS record</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the service </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00608">608</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00145">ast_dns_record_get_rr_type()</a>, and <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00098">ast_dns_naptr_record::service</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d5c/res__resolver__unbound_8c_source.html#l01199">AST_TEST_DEFINE()</a>, and <a class="el" href="../../d4/d43/pjsip__resolver_8c_source.html#l00227">sip_resolve_handle_naptr()</a>.</p>
<div class="fragment"><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;{</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *<a class="code" href="../../dd/d3d/structnaptr.html">naptr</a> = (<span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *) record;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(<a class="code" href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a>(record) == T_NAPTR);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="keywordflow">return</span> naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#af053a80dc771b285c53ac53025303970">service</a>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_af053a80dc771b285c53ac53025303970"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#af053a80dc771b285c53ac53025303970">ast_dns_naptr_record::service</a></div><div class="ttdeci">const char * service</div><div class="ttdoc">The service from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00098">dns_internal.h:98</a></div></div>
<div class="ttc" id="structnaptr_html"><div class="ttname"><a href="../../dd/d3d/structnaptr.html">naptr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00028">enum.h:28</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="dns__core_8h_html_abc1ded697e0cbcba8da698bc821d160f"><div class="ttname"><a href="../../d6/d51/dns__core_8h.html#abc1ded697e0cbcba8da698bc821d160f">ast_dns_record_get_rr_type</a></div><div class="ttdeci">int ast_dns_record_get_rr_type(const struct ast_dns_record *record)</div><div class="ttdoc">Get the resource record type of a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00145">dns_core.c:145</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aed31ff93373c046a4731ca6c7cd585e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed31ff93373c046a4731ca6c7cd585e7">&#9670;&nbsp;</a></span>compare_order()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int compare_order </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>record1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>record2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00523">523</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00551">dns_naptr_sort()</a>.</p>
<div class="fragment"><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;{</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **left = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **)record1;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **right = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **)record2;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="keywordflow">if</span> ((*left)-&gt;order &lt; (*right)-&gt;order) {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*left)-&gt;order &gt; (*right)-&gt;order) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div><div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeee7bfa19514c205321ad9c0c7908086"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeee7bfa19514c205321ad9c0c7908086">&#9670;&nbsp;</a></span>compare_preference()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int compare_preference </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>record1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>record2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00537">537</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00551">dns_naptr_sort()</a>.</p>
<div class="fragment"><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **left = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **)record1;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **right = (<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **)record2;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   <span class="keywordflow">if</span> ((*left)-&gt;preference &lt; (*right)-&gt;preference) {</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*left)-&gt;preference &gt; (*right)-&gt;preference) {</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1507445dcefc7ca59022e2ef4c2433aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1507445dcefc7ca59022e2ef4c2433aa">&#9670;&nbsp;</a></span>dns_naptr_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a>* dns_naptr_alloc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../dd/daa/structast__dns__query.html">ast_dns_query</a> *&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate and parse a DNS NAPTR record. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">query</td><td>The DNS query </td></tr>
    <tr><td class="paramname">data</td><td>This specific NAPTR record </td></tr>
    <tr><td class="paramname">size</td><td>The size of the NAPTR record</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">non-NULL</td><td>success </td></tr>
    <tr><td class="paramname">NULL</td><td>failure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00380">380</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00129">ast_dns_result::answer</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00131">ast_dns_result::answer_size</a>, <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>, <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00204">ast_calloc</a>, <a class="el" href="../../da/df7/astobj2_8c_source.html#l00042">ast_log</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00113">ast_dns_naptr_record::data</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00058">ast_dns_record::data_ptr</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00701">dns_find_record()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00722">dns_parse_short()</a>, <a class="el" href="../../dc/d00/dns__core_8c_source.html#l00734">dns_parse_string()</a>, <a class="el" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00096">ast_dns_naptr_record::flags</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00054">FLAGS_INVALID</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00094">ast_dns_naptr_record::generic</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00066">interpret_flags()</a>, <a class="el" href="../../d1/d8c/logger_8h_source.html#l00285">LOG_ERROR</a>, <a class="el" href="../../dc/d7f/resample_8c_source.html#l00096">NULL</a>, <a class="el" href="../../d2/d79/analys_8c_source.html#l00066">order</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00104">ast_dns_naptr_record::order</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00378">PAST_END_OF_RECORD</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00106">ast_dns_naptr_record::preference</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00100">ast_dns_naptr_record::regexp</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00309">regexp_invalid()</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00102">ast_dns_naptr_record::replacement</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00147">ast_dns_query::result</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00098">ast_dns_naptr_record::service</a>, and <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00130">services_invalid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;{</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *<a class="code" href="../../dd/d3d/structnaptr.html">naptr</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   <span class="keywordtype">char</span> *ptr = <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   uint16_t <a class="code" href="../../d2/d79/analys_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   uint16_t <a class="code" href="../../df/de3/structast__dns__naptr__record.html#a4855753a7f624d6708dade9e9c4f0080">preference</a>;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   uint8_t flags_size;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   uint8_t services_size;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="keywordtype">char</span> *services;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   uint8_t regexp_size;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   <span class="keywordtype">char</span> *<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">regexp</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;   <span class="keywordtype">char</span> <a class="code" href="../../df/de3/structast__dns__naptr__record.html#af13ea6e7567ddf33e5f2dc7fcafde92f">replacement</a>[256] = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordtype">int</span> replacement_size;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *end_of_record;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="keyword">enum</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685e">flags_result</a> flags_res;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordtype">size_t</span> naptr_len;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   ptr = <a class="code" href="../../d4/d07/dns__internal_8h.html#ae0b5c136c1af09327876900be0630411">dns_find_record</a>(<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a9a3b4be1b9151b0369d7fca9911c7ecd">data</a>, size, query-&gt;<a class="code" href="../../dd/daa/structast__dns__query.html#a739d372feb17d2aa4aefab56762623e4">result</a>-&gt;<a class="code" href="../../d5/d8d/structast__dns__result.html#acf478081be3b257185e81c8a92235209">answer</a>, query-&gt;<a class="code" href="../../dd/daa/structast__dns__query.html#a739d372feb17d2aa4aefab56762623e4">result</a>-&gt;<a class="code" href="../../d5/d8d/structast__dns__result.html#a60e7f19e0a67dbea7e21c74f1a225fef">answer_size</a>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(ptr != <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   end_of_record = ptr + size;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="comment">/* ORDER */</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="comment">/* This assignment takes a big-endian 16-bit value and stores it in the</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">    * machine&#39;s native byte order. Using this method allows us to avoid potential</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">    * alignment issues in case the order is not on a short-addressable boundary.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">    * See http://commandcenter.blogspot.com/2012/04/byte-order-fallacy.html for</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">    * more information</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   ptr += <a class="code" href="../../d4/d07/dns__internal_8h.html#a9e4884282d130aebaed0e9d0737fa19b">dns_parse_short</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) ptr, &amp;order);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#a3f25bf14345796cc59bc63bbdfe09642">PAST_END_OF_RECORD</a>) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="comment">/* PREFERENCE */</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   ptr += <a class="code" href="../../d4/d07/dns__internal_8h.html#a9e4884282d130aebaed0e9d0737fa19b">dns_parse_short</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) ptr, &amp;preference);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#a3f25bf14345796cc59bc63bbdfe09642">PAST_END_OF_RECORD</a>) {</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="comment">/* FLAGS */</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   ptr += <a class="code" href="../../d4/d07/dns__internal_8h.html#aabe2faa5200934ee2828955f611e4d5a">dns_parse_string</a>(ptr, &amp;flags_size, &amp;flags);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#a3f25bf14345796cc59bc63bbdfe09642">PAST_END_OF_RECORD</a>) {</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="comment">/* SERVICES */</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   ptr += <a class="code" href="../../d4/d07/dns__internal_8h.html#aabe2faa5200934ee2828955f611e4d5a">dns_parse_string</a>(ptr, &amp;services_size, &amp;services);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#a3f25bf14345796cc59bc63bbdfe09642">PAST_END_OF_RECORD</a>) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="comment">/* REGEXP */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   ptr += <a class="code" href="../../d4/d07/dns__internal_8h.html#aabe2faa5200934ee2828955f611e4d5a">dns_parse_string</a>(ptr, &amp;regexp_size, &amp;regexp);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#a3f25bf14345796cc59bc63bbdfe09642">PAST_END_OF_RECORD</a>) {</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   }</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">    * The return value from dn_expand represents the size of the replacement</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">    * in the buffer which MAY be compressed.  Since the expanded replacement</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">    * is NULL terminated, you can use strlen() to get the expanded size.</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   replacement_size = dn_expand((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)query-&gt;<a class="code" href="../../dd/daa/structast__dns__query.html#a739d372feb17d2aa4aefab56762623e4">result</a>-&gt;<a class="code" href="../../d5/d8d/structast__dns__result.html#acf478081be3b257185e81c8a92235209">answer</a>,</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) end_of_record, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) ptr,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      replacement, <span class="keyword">sizeof</span>(replacement) - 1);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="keywordflow">if</span> (replacement_size &lt; 0) {</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to expand domain name: %s\n&quot;</span>, strerror(<a class="code" href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a>));</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   ptr += replacement_size;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="keywordflow">if</span> (ptr != end_of_record) {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;NAPTR record gave undersized string indications.\n&quot;</span>);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <span class="comment">/* We&#39;ve validated the size of the NAPTR record. Now we can validate</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">    * the individual parts</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   flags_res = <a class="code" href="../../d3/de7/dns__naptr_8c.html#acda3837e17ffc03a649b907e29a029f4">interpret_flags</a>(flags, flags_size);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="keywordflow">if</span> (flags_res == <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>) {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;NAPTR Record contained invalid flags %.*s\n&quot;</span>, flags_size, flags);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#aaa760a6fd5c0c1cb2e77cdf5aa92f7fa">services_invalid</a>(services, services_size)) {</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;NAPTR record contained invalid services %.*s\n&quot;</span>, services_size, services);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   }</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#ab6a35fd0de8c566f1fce2c32f08fc97a">regexp_invalid</a>(regexp, regexp_size)) {</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;NAPTR record contained invalid regexp %.*s\n&quot;</span>, regexp_size, regexp);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="comment">/* replacement_size takes into account the NULL label, so a NAPTR record with no replacement</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">    * will have a replacement_size of 1.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <span class="keywordflow">if</span> (regexp_size &amp;&amp; replacement_size &gt; 1) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <a class="code" href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a>(<a class="code" href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;NAPTR record contained both a regexp and replacement\n&quot;</span>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   naptr_len = <span class="keyword">sizeof</span>(*naptr) + size + flags_size + 1 + services_size + 1</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      + regexp_size + 1 + strlen(replacement) + 1;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   naptr = <a class="code" href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a>(1, naptr_len);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordflow">if</span> (!naptr) {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a1236fced09ddfa5eb51667d641632420">order</a> = <a class="code" href="../../d2/d79/analys_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a4855753a7f624d6708dade9e9c4f0080">preference</a> = <a class="code" href="../../df/de3/structast__dns__naptr__record.html#a4855753a7f624d6708dade9e9c4f0080">preference</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   ptr = naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a9a3b4be1b9151b0369d7fca9911c7ecd">data</a>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   ptr += size;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   strncpy(ptr, flags, flags_size);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   ptr[flags_size] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> = ptr;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   ptr += flags_size + 1;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   strncpy(ptr, services, services_size);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   ptr[services_size] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#af053a80dc771b285c53ac53025303970">service</a> = ptr;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   ptr += services_size + 1;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   strncpy(ptr, regexp, regexp_size);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   ptr[regexp_size] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">regexp</a> = ptr;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   ptr += regexp_size + 1;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   strcpy(ptr, replacement);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#af13ea6e7567ddf33e5f2dc7fcafde92f">replacement</a> = ptr;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a4648fde6e8cb9408e134bc93ef77e3a1">generic</a>.<a class="code" href="../../d3/db7/structast__dns__record.html#ae7533305b03c676bd7047f6d2c3aa7b2">data_ptr</a> = naptr-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a9a3b4be1b9151b0369d7fca9911c7ecd">data</a>;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *)naptr;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div><div class="ttc" id="dns__internal_8h_html_aabe2faa5200934ee2828955f611e4d5a"><div class="ttname"><a href="../../d4/d07/dns__internal_8h.html#aabe2faa5200934ee2828955f611e4d5a">dns_parse_string</a></div><div class="ttdeci">int dns_parse_string(char *cur, uint8_t *size, char **val)</div><div class="ttdoc">Parse a DNS string from a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00734">dns_core.c:734</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_af13ea6e7567ddf33e5f2dc7fcafde92f"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#af13ea6e7567ddf33e5f2dc7fcafde92f">ast_dns_naptr_record::replacement</a></div><div class="ttdeci">const char * replacement</div><div class="ttdoc">The replacement from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00102">dns_internal.h:102</a></div></div>
<div class="ttc" id="structast__dns__record_html_ae7533305b03c676bd7047f6d2c3aa7b2"><div class="ttname"><a href="../../d3/db7/structast__dns__record.html#ae7533305b03c676bd7047f6d2c3aa7b2">ast_dns_record::data_ptr</a></div><div class="ttdeci">char * data_ptr</div><div class="ttdoc">pointer to record-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00058">dns_internal.h:58</a></div></div>
<div class="ttc" id="structast__dns__record_html"><div class="ttname"><a href="../../d3/db7/structast__dns__record.html">ast_dns_record</a></div><div class="ttdoc">For AST_LIST. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00039">dns_internal.h:39</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_acce5fc0dd978f67c45fcf195f37e7422"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">ast_dns_naptr_record::flags</a></div><div class="ttdeci">const char * flags</div><div class="ttdoc">The flags from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00096">dns_internal.h:96</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00054">dns_naptr.c:54</a></div></div>
<div class="ttc" id="dns__internal_8h_html_a9e4884282d130aebaed0e9d0737fa19b"><div class="ttname"><a href="../../d4/d07/dns__internal_8h.html#a9e4884282d130aebaed0e9d0737fa19b">dns_parse_short</a></div><div class="ttdeci">int dns_parse_short(unsigned char *cur, uint16_t *val)</div><div class="ttdoc">Parse a 16-bit unsigned value from a DNS record. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00722">dns_core.c:722</a></div></div>
<div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="resample_8c_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dc/d7f/resample_8c.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7f/resample_8c_source.html#l00096">resample.c:96</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a5c796239be94e0b9cfe95e168e34d1da"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">ast_dns_naptr_record::regexp</a></div><div class="ttdeci">const char * regexp</div><div class="ttdoc">The regular expression from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00100">dns_internal.h:100</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aaa760a6fd5c0c1cb2e77cdf5aa92f7fa"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aaa760a6fd5c0c1cb2e77cdf5aa92f7fa">services_invalid</a></div><div class="ttdeci">static int services_invalid(const char *services, uint8_t services_size)</div><div class="ttdoc">Analyze NAPTR services for validity as defined by RFC 3404. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00130">dns_naptr.c:130</a></div></div>
<div class="ttc" id="astobj2_8c_html_a96a00b3a518d7f32b6d51dc28f09bf9b"><div class="ttname"><a href="../../da/df7/astobj2_8c.html#a96a00b3a518d7f32b6d51dc28f09bf9b">ast_log</a></div><div class="ttdeci">#define ast_log</div><div class="ttdef"><b>Definition:</b> <a href="../../da/df7/astobj2_8c_source.html#l00042">astobj2.c:42</a></div></div>
<div class="ttc" id="analys_8c_html_aed7ca058008dc3e5ee131e575abed285"><div class="ttname"><a href="../../d2/d79/analys_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a></div><div class="ttdeci">integer order</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d79/analys_8c_source.html#l00066">analys.c:66</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_af053a80dc771b285c53ac53025303970"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#af053a80dc771b285c53ac53025303970">ast_dns_naptr_record::service</a></div><div class="ttdeci">const char * service</div><div class="ttdoc">The service from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00098">dns_internal.h:98</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_a3f25bf14345796cc59bc63bbdfe09642"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#a3f25bf14345796cc59bc63bbdfe09642">PAST_END_OF_RECORD</a></div><div class="ttdeci">#define PAST_END_OF_RECORD</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00378">dns_naptr.c:378</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_acda3837e17ffc03a649b907e29a029f4"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#acda3837e17ffc03a649b907e29a029f4">interpret_flags</a></div><div class="ttdeci">static enum flags_result interpret_flags(const char *flags, uint8_t flags_size)</div><div class="ttdoc">Analyze and interpret NAPTR flags as per RFC 3404. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00066">dns_naptr.c:66</a></div></div>
<div class="ttc" id="logger_8h_html_aced66975c154ea0e2a8ec3bc818b4e08"><div class="ttname"><a href="../../d1/d8c/logger_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a></div><div class="ttdeci">#define LOG_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d8c/logger_8h_source.html#l00285">logger.h:285</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a9a3b4be1b9151b0369d7fca9911c7ecd"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a9a3b4be1b9151b0369d7fca9911c7ecd">ast_dns_naptr_record::data</a></div><div class="ttdeci">char data[0]</div><div class="ttdoc">Buffer for NAPTR-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00113">dns_internal.h:113</a></div></div>
<div class="ttc" id="structast__dns__query_html_a739d372feb17d2aa4aefab56762623e4"><div class="ttname"><a href="../../dd/daa/structast__dns__query.html#a739d372feb17d2aa4aefab56762623e4">ast_dns_query::result</a></div><div class="ttdeci">struct ast_dns_result * result</div><div class="ttdoc">Result of the DNS query. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00147">dns_internal.h:147</a></div></div>
<div class="ttc" id="main_2stdtime_2private_8h_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="../../d1/d6e/main_2stdtime_2private_8h.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="astmm_8h_html_ae0cd4c5524b01287ab19cbe233d9cebb"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#ae0cd4c5524b01287ab19cbe233d9cebb">ast_calloc</a></div><div class="ttdeci">#define ast_calloc(num, len)</div><div class="ttdoc">A wrapper for calloc() </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00204">astmm.h:204</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a4855753a7f624d6708dade9e9c4f0080"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a4855753a7f624d6708dade9e9c4f0080">ast_dns_naptr_record::preference</a></div><div class="ttdeci">unsigned short preference</div><div class="ttdoc">The preference of the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00106">dns_internal.h:106</a></div></div>
<div class="ttc" id="structnaptr_html"><div class="ttname"><a href="../../dd/d3d/structnaptr.html">naptr</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d9b/enum_8h_source.html#l00028">enum.h:28</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685e"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685e">flags_result</a></div><div class="ttdeci">flags_result</div><div class="ttdoc">Result of analyzing NAPTR flags on a record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00046">dns_naptr.c:46</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_ab6a35fd0de8c566f1fce2c32f08fc97a"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#ab6a35fd0de8c566f1fce2c32f08fc97a">regexp_invalid</a></div><div class="ttdeci">static int regexp_invalid(const char *regexp, uint8_t regexp_size)</div><div class="ttdoc">Determine if the regexp in a NAPTR record is invalid. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00309">dns_naptr.c:309</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a4648fde6e8cb9408e134bc93ef77e3a1"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a4648fde6e8cb9408e134bc93ef77e3a1">ast_dns_naptr_record::generic</a></div><div class="ttdeci">struct ast_dns_record generic</div><div class="ttdoc">Generic DNS record information. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00094">dns_internal.h:94</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="dns__internal_8h_html_ae0b5c136c1af09327876900be0630411"><div class="ttname"><a href="../../d4/d07/dns__internal_8h.html#ae0b5c136c1af09327876900be0630411">dns_find_record</a></div><div class="ttdeci">char * dns_find_record(const char *record, size_t record_size, const char *response, size_t response_size)</div><div class="ttdoc">Find the location of a DNS record within the entire DNS answer. </div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d00/dns__core_8c_source.html#l00701">dns_core.c:701</a></div></div>
<div class="ttc" id="structast__dns__result_html_a60e7f19e0a67dbea7e21c74f1a225fef"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html#a60e7f19e0a67dbea7e21c74f1a225fef">ast_dns_result::answer_size</a></div><div class="ttdeci">size_t answer_size</div><div class="ttdoc">The size of the raw DNS answer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00131">dns_internal.h:131</a></div></div>
<div class="ttc" id="structast__dns__result_html_acf478081be3b257185e81c8a92235209"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html#acf478081be3b257185e81c8a92235209">ast_dns_result::answer</a></div><div class="ttdeci">const char * answer</div><div class="ttdoc">The raw DNS answer. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00129">dns_internal.h:129</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a1236fced09ddfa5eb51667d641632420"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a1236fced09ddfa5eb51667d641632420">ast_dns_naptr_record::order</a></div><div class="ttdeci">unsigned short order</div><div class="ttdoc">The order for the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00104">dns_internal.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a089c9ec9c3011b12cefaddd04afd2ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a089c9ec9c3011b12cefaddd04afd2ec5">&#9670;&nbsp;</a></span>dns_naptr_sort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dns_naptr_sort </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="../../d5/d8d/structast__dns__result.html">ast_dns_result</a> *&#160;</td>
          <td class="paramname"><em>result</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sort the NAPTR records on a result. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">result</td><td>The DNS result </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00551">551</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d8/d8a/astmm_8h_source.html#l00290">ast_alloca</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00730">AST_LIST_INSERT_TAIL</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00556">AST_LIST_REMOVE_CURRENT</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00490">AST_LIST_TRAVERSE</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00528">AST_LIST_TRAVERSE_SAFE_BEGIN</a>, <a class="el" href="../../df/d90/linkedlists_8h_source.html#l00614">AST_LIST_TRAVERSE_SAFE_END</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00523">compare_order()</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00537">compare_preference()</a>, <a class="el" href="../../d2/d79/analys_8c_source.html#l00066">order</a>, <a class="el" href="../../d4/d07/dns__internal_8h_source.html#l00104">ast_dns_naptr_record::order</a>, <a class="el" href="../../d0/d29/cdr__mysql_8c_source.html#l00084">records</a>, and <a class="el" href="../../d5/d8d/structast__dns__result.html#a85249bc4c3b2ab860d0dd551444a3ed4">ast_dns_result::records</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;{</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *current;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordtype">size_t</span> num_records = 0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> **<a class="code" href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <span class="keywordtype">int</span> j = 0;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <span class="keywordtype">int</span> cur_order;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <span class="comment">/* Determine the number of records */</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a>(&amp;result-&gt;<a class="code" href="../../d5/d8d/structast__dns__result.html#a85249bc4c3b2ab860d0dd551444a3ed4">records</a>, current, list) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      ++num_records;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="comment">/* No point in continuing if there are no records */</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <span class="keywordflow">if</span> (num_records == 0) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="comment">/* Allocate an array with that number of records */</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   records = <a class="code" href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a>(num_records * <span class="keyword">sizeof</span>(*records));</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="comment">/* Move records from the list to the array */</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a>(&amp;result-&gt;<a class="code" href="../../d5/d8d/structast__dns__result.html#a85249bc4c3b2ab860d0dd551444a3ed4">records</a>, current, list) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      records[i++] = (<span class="keyword">struct </span><a class="code" href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a> *) current;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a>(list);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <a class="code" href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <span class="comment">/* Sort the array by order */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   qsort(records, num_records, <span class="keyword">sizeof</span>(*records), <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed31ff93373c046a4731ca6c7cd585e7">compare_order</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <span class="comment">/* Sort subarrays by preference */</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; num_records; i = j) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      cur_order = records[i]-&gt;<a class="code" href="../../df/de3/structast__dns__naptr__record.html#a1236fced09ddfa5eb51667d641632420">order</a>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="keywordflow">for</span> (j = i + 1; j &lt; num_records; ++j) {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;         <span class="keywordflow">if</span> (records[j]-&gt;<a class="code" href="../../d2/d79/analys_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a> != cur_order) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;         }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      qsort(&amp;records[i], j - i, <span class="keyword">sizeof</span>(*records), <a class="code" href="../../d3/de7/dns__naptr_8c.html#aeee7bfa19514c205321ad9c0c7908086">compare_preference</a>);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   <span class="comment">/* Place sorted records back into the original list */</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; num_records; ++i) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <a class="code" href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a>(&amp;result-&gt;<a class="code" href="../../d5/d8d/structast__dns__result.html#a85249bc4c3b2ab860d0dd551444a3ed4">records</a>, (<span class="keyword">struct</span> <a class="code" href="../../d3/db7/structast__dns__record.html">ast_dns_record</a> *)(records[i]), list);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;}</div><div class="ttc" id="cdr__mysql_8c_html_ab18693215565ea1a797096dfe19e895f"><div class="ttname"><a href="../../d0/d29/cdr__mysql_8c.html#ab18693215565ea1a797096dfe19e895f">records</a></div><div class="ttdeci">static int records</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d29/cdr__mysql_8c_source.html#l00084">cdr_mysql.c:84</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed31ff93373c046a4731ca6c7cd585e7"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed31ff93373c046a4731ca6c7cd585e7">compare_order</a></div><div class="ttdeci">static int compare_order(const void *record1, const void *record2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00523">dns_naptr.c:523</a></div></div>
<div class="ttc" id="structast__dns__record_html"><div class="ttname"><a href="../../d3/db7/structast__dns__record.html">ast_dns_record</a></div><div class="ttdoc">For AST_LIST. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00039">dns_internal.h:39</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a712c04b4493919a7052399cd30ee8fb9"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a712c04b4493919a7052399cd30ee8fb9">AST_LIST_TRAVERSE_SAFE_END</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_END</div><div class="ttdoc">Closes a safe loop traversal block. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00614">linkedlists.h:614</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aeee7bfa19514c205321ad9c0c7908086"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aeee7bfa19514c205321ad9c0c7908086">compare_preference</a></div><div class="ttdeci">static int compare_preference(const void *record1, const void *record2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00537">dns_naptr.c:537</a></div></div>
<div class="ttc" id="analys_8c_html_aed7ca058008dc3e5ee131e575abed285"><div class="ttname"><a href="../../d2/d79/analys_8c.html#aed7ca058008dc3e5ee131e575abed285">order</a></div><div class="ttdeci">integer order</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d79/analys_8c_source.html#l00066">analys.c:66</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa8ac496fa9c717d5afb99a02e1e2760c"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa8ac496fa9c717d5afb99a02e1e2760c">AST_LIST_REMOVE_CURRENT</a></div><div class="ttdeci">#define AST_LIST_REMOVE_CURRENT(field)</div><div class="ttdoc">Removes the current entry from a list during a traversal. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00556">linkedlists.h:556</a></div></div>
<div class="ttc" id="astmm_8h_html_a249282ecc7ba5a1a49fa75e9a33d1717"><div class="ttname"><a href="../../d8/d8a/astmm_8h.html#a249282ecc7ba5a1a49fa75e9a33d1717">ast_alloca</a></div><div class="ttdeci">#define ast_alloca(size)</div><div class="ttdoc">call __builtin_alloca to ensure we get gcc builtin semantics </div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d8a/astmm_8h_source.html#l00290">astmm.h:290</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a4d258b4525e63c435d7de579d3f46960"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a4d258b4525e63c435d7de579d3f46960">AST_LIST_INSERT_TAIL</a></div><div class="ttdeci">#define AST_LIST_INSERT_TAIL(head, elm, field)</div><div class="ttdoc">Appends a list entry to the tail of a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00730">linkedlists.h:730</a></div></div>
<div class="ttc" id="linkedlists_8h_html_a3008b2f4f236b72d8bcfb80e346324ef"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#a3008b2f4f236b72d8bcfb80e346324ef">AST_LIST_TRAVERSE</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE(head, var, field)</div><div class="ttdoc">Loops over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00490">linkedlists.h:490</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html">ast_dns_naptr_record</a></div><div class="ttdoc">A NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00092">dns_internal.h:92</a></div></div>
<div class="ttc" id="linkedlists_8h_html_aa5be52067bf16bdc7e56ca19b5ba858d"><div class="ttname"><a href="../../df/d90/linkedlists_8h.html#aa5be52067bf16bdc7e56ca19b5ba858d">AST_LIST_TRAVERSE_SAFE_BEGIN</a></div><div class="ttdeci">#define AST_LIST_TRAVERSE_SAFE_BEGIN(head, var, field)</div><div class="ttdoc">Loops safely over (traverses) the entries in a list. </div><div class="ttdef"><b>Definition:</b> <a href="../../df/d90/linkedlists_8h_source.html#l00528">linkedlists.h:528</a></div></div>
<div class="ttc" id="structast__dns__result_html_a85249bc4c3b2ab860d0dd551444a3ed4"><div class="ttname"><a href="../../d5/d8d/structast__dns__result.html#a85249bc4c3b2ab860d0dd551444a3ed4">ast_dns_result::records</a></div><div class="ttdeci">struct ast_dns_result::dns_records records</div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a1236fced09ddfa5eb51667d641632420"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a1236fced09ddfa5eb51667d641632420">ast_dns_naptr_record::order</a></div><div class="ttdeci">unsigned short order</div><div class="ttdoc">The order for the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00104">dns_internal.h:104</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acda3837e17ffc03a649b907e29a029f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda3837e17ffc03a649b907e29a029f4">&#9670;&nbsp;</a></span>interpret_flags()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static enum <a class="el" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685e">flags_result</a> interpret_flags </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Analyze and interpret NAPTR flags as per RFC 3404. </p>
<dl class="section note"><dt>Note</dt><dd>The flags string passed into this function is NOT NULL-terminated</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>The flags string from a NAPTR record  The size of the flags string in bytes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>flag result </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00066">66</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00050">FLAGS_EMPTY</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00054">FLAGS_INVALID</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00048">FLAGS_TERMINAL</a>, and <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00052">FLAGS_UNKNOWN</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00380">dns_naptr_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keywordtype">char</span> known_flag_found = 0;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <span class="keywordflow">if</span> (flags_size == 0) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450">FLAGS_EMPTY</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="comment">/* Take care of the most common (and easy) case, one character */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <span class="keywordflow">if</span> (flags_size == 1) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">if</span> (*<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> == <span class="charliteral">&#39;s&#39;</span> || *<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> == <span class="charliteral">&#39;S&#39;</span> ||</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            *<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> == <span class="charliteral">&#39;a&#39;</span> || *<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> == <span class="charliteral">&#39;A&#39;</span> ||</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            *<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> == <span class="charliteral">&#39;u&#39;</span> || *<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> == <span class="charliteral">&#39;U&#39;</span>) {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74">FLAGS_TERMINAL</a>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!isalnum(*<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>)) {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c">FLAGS_UNKNOWN</a>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="comment">/*</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">    * Multiple flags are allowed, but you cannot mix the</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">    * S, A, U, and P flags together.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; flags_size; ++i) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <span class="keywordflow">if</span> (!isalnum(<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i])) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;s&#39;</span> || <a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;S&#39;</span>) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;         <span class="keywordflow">if</span> (known_flag_found &amp;&amp; known_flag_found != <span class="charliteral">&#39;s&#39;</span>) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;         }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         known_flag_found = <span class="charliteral">&#39;s&#39;</span>;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;u&#39;</span> || <a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;U&#39;</span>) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;         <span class="keywordflow">if</span> (known_flag_found &amp;&amp; known_flag_found != <span class="charliteral">&#39;u&#39;</span>) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;         }</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;         known_flag_found = <span class="charliteral">&#39;u&#39;</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;a&#39;</span> || <a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;A&#39;</span>) {</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;         <span class="keywordflow">if</span> (known_flag_found &amp;&amp; known_flag_found != <span class="charliteral">&#39;a&#39;</span>) {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         known_flag_found = <span class="charliteral">&#39;a&#39;</span>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;p&#39;</span> || <a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a>[i] == <span class="charliteral">&#39;P&#39;</span>) {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;         <span class="keywordflow">if</span> (known_flag_found &amp;&amp; known_flag_found != <span class="charliteral">&#39;p&#39;</span>) {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;         known_flag_found = <span class="charliteral">&#39;p&#39;</span>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <span class="keywordflow">return</span> (!known_flag_found || known_flag_found == <span class="charliteral">&#39;p&#39;</span>) ? <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c">FLAGS_UNKNOWN</a> : <a class="code" href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74">FLAGS_TERMINAL</a>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="ttc" id="structast__dns__naptr__record_html_acce5fc0dd978f67c45fcf195f37e7422"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">ast_dns_naptr_record::flags</a></div><div class="ttdeci">const char * flags</div><div class="ttdoc">The flags from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00096">dns_internal.h:96</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea008025af8481c9f2de66631289e9b21e">FLAGS_INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00054">dns_naptr.c:54</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685eab25009c086f1a8a0bead4efc8feb4f74">FLAGS_TERMINAL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00048">dns_naptr.c:48</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ead89b6342a440472b1459c4bf58e73450">FLAGS_EMPTY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00050">dns_naptr.c:50</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aed9b1a7b999cab0deaddd6ca8704685ea701b53033c240e0b5f47036ba0b3e02c">FLAGS_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00052">dns_naptr.c:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4259abb6948ada3deaf88deab082d28e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4259abb6948ada3deaf88deab082d28e">&#9670;&nbsp;</a></span>regexp_flags_invalid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int regexp_flags_invalid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if flags in the regexp are invalid. </p>
<p>A NAPTR regexp is structured like so /pattern/repl/FLAGS</p>
<p>This ensures that the flags on the regexp are valid. Regexp flags can either be zero or one character long. If the flags are one character long, that character must be "i" to indicate the regex evaluation is case-insensitive.</p>
<dl class="section note"><dt>Note</dt><dd>The flags string passed to this function is not NULL-terminated </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>The regexp flags from the NAPTR record </td></tr>
    <tr><td class="paramname">end</td><td>A pointer to the end of the flags string </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Flags are valid </td></tr>
    <tr><td class="paramname">-1</td><td>Flags are invalid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00189">189</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00309">regexp_invalid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> &gt;= <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a> - <a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> &gt; 1) {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   <span class="keywordflow">if</span> (*<a class="code" href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">flags</a> != <span class="charliteral">&#39;i&#39;</span>) {</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div><div class="ttc" id="structast__dns__naptr__record_html_acce5fc0dd978f67c45fcf195f37e7422"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#acce5fc0dd978f67c45fcf195f37e7422">ast_dns_naptr_record::flags</a></div><div class="ttdeci">const char * flags</div><div class="ttdoc">The flags from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00096">dns_internal.h:96</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6a35fd0de8c566f1fce2c32f08fc97a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6a35fd0de8c566f1fce2c32f08fc97a">&#9670;&nbsp;</a></span>regexp_invalid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int regexp_invalid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>regexp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>regexp_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if the regexp in a NAPTR record is invalid. </p>
<p>The goal of this function is to divide the regexp into its constituent parts and then let validation subroutines determine if each part is valid. If all parts are valid, then the entire regexp is valid.</p>
<dl class="section note"><dt>Note</dt><dd>The regexp string passed to this function is NOT NULL-terminated</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">regexp</td><td>The regexp from the NAPTR record </td></tr>
    <tr><td class="paramname">regexp_size</td><td>The size of the regexp string</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>regexp is valid </td></tr>
    <tr><td class="paramname">non-zero</td><td>regexp is invalid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00309">309</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00189">regexp_flags_invalid()</a>, <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00275">regexp_pattern_invalid()</a>, and <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00228">regexp_repl_invalid()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00380">dns_naptr_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   <span class="keywordtype">char</span> delim;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *delim2_pos;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *delim3_pos;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *ptr = <a class="code" href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">regexp</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *end_of_regexp = <a class="code" href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">regexp</a> + regexp_size;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *regex_pos;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *repl_pos;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *flags_pos;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <span class="keywordflow">if</span> (regexp_size == 0) {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   <span class="comment">/* The delimiter will be a ! or / in most cases, but the rules allow</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">    * for the delimiter to be nearly any character. It cannot be &#39;i&#39; because</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">    * the delimiter cannot be the same as regexp flags. The delimiter cannot</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">    * be 1-9 because the delimiter cannot be a backreference number. RFC</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">    * 2915 specified that backslash was also not allowed as a delimiter, but</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">    * RFC 3402 does not say this. We&#39;ve gone ahead and made the character</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">    * illegal for our purposes.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;   delim = *ptr;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;   <span class="keywordflow">if</span> (strchr(<span class="stringliteral">&quot;123456789\\i&quot;</span>, delim)) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   }</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   ++ptr;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   regex_pos = ptr;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="comment">/* Find the other two delimiters. If the delim is escaped with a backslash, it doesn&#39;t count */</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      delim2_pos = memchr(ptr, delim, end_of_regexp - ptr);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span> (!delim2_pos) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      ptr = delim2_pos + 1;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordflow">if</span> (delim2_pos[-1] != <span class="charliteral">&#39;\\&#39;</span>) {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="keywordflow">if</span> (ptr &gt;= end_of_regexp) {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   repl_pos = ptr;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      delim3_pos = memchr(ptr, delim, end_of_regexp - ptr);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (!delim3_pos) {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      ptr = delim3_pos + 1;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="keywordflow">if</span> (delim3_pos[-1] != <span class="charliteral">&#39;\\&#39;</span>) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   flags_pos = ptr;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="../../d3/de7/dns__naptr_8c.html#a4259abb6948ada3deaf88deab082d28e">regexp_flags_invalid</a>(flags_pos, end_of_regexp) ||</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         <a class="code" href="../../d3/de7/dns__naptr_8c.html#a7449341085ab5a81b1dbdfcab0fce5d2">regexp_repl_invalid</a>(repl_pos, delim3_pos, delim) ||</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <a class="code" href="../../d3/de7/dns__naptr_8c.html#aa104b7e0526f37f3074bc7edb069fe02">regexp_pattern_invalid</a>(regex_pos, delim2_pos)) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div><div class="ttc" id="dns__naptr_8c_html_a4259abb6948ada3deaf88deab082d28e"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#a4259abb6948ada3deaf88deab082d28e">regexp_flags_invalid</a></div><div class="ttdeci">static int regexp_flags_invalid(const char *flags, const char *end)</div><div class="ttdoc">Determine if flags in the regexp are invalid. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00189">dns_naptr.c:189</a></div></div>
<div class="ttc" id="structast__dns__naptr__record_html_a5c796239be94e0b9cfe95e168e34d1da"><div class="ttname"><a href="../../df/de3/structast__dns__naptr__record.html#a5c796239be94e0b9cfe95e168e34d1da">ast_dns_naptr_record::regexp</a></div><div class="ttdeci">const char * regexp</div><div class="ttdoc">The regular expression from the NAPTR record. </div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d07/dns__internal_8h_source.html#l00100">dns_internal.h:100</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_a7449341085ab5a81b1dbdfcab0fce5d2"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#a7449341085ab5a81b1dbdfcab0fce5d2">regexp_repl_invalid</a></div><div class="ttdeci">static int regexp_repl_invalid(const char *repl, const char *end, char delim)</div><div class="ttdoc">Determine if the replacement in the regexp is invalid. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00228">dns_naptr.c:228</a></div></div>
<div class="ttc" id="dns__naptr_8c_html_aa104b7e0526f37f3074bc7edb069fe02"><div class="ttname"><a href="../../d3/de7/dns__naptr_8c.html#aa104b7e0526f37f3074bc7edb069fe02">regexp_pattern_invalid</a></div><div class="ttdeci">static int regexp_pattern_invalid(const char *pattern, const char *end)</div><div class="ttdoc">Determine if the pattern in a regexp is invalid. </div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de7/dns__naptr_8c_source.html#l00275">dns_naptr.c:275</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa104b7e0526f37f3074bc7edb069fe02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa104b7e0526f37f3074bc7edb069fe02">&#9670;&nbsp;</a></span>regexp_pattern_invalid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int regexp_pattern_invalid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if the pattern in a regexp is invalid. </p>
<p>A NAPTR regexp is structured like so /PATTERN/repl/flags</p>
<p>This ensures that the pattern on the regexp is valid. The pattern is passed to a regex compiler to determine its validity.</p>
<dl class="section note"><dt>Note</dt><dd>The pattern string passed to this function is NOT NULL-terminated</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pattern</td><td>The pattern from the NAPTR record </td></tr>
    <tr><td class="paramname">end</td><td>A pointer to the end of the pattern</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Pattern is valid </td></tr>
    <tr><td class="paramname">non-zero</td><td>Pattern is invalid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00275">275</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00309">regexp_invalid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keywordtype">int</span> pattern_size = <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a> - pattern;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <span class="keywordtype">char</span> pattern_str[pattern_size + 1];</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   regex_t reg;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;   <span class="comment">/* regcomp requires a NULL-terminated string */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   memcpy(pattern_str, pattern, pattern_size);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   pattern_str[pattern_size] = <span class="charliteral">&#39;\0&#39;</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;   res = regcomp(&amp;reg, pattern_str, REG_EXTENDED);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   regfree(&amp;reg);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keywordflow">return</span> res;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7449341085ab5a81b1dbdfcab0fce5d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7449341085ab5a81b1dbdfcab0fce5d2">&#9670;&nbsp;</a></span>regexp_repl_invalid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int regexp_repl_invalid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>delim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if the replacement in the regexp is invalid. </p>
<p>A NAPTR regexp is structured like so /pattern/REPL/flags</p>
<p>This ensures that the replacement on the regexp is valid. The regexp replacement is free to use any character it wants, plus backreferences and an escaped regexp delimiter.</p>
<p>This function does not attempt to ensure that the backreferences refer to valid portions of the regexp's regex pattern.</p>
<dl class="section note"><dt>Note</dt><dd>The repl string passed to this function is NOT NULL-terminated</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">repl</td><td>The regexp replacement string </td></tr>
    <tr><td class="paramname">end</td><td>Pointer to the end of the replacement string </td></tr>
    <tr><td class="paramname">delim</td><td>The delimiter character for the regexp</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Replacement is valid </td></tr>
    <tr><td class="paramname">-1</td><td>Replacement is invalid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00228">228</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">References <a class="el" href="../../d5/d60/utils_8h_source.html#l00695">ast_assert</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00309">regexp_invalid()</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;{</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *ptr = repl;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <span class="keywordflow">if</span> (repl == <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a>) {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">/* Kind of weird, but this is fine */</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keywordtype">char</span> *backslash_pos = memchr(ptr, <span class="charliteral">&#39;\\&#39;</span>, <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a> - ptr);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (!backslash_pos) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a>(backslash_pos &lt; <a class="code" href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a> - 1);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">/* XXX RFC 3402 is unclear about whether other backslash-escaped characters</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">       * (such as a backslash-escaped backslash) are legal</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">if</span> (!strchr(<span class="stringliteral">&quot;12345689&quot;</span>, backslash_pos[1]) &amp;&amp; backslash_pos[1] != delim) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      ptr = backslash_pos + 1;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div><div class="ttc" id="utils_8h_html_a24374da24af1931d8a7ccde5b352bb2c"><div class="ttname"><a href="../../d5/d60/utils_8h.html#a24374da24af1931d8a7ccde5b352bb2c">ast_assert</a></div><div class="ttdeci">#define ast_assert(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d60/utils_8h_source.html#l00695">utils.h:695</a></div></div>
<div class="ttc" id="eagi__proxy_8c_html_a8fd806ad19b8f5513a4cf18cbf77532c"><div class="ttname"><a href="../../dd/d7c/eagi__proxy_8c.html#a8fd806ad19b8f5513a4cf18cbf77532c">end</a></div><div class="ttdeci">char * end</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d7c/eagi__proxy_8c_source.html#l00073">eagi_proxy.c:73</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa760a6fd5c0c1cb2e77cdf5aa92f7fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa760a6fd5c0c1cb2e77cdf5aa92f7fa">&#9670;&nbsp;</a></span>services_invalid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int services_invalid </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>services</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>services_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Analyze NAPTR services for validity as defined by RFC 3404. </p>
<dl class="section note"><dt>Note</dt><dd>The services string passed to this function is NOT NULL-terminated </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">services</td><td>The services string parsed from a NAPTR record </td></tr>
    <tr><td class="paramname">services_size</td><td>The size of the services string </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Services are valid </td></tr>
    <tr><td class="paramname">-1</td><td>Services are invalid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00130">130</a> of file <a class="el" href="../../d3/de7/dns__naptr_8c_source.html">dns_naptr.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d3/de7/dns__naptr_8c_source.html#l00380">dns_naptr_alloc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;{</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *current_pos = services;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span> *end_of_services = services + services_size;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keywordflow">if</span> (services_size == 0) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="comment">/* Services are broken into sections divided by a + sign. Each section</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">    * must start with an alphabetic character, and then can only contain</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">    * alphanumeric characters. The size of any section is limited to</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">    * 32 characters</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordtype">char</span> *plus_pos = memchr(current_pos, <span class="charliteral">&#39;+&#39;</span>, end_of_services - current_pos);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      uint8_t current_size = plus_pos ? plus_pos - current_pos : end_of_services - current_pos;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">int</span> i;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">if</span> (!isalpha(current_pos[0])) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">if</span> (current_size &gt; 32) {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordflow">for</span> (i = 1; i &lt; current_size; ++i) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         <span class="keywordflow">if</span> (!isalnum(current_pos[i])) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">if</span> (!plus_pos) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      current_pos = plus_pos + 1;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 8 2021 19:45:48 for Asterisk - The Open Source Telephony Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
